import{r as A,u as O,j as e,h as S,B as v,C as D,X as j,Y as M,T as b,i as k}from"./vendors-a0b7f925.js";import{a as R}from"./activities-421834d1.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))d(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function I(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(i){if(i.ep)return;i.ep=!0;const c=I(i);fetch(i.href,c)}})();const Et=["北京市","上海市","天津市","重庆市","香港特别行政区","澳门特别行政区"],ht=.5,gt=600,xt=!0,pt=!1,Nt=!0,At=2,Y=(T,r)=>{const I=r==="Total"?"所有":` ${r} `;return`我用 App 记录自己运动 ${T} 年了，下面列表展示的是${I}的数据`},ft="勇敢地踏上旅程，你会发现，世界远比你想象的大。",Ct="纵一苇之所如，凌万顷之茫然。",yt=Y,G="跑步",F="越野跑",H="跑步机",w="徒步",P="骑行",$="滑雪",B="步行",K="活动次数",U="最远距离",W="最快速度",V="总时间",X="平均速度",Z="总距离",q="按年",z="按月",J="按周",Q="按天",tt="位置",f={RUN_GENERIC_TITLE:G,RUN_TRAIL_TITLE:F,RUN_TREADMILL_TITLE:H,HIKING_TITLE:w,CYCLING_TITLE:P,SKIING_TITLE:$,WALKING_TITLE:B},_={ACTIVITY_COUNT_TITLE:K,MAX_DISTANCE_TITLE:U,MAX_SPEED_TITLE:W,TOTAL_TIME_TITLE:V,AVERAGE_SPEED_TITLE:X,TOTAL_DISTANCE_TITLE:Z,YEARLY_TITLE:q,MONTHLY_TITLE:z,WEEKLY_TITLE:J,DAILY_TITLE:Q,LOCATION_TITLE:tt},et="rgb(224,237,94)",st="rgb(228,212,220)",Ot=!1,nt=et,St="#47b8e0",vt=st,Dt=nt,jt="rgb(255,153,51)",Mt="rgb(51,255,87)",at="rgb(151,51,255)",bt=at,kt="rgb(255,51,51)",ot="_activityList_1ukxg_1",it="_filterContainer_1ukxg_7",rt="_summaryContainer_1ukxg_23",ct="_activityCard_1ukxg_30",lt="_activityName_1ukxg_45",Tt="_activityDetails_1ukxg_51",dt="_chart_1ukxg_60",_t="_smallHomeButton_1ukxg_70",m={activityList:ot,filterContainer:it,summaryContainer:rt,activityCard:ct,activityName:lt,activityDetails:Tt,chart:dt,smallHomeButton:_t},It=({period:T,summary:r,dailyDistances:I,interval:d,activityType:i})=>{const u=(()=>{if(d==="month"){const[t,n]=T.split("-").map(Number),a=new Date(t,n,0).getDate();return Array.from({length:a},(s,l)=>l+1)}else{if(d==="week")return Array.from({length:7},(t,n)=>n+1);if(d==="year")return Array.from({length:12},(t,n)=>n+1)}return[]})().map(t=>({day:t,distance:(I[t-1]||0).toFixed(2)})),g=t=>{const n=Math.floor(t/3600),a=Math.floor(t%3600/60),s=Math.floor(t%60);return`${n}h ${a}m ${s}s`},x=t=>{if(t===0)return"0:00";const n=60/t,a=Math.floor(n),s=Math.round((n-a)*60);return`${a}:${s<10?"0":""}${s} min/km`},h=Math.ceil(Math.max(...u.map(t=>parseFloat(t.distance)))+10),o=Array.from({length:Math.ceil(h/5)+1},(t,n)=>n*5);return e.jsxs("div",{className:m.activityCard,children:[e.jsx("h2",{className:m.activityName,children:T}),e.jsxs("div",{className:m.activityDetails,children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[_.TOTAL_DISTANCE_TITLE,":"]})," ",r.totalDistance.toFixed(2)," km"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[_.AVERAGE_SPEED_TITLE,":"]})," ",i==="ride"?`${r.averageSpeed.toFixed(2)} km/h`:x(r.averageSpeed)]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[_.TOTAL_TIME_TITLE,":"]})," ",g(r.totalTime)]}),d!=="day"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[_.ACTIVITY_COUNT_TITLE,":"]})," ",r.count]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[_.MAX_DISTANCE_TITLE,":"]})," ",r.maxDistance.toFixed(2)," km"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[_.MAX_SPEED_TITLE,":"]})," ",i==="ride"?`${r.maxSpeed.toFixed(2)} km/h`:x(r.maxSpeed)]})]}),d==="day"&&e.jsxs("p",{children:[e.jsxs("strong",{children:[_.LOCATION_TITLE,":"]})," ",r.location||""]}),["month","week","year"].includes(d)&&e.jsx("div",{className:m.chart,style:{height:"250px",width:"100%"},children:e.jsx(S,{children:e.jsxs(v,{data:u,margin:{top:20,right:20,left:-20,bottom:5},children:[e.jsx(D,{strokeDasharray:"3 3",stroke:"#444"}),e.jsx(j,{dataKey:"day",tick:{fill:"rgb(204, 204, 204)"}}),e.jsx(M,{label:{value:"km",angle:-90,position:"insideLeft",fill:"rgb(204, 204, 204)"},domain:[0,h],ticks:o,tick:{fill:"rgb(204, 204, 204)"}}),e.jsx(b,{formatter:t=>`${t} km`,contentStyle:{backgroundColor:"rgb(36, 36, 36)",border:"1px solid #444",color:"rgb(204, 204, 204)"},labelStyle:{color:"rgb(224, 237, 94)"}}),e.jsx(k,{dataKey:"distance",fill:"rgb(224, 237, 94)"})]})})})]})]})},ut=()=>{const[T,r]=A.useState("month"),[I,d]=A.useState("run"),i=O(),c=o=>{r(o)},u=o=>o.type.toLowerCase()===I,g=o=>{const[t,n,a]=o.split(":").map(Number);return t*3600+n*60+a},h=(o=>R.filter(u).reduce((t,n)=>{const a=new Date(n.start_date_local);let s,l;switch(o){case"year":s=a.getFullYear().toString(),l=a.getMonth();break;case"month":s=`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}`,l=a.getDate()-1;break;case"week":const L=new Date(a.valueOf());L.setDate(L.getDate()+4-(L.getDay()||7));const C=new Date(L.getFullYear(),0,1),y=Math.ceil(((L.getTime()-C.getTime())/864e5+1)/7);s=`${L.getFullYear()}-W${y.toString().padStart(2,"0")}`,l=(a.getDay()+6)%7;break;case"day":s=a.toLocaleDateString("zh").replaceAll("/","-"),l=0;break;default:s=a.getFullYear().toString(),l=0}t[s]||(t[s]={totalDistance:0,totalTime:0,count:0,dailyDistances:[],maxDistance:0,maxSpeed:0,location:""});const E=n.distance/1e3,p=g(n.moving_time),N=p>0?E/(p/3600):0;return t[s].totalDistance+=E,t[s].totalTime+=p,t[s].count+=1,t[s].dailyDistances[l]=(t[s].dailyDistances[l]||0)+E,E>t[s].maxDistance&&(t[s].maxDistance=E),N>t[s].maxSpeed&&(t[s].maxSpeed=N),o==="day"&&(t[s].location=n.location_country||""),t},{}))(T);return e.jsxs("div",{className:m.activityList,children:[e.jsxs("div",{className:m.filterContainer,children:[e.jsx("button",{className:m.smallHomeButton,onClick:()=>i("/"),children:"Home"}),e.jsxs("select",{onChange:o=>d(o.target.value),value:I,children:[e.jsx("option",{value:"run",children:f.RUN_GENERIC_TITLE}),e.jsx("option",{value:"ride",children:f.CYCLING_TITLE})]}),e.jsxs("select",{onChange:o=>c(o.target.value),value:T,children:[e.jsx("option",{value:"year",children:_.YEARLY_TITLE}),e.jsx("option",{value:"month",children:_.MONTHLY_TITLE}),e.jsx("option",{value:"week",children:_.WEEKLY_TITLE}),e.jsx("option",{value:"day",children:_.DAILY_TITLE})]})]}),e.jsx("div",{className:m.summaryContainer,children:Object.entries(h).sort(([o],[t])=>{if(T==="day")return new Date(t).getTime()-new Date(o).getTime();if(T==="week"){const[n,a]=o.split("-W").map(Number),[s,l]=t.split("-W").map(Number);return s-n||l-a}else{const[n,a=0]=o.split("-").map(Number),[s,l=0]=t.split("-").map(Number);return s-n||l-a}}).map(([o,t])=>e.jsx(It,{period:o,summary:{totalDistance:t.totalDistance,averageSpeed:t.totalTime?t.totalDistance/(t.totalTime/3600):0,totalTime:t.totalTime,count:t.count,maxDistance:t.maxDistance,maxSpeed:t.maxSpeed,location:t.location},dailyDistances:t.dailyDistances,interval:T,activityType:I},o))})]})},Rt=()=>e.jsx("div",{children:e.jsx(ut,{})});export{Mt as C,at as H,Nt as I,xt as L,nt as M,Ot as N,St as P,jt as R,kt as S,bt as W,At as Z,Et as a,Dt as b,pt as c,ft as d,Ct as e,vt as f,ht as g,gt as h,yt as i,Rt as j};
