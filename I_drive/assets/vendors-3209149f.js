function u_(i,a){for(var p=0;p<a.length;p++){const y=a[p];if(typeof y!="string"&&!Array.isArray(y)){for(const T in y)if(T!=="default"&&!(T in i)){const P=Object.getOwnPropertyDescriptor(y,T);P&&Object.defineProperty(i,T,P.get?P:{enumerable:!0,get:()=>y[T]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}var C8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yd(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var I8={exports:{}},y5={},A8={exports:{}},bn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N2=Symbol.for("react.element"),Sb=Symbol.for("react.portal"),Mb=Symbol.for("react.fragment"),Cb=Symbol.for("react.strict_mode"),Ib=Symbol.for("react.profiler"),Ab=Symbol.for("react.provider"),Pb=Symbol.for("react.context"),kb=Symbol.for("react.forward_ref"),zb=Symbol.for("react.suspense"),Db=Symbol.for("react.memo"),Lb=Symbol.for("react.lazy"),v7=Symbol.iterator;function Rb(i){return i===null||typeof i!="object"?null:(i=v7&&i[v7]||i["@@iterator"],typeof i=="function"?i:null)}var P8={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k8=Object.assign,z8={};function N0(i,a,p){this.props=i,this.context=a,this.refs=z8,this.updater=p||P8}N0.prototype.isReactComponent={};N0.prototype.setState=function(i,a){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,a,"setState")};N0.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function D8(){}D8.prototype=N0.prototype;function h_(i,a,p){this.props=i,this.context=a,this.refs=z8,this.updater=p||P8}var d_=h_.prototype=new D8;d_.constructor=h_;k8(d_,N0.prototype);d_.isPureReactComponent=!0;var b7=Array.isArray,L8=Object.prototype.hasOwnProperty,p_={current:null},R8={key:!0,ref:!0,__self:!0,__source:!0};function B8(i,a,p){var y,T={},P=null,F=null;if(a!=null)for(y in a.ref!==void 0&&(F=a.ref),a.key!==void 0&&(P=""+a.key),a)L8.call(a,y)&&!R8.hasOwnProperty(y)&&(T[y]=a[y]);var t=arguments.length-2;if(t===1)T.children=p;else if(1<t){for(var j=Array(t),ie=0;ie<t;ie++)j[ie]=arguments[ie+2];T.children=j}if(i&&i.defaultProps)for(y in t=i.defaultProps,t)T[y]===void 0&&(T[y]=t[y]);return{$$typeof:N2,type:i,key:P,ref:F,props:T,_owner:p_.current}}function Bb(i,a){return{$$typeof:N2,type:i.type,key:a,ref:i.ref,props:i.props,_owner:i._owner}}function f_(i){return typeof i=="object"&&i!==null&&i.$$typeof===N2}function Fb(i){var a={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(p){return a[p]})}var w7=/\/+/g;function S4(i,a){return typeof i=="object"&&i!==null&&i.key!=null?Fb(""+i.key):a.toString(36)}function x3(i,a,p,y,T){var P=typeof i;(P==="undefined"||P==="boolean")&&(i=null);var F=!1;if(i===null)F=!0;else switch(P){case"string":case"number":F=!0;break;case"object":switch(i.$$typeof){case N2:case Sb:F=!0}}if(F)return F=i,T=T(F),i=y===""?"."+S4(F,0):y,b7(T)?(p="",i!=null&&(p=i.replace(w7,"$&/")+"/"),x3(T,a,p,"",function(ie){return ie})):T!=null&&(f_(T)&&(T=Bb(T,p+(!T.key||F&&F.key===T.key?"":(""+T.key).replace(w7,"$&/")+"/")+i)),a.push(T)),1;if(F=0,y=y===""?".":y+":",b7(i))for(var t=0;t<i.length;t++){P=i[t];var j=y+S4(P,t);F+=x3(P,a,p,j,T)}else if(j=Rb(i),typeof j=="function")for(i=j.call(i),t=0;!(P=i.next()).done;)P=P.value,j=y+S4(P,t++),F+=x3(P,a,p,j,T);else if(P==="object")throw a=String(i),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.");return F}function Ym(i,a,p){if(i==null)return i;var y=[],T=0;return x3(i,y,"","",function(P){return a.call(p,P,T++)}),y}function Ob(i){if(i._status===-1){var a=i._result;a=a(),a.then(function(p){(i._status===0||i._status===-1)&&(i._status=1,i._result=p)},function(p){(i._status===0||i._status===-1)&&(i._status=2,i._result=p)}),i._status===-1&&(i._status=0,i._result=a)}if(i._status===1)return i._result.default;throw i._result}var al={current:null},v3={transition:null},Ub={ReactCurrentDispatcher:al,ReactCurrentBatchConfig:v3,ReactCurrentOwner:p_};function F8(){throw Error("act(...) is not supported in production builds of React.")}bn.Children={map:Ym,forEach:function(i,a,p){Ym(i,function(){a.apply(this,arguments)},p)},count:function(i){var a=0;return Ym(i,function(){a++}),a},toArray:function(i){return Ym(i,function(a){return a})||[]},only:function(i){if(!f_(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};bn.Component=N0;bn.Fragment=Mb;bn.Profiler=Ib;bn.PureComponent=h_;bn.StrictMode=Cb;bn.Suspense=zb;bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ub;bn.act=F8;bn.cloneElement=function(i,a,p){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var y=k8({},i.props),T=i.key,P=i.ref,F=i._owner;if(a!=null){if(a.ref!==void 0&&(P=a.ref,F=p_.current),a.key!==void 0&&(T=""+a.key),i.type&&i.type.defaultProps)var t=i.type.defaultProps;for(j in a)L8.call(a,j)&&!R8.hasOwnProperty(j)&&(y[j]=a[j]===void 0&&t!==void 0?t[j]:a[j])}var j=arguments.length-2;if(j===1)y.children=p;else if(1<j){t=Array(j);for(var ie=0;ie<j;ie++)t[ie]=arguments[ie+2];y.children=t}return{$$typeof:N2,type:i.type,key:T,ref:P,props:y,_owner:F}};bn.createContext=function(i){return i={$$typeof:Pb,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:Ab,_context:i},i.Consumer=i};bn.createElement=B8;bn.createFactory=function(i){var a=B8.bind(null,i);return a.type=i,a};bn.createRef=function(){return{current:null}};bn.forwardRef=function(i){return{$$typeof:kb,render:i}};bn.isValidElement=f_;bn.lazy=function(i){return{$$typeof:Lb,_payload:{_status:-1,_result:i},_init:Ob}};bn.memo=function(i,a){return{$$typeof:Db,type:i,compare:a===void 0?null:a}};bn.startTransition=function(i){var a=v3.transition;v3.transition={};try{i()}finally{v3.transition=a}};bn.unstable_act=F8;bn.useCallback=function(i,a){return al.current.useCallback(i,a)};bn.useContext=function(i){return al.current.useContext(i)};bn.useDebugValue=function(){};bn.useDeferredValue=function(i){return al.current.useDeferredValue(i)};bn.useEffect=function(i,a){return al.current.useEffect(i,a)};bn.useId=function(){return al.current.useId()};bn.useImperativeHandle=function(i,a,p){return al.current.useImperativeHandle(i,a,p)};bn.useInsertionEffect=function(i,a){return al.current.useInsertionEffect(i,a)};bn.useLayoutEffect=function(i,a){return al.current.useLayoutEffect(i,a)};bn.useMemo=function(i,a){return al.current.useMemo(i,a)};bn.useReducer=function(i,a,p){return al.current.useReducer(i,a,p)};bn.useRef=function(i){return al.current.useRef(i)};bn.useState=function(i){return al.current.useState(i)};bn.useSyncExternalStore=function(i,a,p){return al.current.useSyncExternalStore(i,a,p)};bn.useTransition=function(){return al.current.useTransition()};bn.version="18.3.1";A8.exports=bn;var Xt=A8.exports;const i1=yd(Xt),Nb=u_({__proto__:null,default:i1},[Xt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vb=Xt,jb=Symbol.for("react.element"),Gb=Symbol.for("react.fragment"),$b=Object.prototype.hasOwnProperty,Zb=Vb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qb={key:!0,ref:!0,__self:!0,__source:!0};function O8(i,a,p){var y,T={},P=null,F=null;p!==void 0&&(P=""+p),a.key!==void 0&&(P=""+a.key),a.ref!==void 0&&(F=a.ref);for(y in a)$b.call(a,y)&&!qb.hasOwnProperty(y)&&(T[y]=a[y]);if(i&&i.defaultProps)for(y in a=i.defaultProps,a)T[y]===void 0&&(T[y]=a[y]);return{$$typeof:jb,type:i,key:P,ref:F,props:T,_owner:Zb.current}}y5.Fragment=Gb;y5.jsx=O8;y5.jsxs=O8;I8.exports=y5;var FC=I8.exports,T7={},U8={exports:{}},bc={},N8={exports:{}},V8={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function a(pt,hi){var Si=pt.length;pt.push(hi);e:for(;0<Si;){var Wi=Si-1>>>1,lr=pt[Wi];if(0<T(lr,hi))pt[Wi]=hi,pt[Si]=lr,Si=Wi;else break e}}function p(pt){return pt.length===0?null:pt[0]}function y(pt){if(pt.length===0)return null;var hi=pt[0],Si=pt.pop();if(Si!==hi){pt[0]=Si;e:for(var Wi=0,lr=pt.length,mr=lr>>>1;Wi<mr;){var Vr=2*(Wi+1)-1,rn=pt[Vr],nn=Vr+1,on=pt[nn];if(0>T(rn,Si))nn<lr&&0>T(on,rn)?(pt[Wi]=on,pt[nn]=Si,Wi=nn):(pt[Wi]=rn,pt[Vr]=Si,Wi=Vr);else if(nn<lr&&0>T(on,Si))pt[Wi]=on,pt[nn]=Si,Wi=nn;else break e}}return hi}function T(pt,hi){var Si=pt.sortIndex-hi.sortIndex;return Si!==0?Si:pt.id-hi.id}if(typeof performance=="object"&&typeof performance.now=="function"){var P=performance;i.unstable_now=function(){return P.now()}}else{var F=Date,t=F.now();i.unstable_now=function(){return F.now()-t}}var j=[],ie=[],ye=1,he=null,ne=3,Ye=!1,lt=!1,at=!1,Kt=typeof setTimeout=="function"?setTimeout:null,Ne=typeof clearTimeout=="function"?clearTimeout:null,Le=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function je(pt){for(var hi=p(ie);hi!==null;){if(hi.callback===null)y(ie);else if(hi.startTime<=pt)y(ie),hi.sortIndex=hi.expirationTime,a(j,hi);else break;hi=p(ie)}}function _t(pt){if(at=!1,je(pt),!lt)if(p(j)!==null)lt=!0,Mt(St);else{var hi=p(ie);hi!==null&&ui(_t,hi.startTime-pt)}}function St(pt,hi){lt=!1,at&&(at=!1,Ne(ri),ri=-1),Ye=!0;var Si=ne;try{for(je(hi),he=p(j);he!==null&&(!(he.expirationTime>hi)||pt&&!yr());){var Wi=he.callback;if(typeof Wi=="function"){he.callback=null,ne=he.priorityLevel;var lr=Wi(he.expirationTime<=hi);hi=i.unstable_now(),typeof lr=="function"?he.callback=lr:he===p(j)&&y(j),je(hi)}else y(j);he=p(j)}if(he!==null)var mr=!0;else{var Vr=p(ie);Vr!==null&&ui(_t,Vr.startTime-hi),mr=!1}return mr}finally{he=null,ne=Si,Ye=!1}}var ci=!1,dt=null,ri=-1,zt=5,Ci=-1;function yr(){return!(i.unstable_now()-Ci<zt)}function ki(){if(dt!==null){var pt=i.unstable_now();Ci=pt;var hi=!0;try{hi=dt(!0,pt)}finally{hi?fr():(ci=!1,dt=null)}}else ci=!1}var fr;if(typeof Le=="function")fr=function(){Le(ki)};else if(typeof MessageChannel<"u"){var Qt=new MessageChannel,$t=Qt.port2;Qt.port1.onmessage=ki,fr=function(){$t.postMessage(null)}}else fr=function(){Kt(ki,0)};function Mt(pt){dt=pt,ci||(ci=!0,fr())}function ui(pt,hi){ri=Kt(function(){pt(i.unstable_now())},hi)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(pt){pt.callback=null},i.unstable_continueExecution=function(){lt||Ye||(lt=!0,Mt(St))},i.unstable_forceFrameRate=function(pt){0>pt||125<pt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):zt=0<pt?Math.floor(1e3/pt):5},i.unstable_getCurrentPriorityLevel=function(){return ne},i.unstable_getFirstCallbackNode=function(){return p(j)},i.unstable_next=function(pt){switch(ne){case 1:case 2:case 3:var hi=3;break;default:hi=ne}var Si=ne;ne=hi;try{return pt()}finally{ne=Si}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(pt,hi){switch(pt){case 1:case 2:case 3:case 4:case 5:break;default:pt=3}var Si=ne;ne=pt;try{return hi()}finally{ne=Si}},i.unstable_scheduleCallback=function(pt,hi,Si){var Wi=i.unstable_now();switch(typeof Si=="object"&&Si!==null?(Si=Si.delay,Si=typeof Si=="number"&&0<Si?Wi+Si:Wi):Si=Wi,pt){case 1:var lr=-1;break;case 2:lr=250;break;case 5:lr=1073741823;break;case 4:lr=1e4;break;default:lr=5e3}return lr=Si+lr,pt={id:ye++,callback:hi,priorityLevel:pt,startTime:Si,expirationTime:lr,sortIndex:-1},Si>Wi?(pt.sortIndex=Si,a(ie,pt),p(j)===null&&pt===p(ie)&&(at?(Ne(ri),ri=-1):at=!0,ui(_t,Si-Wi))):(pt.sortIndex=lr,a(j,pt),lt||Ye||(lt=!0,Mt(St))),pt},i.unstable_shouldYield=yr,i.unstable_wrapCallback=function(pt){var hi=ne;return function(){var Si=ne;ne=hi;try{return pt.apply(this,arguments)}finally{ne=Si}}}})(V8);N8.exports=V8;var Wb=N8.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xb=Xt,vc=Wb;function Ri(i){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+i,p=1;p<arguments.length;p++)a+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var j8=new Set,g2={};function hp(i,a){I0(i,a),I0(i+"Capture",a)}function I0(i,a){for(g2[i]=a,i=0;i<a.length;i++)j8.add(a[i])}var a1=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a6=Object.prototype.hasOwnProperty,Hb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,E7={},S7={};function Kb(i){return a6.call(S7,i)?!0:a6.call(E7,i)?!1:Hb.test(i)?S7[i]=!0:(E7[i]=!0,!1)}function Yb(i,a,p,y){if(p!==null&&p.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return y?!1:p!==null?!p.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function Jb(i,a,p,y){if(a===null||typeof a>"u"||Yb(i,a,p,y))return!0;if(y)return!1;if(p!==null)switch(p.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function ll(i,a,p,y,T,P,F){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=y,this.attributeNamespace=T,this.mustUseProperty=p,this.propertyName=i,this.type=a,this.sanitizeURL=P,this.removeEmptyString=F}var ga={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){ga[i]=new ll(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var a=i[0];ga[a]=new ll(a,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){ga[i]=new ll(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){ga[i]=new ll(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){ga[i]=new ll(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){ga[i]=new ll(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){ga[i]=new ll(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){ga[i]=new ll(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){ga[i]=new ll(i,5,!1,i.toLowerCase(),null,!1,!1)});var m_=/[\-:]([a-z])/g;function __(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var a=i.replace(m_,__);ga[a]=new ll(a,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var a=i.replace(m_,__);ga[a]=new ll(a,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var a=i.replace(m_,__);ga[a]=new ll(a,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){ga[i]=new ll(i,1,!1,i.toLowerCase(),null,!1,!1)});ga.xlinkHref=new ll("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){ga[i]=new ll(i,1,!1,i.toLowerCase(),null,!0,!0)});function g_(i,a,p,y){var T=ga.hasOwnProperty(a)?ga[a]:null;(T!==null?T.type!==0:y||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(Jb(a,p,T,y)&&(p=null),y||T===null?Kb(a)&&(p===null?i.removeAttribute(a):i.setAttribute(a,""+p)):T.mustUseProperty?i[T.propertyName]=p===null?T.type===3?!1:"":p:(a=T.attributeName,y=T.attributeNamespace,p===null?i.removeAttribute(a):(T=T.type,p=T===3||T===4&&p===!0?"":""+p,y?i.setAttributeNS(y,a,p):i.setAttribute(a,p))))}var h1=Xb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jm=Symbol.for("react.element"),s0=Symbol.for("react.portal"),a0=Symbol.for("react.fragment"),y_=Symbol.for("react.strict_mode"),l6=Symbol.for("react.profiler"),G8=Symbol.for("react.provider"),$8=Symbol.for("react.context"),x_=Symbol.for("react.forward_ref"),c6=Symbol.for("react.suspense"),u6=Symbol.for("react.suspense_list"),v_=Symbol.for("react.memo"),Q1=Symbol.for("react.lazy"),Z8=Symbol.for("react.offscreen"),M7=Symbol.iterator;function jf(i){return i===null||typeof i!="object"?null:(i=M7&&i[M7]||i["@@iterator"],typeof i=="function"?i:null)}var qo=Object.assign,M4;function t2(i){if(M4===void 0)try{throw Error()}catch(p){var a=p.stack.trim().match(/\n( *(at )?)/);M4=a&&a[1]||""}return`
`+M4+i}var C4=!1;function I4(i,a){if(!i||C4)return"";C4=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ie){var y=ie}Reflect.construct(i,[],a)}else{try{a.call()}catch(ie){y=ie}i.call(a.prototype)}else{try{throw Error()}catch(ie){y=ie}i()}}catch(ie){if(ie&&y&&typeof ie.stack=="string"){for(var T=ie.stack.split(`
`),P=y.stack.split(`
`),F=T.length-1,t=P.length-1;1<=F&&0<=t&&T[F]!==P[t];)t--;for(;1<=F&&0<=t;F--,t--)if(T[F]!==P[t]){if(F!==1||t!==1)do if(F--,t--,0>t||T[F]!==P[t]){var j=`
`+T[F].replace(" at new "," at ");return i.displayName&&j.includes("<anonymous>")&&(j=j.replace("<anonymous>",i.displayName)),j}while(1<=F&&0<=t);break}}}finally{C4=!1,Error.prepareStackTrace=p}return(i=i?i.displayName||i.name:"")?t2(i):""}function Qb(i){switch(i.tag){case 5:return t2(i.type);case 16:return t2("Lazy");case 13:return t2("Suspense");case 19:return t2("SuspenseList");case 0:case 2:case 15:return i=I4(i.type,!1),i;case 11:return i=I4(i.type.render,!1),i;case 1:return i=I4(i.type,!0),i;default:return""}}function h6(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case a0:return"Fragment";case s0:return"Portal";case l6:return"Profiler";case y_:return"StrictMode";case c6:return"Suspense";case u6:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case $8:return(i.displayName||"Context")+".Consumer";case G8:return(i._context.displayName||"Context")+".Provider";case x_:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case v_:return a=i.displayName||null,a!==null?a:h6(i.type)||"Memo";case Q1:a=i._payload,i=i._init;try{return h6(i(a))}catch{}}return null}function ew(i){var a=i.type;switch(i.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=a.render,i=i.displayName||i.name||"",a.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return h6(a);case 8:return a===y_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function md(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function q8(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function tw(i){var a=q8(i)?"checked":"value",p=Object.getOwnPropertyDescriptor(i.constructor.prototype,a),y=""+i[a];if(!i.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var T=p.get,P=p.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return T.call(this)},set:function(F){y=""+F,P.call(this,F)}}),Object.defineProperty(i,a,{enumerable:p.enumerable}),{getValue:function(){return y},setValue:function(F){y=""+F},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function Qm(i){i._valueTracker||(i._valueTracker=tw(i))}function W8(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var p=a.getValue(),y="";return i&&(y=q8(i)?i.checked?"true":"false":i.value),i=y,i!==p?(a.setValue(i),!0):!1}function R3(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function d6(i,a){var p=a.checked;return qo({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??i._wrapperState.initialChecked})}function C7(i,a){var p=a.defaultValue==null?"":a.defaultValue,y=a.checked!=null?a.checked:a.defaultChecked;p=md(a.value!=null?a.value:p),i._wrapperState={initialChecked:y,initialValue:p,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function X8(i,a){a=a.checked,a!=null&&g_(i,"checked",a,!1)}function p6(i,a){X8(i,a);var p=md(a.value),y=a.type;if(p!=null)y==="number"?(p===0&&i.value===""||i.value!=p)&&(i.value=""+p):i.value!==""+p&&(i.value=""+p);else if(y==="submit"||y==="reset"){i.removeAttribute("value");return}a.hasOwnProperty("value")?f6(i,a.type,p):a.hasOwnProperty("defaultValue")&&f6(i,a.type,md(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(i.defaultChecked=!!a.defaultChecked)}function I7(i,a,p){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var y=a.type;if(!(y!=="submit"&&y!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+i._wrapperState.initialValue,p||a===i.value||(i.value=a),i.defaultValue=a}p=i.name,p!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,p!==""&&(i.name=p)}function f6(i,a,p){(a!=="number"||R3(i.ownerDocument)!==i)&&(p==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+p&&(i.defaultValue=""+p))}var i2=Array.isArray;function x0(i,a,p,y){if(i=i.options,a){a={};for(var T=0;T<p.length;T++)a["$"+p[T]]=!0;for(p=0;p<i.length;p++)T=a.hasOwnProperty("$"+i[p].value),i[p].selected!==T&&(i[p].selected=T),T&&y&&(i[p].defaultSelected=!0)}else{for(p=""+md(p),a=null,T=0;T<i.length;T++){if(i[T].value===p){i[T].selected=!0,y&&(i[T].defaultSelected=!0);return}a!==null||i[T].disabled||(a=i[T])}a!==null&&(a.selected=!0)}}function m6(i,a){if(a.dangerouslySetInnerHTML!=null)throw Error(Ri(91));return qo({},a,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function A7(i,a){var p=a.value;if(p==null){if(p=a.children,a=a.defaultValue,p!=null){if(a!=null)throw Error(Ri(92));if(i2(p)){if(1<p.length)throw Error(Ri(93));p=p[0]}a=p}a==null&&(a=""),p=a}i._wrapperState={initialValue:md(p)}}function H8(i,a){var p=md(a.value),y=md(a.defaultValue);p!=null&&(p=""+p,p!==i.value&&(i.value=p),a.defaultValue==null&&i.defaultValue!==p&&(i.defaultValue=p)),y!=null&&(i.defaultValue=""+y)}function P7(i){var a=i.textContent;a===i._wrapperState.initialValue&&a!==""&&a!==null&&(i.value=a)}function K8(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _6(i,a){return i==null||i==="http://www.w3.org/1999/xhtml"?K8(a):i==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var e3,Y8=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,p,y,T){MSApp.execUnsafeLocalFunction(function(){return i(a,p,y,T)})}:i}(function(i,a){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=a;else{for(e3=e3||document.createElement("div"),e3.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=e3.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;a.firstChild;)i.appendChild(a.firstChild)}});function y2(i,a){if(a){var p=i.firstChild;if(p&&p===i.lastChild&&p.nodeType===3){p.nodeValue=a;return}}i.textContent=a}var a2={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iw=["Webkit","ms","Moz","O"];Object.keys(a2).forEach(function(i){iw.forEach(function(a){a=a+i.charAt(0).toUpperCase()+i.substring(1),a2[a]=a2[i]})});function J8(i,a,p){return a==null||typeof a=="boolean"||a===""?"":p||typeof a!="number"||a===0||a2.hasOwnProperty(i)&&a2[i]?(""+a).trim():a+"px"}function Q8(i,a){i=i.style;for(var p in a)if(a.hasOwnProperty(p)){var y=p.indexOf("--")===0,T=J8(p,a[p],y);p==="float"&&(p="cssFloat"),y?i.setProperty(p,T):i[p]=T}}var rw=qo({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function g6(i,a){if(a){if(rw[i]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(Ri(137,i));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(Ri(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(Ri(61))}if(a.style!=null&&typeof a.style!="object")throw Error(Ri(62))}}function y6(i,a){if(i.indexOf("-")===-1)return typeof a.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var x6=null;function b_(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var v6=null,v0=null,b0=null;function k7(i){if(i=G2(i)){if(typeof v6!="function")throw Error(Ri(280));var a=i.stateNode;a&&(a=T5(a),v6(i.stateNode,i.type,a))}}function e9(i){v0?b0?b0.push(i):b0=[i]:v0=i}function t9(){if(v0){var i=v0,a=b0;if(b0=v0=null,k7(i),a)for(i=0;i<a.length;i++)k7(a[i])}}function i9(i,a){return i(a)}function r9(){}var A4=!1;function n9(i,a,p){if(A4)return i(a,p);A4=!0;try{return i9(i,a,p)}finally{A4=!1,(v0!==null||b0!==null)&&(r9(),t9())}}function x2(i,a){var p=i.stateNode;if(p===null)return null;var y=T5(p);if(y===null)return null;p=y[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(i=i.type,y=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!y;break e;default:i=!1}if(i)return null;if(p&&typeof p!="function")throw Error(Ri(231,a,typeof p));return p}var b6=!1;if(a1)try{var Gf={};Object.defineProperty(Gf,"passive",{get:function(){b6=!0}}),window.addEventListener("test",Gf,Gf),window.removeEventListener("test",Gf,Gf)}catch{b6=!1}function nw(i,a,p,y,T,P,F,t,j){var ie=Array.prototype.slice.call(arguments,3);try{a.apply(p,ie)}catch(ye){this.onError(ye)}}var l2=!1,B3=null,F3=!1,w6=null,ow={onError:function(i){l2=!0,B3=i}};function sw(i,a,p,y,T,P,F,t,j){l2=!1,B3=null,nw.apply(ow,arguments)}function aw(i,a,p,y,T,P,F,t,j){if(sw.apply(this,arguments),l2){if(l2){var ie=B3;l2=!1,B3=null}else throw Error(Ri(198));F3||(F3=!0,w6=ie)}}function dp(i){var a=i,p=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,a.flags&4098&&(p=a.return),i=a.return;while(i)}return a.tag===3?p:null}function o9(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function z7(i){if(dp(i)!==i)throw Error(Ri(188))}function lw(i){var a=i.alternate;if(!a){if(a=dp(i),a===null)throw Error(Ri(188));return a!==i?null:i}for(var p=i,y=a;;){var T=p.return;if(T===null)break;var P=T.alternate;if(P===null){if(y=T.return,y!==null){p=y;continue}break}if(T.child===P.child){for(P=T.child;P;){if(P===p)return z7(T),i;if(P===y)return z7(T),a;P=P.sibling}throw Error(Ri(188))}if(p.return!==y.return)p=T,y=P;else{for(var F=!1,t=T.child;t;){if(t===p){F=!0,p=T,y=P;break}if(t===y){F=!0,y=T,p=P;break}t=t.sibling}if(!F){for(t=P.child;t;){if(t===p){F=!0,p=P,y=T;break}if(t===y){F=!0,y=P,p=T;break}t=t.sibling}if(!F)throw Error(Ri(189))}}if(p.alternate!==y)throw Error(Ri(190))}if(p.tag!==3)throw Error(Ri(188));return p.stateNode.current===p?i:a}function s9(i){return i=lw(i),i!==null?a9(i):null}function a9(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var a=a9(i);if(a!==null)return a;i=i.sibling}return null}var l9=vc.unstable_scheduleCallback,D7=vc.unstable_cancelCallback,cw=vc.unstable_shouldYield,uw=vc.unstable_requestPaint,_s=vc.unstable_now,hw=vc.unstable_getCurrentPriorityLevel,w_=vc.unstable_ImmediatePriority,c9=vc.unstable_UserBlockingPriority,O3=vc.unstable_NormalPriority,dw=vc.unstable_LowPriority,u9=vc.unstable_IdlePriority,x5=null,bh=null;function pw(i){if(bh&&typeof bh.onCommitFiberRoot=="function")try{bh.onCommitFiberRoot(x5,i,void 0,(i.current.flags&128)===128)}catch{}}var Ru=Math.clz32?Math.clz32:_w,fw=Math.log,mw=Math.LN2;function _w(i){return i>>>=0,i===0?32:31-(fw(i)/mw|0)|0}var t3=64,i3=4194304;function r2(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function U3(i,a){var p=i.pendingLanes;if(p===0)return 0;var y=0,T=i.suspendedLanes,P=i.pingedLanes,F=p&268435455;if(F!==0){var t=F&~T;t!==0?y=r2(t):(P&=F,P!==0&&(y=r2(P)))}else F=p&~T,F!==0?y=r2(F):P!==0&&(y=r2(P));if(y===0)return 0;if(a!==0&&a!==y&&!(a&T)&&(T=y&-y,P=a&-a,T>=P||T===16&&(P&4194240)!==0))return a;if(y&4&&(y|=p&16),a=i.entangledLanes,a!==0)for(i=i.entanglements,a&=y;0<a;)p=31-Ru(a),T=1<<p,y|=i[p],a&=~T;return y}function gw(i,a){switch(i){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yw(i,a){for(var p=i.suspendedLanes,y=i.pingedLanes,T=i.expirationTimes,P=i.pendingLanes;0<P;){var F=31-Ru(P),t=1<<F,j=T[F];j===-1?(!(t&p)||t&y)&&(T[F]=gw(t,a)):j<=a&&(i.expiredLanes|=t),P&=~t}}function T6(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function h9(){var i=t3;return t3<<=1,!(t3&4194240)&&(t3=64),i}function P4(i){for(var a=[],p=0;31>p;p++)a.push(i);return a}function V2(i,a,p){i.pendingLanes|=a,a!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,a=31-Ru(a),i[a]=p}function xw(i,a){var p=i.pendingLanes&~a;i.pendingLanes=a,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=a,i.mutableReadLanes&=a,i.entangledLanes&=a,a=i.entanglements;var y=i.eventTimes;for(i=i.expirationTimes;0<p;){var T=31-Ru(p),P=1<<T;a[T]=0,y[T]=-1,i[T]=-1,p&=~P}}function T_(i,a){var p=i.entangledLanes|=a;for(i=i.entanglements;p;){var y=31-Ru(p),T=1<<y;T&a|i[y]&a&&(i[y]|=a),p&=~T}}var Qn=0;function d9(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var p9,E_,f9,m9,_9,E6=!1,r3=[],sd=null,ad=null,ld=null,v2=new Map,b2=new Map,td=[],vw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function L7(i,a){switch(i){case"focusin":case"focusout":sd=null;break;case"dragenter":case"dragleave":ad=null;break;case"mouseover":case"mouseout":ld=null;break;case"pointerover":case"pointerout":v2.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":b2.delete(a.pointerId)}}function $f(i,a,p,y,T,P){return i===null||i.nativeEvent!==P?(i={blockedOn:a,domEventName:p,eventSystemFlags:y,nativeEvent:P,targetContainers:[T]},a!==null&&(a=G2(a),a!==null&&E_(a)),i):(i.eventSystemFlags|=y,a=i.targetContainers,T!==null&&a.indexOf(T)===-1&&a.push(T),i)}function bw(i,a,p,y,T){switch(a){case"focusin":return sd=$f(sd,i,a,p,y,T),!0;case"dragenter":return ad=$f(ad,i,a,p,y,T),!0;case"mouseover":return ld=$f(ld,i,a,p,y,T),!0;case"pointerover":var P=T.pointerId;return v2.set(P,$f(v2.get(P)||null,i,a,p,y,T)),!0;case"gotpointercapture":return P=T.pointerId,b2.set(P,$f(b2.get(P)||null,i,a,p,y,T)),!0}return!1}function g9(i){var a=Qd(i.target);if(a!==null){var p=dp(a);if(p!==null){if(a=p.tag,a===13){if(a=o9(p),a!==null){i.blockedOn=a,_9(i.priority,function(){f9(p)});return}}else if(a===3&&p.stateNode.current.memoizedState.isDehydrated){i.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}i.blockedOn=null}function b3(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var p=S6(i.domEventName,i.eventSystemFlags,a[0],i.nativeEvent);if(p===null){p=i.nativeEvent;var y=new p.constructor(p.type,p);x6=y,p.target.dispatchEvent(y),x6=null}else return a=G2(p),a!==null&&E_(a),i.blockedOn=p,!1;a.shift()}return!0}function R7(i,a,p){b3(i)&&p.delete(a)}function ww(){E6=!1,sd!==null&&b3(sd)&&(sd=null),ad!==null&&b3(ad)&&(ad=null),ld!==null&&b3(ld)&&(ld=null),v2.forEach(R7),b2.forEach(R7)}function Zf(i,a){i.blockedOn===a&&(i.blockedOn=null,E6||(E6=!0,vc.unstable_scheduleCallback(vc.unstable_NormalPriority,ww)))}function w2(i){function a(T){return Zf(T,i)}if(0<r3.length){Zf(r3[0],i);for(var p=1;p<r3.length;p++){var y=r3[p];y.blockedOn===i&&(y.blockedOn=null)}}for(sd!==null&&Zf(sd,i),ad!==null&&Zf(ad,i),ld!==null&&Zf(ld,i),v2.forEach(a),b2.forEach(a),p=0;p<td.length;p++)y=td[p],y.blockedOn===i&&(y.blockedOn=null);for(;0<td.length&&(p=td[0],p.blockedOn===null);)g9(p),p.blockedOn===null&&td.shift()}var w0=h1.ReactCurrentBatchConfig,N3=!0;function Tw(i,a,p,y){var T=Qn,P=w0.transition;w0.transition=null;try{Qn=1,S_(i,a,p,y)}finally{Qn=T,w0.transition=P}}function Ew(i,a,p,y){var T=Qn,P=w0.transition;w0.transition=null;try{Qn=4,S_(i,a,p,y)}finally{Qn=T,w0.transition=P}}function S_(i,a,p,y){if(N3){var T=S6(i,a,p,y);if(T===null)N4(i,a,y,V3,p),L7(i,y);else if(bw(T,i,a,p,y))y.stopPropagation();else if(L7(i,y),a&4&&-1<vw.indexOf(i)){for(;T!==null;){var P=G2(T);if(P!==null&&p9(P),P=S6(i,a,p,y),P===null&&N4(i,a,y,V3,p),P===T)break;T=P}T!==null&&y.stopPropagation()}else N4(i,a,y,null,p)}}var V3=null;function S6(i,a,p,y){if(V3=null,i=b_(y),i=Qd(i),i!==null)if(a=dp(i),a===null)i=null;else if(p=a.tag,p===13){if(i=o9(a),i!==null)return i;i=null}else if(p===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null);return V3=i,null}function y9(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hw()){case w_:return 1;case c9:return 4;case O3:case dw:return 16;case u9:return 536870912;default:return 16}default:return 16}}var rd=null,M_=null,w3=null;function x9(){if(w3)return w3;var i,a=M_,p=a.length,y,T="value"in rd?rd.value:rd.textContent,P=T.length;for(i=0;i<p&&a[i]===T[i];i++);var F=p-i;for(y=1;y<=F&&a[p-y]===T[P-y];y++);return w3=T.slice(i,1<y?1-y:void 0)}function T3(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function n3(){return!0}function B7(){return!1}function wc(i){function a(p,y,T,P,F){this._reactName=p,this._targetInst=T,this.type=y,this.nativeEvent=P,this.target=F,this.currentTarget=null;for(var t in i)i.hasOwnProperty(t)&&(p=i[t],this[t]=p?p(P):P[t]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?n3:B7,this.isPropagationStopped=B7,this}return qo(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=n3)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=n3)},persist:function(){},isPersistent:n3}),a}var V0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},C_=wc(V0),j2=qo({},V0,{view:0,detail:0}),Sw=wc(j2),k4,z4,qf,v5=qo({},j2,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:I_,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==qf&&(qf&&i.type==="mousemove"?(k4=i.screenX-qf.screenX,z4=i.screenY-qf.screenY):z4=k4=0,qf=i),k4)},movementY:function(i){return"movementY"in i?i.movementY:z4}}),F7=wc(v5),Mw=qo({},v5,{dataTransfer:0}),Cw=wc(Mw),Iw=qo({},j2,{relatedTarget:0}),D4=wc(Iw),Aw=qo({},V0,{animationName:0,elapsedTime:0,pseudoElement:0}),Pw=wc(Aw),kw=qo({},V0,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),zw=wc(kw),Dw=qo({},V0,{data:0}),O7=wc(Dw),Lw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fw(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=Bw[i])?!!a[i]:!1}function I_(){return Fw}var Ow=qo({},j2,{key:function(i){if(i.key){var a=Lw[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=T3(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Rw[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:I_,charCode:function(i){return i.type==="keypress"?T3(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?T3(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Uw=wc(Ow),Nw=qo({},v5,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),U7=wc(Nw),Vw=qo({},j2,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:I_}),jw=wc(Vw),Gw=qo({},V0,{propertyName:0,elapsedTime:0,pseudoElement:0}),$w=wc(Gw),Zw=qo({},v5,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),qw=wc(Zw),Ww=[9,13,27,32],A_=a1&&"CompositionEvent"in window,c2=null;a1&&"documentMode"in document&&(c2=document.documentMode);var Xw=a1&&"TextEvent"in window&&!c2,v9=a1&&(!A_||c2&&8<c2&&11>=c2),N7=String.fromCharCode(32),V7=!1;function b9(i,a){switch(i){case"keyup":return Ww.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function w9(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var l0=!1;function Hw(i,a){switch(i){case"compositionend":return w9(a);case"keypress":return a.which!==32?null:(V7=!0,N7);case"textInput":return i=a.data,i===N7&&V7?null:i;default:return null}}function Kw(i,a){if(l0)return i==="compositionend"||!A_&&b9(i,a)?(i=x9(),w3=M_=rd=null,l0=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return v9&&a.locale!=="ko"?null:a.data;default:return null}}var Yw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j7(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!Yw[i.type]:a==="textarea"}function T9(i,a,p,y){e9(y),a=j3(a,"onChange"),0<a.length&&(p=new C_("onChange","change",null,p,y),i.push({event:p,listeners:a}))}var u2=null,T2=null;function Jw(i){L9(i,0)}function b5(i){var a=h0(i);if(W8(a))return i}function Qw(i,a){if(i==="change")return a}var E9=!1;if(a1){var L4;if(a1){var R4="oninput"in document;if(!R4){var G7=document.createElement("div");G7.setAttribute("oninput","return;"),R4=typeof G7.oninput=="function"}L4=R4}else L4=!1;E9=L4&&(!document.documentMode||9<document.documentMode)}function $7(){u2&&(u2.detachEvent("onpropertychange",S9),T2=u2=null)}function S9(i){if(i.propertyName==="value"&&b5(T2)){var a=[];T9(a,T2,i,b_(i)),n9(Jw,a)}}function eT(i,a,p){i==="focusin"?($7(),u2=a,T2=p,u2.attachEvent("onpropertychange",S9)):i==="focusout"&&$7()}function tT(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return b5(T2)}function iT(i,a){if(i==="click")return b5(a)}function rT(i,a){if(i==="input"||i==="change")return b5(a)}function nT(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Fu=typeof Object.is=="function"?Object.is:nT;function E2(i,a){if(Fu(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var p=Object.keys(i),y=Object.keys(a);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var T=p[y];if(!a6.call(a,T)||!Fu(i[T],a[T]))return!1}return!0}function Z7(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function q7(i,a){var p=Z7(i);i=0;for(var y;p;){if(p.nodeType===3){if(y=i+p.textContent.length,i<=a&&y>=a)return{node:p,offset:a-i};i=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Z7(p)}}function M9(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?M9(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function C9(){for(var i=window,a=R3();a instanceof i.HTMLIFrameElement;){try{var p=typeof a.contentWindow.location.href=="string"}catch{p=!1}if(p)i=a.contentWindow;else break;a=R3(i.document)}return a}function P_(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}function oT(i){var a=C9(),p=i.focusedElem,y=i.selectionRange;if(a!==p&&p&&p.ownerDocument&&M9(p.ownerDocument.documentElement,p)){if(y!==null&&P_(p)){if(a=y.start,i=y.end,i===void 0&&(i=a),"selectionStart"in p)p.selectionStart=a,p.selectionEnd=Math.min(i,p.value.length);else if(i=(a=p.ownerDocument||document)&&a.defaultView||window,i.getSelection){i=i.getSelection();var T=p.textContent.length,P=Math.min(y.start,T);y=y.end===void 0?P:Math.min(y.end,T),!i.extend&&P>y&&(T=y,y=P,P=T),T=q7(p,P);var F=q7(p,y);T&&F&&(i.rangeCount!==1||i.anchorNode!==T.node||i.anchorOffset!==T.offset||i.focusNode!==F.node||i.focusOffset!==F.offset)&&(a=a.createRange(),a.setStart(T.node,T.offset),i.removeAllRanges(),P>y?(i.addRange(a),i.extend(F.node,F.offset)):(a.setEnd(F.node,F.offset),i.addRange(a)))}}for(a=[],i=p;i=i.parentNode;)i.nodeType===1&&a.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<a.length;p++)i=a[p],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var sT=a1&&"documentMode"in document&&11>=document.documentMode,c0=null,M6=null,h2=null,C6=!1;function W7(i,a,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;C6||c0==null||c0!==R3(y)||(y=c0,"selectionStart"in y&&P_(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),h2&&E2(h2,y)||(h2=y,y=j3(M6,"onSelect"),0<y.length&&(a=new C_("onSelect","select",null,a,p),i.push({event:a,listeners:y}),a.target=c0)))}function o3(i,a){var p={};return p[i.toLowerCase()]=a.toLowerCase(),p["Webkit"+i]="webkit"+a,p["Moz"+i]="moz"+a,p}var u0={animationend:o3("Animation","AnimationEnd"),animationiteration:o3("Animation","AnimationIteration"),animationstart:o3("Animation","AnimationStart"),transitionend:o3("Transition","TransitionEnd")},B4={},I9={};a1&&(I9=document.createElement("div").style,"AnimationEvent"in window||(delete u0.animationend.animation,delete u0.animationiteration.animation,delete u0.animationstart.animation),"TransitionEvent"in window||delete u0.transitionend.transition);function w5(i){if(B4[i])return B4[i];if(!u0[i])return i;var a=u0[i],p;for(p in a)if(a.hasOwnProperty(p)&&p in I9)return B4[i]=a[p];return i}var A9=w5("animationend"),P9=w5("animationiteration"),k9=w5("animationstart"),z9=w5("transitionend"),D9=new Map,X7="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xd(i,a){D9.set(i,a),hp(a,[i])}for(var F4=0;F4<X7.length;F4++){var O4=X7[F4],aT=O4.toLowerCase(),lT=O4[0].toUpperCase()+O4.slice(1);xd(aT,"on"+lT)}xd(A9,"onAnimationEnd");xd(P9,"onAnimationIteration");xd(k9,"onAnimationStart");xd("dblclick","onDoubleClick");xd("focusin","onFocus");xd("focusout","onBlur");xd(z9,"onTransitionEnd");I0("onMouseEnter",["mouseout","mouseover"]);I0("onMouseLeave",["mouseout","mouseover"]);I0("onPointerEnter",["pointerout","pointerover"]);I0("onPointerLeave",["pointerout","pointerover"]);hp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hp("onBeforeInput",["compositionend","keypress","textInput","paste"]);hp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var n2="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cT=new Set("cancel close invalid load scroll toggle".split(" ").concat(n2));function H7(i,a,p){var y=i.type||"unknown-event";i.currentTarget=p,aw(y,a,void 0,i),i.currentTarget=null}function L9(i,a){a=(a&4)!==0;for(var p=0;p<i.length;p++){var y=i[p],T=y.event;y=y.listeners;e:{var P=void 0;if(a)for(var F=y.length-1;0<=F;F--){var t=y[F],j=t.instance,ie=t.currentTarget;if(t=t.listener,j!==P&&T.isPropagationStopped())break e;H7(T,t,ie),P=j}else for(F=0;F<y.length;F++){if(t=y[F],j=t.instance,ie=t.currentTarget,t=t.listener,j!==P&&T.isPropagationStopped())break e;H7(T,t,ie),P=j}}}if(F3)throw i=w6,F3=!1,w6=null,i}function wo(i,a){var p=a[z6];p===void 0&&(p=a[z6]=new Set);var y=i+"__bubble";p.has(y)||(R9(a,i,2,!1),p.add(y))}function U4(i,a,p){var y=0;a&&(y|=4),R9(p,i,y,a)}var s3="_reactListening"+Math.random().toString(36).slice(2);function S2(i){if(!i[s3]){i[s3]=!0,j8.forEach(function(p){p!=="selectionchange"&&(cT.has(p)||U4(p,!1,i),U4(p,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[s3]||(a[s3]=!0,U4("selectionchange",!1,a))}}function R9(i,a,p,y){switch(y9(a)){case 1:var T=Tw;break;case 4:T=Ew;break;default:T=S_}p=T.bind(null,a,p,i),T=void 0,!b6||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(T=!0),y?T!==void 0?i.addEventListener(a,p,{capture:!0,passive:T}):i.addEventListener(a,p,!0):T!==void 0?i.addEventListener(a,p,{passive:T}):i.addEventListener(a,p,!1)}function N4(i,a,p,y,T){var P=y;if(!(a&1)&&!(a&2)&&y!==null)e:for(;;){if(y===null)return;var F=y.tag;if(F===3||F===4){var t=y.stateNode.containerInfo;if(t===T||t.nodeType===8&&t.parentNode===T)break;if(F===4)for(F=y.return;F!==null;){var j=F.tag;if((j===3||j===4)&&(j=F.stateNode.containerInfo,j===T||j.nodeType===8&&j.parentNode===T))return;F=F.return}for(;t!==null;){if(F=Qd(t),F===null)return;if(j=F.tag,j===5||j===6){y=P=F;continue e}t=t.parentNode}}y=y.return}n9(function(){var ie=P,ye=b_(p),he=[];e:{var ne=D9.get(i);if(ne!==void 0){var Ye=C_,lt=i;switch(i){case"keypress":if(T3(p)===0)break e;case"keydown":case"keyup":Ye=Uw;break;case"focusin":lt="focus",Ye=D4;break;case"focusout":lt="blur",Ye=D4;break;case"beforeblur":case"afterblur":Ye=D4;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ye=F7;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ye=Cw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ye=jw;break;case A9:case P9:case k9:Ye=Pw;break;case z9:Ye=$w;break;case"scroll":Ye=Sw;break;case"wheel":Ye=qw;break;case"copy":case"cut":case"paste":Ye=zw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ye=U7}var at=(a&4)!==0,Kt=!at&&i==="scroll",Ne=at?ne!==null?ne+"Capture":null:ne;at=[];for(var Le=ie,je;Le!==null;){je=Le;var _t=je.stateNode;if(je.tag===5&&_t!==null&&(je=_t,Ne!==null&&(_t=x2(Le,Ne),_t!=null&&at.push(M2(Le,_t,je)))),Kt)break;Le=Le.return}0<at.length&&(ne=new Ye(ne,lt,null,p,ye),he.push({event:ne,listeners:at}))}}if(!(a&7)){e:{if(ne=i==="mouseover"||i==="pointerover",Ye=i==="mouseout"||i==="pointerout",ne&&p!==x6&&(lt=p.relatedTarget||p.fromElement)&&(Qd(lt)||lt[l1]))break e;if((Ye||ne)&&(ne=ye.window===ye?ye:(ne=ye.ownerDocument)?ne.defaultView||ne.parentWindow:window,Ye?(lt=p.relatedTarget||p.toElement,Ye=ie,lt=lt?Qd(lt):null,lt!==null&&(Kt=dp(lt),lt!==Kt||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(Ye=null,lt=ie),Ye!==lt)){if(at=F7,_t="onMouseLeave",Ne="onMouseEnter",Le="mouse",(i==="pointerout"||i==="pointerover")&&(at=U7,_t="onPointerLeave",Ne="onPointerEnter",Le="pointer"),Kt=Ye==null?ne:h0(Ye),je=lt==null?ne:h0(lt),ne=new at(_t,Le+"leave",Ye,p,ye),ne.target=Kt,ne.relatedTarget=je,_t=null,Qd(ye)===ie&&(at=new at(Ne,Le+"enter",lt,p,ye),at.target=je,at.relatedTarget=Kt,_t=at),Kt=_t,Ye&&lt)t:{for(at=Ye,Ne=lt,Le=0,je=at;je;je=Jp(je))Le++;for(je=0,_t=Ne;_t;_t=Jp(_t))je++;for(;0<Le-je;)at=Jp(at),Le--;for(;0<je-Le;)Ne=Jp(Ne),je--;for(;Le--;){if(at===Ne||Ne!==null&&at===Ne.alternate)break t;at=Jp(at),Ne=Jp(Ne)}at=null}else at=null;Ye!==null&&K7(he,ne,Ye,at,!1),lt!==null&&Kt!==null&&K7(he,Kt,lt,at,!0)}}e:{if(ne=ie?h0(ie):window,Ye=ne.nodeName&&ne.nodeName.toLowerCase(),Ye==="select"||Ye==="input"&&ne.type==="file")var St=Qw;else if(j7(ne))if(E9)St=rT;else{St=tT;var ci=eT}else(Ye=ne.nodeName)&&Ye.toLowerCase()==="input"&&(ne.type==="checkbox"||ne.type==="radio")&&(St=iT);if(St&&(St=St(i,ie))){T9(he,St,p,ye);break e}ci&&ci(i,ne,ie),i==="focusout"&&(ci=ne._wrapperState)&&ci.controlled&&ne.type==="number"&&f6(ne,"number",ne.value)}switch(ci=ie?h0(ie):window,i){case"focusin":(j7(ci)||ci.contentEditable==="true")&&(c0=ci,M6=ie,h2=null);break;case"focusout":h2=M6=c0=null;break;case"mousedown":C6=!0;break;case"contextmenu":case"mouseup":case"dragend":C6=!1,W7(he,p,ye);break;case"selectionchange":if(sT)break;case"keydown":case"keyup":W7(he,p,ye)}var dt;if(A_)e:{switch(i){case"compositionstart":var ri="onCompositionStart";break e;case"compositionend":ri="onCompositionEnd";break e;case"compositionupdate":ri="onCompositionUpdate";break e}ri=void 0}else l0?b9(i,p)&&(ri="onCompositionEnd"):i==="keydown"&&p.keyCode===229&&(ri="onCompositionStart");ri&&(v9&&p.locale!=="ko"&&(l0||ri!=="onCompositionStart"?ri==="onCompositionEnd"&&l0&&(dt=x9()):(rd=ye,M_="value"in rd?rd.value:rd.textContent,l0=!0)),ci=j3(ie,ri),0<ci.length&&(ri=new O7(ri,i,null,p,ye),he.push({event:ri,listeners:ci}),dt?ri.data=dt:(dt=w9(p),dt!==null&&(ri.data=dt)))),(dt=Xw?Hw(i,p):Kw(i,p))&&(ie=j3(ie,"onBeforeInput"),0<ie.length&&(ye=new O7("onBeforeInput","beforeinput",null,p,ye),he.push({event:ye,listeners:ie}),ye.data=dt))}L9(he,a)})}function M2(i,a,p){return{instance:i,listener:a,currentTarget:p}}function j3(i,a){for(var p=a+"Capture",y=[];i!==null;){var T=i,P=T.stateNode;T.tag===5&&P!==null&&(T=P,P=x2(i,p),P!=null&&y.unshift(M2(i,P,T)),P=x2(i,a),P!=null&&y.push(M2(i,P,T))),i=i.return}return y}function Jp(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function K7(i,a,p,y,T){for(var P=a._reactName,F=[];p!==null&&p!==y;){var t=p,j=t.alternate,ie=t.stateNode;if(j!==null&&j===y)break;t.tag===5&&ie!==null&&(t=ie,T?(j=x2(p,P),j!=null&&F.unshift(M2(p,j,t))):T||(j=x2(p,P),j!=null&&F.push(M2(p,j,t)))),p=p.return}F.length!==0&&i.push({event:a,listeners:F})}var uT=/\r\n?/g,hT=/\u0000|\uFFFD/g;function Y7(i){return(typeof i=="string"?i:""+i).replace(uT,`
`).replace(hT,"")}function a3(i,a,p){if(a=Y7(a),Y7(i)!==a&&p)throw Error(Ri(425))}function G3(){}var I6=null,A6=null;function P6(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var k6=typeof setTimeout=="function"?setTimeout:void 0,dT=typeof clearTimeout=="function"?clearTimeout:void 0,J7=typeof Promise=="function"?Promise:void 0,pT=typeof queueMicrotask=="function"?queueMicrotask:typeof J7<"u"?function(i){return J7.resolve(null).then(i).catch(fT)}:k6;function fT(i){setTimeout(function(){throw i})}function V4(i,a){var p=a,y=0;do{var T=p.nextSibling;if(i.removeChild(p),T&&T.nodeType===8)if(p=T.data,p==="/$"){if(y===0){i.removeChild(T),w2(a);return}y--}else p!=="$"&&p!=="$?"&&p!=="$!"||y++;p=T}while(p);w2(a)}function cd(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return i}function Q7(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var p=i.data;if(p==="$"||p==="$!"||p==="$?"){if(a===0)return i;a--}else p==="/$"&&a++}i=i.previousSibling}return null}var j0=Math.random().toString(36).slice(2),vh="__reactFiber$"+j0,C2="__reactProps$"+j0,l1="__reactContainer$"+j0,z6="__reactEvents$"+j0,mT="__reactListeners$"+j0,_T="__reactHandles$"+j0;function Qd(i){var a=i[vh];if(a)return a;for(var p=i.parentNode;p;){if(a=p[l1]||p[vh]){if(p=a.alternate,a.child!==null||p!==null&&p.child!==null)for(i=Q7(i);i!==null;){if(p=i[vh])return p;i=Q7(i)}return a}i=p,p=i.parentNode}return null}function G2(i){return i=i[vh]||i[l1],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function h0(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Ri(33))}function T5(i){return i[C2]||null}var D6=[],d0=-1;function vd(i){return{current:i}}function To(i){0>d0||(i.current=D6[d0],D6[d0]=null,d0--)}function fo(i,a){d0++,D6[d0]=i.current,i.current=a}var _d={},Ua=vd(_d),Vl=vd(!1),op=_d;function A0(i,a){var p=i.type.contextTypes;if(!p)return _d;var y=i.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===a)return y.__reactInternalMemoizedMaskedChildContext;var T={},P;for(P in p)T[P]=a[P];return y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=a,i.__reactInternalMemoizedMaskedChildContext=T),T}function jl(i){return i=i.childContextTypes,i!=null}function $3(){To(Vl),To(Ua)}function ey(i,a,p){if(Ua.current!==_d)throw Error(Ri(168));fo(Ua,a),fo(Vl,p)}function B9(i,a,p){var y=i.stateNode;if(a=a.childContextTypes,typeof y.getChildContext!="function")return p;y=y.getChildContext();for(var T in y)if(!(T in a))throw Error(Ri(108,ew(i)||"Unknown",T));return qo({},p,y)}function Z3(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||_d,op=Ua.current,fo(Ua,i),fo(Vl,Vl.current),!0}function ty(i,a,p){var y=i.stateNode;if(!y)throw Error(Ri(169));p?(i=B9(i,a,op),y.__reactInternalMemoizedMergedChildContext=i,To(Vl),To(Ua),fo(Ua,i)):To(Vl),fo(Vl,p)}var t1=null,E5=!1,j4=!1;function F9(i){t1===null?t1=[i]:t1.push(i)}function gT(i){E5=!0,F9(i)}function bd(){if(!j4&&t1!==null){j4=!0;var i=0,a=Qn;try{var p=t1;for(Qn=1;i<p.length;i++){var y=p[i];do y=y(!0);while(y!==null)}t1=null,E5=!1}catch(T){throw t1!==null&&(t1=t1.slice(i+1)),l9(w_,bd),T}finally{Qn=a,j4=!1}}return null}var p0=[],f0=0,q3=null,W3=0,Wc=[],Xc=0,sp=null,r1=1,n1="";function Hd(i,a){p0[f0++]=W3,p0[f0++]=q3,q3=i,W3=a}function O9(i,a,p){Wc[Xc++]=r1,Wc[Xc++]=n1,Wc[Xc++]=sp,sp=i;var y=r1;i=n1;var T=32-Ru(y)-1;y&=~(1<<T),p+=1;var P=32-Ru(a)+T;if(30<P){var F=T-T%5;P=(y&(1<<F)-1).toString(32),y>>=F,T-=F,r1=1<<32-Ru(a)+T|p<<T|y,n1=P+i}else r1=1<<P|p<<T|y,n1=i}function k_(i){i.return!==null&&(Hd(i,1),O9(i,1,0))}function z_(i){for(;i===q3;)q3=p0[--f0],p0[f0]=null,W3=p0[--f0],p0[f0]=null;for(;i===sp;)sp=Wc[--Xc],Wc[Xc]=null,n1=Wc[--Xc],Wc[Xc]=null,r1=Wc[--Xc],Wc[Xc]=null}var xc=null,yc=null,Co=!1,Du=null;function U9(i,a){var p=Hc(5,null,null,0);p.elementType="DELETED",p.stateNode=a,p.return=i,a=i.deletions,a===null?(i.deletions=[p],i.flags|=16):a.push(p)}function iy(i,a){switch(i.tag){case 5:var p=i.type;return a=a.nodeType!==1||p.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(i.stateNode=a,xc=i,yc=cd(a.firstChild),!0):!1;case 6:return a=i.pendingProps===""||a.nodeType!==3?null:a,a!==null?(i.stateNode=a,xc=i,yc=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(p=sp!==null?{id:r1,overflow:n1}:null,i.memoizedState={dehydrated:a,treeContext:p,retryLane:1073741824},p=Hc(18,null,null,0),p.stateNode=a,p.return=i,i.child=p,xc=i,yc=null,!0):!1;default:return!1}}function L6(i){return(i.mode&1)!==0&&(i.flags&128)===0}function R6(i){if(Co){var a=yc;if(a){var p=a;if(!iy(i,a)){if(L6(i))throw Error(Ri(418));a=cd(p.nextSibling);var y=xc;a&&iy(i,a)?U9(y,p):(i.flags=i.flags&-4097|2,Co=!1,xc=i)}}else{if(L6(i))throw Error(Ri(418));i.flags=i.flags&-4097|2,Co=!1,xc=i}}}function ry(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;xc=i}function l3(i){if(i!==xc)return!1;if(!Co)return ry(i),Co=!0,!1;var a;if((a=i.tag!==3)&&!(a=i.tag!==5)&&(a=i.type,a=a!=="head"&&a!=="body"&&!P6(i.type,i.memoizedProps)),a&&(a=yc)){if(L6(i))throw N9(),Error(Ri(418));for(;a;)U9(i,a),a=cd(a.nextSibling)}if(ry(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ri(317));e:{for(i=i.nextSibling,a=0;i;){if(i.nodeType===8){var p=i.data;if(p==="/$"){if(a===0){yc=cd(i.nextSibling);break e}a--}else p!=="$"&&p!=="$!"&&p!=="$?"||a++}i=i.nextSibling}yc=null}}else yc=xc?cd(i.stateNode.nextSibling):null;return!0}function N9(){for(var i=yc;i;)i=cd(i.nextSibling)}function P0(){yc=xc=null,Co=!1}function D_(i){Du===null?Du=[i]:Du.push(i)}var yT=h1.ReactCurrentBatchConfig;function Wf(i,a,p){if(i=p.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(Ri(309));var y=p.stateNode}if(!y)throw Error(Ri(147,i));var T=y,P=""+i;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===P?a.ref:(a=function(F){var t=T.refs;F===null?delete t[P]:t[P]=F},a._stringRef=P,a)}if(typeof i!="string")throw Error(Ri(284));if(!p._owner)throw Error(Ri(290,i))}return i}function c3(i,a){throw i=Object.prototype.toString.call(a),Error(Ri(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i))}function ny(i){var a=i._init;return a(i._payload)}function V9(i){function a(Ne,Le){if(i){var je=Ne.deletions;je===null?(Ne.deletions=[Le],Ne.flags|=16):je.push(Le)}}function p(Ne,Le){if(!i)return null;for(;Le!==null;)a(Ne,Le),Le=Le.sibling;return null}function y(Ne,Le){for(Ne=new Map;Le!==null;)Le.key!==null?Ne.set(Le.key,Le):Ne.set(Le.index,Le),Le=Le.sibling;return Ne}function T(Ne,Le){return Ne=pd(Ne,Le),Ne.index=0,Ne.sibling=null,Ne}function P(Ne,Le,je){return Ne.index=je,i?(je=Ne.alternate,je!==null?(je=je.index,je<Le?(Ne.flags|=2,Le):je):(Ne.flags|=2,Le)):(Ne.flags|=1048576,Le)}function F(Ne){return i&&Ne.alternate===null&&(Ne.flags|=2),Ne}function t(Ne,Le,je,_t){return Le===null||Le.tag!==6?(Le=H4(je,Ne.mode,_t),Le.return=Ne,Le):(Le=T(Le,je),Le.return=Ne,Le)}function j(Ne,Le,je,_t){var St=je.type;return St===a0?ye(Ne,Le,je.props.children,_t,je.key):Le!==null&&(Le.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===Q1&&ny(St)===Le.type)?(_t=T(Le,je.props),_t.ref=Wf(Ne,Le,je),_t.return=Ne,_t):(_t=P3(je.type,je.key,je.props,null,Ne.mode,_t),_t.ref=Wf(Ne,Le,je),_t.return=Ne,_t)}function ie(Ne,Le,je,_t){return Le===null||Le.tag!==4||Le.stateNode.containerInfo!==je.containerInfo||Le.stateNode.implementation!==je.implementation?(Le=K4(je,Ne.mode,_t),Le.return=Ne,Le):(Le=T(Le,je.children||[]),Le.return=Ne,Le)}function ye(Ne,Le,je,_t,St){return Le===null||Le.tag!==7?(Le=np(je,Ne.mode,_t,St),Le.return=Ne,Le):(Le=T(Le,je),Le.return=Ne,Le)}function he(Ne,Le,je){if(typeof Le=="string"&&Le!==""||typeof Le=="number")return Le=H4(""+Le,Ne.mode,je),Le.return=Ne,Le;if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case Jm:return je=P3(Le.type,Le.key,Le.props,null,Ne.mode,je),je.ref=Wf(Ne,null,Le),je.return=Ne,je;case s0:return Le=K4(Le,Ne.mode,je),Le.return=Ne,Le;case Q1:var _t=Le._init;return he(Ne,_t(Le._payload),je)}if(i2(Le)||jf(Le))return Le=np(Le,Ne.mode,je,null),Le.return=Ne,Le;c3(Ne,Le)}return null}function ne(Ne,Le,je,_t){var St=Le!==null?Le.key:null;if(typeof je=="string"&&je!==""||typeof je=="number")return St!==null?null:t(Ne,Le,""+je,_t);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case Jm:return je.key===St?j(Ne,Le,je,_t):null;case s0:return je.key===St?ie(Ne,Le,je,_t):null;case Q1:return St=je._init,ne(Ne,Le,St(je._payload),_t)}if(i2(je)||jf(je))return St!==null?null:ye(Ne,Le,je,_t,null);c3(Ne,je)}return null}function Ye(Ne,Le,je,_t,St){if(typeof _t=="string"&&_t!==""||typeof _t=="number")return Ne=Ne.get(je)||null,t(Le,Ne,""+_t,St);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case Jm:return Ne=Ne.get(_t.key===null?je:_t.key)||null,j(Le,Ne,_t,St);case s0:return Ne=Ne.get(_t.key===null?je:_t.key)||null,ie(Le,Ne,_t,St);case Q1:var ci=_t._init;return Ye(Ne,Le,je,ci(_t._payload),St)}if(i2(_t)||jf(_t))return Ne=Ne.get(je)||null,ye(Le,Ne,_t,St,null);c3(Le,_t)}return null}function lt(Ne,Le,je,_t){for(var St=null,ci=null,dt=Le,ri=Le=0,zt=null;dt!==null&&ri<je.length;ri++){dt.index>ri?(zt=dt,dt=null):zt=dt.sibling;var Ci=ne(Ne,dt,je[ri],_t);if(Ci===null){dt===null&&(dt=zt);break}i&&dt&&Ci.alternate===null&&a(Ne,dt),Le=P(Ci,Le,ri),ci===null?St=Ci:ci.sibling=Ci,ci=Ci,dt=zt}if(ri===je.length)return p(Ne,dt),Co&&Hd(Ne,ri),St;if(dt===null){for(;ri<je.length;ri++)dt=he(Ne,je[ri],_t),dt!==null&&(Le=P(dt,Le,ri),ci===null?St=dt:ci.sibling=dt,ci=dt);return Co&&Hd(Ne,ri),St}for(dt=y(Ne,dt);ri<je.length;ri++)zt=Ye(dt,Ne,ri,je[ri],_t),zt!==null&&(i&&zt.alternate!==null&&dt.delete(zt.key===null?ri:zt.key),Le=P(zt,Le,ri),ci===null?St=zt:ci.sibling=zt,ci=zt);return i&&dt.forEach(function(yr){return a(Ne,yr)}),Co&&Hd(Ne,ri),St}function at(Ne,Le,je,_t){var St=jf(je);if(typeof St!="function")throw Error(Ri(150));if(je=St.call(je),je==null)throw Error(Ri(151));for(var ci=St=null,dt=Le,ri=Le=0,zt=null,Ci=je.next();dt!==null&&!Ci.done;ri++,Ci=je.next()){dt.index>ri?(zt=dt,dt=null):zt=dt.sibling;var yr=ne(Ne,dt,Ci.value,_t);if(yr===null){dt===null&&(dt=zt);break}i&&dt&&yr.alternate===null&&a(Ne,dt),Le=P(yr,Le,ri),ci===null?St=yr:ci.sibling=yr,ci=yr,dt=zt}if(Ci.done)return p(Ne,dt),Co&&Hd(Ne,ri),St;if(dt===null){for(;!Ci.done;ri++,Ci=je.next())Ci=he(Ne,Ci.value,_t),Ci!==null&&(Le=P(Ci,Le,ri),ci===null?St=Ci:ci.sibling=Ci,ci=Ci);return Co&&Hd(Ne,ri),St}for(dt=y(Ne,dt);!Ci.done;ri++,Ci=je.next())Ci=Ye(dt,Ne,ri,Ci.value,_t),Ci!==null&&(i&&Ci.alternate!==null&&dt.delete(Ci.key===null?ri:Ci.key),Le=P(Ci,Le,ri),ci===null?St=Ci:ci.sibling=Ci,ci=Ci);return i&&dt.forEach(function(ki){return a(Ne,ki)}),Co&&Hd(Ne,ri),St}function Kt(Ne,Le,je,_t){if(typeof je=="object"&&je!==null&&je.type===a0&&je.key===null&&(je=je.props.children),typeof je=="object"&&je!==null){switch(je.$$typeof){case Jm:e:{for(var St=je.key,ci=Le;ci!==null;){if(ci.key===St){if(St=je.type,St===a0){if(ci.tag===7){p(Ne,ci.sibling),Le=T(ci,je.props.children),Le.return=Ne,Ne=Le;break e}}else if(ci.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===Q1&&ny(St)===ci.type){p(Ne,ci.sibling),Le=T(ci,je.props),Le.ref=Wf(Ne,ci,je),Le.return=Ne,Ne=Le;break e}p(Ne,ci);break}else a(Ne,ci);ci=ci.sibling}je.type===a0?(Le=np(je.props.children,Ne.mode,_t,je.key),Le.return=Ne,Ne=Le):(_t=P3(je.type,je.key,je.props,null,Ne.mode,_t),_t.ref=Wf(Ne,Le,je),_t.return=Ne,Ne=_t)}return F(Ne);case s0:e:{for(ci=je.key;Le!==null;){if(Le.key===ci)if(Le.tag===4&&Le.stateNode.containerInfo===je.containerInfo&&Le.stateNode.implementation===je.implementation){p(Ne,Le.sibling),Le=T(Le,je.children||[]),Le.return=Ne,Ne=Le;break e}else{p(Ne,Le);break}else a(Ne,Le);Le=Le.sibling}Le=K4(je,Ne.mode,_t),Le.return=Ne,Ne=Le}return F(Ne);case Q1:return ci=je._init,Kt(Ne,Le,ci(je._payload),_t)}if(i2(je))return lt(Ne,Le,je,_t);if(jf(je))return at(Ne,Le,je,_t);c3(Ne,je)}return typeof je=="string"&&je!==""||typeof je=="number"?(je=""+je,Le!==null&&Le.tag===6?(p(Ne,Le.sibling),Le=T(Le,je),Le.return=Ne,Ne=Le):(p(Ne,Le),Le=H4(je,Ne.mode,_t),Le.return=Ne,Ne=Le),F(Ne)):p(Ne,Le)}return Kt}var k0=V9(!0),j9=V9(!1),X3=vd(null),H3=null,m0=null,L_=null;function R_(){L_=m0=H3=null}function B_(i){var a=X3.current;To(X3),i._currentValue=a}function B6(i,a,p){for(;i!==null;){var y=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,y!==null&&(y.childLanes|=a)):y!==null&&(y.childLanes&a)!==a&&(y.childLanes|=a),i===p)break;i=i.return}}function T0(i,a){H3=i,L_=m0=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&a&&(Nl=!0),i.firstContext=null)}function Jc(i){var a=i._currentValue;if(L_!==i)if(i={context:i,memoizedValue:a,next:null},m0===null){if(H3===null)throw Error(Ri(308));m0=i,H3.dependencies={lanes:0,firstContext:i}}else m0=m0.next=i;return a}var ep=null;function F_(i){ep===null?ep=[i]:ep.push(i)}function G9(i,a,p,y){var T=a.interleaved;return T===null?(p.next=p,F_(a)):(p.next=T.next,T.next=p),a.interleaved=p,c1(i,y)}function c1(i,a){i.lanes|=a;var p=i.alternate;for(p!==null&&(p.lanes|=a),p=i,i=i.return;i!==null;)i.childLanes|=a,p=i.alternate,p!==null&&(p.childLanes|=a),p=i,i=i.return;return p.tag===3?p.stateNode:null}var ed=!1;function O_(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $9(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function o1(i,a){return{eventTime:i,lane:a,tag:0,payload:null,callback:null,next:null}}function ud(i,a,p){var y=i.updateQueue;if(y===null)return null;if(y=y.shared,Rn&2){var T=y.pending;return T===null?a.next=a:(a.next=T.next,T.next=a),y.pending=a,c1(i,p)}return T=y.interleaved,T===null?(a.next=a,F_(y)):(a.next=T.next,T.next=a),y.interleaved=a,c1(i,p)}function E3(i,a,p){if(a=a.updateQueue,a!==null&&(a=a.shared,(p&4194240)!==0)){var y=a.lanes;y&=i.pendingLanes,p|=y,a.lanes=p,T_(i,p)}}function oy(i,a){var p=i.updateQueue,y=i.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var T=null,P=null;if(p=p.firstBaseUpdate,p!==null){do{var F={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};P===null?T=P=F:P=P.next=F,p=p.next}while(p!==null);P===null?T=P=a:P=P.next=a}else T=P=a;p={baseState:y.baseState,firstBaseUpdate:T,lastBaseUpdate:P,shared:y.shared,effects:y.effects},i.updateQueue=p;return}i=p.lastBaseUpdate,i===null?p.firstBaseUpdate=a:i.next=a,p.lastBaseUpdate=a}function K3(i,a,p,y){var T=i.updateQueue;ed=!1;var P=T.firstBaseUpdate,F=T.lastBaseUpdate,t=T.shared.pending;if(t!==null){T.shared.pending=null;var j=t,ie=j.next;j.next=null,F===null?P=ie:F.next=ie,F=j;var ye=i.alternate;ye!==null&&(ye=ye.updateQueue,t=ye.lastBaseUpdate,t!==F&&(t===null?ye.firstBaseUpdate=ie:t.next=ie,ye.lastBaseUpdate=j))}if(P!==null){var he=T.baseState;F=0,ye=ie=j=null,t=P;do{var ne=t.lane,Ye=t.eventTime;if((y&ne)===ne){ye!==null&&(ye=ye.next={eventTime:Ye,lane:0,tag:t.tag,payload:t.payload,callback:t.callback,next:null});e:{var lt=i,at=t;switch(ne=a,Ye=p,at.tag){case 1:if(lt=at.payload,typeof lt=="function"){he=lt.call(Ye,he,ne);break e}he=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=at.payload,ne=typeof lt=="function"?lt.call(Ye,he,ne):lt,ne==null)break e;he=qo({},he,ne);break e;case 2:ed=!0}}t.callback!==null&&t.lane!==0&&(i.flags|=64,ne=T.effects,ne===null?T.effects=[t]:ne.push(t))}else Ye={eventTime:Ye,lane:ne,tag:t.tag,payload:t.payload,callback:t.callback,next:null},ye===null?(ie=ye=Ye,j=he):ye=ye.next=Ye,F|=ne;if(t=t.next,t===null){if(t=T.shared.pending,t===null)break;ne=t,t=ne.next,ne.next=null,T.lastBaseUpdate=ne,T.shared.pending=null}}while(1);if(ye===null&&(j=he),T.baseState=j,T.firstBaseUpdate=ie,T.lastBaseUpdate=ye,a=T.shared.interleaved,a!==null){T=a;do F|=T.lane,T=T.next;while(T!==a)}else P===null&&(T.shared.lanes=0);lp|=F,i.lanes=F,i.memoizedState=he}}function sy(i,a,p){if(i=a.effects,a.effects=null,i!==null)for(a=0;a<i.length;a++){var y=i[a],T=y.callback;if(T!==null){if(y.callback=null,y=p,typeof T!="function")throw Error(Ri(191,T));T.call(y)}}}var $2={},wh=vd($2),I2=vd($2),A2=vd($2);function tp(i){if(i===$2)throw Error(Ri(174));return i}function U_(i,a){switch(fo(A2,a),fo(I2,i),fo(wh,$2),i=a.nodeType,i){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:_6(null,"");break;default:i=i===8?a.parentNode:a,a=i.namespaceURI||null,i=i.tagName,a=_6(a,i)}To(wh),fo(wh,a)}function z0(){To(wh),To(I2),To(A2)}function Z9(i){tp(A2.current);var a=tp(wh.current),p=_6(a,i.type);a!==p&&(fo(I2,i),fo(wh,p))}function N_(i){I2.current===i&&(To(wh),To(I2))}var $o=vd(0);function Y3(i){for(var a=i;a!==null;){if(a.tag===13){var p=a.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var G4=[];function V_(){for(var i=0;i<G4.length;i++)G4[i]._workInProgressVersionPrimary=null;G4.length=0}var S3=h1.ReactCurrentDispatcher,$4=h1.ReactCurrentBatchConfig,ap=0,Zo=null,js=null,ta=null,J3=!1,d2=!1,P2=0,xT=0;function Ra(){throw Error(Ri(321))}function j_(i,a){if(a===null)return!1;for(var p=0;p<a.length&&p<i.length;p++)if(!Fu(i[p],a[p]))return!1;return!0}function G_(i,a,p,y,T,P){if(ap=P,Zo=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,S3.current=i===null||i.memoizedState===null?TT:ET,i=p(y,T),d2){P=0;do{if(d2=!1,P2=0,25<=P)throw Error(Ri(301));P+=1,ta=js=null,a.updateQueue=null,S3.current=ST,i=p(y,T)}while(d2)}if(S3.current=Q3,a=js!==null&&js.next!==null,ap=0,ta=js=Zo=null,J3=!1,a)throw Error(Ri(300));return i}function $_(){var i=P2!==0;return P2=0,i}function xh(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ta===null?Zo.memoizedState=ta=i:ta=ta.next=i,ta}function Qc(){if(js===null){var i=Zo.alternate;i=i!==null?i.memoizedState:null}else i=js.next;var a=ta===null?Zo.memoizedState:ta.next;if(a!==null)ta=a,js=i;else{if(i===null)throw Error(Ri(310));js=i,i={memoizedState:js.memoizedState,baseState:js.baseState,baseQueue:js.baseQueue,queue:js.queue,next:null},ta===null?Zo.memoizedState=ta=i:ta=ta.next=i}return ta}function k2(i,a){return typeof a=="function"?a(i):a}function Z4(i){var a=Qc(),p=a.queue;if(p===null)throw Error(Ri(311));p.lastRenderedReducer=i;var y=js,T=y.baseQueue,P=p.pending;if(P!==null){if(T!==null){var F=T.next;T.next=P.next,P.next=F}y.baseQueue=T=P,p.pending=null}if(T!==null){P=T.next,y=y.baseState;var t=F=null,j=null,ie=P;do{var ye=ie.lane;if((ap&ye)===ye)j!==null&&(j=j.next={lane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),y=ie.hasEagerState?ie.eagerState:i(y,ie.action);else{var he={lane:ye,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null};j===null?(t=j=he,F=y):j=j.next=he,Zo.lanes|=ye,lp|=ye}ie=ie.next}while(ie!==null&&ie!==P);j===null?F=y:j.next=t,Fu(y,a.memoizedState)||(Nl=!0),a.memoizedState=y,a.baseState=F,a.baseQueue=j,p.lastRenderedState=y}if(i=p.interleaved,i!==null){T=i;do P=T.lane,Zo.lanes|=P,lp|=P,T=T.next;while(T!==i)}else T===null&&(p.lanes=0);return[a.memoizedState,p.dispatch]}function q4(i){var a=Qc(),p=a.queue;if(p===null)throw Error(Ri(311));p.lastRenderedReducer=i;var y=p.dispatch,T=p.pending,P=a.memoizedState;if(T!==null){p.pending=null;var F=T=T.next;do P=i(P,F.action),F=F.next;while(F!==T);Fu(P,a.memoizedState)||(Nl=!0),a.memoizedState=P,a.baseQueue===null&&(a.baseState=P),p.lastRenderedState=P}return[P,y]}function q9(){}function W9(i,a){var p=Zo,y=Qc(),T=a(),P=!Fu(y.memoizedState,T);if(P&&(y.memoizedState=T,Nl=!0),y=y.queue,Z_(K9.bind(null,p,y,i),[i]),y.getSnapshot!==a||P||ta!==null&&ta.memoizedState.tag&1){if(p.flags|=2048,z2(9,H9.bind(null,p,y,T,a),void 0,null),ia===null)throw Error(Ri(349));ap&30||X9(p,a,T)}return T}function X9(i,a,p){i.flags|=16384,i={getSnapshot:a,value:p},a=Zo.updateQueue,a===null?(a={lastEffect:null,stores:null},Zo.updateQueue=a,a.stores=[i]):(p=a.stores,p===null?a.stores=[i]:p.push(i))}function H9(i,a,p,y){a.value=p,a.getSnapshot=y,Y9(a)&&J9(i)}function K9(i,a,p){return p(function(){Y9(a)&&J9(i)})}function Y9(i){var a=i.getSnapshot;i=i.value;try{var p=a();return!Fu(i,p)}catch{return!0}}function J9(i){var a=c1(i,1);a!==null&&Bu(a,i,1,-1)}function ay(i){var a=xh();return typeof i=="function"&&(i=i()),a.memoizedState=a.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:k2,lastRenderedState:i},a.queue=i,i=i.dispatch=wT.bind(null,Zo,i),[a.memoizedState,i]}function z2(i,a,p,y){return i={tag:i,create:a,destroy:p,deps:y,next:null},a=Zo.updateQueue,a===null?(a={lastEffect:null,stores:null},Zo.updateQueue=a,a.lastEffect=i.next=i):(p=a.lastEffect,p===null?a.lastEffect=i.next=i:(y=p.next,p.next=i,i.next=y,a.lastEffect=i)),i}function Q9(){return Qc().memoizedState}function M3(i,a,p,y){var T=xh();Zo.flags|=i,T.memoizedState=z2(1|a,p,void 0,y===void 0?null:y)}function S5(i,a,p,y){var T=Qc();y=y===void 0?null:y;var P=void 0;if(js!==null){var F=js.memoizedState;if(P=F.destroy,y!==null&&j_(y,F.deps)){T.memoizedState=z2(a,p,P,y);return}}Zo.flags|=i,T.memoizedState=z2(1|a,p,P,y)}function ly(i,a){return M3(8390656,8,i,a)}function Z_(i,a){return S5(2048,8,i,a)}function ex(i,a){return S5(4,2,i,a)}function tx(i,a){return S5(4,4,i,a)}function ix(i,a){if(typeof a=="function")return i=i(),a(i),function(){a(null)};if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function rx(i,a,p){return p=p!=null?p.concat([i]):null,S5(4,4,ix.bind(null,a,i),p)}function q_(){}function nx(i,a){var p=Qc();a=a===void 0?null:a;var y=p.memoizedState;return y!==null&&a!==null&&j_(a,y[1])?y[0]:(p.memoizedState=[i,a],i)}function ox(i,a){var p=Qc();a=a===void 0?null:a;var y=p.memoizedState;return y!==null&&a!==null&&j_(a,y[1])?y[0]:(i=i(),p.memoizedState=[i,a],i)}function sx(i,a,p){return ap&21?(Fu(p,a)||(p=h9(),Zo.lanes|=p,lp|=p,i.baseState=!0),a):(i.baseState&&(i.baseState=!1,Nl=!0),i.memoizedState=p)}function vT(i,a){var p=Qn;Qn=p!==0&&4>p?p:4,i(!0);var y=$4.transition;$4.transition={};try{i(!1),a()}finally{Qn=p,$4.transition=y}}function ax(){return Qc().memoizedState}function bT(i,a,p){var y=dd(i);if(p={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null},lx(i))cx(a,p);else if(p=G9(i,a,p,y),p!==null){var T=sl();Bu(p,i,y,T),ux(p,a,y)}}function wT(i,a,p){var y=dd(i),T={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null};if(lx(i))cx(a,T);else{var P=i.alternate;if(i.lanes===0&&(P===null||P.lanes===0)&&(P=a.lastRenderedReducer,P!==null))try{var F=a.lastRenderedState,t=P(F,p);if(T.hasEagerState=!0,T.eagerState=t,Fu(t,F)){var j=a.interleaved;j===null?(T.next=T,F_(a)):(T.next=j.next,j.next=T),a.interleaved=T;return}}catch{}finally{}p=G9(i,a,T,y),p!==null&&(T=sl(),Bu(p,i,y,T),ux(p,a,y))}}function lx(i){var a=i.alternate;return i===Zo||a!==null&&a===Zo}function cx(i,a){d2=J3=!0;var p=i.pending;p===null?a.next=a:(a.next=p.next,p.next=a),i.pending=a}function ux(i,a,p){if(p&4194240){var y=a.lanes;y&=i.pendingLanes,p|=y,a.lanes=p,T_(i,p)}}var Q3={readContext:Jc,useCallback:Ra,useContext:Ra,useEffect:Ra,useImperativeHandle:Ra,useInsertionEffect:Ra,useLayoutEffect:Ra,useMemo:Ra,useReducer:Ra,useRef:Ra,useState:Ra,useDebugValue:Ra,useDeferredValue:Ra,useTransition:Ra,useMutableSource:Ra,useSyncExternalStore:Ra,useId:Ra,unstable_isNewReconciler:!1},TT={readContext:Jc,useCallback:function(i,a){return xh().memoizedState=[i,a===void 0?null:a],i},useContext:Jc,useEffect:ly,useImperativeHandle:function(i,a,p){return p=p!=null?p.concat([i]):null,M3(4194308,4,ix.bind(null,a,i),p)},useLayoutEffect:function(i,a){return M3(4194308,4,i,a)},useInsertionEffect:function(i,a){return M3(4,2,i,a)},useMemo:function(i,a){var p=xh();return a=a===void 0?null:a,i=i(),p.memoizedState=[i,a],i},useReducer:function(i,a,p){var y=xh();return a=p!==void 0?p(a):a,y.memoizedState=y.baseState=a,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:a},y.queue=i,i=i.dispatch=bT.bind(null,Zo,i),[y.memoizedState,i]},useRef:function(i){var a=xh();return i={current:i},a.memoizedState=i},useState:ay,useDebugValue:q_,useDeferredValue:function(i){return xh().memoizedState=i},useTransition:function(){var i=ay(!1),a=i[0];return i=vT.bind(null,i[1]),xh().memoizedState=i,[a,i]},useMutableSource:function(){},useSyncExternalStore:function(i,a,p){var y=Zo,T=xh();if(Co){if(p===void 0)throw Error(Ri(407));p=p()}else{if(p=a(),ia===null)throw Error(Ri(349));ap&30||X9(y,a,p)}T.memoizedState=p;var P={value:p,getSnapshot:a};return T.queue=P,ly(K9.bind(null,y,P,i),[i]),y.flags|=2048,z2(9,H9.bind(null,y,P,p,a),void 0,null),p},useId:function(){var i=xh(),a=ia.identifierPrefix;if(Co){var p=n1,y=r1;p=(y&~(1<<32-Ru(y)-1)).toString(32)+p,a=":"+a+"R"+p,p=P2++,0<p&&(a+="H"+p.toString(32)),a+=":"}else p=xT++,a=":"+a+"r"+p.toString(32)+":";return i.memoizedState=a},unstable_isNewReconciler:!1},ET={readContext:Jc,useCallback:nx,useContext:Jc,useEffect:Z_,useImperativeHandle:rx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ox,useReducer:Z4,useRef:Q9,useState:function(){return Z4(k2)},useDebugValue:q_,useDeferredValue:function(i){var a=Qc();return sx(a,js.memoizedState,i)},useTransition:function(){var i=Z4(k2)[0],a=Qc().memoizedState;return[i,a]},useMutableSource:q9,useSyncExternalStore:W9,useId:ax,unstable_isNewReconciler:!1},ST={readContext:Jc,useCallback:nx,useContext:Jc,useEffect:Z_,useImperativeHandle:rx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ox,useReducer:q4,useRef:Q9,useState:function(){return q4(k2)},useDebugValue:q_,useDeferredValue:function(i){var a=Qc();return js===null?a.memoizedState=i:sx(a,js.memoizedState,i)},useTransition:function(){var i=q4(k2)[0],a=Qc().memoizedState;return[i,a]},useMutableSource:q9,useSyncExternalStore:W9,useId:ax,unstable_isNewReconciler:!1};function Pu(i,a){if(i&&i.defaultProps){a=qo({},a),i=i.defaultProps;for(var p in i)a[p]===void 0&&(a[p]=i[p]);return a}return a}function F6(i,a,p,y){a=i.memoizedState,p=p(y,a),p=p==null?a:qo({},a,p),i.memoizedState=p,i.lanes===0&&(i.updateQueue.baseState=p)}var M5={isMounted:function(i){return(i=i._reactInternals)?dp(i)===i:!1},enqueueSetState:function(i,a,p){i=i._reactInternals;var y=sl(),T=dd(i),P=o1(y,T);P.payload=a,p!=null&&(P.callback=p),a=ud(i,P,T),a!==null&&(Bu(a,i,T,y),E3(a,i,T))},enqueueReplaceState:function(i,a,p){i=i._reactInternals;var y=sl(),T=dd(i),P=o1(y,T);P.tag=1,P.payload=a,p!=null&&(P.callback=p),a=ud(i,P,T),a!==null&&(Bu(a,i,T,y),E3(a,i,T))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var p=sl(),y=dd(i),T=o1(p,y);T.tag=2,a!=null&&(T.callback=a),a=ud(i,T,y),a!==null&&(Bu(a,i,y,p),E3(a,i,y))}};function cy(i,a,p,y,T,P,F){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(y,P,F):a.prototype&&a.prototype.isPureReactComponent?!E2(p,y)||!E2(T,P):!0}function hx(i,a,p){var y=!1,T=_d,P=a.contextType;return typeof P=="object"&&P!==null?P=Jc(P):(T=jl(a)?op:Ua.current,y=a.contextTypes,P=(y=y!=null)?A0(i,T):_d),a=new a(p,P),i.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=M5,i.stateNode=a,a._reactInternals=i,y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=T,i.__reactInternalMemoizedMaskedChildContext=P),a}function uy(i,a,p,y){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(p,y),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(p,y),a.state!==i&&M5.enqueueReplaceState(a,a.state,null)}function O6(i,a,p,y){var T=i.stateNode;T.props=p,T.state=i.memoizedState,T.refs={},O_(i);var P=a.contextType;typeof P=="object"&&P!==null?T.context=Jc(P):(P=jl(a)?op:Ua.current,T.context=A0(i,P)),T.state=i.memoizedState,P=a.getDerivedStateFromProps,typeof P=="function"&&(F6(i,a,P,p),T.state=i.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(a=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),a!==T.state&&M5.enqueueReplaceState(T,T.state,null),K3(i,p,T,y),T.state=i.memoizedState),typeof T.componentDidMount=="function"&&(i.flags|=4194308)}function D0(i,a){try{var p="",y=a;do p+=Qb(y),y=y.return;while(y);var T=p}catch(P){T=`
Error generating stack: `+P.message+`
`+P.stack}return{value:i,source:a,stack:T,digest:null}}function W4(i,a,p){return{value:i,source:null,stack:p??null,digest:a??null}}function U6(i,a){try{console.error(a.value)}catch(p){setTimeout(function(){throw p})}}var MT=typeof WeakMap=="function"?WeakMap:Map;function dx(i,a,p){p=o1(-1,p),p.tag=3,p.payload={element:null};var y=a.value;return p.callback=function(){t5||(t5=!0,H6=y),U6(i,a)},p}function px(i,a,p){p=o1(-1,p),p.tag=3;var y=i.type.getDerivedStateFromError;if(typeof y=="function"){var T=a.value;p.payload=function(){return y(T)},p.callback=function(){U6(i,a)}}var P=i.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(p.callback=function(){U6(i,a),typeof y!="function"&&(hd===null?hd=new Set([this]):hd.add(this));var F=a.stack;this.componentDidCatch(a.value,{componentStack:F!==null?F:""})}),p}function hy(i,a,p){var y=i.pingCache;if(y===null){y=i.pingCache=new MT;var T=new Set;y.set(a,T)}else T=y.get(a),T===void 0&&(T=new Set,y.set(a,T));T.has(p)||(T.add(p),i=NT.bind(null,i,a,p),a.then(i,i))}function dy(i){do{var a;if((a=i.tag===13)&&(a=i.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return i;i=i.return}while(i!==null);return null}function py(i,a,p,y,T){return i.mode&1?(i.flags|=65536,i.lanes=T,i):(i===a?i.flags|=65536:(i.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(a=o1(-1,1),a.tag=2,ud(p,a,1))),p.lanes|=1),i)}var CT=h1.ReactCurrentOwner,Nl=!1;function nl(i,a,p,y){a.child=i===null?j9(a,null,p,y):k0(a,i.child,p,y)}function fy(i,a,p,y,T){p=p.render;var P=a.ref;return T0(a,T),y=G_(i,a,p,y,P,T),p=$_(),i!==null&&!Nl?(a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~T,u1(i,a,T)):(Co&&p&&k_(a),a.flags|=1,nl(i,a,y,T),a.child)}function my(i,a,p,y,T){if(i===null){var P=p.type;return typeof P=="function"&&!eg(P)&&P.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(a.tag=15,a.type=P,fx(i,a,P,y,T)):(i=P3(p.type,null,y,a,a.mode,T),i.ref=a.ref,i.return=a,a.child=i)}if(P=i.child,!(i.lanes&T)){var F=P.memoizedProps;if(p=p.compare,p=p!==null?p:E2,p(F,y)&&i.ref===a.ref)return u1(i,a,T)}return a.flags|=1,i=pd(P,y),i.ref=a.ref,i.return=a,a.child=i}function fx(i,a,p,y,T){if(i!==null){var P=i.memoizedProps;if(E2(P,y)&&i.ref===a.ref)if(Nl=!1,a.pendingProps=y=P,(i.lanes&T)!==0)i.flags&131072&&(Nl=!0);else return a.lanes=i.lanes,u1(i,a,T)}return N6(i,a,p,y,T)}function mx(i,a,p){var y=a.pendingProps,T=y.children,P=i!==null?i.memoizedState:null;if(y.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},fo(g0,fc),fc|=p;else{if(!(p&1073741824))return i=P!==null?P.baseLanes|p:p,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:i,cachePool:null,transitions:null},a.updateQueue=null,fo(g0,fc),fc|=i,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=P!==null?P.baseLanes:p,fo(g0,fc),fc|=y}else P!==null?(y=P.baseLanes|p,a.memoizedState=null):y=p,fo(g0,fc),fc|=y;return nl(i,a,T,p),a.child}function _x(i,a){var p=a.ref;(i===null&&p!==null||i!==null&&i.ref!==p)&&(a.flags|=512,a.flags|=2097152)}function N6(i,a,p,y,T){var P=jl(p)?op:Ua.current;return P=A0(a,P),T0(a,T),p=G_(i,a,p,y,P,T),y=$_(),i!==null&&!Nl?(a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~T,u1(i,a,T)):(Co&&y&&k_(a),a.flags|=1,nl(i,a,p,T),a.child)}function _y(i,a,p,y,T){if(jl(p)){var P=!0;Z3(a)}else P=!1;if(T0(a,T),a.stateNode===null)C3(i,a),hx(a,p,y),O6(a,p,y,T),y=!0;else if(i===null){var F=a.stateNode,t=a.memoizedProps;F.props=t;var j=F.context,ie=p.contextType;typeof ie=="object"&&ie!==null?ie=Jc(ie):(ie=jl(p)?op:Ua.current,ie=A0(a,ie));var ye=p.getDerivedStateFromProps,he=typeof ye=="function"||typeof F.getSnapshotBeforeUpdate=="function";he||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(t!==y||j!==ie)&&uy(a,F,y,ie),ed=!1;var ne=a.memoizedState;F.state=ne,K3(a,y,F,T),j=a.memoizedState,t!==y||ne!==j||Vl.current||ed?(typeof ye=="function"&&(F6(a,p,ye,y),j=a.memoizedState),(t=ed||cy(a,p,t,y,ne,j,ie))?(he||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(a.flags|=4194308)):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=y,a.memoizedState=j),F.props=y,F.state=j,F.context=ie,y=t):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),y=!1)}else{F=a.stateNode,$9(i,a),t=a.memoizedProps,ie=a.type===a.elementType?t:Pu(a.type,t),F.props=ie,he=a.pendingProps,ne=F.context,j=p.contextType,typeof j=="object"&&j!==null?j=Jc(j):(j=jl(p)?op:Ua.current,j=A0(a,j));var Ye=p.getDerivedStateFromProps;(ye=typeof Ye=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(t!==he||ne!==j)&&uy(a,F,y,j),ed=!1,ne=a.memoizedState,F.state=ne,K3(a,y,F,T);var lt=a.memoizedState;t!==he||ne!==lt||Vl.current||ed?(typeof Ye=="function"&&(F6(a,p,Ye,y),lt=a.memoizedState),(ie=ed||cy(a,p,ie,y,ne,lt,j)||!1)?(ye||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(y,lt,j),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(y,lt,j)),typeof F.componentDidUpdate=="function"&&(a.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof F.componentDidUpdate!="function"||t===i.memoizedProps&&ne===i.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||t===i.memoizedProps&&ne===i.memoizedState||(a.flags|=1024),a.memoizedProps=y,a.memoizedState=lt),F.props=y,F.state=lt,F.context=j,y=ie):(typeof F.componentDidUpdate!="function"||t===i.memoizedProps&&ne===i.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||t===i.memoizedProps&&ne===i.memoizedState||(a.flags|=1024),y=!1)}return V6(i,a,p,y,P,T)}function V6(i,a,p,y,T,P){_x(i,a);var F=(a.flags&128)!==0;if(!y&&!F)return T&&ty(a,p,!1),u1(i,a,P);y=a.stateNode,CT.current=a;var t=F&&typeof p.getDerivedStateFromError!="function"?null:y.render();return a.flags|=1,i!==null&&F?(a.child=k0(a,i.child,null,P),a.child=k0(a,null,t,P)):nl(i,a,t,P),a.memoizedState=y.state,T&&ty(a,p,!0),a.child}function gx(i){var a=i.stateNode;a.pendingContext?ey(i,a.pendingContext,a.pendingContext!==a.context):a.context&&ey(i,a.context,!1),U_(i,a.containerInfo)}function gy(i,a,p,y,T){return P0(),D_(T),a.flags|=256,nl(i,a,p,y),a.child}var j6={dehydrated:null,treeContext:null,retryLane:0};function G6(i){return{baseLanes:i,cachePool:null,transitions:null}}function yx(i,a,p){var y=a.pendingProps,T=$o.current,P=!1,F=(a.flags&128)!==0,t;if((t=F)||(t=i!==null&&i.memoizedState===null?!1:(T&2)!==0),t?(P=!0,a.flags&=-129):(i===null||i.memoizedState!==null)&&(T|=1),fo($o,T&1),i===null)return R6(a),i=a.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(a.mode&1?i.data==="$!"?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(F=y.children,i=y.fallback,P?(y=a.mode,P=a.child,F={mode:"hidden",children:F},!(y&1)&&P!==null?(P.childLanes=0,P.pendingProps=F):P=A5(F,y,0,null),i=np(i,y,p,null),P.return=a,i.return=a,P.sibling=i,a.child=P,a.child.memoizedState=G6(p),a.memoizedState=j6,i):W_(a,F));if(T=i.memoizedState,T!==null&&(t=T.dehydrated,t!==null))return IT(i,a,F,y,t,T,p);if(P){P=y.fallback,F=a.mode,T=i.child,t=T.sibling;var j={mode:"hidden",children:y.children};return!(F&1)&&a.child!==T?(y=a.child,y.childLanes=0,y.pendingProps=j,a.deletions=null):(y=pd(T,j),y.subtreeFlags=T.subtreeFlags&14680064),t!==null?P=pd(t,P):(P=np(P,F,p,null),P.flags|=2),P.return=a,y.return=a,y.sibling=P,a.child=y,y=P,P=a.child,F=i.child.memoizedState,F=F===null?G6(p):{baseLanes:F.baseLanes|p,cachePool:null,transitions:F.transitions},P.memoizedState=F,P.childLanes=i.childLanes&~p,a.memoizedState=j6,y}return P=i.child,i=P.sibling,y=pd(P,{mode:"visible",children:y.children}),!(a.mode&1)&&(y.lanes=p),y.return=a,y.sibling=null,i!==null&&(p=a.deletions,p===null?(a.deletions=[i],a.flags|=16):p.push(i)),a.child=y,a.memoizedState=null,y}function W_(i,a){return a=A5({mode:"visible",children:a},i.mode,0,null),a.return=i,i.child=a}function u3(i,a,p,y){return y!==null&&D_(y),k0(a,i.child,null,p),i=W_(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function IT(i,a,p,y,T,P,F){if(p)return a.flags&256?(a.flags&=-257,y=W4(Error(Ri(422))),u3(i,a,F,y)):a.memoizedState!==null?(a.child=i.child,a.flags|=128,null):(P=y.fallback,T=a.mode,y=A5({mode:"visible",children:y.children},T,0,null),P=np(P,T,F,null),P.flags|=2,y.return=a,P.return=a,y.sibling=P,a.child=y,a.mode&1&&k0(a,i.child,null,F),a.child.memoizedState=G6(F),a.memoizedState=j6,P);if(!(a.mode&1))return u3(i,a,F,null);if(T.data==="$!"){if(y=T.nextSibling&&T.nextSibling.dataset,y)var t=y.dgst;return y=t,P=Error(Ri(419)),y=W4(P,y,void 0),u3(i,a,F,y)}if(t=(F&i.childLanes)!==0,Nl||t){if(y=ia,y!==null){switch(F&-F){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=T&(y.suspendedLanes|F)?0:T,T!==0&&T!==P.retryLane&&(P.retryLane=T,c1(i,T),Bu(y,i,T,-1))}return Q_(),y=W4(Error(Ri(421))),u3(i,a,F,y)}return T.data==="$?"?(a.flags|=128,a.child=i.child,a=VT.bind(null,i),T._reactRetry=a,null):(i=P.treeContext,yc=cd(T.nextSibling),xc=a,Co=!0,Du=null,i!==null&&(Wc[Xc++]=r1,Wc[Xc++]=n1,Wc[Xc++]=sp,r1=i.id,n1=i.overflow,sp=a),a=W_(a,y.children),a.flags|=4096,a)}function yy(i,a,p){i.lanes|=a;var y=i.alternate;y!==null&&(y.lanes|=a),B6(i.return,a,p)}function X4(i,a,p,y,T){var P=i.memoizedState;P===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:T}:(P.isBackwards=a,P.rendering=null,P.renderingStartTime=0,P.last=y,P.tail=p,P.tailMode=T)}function xx(i,a,p){var y=a.pendingProps,T=y.revealOrder,P=y.tail;if(nl(i,a,y.children,p),y=$o.current,y&2)y=y&1|2,a.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&yy(i,p,a);else if(i.tag===19)yy(i,p,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}y&=1}if(fo($o,y),!(a.mode&1))a.memoizedState=null;else switch(T){case"forwards":for(p=a.child,T=null;p!==null;)i=p.alternate,i!==null&&Y3(i)===null&&(T=p),p=p.sibling;p=T,p===null?(T=a.child,a.child=null):(T=p.sibling,p.sibling=null),X4(a,!1,T,p,P);break;case"backwards":for(p=null,T=a.child,a.child=null;T!==null;){if(i=T.alternate,i!==null&&Y3(i)===null){a.child=T;break}i=T.sibling,T.sibling=p,p=T,T=i}X4(a,!0,p,null,P);break;case"together":X4(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function C3(i,a){!(a.mode&1)&&i!==null&&(i.alternate=null,a.alternate=null,a.flags|=2)}function u1(i,a,p){if(i!==null&&(a.dependencies=i.dependencies),lp|=a.lanes,!(p&a.childLanes))return null;if(i!==null&&a.child!==i.child)throw Error(Ri(153));if(a.child!==null){for(i=a.child,p=pd(i,i.pendingProps),a.child=p,p.return=a;i.sibling!==null;)i=i.sibling,p=p.sibling=pd(i,i.pendingProps),p.return=a;p.sibling=null}return a.child}function AT(i,a,p){switch(a.tag){case 3:gx(a),P0();break;case 5:Z9(a);break;case 1:jl(a.type)&&Z3(a);break;case 4:U_(a,a.stateNode.containerInfo);break;case 10:var y=a.type._context,T=a.memoizedProps.value;fo(X3,y._currentValue),y._currentValue=T;break;case 13:if(y=a.memoizedState,y!==null)return y.dehydrated!==null?(fo($o,$o.current&1),a.flags|=128,null):p&a.child.childLanes?yx(i,a,p):(fo($o,$o.current&1),i=u1(i,a,p),i!==null?i.sibling:null);fo($o,$o.current&1);break;case 19:if(y=(p&a.childLanes)!==0,i.flags&128){if(y)return xx(i,a,p);a.flags|=128}if(T=a.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),fo($o,$o.current),y)break;return null;case 22:case 23:return a.lanes=0,mx(i,a,p)}return u1(i,a,p)}var vx,$6,bx,wx;vx=function(i,a){for(var p=a.child;p!==null;){if(p.tag===5||p.tag===6)i.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===a)break;for(;p.sibling===null;){if(p.return===null||p.return===a)return;p=p.return}p.sibling.return=p.return,p=p.sibling}};$6=function(){};bx=function(i,a,p,y){var T=i.memoizedProps;if(T!==y){i=a.stateNode,tp(wh.current);var P=null;switch(p){case"input":T=d6(i,T),y=d6(i,y),P=[];break;case"select":T=qo({},T,{value:void 0}),y=qo({},y,{value:void 0}),P=[];break;case"textarea":T=m6(i,T),y=m6(i,y),P=[];break;default:typeof T.onClick!="function"&&typeof y.onClick=="function"&&(i.onclick=G3)}g6(p,y);var F;p=null;for(ie in T)if(!y.hasOwnProperty(ie)&&T.hasOwnProperty(ie)&&T[ie]!=null)if(ie==="style"){var t=T[ie];for(F in t)t.hasOwnProperty(F)&&(p||(p={}),p[F]="")}else ie!=="dangerouslySetInnerHTML"&&ie!=="children"&&ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&ie!=="autoFocus"&&(g2.hasOwnProperty(ie)?P||(P=[]):(P=P||[]).push(ie,null));for(ie in y){var j=y[ie];if(t=T!=null?T[ie]:void 0,y.hasOwnProperty(ie)&&j!==t&&(j!=null||t!=null))if(ie==="style")if(t){for(F in t)!t.hasOwnProperty(F)||j&&j.hasOwnProperty(F)||(p||(p={}),p[F]="");for(F in j)j.hasOwnProperty(F)&&t[F]!==j[F]&&(p||(p={}),p[F]=j[F])}else p||(P||(P=[]),P.push(ie,p)),p=j;else ie==="dangerouslySetInnerHTML"?(j=j?j.__html:void 0,t=t?t.__html:void 0,j!=null&&t!==j&&(P=P||[]).push(ie,j)):ie==="children"?typeof j!="string"&&typeof j!="number"||(P=P||[]).push(ie,""+j):ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&(g2.hasOwnProperty(ie)?(j!=null&&ie==="onScroll"&&wo("scroll",i),P||t===j||(P=[])):(P=P||[]).push(ie,j))}p&&(P=P||[]).push("style",p);var ie=P;(a.updateQueue=ie)&&(a.flags|=4)}};wx=function(i,a,p,y){p!==y&&(a.flags|=4)};function Xf(i,a){if(!Co)switch(i.tailMode){case"hidden":a=i.tail;for(var p=null;a!==null;)a.alternate!==null&&(p=a),a=a.sibling;p===null?i.tail=null:p.sibling=null;break;case"collapsed":p=i.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:y.sibling=null}}function Ba(i){var a=i.alternate!==null&&i.alternate.child===i.child,p=0,y=0;if(a)for(var T=i.child;T!==null;)p|=T.lanes|T.childLanes,y|=T.subtreeFlags&14680064,y|=T.flags&14680064,T.return=i,T=T.sibling;else for(T=i.child;T!==null;)p|=T.lanes|T.childLanes,y|=T.subtreeFlags,y|=T.flags,T.return=i,T=T.sibling;return i.subtreeFlags|=y,i.childLanes=p,a}function PT(i,a,p){var y=a.pendingProps;switch(z_(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ba(a),null;case 1:return jl(a.type)&&$3(),Ba(a),null;case 3:return y=a.stateNode,z0(),To(Vl),To(Ua),V_(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(i===null||i.child===null)&&(l3(a)?a.flags|=4:i===null||i.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,Du!==null&&(J6(Du),Du=null))),$6(i,a),Ba(a),null;case 5:N_(a);var T=tp(A2.current);if(p=a.type,i!==null&&a.stateNode!=null)bx(i,a,p,y,T),i.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!y){if(a.stateNode===null)throw Error(Ri(166));return Ba(a),null}if(i=tp(wh.current),l3(a)){y=a.stateNode,p=a.type;var P=a.memoizedProps;switch(y[vh]=a,y[C2]=P,i=(a.mode&1)!==0,p){case"dialog":wo("cancel",y),wo("close",y);break;case"iframe":case"object":case"embed":wo("load",y);break;case"video":case"audio":for(T=0;T<n2.length;T++)wo(n2[T],y);break;case"source":wo("error",y);break;case"img":case"image":case"link":wo("error",y),wo("load",y);break;case"details":wo("toggle",y);break;case"input":C7(y,P),wo("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!P.multiple},wo("invalid",y);break;case"textarea":A7(y,P),wo("invalid",y)}g6(p,P),T=null;for(var F in P)if(P.hasOwnProperty(F)){var t=P[F];F==="children"?typeof t=="string"?y.textContent!==t&&(P.suppressHydrationWarning!==!0&&a3(y.textContent,t,i),T=["children",t]):typeof t=="number"&&y.textContent!==""+t&&(P.suppressHydrationWarning!==!0&&a3(y.textContent,t,i),T=["children",""+t]):g2.hasOwnProperty(F)&&t!=null&&F==="onScroll"&&wo("scroll",y)}switch(p){case"input":Qm(y),I7(y,P,!0);break;case"textarea":Qm(y),P7(y);break;case"select":case"option":break;default:typeof P.onClick=="function"&&(y.onclick=G3)}y=T,a.updateQueue=y,y!==null&&(a.flags|=4)}else{F=T.nodeType===9?T:T.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=K8(p)),i==="http://www.w3.org/1999/xhtml"?p==="script"?(i=F.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof y.is=="string"?i=F.createElement(p,{is:y.is}):(i=F.createElement(p),p==="select"&&(F=i,y.multiple?F.multiple=!0:y.size&&(F.size=y.size))):i=F.createElementNS(i,p),i[vh]=a,i[C2]=y,vx(i,a,!1,!1),a.stateNode=i;e:{switch(F=y6(p,y),p){case"dialog":wo("cancel",i),wo("close",i),T=y;break;case"iframe":case"object":case"embed":wo("load",i),T=y;break;case"video":case"audio":for(T=0;T<n2.length;T++)wo(n2[T],i);T=y;break;case"source":wo("error",i),T=y;break;case"img":case"image":case"link":wo("error",i),wo("load",i),T=y;break;case"details":wo("toggle",i),T=y;break;case"input":C7(i,y),T=d6(i,y),wo("invalid",i);break;case"option":T=y;break;case"select":i._wrapperState={wasMultiple:!!y.multiple},T=qo({},y,{value:void 0}),wo("invalid",i);break;case"textarea":A7(i,y),T=m6(i,y),wo("invalid",i);break;default:T=y}g6(p,T),t=T;for(P in t)if(t.hasOwnProperty(P)){var j=t[P];P==="style"?Q8(i,j):P==="dangerouslySetInnerHTML"?(j=j?j.__html:void 0,j!=null&&Y8(i,j)):P==="children"?typeof j=="string"?(p!=="textarea"||j!=="")&&y2(i,j):typeof j=="number"&&y2(i,""+j):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(g2.hasOwnProperty(P)?j!=null&&P==="onScroll"&&wo("scroll",i):j!=null&&g_(i,P,j,F))}switch(p){case"input":Qm(i),I7(i,y,!1);break;case"textarea":Qm(i),P7(i);break;case"option":y.value!=null&&i.setAttribute("value",""+md(y.value));break;case"select":i.multiple=!!y.multiple,P=y.value,P!=null?x0(i,!!y.multiple,P,!1):y.defaultValue!=null&&x0(i,!!y.multiple,y.defaultValue,!0);break;default:typeof T.onClick=="function"&&(i.onclick=G3)}switch(p){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Ba(a),null;case 6:if(i&&a.stateNode!=null)wx(i,a,i.memoizedProps,y);else{if(typeof y!="string"&&a.stateNode===null)throw Error(Ri(166));if(p=tp(A2.current),tp(wh.current),l3(a)){if(y=a.stateNode,p=a.memoizedProps,y[vh]=a,(P=y.nodeValue!==p)&&(i=xc,i!==null))switch(i.tag){case 3:a3(y.nodeValue,p,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&a3(y.nodeValue,p,(i.mode&1)!==0)}P&&(a.flags|=4)}else y=(p.nodeType===9?p:p.ownerDocument).createTextNode(y),y[vh]=a,a.stateNode=y}return Ba(a),null;case 13:if(To($o),y=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Co&&yc!==null&&a.mode&1&&!(a.flags&128))N9(),P0(),a.flags|=98560,P=!1;else if(P=l3(a),y!==null&&y.dehydrated!==null){if(i===null){if(!P)throw Error(Ri(318));if(P=a.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(Ri(317));P[vh]=a}else P0(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Ba(a),P=!1}else Du!==null&&(J6(Du),Du=null),P=!0;if(!P)return a.flags&65536?a:null}return a.flags&128?(a.lanes=p,a):(y=y!==null,y!==(i!==null&&i.memoizedState!==null)&&y&&(a.child.flags|=8192,a.mode&1&&(i===null||$o.current&1?Gs===0&&(Gs=3):Q_())),a.updateQueue!==null&&(a.flags|=4),Ba(a),null);case 4:return z0(),$6(i,a),i===null&&S2(a.stateNode.containerInfo),Ba(a),null;case 10:return B_(a.type._context),Ba(a),null;case 17:return jl(a.type)&&$3(),Ba(a),null;case 19:if(To($o),P=a.memoizedState,P===null)return Ba(a),null;if(y=(a.flags&128)!==0,F=P.rendering,F===null)if(y)Xf(P,!1);else{if(Gs!==0||i!==null&&i.flags&128)for(i=a.child;i!==null;){if(F=Y3(i),F!==null){for(a.flags|=128,Xf(P,!1),y=F.updateQueue,y!==null&&(a.updateQueue=y,a.flags|=4),a.subtreeFlags=0,y=p,p=a.child;p!==null;)P=p,i=y,P.flags&=14680066,F=P.alternate,F===null?(P.childLanes=0,P.lanes=i,P.child=null,P.subtreeFlags=0,P.memoizedProps=null,P.memoizedState=null,P.updateQueue=null,P.dependencies=null,P.stateNode=null):(P.childLanes=F.childLanes,P.lanes=F.lanes,P.child=F.child,P.subtreeFlags=0,P.deletions=null,P.memoizedProps=F.memoizedProps,P.memoizedState=F.memoizedState,P.updateQueue=F.updateQueue,P.type=F.type,i=F.dependencies,P.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),p=p.sibling;return fo($o,$o.current&1|2),a.child}i=i.sibling}P.tail!==null&&_s()>L0&&(a.flags|=128,y=!0,Xf(P,!1),a.lanes=4194304)}else{if(!y)if(i=Y3(F),i!==null){if(a.flags|=128,y=!0,p=i.updateQueue,p!==null&&(a.updateQueue=p,a.flags|=4),Xf(P,!0),P.tail===null&&P.tailMode==="hidden"&&!F.alternate&&!Co)return Ba(a),null}else 2*_s()-P.renderingStartTime>L0&&p!==1073741824&&(a.flags|=128,y=!0,Xf(P,!1),a.lanes=4194304);P.isBackwards?(F.sibling=a.child,a.child=F):(p=P.last,p!==null?p.sibling=F:a.child=F,P.last=F)}return P.tail!==null?(a=P.tail,P.rendering=a,P.tail=a.sibling,P.renderingStartTime=_s(),a.sibling=null,p=$o.current,fo($o,y?p&1|2:p&1),a):(Ba(a),null);case 22:case 23:return J_(),y=a.memoizedState!==null,i!==null&&i.memoizedState!==null!==y&&(a.flags|=8192),y&&a.mode&1?fc&1073741824&&(Ba(a),a.subtreeFlags&6&&(a.flags|=8192)):Ba(a),null;case 24:return null;case 25:return null}throw Error(Ri(156,a.tag))}function kT(i,a){switch(z_(a),a.tag){case 1:return jl(a.type)&&$3(),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return z0(),To(Vl),To(Ua),V_(),i=a.flags,i&65536&&!(i&128)?(a.flags=i&-65537|128,a):null;case 5:return N_(a),null;case 13:if(To($o),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(Ri(340));P0()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return To($o),null;case 4:return z0(),null;case 10:return B_(a.type._context),null;case 22:case 23:return J_(),null;case 24:return null;default:return null}}var h3=!1,Oa=!1,zT=typeof WeakSet=="function"?WeakSet:Set,pr=null;function _0(i,a){var p=i.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(y){rs(i,a,y)}else p.current=null}function Z6(i,a,p){try{p()}catch(y){rs(i,a,y)}}var xy=!1;function DT(i,a){if(I6=N3,i=C9(),P_(i)){if("selectionStart"in i)var p={start:i.selectionStart,end:i.selectionEnd};else e:{p=(p=i.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var T=y.anchorOffset,P=y.focusNode;y=y.focusOffset;try{p.nodeType,P.nodeType}catch{p=null;break e}var F=0,t=-1,j=-1,ie=0,ye=0,he=i,ne=null;t:for(;;){for(var Ye;he!==p||T!==0&&he.nodeType!==3||(t=F+T),he!==P||y!==0&&he.nodeType!==3||(j=F+y),he.nodeType===3&&(F+=he.nodeValue.length),(Ye=he.firstChild)!==null;)ne=he,he=Ye;for(;;){if(he===i)break t;if(ne===p&&++ie===T&&(t=F),ne===P&&++ye===y&&(j=F),(Ye=he.nextSibling)!==null)break;he=ne,ne=he.parentNode}he=Ye}p=t===-1||j===-1?null:{start:t,end:j}}else p=null}p=p||{start:0,end:0}}else p=null;for(A6={focusedElem:i,selectionRange:p},N3=!1,pr=a;pr!==null;)if(a=pr,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,pr=i;else for(;pr!==null;){a=pr;try{var lt=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var at=lt.memoizedProps,Kt=lt.memoizedState,Ne=a.stateNode,Le=Ne.getSnapshotBeforeUpdate(a.elementType===a.type?at:Pu(a.type,at),Kt);Ne.__reactInternalSnapshotBeforeUpdate=Le}break;case 3:var je=a.stateNode.containerInfo;je.nodeType===1?je.textContent="":je.nodeType===9&&je.documentElement&&je.removeChild(je.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ri(163))}}catch(_t){rs(a,a.return,_t)}if(i=a.sibling,i!==null){i.return=a.return,pr=i;break}pr=a.return}return lt=xy,xy=!1,lt}function p2(i,a,p){var y=a.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var T=y=y.next;do{if((T.tag&i)===i){var P=T.destroy;T.destroy=void 0,P!==void 0&&Z6(a,p,P)}T=T.next}while(T!==y)}}function C5(i,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var p=a=a.next;do{if((p.tag&i)===i){var y=p.create;p.destroy=y()}p=p.next}while(p!==a)}}function q6(i){var a=i.ref;if(a!==null){var p=i.stateNode;switch(i.tag){case 5:i=p;break;default:i=p}typeof a=="function"?a(i):a.current=i}}function Tx(i){var a=i.alternate;a!==null&&(i.alternate=null,Tx(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&(delete a[vh],delete a[C2],delete a[z6],delete a[mT],delete a[_T])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Ex(i){return i.tag===5||i.tag===3||i.tag===4}function vy(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Ex(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function W6(i,a,p){var y=i.tag;if(y===5||y===6)i=i.stateNode,a?p.nodeType===8?p.parentNode.insertBefore(i,a):p.insertBefore(i,a):(p.nodeType===8?(a=p.parentNode,a.insertBefore(i,p)):(a=p,a.appendChild(i)),p=p._reactRootContainer,p!=null||a.onclick!==null||(a.onclick=G3));else if(y!==4&&(i=i.child,i!==null))for(W6(i,a,p),i=i.sibling;i!==null;)W6(i,a,p),i=i.sibling}function X6(i,a,p){var y=i.tag;if(y===5||y===6)i=i.stateNode,a?p.insertBefore(i,a):p.appendChild(i);else if(y!==4&&(i=i.child,i!==null))for(X6(i,a,p),i=i.sibling;i!==null;)X6(i,a,p),i=i.sibling}var ma=null,ku=!1;function H1(i,a,p){for(p=p.child;p!==null;)Sx(i,a,p),p=p.sibling}function Sx(i,a,p){if(bh&&typeof bh.onCommitFiberUnmount=="function")try{bh.onCommitFiberUnmount(x5,p)}catch{}switch(p.tag){case 5:Oa||_0(p,a);case 6:var y=ma,T=ku;ma=null,H1(i,a,p),ma=y,ku=T,ma!==null&&(ku?(i=ma,p=p.stateNode,i.nodeType===8?i.parentNode.removeChild(p):i.removeChild(p)):ma.removeChild(p.stateNode));break;case 18:ma!==null&&(ku?(i=ma,p=p.stateNode,i.nodeType===8?V4(i.parentNode,p):i.nodeType===1&&V4(i,p),w2(i)):V4(ma,p.stateNode));break;case 4:y=ma,T=ku,ma=p.stateNode.containerInfo,ku=!0,H1(i,a,p),ma=y,ku=T;break;case 0:case 11:case 14:case 15:if(!Oa&&(y=p.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){T=y=y.next;do{var P=T,F=P.destroy;P=P.tag,F!==void 0&&(P&2||P&4)&&Z6(p,a,F),T=T.next}while(T!==y)}H1(i,a,p);break;case 1:if(!Oa&&(_0(p,a),y=p.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=p.memoizedProps,y.state=p.memoizedState,y.componentWillUnmount()}catch(t){rs(p,a,t)}H1(i,a,p);break;case 21:H1(i,a,p);break;case 22:p.mode&1?(Oa=(y=Oa)||p.memoizedState!==null,H1(i,a,p),Oa=y):H1(i,a,p);break;default:H1(i,a,p)}}function by(i){var a=i.updateQueue;if(a!==null){i.updateQueue=null;var p=i.stateNode;p===null&&(p=i.stateNode=new zT),a.forEach(function(y){var T=jT.bind(null,i,y);p.has(y)||(p.add(y),y.then(T,T))})}}function Au(i,a){var p=a.deletions;if(p!==null)for(var y=0;y<p.length;y++){var T=p[y];try{var P=i,F=a,t=F;e:for(;t!==null;){switch(t.tag){case 5:ma=t.stateNode,ku=!1;break e;case 3:ma=t.stateNode.containerInfo,ku=!0;break e;case 4:ma=t.stateNode.containerInfo,ku=!0;break e}t=t.return}if(ma===null)throw Error(Ri(160));Sx(P,F,T),ma=null,ku=!1;var j=T.alternate;j!==null&&(j.return=null),T.return=null}catch(ie){rs(T,a,ie)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Mx(a,i),a=a.sibling}function Mx(i,a){var p=i.alternate,y=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Au(a,i),yh(i),y&4){try{p2(3,i,i.return),C5(3,i)}catch(at){rs(i,i.return,at)}try{p2(5,i,i.return)}catch(at){rs(i,i.return,at)}}break;case 1:Au(a,i),yh(i),y&512&&p!==null&&_0(p,p.return);break;case 5:if(Au(a,i),yh(i),y&512&&p!==null&&_0(p,p.return),i.flags&32){var T=i.stateNode;try{y2(T,"")}catch(at){rs(i,i.return,at)}}if(y&4&&(T=i.stateNode,T!=null)){var P=i.memoizedProps,F=p!==null?p.memoizedProps:P,t=i.type,j=i.updateQueue;if(i.updateQueue=null,j!==null)try{t==="input"&&P.type==="radio"&&P.name!=null&&X8(T,P),y6(t,F);var ie=y6(t,P);for(F=0;F<j.length;F+=2){var ye=j[F],he=j[F+1];ye==="style"?Q8(T,he):ye==="dangerouslySetInnerHTML"?Y8(T,he):ye==="children"?y2(T,he):g_(T,ye,he,ie)}switch(t){case"input":p6(T,P);break;case"textarea":H8(T,P);break;case"select":var ne=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!P.multiple;var Ye=P.value;Ye!=null?x0(T,!!P.multiple,Ye,!1):ne!==!!P.multiple&&(P.defaultValue!=null?x0(T,!!P.multiple,P.defaultValue,!0):x0(T,!!P.multiple,P.multiple?[]:"",!1))}T[C2]=P}catch(at){rs(i,i.return,at)}}break;case 6:if(Au(a,i),yh(i),y&4){if(i.stateNode===null)throw Error(Ri(162));T=i.stateNode,P=i.memoizedProps;try{T.nodeValue=P}catch(at){rs(i,i.return,at)}}break;case 3:if(Au(a,i),yh(i),y&4&&p!==null&&p.memoizedState.isDehydrated)try{w2(a.containerInfo)}catch(at){rs(i,i.return,at)}break;case 4:Au(a,i),yh(i);break;case 13:Au(a,i),yh(i),T=i.child,T.flags&8192&&(P=T.memoizedState!==null,T.stateNode.isHidden=P,!P||T.alternate!==null&&T.alternate.memoizedState!==null||(K_=_s())),y&4&&by(i);break;case 22:if(ye=p!==null&&p.memoizedState!==null,i.mode&1?(Oa=(ie=Oa)||ye,Au(a,i),Oa=ie):Au(a,i),yh(i),y&8192){if(ie=i.memoizedState!==null,(i.stateNode.isHidden=ie)&&!ye&&i.mode&1)for(pr=i,ye=i.child;ye!==null;){for(he=pr=ye;pr!==null;){switch(ne=pr,Ye=ne.child,ne.tag){case 0:case 11:case 14:case 15:p2(4,ne,ne.return);break;case 1:_0(ne,ne.return);var lt=ne.stateNode;if(typeof lt.componentWillUnmount=="function"){y=ne,p=ne.return;try{a=y,lt.props=a.memoizedProps,lt.state=a.memoizedState,lt.componentWillUnmount()}catch(at){rs(y,p,at)}}break;case 5:_0(ne,ne.return);break;case 22:if(ne.memoizedState!==null){Ty(he);continue}}Ye!==null?(Ye.return=ne,pr=Ye):Ty(he)}ye=ye.sibling}e:for(ye=null,he=i;;){if(he.tag===5){if(ye===null){ye=he;try{T=he.stateNode,ie?(P=T.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none"):(t=he.stateNode,j=he.memoizedProps.style,F=j!=null&&j.hasOwnProperty("display")?j.display:null,t.style.display=J8("display",F))}catch(at){rs(i,i.return,at)}}}else if(he.tag===6){if(ye===null)try{he.stateNode.nodeValue=ie?"":he.memoizedProps}catch(at){rs(i,i.return,at)}}else if((he.tag!==22&&he.tag!==23||he.memoizedState===null||he===i)&&he.child!==null){he.child.return=he,he=he.child;continue}if(he===i)break e;for(;he.sibling===null;){if(he.return===null||he.return===i)break e;ye===he&&(ye=null),he=he.return}ye===he&&(ye=null),he.sibling.return=he.return,he=he.sibling}}break;case 19:Au(a,i),yh(i),y&4&&by(i);break;case 21:break;default:Au(a,i),yh(i)}}function yh(i){var a=i.flags;if(a&2){try{e:{for(var p=i.return;p!==null;){if(Ex(p)){var y=p;break e}p=p.return}throw Error(Ri(160))}switch(y.tag){case 5:var T=y.stateNode;y.flags&32&&(y2(T,""),y.flags&=-33);var P=vy(i);X6(i,P,T);break;case 3:case 4:var F=y.stateNode.containerInfo,t=vy(i);W6(i,t,F);break;default:throw Error(Ri(161))}}catch(j){rs(i,i.return,j)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function LT(i,a,p){pr=i,Cx(i)}function Cx(i,a,p){for(var y=(i.mode&1)!==0;pr!==null;){var T=pr,P=T.child;if(T.tag===22&&y){var F=T.memoizedState!==null||h3;if(!F){var t=T.alternate,j=t!==null&&t.memoizedState!==null||Oa;t=h3;var ie=Oa;if(h3=F,(Oa=j)&&!ie)for(pr=T;pr!==null;)F=pr,j=F.child,F.tag===22&&F.memoizedState!==null?Ey(T):j!==null?(j.return=F,pr=j):Ey(T);for(;P!==null;)pr=P,Cx(P),P=P.sibling;pr=T,h3=t,Oa=ie}wy(i)}else T.subtreeFlags&8772&&P!==null?(P.return=T,pr=P):wy(i)}}function wy(i){for(;pr!==null;){var a=pr;if(a.flags&8772){var p=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:Oa||C5(5,a);break;case 1:var y=a.stateNode;if(a.flags&4&&!Oa)if(p===null)y.componentDidMount();else{var T=a.elementType===a.type?p.memoizedProps:Pu(a.type,p.memoizedProps);y.componentDidUpdate(T,p.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var P=a.updateQueue;P!==null&&sy(a,P,y);break;case 3:var F=a.updateQueue;if(F!==null){if(p=null,a.child!==null)switch(a.child.tag){case 5:p=a.child.stateNode;break;case 1:p=a.child.stateNode}sy(a,F,p)}break;case 5:var t=a.stateNode;if(p===null&&a.flags&4){p=t;var j=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":j.autoFocus&&p.focus();break;case"img":j.src&&(p.src=j.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var ie=a.alternate;if(ie!==null){var ye=ie.memoizedState;if(ye!==null){var he=ye.dehydrated;he!==null&&w2(he)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ri(163))}Oa||a.flags&512&&q6(a)}catch(ne){rs(a,a.return,ne)}}if(a===i){pr=null;break}if(p=a.sibling,p!==null){p.return=a.return,pr=p;break}pr=a.return}}function Ty(i){for(;pr!==null;){var a=pr;if(a===i){pr=null;break}var p=a.sibling;if(p!==null){p.return=a.return,pr=p;break}pr=a.return}}function Ey(i){for(;pr!==null;){var a=pr;try{switch(a.tag){case 0:case 11:case 15:var p=a.return;try{C5(4,a)}catch(j){rs(a,p,j)}break;case 1:var y=a.stateNode;if(typeof y.componentDidMount=="function"){var T=a.return;try{y.componentDidMount()}catch(j){rs(a,T,j)}}var P=a.return;try{q6(a)}catch(j){rs(a,P,j)}break;case 5:var F=a.return;try{q6(a)}catch(j){rs(a,F,j)}}}catch(j){rs(a,a.return,j)}if(a===i){pr=null;break}var t=a.sibling;if(t!==null){t.return=a.return,pr=t;break}pr=a.return}}var RT=Math.ceil,e5=h1.ReactCurrentDispatcher,X_=h1.ReactCurrentOwner,Kc=h1.ReactCurrentBatchConfig,Rn=0,ia=null,Ls=null,_a=0,fc=0,g0=vd(0),Gs=0,D2=null,lp=0,I5=0,H_=0,f2=null,Ul=null,K_=0,L0=1/0,e1=null,t5=!1,H6=null,hd=null,d3=!1,nd=null,i5=0,m2=0,K6=null,I3=-1,A3=0;function sl(){return Rn&6?_s():I3!==-1?I3:I3=_s()}function dd(i){return i.mode&1?Rn&2&&_a!==0?_a&-_a:yT.transition!==null?(A3===0&&(A3=h9()),A3):(i=Qn,i!==0||(i=window.event,i=i===void 0?16:y9(i.type)),i):1}function Bu(i,a,p,y){if(50<m2)throw m2=0,K6=null,Error(Ri(185));V2(i,p,y),(!(Rn&2)||i!==ia)&&(i===ia&&(!(Rn&2)&&(I5|=p),Gs===4&&id(i,_a)),Gl(i,y),p===1&&Rn===0&&!(a.mode&1)&&(L0=_s()+500,E5&&bd()))}function Gl(i,a){var p=i.callbackNode;yw(i,a);var y=U3(i,i===ia?_a:0);if(y===0)p!==null&&D7(p),i.callbackNode=null,i.callbackPriority=0;else if(a=y&-y,i.callbackPriority!==a){if(p!=null&&D7(p),a===1)i.tag===0?gT(Sy.bind(null,i)):F9(Sy.bind(null,i)),pT(function(){!(Rn&6)&&bd()}),p=null;else{switch(d9(y)){case 1:p=w_;break;case 4:p=c9;break;case 16:p=O3;break;case 536870912:p=u9;break;default:p=O3}p=Rx(p,Ix.bind(null,i))}i.callbackPriority=a,i.callbackNode=p}}function Ix(i,a){if(I3=-1,A3=0,Rn&6)throw Error(Ri(327));var p=i.callbackNode;if(E0()&&i.callbackNode!==p)return null;var y=U3(i,i===ia?_a:0);if(y===0)return null;if(y&30||y&i.expiredLanes||a)a=r5(i,y);else{a=y;var T=Rn;Rn|=2;var P=Px();(ia!==i||_a!==a)&&(e1=null,L0=_s()+500,rp(i,a));do try{OT();break}catch(t){Ax(i,t)}while(1);R_(),e5.current=P,Rn=T,Ls!==null?a=0:(ia=null,_a=0,a=Gs)}if(a!==0){if(a===2&&(T=T6(i),T!==0&&(y=T,a=Y6(i,T))),a===1)throw p=D2,rp(i,0),id(i,y),Gl(i,_s()),p;if(a===6)id(i,y);else{if(T=i.current.alternate,!(y&30)&&!BT(T)&&(a=r5(i,y),a===2&&(P=T6(i),P!==0&&(y=P,a=Y6(i,P))),a===1))throw p=D2,rp(i,0),id(i,y),Gl(i,_s()),p;switch(i.finishedWork=T,i.finishedLanes=y,a){case 0:case 1:throw Error(Ri(345));case 2:Kd(i,Ul,e1);break;case 3:if(id(i,y),(y&130023424)===y&&(a=K_+500-_s(),10<a)){if(U3(i,0)!==0)break;if(T=i.suspendedLanes,(T&y)!==y){sl(),i.pingedLanes|=i.suspendedLanes&T;break}i.timeoutHandle=k6(Kd.bind(null,i,Ul,e1),a);break}Kd(i,Ul,e1);break;case 4:if(id(i,y),(y&4194240)===y)break;for(a=i.eventTimes,T=-1;0<y;){var F=31-Ru(y);P=1<<F,F=a[F],F>T&&(T=F),y&=~P}if(y=T,y=_s()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*RT(y/1960))-y,10<y){i.timeoutHandle=k6(Kd.bind(null,i,Ul,e1),y);break}Kd(i,Ul,e1);break;case 5:Kd(i,Ul,e1);break;default:throw Error(Ri(329))}}}return Gl(i,_s()),i.callbackNode===p?Ix.bind(null,i):null}function Y6(i,a){var p=f2;return i.current.memoizedState.isDehydrated&&(rp(i,a).flags|=256),i=r5(i,a),i!==2&&(a=Ul,Ul=p,a!==null&&J6(a)),i}function J6(i){Ul===null?Ul=i:Ul.push.apply(Ul,i)}function BT(i){for(var a=i;;){if(a.flags&16384){var p=a.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var y=0;y<p.length;y++){var T=p[y],P=T.getSnapshot;T=T.value;try{if(!Fu(P(),T))return!1}catch{return!1}}}if(p=a.child,a.subtreeFlags&16384&&p!==null)p.return=a,a=p;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function id(i,a){for(a&=~H_,a&=~I5,i.suspendedLanes|=a,i.pingedLanes&=~a,i=i.expirationTimes;0<a;){var p=31-Ru(a),y=1<<p;i[p]=-1,a&=~y}}function Sy(i){if(Rn&6)throw Error(Ri(327));E0();var a=U3(i,0);if(!(a&1))return Gl(i,_s()),null;var p=r5(i,a);if(i.tag!==0&&p===2){var y=T6(i);y!==0&&(a=y,p=Y6(i,y))}if(p===1)throw p=D2,rp(i,0),id(i,a),Gl(i,_s()),p;if(p===6)throw Error(Ri(345));return i.finishedWork=i.current.alternate,i.finishedLanes=a,Kd(i,Ul,e1),Gl(i,_s()),null}function Y_(i,a){var p=Rn;Rn|=1;try{return i(a)}finally{Rn=p,Rn===0&&(L0=_s()+500,E5&&bd())}}function cp(i){nd!==null&&nd.tag===0&&!(Rn&6)&&E0();var a=Rn;Rn|=1;var p=Kc.transition,y=Qn;try{if(Kc.transition=null,Qn=1,i)return i()}finally{Qn=y,Kc.transition=p,Rn=a,!(Rn&6)&&bd()}}function J_(){fc=g0.current,To(g0)}function rp(i,a){i.finishedWork=null,i.finishedLanes=0;var p=i.timeoutHandle;if(p!==-1&&(i.timeoutHandle=-1,dT(p)),Ls!==null)for(p=Ls.return;p!==null;){var y=p;switch(z_(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&$3();break;case 3:z0(),To(Vl),To(Ua),V_();break;case 5:N_(y);break;case 4:z0();break;case 13:To($o);break;case 19:To($o);break;case 10:B_(y.type._context);break;case 22:case 23:J_()}p=p.return}if(ia=i,Ls=i=pd(i.current,null),_a=fc=a,Gs=0,D2=null,H_=I5=lp=0,Ul=f2=null,ep!==null){for(a=0;a<ep.length;a++)if(p=ep[a],y=p.interleaved,y!==null){p.interleaved=null;var T=y.next,P=p.pending;if(P!==null){var F=P.next;P.next=T,y.next=F}p.pending=y}ep=null}return i}function Ax(i,a){do{var p=Ls;try{if(R_(),S3.current=Q3,J3){for(var y=Zo.memoizedState;y!==null;){var T=y.queue;T!==null&&(T.pending=null),y=y.next}J3=!1}if(ap=0,ta=js=Zo=null,d2=!1,P2=0,X_.current=null,p===null||p.return===null){Gs=1,D2=a,Ls=null;break}e:{var P=i,F=p.return,t=p,j=a;if(a=_a,t.flags|=32768,j!==null&&typeof j=="object"&&typeof j.then=="function"){var ie=j,ye=t,he=ye.tag;if(!(ye.mode&1)&&(he===0||he===11||he===15)){var ne=ye.alternate;ne?(ye.updateQueue=ne.updateQueue,ye.memoizedState=ne.memoizedState,ye.lanes=ne.lanes):(ye.updateQueue=null,ye.memoizedState=null)}var Ye=dy(F);if(Ye!==null){Ye.flags&=-257,py(Ye,F,t,P,a),Ye.mode&1&&hy(P,ie,a),a=Ye,j=ie;var lt=a.updateQueue;if(lt===null){var at=new Set;at.add(j),a.updateQueue=at}else lt.add(j);break e}else{if(!(a&1)){hy(P,ie,a),Q_();break e}j=Error(Ri(426))}}else if(Co&&t.mode&1){var Kt=dy(F);if(Kt!==null){!(Kt.flags&65536)&&(Kt.flags|=256),py(Kt,F,t,P,a),D_(D0(j,t));break e}}P=j=D0(j,t),Gs!==4&&(Gs=2),f2===null?f2=[P]:f2.push(P),P=F;do{switch(P.tag){case 3:P.flags|=65536,a&=-a,P.lanes|=a;var Ne=dx(P,j,a);oy(P,Ne);break e;case 1:t=j;var Le=P.type,je=P.stateNode;if(!(P.flags&128)&&(typeof Le.getDerivedStateFromError=="function"||je!==null&&typeof je.componentDidCatch=="function"&&(hd===null||!hd.has(je)))){P.flags|=65536,a&=-a,P.lanes|=a;var _t=px(P,t,a);oy(P,_t);break e}}P=P.return}while(P!==null)}zx(p)}catch(St){a=St,Ls===p&&p!==null&&(Ls=p=p.return);continue}break}while(1)}function Px(){var i=e5.current;return e5.current=Q3,i===null?Q3:i}function Q_(){(Gs===0||Gs===3||Gs===2)&&(Gs=4),ia===null||!(lp&268435455)&&!(I5&268435455)||id(ia,_a)}function r5(i,a){var p=Rn;Rn|=2;var y=Px();(ia!==i||_a!==a)&&(e1=null,rp(i,a));do try{FT();break}catch(T){Ax(i,T)}while(1);if(R_(),Rn=p,e5.current=y,Ls!==null)throw Error(Ri(261));return ia=null,_a=0,Gs}function FT(){for(;Ls!==null;)kx(Ls)}function OT(){for(;Ls!==null&&!cw();)kx(Ls)}function kx(i){var a=Lx(i.alternate,i,fc);i.memoizedProps=i.pendingProps,a===null?zx(i):Ls=a,X_.current=null}function zx(i){var a=i;do{var p=a.alternate;if(i=a.return,a.flags&32768){if(p=kT(p,a),p!==null){p.flags&=32767,Ls=p;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Gs=6,Ls=null;return}}else if(p=PT(p,a,fc),p!==null){Ls=p;return}if(a=a.sibling,a!==null){Ls=a;return}Ls=a=i}while(a!==null);Gs===0&&(Gs=5)}function Kd(i,a,p){var y=Qn,T=Kc.transition;try{Kc.transition=null,Qn=1,UT(i,a,p,y)}finally{Kc.transition=T,Qn=y}return null}function UT(i,a,p,y){do E0();while(nd!==null);if(Rn&6)throw Error(Ri(327));p=i.finishedWork;var T=i.finishedLanes;if(p===null)return null;if(i.finishedWork=null,i.finishedLanes=0,p===i.current)throw Error(Ri(177));i.callbackNode=null,i.callbackPriority=0;var P=p.lanes|p.childLanes;if(xw(i,P),i===ia&&(Ls=ia=null,_a=0),!(p.subtreeFlags&2064)&&!(p.flags&2064)||d3||(d3=!0,Rx(O3,function(){return E0(),null})),P=(p.flags&15990)!==0,p.subtreeFlags&15990||P){P=Kc.transition,Kc.transition=null;var F=Qn;Qn=1;var t=Rn;Rn|=4,X_.current=null,DT(i,p),Mx(p,i),oT(A6),N3=!!I6,A6=I6=null,i.current=p,LT(p),uw(),Rn=t,Qn=F,Kc.transition=P}else i.current=p;if(d3&&(d3=!1,nd=i,i5=T),P=i.pendingLanes,P===0&&(hd=null),pw(p.stateNode),Gl(i,_s()),a!==null)for(y=i.onRecoverableError,p=0;p<a.length;p++)T=a[p],y(T.value,{componentStack:T.stack,digest:T.digest});if(t5)throw t5=!1,i=H6,H6=null,i;return i5&1&&i.tag!==0&&E0(),P=i.pendingLanes,P&1?i===K6?m2++:(m2=0,K6=i):m2=0,bd(),null}function E0(){if(nd!==null){var i=d9(i5),a=Kc.transition,p=Qn;try{if(Kc.transition=null,Qn=16>i?16:i,nd===null)var y=!1;else{if(i=nd,nd=null,i5=0,Rn&6)throw Error(Ri(331));var T=Rn;for(Rn|=4,pr=i.current;pr!==null;){var P=pr,F=P.child;if(pr.flags&16){var t=P.deletions;if(t!==null){for(var j=0;j<t.length;j++){var ie=t[j];for(pr=ie;pr!==null;){var ye=pr;switch(ye.tag){case 0:case 11:case 15:p2(8,ye,P)}var he=ye.child;if(he!==null)he.return=ye,pr=he;else for(;pr!==null;){ye=pr;var ne=ye.sibling,Ye=ye.return;if(Tx(ye),ye===ie){pr=null;break}if(ne!==null){ne.return=Ye,pr=ne;break}pr=Ye}}}var lt=P.alternate;if(lt!==null){var at=lt.child;if(at!==null){lt.child=null;do{var Kt=at.sibling;at.sibling=null,at=Kt}while(at!==null)}}pr=P}}if(P.subtreeFlags&2064&&F!==null)F.return=P,pr=F;else e:for(;pr!==null;){if(P=pr,P.flags&2048)switch(P.tag){case 0:case 11:case 15:p2(9,P,P.return)}var Ne=P.sibling;if(Ne!==null){Ne.return=P.return,pr=Ne;break e}pr=P.return}}var Le=i.current;for(pr=Le;pr!==null;){F=pr;var je=F.child;if(F.subtreeFlags&2064&&je!==null)je.return=F,pr=je;else e:for(F=Le;pr!==null;){if(t=pr,t.flags&2048)try{switch(t.tag){case 0:case 11:case 15:C5(9,t)}}catch(St){rs(t,t.return,St)}if(t===F){pr=null;break e}var _t=t.sibling;if(_t!==null){_t.return=t.return,pr=_t;break e}pr=t.return}}if(Rn=T,bd(),bh&&typeof bh.onPostCommitFiberRoot=="function")try{bh.onPostCommitFiberRoot(x5,i)}catch{}y=!0}return y}finally{Qn=p,Kc.transition=a}}return!1}function My(i,a,p){a=D0(p,a),a=dx(i,a,1),i=ud(i,a,1),a=sl(),i!==null&&(V2(i,1,a),Gl(i,a))}function rs(i,a,p){if(i.tag===3)My(i,i,p);else for(;a!==null;){if(a.tag===3){My(a,i,p);break}else if(a.tag===1){var y=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(hd===null||!hd.has(y))){i=D0(p,i),i=px(a,i,1),a=ud(a,i,1),i=sl(),a!==null&&(V2(a,1,i),Gl(a,i));break}}a=a.return}}function NT(i,a,p){var y=i.pingCache;y!==null&&y.delete(a),a=sl(),i.pingedLanes|=i.suspendedLanes&p,ia===i&&(_a&p)===p&&(Gs===4||Gs===3&&(_a&130023424)===_a&&500>_s()-K_?rp(i,0):H_|=p),Gl(i,a)}function Dx(i,a){a===0&&(i.mode&1?(a=i3,i3<<=1,!(i3&130023424)&&(i3=4194304)):a=1);var p=sl();i=c1(i,a),i!==null&&(V2(i,a,p),Gl(i,p))}function VT(i){var a=i.memoizedState,p=0;a!==null&&(p=a.retryLane),Dx(i,p)}function jT(i,a){var p=0;switch(i.tag){case 13:var y=i.stateNode,T=i.memoizedState;T!==null&&(p=T.retryLane);break;case 19:y=i.stateNode;break;default:throw Error(Ri(314))}y!==null&&y.delete(a),Dx(i,p)}var Lx;Lx=function(i,a,p){if(i!==null)if(i.memoizedProps!==a.pendingProps||Vl.current)Nl=!0;else{if(!(i.lanes&p)&&!(a.flags&128))return Nl=!1,AT(i,a,p);Nl=!!(i.flags&131072)}else Nl=!1,Co&&a.flags&1048576&&O9(a,W3,a.index);switch(a.lanes=0,a.tag){case 2:var y=a.type;C3(i,a),i=a.pendingProps;var T=A0(a,Ua.current);T0(a,p),T=G_(null,a,y,i,T,p);var P=$_();return a.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,jl(y)?(P=!0,Z3(a)):P=!1,a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,O_(a),T.updater=M5,a.stateNode=T,T._reactInternals=a,O6(a,y,i,p),a=V6(null,a,y,!0,P,p)):(a.tag=0,Co&&P&&k_(a),nl(null,a,T,p),a=a.child),a;case 16:y=a.elementType;e:{switch(C3(i,a),i=a.pendingProps,T=y._init,y=T(y._payload),a.type=y,T=a.tag=$T(y),i=Pu(y,i),T){case 0:a=N6(null,a,y,i,p);break e;case 1:a=_y(null,a,y,i,p);break e;case 11:a=fy(null,a,y,i,p);break e;case 14:a=my(null,a,y,Pu(y.type,i),p);break e}throw Error(Ri(306,y,""))}return a;case 0:return y=a.type,T=a.pendingProps,T=a.elementType===y?T:Pu(y,T),N6(i,a,y,T,p);case 1:return y=a.type,T=a.pendingProps,T=a.elementType===y?T:Pu(y,T),_y(i,a,y,T,p);case 3:e:{if(gx(a),i===null)throw Error(Ri(387));y=a.pendingProps,P=a.memoizedState,T=P.element,$9(i,a),K3(a,y,null,p);var F=a.memoizedState;if(y=F.element,P.isDehydrated)if(P={element:y,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},a.updateQueue.baseState=P,a.memoizedState=P,a.flags&256){T=D0(Error(Ri(423)),a),a=gy(i,a,y,p,T);break e}else if(y!==T){T=D0(Error(Ri(424)),a),a=gy(i,a,y,p,T);break e}else for(yc=cd(a.stateNode.containerInfo.firstChild),xc=a,Co=!0,Du=null,p=j9(a,null,y,p),a.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(P0(),y===T){a=u1(i,a,p);break e}nl(i,a,y,p)}a=a.child}return a;case 5:return Z9(a),i===null&&R6(a),y=a.type,T=a.pendingProps,P=i!==null?i.memoizedProps:null,F=T.children,P6(y,T)?F=null:P!==null&&P6(y,P)&&(a.flags|=32),_x(i,a),nl(i,a,F,p),a.child;case 6:return i===null&&R6(a),null;case 13:return yx(i,a,p);case 4:return U_(a,a.stateNode.containerInfo),y=a.pendingProps,i===null?a.child=k0(a,null,y,p):nl(i,a,y,p),a.child;case 11:return y=a.type,T=a.pendingProps,T=a.elementType===y?T:Pu(y,T),fy(i,a,y,T,p);case 7:return nl(i,a,a.pendingProps,p),a.child;case 8:return nl(i,a,a.pendingProps.children,p),a.child;case 12:return nl(i,a,a.pendingProps.children,p),a.child;case 10:e:{if(y=a.type._context,T=a.pendingProps,P=a.memoizedProps,F=T.value,fo(X3,y._currentValue),y._currentValue=F,P!==null)if(Fu(P.value,F)){if(P.children===T.children&&!Vl.current){a=u1(i,a,p);break e}}else for(P=a.child,P!==null&&(P.return=a);P!==null;){var t=P.dependencies;if(t!==null){F=P.child;for(var j=t.firstContext;j!==null;){if(j.context===y){if(P.tag===1){j=o1(-1,p&-p),j.tag=2;var ie=P.updateQueue;if(ie!==null){ie=ie.shared;var ye=ie.pending;ye===null?j.next=j:(j.next=ye.next,ye.next=j),ie.pending=j}}P.lanes|=p,j=P.alternate,j!==null&&(j.lanes|=p),B6(P.return,p,a),t.lanes|=p;break}j=j.next}}else if(P.tag===10)F=P.type===a.type?null:P.child;else if(P.tag===18){if(F=P.return,F===null)throw Error(Ri(341));F.lanes|=p,t=F.alternate,t!==null&&(t.lanes|=p),B6(F,p,a),F=P.sibling}else F=P.child;if(F!==null)F.return=P;else for(F=P;F!==null;){if(F===a){F=null;break}if(P=F.sibling,P!==null){P.return=F.return,F=P;break}F=F.return}P=F}nl(i,a,T.children,p),a=a.child}return a;case 9:return T=a.type,y=a.pendingProps.children,T0(a,p),T=Jc(T),y=y(T),a.flags|=1,nl(i,a,y,p),a.child;case 14:return y=a.type,T=Pu(y,a.pendingProps),T=Pu(y.type,T),my(i,a,y,T,p);case 15:return fx(i,a,a.type,a.pendingProps,p);case 17:return y=a.type,T=a.pendingProps,T=a.elementType===y?T:Pu(y,T),C3(i,a),a.tag=1,jl(y)?(i=!0,Z3(a)):i=!1,T0(a,p),hx(a,y,T),O6(a,y,T,p),V6(null,a,y,!0,i,p);case 19:return xx(i,a,p);case 22:return mx(i,a,p)}throw Error(Ri(156,a.tag))};function Rx(i,a){return l9(i,a)}function GT(i,a,p,y){this.tag=i,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hc(i,a,p,y){return new GT(i,a,p,y)}function eg(i){return i=i.prototype,!(!i||!i.isReactComponent)}function $T(i){if(typeof i=="function")return eg(i)?1:0;if(i!=null){if(i=i.$$typeof,i===x_)return 11;if(i===v_)return 14}return 2}function pd(i,a){var p=i.alternate;return p===null?(p=Hc(i.tag,a,i.key,i.mode),p.elementType=i.elementType,p.type=i.type,p.stateNode=i.stateNode,p.alternate=i,i.alternate=p):(p.pendingProps=a,p.type=i.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=i.flags&14680064,p.childLanes=i.childLanes,p.lanes=i.lanes,p.child=i.child,p.memoizedProps=i.memoizedProps,p.memoizedState=i.memoizedState,p.updateQueue=i.updateQueue,a=i.dependencies,p.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},p.sibling=i.sibling,p.index=i.index,p.ref=i.ref,p}function P3(i,a,p,y,T,P){var F=2;if(y=i,typeof i=="function")eg(i)&&(F=1);else if(typeof i=="string")F=5;else e:switch(i){case a0:return np(p.children,T,P,a);case y_:F=8,T|=8;break;case l6:return i=Hc(12,p,a,T|2),i.elementType=l6,i.lanes=P,i;case c6:return i=Hc(13,p,a,T),i.elementType=c6,i.lanes=P,i;case u6:return i=Hc(19,p,a,T),i.elementType=u6,i.lanes=P,i;case Z8:return A5(p,T,P,a);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case G8:F=10;break e;case $8:F=9;break e;case x_:F=11;break e;case v_:F=14;break e;case Q1:F=16,y=null;break e}throw Error(Ri(130,i==null?i:typeof i,""))}return a=Hc(F,p,a,T),a.elementType=i,a.type=y,a.lanes=P,a}function np(i,a,p,y){return i=Hc(7,i,y,a),i.lanes=p,i}function A5(i,a,p,y){return i=Hc(22,i,y,a),i.elementType=Z8,i.lanes=p,i.stateNode={isHidden:!1},i}function H4(i,a,p){return i=Hc(6,i,null,a),i.lanes=p,i}function K4(i,a,p){return a=Hc(4,i.children!==null?i.children:[],i.key,a),a.lanes=p,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}function ZT(i,a,p,y,T){this.tag=a,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=P4(0),this.expirationTimes=P4(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=P4(0),this.identifierPrefix=y,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function tg(i,a,p,y,T,P,F,t,j){return i=new ZT(i,a,p,t,j),a===1?(a=1,P===!0&&(a|=8)):a=0,P=Hc(3,null,null,a),i.current=P,P.stateNode=i,P.memoizedState={element:y,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},O_(P),i}function qT(i,a,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s0,key:y==null?null:""+y,children:i,containerInfo:a,implementation:p}}function Bx(i){if(!i)return _d;i=i._reactInternals;e:{if(dp(i)!==i||i.tag!==1)throw Error(Ri(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(jl(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(Ri(171))}if(i.tag===1){var p=i.type;if(jl(p))return B9(i,p,a)}return a}function Fx(i,a,p,y,T,P,F,t,j){return i=tg(p,y,!0,i,T,P,F,t,j),i.context=Bx(null),p=i.current,y=sl(),T=dd(p),P=o1(y,T),P.callback=a??null,ud(p,P,T),i.current.lanes=T,V2(i,T,y),Gl(i,y),i}function P5(i,a,p,y){var T=a.current,P=sl(),F=dd(T);return p=Bx(p),a.context===null?a.context=p:a.pendingContext=p,a=o1(P,F),a.payload={element:i},y=y===void 0?null:y,y!==null&&(a.callback=y),i=ud(T,a,F),i!==null&&(Bu(i,T,F,P),E3(i,T,F)),F}function n5(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Cy(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var p=i.retryLane;i.retryLane=p!==0&&p<a?p:a}}function ig(i,a){Cy(i,a),(i=i.alternate)&&Cy(i,a)}function WT(){return null}var Ox=typeof reportError=="function"?reportError:function(i){console.error(i)};function rg(i){this._internalRoot=i}k5.prototype.render=rg.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(Ri(409));P5(i,a,null,null)};k5.prototype.unmount=rg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;cp(function(){P5(null,i,null,null)}),a[l1]=null}};function k5(i){this._internalRoot=i}k5.prototype.unstable_scheduleHydration=function(i){if(i){var a=m9();i={blockedOn:null,target:i,priority:a};for(var p=0;p<td.length&&a!==0&&a<td[p].priority;p++);td.splice(p,0,i),p===0&&g9(i)}};function ng(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function z5(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Iy(){}function XT(i,a,p,y,T){if(T){if(typeof y=="function"){var P=y;y=function(){var ie=n5(F);P.call(ie)}}var F=Fx(a,y,i,0,null,!1,!1,"",Iy);return i._reactRootContainer=F,i[l1]=F.current,S2(i.nodeType===8?i.parentNode:i),cp(),F}for(;T=i.lastChild;)i.removeChild(T);if(typeof y=="function"){var t=y;y=function(){var ie=n5(j);t.call(ie)}}var j=tg(i,0,!1,null,null,!1,!1,"",Iy);return i._reactRootContainer=j,i[l1]=j.current,S2(i.nodeType===8?i.parentNode:i),cp(function(){P5(a,j,p,y)}),j}function D5(i,a,p,y,T){var P=p._reactRootContainer;if(P){var F=P;if(typeof T=="function"){var t=T;T=function(){var j=n5(F);t.call(j)}}P5(a,F,i,T)}else F=XT(p,a,i,T,y);return n5(F)}p9=function(i){switch(i.tag){case 3:var a=i.stateNode;if(a.current.memoizedState.isDehydrated){var p=r2(a.pendingLanes);p!==0&&(T_(a,p|1),Gl(a,_s()),!(Rn&6)&&(L0=_s()+500,bd()))}break;case 13:cp(function(){var y=c1(i,1);if(y!==null){var T=sl();Bu(y,i,1,T)}}),ig(i,1)}};E_=function(i){if(i.tag===13){var a=c1(i,134217728);if(a!==null){var p=sl();Bu(a,i,134217728,p)}ig(i,134217728)}};f9=function(i){if(i.tag===13){var a=dd(i),p=c1(i,a);if(p!==null){var y=sl();Bu(p,i,a,y)}ig(i,a)}};m9=function(){return Qn};_9=function(i,a){var p=Qn;try{return Qn=i,a()}finally{Qn=p}};v6=function(i,a,p){switch(a){case"input":if(p6(i,p),a=p.name,p.type==="radio"&&a!=null){for(p=i;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<p.length;a++){var y=p[a];if(y!==i&&y.form===i.form){var T=T5(y);if(!T)throw Error(Ri(90));W8(y),p6(y,T)}}}break;case"textarea":H8(i,p);break;case"select":a=p.value,a!=null&&x0(i,!!p.multiple,a,!1)}};i9=Y_;r9=cp;var HT={usingClientEntryPoint:!1,Events:[G2,h0,T5,e9,t9,Y_]},Hf={findFiberByHostInstance:Qd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KT={bundleType:Hf.bundleType,version:Hf.version,rendererPackageName:Hf.rendererPackageName,rendererConfig:Hf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:h1.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=s9(i),i===null?null:i.stateNode},findFiberByHostInstance:Hf.findFiberByHostInstance||WT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var p3=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!p3.isDisabled&&p3.supportsFiber)try{x5=p3.inject(KT),bh=p3}catch{}}bc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HT;bc.createPortal=function(i,a){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ng(a))throw Error(Ri(200));return qT(i,a,null,p)};bc.createRoot=function(i,a){if(!ng(i))throw Error(Ri(299));var p=!1,y="",T=Ox;return a!=null&&(a.unstable_strictMode===!0&&(p=!0),a.identifierPrefix!==void 0&&(y=a.identifierPrefix),a.onRecoverableError!==void 0&&(T=a.onRecoverableError)),a=tg(i,1,!1,null,null,p,!1,y,T),i[l1]=a.current,S2(i.nodeType===8?i.parentNode:i),new rg(a)};bc.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(Ri(188)):(i=Object.keys(i).join(","),Error(Ri(268,i)));return i=s9(a),i=i===null?null:i.stateNode,i};bc.flushSync=function(i){return cp(i)};bc.hydrate=function(i,a,p){if(!z5(a))throw Error(Ri(200));return D5(null,i,a,!0,p)};bc.hydrateRoot=function(i,a,p){if(!ng(i))throw Error(Ri(405));var y=p!=null&&p.hydratedSources||null,T=!1,P="",F=Ox;if(p!=null&&(p.unstable_strictMode===!0&&(T=!0),p.identifierPrefix!==void 0&&(P=p.identifierPrefix),p.onRecoverableError!==void 0&&(F=p.onRecoverableError)),a=Fx(a,null,i,1,p??null,T,!1,P,F),i[l1]=a.current,S2(i),y)for(i=0;i<y.length;i++)p=y[i],T=p._getVersion,T=T(p._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[p,T]:a.mutableSourceEagerHydrationData.push(p,T);return new k5(a)};bc.render=function(i,a,p){if(!z5(a))throw Error(Ri(200));return D5(null,i,a,!1,p)};bc.unmountComponentAtNode=function(i){if(!z5(i))throw Error(Ri(40));return i._reactRootContainer?(cp(function(){D5(null,null,i,!1,function(){i._reactRootContainer=null,i[l1]=null})}),!0):!1};bc.unstable_batchedUpdates=Y_;bc.unstable_renderSubtreeIntoContainer=function(i,a,p,y){if(!z5(p))throw Error(Ri(200));if(i==null||i._reactInternals===void 0)throw Error(Ri(38));return D5(i,a,p,!1,y)};bc.version="18.3.1-next-f1338f8080-20240426";function Ux(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ux)}catch(i){console.error(i)}}Ux(),U8.exports=bc;var Z2=U8.exports;const YT=yd(Z2),JT=u_({__proto__:null,default:YT},[Z2]);var Ay=Z2;T7.createRoot=Ay.createRoot,T7.hydrateRoot=Ay.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mo(){return Mo=Object.assign?Object.assign.bind():function(i){for(var a=1;a<arguments.length;a++){var p=arguments[a];for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(i[y]=p[y])}return i},Mo.apply(this,arguments)}var ms;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(ms||(ms={}));const Py="popstate";function QT(i){i===void 0&&(i={});function a(y,T){let{pathname:P,search:F,hash:t}=y.location;return L2("",{pathname:P,search:F,hash:t},T.state&&T.state.usr||null,T.state&&T.state.key||"default")}function p(y,T){return typeof T=="string"?T:up(T)}return tE(a,p,null,i)}function vn(i,a){if(i===!1||i===null||typeof i>"u")throw new Error(a)}function R0(i,a){if(!i){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function eE(){return Math.random().toString(36).substr(2,8)}function ky(i,a){return{usr:i.state,key:i.key,idx:a}}function L2(i,a,p,y){return p===void 0&&(p=null),Mo({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof a=="string"?d1(a):a,{state:p,key:a&&a.key||y||eE()})}function up(i){let{pathname:a="/",search:p="",hash:y=""}=i;return p&&p!=="?"&&(a+=p.charAt(0)==="?"?p:"?"+p),y&&y!=="#"&&(a+=y.charAt(0)==="#"?y:"#"+y),a}function d1(i){let a={};if(i){let p=i.indexOf("#");p>=0&&(a.hash=i.substr(p),i=i.substr(0,p));let y=i.indexOf("?");y>=0&&(a.search=i.substr(y),i=i.substr(0,y)),i&&(a.pathname=i)}return a}function tE(i,a,p,y){y===void 0&&(y={});let{window:T=document.defaultView,v5Compat:P=!1}=y,F=T.history,t=ms.Pop,j=null,ie=ye();ie==null&&(ie=0,F.replaceState(Mo({},F.state,{idx:ie}),""));function ye(){return(F.state||{idx:null}).idx}function he(){t=ms.Pop;let Kt=ye(),Ne=Kt==null?null:Kt-ie;ie=Kt,j&&j({action:t,location:at.location,delta:Ne})}function ne(Kt,Ne){t=ms.Push;let Le=L2(at.location,Kt,Ne);p&&p(Le,Kt),ie=ye()+1;let je=ky(Le,ie),_t=at.createHref(Le);try{F.pushState(je,"",_t)}catch(St){if(St instanceof DOMException&&St.name==="DataCloneError")throw St;T.location.assign(_t)}P&&j&&j({action:t,location:at.location,delta:1})}function Ye(Kt,Ne){t=ms.Replace;let Le=L2(at.location,Kt,Ne);p&&p(Le,Kt),ie=ye();let je=ky(Le,ie),_t=at.createHref(Le);F.replaceState(je,"",_t),P&&j&&j({action:t,location:at.location,delta:0})}function lt(Kt){let Ne=T.location.origin!=="null"?T.location.origin:T.location.href,Le=typeof Kt=="string"?Kt:up(Kt);return Le=Le.replace(/ $/,"%20"),vn(Ne,"No window.location.(origin|href) available to create URL for href: "+Le),new URL(Le,Ne)}let at={get action(){return t},get location(){return i(T,F)},listen(Kt){if(j)throw new Error("A history only accepts one active listener");return T.addEventListener(Py,he),j=Kt,()=>{T.removeEventListener(Py,he),j=null}},createHref(Kt){return a(T,Kt)},createURL:lt,encodeLocation(Kt){let Ne=lt(Kt);return{pathname:Ne.pathname,search:Ne.search,hash:Ne.hash}},push:ne,replace:Ye,go(Kt){return F.go(Kt)}};return at}var Jn;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(Jn||(Jn={}));const iE=new Set(["lazy","caseSensitive","path","id","index","children"]);function rE(i){return i.index===!0}function o5(i,a,p,y){return p===void 0&&(p=[]),y===void 0&&(y={}),i.map((T,P)=>{let F=[...p,String(P)],t=typeof T.id=="string"?T.id:F.join("-");if(vn(T.index!==!0||!T.children,"Cannot specify children on an index route"),vn(!y[t],'Found a route id collision on id "'+t+`".  Route id's must be globally unique within Data Router usages`),rE(T)){let j=Mo({},T,a(T),{id:t});return y[t]=j,j}else{let j=Mo({},T,a(T),{id:t,children:void 0});return y[t]=j,T.children&&(j.children=o5(T.children,a,F,y)),j}})}function Yd(i,a,p){return p===void 0&&(p="/"),k3(i,a,p,!1)}function k3(i,a,p,y){let T=typeof a=="string"?d1(a):a,P=G0(T.pathname||"/",p);if(P==null)return null;let F=Nx(i);oE(F);let t=null;for(let j=0;t==null&&j<F.length;++j){let ie=_E(P);t=fE(F[j],ie,y)}return t}function nE(i,a){let{route:p,pathname:y,params:T}=i;return{id:p.id,pathname:y,params:T,data:a[p.id],handle:p.handle}}function Nx(i,a,p,y){a===void 0&&(a=[]),p===void 0&&(p=[]),y===void 0&&(y="");let T=(P,F,t)=>{let j={relativePath:t===void 0?P.path||"":t,caseSensitive:P.caseSensitive===!0,childrenIndex:F,route:P};j.relativePath.startsWith("/")&&(vn(j.relativePath.startsWith(y),'Absolute route path "'+j.relativePath+'" nested under path '+('"'+y+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),j.relativePath=j.relativePath.slice(y.length));let ie=s1([y,j.relativePath]),ye=p.concat(j);P.children&&P.children.length>0&&(vn(P.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+ie+'".')),Nx(P.children,a,ye,ie)),!(P.path==null&&!P.index)&&a.push({path:ie,score:dE(ie,P.index),routesMeta:ye})};return i.forEach((P,F)=>{var t;if(P.path===""||!((t=P.path)!=null&&t.includes("?")))T(P,F);else for(let j of Vx(P.path))T(P,F,j)}),a}function Vx(i){let a=i.split("/");if(a.length===0)return[];let[p,...y]=a,T=p.endsWith("?"),P=p.replace(/\?$/,"");if(y.length===0)return T?[P,""]:[P];let F=Vx(y.join("/")),t=[];return t.push(...F.map(j=>j===""?P:[P,j].join("/"))),T&&t.push(...F),t.map(j=>i.startsWith("/")&&j===""?"/":j)}function oE(i){i.sort((a,p)=>a.score!==p.score?p.score-a.score:pE(a.routesMeta.map(y=>y.childrenIndex),p.routesMeta.map(y=>y.childrenIndex)))}const sE=/^:[\w-]+$/,aE=3,lE=2,cE=1,uE=10,hE=-2,zy=i=>i==="*";function dE(i,a){let p=i.split("/"),y=p.length;return p.some(zy)&&(y+=hE),a&&(y+=lE),p.filter(T=>!zy(T)).reduce((T,P)=>T+(sE.test(P)?aE:P===""?cE:uE),y)}function pE(i,a){return i.length===a.length&&i.slice(0,-1).every((y,T)=>y===a[T])?i[i.length-1]-a[a.length-1]:0}function fE(i,a,p){p===void 0&&(p=!1);let{routesMeta:y}=i,T={},P="/",F=[];for(let t=0;t<y.length;++t){let j=y[t],ie=t===y.length-1,ye=P==="/"?a:a.slice(P.length)||"/",he=Dy({path:j.relativePath,caseSensitive:j.caseSensitive,end:ie},ye),ne=j.route;if(!he&&ie&&p&&!y[y.length-1].route.index&&(he=Dy({path:j.relativePath,caseSensitive:j.caseSensitive,end:!1},ye)),!he)return null;Object.assign(T,he.params),F.push({params:T,pathname:s1([P,he.pathname]),pathnameBase:xE(s1([P,he.pathnameBase])),route:ne}),he.pathnameBase!=="/"&&(P=s1([P,he.pathnameBase]))}return F}function Dy(i,a){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[p,y]=mE(i.path,i.caseSensitive,i.end),T=a.match(p);if(!T)return null;let P=T[0],F=P.replace(/(.)\/+$/,"$1"),t=T.slice(1);return{params:y.reduce((ie,ye,he)=>{let{paramName:ne,isOptional:Ye}=ye;if(ne==="*"){let at=t[he]||"";F=P.slice(0,P.length-at.length).replace(/(.)\/+$/,"$1")}const lt=t[he];return Ye&&!lt?ie[ne]=void 0:ie[ne]=(lt||"").replace(/%2F/g,"/"),ie},{}),pathname:P,pathnameBase:F,pattern:i}}function mE(i,a,p){a===void 0&&(a=!1),p===void 0&&(p=!0),R0(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let y=[],T="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(F,t,j)=>(y.push({paramName:t,isOptional:j!=null}),j?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(y.push({paramName:"*"}),T+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):p?T+="\\/*$":i!==""&&i!=="/"&&(T+="(?:(?=\\/|$))"),[new RegExp(T,a?void 0:"i"),y]}function _E(i){try{return i.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return R0(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),i}}function G0(i,a){if(a==="/")return i;if(!i.toLowerCase().startsWith(a.toLowerCase()))return null;let p=a.endsWith("/")?a.length-1:a.length,y=i.charAt(p);return y&&y!=="/"?null:i.slice(p)||"/"}function gE(i,a){a===void 0&&(a="/");let{pathname:p,search:y="",hash:T=""}=typeof i=="string"?d1(i):i;return{pathname:p?p.startsWith("/")?p:yE(p,a):a,search:vE(y),hash:bE(T)}}function yE(i,a){let p=a.replace(/\/+$/,"").split("/");return i.split("/").forEach(T=>{T===".."?p.length>1&&p.pop():T!=="."&&p.push(T)}),p.length>1?p.join("/"):"/"}function Y4(i,a,p,y){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(y)+"].  Please separate it out to the ")+("`to."+p+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function jx(i){return i.filter((a,p)=>p===0||a.route.path&&a.route.path.length>0)}function og(i,a){let p=jx(i);return a?p.map((y,T)=>T===p.length-1?y.pathname:y.pathnameBase):p.map(y=>y.pathnameBase)}function sg(i,a,p,y){y===void 0&&(y=!1);let T;typeof i=="string"?T=d1(i):(T=Mo({},i),vn(!T.pathname||!T.pathname.includes("?"),Y4("?","pathname","search",T)),vn(!T.pathname||!T.pathname.includes("#"),Y4("#","pathname","hash",T)),vn(!T.search||!T.search.includes("#"),Y4("#","search","hash",T)));let P=i===""||T.pathname==="",F=P?"/":T.pathname,t;if(F==null)t=p;else{let he=a.length-1;if(!y&&F.startsWith("..")){let ne=F.split("/");for(;ne[0]==="..";)ne.shift(),he-=1;T.pathname=ne.join("/")}t=he>=0?a[he]:"/"}let j=gE(T,t),ie=F&&F!=="/"&&F.endsWith("/"),ye=(P||F===".")&&p.endsWith("/");return!j.pathname.endsWith("/")&&(ie||ye)&&(j.pathname+="/"),j}const s1=i=>i.join("/").replace(/\/\/+/g,"/"),xE=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),vE=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,bE=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;class s5{constructor(a,p,y,T){T===void 0&&(T=!1),this.status=a,this.statusText=p||"",this.internal=T,y instanceof Error?(this.data=y.toString(),this.error=y):this.data=y}}function R2(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const Gx=["post","put","patch","delete"],wE=new Set(Gx),TE=["get",...Gx],EE=new Set(TE),SE=new Set([301,302,303,307,308]),ME=new Set([307,308]),J4={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},CE={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Kf={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ag=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IE=i=>({hasErrorBoundary:!!i.hasErrorBoundary}),$x="remix-router-transitions";function AE(i){const a=i.window?i.window:typeof window<"u"?window:void 0,p=typeof a<"u"&&typeof a.document<"u"&&typeof a.document.createElement<"u",y=!p;vn(i.routes.length>0,"You must provide a non-empty routes array to createRouter");let T;if(i.mapRouteProperties)T=i.mapRouteProperties;else if(i.detectErrorBoundary){let Pe=i.detectErrorBoundary;T=ct=>({hasErrorBoundary:Pe(ct)})}else T=IE;let P={},F=o5(i.routes,T,void 0,P),t,j=i.basename||"/",ie=i.dataStrategy||DE,ye=i.patchRoutesOnNavigation,he=Mo({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},i.future),ne=null,Ye=new Set,lt=null,at=null,Kt=null,Ne=i.hydrationData!=null,Le=Yd(F,i.history.location,j),je=!1,_t=null;if(Le==null&&!ye){let Pe=Ol(404,{pathname:i.history.location.pathname}),{matches:ct,route:bt}=$y(F);Le=ct,_t={[bt.id]:Pe}}Le&&!i.hydrationData&&st(Le,F,i.history.location.pathname).active&&(Le=null);let St;if(Le)if(Le.some(Pe=>Pe.route.lazy))St=!1;else if(!Le.some(Pe=>Pe.route.loader))St=!0;else if(he.v7_partialHydration){let Pe=i.hydrationData?i.hydrationData.loaderData:null,ct=i.hydrationData?i.hydrationData.errors:null;if(ct){let bt=Le.findIndex(jt=>ct[jt.route.id]!==void 0);St=Le.slice(0,bt+1).every(jt=>!e_(jt.route,Pe,ct))}else St=Le.every(bt=>!e_(bt.route,Pe,ct))}else St=i.hydrationData!=null;else if(St=!1,Le=[],he.v7_partialHydration){let Pe=st(null,F,i.history.location.pathname);Pe.active&&Pe.matches&&(je=!0,Le=Pe.matches)}let ci,dt={historyAction:i.history.action,location:i.history.location,matches:Le,initialized:St,navigation:J4,restoreScrollPosition:i.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:i.hydrationData&&i.hydrationData.loaderData||{},actionData:i.hydrationData&&i.hydrationData.actionData||null,errors:i.hydrationData&&i.hydrationData.errors||_t,fetchers:new Map,blockers:new Map},ri=ms.Pop,zt=!1,Ci,yr=!1,ki=new Map,fr=null,Qt=!1,$t=!1,Mt=[],ui=new Set,pt=new Map,hi=0,Si=-1,Wi=new Map,lr=new Set,mr=new Map,Vr=new Map,rn=new Set,nn=new Map,on=new Map,mo;function eo(){if(ne=i.history.listen(Pe=>{let{action:ct,location:bt,delta:jt}=Pe;if(mo){mo(),mo=void 0;return}R0(on.size===0||jt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let pe=de({currentLocation:dt.location,nextLocation:bt,historyAction:ct});if(pe&&jt!=null){let Y=new Promise(re=>{mo=re});i.history.go(jt*-1),De(pe,{state:"blocked",location:bt,proceed(){De(pe,{state:"proceeding",proceed:void 0,reset:void 0,location:bt}),Y.then(()=>i.history.go(jt))},reset(){let re=new Map(dt.blockers);re.set(pe,Kf),wn({blockers:re})}});return}return Vn(ct,bt)}),p){WE(a,ki);let Pe=()=>XE(a,ki);a.addEventListener("pagehide",Pe),fr=()=>a.removeEventListener("pagehide",Pe)}return dt.initialized||Vn(ms.Pop,dt.location,{initialHydration:!0}),ci}function Rs(){ne&&ne(),fr&&fr(),Ye.clear(),Ci&&Ci.abort(),dt.fetchers.forEach((Pe,ct)=>so(ct)),dt.blockers.forEach((Pe,ct)=>Tr(ct))}function Ir(Pe){return Ye.add(Pe),()=>Ye.delete(Pe)}function wn(Pe,ct){ct===void 0&&(ct={}),dt=Mo({},dt,Pe);let bt=[],jt=[];he.v7_fetcherPersist&&dt.fetchers.forEach((pe,Y)=>{pe.state==="idle"&&(rn.has(Y)?jt.push(Y):bt.push(Y))}),rn.forEach(pe=>{!dt.fetchers.has(pe)&&!pt.has(pe)&&jt.push(pe)}),[...Ye].forEach(pe=>pe(dt,{deletedFetchers:jt,viewTransitionOpts:ct.viewTransitionOpts,flushSync:ct.flushSync===!0})),he.v7_fetcherPersist?(bt.forEach(pe=>dt.fetchers.delete(pe)),jt.forEach(pe=>so(pe))):jt.forEach(pe=>rn.delete(pe))}function hn(Pe,ct,bt){var jt,pe;let{flushSync:Y}=bt===void 0?{}:bt,re=dt.actionData!=null&&dt.navigation.formMethod!=null&&zu(dt.navigation.formMethod)&&dt.navigation.state==="loading"&&((jt=Pe.state)==null?void 0:jt._isRedirect)!==!0,fe;ct.actionData?Object.keys(ct.actionData).length>0?fe=ct.actionData:fe=null:re?fe=dt.actionData:fe=null;let ge=ct.loaderData?jy(dt.loaderData,ct.loaderData,ct.matches||[],ct.errors):dt.loaderData,ke=dt.blockers;ke.size>0&&(ke=new Map(ke),ke.forEach((Ve,ut)=>ke.set(ut,Kf)));let Ze=zt===!0||dt.navigation.formMethod!=null&&zu(dt.navigation.formMethod)&&((pe=Pe.state)==null?void 0:pe._isRedirect)!==!0;t&&(F=t,t=void 0),Qt||ri===ms.Pop||(ri===ms.Push?i.history.push(Pe,Pe.state):ri===ms.Replace&&i.history.replace(Pe,Pe.state));let $e;if(ri===ms.Pop){let Ve=ki.get(dt.location.pathname);Ve&&Ve.has(Pe.pathname)?$e={currentLocation:dt.location,nextLocation:Pe}:ki.has(Pe.pathname)&&($e={currentLocation:Pe,nextLocation:dt.location})}else if(yr){let Ve=ki.get(dt.location.pathname);Ve?Ve.add(Pe.pathname):(Ve=new Set([Pe.pathname]),ki.set(dt.location.pathname,Ve)),$e={currentLocation:dt.location,nextLocation:Pe}}wn(Mo({},ct,{actionData:fe,loaderData:ge,historyAction:ri,location:Pe,initialized:!0,navigation:J4,revalidation:"idle",restoreScrollPosition:mt(Pe,ct.matches||dt.matches),preventScrollReset:Ze,blockers:ke}),{viewTransitionOpts:$e,flushSync:Y===!0}),ri=ms.Pop,zt=!1,yr=!1,Qt=!1,$t=!1,Mt=[]}async function $s(Pe,ct){if(typeof Pe=="number"){i.history.go(Pe);return}let bt=Q6(dt.location,dt.matches,j,he.v7_prependBasename,Pe,he.v7_relativeSplatPath,ct==null?void 0:ct.fromRouteId,ct==null?void 0:ct.relative),{path:jt,submission:pe,error:Y}=Ly(he.v7_normalizeFormMethod,!1,bt,ct),re=dt.location,fe=L2(dt.location,jt,ct&&ct.state);fe=Mo({},fe,i.history.encodeLocation(fe));let ge=ct&&ct.replace!=null?ct.replace:void 0,ke=ms.Push;ge===!0?ke=ms.Replace:ge===!1||pe!=null&&zu(pe.formMethod)&&pe.formAction===dt.location.pathname+dt.location.search&&(ke=ms.Replace);let Ze=ct&&"preventScrollReset"in ct?ct.preventScrollReset===!0:void 0,$e=(ct&&ct.flushSync)===!0,Ve=de({currentLocation:re,nextLocation:fe,historyAction:ke});if(Ve){De(Ve,{state:"blocked",location:fe,proceed(){De(Ve,{state:"proceeding",proceed:void 0,reset:void 0,location:fe}),$s(Pe,ct)},reset(){let ut=new Map(dt.blockers);ut.set(Ve,Kf),wn({blockers:ut})}});return}return await Vn(ke,fe,{submission:pe,pendingError:Y,preventScrollReset:Ze,replace:ct&&ct.replace,enableViewTransition:ct&&ct.viewTransition,flushSync:$e})}function sn(){if(qn(),wn({revalidation:"loading"}),dt.navigation.state!=="submitting"){if(dt.navigation.state==="idle"){Vn(dt.historyAction,dt.location,{startUninterruptedRevalidation:!0});return}Vn(ri||dt.historyAction,dt.navigation.location,{overrideNavigation:dt.navigation,enableViewTransition:yr===!0})}}async function Vn(Pe,ct,bt){Ci&&Ci.abort(),Ci=null,ri=Pe,Qt=(bt&&bt.startUninterruptedRevalidation)===!0,Tt(dt.location,dt.matches),zt=(bt&&bt.preventScrollReset)===!0,yr=(bt&&bt.enableViewTransition)===!0;let jt=t||F,pe=bt&&bt.overrideNavigation,Y=bt!=null&&bt.initialHydration&&dt.matches&&dt.matches.length>0&&!je?dt.matches:Yd(jt,ct,j),re=(bt&&bt.flushSync)===!0;if(Y&&dt.initialized&&!$t&&UE(dt.location,ct)&&!(bt&&bt.submission&&zu(bt.submission.formMethod))){hn(ct,{matches:Y},{flushSync:re});return}let fe=st(Y,jt,ct.pathname);if(fe.active&&fe.matches&&(Y=fe.matches),!Y){let{error:Dt,notFoundMatches:Ht,route:ft}=_e(ct.pathname);hn(ct,{matches:Ht,loaderData:{},errors:{[ft.id]:Dt}},{flushSync:re});return}Ci=new AbortController;let ge=Qp(i.history,ct,Ci.signal,bt&&bt.submission),ke;if(bt&&bt.pendingError)ke=[Jd(Y).route.id,{type:Jn.error,error:bt.pendingError}];else if(bt&&bt.submission&&zu(bt.submission.formMethod)){let Dt=await ra(ge,ct,bt.submission,Y,fe.active,{replace:bt.replace,flushSync:re});if(Dt.shortCircuited)return;if(Dt.pendingActionResult){let[Ht,ft]=Dt.pendingActionResult;if(mc(ft)&&R2(ft.error)&&ft.error.status===404){Ci=null,hn(ct,{matches:Dt.matches,loaderData:{},errors:{[Ht]:ft.error}});return}}Y=Dt.matches||Y,ke=Dt.pendingActionResult,pe=Q4(ct,bt.submission),re=!1,fe.active=!1,ge=Qp(i.history,ge.url,ge.signal)}let{shortCircuited:Ze,matches:$e,loaderData:Ve,errors:ut}=await ns(ge,ct,Y,fe.active,pe,bt&&bt.submission,bt&&bt.fetcherSubmission,bt&&bt.replace,bt&&bt.initialHydration===!0,re,ke);Ze||(Ci=null,hn(ct,Mo({matches:$e||Y},Gy(ke),{loaderData:Ve,errors:ut})))}async function ra(Pe,ct,bt,jt,pe,Y){Y===void 0&&(Y={}),qn();let re=ZE(ct,bt);if(wn({navigation:re},{flushSync:Y.flushSync===!0}),pe){let ke=await xt(jt,ct.pathname,Pe.signal);if(ke.type==="aborted")return{shortCircuited:!0};if(ke.type==="error"){let Ze=Jd(ke.partialMatches).route.id;return{matches:ke.partialMatches,pendingActionResult:[Ze,{type:Jn.error,error:ke.error}]}}else if(ke.matches)jt=ke.matches;else{let{notFoundMatches:Ze,error:$e,route:Ve}=_e(ct.pathname);return{matches:Ze,pendingActionResult:[Ve.id,{type:Jn.error,error:$e}]}}}let fe,ge=o2(jt,ct);if(!ge.route.action&&!ge.route.lazy)fe={type:Jn.error,error:Ol(405,{method:Pe.method,pathname:ct.pathname,routeId:ge.route.id})};else if(fe=(await Eo("action",dt,Pe,[ge],jt,null))[ge.route.id],Pe.signal.aborted)return{shortCircuited:!0};if(ip(fe)){let ke;return Y&&Y.replace!=null?ke=Y.replace:ke=Uy(fe.response.headers.get("Location"),new URL(Pe.url),j)===dt.location.pathname+dt.location.search,await to(Pe,fe,!0,{submission:bt,replace:ke}),{shortCircuited:!0}}if(od(fe))throw Ol(400,{type:"defer-action"});if(mc(fe)){let ke=Jd(jt,ge.route.id);return(Y&&Y.replace)!==!0&&(ri=ms.Push),{matches:jt,pendingActionResult:[ke.route.id,fe]}}return{matches:jt,pendingActionResult:[ge.route.id,fe]}}async function ns(Pe,ct,bt,jt,pe,Y,re,fe,ge,ke,Ze){let $e=pe||Q4(ct,Y),Ve=Y||re||qy($e),ut=!Qt&&(!he.v7_partialHydration||!ge);if(jt){if(ut){let Pr=xr(Ze);wn(Mo({navigation:$e},Pr!==void 0?{actionData:Pr}:{}),{flushSync:ke})}let Qi=await xt(bt,ct.pathname,Pe.signal);if(Qi.type==="aborted")return{shortCircuited:!0};if(Qi.type==="error"){let Pr=Jd(Qi.partialMatches).route.id;return{matches:Qi.partialMatches,loaderData:{},errors:{[Pr]:Qi.error}}}else if(Qi.matches)bt=Qi.matches;else{let{error:Pr,notFoundMatches:It,route:Tn}=_e(ct.pathname);return{matches:It,loaderData:{},errors:{[Tn.id]:Pr}}}}let Dt=t||F,[Ht,ft]=By(i.history,dt,bt,Ve,ct,he.v7_partialHydration&&ge===!0,he.v7_skipActionErrorRevalidation,$t,Mt,ui,rn,mr,lr,Dt,j,Ze);if(Ae(Qi=>!(bt&&bt.some(Pr=>Pr.route.id===Qi))||Ht&&Ht.some(Pr=>Pr.route.id===Qi)),Si=++hi,Ht.length===0&&ft.length===0){let Qi=io();return hn(ct,Mo({matches:bt,loaderData:{},errors:Ze&&mc(Ze[1])?{[Ze[0]]:Ze[1].error}:null},Gy(Ze),Qi?{fetchers:new Map(dt.fetchers)}:{}),{flushSync:ke}),{shortCircuited:!0}}if(ut){let Qi={};if(!jt){Qi.navigation=$e;let Pr=xr(Ze);Pr!==void 0&&(Qi.actionData=Pr)}ft.length>0&&(Qi.fetchers=Wo(ft)),wn(Qi,{flushSync:ke})}ft.forEach(Qi=>{zn(Qi.key),Qi.controller&&pt.set(Qi.key,Qi.controller)});let ji=()=>ft.forEach(Qi=>zn(Qi.key));Ci&&Ci.signal.addEventListener("abort",ji);let{loaderResults:Zi,fetcherResults:Ai}=await Zs(dt,bt,Ht,ft,Pe);if(Pe.signal.aborted)return{shortCircuited:!0};Ci&&Ci.signal.removeEventListener("abort",ji),ft.forEach(Qi=>pt.delete(Qi.key));let Yi=f3(Zi);if(Yi)return await to(Pe,Yi.result,!0,{replace:fe}),{shortCircuited:!0};if(Yi=f3(Ai),Yi)return lr.add(Yi.key),await to(Pe,Yi.result,!0,{replace:fe}),{shortCircuited:!0};let{loaderData:rr,errors:br}=Vy(dt,bt,Zi,Ze,ft,Ai,nn);nn.forEach((Qi,Pr)=>{Qi.subscribe(It=>{(It||Qi.done)&&nn.delete(Pr)})}),he.v7_partialHydration&&ge&&dt.errors&&(br=Mo({},dt.errors,br));let hr=io(),wr=Ao(Si),Mr=hr||wr||ft.length>0;return Mo({matches:bt,loaderData:rr,errors:br},Mr?{fetchers:new Map(dt.fetchers)}:{})}function xr(Pe){if(Pe&&!mc(Pe[1]))return{[Pe[0]]:Pe[1].data};if(dt.actionData)return Object.keys(dt.actionData).length===0?null:dt.actionData}function Wo(Pe){return Pe.forEach(ct=>{let bt=dt.fetchers.get(ct.key),jt=Yf(void 0,bt?bt.data:void 0);dt.fetchers.set(ct.key,jt)}),new Map(dt.fetchers)}function os(Pe,ct,bt,jt){if(y)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");zn(Pe);let pe=(jt&&jt.flushSync)===!0,Y=t||F,re=Q6(dt.location,dt.matches,j,he.v7_prependBasename,bt,he.v7_relativeSplatPath,ct,jt==null?void 0:jt.relative),fe=Yd(Y,re,j),ge=st(fe,Y,re);if(ge.active&&ge.matches&&(fe=ge.matches),!fe){Mi(Pe,ct,Ol(404,{pathname:re}),{flushSync:pe});return}let{path:ke,submission:Ze,error:$e}=Ly(he.v7_normalizeFormMethod,!0,re,jt);if($e){Mi(Pe,ct,$e,{flushSync:pe});return}let Ve=o2(fe,ke),ut=(jt&&jt.preventScrollReset)===!0;if(Ze&&zu(Ze.formMethod)){gs(Pe,ct,ke,Ve,fe,ge.active,pe,ut,Ze);return}mr.set(Pe,{routeId:ct,path:ke}),ys(Pe,ct,ke,Ve,fe,ge.active,pe,ut,Ze)}async function gs(Pe,ct,bt,jt,pe,Y,re,fe,ge){qn(),mr.delete(Pe);function ke(Cr){if(!Cr.route.action&&!Cr.route.lazy){let En=Ol(405,{method:ge.formMethod,pathname:bt,routeId:ct});return Mi(Pe,ct,En,{flushSync:re}),!0}return!1}if(!Y&&ke(jt))return;let Ze=dt.fetchers.get(Pe);qt(Pe,qE(ge,Ze),{flushSync:re});let $e=new AbortController,Ve=Qp(i.history,bt,$e.signal,ge);if(Y){let Cr=await xt(pe,new URL(Ve.url).pathname,Ve.signal,Pe);if(Cr.type==="aborted")return;if(Cr.type==="error"){Mi(Pe,ct,Cr.error,{flushSync:re});return}else if(Cr.matches){if(pe=Cr.matches,jt=o2(pe,bt),ke(jt))return}else{Mi(Pe,ct,Ol(404,{pathname:bt}),{flushSync:re});return}}pt.set(Pe,$e);let ut=hi,Ht=(await Eo("action",dt,Ve,[jt],pe,Pe))[jt.route.id];if(Ve.signal.aborted){pt.get(Pe)===$e&&pt.delete(Pe);return}if(he.v7_fetcherPersist&&rn.has(Pe)){if(ip(Ht)||mc(Ht)){qt(Pe,J1(void 0));return}}else{if(ip(Ht))if(pt.delete(Pe),Si>ut){qt(Pe,J1(void 0));return}else return lr.add(Pe),qt(Pe,Yf(ge)),to(Ve,Ht,!1,{fetcherSubmission:ge,preventScrollReset:fe});if(mc(Ht)){Mi(Pe,ct,Ht.error);return}}if(od(Ht))throw Ol(400,{type:"defer-action"});let ft=dt.navigation.location||dt.location,ji=Qp(i.history,ft,$e.signal),Zi=t||F,Ai=dt.navigation.state!=="idle"?Yd(Zi,dt.navigation.location,j):dt.matches;vn(Ai,"Didn't find any matches after fetcher action");let Yi=++hi;Wi.set(Pe,Yi);let rr=Yf(ge,Ht.data);dt.fetchers.set(Pe,rr);let[br,hr]=By(i.history,dt,Ai,ge,ft,!1,he.v7_skipActionErrorRevalidation,$t,Mt,ui,rn,mr,lr,Zi,j,[jt.route.id,Ht]);hr.filter(Cr=>Cr.key!==Pe).forEach(Cr=>{let En=Cr.key,ln=dt.fetchers.get(En),xs=Yf(void 0,ln?ln.data:void 0);dt.fetchers.set(En,xs),zn(En),Cr.controller&&pt.set(En,Cr.controller)}),wn({fetchers:new Map(dt.fetchers)});let wr=()=>hr.forEach(Cr=>zn(Cr.key));$e.signal.addEventListener("abort",wr);let{loaderResults:Mr,fetcherResults:Qi}=await Zs(dt,Ai,br,hr,ji);if($e.signal.aborted)return;$e.signal.removeEventListener("abort",wr),Wi.delete(Pe),pt.delete(Pe),hr.forEach(Cr=>pt.delete(Cr.key));let Pr=f3(Mr);if(Pr)return to(ji,Pr.result,!1,{preventScrollReset:fe});if(Pr=f3(Qi),Pr)return lr.add(Pr.key),to(ji,Pr.result,!1,{preventScrollReset:fe});let{loaderData:It,errors:Tn}=Vy(dt,Ai,Mr,void 0,hr,Qi,nn);if(dt.fetchers.has(Pe)){let Cr=J1(Ht.data);dt.fetchers.set(Pe,Cr)}Ao(Yi),dt.navigation.state==="loading"&&Yi>Si?(vn(ri,"Expected pending action"),Ci&&Ci.abort(),hn(dt.navigation.location,{matches:Ai,loaderData:It,errors:Tn,fetchers:new Map(dt.fetchers)})):(wn({errors:Tn,loaderData:jy(dt.loaderData,It,Ai,Tn),fetchers:new Map(dt.fetchers)}),$t=!1)}async function ys(Pe,ct,bt,jt,pe,Y,re,fe,ge){let ke=dt.fetchers.get(Pe);qt(Pe,Yf(ge,ke?ke.data:void 0),{flushSync:re});let Ze=new AbortController,$e=Qp(i.history,bt,Ze.signal);if(Y){let Ht=await xt(pe,new URL($e.url).pathname,$e.signal,Pe);if(Ht.type==="aborted")return;if(Ht.type==="error"){Mi(Pe,ct,Ht.error,{flushSync:re});return}else if(Ht.matches)pe=Ht.matches,jt=o2(pe,bt);else{Mi(Pe,ct,Ol(404,{pathname:bt}),{flushSync:re});return}}pt.set(Pe,Ze);let Ve=hi,Dt=(await Eo("loader",dt,$e,[jt],pe,Pe))[jt.route.id];if(od(Dt)&&(Dt=await lg(Dt,$e.signal,!0)||Dt),pt.get(Pe)===Ze&&pt.delete(Pe),!$e.signal.aborted){if(rn.has(Pe)){qt(Pe,J1(void 0));return}if(ip(Dt))if(Si>Ve){qt(Pe,J1(void 0));return}else{lr.add(Pe),await to($e,Dt,!1,{preventScrollReset:fe});return}if(mc(Dt)){Mi(Pe,ct,Dt.error);return}vn(!od(Dt),"Unhandled fetcher deferred data"),qt(Pe,J1(Dt.data))}}async function to(Pe,ct,bt,jt){let{submission:pe,fetcherSubmission:Y,preventScrollReset:re,replace:fe}=jt===void 0?{}:jt;ct.response.headers.has("X-Remix-Revalidate")&&($t=!0);let ge=ct.response.headers.get("Location");vn(ge,"Expected a Location header on the redirect Response"),ge=Uy(ge,new URL(Pe.url),j);let ke=L2(dt.location,ge,{_isRedirect:!0});if(p){let Ht=!1;if(ct.response.headers.has("X-Remix-Reload-Document"))Ht=!0;else if(ag.test(ge)){const ft=i.history.createURL(ge);Ht=ft.origin!==a.location.origin||G0(ft.pathname,j)==null}if(Ht){fe?a.location.replace(ge):a.location.assign(ge);return}}Ci=null;let Ze=fe===!0||ct.response.headers.has("X-Remix-Replace")?ms.Replace:ms.Push,{formMethod:$e,formAction:Ve,formEncType:ut}=dt.navigation;!pe&&!Y&&$e&&Ve&&ut&&(pe=qy(dt.navigation));let Dt=pe||Y;if(ME.has(ct.response.status)&&Dt&&zu(Dt.formMethod))await Vn(Ze,ke,{submission:Mo({},Dt,{formAction:ge}),preventScrollReset:re||zt,enableViewTransition:bt?yr:void 0});else{let Ht=Q4(ke,pe);await Vn(Ze,ke,{overrideNavigation:Ht,fetcherSubmission:Y,preventScrollReset:re||zt,enableViewTransition:bt?yr:void 0})}}async function Eo(Pe,ct,bt,jt,pe,Y){let re,fe={};try{re=await LE(ie,Pe,ct,bt,jt,pe,Y,P,T)}catch(ge){return jt.forEach(ke=>{fe[ke.route.id]={type:Jn.error,error:ge}}),fe}for(let[ge,ke]of Object.entries(re))if(NE(ke)){let Ze=ke.result;fe[ge]={type:Jn.redirect,response:FE(Ze,bt,ge,pe,j,he.v7_relativeSplatPath)}}else fe[ge]=await BE(ke);return fe}async function Zs(Pe,ct,bt,jt,pe){let Y=Pe.matches,re=Eo("loader",Pe,pe,bt,ct,null),fe=Promise.all(jt.map(async Ze=>{if(Ze.matches&&Ze.match&&Ze.controller){let Ve=(await Eo("loader",Pe,Qp(i.history,Ze.path,Ze.controller.signal),[Ze.match],Ze.matches,Ze.key))[Ze.match.route.id];return{[Ze.key]:Ve}}else return Promise.resolve({[Ze.key]:{type:Jn.error,error:Ol(404,{pathname:Ze.path})}})})),ge=await re,ke=(await fe).reduce((Ze,$e)=>Object.assign(Ze,$e),{});return await Promise.all([GE(ct,ge,pe.signal,Y,Pe.loaderData),$E(ct,ke,jt)]),{loaderResults:ge,fetcherResults:ke}}function qn(){$t=!0,Mt.push(...Ae()),mr.forEach((Pe,ct)=>{pt.has(ct)&&ui.add(ct),zn(ct)})}function qt(Pe,ct,bt){bt===void 0&&(bt={}),dt.fetchers.set(Pe,ct),wn({fetchers:new Map(dt.fetchers)},{flushSync:(bt&&bt.flushSync)===!0})}function Mi(Pe,ct,bt,jt){jt===void 0&&(jt={});let pe=Jd(dt.matches,ct);so(Pe),wn({errors:{[pe.route.id]:bt},fetchers:new Map(dt.fetchers)},{flushSync:(jt&&jt.flushSync)===!0})}function Xo(Pe){return Vr.set(Pe,(Vr.get(Pe)||0)+1),rn.has(Pe)&&rn.delete(Pe),dt.fetchers.get(Pe)||CE}function so(Pe){let ct=dt.fetchers.get(Pe);pt.has(Pe)&&!(ct&&ct.state==="loading"&&Wi.has(Pe))&&zn(Pe),mr.delete(Pe),Wi.delete(Pe),lr.delete(Pe),he.v7_fetcherPersist&&rn.delete(Pe),ui.delete(Pe),dt.fetchers.delete(Pe)}function Gr(Pe){let ct=(Vr.get(Pe)||0)-1;ct<=0?(Vr.delete(Pe),rn.add(Pe),he.v7_fetcherPersist||so(Pe)):Vr.set(Pe,ct),wn({fetchers:new Map(dt.fetchers)})}function zn(Pe){let ct=pt.get(Pe);ct&&(ct.abort(),pt.delete(Pe))}function Hn(Pe){for(let ct of Pe){let bt=Xo(ct),jt=J1(bt.data);dt.fetchers.set(ct,jt)}}function io(){let Pe=[],ct=!1;for(let bt of lr){let jt=dt.fetchers.get(bt);vn(jt,"Expected fetcher: "+bt),jt.state==="loading"&&(lr.delete(bt),Pe.push(bt),ct=!0)}return Hn(Pe),ct}function Ao(Pe){let ct=[];for(let[bt,jt]of Wi)if(jt<Pe){let pe=dt.fetchers.get(bt);vn(pe,"Expected fetcher: "+bt),pe.state==="loading"&&(zn(bt),Wi.delete(bt),ct.push(bt))}return Hn(ct),ct.length>0}function Ii(Pe,ct){let bt=dt.blockers.get(Pe)||Kf;return on.get(Pe)!==ct&&on.set(Pe,ct),bt}function Tr(Pe){dt.blockers.delete(Pe),on.delete(Pe)}function De(Pe,ct){let bt=dt.blockers.get(Pe)||Kf;vn(bt.state==="unblocked"&&ct.state==="blocked"||bt.state==="blocked"&&ct.state==="blocked"||bt.state==="blocked"&&ct.state==="proceeding"||bt.state==="blocked"&&ct.state==="unblocked"||bt.state==="proceeding"&&ct.state==="unblocked","Invalid blocker state transition: "+bt.state+" -> "+ct.state);let jt=new Map(dt.blockers);jt.set(Pe,ct),wn({blockers:jt})}function de(Pe){let{currentLocation:ct,nextLocation:bt,historyAction:jt}=Pe;if(on.size===0)return;on.size>1&&R0(!1,"A router only supports one blocker at a time");let pe=Array.from(on.entries()),[Y,re]=pe[pe.length-1],fe=dt.blockers.get(Y);if(!(fe&&fe.state==="proceeding")&&re({currentLocation:ct,nextLocation:bt,historyAction:jt}))return Y}function _e(Pe){let ct=Ol(404,{pathname:Pe}),bt=t||F,{matches:jt,route:pe}=$y(bt);return Ae(),{notFoundMatches:jt,route:pe,error:ct}}function Ae(Pe){let ct=[];return nn.forEach((bt,jt)=>{(!Pe||Pe(jt))&&(bt.cancel(),ct.push(jt),nn.delete(jt))}),ct}function Je(Pe,ct,bt){if(lt=Pe,Kt=ct,at=bt||null,!Ne&&dt.navigation===J4){Ne=!0;let jt=mt(dt.location,dt.matches);jt!=null&&wn({restoreScrollPosition:jt})}return()=>{lt=null,Kt=null,at=null}}function ot(Pe,ct){return at&&at(Pe,ct.map(jt=>nE(jt,dt.loaderData)))||Pe.key}function Tt(Pe,ct){if(lt&&Kt){let bt=ot(Pe,ct);lt[bt]=Kt()}}function mt(Pe,ct){if(lt){let bt=ot(Pe,ct),jt=lt[bt];if(typeof jt=="number")return jt}return null}function st(Pe,ct,bt){if(ye)if(Pe){if(Object.keys(Pe[0].params).length>0)return{active:!0,matches:k3(ct,bt,j,!0)}}else return{active:!0,matches:k3(ct,bt,j,!0)||[]};return{active:!1,matches:null}}async function xt(Pe,ct,bt,jt){if(!ye)return{type:"success",matches:Pe};let pe=Pe;for(;;){let Y=t==null,re=t||F,fe=P;try{await ye({signal:bt,path:ct,matches:pe,fetcherKey:jt,patch:(Ze,$e)=>{bt.aborted||Oy(Ze,$e,re,fe,T)}})}catch(Ze){return{type:"error",error:Ze,partialMatches:pe}}finally{Y&&!bt.aborted&&(F=[...F])}if(bt.aborted)return{type:"aborted"};let ge=Yd(re,ct,j);if(ge)return{type:"success",matches:ge};let ke=k3(re,ct,j,!0);if(!ke||pe.length===ke.length&&pe.every((Ze,$e)=>Ze.route.id===ke[$e].route.id))return{type:"success",matches:null};pe=ke}}function gi(Pe){P={},t=o5(Pe,T,void 0,P)}function wi(Pe,ct){let bt=t==null;Oy(Pe,ct,t||F,P,T),bt&&(F=[...F],wn({}))}return ci={get basename(){return j},get future(){return he},get state(){return dt},get routes(){return F},get window(){return a},initialize:eo,subscribe:Ir,enableScrollRestoration:Je,navigate:$s,fetch:os,revalidate:sn,createHref:Pe=>i.history.createHref(Pe),encodeLocation:Pe=>i.history.encodeLocation(Pe),getFetcher:Xo,deleteFetcher:Gr,dispose:Rs,getBlocker:Ii,deleteBlocker:Tr,patchRoutes:wi,_internalFetchControllers:pt,_internalActiveDeferreds:nn,_internalSetRoutes:gi},ci}function PE(i){return i!=null&&("formData"in i&&i.formData!=null||"body"in i&&i.body!==void 0)}function Q6(i,a,p,y,T,P,F,t){let j,ie;if(F){j=[];for(let he of a)if(j.push(he),he.route.id===F){ie=he;break}}else j=a,ie=a[a.length-1];let ye=sg(T||".",og(j,P),G0(i.pathname,p)||i.pathname,t==="path");if(T==null&&(ye.search=i.search,ye.hash=i.hash),(T==null||T===""||T===".")&&ie){let he=cg(ye.search);if(ie.route.index&&!he)ye.search=ye.search?ye.search.replace(/^\?/,"?index&"):"?index";else if(!ie.route.index&&he){let ne=new URLSearchParams(ye.search),Ye=ne.getAll("index");ne.delete("index"),Ye.filter(at=>at).forEach(at=>ne.append("index",at));let lt=ne.toString();ye.search=lt?"?"+lt:""}}return y&&p!=="/"&&(ye.pathname=ye.pathname==="/"?p:s1([p,ye.pathname])),up(ye)}function Ly(i,a,p,y){if(!y||!PE(y))return{path:p};if(y.formMethod&&!jE(y.formMethod))return{path:p,error:Ol(405,{method:y.formMethod})};let T=()=>({path:p,error:Ol(400,{type:"invalid-body"})}),P=y.formMethod||"get",F=i?P.toUpperCase():P.toLowerCase(),t=Wx(p);if(y.body!==void 0){if(y.formEncType==="text/plain"){if(!zu(F))return T();let ne=typeof y.body=="string"?y.body:y.body instanceof FormData||y.body instanceof URLSearchParams?Array.from(y.body.entries()).reduce((Ye,lt)=>{let[at,Kt]=lt;return""+Ye+at+"="+Kt+`
`},""):String(y.body);return{path:p,submission:{formMethod:F,formAction:t,formEncType:y.formEncType,formData:void 0,json:void 0,text:ne}}}else if(y.formEncType==="application/json"){if(!zu(F))return T();try{let ne=typeof y.body=="string"?JSON.parse(y.body):y.body;return{path:p,submission:{formMethod:F,formAction:t,formEncType:y.formEncType,formData:void 0,json:ne,text:void 0}}}catch{return T()}}}vn(typeof FormData=="function","FormData is not available in this environment");let j,ie;if(y.formData)j=t_(y.formData),ie=y.formData;else if(y.body instanceof FormData)j=t_(y.body),ie=y.body;else if(y.body instanceof URLSearchParams)j=y.body,ie=Ny(j);else if(y.body==null)j=new URLSearchParams,ie=new FormData;else try{j=new URLSearchParams(y.body),ie=Ny(j)}catch{return T()}let ye={formMethod:F,formAction:t,formEncType:y&&y.formEncType||"application/x-www-form-urlencoded",formData:ie,json:void 0,text:void 0};if(zu(ye.formMethod))return{path:p,submission:ye};let he=d1(p);return a&&he.search&&cg(he.search)&&j.append("index",""),he.search="?"+j,{path:up(he),submission:ye}}function Ry(i,a,p){p===void 0&&(p=!1);let y=i.findIndex(T=>T.route.id===a);return y>=0?i.slice(0,p?y+1:y):i}function By(i,a,p,y,T,P,F,t,j,ie,ye,he,ne,Ye,lt,at){let Kt=at?mc(at[1])?at[1].error:at[1].data:void 0,Ne=i.createURL(a.location),Le=i.createURL(T),je=p;P&&a.errors?je=Ry(p,Object.keys(a.errors)[0],!0):at&&mc(at[1])&&(je=Ry(p,at[0]));let _t=at?at[1].statusCode:void 0,St=F&&_t&&_t>=400,ci=je.filter((ri,zt)=>{let{route:Ci}=ri;if(Ci.lazy)return!0;if(Ci.loader==null)return!1;if(P)return e_(Ci,a.loaderData,a.errors);if(kE(a.loaderData,a.matches[zt],ri)||j.some(fr=>fr===ri.route.id))return!0;let yr=a.matches[zt],ki=ri;return Fy(ri,Mo({currentUrl:Ne,currentParams:yr.params,nextUrl:Le,nextParams:ki.params},y,{actionResult:Kt,actionStatus:_t,defaultShouldRevalidate:St?!1:t||Ne.pathname+Ne.search===Le.pathname+Le.search||Ne.search!==Le.search||Zx(yr,ki)}))}),dt=[];return he.forEach((ri,zt)=>{if(P||!p.some(Qt=>Qt.route.id===ri.routeId)||ye.has(zt))return;let Ci=Yd(Ye,ri.path,lt);if(!Ci){dt.push({key:zt,routeId:ri.routeId,path:ri.path,matches:null,match:null,controller:null});return}let yr=a.fetchers.get(zt),ki=o2(Ci,ri.path),fr=!1;ne.has(zt)?fr=!1:ie.has(zt)?(ie.delete(zt),fr=!0):yr&&yr.state!=="idle"&&yr.data===void 0?fr=t:fr=Fy(ki,Mo({currentUrl:Ne,currentParams:a.matches[a.matches.length-1].params,nextUrl:Le,nextParams:p[p.length-1].params},y,{actionResult:Kt,actionStatus:_t,defaultShouldRevalidate:St?!1:t})),fr&&dt.push({key:zt,routeId:ri.routeId,path:ri.path,matches:Ci,match:ki,controller:new AbortController})}),[ci,dt]}function e_(i,a,p){if(i.lazy)return!0;if(!i.loader)return!1;let y=a!=null&&a[i.id]!==void 0,T=p!=null&&p[i.id]!==void 0;return!y&&T?!1:typeof i.loader=="function"&&i.loader.hydrate===!0?!0:!y&&!T}function kE(i,a,p){let y=!a||p.route.id!==a.route.id,T=i[p.route.id]===void 0;return y||T}function Zx(i,a){let p=i.route.path;return i.pathname!==a.pathname||p!=null&&p.endsWith("*")&&i.params["*"]!==a.params["*"]}function Fy(i,a){if(i.route.shouldRevalidate){let p=i.route.shouldRevalidate(a);if(typeof p=="boolean")return p}return a.defaultShouldRevalidate}function Oy(i,a,p,y,T){var P;let F;if(i){let ie=y[i];vn(ie,"No route found to patch children into: routeId = "+i),ie.children||(ie.children=[]),F=ie.children}else F=p;let t=a.filter(ie=>!F.some(ye=>qx(ie,ye))),j=o5(t,T,[i||"_","patch",String(((P=F)==null?void 0:P.length)||"0")],y);F.push(...j)}function qx(i,a){return"id"in i&&"id"in a&&i.id===a.id?!0:i.index===a.index&&i.path===a.path&&i.caseSensitive===a.caseSensitive?(!i.children||i.children.length===0)&&(!a.children||a.children.length===0)?!0:i.children.every((p,y)=>{var T;return(T=a.children)==null?void 0:T.some(P=>qx(p,P))}):!1}async function zE(i,a,p){if(!i.lazy)return;let y=await i.lazy();if(!i.lazy)return;let T=p[i.id];vn(T,"No route found in manifest");let P={};for(let F in y){let j=T[F]!==void 0&&F!=="hasErrorBoundary";R0(!j,'Route "'+T.id+'" has a static property "'+F+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+F+'" will be ignored.')),!j&&!iE.has(F)&&(P[F]=y[F])}Object.assign(T,P),Object.assign(T,Mo({},a(T),{lazy:void 0}))}async function DE(i){let{matches:a}=i,p=a.filter(T=>T.shouldLoad);return(await Promise.all(p.map(T=>T.resolve()))).reduce((T,P,F)=>Object.assign(T,{[p[F].route.id]:P}),{})}async function LE(i,a,p,y,T,P,F,t,j,ie){let ye=P.map(Ye=>Ye.route.lazy?zE(Ye.route,j,t):void 0),he=P.map((Ye,lt)=>{let at=ye[lt],Kt=T.some(Le=>Le.route.id===Ye.route.id);return Mo({},Ye,{shouldLoad:Kt,resolve:async Le=>(Le&&y.method==="GET"&&(Ye.route.lazy||Ye.route.loader)&&(Kt=!0),Kt?RE(a,y,Ye,at,Le,ie):Promise.resolve({type:Jn.data,result:void 0}))})}),ne=await i({matches:he,request:y,params:P[0].params,fetcherKey:F,context:ie});try{await Promise.all(ye)}catch{}return ne}async function RE(i,a,p,y,T,P){let F,t,j=ie=>{let ye,he=new Promise((lt,at)=>ye=at);t=()=>ye(),a.signal.addEventListener("abort",t);let ne=lt=>typeof ie!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+i+'" [routeId: '+p.route.id+"]"))):ie({request:a,params:p.params,context:P},...lt!==void 0?[lt]:[]),Ye=(async()=>{try{return{type:"data",result:await(T?T(at=>ne(at)):ne())}}catch(lt){return{type:"error",result:lt}}})();return Promise.race([Ye,he])};try{let ie=p.route[i];if(y)if(ie){let ye,[he]=await Promise.all([j(ie).catch(ne=>{ye=ne}),y]);if(ye!==void 0)throw ye;F=he}else if(await y,ie=p.route[i],ie)F=await j(ie);else if(i==="action"){let ye=new URL(a.url),he=ye.pathname+ye.search;throw Ol(405,{method:a.method,pathname:he,routeId:p.route.id})}else return{type:Jn.data,result:void 0};else if(ie)F=await j(ie);else{let ye=new URL(a.url),he=ye.pathname+ye.search;throw Ol(404,{pathname:he})}vn(F.result!==void 0,"You defined "+(i==="action"?"an action":"a loader")+" for route "+('"'+p.route.id+"\" but didn't return anything from your `"+i+"` ")+"function. Please return a value or `null`.")}catch(ie){return{type:Jn.error,result:ie}}finally{t&&a.signal.removeEventListener("abort",t)}return F}async function BE(i){let{result:a,type:p}=i;if(Xx(a)){let he;try{let ne=a.headers.get("Content-Type");ne&&/\bapplication\/json\b/.test(ne)?a.body==null?he=null:he=await a.json():he=await a.text()}catch(ne){return{type:Jn.error,error:ne}}return p===Jn.error?{type:Jn.error,error:new s5(a.status,a.statusText,he),statusCode:a.status,headers:a.headers}:{type:Jn.data,data:he,statusCode:a.status,headers:a.headers}}if(p===Jn.error){if(Zy(a)){var y,T;if(a.data instanceof Error){var P,F;return{type:Jn.error,error:a.data,statusCode:(P=a.init)==null?void 0:P.status,headers:(F=a.init)!=null&&F.headers?new Headers(a.init.headers):void 0}}return{type:Jn.error,error:new s5(((y=a.init)==null?void 0:y.status)||500,void 0,a.data),statusCode:R2(a)?a.status:void 0,headers:(T=a.init)!=null&&T.headers?new Headers(a.init.headers):void 0}}return{type:Jn.error,error:a,statusCode:R2(a)?a.status:void 0}}if(VE(a)){var t,j;return{type:Jn.deferred,deferredData:a,statusCode:(t=a.init)==null?void 0:t.status,headers:((j=a.init)==null?void 0:j.headers)&&new Headers(a.init.headers)}}if(Zy(a)){var ie,ye;return{type:Jn.data,data:a.data,statusCode:(ie=a.init)==null?void 0:ie.status,headers:(ye=a.init)!=null&&ye.headers?new Headers(a.init.headers):void 0}}return{type:Jn.data,data:a}}function FE(i,a,p,y,T,P){let F=i.headers.get("Location");if(vn(F,"Redirects returned/thrown from loaders/actions must have a Location header"),!ag.test(F)){let t=y.slice(0,y.findIndex(j=>j.route.id===p)+1);F=Q6(new URL(a.url),t,T,!0,F,P),i.headers.set("Location",F)}return i}function Uy(i,a,p){if(ag.test(i)){let y=i,T=y.startsWith("//")?new URL(a.protocol+y):new URL(y),P=G0(T.pathname,p)!=null;if(T.origin===a.origin&&P)return T.pathname+T.search+T.hash}return i}function Qp(i,a,p,y){let T=i.createURL(Wx(a)).toString(),P={signal:p};if(y&&zu(y.formMethod)){let{formMethod:F,formEncType:t}=y;P.method=F.toUpperCase(),t==="application/json"?(P.headers=new Headers({"Content-Type":t}),P.body=JSON.stringify(y.json)):t==="text/plain"?P.body=y.text:t==="application/x-www-form-urlencoded"&&y.formData?P.body=t_(y.formData):P.body=y.formData}return new Request(T,P)}function t_(i){let a=new URLSearchParams;for(let[p,y]of i.entries())a.append(p,typeof y=="string"?y:y.name);return a}function Ny(i){let a=new FormData;for(let[p,y]of i.entries())a.append(p,y);return a}function OE(i,a,p,y,T){let P={},F=null,t,j=!1,ie={},ye=p&&mc(p[1])?p[1].error:void 0;return i.forEach(he=>{if(!(he.route.id in a))return;let ne=he.route.id,Ye=a[ne];if(vn(!ip(Ye),"Cannot handle redirect results in processLoaderData"),mc(Ye)){let lt=Ye.error;if(ye!==void 0&&(lt=ye,ye=void 0),F=F||{},T)F[ne]=lt;else{let at=Jd(i,ne);F[at.route.id]==null&&(F[at.route.id]=lt)}P[ne]=void 0,j||(j=!0,t=R2(Ye.error)?Ye.error.status:500),Ye.headers&&(ie[ne]=Ye.headers)}else od(Ye)?(y.set(ne,Ye.deferredData),P[ne]=Ye.deferredData.data,Ye.statusCode!=null&&Ye.statusCode!==200&&!j&&(t=Ye.statusCode),Ye.headers&&(ie[ne]=Ye.headers)):(P[ne]=Ye.data,Ye.statusCode&&Ye.statusCode!==200&&!j&&(t=Ye.statusCode),Ye.headers&&(ie[ne]=Ye.headers))}),ye!==void 0&&p&&(F={[p[0]]:ye},P[p[0]]=void 0),{loaderData:P,errors:F,statusCode:t||200,loaderHeaders:ie}}function Vy(i,a,p,y,T,P,F){let{loaderData:t,errors:j}=OE(a,p,y,F,!1);return T.forEach(ie=>{let{key:ye,match:he,controller:ne}=ie,Ye=P[ye];if(vn(Ye,"Did not find corresponding fetcher result"),!(ne&&ne.signal.aborted))if(mc(Ye)){let lt=Jd(i.matches,he==null?void 0:he.route.id);j&&j[lt.route.id]||(j=Mo({},j,{[lt.route.id]:Ye.error})),i.fetchers.delete(ye)}else if(ip(Ye))vn(!1,"Unhandled fetcher revalidation redirect");else if(od(Ye))vn(!1,"Unhandled fetcher deferred data");else{let lt=J1(Ye.data);i.fetchers.set(ye,lt)}}),{loaderData:t,errors:j}}function jy(i,a,p,y){let T=Mo({},a);for(let P of p){let F=P.route.id;if(a.hasOwnProperty(F)?a[F]!==void 0&&(T[F]=a[F]):i[F]!==void 0&&P.route.loader&&(T[F]=i[F]),y&&y.hasOwnProperty(F))break}return T}function Gy(i){return i?mc(i[1])?{actionData:{}}:{actionData:{[i[0]]:i[1].data}}:{}}function Jd(i,a){return(a?i.slice(0,i.findIndex(y=>y.route.id===a)+1):[...i]).reverse().find(y=>y.route.hasErrorBoundary===!0)||i[0]}function $y(i){let a=i.length===1?i[0]:i.find(p=>p.index||!p.path||p.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:a}],route:a}}function Ol(i,a){let{pathname:p,routeId:y,method:T,type:P,message:F}=a===void 0?{}:a,t="Unknown Server Error",j="Unknown @remix-run/router error";return i===400?(t="Bad Request",T&&p&&y?j="You made a "+T+' request to "'+p+'" but '+('did not provide a `loader` for route "'+y+'", ')+"so there is no way to handle the request.":P==="defer-action"?j="defer() is not supported in actions":P==="invalid-body"&&(j="Unable to encode submission body")):i===403?(t="Forbidden",j='Route "'+y+'" does not match URL "'+p+'"'):i===404?(t="Not Found",j='No route matches URL "'+p+'"'):i===405&&(t="Method Not Allowed",T&&p&&y?j="You made a "+T.toUpperCase()+' request to "'+p+'" but '+('did not provide an `action` for route "'+y+'", ')+"so there is no way to handle the request.":T&&(j='Invalid request method "'+T.toUpperCase()+'"')),new s5(i||500,t,new Error(j),!0)}function f3(i){let a=Object.entries(i);for(let p=a.length-1;p>=0;p--){let[y,T]=a[p];if(ip(T))return{key:y,result:T}}}function Wx(i){let a=typeof i=="string"?d1(i):i;return up(Mo({},a,{hash:""}))}function UE(i,a){return i.pathname!==a.pathname||i.search!==a.search?!1:i.hash===""?a.hash!=="":i.hash===a.hash?!0:a.hash!==""}function NE(i){return Xx(i.result)&&SE.has(i.result.status)}function od(i){return i.type===Jn.deferred}function mc(i){return i.type===Jn.error}function ip(i){return(i&&i.type)===Jn.redirect}function Zy(i){return typeof i=="object"&&i!=null&&"type"in i&&"data"in i&&"init"in i&&i.type==="DataWithResponseInit"}function VE(i){let a=i;return a&&typeof a=="object"&&typeof a.data=="object"&&typeof a.subscribe=="function"&&typeof a.cancel=="function"&&typeof a.resolveData=="function"}function Xx(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.headers=="object"&&typeof i.body<"u"}function jE(i){return EE.has(i.toLowerCase())}function zu(i){return wE.has(i.toLowerCase())}async function GE(i,a,p,y,T){let P=Object.entries(a);for(let F=0;F<P.length;F++){let[t,j]=P[F],ie=i.find(ne=>(ne==null?void 0:ne.route.id)===t);if(!ie)continue;let ye=y.find(ne=>ne.route.id===ie.route.id),he=ye!=null&&!Zx(ye,ie)&&(T&&T[ie.route.id])!==void 0;od(j)&&he&&await lg(j,p,!1).then(ne=>{ne&&(a[t]=ne)})}}async function $E(i,a,p){for(let y=0;y<p.length;y++){let{key:T,routeId:P,controller:F}=p[y],t=a[T];i.find(ie=>(ie==null?void 0:ie.route.id)===P)&&od(t)&&(vn(F,"Expected an AbortController for revalidating fetcher deferred result"),await lg(t,F.signal,!0).then(ie=>{ie&&(a[T]=ie)}))}}async function lg(i,a,p){if(p===void 0&&(p=!1),!await i.deferredData.resolveData(a)){if(p)try{return{type:Jn.data,data:i.deferredData.unwrappedData}}catch(T){return{type:Jn.error,error:T}}return{type:Jn.data,data:i.deferredData.data}}}function cg(i){return new URLSearchParams(i).getAll("index").some(a=>a==="")}function o2(i,a){let p=typeof a=="string"?d1(a).search:a.search;if(i[i.length-1].route.index&&cg(p||""))return i[i.length-1];let y=jx(i);return y[y.length-1]}function qy(i){let{formMethod:a,formAction:p,formEncType:y,text:T,formData:P,json:F}=i;if(!(!a||!p||!y)){if(T!=null)return{formMethod:a,formAction:p,formEncType:y,formData:void 0,json:void 0,text:T};if(P!=null)return{formMethod:a,formAction:p,formEncType:y,formData:P,json:void 0,text:void 0};if(F!==void 0)return{formMethod:a,formAction:p,formEncType:y,formData:void 0,json:F,text:void 0}}}function Q4(i,a){return a?{state:"loading",location:i,formMethod:a.formMethod,formAction:a.formAction,formEncType:a.formEncType,formData:a.formData,json:a.json,text:a.text}:{state:"loading",location:i,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function ZE(i,a){return{state:"submitting",location:i,formMethod:a.formMethod,formAction:a.formAction,formEncType:a.formEncType,formData:a.formData,json:a.json,text:a.text}}function Yf(i,a){return i?{state:"loading",formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text,data:a}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:a}}function qE(i,a){return{state:"submitting",formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text,data:a?a.data:void 0}}function J1(i){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:i}}function WE(i,a){try{let p=i.sessionStorage.getItem($x);if(p){let y=JSON.parse(p);for(let[T,P]of Object.entries(y||{}))P&&Array.isArray(P)&&a.set(T,new Set(P||[]))}}catch{}}function XE(i,a){if(a.size>0){let p={};for(let[y,T]of a)p[y]=[...T];try{i.sessionStorage.setItem($x,JSON.stringify(p))}catch(y){R0(!1,"Failed to save applied view transitions in sessionStorage ("+y+").")}}}/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function B2(){return B2=Object.assign?Object.assign.bind():function(i){for(var a=1;a<arguments.length;a++){var p=arguments[a];for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(i[y]=p[y])}return i},B2.apply(this,arguments)}const L5=Xt.createContext(null),Hx=Xt.createContext(null),pp=Xt.createContext(null),R5=Xt.createContext(null),fp=Xt.createContext({outlet:null,matches:[],isDataRoute:!1}),Kx=Xt.createContext(null);function HE(i,a){let{relative:p}=a===void 0?{}:a;q2()||vn(!1);let{basename:y,navigator:T}=Xt.useContext(pp),{hash:P,pathname:F,search:t}=Jx(i,{relative:p}),j=F;return y!=="/"&&(j=F==="/"?y:s1([y,F])),T.createHref({pathname:j,search:t,hash:P})}function q2(){return Xt.useContext(R5)!=null}function B5(){return q2()||vn(!1),Xt.useContext(R5).location}function Yx(i){Xt.useContext(pp).static||Xt.useLayoutEffect(i)}function KE(){let{isDataRoute:i}=Xt.useContext(fp);return i?lS():YE()}function YE(){q2()||vn(!1);let i=Xt.useContext(L5),{basename:a,future:p,navigator:y}=Xt.useContext(pp),{matches:T}=Xt.useContext(fp),{pathname:P}=B5(),F=JSON.stringify(og(T,p.v7_relativeSplatPath)),t=Xt.useRef(!1);return Yx(()=>{t.current=!0}),Xt.useCallback(function(ie,ye){if(ye===void 0&&(ye={}),!t.current)return;if(typeof ie=="number"){y.go(ie);return}let he=sg(ie,JSON.parse(F),P,ye.relative==="path");i==null&&a!=="/"&&(he.pathname=he.pathname==="/"?a:s1([a,he.pathname])),(ye.replace?y.replace:y.push)(he,ye.state,ye)},[a,y,F,P,i])}function Jx(i,a){let{relative:p}=a===void 0?{}:a,{future:y}=Xt.useContext(pp),{matches:T}=Xt.useContext(fp),{pathname:P}=B5(),F=JSON.stringify(og(T,y.v7_relativeSplatPath));return Xt.useMemo(()=>sg(i,JSON.parse(F),P,p==="path"),[i,F,P,p])}function JE(i,a,p,y){q2()||vn(!1);let{navigator:T,static:P}=Xt.useContext(pp),{matches:F}=Xt.useContext(fp),t=F[F.length-1],j=t?t.params:{};t&&t.pathname;let ie=t?t.pathnameBase:"/";t&&t.route;let ye=B5(),he;if(a){var ne;let Ne=typeof a=="string"?d1(a):a;ie==="/"||(ne=Ne.pathname)!=null&&ne.startsWith(ie)||vn(!1),he=Ne}else he=ye;let Ye=he.pathname||"/",lt=Ye;if(ie!=="/"){let Ne=ie.replace(/^\//,"").split("/");lt="/"+Ye.replace(/^\//,"").split("/").slice(Ne.length).join("/")}let at=!P&&p&&p.matches&&p.matches.length>0?p.matches:Yd(i,{pathname:lt}),Kt=rS(at&&at.map(Ne=>Object.assign({},Ne,{params:Object.assign({},j,Ne.params),pathname:s1([ie,T.encodeLocation?T.encodeLocation(Ne.pathname).pathname:Ne.pathname]),pathnameBase:Ne.pathnameBase==="/"?ie:s1([ie,T.encodeLocation?T.encodeLocation(Ne.pathnameBase).pathname:Ne.pathnameBase])})),F,p,y);return a&&Kt?Xt.createElement(R5.Provider,{value:{location:B2({pathname:"/",search:"",hash:"",state:null,key:"default"},he),navigationType:ms.Pop}},Kt):Kt}function QE(){let i=aS(),a=R2(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),p=i instanceof Error?i.stack:null,T={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},P=null;return Xt.createElement(Xt.Fragment,null,Xt.createElement("h2",null,"Unexpected Application Error!"),Xt.createElement("h3",{style:{fontStyle:"italic"}},a),p?Xt.createElement("pre",{style:T},p):null,P)}const eS=Xt.createElement(QE,null);class tS extends Xt.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,p){return p.location!==a.location||p.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:p.error,location:p.location,revalidation:a.revalidation||p.revalidation}}componentDidCatch(a,p){console.error("React Router caught the following error during render",a,p)}render(){return this.state.error!==void 0?Xt.createElement(fp.Provider,{value:this.props.routeContext},Xt.createElement(Kx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iS(i){let{routeContext:a,match:p,children:y}=i,T=Xt.useContext(L5);return T&&T.static&&T.staticContext&&(p.route.errorElement||p.route.ErrorBoundary)&&(T.staticContext._deepestRenderedBoundaryId=p.route.id),Xt.createElement(fp.Provider,{value:a},y)}function rS(i,a,p,y){var T;if(a===void 0&&(a=[]),p===void 0&&(p=null),y===void 0&&(y=null),i==null){var P;if(!p)return null;if(p.errors)i=p.matches;else if((P=y)!=null&&P.v7_partialHydration&&a.length===0&&!p.initialized&&p.matches.length>0)i=p.matches;else return null}let F=i,t=(T=p)==null?void 0:T.errors;if(t!=null){let ye=F.findIndex(he=>he.route.id&&(t==null?void 0:t[he.route.id])!==void 0);ye>=0||vn(!1),F=F.slice(0,Math.min(F.length,ye+1))}let j=!1,ie=-1;if(p&&y&&y.v7_partialHydration)for(let ye=0;ye<F.length;ye++){let he=F[ye];if((he.route.HydrateFallback||he.route.hydrateFallbackElement)&&(ie=ye),he.route.id){let{loaderData:ne,errors:Ye}=p,lt=he.route.loader&&ne[he.route.id]===void 0&&(!Ye||Ye[he.route.id]===void 0);if(he.route.lazy||lt){j=!0,ie>=0?F=F.slice(0,ie+1):F=[F[0]];break}}}return F.reduceRight((ye,he,ne)=>{let Ye,lt=!1,at=null,Kt=null;p&&(Ye=t&&he.route.id?t[he.route.id]:void 0,at=he.route.errorElement||eS,j&&(ie<0&&ne===0?(cS("route-fallback",!1),lt=!0,Kt=null):ie===ne&&(lt=!0,Kt=he.route.hydrateFallbackElement||null)));let Ne=a.concat(F.slice(0,ne+1)),Le=()=>{let je;return Ye?je=at:lt?je=Kt:he.route.Component?je=Xt.createElement(he.route.Component,null):he.route.element?je=he.route.element:je=ye,Xt.createElement(iS,{match:he,routeContext:{outlet:ye,matches:Ne,isDataRoute:p!=null},children:je})};return p&&(he.route.ErrorBoundary||he.route.errorElement||ne===0)?Xt.createElement(tS,{location:p.location,revalidation:p.revalidation,component:at,error:Ye,children:Le(),routeContext:{outlet:null,matches:Ne,isDataRoute:!0}}):Le()},null)}var Qx=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(Qx||{}),a5=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(a5||{});function nS(i){let a=Xt.useContext(L5);return a||vn(!1),a}function oS(i){let a=Xt.useContext(Hx);return a||vn(!1),a}function sS(i){let a=Xt.useContext(fp);return a||vn(!1),a}function ev(i){let a=sS(),p=a.matches[a.matches.length-1];return p.route.id||vn(!1),p.route.id}function aS(){var i;let a=Xt.useContext(Kx),p=oS(a5.UseRouteError),y=ev(a5.UseRouteError);return a!==void 0?a:(i=p.errors)==null?void 0:i[y]}function lS(){let{router:i}=nS(Qx.UseNavigateStable),a=ev(a5.UseNavigateStable),p=Xt.useRef(!1);return Yx(()=>{p.current=!0}),Xt.useCallback(function(T,P){P===void 0&&(P={}),p.current&&(typeof T=="number"?i.navigate(T):i.navigate(T,B2({fromRouteId:a},P)))},[i,a])}const Wy={};function cS(i,a,p){!a&&!Wy[i]&&(Wy[i]=!0)}function uS(i,a){i==null||i.v7_startTransition,(i==null?void 0:i.v7_relativeSplatPath)===void 0&&(!a||a.v7_relativeSplatPath),a&&(a.v7_fetcherPersist,a.v7_normalizeFormMethod,a.v7_partialHydration,a.v7_skipActionErrorRevalidation)}function hS(i){let{basename:a="/",children:p=null,location:y,navigationType:T=ms.Pop,navigator:P,static:F=!1,future:t}=i;q2()&&vn(!1);let j=a.replace(/^\/*/,"/"),ie=Xt.useMemo(()=>({basename:j,navigator:P,static:F,future:B2({v7_relativeSplatPath:!1},t)}),[j,t,P,F]);typeof y=="string"&&(y=d1(y));let{pathname:ye="/",search:he="",hash:ne="",state:Ye=null,key:lt="default"}=y,at=Xt.useMemo(()=>{let Kt=G0(ye,j);return Kt==null?null:{location:{pathname:Kt,search:he,hash:ne,state:Ye,key:lt},navigationType:T}},[j,ye,he,ne,Ye,lt,T]);return at==null?null:Xt.createElement(pp.Provider,{value:ie},Xt.createElement(R5.Provider,{children:p,value:at}))}new Promise(()=>{});function dS(i){let a={hasErrorBoundary:i.ErrorBoundary!=null||i.errorElement!=null};return i.Component&&Object.assign(a,{element:Xt.createElement(i.Component),Component:void 0}),i.HydrateFallback&&Object.assign(a,{hydrateFallbackElement:Xt.createElement(i.HydrateFallback),HydrateFallback:void 0}),i.ErrorBoundary&&Object.assign(a,{errorElement:Xt.createElement(i.ErrorBoundary),ErrorBoundary:void 0}),a}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function F2(){return F2=Object.assign?Object.assign.bind():function(i){for(var a=1;a<arguments.length;a++){var p=arguments[a];for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(i[y]=p[y])}return i},F2.apply(this,arguments)}function pS(i,a){if(i==null)return{};var p={},y=Object.keys(i),T,P;for(P=0;P<y.length;P++)T=y[P],!(a.indexOf(T)>=0)&&(p[T]=i[T]);return p}function fS(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function mS(i,a){return i.button===0&&(!a||a==="_self")&&!fS(i)}const _S=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],gS="6";try{window.__reactRouterVersion=gS}catch{}function OC(i,a){return AE({basename:a==null?void 0:a.basename,future:F2({},a==null?void 0:a.future,{v7_prependBasename:!0}),history:QT({window:a==null?void 0:a.window}),hydrationData:(a==null?void 0:a.hydrationData)||yS(),routes:i,mapRouteProperties:dS,dataStrategy:a==null?void 0:a.dataStrategy,patchRoutesOnNavigation:a==null?void 0:a.patchRoutesOnNavigation,window:a==null?void 0:a.window}).initialize()}function yS(){var i;let a=(i=window)==null?void 0:i.__staticRouterHydrationData;return a&&a.errors&&(a=F2({},a,{errors:xS(a.errors)})),a}function xS(i){if(!i)return null;let a=Object.entries(i),p={};for(let[y,T]of a)if(T&&T.__type==="RouteErrorResponse")p[y]=new s5(T.status,T.statusText,T.data,T.internal===!0);else if(T&&T.__type==="Error"){if(T.__subType){let P=window[T.__subType];if(typeof P=="function")try{let F=new P(T.message);F.stack="",p[y]=F}catch{}}if(p[y]==null){let P=new Error(T.message);P.stack="",p[y]=P}}else p[y]=T;return p}const vS=Xt.createContext({isTransitioning:!1}),bS=Xt.createContext(new Map),wS="startTransition",Xy=Nb[wS],TS="flushSync",Hy=JT[TS];function ES(i){Xy?Xy(i):i()}function Jf(i){Hy?Hy(i):i()}class SS{constructor(){this.status="pending",this.promise=new Promise((a,p)=>{this.resolve=y=>{this.status==="pending"&&(this.status="resolved",a(y))},this.reject=y=>{this.status==="pending"&&(this.status="rejected",p(y))}})}}function UC(i){let{fallbackElement:a,router:p,future:y}=i,[T,P]=Xt.useState(p.state),[F,t]=Xt.useState(),[j,ie]=Xt.useState({isTransitioning:!1}),[ye,he]=Xt.useState(),[ne,Ye]=Xt.useState(),[lt,at]=Xt.useState(),Kt=Xt.useRef(new Map),{v7_startTransition:Ne}=y||{},Le=Xt.useCallback(ri=>{Ne?ES(ri):ri()},[Ne]),je=Xt.useCallback((ri,zt)=>{let{deletedFetchers:Ci,flushSync:yr,viewTransitionOpts:ki}=zt;ri.fetchers.forEach((Qt,$t)=>{Qt.data!==void 0&&Kt.current.set($t,Qt.data)}),Ci.forEach(Qt=>Kt.current.delete(Qt));let fr=p.window==null||p.window.document==null||typeof p.window.document.startViewTransition!="function";if(!ki||fr){yr?Jf(()=>P(ri)):Le(()=>P(ri));return}if(yr){Jf(()=>{ne&&(ye&&ye.resolve(),ne.skipTransition()),ie({isTransitioning:!0,flushSync:!0,currentLocation:ki.currentLocation,nextLocation:ki.nextLocation})});let Qt=p.window.document.startViewTransition(()=>{Jf(()=>P(ri))});Qt.finished.finally(()=>{Jf(()=>{he(void 0),Ye(void 0),t(void 0),ie({isTransitioning:!1})})}),Jf(()=>Ye(Qt));return}ne?(ye&&ye.resolve(),ne.skipTransition(),at({state:ri,currentLocation:ki.currentLocation,nextLocation:ki.nextLocation})):(t(ri),ie({isTransitioning:!0,flushSync:!1,currentLocation:ki.currentLocation,nextLocation:ki.nextLocation}))},[p.window,ne,ye,Kt,Le]);Xt.useLayoutEffect(()=>p.subscribe(je),[p,je]),Xt.useEffect(()=>{j.isTransitioning&&!j.flushSync&&he(new SS)},[j]),Xt.useEffect(()=>{if(ye&&F&&p.window){let ri=F,zt=ye.promise,Ci=p.window.document.startViewTransition(async()=>{Le(()=>P(ri)),await zt});Ci.finished.finally(()=>{he(void 0),Ye(void 0),t(void 0),ie({isTransitioning:!1})}),Ye(Ci)}},[Le,F,ye,p.window]),Xt.useEffect(()=>{ye&&F&&T.location.key===F.location.key&&ye.resolve()},[ye,ne,T.location,F]),Xt.useEffect(()=>{!j.isTransitioning&&lt&&(t(lt.state),ie({isTransitioning:!0,flushSync:!1,currentLocation:lt.currentLocation,nextLocation:lt.nextLocation}),at(void 0))},[j.isTransitioning,lt]),Xt.useEffect(()=>{},[]);let _t=Xt.useMemo(()=>({createHref:p.createHref,encodeLocation:p.encodeLocation,go:ri=>p.navigate(ri),push:(ri,zt,Ci)=>p.navigate(ri,{state:zt,preventScrollReset:Ci==null?void 0:Ci.preventScrollReset}),replace:(ri,zt,Ci)=>p.navigate(ri,{replace:!0,state:zt,preventScrollReset:Ci==null?void 0:Ci.preventScrollReset})}),[p]),St=p.basename||"/",ci=Xt.useMemo(()=>({router:p,navigator:_t,static:!1,basename:St}),[p,_t,St]),dt=Xt.useMemo(()=>({v7_relativeSplatPath:p.future.v7_relativeSplatPath}),[p.future.v7_relativeSplatPath]);return Xt.useEffect(()=>uS(y,p.future),[y,p.future]),Xt.createElement(Xt.Fragment,null,Xt.createElement(L5.Provider,{value:ci},Xt.createElement(Hx.Provider,{value:T},Xt.createElement(bS.Provider,{value:Kt.current},Xt.createElement(vS.Provider,{value:j},Xt.createElement(hS,{basename:St,location:T.location,navigationType:T.historyAction,navigator:_t,future:dt},T.initialized||p.future.v7_partialHydration?Xt.createElement(MS,{routes:p.routes,future:p.future,state:T}):a))))),null)}const MS=Xt.memo(CS);function CS(i){let{routes:a,future:p,state:y}=i;return JE(a,void 0,y,p)}const IS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",AS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,NC=Xt.forwardRef(function(a,p){let{onClick:y,relative:T,reloadDocument:P,replace:F,state:t,target:j,to:ie,preventScrollReset:ye,viewTransition:he}=a,ne=pS(a,_S),{basename:Ye}=Xt.useContext(pp),lt,at=!1;if(typeof ie=="string"&&AS.test(ie)&&(lt=ie,IS))try{let je=new URL(window.location.href),_t=ie.startsWith("//")?new URL(je.protocol+ie):new URL(ie),St=G0(_t.pathname,Ye);_t.origin===je.origin&&St!=null?ie=St+_t.search+_t.hash:at=!0}catch{}let Kt=HE(ie,{relative:T}),Ne=PS(ie,{replace:F,state:t,target:j,preventScrollReset:ye,relative:T,viewTransition:he});function Le(je){y&&y(je),je.defaultPrevented||Ne(je)}return Xt.createElement("a",F2({},ne,{href:lt||Kt,onClick:at||P?y:Le,ref:p,target:j}))});var Ky;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(Ky||(Ky={}));var Yy;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(Yy||(Yy={}));function PS(i,a){let{target:p,replace:y,state:T,preventScrollReset:P,relative:F,viewTransition:t}=a===void 0?{}:a,j=KE(),ie=B5(),ye=Jx(i,{relative:F});return Xt.useCallback(he=>{if(mS(he,p)){he.preventDefault();let ne=y!==void 0?y:up(ie)===up(ye);j(i,{replace:ne,state:T,preventScrollReset:P,relative:F,viewTransition:t})}},[ie,j,ye,y,T,p,i,P,F,t])}var tv={exports:{}},kS="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",zS=kS,DS=zS;function iv(){}function rv(){}rv.resetWarningCache=iv;var LS=function(){function i(y,T,P,F,t,j){if(j!==DS){var ie=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw ie.name="Invariant Violation",ie}}i.isRequired=i;function a(){return i}var p={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:a,element:i,elementType:i,instanceOf:a,node:i,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:rv,resetWarningCache:iv};return p.PropTypes=p,p};tv.exports=LS();var RS=tv.exports;const An=yd(RS);var BS=typeof Element<"u",FS=typeof Map=="function",OS=typeof Set=="function",US=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function z3(i,a){if(i===a)return!0;if(i&&a&&typeof i=="object"&&typeof a=="object"){if(i.constructor!==a.constructor)return!1;var p,y,T;if(Array.isArray(i)){if(p=i.length,p!=a.length)return!1;for(y=p;y--!==0;)if(!z3(i[y],a[y]))return!1;return!0}var P;if(FS&&i instanceof Map&&a instanceof Map){if(i.size!==a.size)return!1;for(P=i.entries();!(y=P.next()).done;)if(!a.has(y.value[0]))return!1;for(P=i.entries();!(y=P.next()).done;)if(!z3(y.value[1],a.get(y.value[0])))return!1;return!0}if(OS&&i instanceof Set&&a instanceof Set){if(i.size!==a.size)return!1;for(P=i.entries();!(y=P.next()).done;)if(!a.has(y.value[0]))return!1;return!0}if(US&&ArrayBuffer.isView(i)&&ArrayBuffer.isView(a)){if(p=i.length,p!=a.length)return!1;for(y=p;y--!==0;)if(i[y]!==a[y])return!1;return!0}if(i.constructor===RegExp)return i.source===a.source&&i.flags===a.flags;if(i.valueOf!==Object.prototype.valueOf&&typeof i.valueOf=="function"&&typeof a.valueOf=="function")return i.valueOf()===a.valueOf();if(i.toString!==Object.prototype.toString&&typeof i.toString=="function"&&typeof a.toString=="function")return i.toString()===a.toString();if(T=Object.keys(i),p=T.length,p!==Object.keys(a).length)return!1;for(y=p;y--!==0;)if(!Object.prototype.hasOwnProperty.call(a,T[y]))return!1;if(BS&&i instanceof Element)return!1;for(y=p;y--!==0;)if(!((T[y]==="_owner"||T[y]==="__v"||T[y]==="__o")&&i.$$typeof)&&!z3(i[T[y]],a[T[y]]))return!1;return!0}return i!==i&&a!==a}var NS=function(a,p){try{return z3(a,p)}catch(y){if((y.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw y}};const VS=yd(NS);var jS=function(i,a,p,y,T,P,F,t){if(!i){var j;if(a===void 0)j=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var ie=[p,y,T,P,F,t],ye=0;j=new Error(a.replace(/%s/g,function(){return ie[ye++]})),j.name="Invariant Violation"}throw j.framesToPop=1,j}},GS=jS;const Jy=yd(GS);var $S=function(a,p,y,T){var P=y?y.call(T,a,p):void 0;if(P!==void 0)return!!P;if(a===p)return!0;if(typeof a!="object"||!a||typeof p!="object"||!p)return!1;var F=Object.keys(a),t=Object.keys(p);if(F.length!==t.length)return!1;for(var j=Object.prototype.hasOwnProperty.bind(p),ie=0;ie<F.length;ie++){var ye=F[ie];if(!j(ye))return!1;var he=a[ye],ne=p[ye];if(P=y?y.call(T,he,ne,ye):void 0,P===!1||P===void 0&&he!==ne)return!1}return!0};const ZS=yd($S);function fs(){return fs=Object.assign||function(i){for(var a=1;a<arguments.length;a++){var p=arguments[a];for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(i[y]=p[y])}return i},fs.apply(this,arguments)}function ug(i,a){i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i_(i,a)}function i_(i,a){return i_=Object.setPrototypeOf||function(p,y){return p.__proto__=y,p},i_(i,a)}function Qy(i,a){if(i==null)return{};var p,y,T={},P=Object.keys(i);for(y=0;y<P.length;y++)a.indexOf(p=P[y])>=0||(T[p]=i[p]);return T}var Nr={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title",FRAGMENT:"Symbol(react.fragment)"},qS={rel:["amphtml","canonical","alternate"]},WS={type:["application/ld+json"]},XS={charset:"",name:["robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},e8=Object.keys(Nr).map(function(i){return Nr[i]}),l5={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},HS=Object.keys(l5).reduce(function(i,a){return i[l5[a]]=a,i},{}),S0=function(i,a){for(var p=i.length-1;p>=0;p-=1){var y=i[p];if(Object.prototype.hasOwnProperty.call(y,a))return y[a]}return null},KS=function(i){var a=S0(i,Nr.TITLE),p=S0(i,"titleTemplate");if(Array.isArray(a)&&(a=a.join("")),p&&a)return p.replace(/%s/g,function(){return a});var y=S0(i,"defaultTitle");return a||y||void 0},YS=function(i){return S0(i,"onChangeClientState")||function(){}},e6=function(i,a){return a.filter(function(p){return p[i]!==void 0}).map(function(p){return p[i]}).reduce(function(p,y){return fs({},p,y)},{})},JS=function(i,a){return a.filter(function(p){return p[Nr.BASE]!==void 0}).map(function(p){return p[Nr.BASE]}).reverse().reduce(function(p,y){if(!p.length)for(var T=Object.keys(y),P=0;P<T.length;P+=1){var F=T[P].toLowerCase();if(i.indexOf(F)!==-1&&y[F])return p.concat(y)}return p},[])},Qf=function(i,a,p){var y={};return p.filter(function(T){return!!Array.isArray(T[i])||(T[i]!==void 0&&console&&typeof console.warn=="function"&&console.warn("Helmet: "+i+' should be of type "Array". Instead found type "'+typeof T[i]+'"'),!1)}).map(function(T){return T[i]}).reverse().reduce(function(T,P){var F={};P.filter(function(he){for(var ne,Ye=Object.keys(he),lt=0;lt<Ye.length;lt+=1){var at=Ye[lt],Kt=at.toLowerCase();a.indexOf(Kt)===-1||ne==="rel"&&he[ne].toLowerCase()==="canonical"||Kt==="rel"&&he[Kt].toLowerCase()==="stylesheet"||(ne=Kt),a.indexOf(at)===-1||at!=="innerHTML"&&at!=="cssText"&&at!=="itemprop"||(ne=at)}if(!ne||!he[ne])return!1;var Ne=he[ne].toLowerCase();return y[ne]||(y[ne]={}),F[ne]||(F[ne]={}),!y[ne][Ne]&&(F[ne][Ne]=!0,!0)}).reverse().forEach(function(he){return T.push(he)});for(var t=Object.keys(F),j=0;j<t.length;j+=1){var ie=t[j],ye=fs({},y[ie],F[ie]);y[ie]=ye}return T},[]).reverse()},QS=function(i,a){if(Array.isArray(i)&&i.length){for(var p=0;p<i.length;p+=1)if(i[p][a])return!0}return!1},nv=function(i){return Array.isArray(i)?i.join(""):i},t6=function(i,a){return Array.isArray(i)?i.reduce(function(p,y){return function(T,P){for(var F=Object.keys(T),t=0;t<F.length;t+=1)if(P[F[t]]&&P[F[t]].includes(T[F[t]]))return!0;return!1}(y,a)?p.priority.push(y):p.default.push(y),p},{priority:[],default:[]}):{default:i}},t8=function(i,a){var p;return fs({},i,((p={})[a]=void 0,p))},eM=[Nr.NOSCRIPT,Nr.SCRIPT,Nr.STYLE],i6=function(i,a){return a===void 0&&(a=!0),a===!1?String(i):String(i).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},i8=function(i){return Object.keys(i).reduce(function(a,p){var y=i[p]!==void 0?p+'="'+i[p]+'"':""+p;return a?a+" "+y:y},"")},r8=function(i,a){return a===void 0&&(a={}),Object.keys(i).reduce(function(p,y){return p[l5[y]||y]=i[y],p},a)},D3=function(i,a){return a.map(function(p,y){var T,P=((T={key:y})["data-rh"]=!0,T);return Object.keys(p).forEach(function(F){var t=l5[F]||F;t==="innerHTML"||t==="cssText"?P.dangerouslySetInnerHTML={__html:p.innerHTML||p.cssText}:P[t]=p[F]}),i1.createElement(i,P)})},qc=function(i,a,p){switch(i){case Nr.TITLE:return{toComponent:function(){return T=a.titleAttributes,(P={key:y=a.title})["data-rh"]=!0,F=r8(T,P),[i1.createElement(Nr.TITLE,F,y)];var y,T,P,F},toString:function(){return function(y,T,P,F){var t=i8(P),j=nv(T);return t?"<"+y+' data-rh="true" '+t+">"+i6(j,F)+"</"+y+">":"<"+y+' data-rh="true">'+i6(j,F)+"</"+y+">"}(i,a.title,a.titleAttributes,p)}};case"bodyAttributes":case"htmlAttributes":return{toComponent:function(){return r8(a)},toString:function(){return i8(a)}};default:return{toComponent:function(){return D3(i,a)},toString:function(){return function(y,T,P){return T.reduce(function(F,t){var j=Object.keys(t).filter(function(he){return!(he==="innerHTML"||he==="cssText")}).reduce(function(he,ne){var Ye=t[ne]===void 0?ne:ne+'="'+i6(t[ne],P)+'"';return he?he+" "+Ye:Ye},""),ie=t.innerHTML||t.cssText||"",ye=eM.indexOf(y)===-1;return F+"<"+y+' data-rh="true" '+j+(ye?"/>":">"+ie+"</"+y+">")},"")}(i,a,p)}}}},r_=function(i){var a=i.baseTag,p=i.bodyAttributes,y=i.encode,T=i.htmlAttributes,P=i.noscriptTags,F=i.styleTags,t=i.title,j=t===void 0?"":t,ie=i.titleAttributes,ye=i.linkTags,he=i.metaTags,ne=i.scriptTags,Ye={toComponent:function(){},toString:function(){return""}};if(i.prioritizeSeoTags){var lt=function(at){var Kt=at.linkTags,Ne=at.scriptTags,Le=at.encode,je=t6(at.metaTags,XS),_t=t6(Kt,qS),St=t6(Ne,WS);return{priorityMethods:{toComponent:function(){return[].concat(D3(Nr.META,je.priority),D3(Nr.LINK,_t.priority),D3(Nr.SCRIPT,St.priority))},toString:function(){return qc(Nr.META,je.priority,Le)+" "+qc(Nr.LINK,_t.priority,Le)+" "+qc(Nr.SCRIPT,St.priority,Le)}},metaTags:je.default,linkTags:_t.default,scriptTags:St.default}}(i);Ye=lt.priorityMethods,ye=lt.linkTags,he=lt.metaTags,ne=lt.scriptTags}return{priority:Ye,base:qc(Nr.BASE,a,y),bodyAttributes:qc("bodyAttributes",p,y),htmlAttributes:qc("htmlAttributes",T,y),link:qc(Nr.LINK,ye,y),meta:qc(Nr.META,he,y),noscript:qc(Nr.NOSCRIPT,P,y),script:qc(Nr.SCRIPT,ne,y),style:qc(Nr.STYLE,F,y),title:qc(Nr.TITLE,{title:j,titleAttributes:ie},y)}},m3=[],n_=function(i,a){var p=this;a===void 0&&(a=typeof document<"u"),this.instances=[],this.value={setHelmet:function(y){p.context.helmet=y},helmetInstances:{get:function(){return p.canUseDOM?m3:p.instances},add:function(y){(p.canUseDOM?m3:p.instances).push(y)},remove:function(y){var T=(p.canUseDOM?m3:p.instances).indexOf(y);(p.canUseDOM?m3:p.instances).splice(T,1)}}},this.context=i,this.canUseDOM=a,a||(i.helmet=r_({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))},ov=i1.createContext({}),tM=An.shape({setHelmet:An.func,helmetInstances:An.shape({get:An.func,add:An.func,remove:An.func})}),iM=typeof document<"u",s2=function(i){function a(p){var y;return(y=i.call(this,p)||this).helmetData=new n_(y.props.context,a.canUseDOM),y}return ug(a,i),a.prototype.render=function(){return i1.createElement(ov.Provider,{value:this.helmetData.value},this.props.children)},a}(Xt.Component);s2.canUseDOM=iM,s2.propTypes={context:An.shape({helmet:An.shape()}),children:An.node.isRequired},s2.defaultProps={context:{}},s2.displayName="HelmetProvider";var e0=function(i,a){var p,y=document.head||document.querySelector(Nr.HEAD),T=y.querySelectorAll(i+"[data-rh]"),P=[].slice.call(T),F=[];return a&&a.length&&a.forEach(function(t){var j=document.createElement(i);for(var ie in t)Object.prototype.hasOwnProperty.call(t,ie)&&(ie==="innerHTML"?j.innerHTML=t.innerHTML:ie==="cssText"?j.styleSheet?j.styleSheet.cssText=t.cssText:j.appendChild(document.createTextNode(t.cssText)):j.setAttribute(ie,t[ie]===void 0?"":t[ie]));j.setAttribute("data-rh","true"),P.some(function(ye,he){return p=he,j.isEqualNode(ye)})?P.splice(p,1):F.push(j)}),P.forEach(function(t){return t.parentNode.removeChild(t)}),F.forEach(function(t){return y.appendChild(t)}),{oldTags:P,newTags:F}},r6=function(i,a){var p=document.getElementsByTagName(i)[0];if(p){for(var y=p.getAttribute("data-rh"),T=y?y.split(","):[],P=[].concat(T),F=Object.keys(a),t=0;t<F.length;t+=1){var j=F[t],ie=a[j]||"";p.getAttribute(j)!==ie&&p.setAttribute(j,ie),T.indexOf(j)===-1&&T.push(j);var ye=P.indexOf(j);ye!==-1&&P.splice(ye,1)}for(var he=P.length-1;he>=0;he-=1)p.removeAttribute(P[he]);T.length===P.length?p.removeAttribute("data-rh"):p.getAttribute("data-rh")!==F.join(",")&&p.setAttribute("data-rh",F.join(","))}},n8=function(i,a){var p=i.baseTag,y=i.htmlAttributes,T=i.linkTags,P=i.metaTags,F=i.noscriptTags,t=i.onChangeClientState,j=i.scriptTags,ie=i.styleTags,ye=i.title,he=i.titleAttributes;r6(Nr.BODY,i.bodyAttributes),r6(Nr.HTML,y),function(at,Kt){at!==void 0&&document.title!==at&&(document.title=nv(at)),r6(Nr.TITLE,Kt)}(ye,he);var ne={baseTag:e0(Nr.BASE,p),linkTags:e0(Nr.LINK,T),metaTags:e0(Nr.META,P),noscriptTags:e0(Nr.NOSCRIPT,F),scriptTags:e0(Nr.SCRIPT,j),styleTags:e0(Nr.STYLE,ie)},Ye={},lt={};Object.keys(ne).forEach(function(at){var Kt=ne[at],Ne=Kt.newTags,Le=Kt.oldTags;Ne.length&&(Ye[at]=Ne),Le.length&&(lt[at]=ne[at].oldTags)}),a&&a(),t(i,Ye,lt)},e2=null,c5=function(i){function a(){for(var y,T=arguments.length,P=new Array(T),F=0;F<T;F++)P[F]=arguments[F];return(y=i.call.apply(i,[this].concat(P))||this).rendered=!1,y}ug(a,i);var p=a.prototype;return p.shouldComponentUpdate=function(y){return!ZS(y,this.props)},p.componentDidUpdate=function(){this.emitChange()},p.componentWillUnmount=function(){this.props.context.helmetInstances.remove(this),this.emitChange()},p.emitChange=function(){var y,T,P=this.props.context,F=P.setHelmet,t=null,j=(y=P.helmetInstances.get().map(function(ie){var ye=fs({},ie.props);return delete ye.context,ye}),{baseTag:JS(["href"],y),bodyAttributes:e6("bodyAttributes",y),defer:S0(y,"defer"),encode:S0(y,"encodeSpecialCharacters"),htmlAttributes:e6("htmlAttributes",y),linkTags:Qf(Nr.LINK,["rel","href"],y),metaTags:Qf(Nr.META,["name","charset","http-equiv","property","itemprop"],y),noscriptTags:Qf(Nr.NOSCRIPT,["innerHTML"],y),onChangeClientState:YS(y),scriptTags:Qf(Nr.SCRIPT,["src","innerHTML"],y),styleTags:Qf(Nr.STYLE,["cssText"],y),title:KS(y),titleAttributes:e6("titleAttributes",y),prioritizeSeoTags:QS(y,"prioritizeSeoTags")});s2.canUseDOM?(T=j,e2&&cancelAnimationFrame(e2),T.defer?e2=requestAnimationFrame(function(){n8(T,function(){e2=null})}):(n8(T),e2=null)):r_&&(t=r_(j)),F(t)},p.init=function(){this.rendered||(this.rendered=!0,this.props.context.helmetInstances.add(this),this.emitChange())},p.render=function(){return this.init(),null},a}(Xt.Component);c5.propTypes={context:tM.isRequired},c5.displayName="HelmetDispatcher";var rM=["children"],nM=["children"],n6=function(i){function a(){return i.apply(this,arguments)||this}ug(a,i);var p=a.prototype;return p.shouldComponentUpdate=function(y){return!VS(t8(this.props,"helmetData"),t8(y,"helmetData"))},p.mapNestedChildrenToProps=function(y,T){if(!T)return null;switch(y.type){case Nr.SCRIPT:case Nr.NOSCRIPT:return{innerHTML:T};case Nr.STYLE:return{cssText:T};default:throw new Error("<"+y.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")}},p.flattenArrayTypeChildren=function(y){var T,P=y.child,F=y.arrayTypeChildren;return fs({},F,((T={})[P.type]=[].concat(F[P.type]||[],[fs({},y.newChildProps,this.mapNestedChildrenToProps(P,y.nestedChildren))]),T))},p.mapObjectTypeChildren=function(y){var T,P,F=y.child,t=y.newProps,j=y.newChildProps,ie=y.nestedChildren;switch(F.type){case Nr.TITLE:return fs({},t,((T={})[F.type]=ie,T.titleAttributes=fs({},j),T));case Nr.BODY:return fs({},t,{bodyAttributes:fs({},j)});case Nr.HTML:return fs({},t,{htmlAttributes:fs({},j)});default:return fs({},t,((P={})[F.type]=fs({},j),P))}},p.mapArrayTypeChildrenToProps=function(y,T){var P=fs({},T);return Object.keys(y).forEach(function(F){var t;P=fs({},P,((t={})[F]=y[F],t))}),P},p.warnOnInvalidChildren=function(y,T){return Jy(e8.some(function(P){return y.type===P}),typeof y.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":"Only elements types "+e8.join(", ")+" are allowed. Helmet does not support rendering <"+y.type+"> elements. Refer to our API for more information."),Jy(!T||typeof T=="string"||Array.isArray(T)&&!T.some(function(P){return typeof P!="string"}),"Helmet expects a string as a child of <"+y.type+">. Did you forget to wrap your children in braces? ( <"+y.type+">{``}</"+y.type+"> ) Refer to our API for more information."),!0},p.mapChildrenToProps=function(y,T){var P=this,F={};return i1.Children.forEach(y,function(t){if(t&&t.props){var j=t.props,ie=j.children,ye=Qy(j,rM),he=Object.keys(ye).reduce(function(Ye,lt){return Ye[HS[lt]||lt]=ye[lt],Ye},{}),ne=t.type;switch(typeof ne=="symbol"?ne=ne.toString():P.warnOnInvalidChildren(t,ie),ne){case Nr.FRAGMENT:T=P.mapChildrenToProps(ie,T);break;case Nr.LINK:case Nr.META:case Nr.NOSCRIPT:case Nr.SCRIPT:case Nr.STYLE:F=P.flattenArrayTypeChildren({child:t,arrayTypeChildren:F,newChildProps:he,nestedChildren:ie});break;default:T=P.mapObjectTypeChildren({child:t,newProps:T,newChildProps:he,nestedChildren:ie})}}}),this.mapArrayTypeChildrenToProps(F,T)},p.render=function(){var y=this.props,T=y.children,P=Qy(y,nM),F=fs({},P),t=P.helmetData;return T&&(F=this.mapChildrenToProps(T,F)),!t||t instanceof n_||(t=new n_(t.context,t.instances)),t?i1.createElement(c5,fs({},F,{context:t.value,helmetData:void 0})):i1.createElement(ov.Consumer,null,function(j){return i1.createElement(c5,fs({},F,{context:j}))})},a}(Xt.Component);n6.propTypes={base:An.object,bodyAttributes:An.object,children:An.oneOfType([An.arrayOf(An.node),An.node]),defaultTitle:An.string,defer:An.bool,encodeSpecialCharacters:An.bool,htmlAttributes:An.object,link:An.arrayOf(An.object),meta:An.arrayOf(An.object),noscript:An.arrayOf(An.object),onChangeClientState:An.func,script:An.arrayOf(An.object),style:An.arrayOf(An.object),title:An.string,titleAttributes:An.object,titleTemplate:An.string,prioritizeSeoTags:An.bool,helmetData:An.object},n6.defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1},n6.displayName="Helmet";var sv={exports:{}};(function(i){var a={};function p(P){return Math.floor(Math.abs(P)+.5)*(P>=0?1:-1)}function y(P,F,t){P=p(P*t),F=p(F*t);var j=(P-F)*2;j<0&&(j=-j-1);for(var ie="";j>=32;)ie+=String.fromCharCode((32|j&31)+63),j/=32;return ie+=String.fromCharCode((j|0)+63),ie}a.decode=function(P,F){for(var t=0,j=0,ie=0,ye=[],he=0,ne=0,Ye=null,lt,at,Kt=Math.pow(10,Number.isInteger(F)?F:5);t<P.length;){Ye=null,he=1,ne=0;do Ye=P.charCodeAt(t++)-63,ne+=(Ye&31)*he,he*=32;while(Ye>=32);lt=ne&1?(-ne-1)/2:ne/2,he=1,ne=0;do Ye=P.charCodeAt(t++)-63,ne+=(Ye&31)*he,he*=32;while(Ye>=32);at=ne&1?(-ne-1)/2:ne/2,j+=lt,ie+=at,ye.push([j/Kt,ie/Kt])}return ye},a.encode=function(P,F){if(!P.length)return"";for(var t=Math.pow(10,Number.isInteger(F)?F:5),j=y(P[0][0],0,t)+y(P[0][1],0,t),ie=1;ie<P.length;ie++){var ye=P[ie],he=P[ie-1];j+=y(ye[0],he[0],t),j+=y(ye[1],he[1],t)}return j};function T(P){for(var F=[],t=0;t<P.length;t++){var j=P[t].slice();F.push([j[1],j[0]])}return F}a.fromGeoJSON=function(P,F){if(P&&P.type==="Feature"&&(P=P.geometry),!P||P.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return a.encode(T(P.coordinates),F)},a.toGeoJSON=function(P,F){var t=a.decode(P,F);return{type:"LineString",coordinates:T(t)}},i.exports&&(i.exports=a)})(sv);var VC=sv.exports;/* @preserve
 * gcoord 0.3.2, geographic coordinate library
 * Copyright (c) 2021 Jiulong Hu <me@hujiulong.com>
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var u5=function(){return u5=Object.assign||function(a){for(var p,y=1,T=arguments.length;y<T;y++){p=arguments[y];for(var P in p)Object.prototype.hasOwnProperty.call(p,P)&&(a[P]=p[P])}return a},u5.apply(this,arguments)},_c=Math.sin,oM=Math.cos,hg=Math.sqrt,h5=Math.abs,ol=Math.PI,o8=6378245,s8=.006693421622965823;function av(i,a){return i>=72.004&&i<=137.8347&&a>=.8293&&a<=55.8271}function sM(i,a){var p=-100+2*i+3*a+.2*a*a+.1*i*a+.2*hg(h5(i));return p+=(20*_c(6*i*ol)+20*_c(2*i*ol))*2/3,p+=(20*_c(a*ol)+40*_c(a/3*ol))*2/3,p+=(160*_c(a/12*ol)+320*_c(a*ol/30))*2/3,p}function aM(i,a){var p=300+i+2*a+.1*i*i+.1*i*a+.1*hg(h5(i));return p+=(20*_c(6*i*ol)+20*_c(2*i*ol))*2/3,p+=(20*_c(i*ol)+40*_c(i/3*ol))*2/3,p+=(150*_c(i/12*ol)+300*_c(i/30*ol))*2/3,p}function lM(i,a){var p=aM(i-105,a-35),y=sM(i-105,a-35),T=a/180*ol,P=_c(T);P=1-s8*P*P;var F=hg(P);return p=p*180/(o8/F*oM(T)*ol),y=y*180/(o8*(1-s8)/(P*F)*ol),[p,y]}function fd(i){var a=i[0],p=i[1];if(!av(a,p))return[a,p];var y=lM(a,p);return[a+y[0],p+y[1]]}function B0(i){var a=i[0],p=i[1];if(!av(a,p))return[a,p];for(var y=[a,p],T=y[0],P=y[1],F=fd([T,P]),t=F[0]-a,j=F[1]-p;h5(t)>1e-6||h5(j)>1e-6;)T-=t,P-=j,F=fd([T,P]),t=F[0]-a,j=F[1]-p;return[T,P]}var d5=Math.sin,p5=Math.cos,lv=Math.atan2,cv=Math.sqrt,cM=Math.PI,f5=cM*3e3/180;function M0(i){var a=i[0],p=i[1],y=a-.0065,T=p-.006,P=cv(y*y+T*T)-2e-5*d5(T*f5),F=lv(T,y)-3e-6*p5(y*f5),t=P*p5(F),j=P*d5(F);return[t,j]}function F0(i){var a=i[0],p=i[1],y=a,T=p,P=cv(y*y+T*T)+2e-5*d5(T*f5),F=lv(T,y)+3e-6*p5(y*f5),t=P*p5(F)+.0065,j=P*d5(F)+.006;return[t,j]}var a8=180/Math.PI,l8=Math.PI/180,m5=6378137,K1=20037508342789244e-9;function _3(i){return[i[0]*a8/m5,(Math.PI*.5-2*Math.atan(Math.exp(-i[1]/m5)))*a8]}function F5(i){var a=Math.abs(i[0])<=180?i[0]:i[0]-(i[0]<0?-1:1)*360,p=[m5*a*l8,m5*Math.log(Math.tan(Math.PI*.25+.5*i[1]*l8))];return p[0]>K1&&(p[0]=K1),p[0]<-K1&&(p[0]=-K1),p[1]>K1&&(p[1]=K1),p[1]<-K1&&(p[1]=-K1),p}var o_=Math.abs,c8=[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],u8=[75,60,45,30,15,0],uM=[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],hM=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]];function uv(i,a,p){var y=o_(a)/p[9],T=p[0]+p[1]*o_(i),P=p[2]+p[3]*y+p[4]*Math.pow(y,2)+p[5]*Math.pow(y,3)+p[6]*Math.pow(y,4)+p[7]*Math.pow(y,5)+p[8]*Math.pow(y,6);return T*=i<0?-1:1,P*=a<0?-1:1,[T,P]}function O5(i){for(var a=i[0],p=i[1],y=[],T=0;T<u8.length;T++)if(o_(p)>u8[T]){y=hM[T];break}return uv(a,p,y)}function g3(i){for(var a=i[0],p=i[1],y=[],T=0;T<c8.length;T++)if(p>=c8[T]){y=uM[T];break}return uv(a,p,y)}function Y1(i,a){if(!i)throw new Error(a)}function hv(i){return!!i&&Object.prototype.toString.call(i)==="[object Array]"}function h8(i){return!isNaN(Number(i))&&i!==null&&!hv(i)}function Yc(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var p=i.length-1;return function(){for(var y=[],T=0;T<arguments.length;T++)y[T]=arguments[T];for(var P=p,F=i[p].apply(null,y);P--;)F=i[P].call(null,F);return F}}function dv(i,a,p){if(p===void 0&&(p=!1),i!==null)for(var y,T,P,F,t,j,ie,ye=0,he=0,ne,Ye=i.type,lt=Ye==="FeatureCollection",at=Ye==="Feature",Kt=lt?i.features.length:1,Ne=0;Ne<Kt;Ne++){ie=lt?i.features[Ne].geometry:at?i.geometry:i,ne=ie?ie.type==="GeometryCollection":!1,t=ne?ie.geometries.length:1;for(var Le=0;Le<t;Le++){var je=0,_t=0;if(F=ne?ie.geometries[Le]:ie,F!==null){var St=F.type;switch(ye=p&&(St==="Polygon"||St==="MultiPolygon")?1:0,St){case null:break;case"Point":if(j=F.coordinates,a(j,he,Ne,je,_t)===!1)return!1;he++,je++;break;case"LineString":case"MultiPoint":for(j=F.coordinates,y=0;y<j.length;y++){if(a(j[y],he,Ne,je,_t)===!1)return!1;he++,St==="MultiPoint"&&je++}St==="LineString"&&je++;break;case"Polygon":case"MultiLineString":for(j=F.coordinates,y=0;y<j.length;y++){for(T=0;T<j[y].length-ye;T++){if(a(j[y][T],he,Ne,je,_t)===!1)return!1;he++}St==="MultiLineString"&&je++,St==="Polygon"&&_t++}St==="Polygon"&&je++;break;case"MultiPolygon":for(j=F.coordinates,y=0;y<j.length;y++){for(_t=0,T=0;T<j[y].length;T++){for(P=0;P<j[y][T].length-ye;P++){if(a(j[y][T][P],he,Ne,je,_t)===!1)return!1;he++}_t++}je++}break;case"GeometryCollection":for(y=0;y<F.geometries.length;y++)if(dv(F.geometries[y],a,p)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var t0,i0,r0,n0,o0,Io;(function(i){i.WGS84="WGS84",i.WGS1984="WGS84",i.EPSG4326="WGS84",i.GCJ02="GCJ02",i.AMap="GCJ02",i.BD09="BD09",i.BD09LL="BD09",i.Baidu="BD09",i.BMap="BD09",i.BD09MC="BD09MC",i.BD09Meter="BD09MC",i.EPSG3857="EPSG3857",i.EPSG900913="EPSG3857",i.EPSG102100="EPSG3857",i.WebMercator="EPSG3857",i.WM="EPSG3857"})(Io||(Io={}));var dM={to:(t0={},t0[Io.GCJ02]=fd,t0[Io.BD09]=Yc(F0,fd),t0[Io.BD09MC]=Yc(O5,F0,fd),t0[Io.EPSG3857]=F5,t0)},pM={to:(i0={},i0[Io.WGS84]=B0,i0[Io.BD09]=F0,i0[Io.BD09MC]=Yc(O5,F0),i0[Io.EPSG3857]=Yc(F5,B0),i0)},fM={to:(r0={},r0[Io.WGS84]=Yc(B0,M0),r0[Io.GCJ02]=M0,r0[Io.EPSG3857]=Yc(F5,B0,M0),r0[Io.BD09MC]=O5,r0)},mM={to:(n0={},n0[Io.WGS84]=_3,n0[Io.GCJ02]=Yc(fd,_3),n0[Io.BD09]=Yc(F0,fd,_3),n0[Io.BD09MC]=Yc(O5,F0,fd,_3),n0)},_M={to:(o0={},o0[Io.WGS84]=Yc(B0,M0,g3),o0[Io.GCJ02]=Yc(M0,g3),o0[Io.EPSG3857]=Yc(F5,B0,M0,g3),o0[Io.BD09]=g3,o0)},gM={WGS84:dM,GCJ02:pM,BD09:fM,EPSG3857:mM,BD09MC:_M};function yM(i,a,p){if(Y1(!!i,"The args[0] input coordinate is required"),Y1(!!a,"The args[1] original coordinate system is required"),Y1(!!p,"The args[2] target coordinate system is required"),a===p)return i;var y=gM[a];Y1(!!y,"Invalid original coordinate system: "+a);var T=y.to[p];Y1(!!T,"Invalid target coordinate system: "+p);var P=typeof i;if(Y1(P==="string"||P==="object","Invalid input coordinate type: "+P),P==="string")try{i=JSON.parse(i)}catch{throw new Error("Invalid input coordinate: "+i)}var F=!1;hv(i)&&(Y1(i.length>=2,"Invalid input coordinate: "+i),Y1(h8(i[0])&&h8(i[1]),"Invalid input coordinate: "+i),i=i.map(Number),F=!0);var t=T;return F?t(i):(dv(i,function(j){var ie;ie=t(j),j[0]=ie[0],j[1]=ie[1]}),i)}var xM=u5(u5({},Io),{CRSTypes:Io,transform:yM});const jC=xM;function O2(i){"@babel/helpers - typeof";return O2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},O2(i)}function vM(i,a){if(O2(i)!="object"||!i)return i;var p=i[Symbol.toPrimitive];if(p!==void 0){var y=p.call(i,a||"default");if(O2(y)!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(i)}function bM(i){var a=vM(i,"string");return O2(a)=="symbol"?a:a+""}function Go(i,a,p){return(a=bM(a))in i?Object.defineProperty(i,a,{value:p,enumerable:!0,configurable:!0,writable:!0}):i[a]=p,i}var Fa=1e-6,O0=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var i=0,a=arguments.length;a--;)i+=arguments[a]*arguments[a];return Math.sqrt(i)});function wM(){var i=new O0(4);return O0!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function TM(i,a,p){return i[0]=a[0]*p,i[1]=a[1]*p,i[2]=a[2]*p,i[3]=a[3]*p,i}function EM(i,a,p){var y=a[0],T=a[1],P=a[2],F=a[3];return i[0]=p[0]*y+p[4]*T+p[8]*P+p[12]*F,i[1]=p[1]*y+p[5]*T+p[9]*P+p[13]*F,i[2]=p[2]*y+p[6]*T+p[10]*P+p[14]*F,i[3]=p[3]*y+p[7]*T+p[11]*P+p[15]*F,i}(function(){var i=wM();return function(a,p,y,T,P,F){var t,j;for(p||(p=4),y||(y=0),T?j=Math.min(T*p+y,a.length):j=a.length,t=y;t<j;t+=p)i[0]=a[t],i[1]=a[t+1],i[2]=a[t+2],i[3]=a[t+3],P(i,i,F),a[t]=i[0],a[t+1]=i[1],a[t+2]=i[2],a[t+3]=i[3];return a}})();function L3(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function C0(i,a){const p=EM([],a,i);return TM(p,p,1/p[3]),p}function s_(i,a,p){return i<a?a:i>p?p:i}function SM(i){return Math.log(i)*Math.LOG2E}const MM=Math.log2||SM;function CM(i,a){var p=a[0],y=a[1],T=a[2],P=a[3],F=a[4],t=a[5],j=a[6],ie=a[7],ye=a[8],he=a[9],ne=a[10],Ye=a[11],lt=a[12],at=a[13],Kt=a[14],Ne=a[15],Le=p*t-y*F,je=p*j-T*F,_t=p*ie-P*F,St=y*j-T*t,ci=y*ie-P*t,dt=T*ie-P*j,ri=ye*at-he*lt,zt=ye*Kt-ne*lt,Ci=ye*Ne-Ye*lt,yr=he*Kt-ne*at,ki=he*Ne-Ye*at,fr=ne*Ne-Ye*Kt,Qt=Le*fr-je*ki+_t*yr+St*Ci-ci*zt+dt*ri;return Qt?(Qt=1/Qt,i[0]=(t*fr-j*ki+ie*yr)*Qt,i[1]=(T*ki-y*fr-P*yr)*Qt,i[2]=(at*dt-Kt*ci+Ne*St)*Qt,i[3]=(ne*ci-he*dt-Ye*St)*Qt,i[4]=(j*Ci-F*fr-ie*zt)*Qt,i[5]=(p*fr-T*Ci+P*zt)*Qt,i[6]=(Kt*_t-lt*dt-Ne*je)*Qt,i[7]=(ye*dt-ne*_t+Ye*je)*Qt,i[8]=(F*ki-t*Ci+ie*ri)*Qt,i[9]=(y*Ci-p*ki-P*ri)*Qt,i[10]=(lt*ci-at*_t+Ne*Le)*Qt,i[11]=(he*_t-ye*ci-Ye*Le)*Qt,i[12]=(t*zt-F*yr-j*ri)*Qt,i[13]=(p*yr-y*zt+T*ri)*Qt,i[14]=(at*je-lt*St-Kt*Le)*Qt,i[15]=(ye*St-he*je+ne*Le)*Qt,i):null}function o6(i,a,p){var y=a[0],T=a[1],P=a[2],F=a[3],t=a[4],j=a[5],ie=a[6],ye=a[7],he=a[8],ne=a[9],Ye=a[10],lt=a[11],at=a[12],Kt=a[13],Ne=a[14],Le=a[15],je=p[0],_t=p[1],St=p[2],ci=p[3];return i[0]=je*y+_t*t+St*he+ci*at,i[1]=je*T+_t*j+St*ne+ci*Kt,i[2]=je*P+_t*ie+St*Ye+ci*Ne,i[3]=je*F+_t*ye+St*lt+ci*Le,je=p[4],_t=p[5],St=p[6],ci=p[7],i[4]=je*y+_t*t+St*he+ci*at,i[5]=je*T+_t*j+St*ne+ci*Kt,i[6]=je*P+_t*ie+St*Ye+ci*Ne,i[7]=je*F+_t*ye+St*lt+ci*Le,je=p[8],_t=p[9],St=p[10],ci=p[11],i[8]=je*y+_t*t+St*he+ci*at,i[9]=je*T+_t*j+St*ne+ci*Kt,i[10]=je*P+_t*ie+St*Ye+ci*Ne,i[11]=je*F+_t*ye+St*lt+ci*Le,je=p[12],_t=p[13],St=p[14],ci=p[15],i[12]=je*y+_t*t+St*he+ci*at,i[13]=je*T+_t*j+St*ne+ci*Kt,i[14]=je*P+_t*ie+St*Ye+ci*Ne,i[15]=je*F+_t*ye+St*lt+ci*Le,i}function a_(i,a,p){var y=p[0],T=p[1],P=p[2],F,t,j,ie,ye,he,ne,Ye,lt,at,Kt,Ne;return a===i?(i[12]=a[0]*y+a[4]*T+a[8]*P+a[12],i[13]=a[1]*y+a[5]*T+a[9]*P+a[13],i[14]=a[2]*y+a[6]*T+a[10]*P+a[14],i[15]=a[3]*y+a[7]*T+a[11]*P+a[15]):(F=a[0],t=a[1],j=a[2],ie=a[3],ye=a[4],he=a[5],ne=a[6],Ye=a[7],lt=a[8],at=a[9],Kt=a[10],Ne=a[11],i[0]=F,i[1]=t,i[2]=j,i[3]=ie,i[4]=ye,i[5]=he,i[6]=ne,i[7]=Ye,i[8]=lt,i[9]=at,i[10]=Kt,i[11]=Ne,i[12]=F*y+ye*T+lt*P+a[12],i[13]=t*y+he*T+at*P+a[13],i[14]=j*y+ne*T+Kt*P+a[14],i[15]=ie*y+Ye*T+Ne*P+a[15]),i}function pv(i,a,p){var y=p[0],T=p[1],P=p[2];return i[0]=a[0]*y,i[1]=a[1]*y,i[2]=a[2]*y,i[3]=a[3]*y,i[4]=a[4]*T,i[5]=a[5]*T,i[6]=a[6]*T,i[7]=a[7]*T,i[8]=a[8]*P,i[9]=a[9]*P,i[10]=a[10]*P,i[11]=a[11]*P,i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],i}function IM(i,a,p){var y=Math.sin(p),T=Math.cos(p),P=a[4],F=a[5],t=a[6],j=a[7],ie=a[8],ye=a[9],he=a[10],ne=a[11];return a!==i&&(i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15]),i[4]=P*T+ie*y,i[5]=F*T+ye*y,i[6]=t*T+he*y,i[7]=j*T+ne*y,i[8]=ie*T-P*y,i[9]=ye*T-F*y,i[10]=he*T-t*y,i[11]=ne*T-j*y,i}function AM(i,a,p){var y=Math.sin(p),T=Math.cos(p),P=a[0],F=a[1],t=a[2],j=a[3],ie=a[4],ye=a[5],he=a[6],ne=a[7];return a!==i&&(i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15]),i[0]=P*T+ie*y,i[1]=F*T+ye*y,i[2]=t*T+he*y,i[3]=j*T+ne*y,i[4]=ie*T-P*y,i[5]=ye*T-F*y,i[6]=he*T-t*y,i[7]=ne*T-j*y,i}function PM(i,a,p,y,T){var P=1/Math.tan(a/2),F;return i[0]=P/p,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=P,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,T!=null&&T!==1/0?(F=1/(y-T),i[10]=(T+y)*F,i[14]=2*T*y*F):(i[10]=-1,i[14]=-2*y),i}var kM=PM;function d8(i,a){var p=i[0],y=i[1],T=i[2],P=i[3],F=i[4],t=i[5],j=i[6],ie=i[7],ye=i[8],he=i[9],ne=i[10],Ye=i[11],lt=i[12],at=i[13],Kt=i[14],Ne=i[15],Le=a[0],je=a[1],_t=a[2],St=a[3],ci=a[4],dt=a[5],ri=a[6],zt=a[7],Ci=a[8],yr=a[9],ki=a[10],fr=a[11],Qt=a[12],$t=a[13],Mt=a[14],ui=a[15];return Math.abs(p-Le)<=Fa*Math.max(1,Math.abs(p),Math.abs(Le))&&Math.abs(y-je)<=Fa*Math.max(1,Math.abs(y),Math.abs(je))&&Math.abs(T-_t)<=Fa*Math.max(1,Math.abs(T),Math.abs(_t))&&Math.abs(P-St)<=Fa*Math.max(1,Math.abs(P),Math.abs(St))&&Math.abs(F-ci)<=Fa*Math.max(1,Math.abs(F),Math.abs(ci))&&Math.abs(t-dt)<=Fa*Math.max(1,Math.abs(t),Math.abs(dt))&&Math.abs(j-ri)<=Fa*Math.max(1,Math.abs(j),Math.abs(ri))&&Math.abs(ie-zt)<=Fa*Math.max(1,Math.abs(ie),Math.abs(zt))&&Math.abs(ye-Ci)<=Fa*Math.max(1,Math.abs(ye),Math.abs(Ci))&&Math.abs(he-yr)<=Fa*Math.max(1,Math.abs(he),Math.abs(yr))&&Math.abs(ne-ki)<=Fa*Math.max(1,Math.abs(ne),Math.abs(ki))&&Math.abs(Ye-fr)<=Fa*Math.max(1,Math.abs(Ye),Math.abs(fr))&&Math.abs(lt-Qt)<=Fa*Math.max(1,Math.abs(lt),Math.abs(Qt))&&Math.abs(at-$t)<=Fa*Math.max(1,Math.abs(at),Math.abs($t))&&Math.abs(Kt-Mt)<=Fa*Math.max(1,Math.abs(Kt),Math.abs(Mt))&&Math.abs(Ne-ui)<=Fa*Math.max(1,Math.abs(Ne),Math.abs(ui))}function zM(){var i=new O0(2);return O0!=Float32Array&&(i[0]=0,i[1]=0),i}function p8(i,a,p){return i[0]=a[0]+p[0],i[1]=a[1]+p[1],i}function DM(i,a){return i[0]=-a[0],i[1]=-a[1],i}function fv(i,a,p,y){var T=a[0],P=a[1];return i[0]=T+y*(p[0]-T),i[1]=P+y*(p[1]-P),i}(function(){var i=zM();return function(a,p,y,T,P,F){var t,j;for(p||(p=2),y||(y=0),T?j=Math.min(T*p+y,a.length):j=a.length,t=y;t<j;t+=p)i[0]=a[t],i[1]=a[t+1],P(i,i,F),a[t]=i[0],a[t+1]=i[1];return a}})();function LM(){var i=new O0(3);return O0!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function RM(i,a,p){return i[0]=a[0]+p[0],i[1]=a[1]+p[1],i[2]=a[2]+p[2],i}function BM(i,a,p){return i[0]=a[0]*p[0],i[1]=a[1]*p[1],i[2]=a[2]*p[2],i}function FM(i,a){return i[0]=-a[0],i[1]=-a[1],i[2]=-a[2],i}var OM=BM;(function(){var i=LM();return function(a,p,y,T,P,F){var t,j;for(p||(p=3),y||(y=0),T?j=Math.min(T*p+y,a.length):j=a.length,t=y;t<j;t+=p)i[0]=a[t],i[1]=a[t+1],i[2]=a[t+2],P(i,i,F),a[t]=i[0],a[t+1]=i[1],a[t+2]=i[2];return a}})();function gd(i,a){if(!i)throw new Error(a||"@math.gl/web-mercator: assertion failed.")}const Lu=Math.PI,mv=Lu/4,Th=Lu/180,l_=180/Lu,U2=512,f8=4003e4,y3=85.051129,_v=1.5;function UM(i){return Math.pow(2,i)}function y0(i){const[a,p]=i;gd(Number.isFinite(a)),gd(Number.isFinite(p)&&p>=-90&&p<=90,"invalid latitude");const y=a*Th,T=p*Th,P=U2*(y+Lu)/(2*Lu),F=U2*(Lu+Math.log(Math.tan(mv+T*.5)))/(2*Lu);return[P,F]}function _2(i){const[a,p]=i,y=a/U2*(2*Lu)-Lu,T=2*(Math.atan(Math.exp(p/U2*(2*Lu)-Lu))-mv);return[y*l_,T*l_]}function NM(i){const{latitude:a,longitude:p,highPrecision:y=!1}=i;gd(Number.isFinite(a)&&Number.isFinite(p));const T=U2,P=Math.cos(a*Th),F=T/360,t=F/P,j=T/f8/P,ie={unitsPerMeter:[j,j,j],metersPerUnit:[1/j,1/j,1/j],unitsPerDegree:[F,t,j],degreesPerUnit:[1/F,1/t,1/j]};if(y){const ye=Th*Math.tan(a*Th)/P,he=F*ye/2,ne=T/f8*ye,Ye=ne/t*j;ie.unitsPerDegree2=[0,he,ne],ie.unitsPerMeter2=[Ye,0,Ye]}return ie}function VM(i){const{height:a,pitch:p,bearing:y,altitude:T,scale:P,center:F}=i,t=L3();a_(t,t,[0,0,-T]),IM(t,t,-p*Th),AM(t,t,y*Th);const j=P/a;return pv(t,t,[j,j,j]),F&&a_(t,t,FM([],F)),t}function jM(i){const{width:a,height:p,altitude:y,pitch:T=0,offset:P,center:F,scale:t,nearZMultiplier:j=1,farZMultiplier:ie=1}=i;let{fovy:ye=_5(_v)}=i;y!==void 0&&(ye=_5(y));const he=ye*Th,ne=T*Th,Ye=gv(ye);let lt=Ye;F&&(lt+=F[2]*t/Math.cos(ne)/p);const at=he*(.5+(P?P[1]:0)/p),Kt=Math.sin(at)*lt/Math.sin(s_(Math.PI/2-ne-at,.01,Math.PI-.01)),Ne=Math.sin(ne)*Kt+lt,Le=lt*10,je=Math.min(Ne*ie,Le);return{fov:he,aspect:a/p,focalDistance:Ye,near:j,far:je}}function GM(i){const{fov:a,aspect:p,near:y,far:T}=jM(i);return kM([],a,p,y,T)}function _5(i){return 2*Math.atan(.5/i)*l_}function gv(i){return .5/Math.tan(.5*i*Th)}function $M(i,a){const[p,y,T=0]=i;return gd(Number.isFinite(p)&&Number.isFinite(y)&&Number.isFinite(T)),C0(a,[p,y,T,1])}function m8(i,a,p=0){const[y,T,P]=i;if(gd(Number.isFinite(y)&&Number.isFinite(T),"invalid pixel coordinate"),Number.isFinite(P))return C0(a,[y,T,P,1]);const F=C0(a,[y,T,0,1]),t=C0(a,[y,T,1,1]),j=F[2],ie=t[2],ye=j===ie?0:((p||0)-j)/(ie-j);return fv([],F,t,ye)}function ZM(i){const{width:a,height:p,bounds:y,minExtent:T=0,maxZoom:P=24,offset:F=[0,0]}=i,[[t,j],[ie,ye]]=y,he=qM(i.padding),ne=y0([t,s_(ye,-y3,y3)]),Ye=y0([ie,s_(j,-y3,y3)]),lt=[Math.max(Math.abs(Ye[0]-ne[0]),T),Math.max(Math.abs(Ye[1]-ne[1]),T)],at=[a-he.left-he.right-Math.abs(F[0])*2,p-he.top-he.bottom-Math.abs(F[1])*2];gd(at[0]>0&&at[1]>0);const Kt=at[0]/lt[0],Ne=at[1]/lt[1],Le=(he.right-he.left)/2/Kt,je=(he.top-he.bottom)/2/Ne,_t=[(Ye[0]+ne[0])/2+Le,(Ye[1]+ne[1])/2+je],St=_2(_t),ci=Math.min(P,MM(Math.abs(Math.min(Kt,Ne))));return gd(Number.isFinite(ci)),{longitude:St[0],latitude:St[1],zoom:ci}}function qM(i=0){return typeof i=="number"?{top:i,bottom:i,left:i,right:i}:(gd(Number.isFinite(i.top)&&Number.isFinite(i.bottom)&&Number.isFinite(i.left)&&Number.isFinite(i.right)),i)}const _8=Math.PI/180;function WM(i,a=0){const{width:p,height:y,unproject:T}=i,P={targetZ:a},F=T([0,y],P),t=T([p,y],P);let j,ie;const ye=i.fovy?.5*i.fovy*_8:Math.atan(.5/i.altitude),he=(90-i.pitch)*_8;return ye>he-.01?(j=g8(i,0,a),ie=g8(i,p,a)):(j=T([0,0],P),ie=T([p,0],P)),[F,t,ie,j]}function g8(i,a,p){const{pixelUnprojectionMatrix:y}=i,T=C0(y,[a,0,1,1]),P=C0(y,[a,i.height,1,1]),t=(p*i.distanceScales.unitsPerMeter[2]-T[2])/(P[2]-T[2]),j=fv([],T,P,t),ie=_2(j);return ie.push(p),ie}class c_{constructor(a={width:1,height:1}){Go(this,"latitude",void 0),Go(this,"longitude",void 0),Go(this,"zoom",void 0),Go(this,"pitch",void 0),Go(this,"bearing",void 0),Go(this,"altitude",void 0),Go(this,"fovy",void 0),Go(this,"meterOffset",void 0),Go(this,"center",void 0),Go(this,"width",void 0),Go(this,"height",void 0),Go(this,"scale",void 0),Go(this,"distanceScales",void 0),Go(this,"viewMatrix",void 0),Go(this,"projectionMatrix",void 0),Go(this,"viewProjectionMatrix",void 0),Go(this,"pixelProjectionMatrix",void 0),Go(this,"pixelUnprojectionMatrix",void 0),Go(this,"equals",Ne=>Ne instanceof c_?Ne.width===this.width&&Ne.height===this.height&&d8(Ne.projectionMatrix,this.projectionMatrix)&&d8(Ne.viewMatrix,this.viewMatrix):!1),Go(this,"project",(Ne,Le={})=>{const{topLeft:je=!0}=Le,_t=this.projectPosition(Ne),St=$M(_t,this.pixelProjectionMatrix),[ci,dt]=St,ri=je?dt:this.height-dt;return Ne.length===2?[ci,ri]:[ci,ri,St[2]]}),Go(this,"unproject",(Ne,Le={})=>{const{topLeft:je=!0,targetZ:_t=void 0}=Le,[St,ci,dt]=Ne,ri=je?ci:this.height-ci,zt=_t&&_t*this.distanceScales.unitsPerMeter[2],Ci=m8([St,ri,dt],this.pixelUnprojectionMatrix,zt),[yr,ki,fr]=this.unprojectPosition(Ci);return Number.isFinite(dt)?[yr,ki,fr]:Number.isFinite(_t)?[yr,ki,_t]:[yr,ki]}),Go(this,"projectPosition",Ne=>{const[Le,je]=y0(Ne),_t=(Ne[2]||0)*this.distanceScales.unitsPerMeter[2];return[Le,je,_t]}),Go(this,"unprojectPosition",Ne=>{const[Le,je]=_2(Ne),_t=(Ne[2]||0)*this.distanceScales.metersPerUnit[2];return[Le,je,_t]});let{width:p,height:y,altitude:T=null,fovy:P=null}=a;const{latitude:F=0,longitude:t=0,zoom:j=0,pitch:ie=0,bearing:ye=0,position:he=null,nearZMultiplier:ne=.02,farZMultiplier:Ye=1.01}=a;p=p||1,y=y||1,P===null&&T===null?(T=_v,P=_5(T)):P===null?P=_5(T):T===null&&(T=gv(P));const lt=UM(j);T=Math.max(.75,T);const at=NM({longitude:t,latitude:F}),Kt=y0([t,F]);Kt.push(0),he&&RM(Kt,Kt,OM([],he,at.unitsPerMeter)),this.projectionMatrix=GM({width:p,height:y,scale:lt,center:Kt,pitch:ie,fovy:P,nearZMultiplier:ne,farZMultiplier:Ye}),this.viewMatrix=VM({height:y,scale:lt,center:Kt,pitch:ie,bearing:ye,altitude:T}),this.width=p,this.height=y,this.scale=lt,this.latitude=F,this.longitude=t,this.zoom=j,this.pitch=ie,this.bearing=ye,this.altitude=T,this.fovy=P,this.center=Kt,this.meterOffset=he||[0,0,0],this.distanceScales=at,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:a,height:p,projectionMatrix:y,viewMatrix:T}=this,P=L3();o6(P,P,y),o6(P,P,T),this.viewProjectionMatrix=P;const F=L3();pv(F,F,[a/2,-p/2,1]),a_(F,F,[1,-1,0]),o6(F,F,P);const t=CM(L3(),F);if(!t)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=F,this.pixelUnprojectionMatrix=t}projectFlat(a){return y0(a)}unprojectFlat(a){return _2(a)}getMapCenterByLngLatPosition({lngLat:a,pos:p}){const y=m8(p,this.pixelUnprojectionMatrix),T=y0(a),P=p8([],T,DM([],y)),F=p8([],this.center,P);return _2(F)}fitBounds(a,p={}){const{width:y,height:T}=this,{longitude:P,latitude:F,zoom:t}=ZM(Object.assign({width:y,height:T,bounds:a},p));return new c_({width:y,height:T,longitude:P,latitude:F,zoom:t})}getBounds(a){const p=this.getBoundingRegion(a),y=Math.min(...p.map(t=>t[0])),T=Math.max(...p.map(t=>t[0])),P=Math.min(...p.map(t=>t[1])),F=Math.max(...p.map(t=>t[1]));return[[y,P],[T,F]]}getBoundingRegion(a={}){return WM(this,a.z||0)}getLocationAtPoint({lngLat:a,pos:p}){return this.getMapCenterByLngLatPosition({lngLat:a,pos:p})}}const XM="FeatureCollection",HM=[{type:"Feature",properties:{name:"津巴布韦",full_name:"津巴布韦共和国",iso_a2:"ZW",iso_a3:"ZWE",iso_n3:"716"},geometry:{type:"Polygon",coordinates:[[[31.287891,-22.402051],[32.429785,-21.29707],[32.492383,-20.659766],[32.992773,-19.984863],[32.699707,-18.940918],[32.993066,-18.35957],[32.948047,-16.712305],[31.23623,-16.023633],[30.437793,-15.995313],[30.396094,-15.643066],[29.487305,-15.696777],[28.913086,-15.987793],[28.760547,-16.532129],[27.932227,-16.896191],[27.020801,-17.958398],[25.258789,-17.793555],[26.168066,-19.538281],[27.178223,-20.100977],[27.280762,-20.478711],[27.679297,-20.503027],[27.669434,-21.064258],[28.014063,-21.554199],[29.025586,-21.796875],[29.364844,-22.193945],[31.287891,-22.402051]]]}},{type:"Feature",properties:{name:"赞比亚",full_name:"赞比亚共和国",iso_a2:"ZM",iso_a3:"ZMB",iso_n3:"894"},geometry:{type:"Polygon",coordinates:[[[30.396094,-15.643066],[30.231836,-14.990332],[33.201758,-14.013379],[32.67041,-13.59043],[33.021582,-12.630469],[33.512305,-12.347754],[33.252344,-12.112598],[33.261328,-10.893359],[33.661523,-10.553125],[32.919922,-9.407422],[31.033398,-8.597656],[30.751172,-8.193652],[28.898145,-8.485449],[28.400684,-9.224805],[28.645508,-10.550195],[28.383398,-11.566699],[29.064355,-12.348828],[29.485547,-12.418457],[29.795117,-12.155469],[29.775195,-13.438086],[29.554199,-13.248926],[29.014258,-13.368848],[28.412891,-12.518066],[27.573828,-12.227051],[27.15918,-11.579199],[26.824023,-11.965234],[26.025977,-11.890137],[25.349414,-11.623047],[25.28877,-11.212402],[24.37793,-11.41709],[24.365723,-11.129883],[23.966504,-10.871777],[23.962988,-12.988477],[21.978906,-13.000977],[22.040234,-16.262793],[23.380664,-17.640625],[24.73291,-17.517773],[25.258789,-17.793555],[27.020801,-17.958398],[27.932227,-16.896191],[28.760547,-16.532129],[28.913086,-15.987793],[29.487305,-15.696777],[30.396094,-15.643066]]]}},{type:"Feature",properties:{name:"也门",full_name:"也门共和国",iso_a2:"YE",iso_a3:"YEM",iso_n3:"887"},geometry:{type:"MultiPolygon",coordinates:[[[[53.085645,16.648389],[51.977637,18.996143],[49.041992,18.581787],[48.172168,18.156934],[47.143555,16.94668],[46.727637,17.265576],[43.916992,17.324707],[43.417969,17.51626],[43.190918,17.359375],[43.165039,16.689404],[42.799316,16.371777],[42.657812,15.232812],[42.936426,14.938574],[43.231934,13.26709],[43.487598,12.698828],[44.005859,12.607666],[45.038672,12.815869],[45.657324,13.338721],[46.788867,13.465576],[47.989941,14.048096],[48.668359,14.050146],[49.349902,14.637793],[52.21748,15.655518],[52.327734,16.293555],[53.085645,16.648389]]],[[[53.763184,12.636816],[53.31582,12.533154],[53.718848,12.318994],[54.511133,12.552783],[53.763184,12.636816]]]]}},{type:"Feature",properties:{name:"越南",full_name:"越南社会主义共和国",iso_a2:"VN",iso_a3:"VNM",iso_n3:"704"},geometry:{type:"MultiPolygon",coordinates:[[[[104.063965,10.39082],[103.849512,10.371094],[104.018457,10.029199],[104.063965,10.39082]]],[[[107.972656,21.507959],[106.663574,21.978906],[106.550391,22.501367],[106.780273,22.778906],[105.842969,22.922803],[105.275391,23.345215],[103.941504,22.540088],[103.32666,22.769775],[102.981934,22.448242],[102.470898,22.750928],[102.127441,22.379199],[102.662012,21.676025],[102.949609,21.681348],[102.851172,21.265918],[103.104492,20.89165],[103.635059,20.69707],[104.101367,20.945508],[104.583203,20.64668],[104.367773,20.441406],[104.92793,20.018115],[104.587891,19.61875],[104.032031,19.675146],[103.891602,19.30498],[105.146484,18.650977],[105.114551,18.405273],[106.502246,16.954102],[106.656445,16.492627],[107.396387,16.043018],[107.165918,15.80249],[107.653125,15.255225],[107.519434,14.705078],[107.331445,14.126611],[107.605469,13.437793],[107.506445,12.364551],[106.413867,11.948438],[106.399219,11.687012],[105.851465,11.63501],[106.163965,10.794922],[105.755078,10.98999],[105.045703,10.911377],[104.850586,10.534473],[104.426367,10.41123],[105.084473,9.995703],[104.77041,8.597656],[105.114355,8.629199],[106.168359,9.396729],[105.830957,10.000732],[106.484082,9.559424],[106.136426,10.22168],[106.595605,9.859863],[106.785254,10.116455],[106.464063,10.298291],[106.757422,10.295801],[106.605859,10.464941],[106.947461,10.400342],[107.006641,10.660547],[107.261523,10.398389],[108.001367,10.720361],[108.986719,11.336377],[109.198633,11.724854],[109.423926,12.955957],[108.821289,15.37793],[106.370508,17.746875],[106.499023,17.946436],[105.621777,18.966309],[105.984082,19.939062],[106.572852,20.392188],[106.683398,21.000293],[107.164746,20.94873],[107.972656,21.507959]]]]}},{type:"Feature",properties:{name:"委内瑞拉",full_name:"委内瑞拉玻利瓦尔共和国",iso_a2:"VE",iso_a3:"VEN",iso_n3:"862"},geometry:{type:"MultiPolygon",coordinates:[[[[-63.849365,11.131006],[-64.402344,10.981592],[-63.917627,10.887549],[-63.849365,11.131006]]],[[[-60.017529,8.549316],[-61.304004,8.4104],[-61.618701,8.597461],[-61.247266,8.600342],[-60.79248,9.360742],[-61.588867,9.894531],[-61.735938,9.631201],[-62.0771,9.975049],[-62.32041,9.783057],[-62.550342,10.200439],[-62.740576,10.056152],[-62.913574,10.531494],[-61.879492,10.741016],[-64.298193,10.635156],[-63.731885,10.503418],[-65.129102,10.070068],[-65.851758,10.257764],[-66.247217,10.632227],[-68.139941,10.492725],[-68.398633,11.160986],[-68.827979,11.431738],[-69.631592,11.479932],[-70.003955,12.177881],[-70.286523,11.886035],[-69.804785,11.474219],[-71.469531,10.96416],[-71.494238,10.533203],[-71.052686,9.705811],[-71.241406,9.160449],[-71.619531,9.047949],[-72.112842,9.815576],[-71.594336,10.657373],[-71.956934,11.569922],[-71.319727,11.861914],[-71.958105,11.666406],[-72.690088,10.83584],[-73.366211,9.194141],[-72.796387,9.108984],[-72.390332,8.287061],[-72.471973,7.524268],[-72.006641,7.032617],[-70.129199,6.953613],[-69.427148,6.123975],[-67.481982,6.180273],[-67.855273,4.506885],[-67.311133,3.415869],[-67.859082,2.793604],[-67.21084,2.390137],[-66.876025,1.223047],[-66.347119,.767188],[-65.681445,.983447],[-65.473389,.69126],[-64.205029,1.529492],[-64.008496,1.931592],[-63.43252,2.155566],[-63.389258,2.411914],[-64.046582,2.502393],[-64.221094,3.587402],[-64.788672,4.276025],[-64.021484,3.929102],[-63.338672,3.943896],[-62.856982,3.593457],[-62.712109,4.01792],[-61.002832,4.535254],[-60.603857,4.949365],[-60.742139,5.202051],[-61.39082,5.93877],[-61.128711,6.214307],[-61.145605,6.694531],[-60.3521,7.002881],[-60.718652,7.535937],[-59.849072,8.248682],[-60.017529,8.549316]]]]}},{type:"Feature",properties:{name:"梵蒂冈",full_name:"梵蒂冈城国",iso_a2:"VA",iso_a3:"VAT",iso_n3:"336"},geometry:{type:"Polygon",coordinates:[[[12.43916,41.898389],[12.430566,41.905469],[12.430566,41.897559],[12.43916,41.898389]]]}},{type:"Feature",properties:{name:"瓦努阿图",full_name:"瓦努阿图共和国",iso_a2:"VU",iso_a3:"VUT",iso_n3:"548"},geometry:{type:"MultiPolygon",coordinates:[[[[166.745801,-14.826855],[166.567383,-14.641797],[166.631055,-15.406055],[166.758301,-15.631152],[167.093945,-15.580859],[167.075586,-14.935645],[166.810156,-15.157422],[166.745801,-14.826855]]],[[[167.4125,-16.095898],[167.199512,-15.885059],[167.449316,-16.55498],[167.836621,-16.449707],[167.4125,-16.095898]]],[[[168.29668,-16.336523],[168.163867,-16.081641],[167.929004,-16.228711],[168.29668,-16.336523]]],[[[168.445801,-17.542188],[168.158203,-17.710547],[168.524609,-17.798047],[168.445801,-17.542188]]],[[[167.911328,-15.435938],[168.002539,-15.283203],[167.674219,-15.451562],[167.911328,-15.435938]]],[[[169.491309,-19.540137],[169.247461,-19.344727],[169.347266,-19.623535],[169.491309,-19.540137]]],[[[169.334375,-18.940234],[169.01582,-18.64375],[168.986914,-18.871289],[169.334375,-18.940234]]]]}},{type:"Feature",properties:{name:"乌兹别克斯坦",full_name:"乌兹别克斯坦共和国",iso_a2:"UZ",iso_a3:"UZB",iso_n3:"860"},geometry:{type:"Polygon",coordinates:[[[70.946777,42.248682],[69.153613,41.425244],[68.572656,40.622656],[68.291895,40.656104],[67.935742,41.196582],[66.709668,41.17915],[66.498633,41.994873],[66.00957,42.004883],[66.100293,42.99082],[65.803027,42.876953],[64.905469,43.714697],[61.990234,43.492139],[61.00791,44.393799],[58.555273,45.555371],[55.975684,44.994922],[55.977441,41.322217],[57.017969,41.263477],[56.964063,41.856543],[58.028906,42.487646],[58.474414,42.299365],[58.151563,42.628076],[58.589063,42.778467],[59.985156,42.211719],[60.089648,41.399414],[61.902832,41.093701],[62.483203,39.975635],[63.763672,39.160547],[65.612891,38.238574],[66.60625,37.986719],[66.522266,37.348486],[67.758984,37.172217],[68.350293,38.211035],[68.13252,38.927637],[67.357617,39.216699],[67.426172,39.465576],[68.463281,39.536719],[68.97207,40.089941],[68.630664,40.16709],[69.274902,40.198096],[69.357227,40.767383],[69.712891,40.656982],[70.401953,41.035107],[70.751074,40.721777],[70.371582,40.384131],[70.958008,40.238867],[71.69248,40.152344],[73.136914,40.810645],[72.187305,41.025928],[71.664941,41.541211],[71.393066,41.123389],[70.200879,41.514453],[71.228516,42.162891],[70.946777,42.248682]]]}},{type:"Feature",properties:{name:"乌拉圭",full_name:"乌拉圭东岸共和国",iso_a2:"UY",iso_a3:"URY",iso_n3:"858"},geometry:{type:"Polygon",coordinates:[[[-53.370605,-33.742188],[-53.531348,-33.170898],[-53.125586,-32.736719],[-53.761719,-32.056836],[-55.603027,-30.850781],[-56.004687,-31.079199],[-56.044824,-30.777637],[-56.832715,-30.107227],[-57.608887,-30.187793],[-58.201172,-32.47168],[-58.092676,-32.967383],[-58.363525,-33.182324],[-58.438135,-33.719141],[-57.829102,-34.477344],[-57.170703,-34.452344],[-56.249951,-34.90127],[-54.902295,-34.932813],[-53.785303,-34.380371],[-53.370605,-33.742188]]]}},{type:"Feature",properties:{name:"密克罗尼西亚",full_name:"密克罗尼西亚联邦",iso_a2:"FM",iso_a3:"FSM",iso_n3:"583"},geometry:{type:"Polygon",coordinates:[[[158.314844,6.813672],[158.294629,6.951074],[158.134766,6.944824],[158.314844,6.813672]]]}},{type:"Feature",properties:{name:"马绍尔群岛",full_name:"马绍尔群岛共和国",iso_a2:"MH",iso_a3:"MHL",iso_n3:"584"},geometry:{type:"Polygon",coordinates:[[[171.101953,7.138232],[171.035742,7.156104],[171.235352,7.06875],[171.39375,7.110938],[171.101953,7.138232]]]}},{type:"Feature",properties:{name:"北马里亚纳群岛",full_name:"北马里亚纳群岛联邦（美国）",iso_a2:"MP",iso_a3:"MNP",iso_n3:"580"},geometry:{type:"Polygon",coordinates:[[[145.751953,15.133154],[145.821875,15.265381],[145.713184,15.215283],[145.751953,15.133154]]]}},{type:"Feature",properties:{name:"美属维尔京群岛",full_name:"美属维尔京群岛",iso_a2:"VI",iso_a3:"VIR",iso_n3:"850"},geometry:{type:"Polygon",coordinates:[[[-64.765625,17.794336],[-64.889111,17.701709],[-64.580469,17.750195],[-64.765625,17.794336]]]}},{type:"Feature",properties:{name:"关岛",full_name:"关岛",iso_a2:"GU",iso_a3:"GUM",iso_n3:"316"},geometry:{type:"Polygon",coordinates:[[[144.741797,13.259277],[144.875391,13.614648],[144.649316,13.428711],[144.741797,13.259277]]]}},{type:"Feature",properties:{name:"美属萨摩亚",full_name:"美属萨摩亚",iso_a2:"AS",iso_a3:"ASM",iso_n3:"016"},geometry:{type:"Polygon",coordinates:[[[-170.72627,-14.351172],[-170.568115,-14.266797],[-170.820508,-14.312109],[-170.72627,-14.351172]]]}},{type:"Feature",properties:{name:"波多黎各",full_name:"波多黎各自由邦",iso_a2:"PR",iso_a3:"PRI",iso_n3:"630"},geometry:{type:"Polygon",coordinates:[[[-66.129395,18.444922],[-67.158643,18.499219],[-67.196875,17.994189],[-65.970801,17.974365],[-65.62085,18.242334],[-66.129395,18.444922]]]}},{type:"Feature",properties:{name:"美国",full_name:"美利坚合众国",iso_a2:"US",iso_a3:"USA",iso_n3:"840"},geometry:{type:"MultiPolygon",coordinates:[[[[-171.463037,63.640039],[-171.631836,63.351221],[-170.848389,63.444385],[-169.676367,62.956104],[-168.761328,63.21377],[-170.299365,63.680615],[-171.463037,63.640039]]],[[[-166.135449,60.383545],[-167.436426,60.206641],[-166.14873,59.764111],[-165.591797,59.913135],[-166.135449,60.383545]]],[[[-152.898047,57.823926],[-153.841553,57.862842],[-153.687695,57.305127],[-154.116162,57.651221],[-154.673193,57.446094],[-154.338965,56.920898],[-154.24375,57.143018],[-153.793213,56.989502],[-154.027344,56.777979],[-152.679053,57.345117],[-152.940771,57.498096],[-152.216211,57.577002],[-152.898047,57.823926]]],[[[-130.025098,55.888232],[-130.097852,56.109277],[-131.824268,56.58999],[-133.401123,58.410889],[-135.475928,59.793262],[-137.438574,58.903125],[-139.185156,60.083594],[-139.079248,60.343701],[-141.002148,60.300244],[-141.002148,64.975537],[-141.002148,69.650781],[-143.218311,70.11626],[-145.197363,70.008691],[-149.269434,70.500781],[-151.944678,70.4521],[-152.491211,70.880957],[-154.195215,70.801123],[-155.166846,71.099219],[-155.973535,70.841992],[-155.579443,71.121094],[-156.470215,71.407666],[-157.909375,70.860107],[-159.680908,70.786768],[-159.865674,70.278857],[-160.117139,70.591211],[-162.073877,70.161963],[-161.880957,70.331738],[-163.86792,69.03667],[-166.209082,68.885352],[-166.786279,68.359619],[-164.125195,67.606738],[-163.531836,67.102588],[-161.719922,67.020557],[-161.856689,66.700342],[-160.360889,66.6125],[-160.231689,66.420264],[-161.591016,66.459521],[-162.361621,66.947314],[-161.916895,66.411816],[-161.034277,66.188818],[-163.695361,66.083838],[-163.638232,66.574658],[-164.460498,66.588428],[-168.088379,65.657764],[-166.157031,65.28584],[-166.928418,65.15708],[-166.142773,64.582764],[-163.144336,64.423828],[-163.203906,64.652002],[-162.807031,64.374219],[-161.759375,64.81626],[-160.855908,64.755615],[-161.490723,64.433789],[-160.778564,63.818945],[-161.099707,63.55791],[-162.282812,63.529199],[-163.287842,63.046436],[-164.409033,63.215039],[-164.757861,62.496729],[-166.078809,61.803125],[-165.565869,61.102344],[-165.273633,61.274854],[-164.868994,61.111768],[-165.114844,60.932812],[-163.749023,60.969727],[-163.420947,60.757422],[-164.372363,60.591846],[-164.805176,60.892041],[-165.353809,60.541211],[-163.680371,59.801514],[-162.570752,59.989746],[-162.684961,60.268945],[-161.962012,60.695361],[-162.421338,60.283984],[-161.828711,59.588623],[-161.981055,59.146143],[-161.644385,59.109668],[-162.144922,58.644238],[-160.363135,59.051172],[-158.950684,58.404541],[-158.809473,58.973877],[-158.080518,58.977441],[-158.503174,58.850342],[-158.190918,58.614258],[-156.808887,59.134277],[-157.523633,58.421338],[-157.193701,58.194189],[-157.610889,58.05083],[-157.461914,57.506201],[-158.320947,57.2979],[-158.675146,56.794873],[-160.302051,56.314111],[-160.291699,55.805078],[-161.697314,55.907227],[-163.278809,55.121826],[-163.335303,54.83916],[-163.131104,54.916553],[-163.119629,55.064697],[-162.674365,54.996582],[-162.630371,55.24668],[-162.073975,55.139307],[-161.516943,55.618408],[-161.381934,55.371289],[-159.771387,55.841113],[-159.659668,55.625928],[-158.275635,56.19624],[-158.414404,56.43584],[-156.629004,57.009961],[-156.435889,57.359961],[-154.247021,58.159424],[-153.437598,58.754834],[-154.17832,59.155566],[-152.660107,59.997217],[-153.025,60.295654],[-152.540918,60.26543],[-151.593506,60.979639],[-149.433545,61.500781],[-150.053271,61.171094],[-149.075098,60.876416],[-150.44126,61.023584],[-151.356445,60.722949],[-151.853223,59.78208],[-151.046484,59.771826],[-151.884619,59.386328],[-151.738184,59.188525],[-150.934521,59.249121],[-149.713867,59.91958],[-149.598047,59.770459],[-149.395264,60.105762],[-148.430713,59.989111],[-147.964111,60.484863],[-148.640137,60.489453],[-148.256738,60.675293],[-148.556152,60.827002],[-147.751855,61.218945],[-147.891113,60.889893],[-146.284912,61.112646],[-146.570459,60.72915],[-145.674902,60.651123],[-145.898877,60.478174],[-145.248291,60.380127],[-144.691113,60.669092],[-144.901318,60.335156],[-144.147217,60.016406],[-141.40874,60.117676],[-141.408301,59.902783],[-140.419824,59.710742],[-139.431445,60.012256],[-138.988086,59.83501],[-139.286719,59.610938],[-139.512305,59.953564],[-139.773291,59.527295],[-136.607422,58.243994],[-136.061475,58.452734],[-136.989014,59.034473],[-136.22583,58.765479],[-136.150049,59.048096],[-135.897559,58.400195],[-135.090234,58.24585],[-135.363672,59.419434],[-134.776123,58.453857],[-134.208838,58.232959],[-133.876758,58.518164],[-134.031104,58.072168],[-133.194336,57.877686],[-133.535205,57.832959],[-133.117041,57.566211],[-133.64873,57.642285],[-133.465869,57.172168],[-131.551367,56.206787],[-132.15542,55.599561],[-131.032764,56.088086],[-130.748193,55.318018],[-131.047852,55.157666],[-130.575342,54.769678],[-130.214062,55.025879],[-130.025098,55.888232]]],[[[-163.476025,54.980713],[-164.478613,54.906836],[-164.823438,54.419092],[-163.083252,54.668994],[-163.378955,54.815527],[-163.476025,54.980713]]],[[[-133.305078,55.54375],[-133.737109,55.496924],[-133.650195,55.269287],[-133.305078,55.54375]]],[[[-131.339746,55.079834],[-131.56543,55.264111],[-131.329541,54.887744],[-131.339746,55.079834]]],[[[-132.112354,56.109375],[-132.379834,56.498779],[-132.659912,56.078174],[-132.287305,55.929395],[-132.112354,56.109375]]],[[[-130.97915,55.48916],[-131.269238,55.955371],[-131.7625,55.16582],[-131.447559,55.408789],[-131.187891,55.206299],[-130.97915,55.48916]]],[[[-133.366211,57.003516],[-133.979443,57.00957],[-133.48418,56.451758],[-133.158154,56.495166],[-133.328955,56.830078],[-132.95918,56.677051],[-133.366211,57.003516]]],[[[-132.862256,54.894434],[-133.429053,55.303809],[-132.705811,54.68418],[-132.862256,54.894434]]],[[[-160.684912,55.314795],[-160.795068,55.145215],[-160.487549,55.184863],[-160.684912,55.314795]]],[[[-177.148193,51.716748],[-177.110059,51.92876],[-177.670215,51.701074],[-177.148193,51.716748]]],[[[-134.969775,57.351416],[-135.448682,57.534375],[-135.812305,57.009521],[-135.454932,57.249414],[-134.681885,56.216162],[-134.969775,57.351416]]],[[[-134.680273,58.16167],[-134.923486,58.354639],[-134.516016,57.042578],[-133.911133,57.352539],[-134.292334,58.044727],[-133.822754,57.628662],[-134.240088,58.143994],[-134.680273,58.16167]]],[[[-135.730371,58.244238],[-136.568604,57.972168],[-135.910791,57.446582],[-135.564209,57.666406],[-134.931494,57.481152],[-135.338477,57.768652],[-134.954688,58.015332],[-135.613232,57.991846],[-135.730371,58.244238]]],[[[-133.566113,56.339209],[-133.742529,55.964844],[-133.241504,55.920801],[-133.680176,55.785156],[-133.033398,55.589697],[-133.118555,55.327637],[-132.064746,54.713135],[-131.976416,55.208594],[-132.631299,55.473193],[-132.172705,55.480615],[-133.566113,56.339209]]],[[[-133.9896,56.844971],[-134.373682,56.838672],[-134.1896,56.076953],[-133.738379,56.650439],[-133.9896,56.844971]]],[[[-152.416943,58.360205],[-152.841113,58.416406],[-153.381348,58.087207],[-152.068896,58.17793],[-152.416943,58.360205]]],[[[-167.964355,53.345117],[-167.828076,53.507959],[-168.287695,53.500146],[-169.088916,52.832031],[-167.964355,53.345117]]],[[[-166.615332,53.900928],[-167.038086,53.942188],[-166.808984,53.646143],[-167.780859,53.300244],[-166.354541,53.673535],[-166.230859,53.932617],[-166.615332,53.900928]]],[[[-173.55332,52.136279],[-173.99248,52.12334],[-173.0229,52.07915],[-173.55332,52.136279]]],[[[-174.677393,52.03501],[-174.045605,52.367236],[-175.295557,52.022168],[-174.677393,52.03501]]],[[[-176.593311,51.866699],[-176.961621,51.603662],[-176.452344,51.735693],[-176.593311,51.866699]]],[[[-177.879053,51.649707],[-177.644482,51.82627],[-178.168262,51.903027],[-177.879053,51.649707]]],[[[172.811816,53.012988],[172.494824,52.937891],[172.935156,52.7521],[173.436035,52.852051],[172.811816,53.012988]]],[[[-155.581348,19.012012],[-154.804199,19.524463],[-155.831641,20.27583],[-156.048682,19.749951],[-155.881299,19.070508],[-155.581348,19.012012]]],[[[-156.486816,20.932568],[-156.697754,20.949072],[-156.408789,20.605176],[-155.989844,20.757129],[-156.486816,20.932568]]],[[[-157.799365,21.456641],[-157.9625,21.701367],[-158.273145,21.585254],[-158.110352,21.318604],[-157.6354,21.307617],[-157.799365,21.456641]]],[[[-159.372754,21.932373],[-159.352051,22.21958],[-159.78916,22.041797],[-159.372754,21.932373]]],[[[-74.708887,45.003857],[-76.151172,44.303955],[-76.819971,43.628809],[-78.72041,43.624951],[-79.171875,43.466553],[-79.036719,42.802344],[-82.690039,41.675195],[-83.149658,42.141943],[-82.545312,42.624707],[-82.137842,43.570898],[-82.551074,45.347363],[-83.592676,45.817139],[-83.615967,46.116846],[-83.977783,46.084912],[-84.149463,46.542773],[-84.561768,46.457373],[-84.875977,46.899902],[-88.378174,48.303076],[-89.455664,47.99624],[-90.916064,48.209131],[-91.518311,48.058301],[-92.99624,48.611816],[-94.620898,48.742627],[-95.155273,49.369678],[-95.162061,48.991748],[-97.529834,48.993164],[-106.483838,48.993115],[-114.585107,48.993066],[-122.78877,48.993018],[-122.241992,48.010742],[-122.353809,47.371582],[-122.701953,47.110889],[-123.027588,47.138916],[-122.577881,47.293164],[-122.532812,47.919727],[-123.139062,47.386084],[-122.656641,47.881152],[-122.778613,48.137598],[-124.709961,48.380371],[-124.139258,46.954688],[-123.842871,46.963184],[-124.112549,46.862695],[-124.072754,46.279443],[-123.220605,46.153613],[-123.989307,46.219385],[-124.14873,43.691748],[-124.539648,42.812891],[-124.071924,41.459521],[-124.324023,40.251953],[-122.998779,37.988623],[-122.521338,37.826416],[-122.393359,38.144824],[-121.525342,38.055908],[-122.314258,38.007324],[-122.070508,37.478271],[-122.445605,37.797998],[-122.499219,37.542627],[-121.807422,36.851221],[-121.877393,36.331055],[-120.659082,35.122412],[-120.644678,34.57998],[-118.506201,34.017383],[-118.410449,33.743945],[-117.467432,33.295508],[-117.128271,32.53335],[-114.724756,32.715332],[-114.835938,32.508301],[-111.041992,31.324219],[-108.214453,31.329443],[-108.211816,31.779346],[-106.44541,31.768408],[-104.978809,30.645947],[-104.110596,29.386133],[-103.168311,28.998193],[-102.614941,29.752344],[-101.440381,29.776855],[-99.505322,27.54834],[-99.107764,26.446924],[-97.14624,25.961475],[-97.485107,27.237402],[-97.768457,27.45752],[-97.439111,27.328271],[-97.156494,28.144336],[-96.421094,28.457324],[-96.640039,28.708789],[-96.011035,28.631934],[-96.234521,28.488965],[-95.273486,28.963867],[-94.888281,29.370557],[-95.022852,29.702344],[-94.52627,29.547949],[-94.759619,29.384277],[-93.890479,29.689355],[-93.841455,29.979736],[-93.826465,29.725146],[-92.26084,29.556836],[-91.893164,29.836035],[-91.248828,29.564209],[-91.290137,29.288965],[-90.751025,29.130859],[-90.379199,29.295117],[-90.212793,29.104932],[-90.159082,29.537158],[-89.376123,28.981348],[-89.015723,29.202881],[-89.720898,29.619287],[-89.354443,29.820215],[-89.400732,30.046045],[-90.175342,30.029102],[-90.331982,30.277588],[-88.135449,30.366602],[-88.011328,30.694189],[-87.790283,30.291797],[-88.005957,30.230908],[-87.281055,30.339258],[-86.997559,30.570312],[-87.201172,30.339258],[-86.257373,30.493018],[-86.454443,30.399121],[-85.603516,30.286768],[-85.318945,29.680225],[-84.309668,30.064746],[-83.694385,29.925977],[-82.651465,28.8875],[-82.843506,27.845996],[-82.405762,27.862891],[-82.7146,27.499609],[-82.441357,27.059668],[-82.242871,26.848877],[-82.013281,26.961572],[-81.715479,25.983154],[-80.94043,25.264209],[-81.110498,25.138037],[-80.484668,25.229834],[-80.126367,25.833496],[-80.050049,26.807715],[-80.838184,28.757666],[-80.456885,27.900684],[-80.524121,28.486084],[-81.249512,29.793799],[-81.516211,30.801807],[-81.380957,31.353271],[-80.694238,32.215723],[-80.802539,32.448047],[-80.579346,32.287305],[-80.63418,32.511719],[-79.940723,32.667139],[-78.841455,33.724072],[-78.01333,33.911816],[-77.953271,34.168994],[-77.927832,33.939746],[-77.412256,34.730811],[-76.439795,34.84292],[-76.974951,35.025195],[-77.070264,35.154639],[-76.77915,34.990332],[-76.512939,35.27041],[-77.03999,35.527393],[-76.173828,35.35415],[-75.758838,35.843262],[-76.083594,35.690527],[-76.069775,35.970312],[-76.726221,35.957617],[-76.733643,36.22915],[-76.559375,36.015332],[-76.147852,36.279297],[-75.820068,36.112842],[-75.946484,36.659082],[-75.53418,35.819092],[-75.999414,36.912646],[-76.487842,36.897021],[-77.250879,37.329199],[-76.283301,37.052686],[-76.757715,37.50542],[-76.453906,37.273535],[-76.305566,37.571484],[-76.549463,37.669141],[-77.111084,38.165674],[-76.49248,37.682227],[-76.344141,37.675684],[-76.264258,37.893555],[-77.273242,38.351758],[-77.2604,38.6],[-77.030371,38.889258],[-77.23252,38.407715],[-76.341162,38.087012],[-76.668555,38.5375],[-76.394092,38.368994],[-76.57041,39.269336],[-75.958936,39.585059],[-76.341162,38.709668],[-76.016943,38.625098],[-76.264648,38.436426],[-75.858691,38.362061],[-75.659277,37.953955],[-75.934375,37.151904],[-75.03877,38.426367],[-75.187109,38.591113],[-75.088672,38.777539],[-75.392188,39.092773],[-75.587598,39.640771],[-75.07417,39.983496],[-75.524219,39.490186],[-74.897021,39.145459],[-74.954297,38.949951],[-74.794482,39.001904],[-74.0646,39.993115],[-74.079932,39.788135],[-73.972266,40.400342],[-74.264209,40.528613],[-73.969922,41.249707],[-73.987109,40.751367],[-72.924707,41.285156],[-71.522852,41.378955],[-71.390137,41.795312],[-71.168555,41.489404],[-69.948633,41.677148],[-69.977881,41.961279],[-70.108936,42.07832],[-70.001416,41.826172],[-70.42666,41.757275],[-71.046191,42.331104],[-70.612939,42.623242],[-70.733105,43.07002],[-70.178809,43.766357],[-69.226074,43.986475],[-68.762695,44.570752],[-68.53252,44.258643],[-68.450586,44.507617],[-68.056641,44.384326],[-67.19126,44.675586],[-67.124854,45.169434],[-67.802246,45.727539],[-67.806787,47.082812],[-68.235498,47.345947],[-68.937207,47.21123],[-69.242871,47.462988],[-70.865039,45.270703],[-71.327295,45.290088],[-71.517529,45.007568],[-74.708887,45.003857]],[[-122.572754,48.156641],[-122.628613,48.384229],[-122.383154,47.923193],[-122.572754,48.156641]]],[[[-72.509766,40.986035],[-72.274121,41.153027],[-73.573828,40.919629],[-74.014893,40.581201],[-71.903223,41.060693],[-72.509766,40.986035]]],[[[-80.381836,25.142285],[-80.25708,25.347607],[-80.580566,24.954248],[-80.381836,25.142285]]],[[[-84.90791,29.642627],[-84.737158,29.732422],[-85.116748,29.632812],[-84.90791,29.642627]]]]}},{type:"Feature",properties:{name:"南乔治亚和南桑威奇群岛",full_name:"南乔治亚和南桑威奇群岛（英国）",iso_a2:"GS",iso_a3:"SGS",iso_n3:"239"},geometry:{type:"Polygon",coordinates:[[[-37.10332,-54.065625],[-38.017432,-54.008008],[-36.085498,-54.866797],[-35.798584,-54.763477],[-36.326465,-54.251172],[-37.10332,-54.065625]]]}},{type:"Feature",properties:{name:"英属印度洋领地",full_name:"英属印度洋领地",iso_a2:"IO",iso_a3:"IOT",iso_n3:"086"},geometry:{type:"Polygon",coordinates:[[[72.491992,-7.377441],[72.445605,-7.22041],[72.447266,-7.395703],[72.349707,-7.263379],[72.429102,-7.435352],[72.491992,-7.377441]]]}},{type:"Feature",properties:{name:"圣赫勒拿",full_name:"圣赫勒拿岛（英国）",iso_a2:"SH",iso_a3:"SHN",iso_n3:"654"},geometry:{type:"Polygon",coordinates:[[[-5.692139,-15.997754],[-5.707861,-15.906152],[-5.78252,-16.004004],[-5.692139,-15.997754]]]}},{type:"Feature",properties:{name:"皮特凯恩群岛",full_name:"皮特凯恩群岛（英国）",iso_a2:"PN",iso_a3:"PCN",iso_n3:"612"},geometry:{type:"Polygon",coordinates:[[[-128.290088,-24.397363],[-128.330127,-24.323242],[-128.342188,-24.370703],[-128.290088,-24.397363]]]}},{type:"Feature",properties:{name:"安圭拉",full_name:"安圭拉",iso_a2:"AI",iso_a3:"AIA",iso_n3:"660"},geometry:{type:"Polygon",coordinates:[[[-63.001221,18.221777],[-63.026025,18.269727],[-63.16001,18.171387],[-63.001221,18.221777]]]}},{type:"Feature",properties:{name:"马尔维纳斯群岛（福克兰）",full_name:"马尔维纳斯群岛（福克兰）",iso_a2:"FK",iso_a3:"FLK",iso_n3:"238"},geometry:{type:"MultiPolygon",coordinates:[[[[-58.850195,-51.269922],[-59.570801,-51.925391],[-59.395654,-52.308008],[-59.19585,-52.017676],[-58.652783,-52.099219],[-57.791797,-51.636133],[-57.976514,-51.384375],[-58.271582,-51.574707],[-58.850195,-51.269922]]],[[[-60.28623,-51.461914],[-60.568457,-51.357812],[-60.245166,-51.638867],[-60.58252,-51.712695],[-60.238477,-51.771973],[-60.961426,-52.057324],[-60.686377,-52.188379],[-59.268066,-51.427539],[-60.28623,-51.461914]]]]}},{type:"Feature",properties:{name:"开曼群岛",full_name:"开曼群岛",iso_a2:"KY",iso_a3:"CYM",iso_n3:"136"},geometry:{type:"Polygon",coordinates:[[[-81.369531,19.348877],[-81.404785,19.278418],[-81.107129,19.305176],[-81.369531,19.348877]]]}},{type:"Feature",properties:{name:"百慕大",full_name:"百慕大",iso_a2:"BM",iso_a3:"BMU",iso_n3:"060"},geometry:{type:"Polygon",coordinates:[[[-64.730273,32.293457],[-64.668311,32.381934],[-64.862842,32.273877],[-64.730273,32.293457]]]}},{type:"Feature",properties:{name:"英属维尔京群岛",full_name:"英属维尔京群岛",iso_a2:"VG",iso_a3:"VGB",iso_n3:"092"},geometry:{type:"Polygon",coordinates:[[[-64.395215,18.4646],[-64.324658,18.51748],[-64.426074,18.513086],[-64.395215,18.4646]]]}},{type:"Feature",properties:{name:"特克斯和凯科斯群岛",full_name:"特克斯和凯科斯群岛",iso_a2:"TC",iso_a3:"TCA",iso_n3:"796"},geometry:{type:"Polygon",coordinates:[[[-71.661426,21.765234],[-71.668359,21.833447],[-71.847656,21.843457],[-71.661426,21.765234]]]}},{type:"Feature",properties:{name:"蒙特塞拉特",full_name:"蒙特塞拉特",iso_a2:"MS",iso_a3:"MSR",iso_n3:"500"},geometry:{type:"Polygon",coordinates:[[[-62.148438,16.740332],[-62.191357,16.804395],[-62.221631,16.699512],[-62.148438,16.740332]]]}},{type:"Feature",properties:{name:"泽西岛",full_name:"泽西岛",iso_a2:"JE",iso_a3:"JEY",iso_n3:"832"},geometry:{type:"Polygon",coordinates:[[[-2.018652,49.23125],[-2.220508,49.266357],[-2.23584,49.176367],[-2.018652,49.23125]]]}},{type:"Feature",properties:{name:"根西岛",full_name:"根西岛",iso_a2:"GG",iso_a3:"GGY",iso_n3:"831"},geometry:{type:"Polygon",coordinates:[[[-2.512305,49.494531],[-2.639014,49.450928],[-2.547363,49.428711],[-2.512305,49.494531]]]}},{type:"Feature",properties:{name:"马恩岛",full_name:"马恩岛",iso_a2:"IM",iso_a3:"IMN",iso_n3:"833"},geometry:{type:"Polygon",coordinates:[[[-4.412061,54.185352],[-4.424707,54.407178],[-4.785352,54.073047],[-4.412061,54.185352]]]}},{type:"Feature",properties:{name:"英国",full_name:"大不列颠及北爱尔兰联合王国",iso_a2:"GB",iso_a3:"GBR",iso_n3:"826"},geometry:{type:"MultiPolygon",coordinates:[[[[-2.667676,51.622998],[-2.433057,51.740723],[-3.135986,51.205029],[-4.188184,51.188525],[-5.622119,50.050684],[-4.19458,50.393311],[-3.679785,50.239941],[-2.999414,50.716602],[-2.03584,50.603076],[-1.416455,50.896875],[.205078,50.763037],[.960156,50.925879],[1.414941,51.363281],[.424512,51.465625],[1.274414,51.845361],[1.743359,52.578516],[1.271289,52.924561],[.045898,52.905615],[.270996,53.335498],[-.659912,53.724023],[.115332,53.609277],[-.084375,54.118066],[-1.232422,54.703711],[-1.655371,55.570361],[-2.599316,56.027295],[-3.789062,56.095215],[-2.674268,56.253418],[-3.309961,56.363477],[-2.592676,56.561572],[-1.77793,57.49375],[-2.074072,57.702393],[-4.134521,57.577734],[-3.053076,58.634814],[-4.924658,58.588379],[-5.413184,58.069727],[-5.157227,57.881348],[-5.744922,57.668311],[-5.561914,57.232715],[-5.730615,56.853076],[-6.132764,56.718018],[-5.652441,56.531982],[-5.188379,56.758057],[-5.768213,55.362646],[-4.996973,56.23335],[-5.228223,55.886328],[-4.800293,56.15835],[-4.584082,55.938672],[-5.135498,54.85752],[-4.91123,54.689453],[-3.03623,54.953076],[-3.592041,54.564355],[-3.165967,54.12793],[-2.867578,54.177246],[-3.0646,53.512842],[-2.749512,53.310205],[-4.268555,53.144531],[-4.683057,52.806152],[-4.101465,52.915479],[-4.149365,52.32627],[-5.262305,51.880176],[-3.562354,51.413818],[-2.667676,51.622998]]],[[[-4.196777,53.321436],[-4.567871,53.386475],[-4.373047,53.13418],[-4.196777,53.321436]]],[[[-1.308105,60.5375],[-1.66377,60.28252],[-1.299463,59.878662],[-1.308105,60.5375]]],[[[-3.057422,59.029639],[-3.310352,59.130811],[-2.793018,58.906934],[-3.057422,59.029639]]],[[[-5.777881,56.344336],[-6.286328,56.611865],[-6.313428,56.293652],[-5.777881,56.344336]]],[[[-6.198682,58.363281],[-7.085254,58.182178],[-6.983105,57.75],[-6.198682,58.363281]]],[[[-6.144727,57.50498],[-6.305957,57.671973],[-6.761133,57.442383],[-5.949072,57.045166],[-5.672461,57.252686],[-6.135547,57.314258],[-6.144727,57.50498]]],[[[-6.218018,54.088721],[-5.47041,54.500195],[-6.035791,55.144531],[-7.218652,55.091992],[-8.118262,54.414258],[-7.606543,54.143848],[-7.007715,54.406689],[-6.649805,54.058643],[-6.218018,54.088721]]]]}},{type:"Feature",properties:{name:"阿联酋",full_name:"阿拉伯联合酋长国",iso_a2:"AE",iso_a3:"ARE",iso_n3:"784"},geometry:{type:"Polygon",coordinates:[[[56.297852,25.650684],[56.080469,26.062646],[54.147949,24.171191],[52.118555,23.971094],[51.568359,24.286182],[52.555078,22.932812],[55.18584,22.704102],[55.468457,23.941113],[55.985156,24.063379],[55.76084,24.242676],[55.795703,24.868115],[56.000586,24.953223],[56.063867,24.73877],[56.387988,24.979199],[56.297852,25.650684]]]}},{type:"Feature",properties:{name:"乌克兰",full_name:"乌克兰",iso_a2:"UA",iso_a3:"UKR",iso_n3:"804"},geometry:{type:"Polygon",coordinates:[[[38.214355,47.091455],[38.368848,47.609961],[39.778711,47.887549],[39.95791,48.268896],[39.644727,48.591211],[40.003613,48.82207],[39.686523,49.00791],[40.108789,49.251562],[40.080664,49.576855],[38.258594,50.052344],[38.046875,49.92002],[37.422852,50.411475],[36.619434,50.209229],[35.591113,50.36875],[35.311914,51.043896],[34.213867,51.255371],[34.397852,51.78042],[33.735254,52.344775],[31.763379,52.101074],[30.755273,51.895166],[30.544531,51.265039],[30.160742,51.477881],[29.346484,51.382568],[29.102051,51.627539],[28.73125,51.433398],[27.7,51.477979],[27.141992,51.752051],[25.267188,51.937744],[23.605273,51.51792],[24.089941,50.530469],[22.706152,49.606201],[22.852051,49.062744],[22.538672,49.072705],[22.131836,48.405322],[22.87666,47.947266],[23.202637,48.084521],[24.979102,47.724121],[26.618945,48.259863],[27.549219,48.477734],[29.125391,47.964551],[29.134863,47.489697],[30.131055,46.423096],[28.958398,46.458496],[28.947754,46.049951],[28.2125,45.450439],[29.705859,45.259912],[29.628418,45.722461],[30.219043,45.866748],[30.796289,46.552002],[31.563379,46.777295],[31.872852,46.649756],[31.75918,47.212842],[32.044336,46.64248],[32.578027,46.615625],[31.554883,46.554297],[32.008496,46.42998],[31.83125,46.281689],[33.594141,46.09624],[33.806667,46.208288],[35.001674,45.733383],[34.849609,46.189893],[35.230371,46.440625],[35.014551,46.106006],[35.827148,46.624316],[38.214355,47.091455]]]}},{type:"Feature",properties:{name:"乌干达",full_name:"乌干达共和国",iso_a2:"UG",iso_a3:"UGA",iso_n3:"800"},geometry:{type:"Polygon",coordinates:[[[33.903223,-1.002051],[33.943164,.173779],[34.978223,1.773633],[34.437695,3.650586],[33.976074,4.220215],[33.489355,3.755078],[32.997266,3.880176],[32.135938,3.519727],[31.798047,3.802637],[31.152344,3.785596],[30.838574,3.490723],[30.728613,2.455371],[31.252734,2.04458],[29.942871,.819238],[29.576953,-1.387891],[29.930078,-1.469922],[30.509961,-1.067285],[33.903223,-1.002051]]]}},{type:"Feature",properties:{name:"土库曼斯坦",full_name:"土库曼斯坦",iso_a2:"TM",iso_a3:"TKM",iso_n3:"795"},geometry:{type:"Polygon",coordinates:[[[55.977441,41.322217],[55.434375,41.296289],[54.120996,42.335205],[53.055859,42.147754],[52.493848,41.780371],[52.850391,41.200293],[52.97002,41.976221],[53.804688,42.117627],[54.703711,41.071143],[54.377344,40.693262],[53.87002,40.648682],[52.943457,41.038086],[52.733691,40.39873],[53.035547,39.774414],[52.9875,39.987598],[53.487305,39.909375],[53.603125,39.546973],[53.235645,39.608545],[53.156641,39.26499],[53.70459,39.20957],[53.868652,38.949268],[53.91416,37.343555],[54.699414,37.470166],[55.380859,38.051123],[57.193555,38.216406],[58.261621,37.66582],[59.301758,37.510645],[60.341309,36.637646],[61.119629,36.642578],[61.262012,35.61958],[62.307813,35.170801],[62.688086,35.255322],[63.056641,35.445801],[63.12998,35.846191],[64.511035,36.340674],[64.816309,37.13208],[65.55498,37.251172],[65.765039,37.569141],[66.522266,37.348486],[66.60625,37.986719],[65.612891,38.238574],[63.763672,39.160547],[62.483203,39.975635],[61.902832,41.093701],[60.089648,41.399414],[59.985156,42.211719],[58.589063,42.778467],[58.151563,42.628076],[58.474414,42.299365],[58.028906,42.487646],[56.964063,41.856543],[57.017969,41.263477],[55.977441,41.322217]]]}},{type:"Feature",properties:{name:"土耳其",full_name:"土耳其共和国",iso_a2:"TR",iso_a3:"TUR",iso_n3:"792"},geometry:{type:"MultiPolygon",coordinates:[[[[41.510059,41.51748],[40.265234,40.961328],[39.426367,41.106445],[38.381055,40.924512],[36.405371,41.274609],[36.051758,41.682568],[35.297754,41.728516],[35.006445,42.063281],[33.381348,42.017578],[31.254883,41.107617],[29.148145,41.221045],[29.113867,40.937842],[29.849219,40.760107],[28.958008,40.630566],[29.007129,40.389746],[26.738086,40.400244],[26.181348,39.990088],[26.113086,39.467383],[26.899219,39.549658],[26.681836,39.292236],[27.013672,38.886865],[26.763672,38.709619],[27.144238,38.451953],[26.674219,38.335742],[26.441309,38.641211],[26.290723,38.277197],[27.232422,37.978662],[27.067969,37.65791],[27.535059,37.163867],[27.262988,36.976562],[28.242383,37.029053],[27.453906,36.712158],[28.969629,36.715332],[29.689062,36.156689],[30.446094,36.269873],[30.644043,36.865674],[31.240625,36.821729],[32.794824,36.035889],[33.694727,36.181982],[34.703613,36.816797],[35.393164,36.575195],[36.048926,36.910596],[35.892676,35.916553],[36.153613,35.833887],[36.636719,36.233984],[36.658594,36.802539],[37.436328,36.643311],[38.191699,36.901562],[39.356641,36.681592],[40.705664,37.097705],[42.202734,37.297266],[42.358984,37.108594],[42.774609,37.371875],[44.114453,37.301855],[44.281836,36.978027],[44.765137,37.142432],[44.589941,37.710352],[44.211328,37.908057],[44.449902,38.334229],[44.023242,39.377441],[44.389355,39.422119],[44.587109,39.768555],[44.817188,39.650439],[44.768262,39.703516],[43.666211,40.126367],[43.439453,41.107129],[42.754102,41.578906],[41.510059,41.51748]]],[[[28.014453,41.969043],[27.011719,42.058643],[26.320898,41.716553],[26.624902,41.401758],[26.038965,40.726758],[26.79209,40.626611],[26.202734,40.075391],[27.499414,40.973145],[28.95625,41.008203],[29.057227,41.229736],[28.197852,41.554492],[28.014453,41.969043]]]]}},{type:"Feature",properties:{name:"突尼斯",full_name:"突尼斯共和国",iso_a2:"TN",iso_a3:"TUN",iso_n3:"788"},geometry:{type:"Polygon",coordinates:[[[11.50459,33.181934],[10.049023,34.056299],[11.120117,35.240283],[10.476562,36.175146],[11.053906,37.07251],[10.412305,36.731836],[10.196387,37.205859],[9.830273,37.135352],[9.687988,37.340381],[8.576563,36.937207],[8.207617,36.518945],[8.245605,34.734082],[7.500195,33.832471],[8.333398,32.543604],[9.044043,32.072363],[9.51875,30.229395],[10.216406,30.783203],[10.274609,31.684961],[11.50498,32.413672],[11.50459,33.181934]]]}},{type:"Feature",properties:{name:"特立尼达和多巴哥",full_name:"特立尼达和多巴哥共和国",iso_a2:"TT",iso_a3:"TTO",iso_n3:"780"},geometry:{type:"Polygon",coordinates:[[[-61.012109,10.134326],[-60.917627,10.840234],[-61.651172,10.718066],[-61.499316,10.268555],[-61.906104,10.069141],[-61.012109,10.134326]]]}},{type:"Feature",properties:{name:"汤加",full_name:"汤加王国",iso_a2:"TO",iso_a3:"TON",iso_n3:"776"},geometry:{type:"Polygon",coordinates:[[[-175.161914,-21.169336],[-175.362354,-21.106836],[-175.156592,-21.263672],[-175.161914,-21.169336]]]}},{type:"Feature",properties:{name:"多哥",full_name:"多哥共和国",iso_a2:"TG",iso_a3:"TGO",iso_n3:"768"},geometry:{type:"Polygon",coordinates:[[[.900488,10.993262],[-.068604,11.115625],[-.086328,10.673047],[.380859,10.291846],[.233398,9.463525],[.525684,9.398486],[.372559,8.759277],[.686328,8.354883],[.525586,6.850928],[1.187207,6.089404],[1.622656,6.216797],[1.77793,6.294629],[1.530957,6.992432],[1.600195,9.050049],[1.330078,9.996973],[.763379,10.38667],[.900488,10.993262]]]}},{type:"Feature",properties:{name:"东帝汶",full_name:"东帝汶民主共和国",iso_a2:"TL",iso_a3:"TLS",iso_n3:"626"},geometry:{type:"MultiPolygon",coordinates:[[[[125.068164,-9.511914],[127.296094,-8.424512],[125.381836,-8.575391],[124.922266,-8.94248],[125.149023,-9.042578],[124.960156,-9.21377],[125.068164,-9.511914]]],[[[124.036328,-9.341602],[124.282324,-9.42793],[124.444434,-9.190332],[124.036328,-9.341602]]]]}},{type:"Feature",properties:{name:"泰国",full_name:"泰王国",iso_a2:"TH",iso_a3:"THA",iso_n3:"764"},geometry:{type:"MultiPolygon",coordinates:[[[[98.409082,7.902051],[98.32207,8.166309],[98.296289,7.776074],[98.409082,7.902051]]],[[[100.122461,20.31665],[99.458887,20.363037],[99.485938,20.149854],[99.074219,20.099365],[98.916699,19.7729],[98.015039,19.749512],[97.745898,18.588184],[97.373926,18.517969],[98.660742,16.33042],[98.888281,16.351904],[98.202148,14.975928],[99.136816,13.716699],[99.123926,13.030762],[99.614746,11.781201],[98.757227,10.660937],[98.702539,10.190381],[98.241797,8.767871],[98.305469,8.226221],[98.703516,8.256738],[100.119141,6.441992],[100.261426,6.682715],[101.053516,6.242578],[101.113965,5.636768],[101.556055,5.907764],[101.873633,5.825293],[102.101074,6.242236],[101.497949,6.865283],[100.423535,7.187842],[100.160742,7.599268],[100.256641,7.774902],[100.545215,7.226904],[100.279395,8.268506],[99.835547,9.288379],[99.253906,9.265234],[99.165039,10.319824],[99.989062,12.170801],[99.990527,13.243457],[100.235645,13.484473],[100.962695,13.431982],[100.897754,12.653809],[101.835742,12.640381],[102.594141,12.203027],[102.933887,11.706689],[102.336328,13.560303],[103.199414,14.332617],[105.183301,14.34624],[105.497363,14.590674],[105.641016,15.656543],[104.819336,16.466064],[104.739648,17.46167],[103.949609,18.318994],[103.366992,18.42334],[102.680078,17.824121],[102.101465,18.210645],[100.955859,17.541113],[101.211914,19.54834],[100.513574,19.553467],[100.519531,20.17793],[100.122461,20.31665]]]]}},{type:"Feature",properties:{name:"坦桑尼亚",full_name:"坦桑尼亚联合共和国",iso_a2:"TZ",iso_a3:"TZA",iso_n3:"834"},geometry:{type:"MultiPolygon",coordinates:[[[[39.496484,-6.174609],[39.308984,-5.721973],[39.182324,-6.172559],[39.480957,-6.453711],[39.496484,-6.174609]]],[[[39.865039,-4.906152],[39.673438,-4.927051],[39.749316,-5.443848],[39.865039,-4.906152]]],[[[32.919922,-9.407422],[33.888867,-9.670117],[33.995605,-9.49541],[34.320898,-9.731543],[34.60791,-11.080469],[34.959473,-11.578125],[35.911328,-11.454688],[36.305664,-11.706348],[37.372852,-11.710449],[37.920215,-11.294727],[38.491797,-11.413281],[40.463574,-10.464355],[39.725195,-10.000488],[39.304004,-8.443848],[39.288477,-7.517871],[39.546094,-7.024023],[38.804688,-6.070117],[39.221777,-4.692383],[37.608203,-3.49707],[37.643848,-3.04541],[33.903223,-1.002051],[30.509961,-1.067285],[30.876562,-2.143359],[30.553613,-2.400098],[30.433496,-2.874512],[30.780273,-2.984863],[30.790234,-3.274609],[29.947266,-4.307324],[29.403223,-4.449316],[29.54082,-6.313867],[30.212695,-7.037891],[30.751172,-8.193652],[31.033398,-8.597656],[32.919922,-9.407422]]]]}},{type:"Feature",properties:{name:"塔吉克斯坦",full_name:"塔吉克斯坦共和国",iso_a2:"TJ",iso_a3:"TJK",iso_n3:"762"},geometry:{type:"Polygon",coordinates:[[[67.758984,37.172217],[68.067773,36.949805],[68.911816,37.333936],[69.303906,37.116943],[69.49209,37.553076],[70.188672,37.582471],[70.214648,37.924414],[70.878906,38.456396],[71.255859,38.306982],[71.278516,37.918408],[71.582227,37.910107],[71.43291,37.127539],[71.665625,36.696924],[73.38291,37.462256],[73.720605,37.41875],[73.653516,37.239355],[74.349023,37.41875],[74.891309,37.231641],[75.11875,37.385693],[74.812305,38.460303],[73.80166,38.606885],[73.631641,39.448877],[72.22998,39.20752],[71.470312,39.603662],[70.799316,39.394727],[70.501172,39.587354],[69.297656,39.524805],[69.530273,40.097314],[69.966797,40.202246],[70.515137,39.949902],[70.958008,40.238867],[70.371582,40.384131],[70.751074,40.721777],[70.401953,41.035107],[69.712891,40.656982],[69.357227,40.767383],[69.274902,40.198096],[68.630664,40.16709],[68.97207,40.089941],[68.463281,39.536719],[67.426172,39.465576],[67.357617,39.216699],[68.13252,38.927637],[68.350293,38.211035],[67.758984,37.172217]]]}},{type:"Feature",properties:{name:"叙利亚",full_name:"阿拉伯叙利亚共和国",iso_a2:"SY",iso_a3:"SYR",iso_n3:"760"},geometry:{type:"Polygon",coordinates:[[[35.892676,35.916553],[35.97627,34.629199],[36.383887,34.65791],[36.584961,34.22124],[35.869141,33.431738],[35.816125,33.361879],[35.787305,32.734912],[36.818359,32.317285],[38.773535,33.372217],[40.987012,34.429053],[41.295996,36.38335],[42.358984,37.108594],[42.202734,37.297266],[40.705664,37.097705],[39.356641,36.681592],[38.191699,36.901562],[37.436328,36.643311],[36.658594,36.802539],[36.636719,36.233984],[36.153613,35.833887],[35.892676,35.916553]]]}},{type:"Feature",properties:{name:"瑞士",full_name:"瑞士联邦",iso_a2:"CH",iso_a3:"CHE",iso_n3:"756"},geometry:{type:"Polygon",coordinates:[[[9.524023,47.524219],[8.572656,47.775635],[8.454004,47.596191],[7.615625,47.592725],[6.968359,47.453223],[5.97002,46.214697],[6.758105,46.415771],[7.021094,45.925781],[7.787891,45.921826],[8.422559,46.446045],[9.02373,45.845703],[9.260156,46.475195],[10.12832,46.238232],[10.452832,46.864941],[9.580273,47.057373],[9.487695,47.062256],[9.527539,47.270752],[9.524023,47.524219]]]}},{type:"Feature",properties:{name:"瑞典",full_name:"瑞典",iso_a2:"SE",iso_a3:"SWE",iso_n3:"752"},geometry:{type:"MultiPolygon",coordinates:[[[[19.076465,57.835938],[18.136523,57.556641],[18.146387,56.920508],[19.076465,57.835938]]],[[[11.388281,59.036523],[11.248242,58.369141],[12.883691,56.617725],[12.80166,56.263916],[12.471191,56.290527],[12.88584,55.411377],[14.17373,55.396631],[14.401953,55.976758],[15.82666,56.124951],[16.34873,56.709277],[16.923828,58.492578],[16.214258,58.63667],[18.285352,59.109375],[18.560254,59.394482],[17.964258,59.359375],[18.970508,59.757227],[17.955762,60.589795],[17.250977,60.700781],[17.410254,62.508398],[20.762695,63.867822],[21.519629,64.463086],[21.410352,65.317432],[22.400977,65.862109],[24.155469,65.805273],[23.638867,67.954395],[20.622168,69.036865],[20.116699,69.020898],[19.969824,68.356396],[18.303027,68.55542],[17.916699,67.964893],[17.324609,68.103809],[16.783594,67.89502],[15.483789,66.305957],[14.543262,66.129346],[14.479688,65.301465],[13.650293,64.581543],[14.141211,64.173535],[12.792773,64],[12.175195,63.595947],[12.155371,61.720752],[12.880762,61.352295],[12.294141,61.002686],[12.486133,60.106787],[11.680762,59.592285],[11.642773,58.926074],[11.388281,59.036523]]]]}},{type:"Feature",properties:{name:"斯威士兰",full_name:"斯威士兰王国",iso_a2:"SZ",iso_a3:"SWZ",iso_n3:"748"},geometry:{type:"Polygon",coordinates:[[[31.948242,-25.957617],[31.207324,-25.843359],[30.794336,-26.764258],[31.469531,-27.295508],[31.958398,-27.305859],[32.112891,-26.839453],[31.948242,-25.957617]]]}},{type:"Feature",properties:{name:"苏里南",full_name:"苏里南共和国",iso_a2:"SR",iso_a3:"SUR",iso_n3:"740"},geometry:{type:"Polygon",coordinates:[[[-54.155957,5.358984],[-54.054199,5.80791],[-54.833691,5.98833],[-55.828174,5.96167],[-55.897607,5.699316],[-56.969824,5.992871],[-57.194775,5.548438],[-57.331006,5.020166],[-57.917041,4.82041],[-58.054297,4.10166],[-57.646729,3.394531],[-57.303662,3.3771],[-57.197363,2.853271],[-56.482812,1.942139],[-55.929639,1.8875],[-56.137695,2.259033],[-55.957471,2.520459],[-54.978662,2.597656],[-54.61626,2.326758],[-54.00957,3.448535],[-54.479688,4.836523],[-54.155957,5.358984]]]}},{type:"Feature",properties:{name:"南苏丹",full_name:"南苏丹共和国",iso_a2:"SS",iso_a3:"SSD",iso_n3:"728"},geometry:{type:"Polygon",coordinates:[[[33.976074,4.220215],[35.268359,5.492285],[34.710645,6.660303],[33.902441,7.509521],[32.998926,7.899512],[33.281055,8.437256],[34.072754,8.545264],[34.078125,9.461523],[33.871484,9.506152],[33.907031,10.181445],[33.130078,10.745947],[33.199316,12.217285],[32.721875,12.223096],[32.736719,12.009668],[32.072266,12.006738],[32.420801,11.089111],[31.224902,9.799268],[30.755371,9.731201],[30.003027,10.277393],[28.844531,9.326074],[28.048926,9.328613],[27.880859,9.601611],[26.658691,9.484131],[25.858203,10.406494],[25.211719,10.329932],[24.531934,8.886914],[24.147363,8.665625],[24.291406,8.291406],[24.85332,8.137549],[25.278906,7.42749],[26.361816,6.635303],[26.514258,6.069238],[27.143945,5.722949],[27.40332,5.10918],[28.19209,4.350244],[29.676855,4.586914],[30.838574,3.490723],[31.152344,3.785596],[31.798047,3.802637],[32.135938,3.519727],[32.997266,3.880176],[33.489355,3.755078],[33.976074,4.220215]]]}},{type:"Feature",properties:{name:"苏丹",full_name:"苏丹共和国",iso_a2:"SD",iso_a3:"SDN",iso_n3:"729"},geometry:{type:"Polygon",coordinates:[[[34.078125,9.461523],[34.343945,10.658643],[34.931445,10.864795],[35.112305,11.816553],[35.670215,12.62373],[36.125195,12.757031],[36.524316,14.256836],[36.426758,15.13208],[37.008984,17.058887],[37.411035,17.061719],[38.609473,18.005078],[37.471289,18.820117],[37.258594,21.108545],[36.871387,21.996729],[31.434473,21.99585],[31.400293,22.202441],[31.092676,21.994873],[24.980273,21.99585],[24.979492,20.002588],[23.980273,19.995947],[23.980273,19.496631],[23.970801,15.721533],[22.933887,15.533105],[22.932324,15.162109],[22.381543,14.550488],[22.538574,14.161865],[22.106445,13.799805],[22.228125,13.32959],[21.825293,12.790527],[22.352344,12.660449],[22.591113,11.579883],[22.922656,11.344873],[22.860059,10.919678],[23.646289,9.8229],[23.537305,8.81582],[24.147363,8.665625],[24.531934,8.886914],[25.211719,10.329932],[25.858203,10.406494],[26.658691,9.484131],[27.880859,9.601611],[28.048926,9.328613],[28.844531,9.326074],[30.003027,10.277393],[30.755371,9.731201],[31.224902,9.799268],[32.420801,11.089111],[32.072266,12.006738],[32.736719,12.009668],[32.721875,12.223096],[33.199316,12.217285],[33.130078,10.745947],[33.907031,10.181445],[33.871484,9.506152],[34.078125,9.461523]]]}},{type:"Feature",properties:{name:"斯里兰卡",full_name:"斯里兰卡民主社会主义共和国",iso_a2:"LK",iso_a3:"LKA",iso_n3:"144"},geometry:{type:"Polygon",coordinates:[[[79.982324,9.812695],[80.42832,9.480957],[80.086328,9.577832],[79.783496,8.018457],[79.712988,8.182324],[79.859375,6.829297],[80.095313,6.153174],[80.724121,5.979053],[81.637402,6.425146],[81.874121,7.28833],[80.711133,9.366357],[79.982324,9.812695]]]}},{type:"Feature",properties:{name:"西班牙",full_name:"西班牙王国",iso_a2:"ES",iso_a3:"ESP",iso_n3:"724"},geometry:{type:"MultiPolygon",coordinates:[[[[3.145313,39.790088],[3.158691,39.970508],[2.37002,39.57207],[3.072852,39.30127],[3.461816,39.697754],[3.145313,39.790088]]],[[[1.445215,38.918701],[1.564453,39.121045],[1.22334,38.903857],[1.445215,38.918701]]],[[[-1.794043,43.407324],[-4.523047,43.415723],[-8.004687,43.694385],[-9.178076,43.174023],[-8.777148,41.941064],[-8.266064,42.137402],[-8.15249,41.811963],[-6.618262,41.942383],[-6.2125,41.532031],[-6.928467,41.009131],[-6.975391,39.798389],[-7.535693,39.661572],[-6.997949,39.056445],[-7.343018,38.457422],[-6.957568,38.187891],[-7.443945,37.728271],[-7.406152,37.179443],[-6.86377,37.278906],[-6.216797,36.913574],[-6.384131,36.637012],[-5.625488,36.025928],[-4.366846,36.718115],[-2.111523,36.77666],[-1.640967,37.386963],[-.721582,37.631055],[-.520801,38.317285],[.201563,38.75918],[-.327002,39.519873],[.891113,40.722363],[.714648,40.822852],[3.004883,41.767432],[3.211426,42.431152],[1.706055,42.50332],[1.448828,42.437451],[1.42832,42.595898],[.696875,42.845117],[.631641,42.6896],[-.586426,42.798975],[-1.46084,43.051758],[-1.794043,43.407324]]],[[[-16.334473,28.379932],[-16.123633,28.575977],[-16.905322,28.3396],[-16.658008,28.007178],[-16.334473,28.379932]]],[[[-14.196777,28.169287],[-13.928027,28.253467],[-13.857227,28.738037],[-14.491797,28.100928],[-14.196777,28.169287]]],[[[-15.400586,28.147363],[-15.682764,28.154053],[-15.710303,27.784082],[-15.436768,27.810693],[-15.400586,28.147363]]]]}},{type:"Feature",properties:{name:"韩国",full_name:"大韩民国",iso_a2:"KR",iso_a3:"KOR",iso_n3:"410"},geometry:{type:"MultiPolygon",coordinates:[[[[126.633887,37.781836],[126.976855,36.939404],[126.487012,37.007471],[126.160547,36.771924],[126.487695,36.693799],[126.753027,35.871973],[126.291113,35.15415],[126.593359,34.824365],[126.264453,34.673242],[126.531445,34.314258],[127.24707,34.755127],[127.324609,34.463281],[127.714844,34.954688],[128.443945,34.870361],[128.510938,35.100977],[129.076758,35.122705],[129.419141,35.497852],[129.418262,37.059033],[128.374609,38.623438],[128.038965,38.308545],[127.090332,38.283887],[126.633887,37.781836]]],[[[128.741016,34.798535],[128.667969,35.008789],[128.489258,34.865283],[128.741016,34.798535]]],[[[126.326953,33.223633],[126.901172,33.515137],[126.337695,33.4604],[126.326953,33.223633]]]]}},{type:"Feature",properties:{name:"南非",full_name:"南非共和国",iso_a2:"ZA",iso_a3:"ZAF",iso_n3:"710"},geometry:{type:"Polygon",coordinates:[[[29.364844,-22.193945],[28.210156,-22.693652],[27.085547,-23.57793],[26.835059,-24.24082],[25.912109,-24.747461],[25.443652,-25.714453],[24.748145,-25.817383],[23.05752,-25.312305],[22.597656,-26.132715],[21.646289,-26.854199],[20.685059,-26.822461],[20.793164,-25.915625],[19.980469,-24.776758],[19.980469,-28.45127],[19.161719,-28.93877],[18.102734,-28.87168],[17.447949,-28.698145],[17.05625,-28.031055],[16.447559,-28.617578],[18.21084,-31.74248],[18.325293,-32.50498],[17.851074,-32.827441],[18.433008,-33.717285],[18.410352,-34.295605],[18.752148,-34.082617],[18.831348,-34.364062],[20.020605,-34.785742],[20.529883,-34.463086],[21.788965,-34.372656],[22.553809,-34.010059],[25.574219,-34.035352],[25.805859,-33.737109],[26.613672,-33.707422],[27.860645,-33.053906],[29.971191,-31.32207],[31.335156,-29.378125],[32.285742,-28.621484],[32.886133,-26.849316],[32.112891,-26.839453],[31.958398,-27.305859],[31.469531,-27.295508],[30.794336,-26.764258],[31.207324,-25.843359],[31.948242,-25.957617],[31.98584,-24.460645],[31.287891,-22.402051],[29.364844,-22.193945]],[[28.736914,-30.101953],[28.39209,-30.147559],[28.056836,-30.631055],[27.753125,-30.6],[27.056934,-29.625586],[27.735547,-28.940039],[28.625781,-28.581738],[29.390723,-29.269727],[29.098047,-29.919043],[28.736914,-30.101953]]]}},{type:"Feature",properties:{name:"索马里",full_name:"索马里联邦共和国",iso_a2:"SO",iso_a3:"SOM",iso_n3:"706"},geometry:{type:"Polygon",coordinates:[[[41.532715,-1.695312],[43.717578,.857861],[46.878809,3.285645],[47.975293,4.497021],[49.049316,6.173633],[49.852051,7.962549],[50.825,9.428174],[50.930078,10.335547],[51.390234,10.422607],[51.031836,10.444775],[51.254883,11.830713],[50.792285,11.983691],[50.110059,11.529297],[48.938574,11.258447],[48.938086,9.451758],[47.978223,7.99707],[44.940527,4.912012],[43.583496,4.85498],[41.883984,3.977734],[40.964453,2.814648],[40.978711,-.870313],[41.532715,-1.695312]]]}},{type:"Feature",properties:{name:"索马里兰",full_name:"索马里兰",iso_a2:"-99",iso_a3:"-99",iso_n3:"-99"},geometry:{type:"Polygon",coordinates:[[[48.938574,11.258447],[47.40498,11.174023],[46.565039,10.745996],[45.816699,10.835889],[44.386523,10.430225],[43.245996,11.499805],[42.922754,10.999316],[42.656445,10.6],[42.841602,10.203076],[43.983789,9.008838],[46.978223,7.99707],[47.978223,7.99707],[48.938086,9.451758],[48.938574,11.258447]]]}},{type:"Feature",properties:{name:"所罗门群岛",full_name:"所罗门群岛",iso_a2:"SB",iso_a3:"SLB",iso_n3:"090"},geometry:{type:"MultiPolygon",coordinates:[[[[157.763477,-8.242188],[157.490625,-7.965723],[157.217578,-8.262793],[157.558008,-8.269922],[157.819336,-8.612012],[157.763477,-8.242188]]],[[[157.388965,-8.713477],[157.379492,-8.420898],[157.212305,-8.565039],[157.388965,-8.713477]]],[[[156.687891,-7.923047],[156.809082,-7.722852],[156.560938,-7.574023],[156.687891,-7.923047]]],[[[159.750391,-9.272656],[159.612305,-9.470703],[159.802734,-9.763477],[160.818945,-9.862793],[160.35459,-9.421582],[159.750391,-9.272656]]],[[[159.879102,-8.534277],[159.431445,-8.029004],[158.457422,-7.544727],[159.879102,-8.534277]]],[[[157.486719,-7.330371],[156.452539,-6.638281],[157.101562,-7.323633],[157.486719,-7.330371]]],[[[160.749414,-8.313965],[160.59043,-8.372754],[160.77207,-8.963867],[161.367383,-9.61123],[160.749414,-8.313965]]],[[[161.715332,-10.387305],[161.304785,-10.204395],[161.786816,-10.716895],[162.37334,-10.823242],[162.105371,-10.453809],[161.715332,-10.387305]]]]}},{type:"Feature",properties:{name:"斯洛伐克",full_name:"斯洛伐克共和国",iso_a2:"SK",iso_a3:"SVK",iso_n3:"703"},geometry:{type:"Polygon",coordinates:[[[22.538672,49.072705],[21.639648,49.411963],[20.362988,49.385254],[20.057617,49.181299],[19.441602,49.597705],[19.149414,49.4],[18.832227,49.510791],[16.953125,48.598828],[17.147363,48.005957],[17.761914,47.770166],[18.724219,47.787158],[18.791895,48.000293],[19.950391,48.146631],[20.490039,48.526904],[22.131836,48.405322],[22.538672,49.072705]]]}},{type:"Feature",properties:{name:"斯洛文尼亚",full_name:"斯洛文尼亚共和国",iso_a2:"SI",iso_a3:"SVN",iso_n3:"705"},geometry:{type:"Polygon",coordinates:[[[16.516211,46.499902],[16.093066,46.863281],[14.549805,46.399707],[13.7,46.520264],[13.378223,46.261621],[13.719824,45.587598],[13.57793,45.516895],[14.568848,45.657227],[15.339453,45.467041],[15.635938,46.200732],[16.516211,46.499902]]]}},{type:"Feature",properties:{name:"新加坡",full_name:"新加坡共和国",iso_a2:"SG",iso_a3:"SGP",iso_n3:"702"},geometry:{type:"Polygon",coordinates:[[[103.969727,1.331445],[103.817969,1.44707],[103.650195,1.325537],[103.969727,1.331445]]]}},{type:"Feature",properties:{name:"塞拉利昂",full_name:"塞拉利昂共和国",iso_a2:"SL",iso_a3:"SLE",iso_n3:"694"},geometry:{type:"MultiPolygon",coordinates:[[[[-10.283203,8.485156],[-10.712109,8.335254],[-10.500537,8.687549],[-10.690527,9.314258],[-11.273633,9.996533],[-12.427979,9.898145],[-13.292676,9.049219],[-13.059473,8.881152],[-13.181836,8.576904],[-12.894092,8.629785],[-13.272754,8.429736],[-12.850879,7.818701],[-12.480273,7.753271],[-12.485645,7.386279],[-11.50752,6.906543],[-10.647461,7.759375],[-10.283203,8.485156]]],[[[-12.526074,7.436328],[-12.615234,7.637207],[-12.951611,7.57085],[-12.526074,7.436328]]]]}},{type:"Feature",properties:{name:"塞舌尔",full_name:"塞舌尔共和国",iso_a2:"SC",iso_a3:"SYC",iso_n3:"690"},geometry:{type:"Polygon",coordinates:[[[55.540332,-4.693066],[55.383398,-4.609277],[55.542969,-4.785547],[55.540332,-4.693066]]]}},{type:"Feature",properties:{name:"塞尔维亚",full_name:"塞尔维亚共和国",iso_a2:"RS",iso_a3:"SRB",iso_n3:"688"},geometry:{type:"Polygon",coordinates:[[[22.705078,44.237793],[22.64209,44.650977],[22.093066,44.541943],[21.360059,44.82666],[21.490234,45.1479],[20.241797,46.108594],[18.905371,45.931738],[19.004688,45.399512],[19.4,45.2125],[19.007129,44.869189],[19.348633,44.880908],[19.118457,44.359961],[19.583789,44.043457],[19.24502,43.965039],[19.495117,43.642871],[19.194336,43.533301],[20.344336,42.82793],[20.063965,42.547266],[20.566211,41.873682],[21.5625,42.24751],[22.344043,42.313965],[22.466797,42.84248],[22.967969,43.142041],[22.369629,43.781299],[22.705078,44.237793]]]}},{type:"Feature",properties:{name:"塞内加尔",full_name:"塞内加尔共和国",iso_a2:"SN",iso_a3:"SEN",iso_n3:"686"},geometry:{type:"Polygon",coordinates:[[[-12.280615,14.809033],[-13.409668,16.05918],[-14.53374,16.655957],[-16.239014,16.531299],[-16.535254,15.838379],[-17.147168,14.922021],[-17.535645,14.755127],[-16.618115,14.040527],[-16.766943,13.904932],[-16.562305,13.587305],[-15.509668,13.58623],[-15.10835,13.812109],[-13.826709,13.407812],[-14.246777,13.23584],[-15.151123,13.556494],[-15.834277,13.156445],[-16.76333,13.06416],[-16.743896,12.585449],[-16.442871,12.609473],[-16.760303,12.525781],[-16.711816,12.354834],[-15.196094,12.679932],[-13.729248,12.673926],[-12.399072,12.340088],[-11.389404,12.404395],[-11.390381,12.941992],[-12.054199,13.633057],[-12.280615,14.809033]]]}},{type:"Feature",properties:{name:"沙特阿拉伯",full_name:"沙特阿拉伯王国",iso_a2:"SA",iso_a3:"SAU",iso_n3:"682"},geometry:{type:"MultiPolygon",coordinates:[[[[41.987695,16.715625],[41.860449,17.002539],[41.801563,16.77876],[42.157812,16.570703],[41.987695,16.715625]]],[[[51.977637,18.996143],[54.977344,19.995947],[55.641016,22.001855],[55.18584,22.704102],[52.555078,22.932812],[51.568359,24.286182],[51.267969,24.607227],[50.804395,24.789258],[50.081055,25.961377],[50.149805,26.662646],[48.797168,27.724316],[48.44248,28.54292],[47.671289,28.533154],[47.433203,28.989551],[46.531445,29.09624],[44.69082,29.202344],[42.074414,31.080371],[40.369336,31.938965],[39.14541,32.124512],[36.958594,31.491504],[37.980078,30.5],[37.469238,29.995068],[36.755273,29.866016],[36.068457,29.200537],[34.950781,29.353516],[34.625,28.064502],[35.180469,28.034863],[37.148828,25.291113],[37.543066,24.29165],[38.46416,23.711865],[39.062012,22.592188],[38.987891,21.881738],[39.276074,20.973975],[39.72832,20.390332],[40.75918,19.755469],[41.229492,18.678418],[42.293945,17.434961],[42.799316,16.371777],[43.165039,16.689404],[43.190918,17.359375],[43.417969,17.51626],[43.916992,17.324707],[46.727637,17.265576],[47.143555,16.94668],[48.172168,18.156934],[49.041992,18.581787],[51.977637,18.996143]]]]}},{type:"Feature",properties:{name:"圣多美和普林西比",full_name:"圣多美和普林西比民主共和国",iso_a2:"ST",iso_a3:"STP",iso_n3:"678"},geometry:{type:"Polygon",coordinates:[[[6.659961,.120654],[6.686914,.404395],[6.468164,.227344],[6.659961,.120654]]]}},{type:"Feature",properties:{name:"圣马力诺",full_name:"圣马力诺共和国",iso_a2:"SM",iso_a3:"SMR",iso_n3:"674"},geometry:{type:"Polygon",coordinates:[[[12.485254,43.901416],[12.503711,43.989746],[12.396875,43.93457],[12.485254,43.901416]]]}},{type:"Feature",properties:{name:"萨摩亚",full_name:"萨摩亚独立国",iso_a2:"WS",iso_a3:"WSM",iso_n3:"882"},geometry:{type:"Polygon",coordinates:[[[-172.333496,-13.465234],[-172.778516,-13.516797],[-172.224951,-13.804297],[-172.333496,-13.465234]]]}},{type:"Feature",properties:{name:"圣文森特和格林纳丁斯",full_name:"圣文森特和格林纳丁斯",iso_a2:"VC",iso_a3:"VCT",iso_n3:"670"},geometry:{type:"Polygon",coordinates:[[[-61.174512,13.158105],[-61.138965,13.35874],[-61.268457,13.287695],[-61.174512,13.158105]]]}},{type:"Feature",properties:{name:"圣卢西亚",full_name:"圣卢西亚",iso_a2:"LC",iso_a3:"LCA",iso_n3:"662"},geometry:{type:"Polygon",coordinates:[[[-60.895215,13.821973],[-60.908105,14.093359],[-61.073145,13.865576],[-60.895215,13.821973]]]}},{type:"Feature",properties:{name:"圣基茨和尼维斯",full_name:"圣基茨和尼维斯联邦",iso_a2:"KN",iso_a3:"KNA",iso_n3:"659"},geometry:{type:"Polygon",coordinates:[[[-62.630664,17.23999],[-62.827051,17.386426],[-62.838916,17.339258],[-62.630664,17.23999]]]}},{type:"Feature",properties:{name:"卢旺达",full_name:"卢旺达共和国",iso_a2:"RW",iso_a3:"RWA",iso_n3:"646"},geometry:{type:"Polygon",coordinates:[[[29.576953,-1.387891],[28.876367,-2.400293],[29.014355,-2.720215],[29.698047,-2.794727],[29.930176,-2.339551],[30.553613,-2.400098],[30.876562,-2.143359],[30.509961,-1.067285],[29.930078,-1.469922],[29.576953,-1.387891]]]}},{type:"Feature",properties:{name:"俄罗斯",full_name:"俄罗斯联邦",iso_a2:"RU",iso_a3:"RUS",iso_n3:"643"},geometry:{type:"MultiPolygon",coordinates:[[[[-179.798535,68.94043],[-180,68.738672],[-180,68.493896],[-180,68.249121],[-180,68.004395],[-180,67.759619],[-180,67.514844],[-180,67.270117],[-180,67.025342],[-180,66.780566],[-180,66.53584],[-180,66.291064],[-180,66.046289],[-180,65.801562],[-180,65.556787],[-180,65.311963],[-180,65.067236],[-179.3521,65.516748],[-179.683301,66.184131],[-178.526562,66.401562],[-178.939062,66.032764],[-178.4125,65.495557],[-176.093262,65.471045],[-175.395117,64.802393],[-173.729736,64.364502],[-173.32749,64.539551],[-173.275488,64.289648],[-172.903174,64.526074],[-172.401465,64.413916],[-173.085791,64.817334],[-172.213184,65.048145],[-172.783301,65.681055],[-171.105859,65.511035],[-171.421533,65.810352],[-170.666309,65.621533],[-169.777881,66.143115],[-170.604443,66.248926],[-171.795557,66.931738],[-173.00752,67.064893],[-172.520117,66.95249],[-173.258936,66.840088],[-173.679688,67.144775],[-174.550098,67.090625],[-173.773975,66.434668],[-174.065039,66.22959],[-174.084766,66.473096],[-174.394092,66.344238],[-174.924902,66.623145],[-175.345215,67.678076],[-178.373047,68.565674],[-178.055811,68.264893],[-179.798535,68.94043]]],[[[130.687305,42.302539],[130.709375,42.656396],[131.158301,42.626025],[131.938965,43.301953],[131.866602,43.095166],[132.30957,43.313525],[132.303809,42.883301],[133.159961,42.696973],[135.131055,43.525732],[137.685449,45.818359],[140.170605,48.523682],[140.520898,50.800195],[141.485254,52.178516],[140.839648,53.087891],[141.18125,53.015283],[141.37373,53.292773],[139.707422,54.277148],[138.657227,54.29834],[138.450684,53.537012],[138.52793,53.959863],[137.950488,53.603564],[137.253711,53.546143],[137.834766,53.946729],[137.339258,54.100537],[137.666016,54.283301],[137.141602,54.182227],[137.155371,53.82168],[136.718848,53.804102],[136.797266,54.620996],[135.851562,54.583936],[135.2625,54.943311],[137.691504,56.139355],[142.580273,59.240137],[145.55459,59.413525],[146.049512,59.170557],[146.537207,59.456982],[148.72666,59.25791],[148.79707,59.532324],[149.642578,59.77041],[152.260645,59.223584],[151.121094,59.08252],[151.326758,58.875098],[152.817871,58.92627],[153.361133,59.214795],[155.160449,59.190137],[154.971289,59.449609],[154.149805,59.528516],[154.293066,59.83335],[157.08418,61.675684],[160.309375,61.894385],[159.79043,60.956641],[160.378906,61.025488],[160.173633,60.638428],[162.392578,61.662109],[163.085254,61.570557],[163.331738,62.550928],[164.418359,62.704639],[165.417383,62.44707],[164.207227,62.292236],[163.709961,60.916797],[162.068164,60.466406],[158.275195,58.008984],[156.829883,57.779639],[156.848828,57.290186],[155.98252,56.695215],[155.620312,54.864551],[156.847461,51.006592],[158.103516,51.809619],[158.47207,53.032373],[160.025098,53.12959],[160.074414,54.18916],[162.105566,54.752148],[161.723926,55.496143],[162.084961,56.089648],[162.671484,56.490088],[163.038379,56.521875],[162.628125,56.232275],[162.840332,56.065625],[163.335547,56.23252],[163.256543,56.688037],[162.791113,56.875391],[163.225781,57.790381],[162.654297,57.948242],[162.391406,57.717236],[161.960059,58.076904],[163.743848,60.028027],[164.953711,59.843604],[166.352148,60.484814],[166.273047,59.85625],[167.226758,60.406299],[169.226758,60.595947],[170.350977,59.965527],[170.608203,60.434912],[172.856543,61.469189],[177.159473,62.560986],[177.023535,62.777246],[179.120703,62.320361],[179.570508,62.6875],[178.44043,63.605566],[178.381445,64.260889],[177.6875,64.304736],[177.427441,64.763379],[176.140918,64.58584],[176.056543,64.904736],[174.548828,64.683887],[176.061133,64.960889],[177.06875,64.78667],[177.037305,64.999658],[176.341016,65.047314],[176.880859,65.081934],[178.519531,64.602979],[180,65.067236],[180,68.983447],[179.272656,69.259668],[175.921484,69.895312],[173.277441,69.823828],[170.486816,70.107568],[170.160938,69.626562],[170.99541,69.045312],[169.609863,68.786035],[167.856836,69.728223],[166.820312,69.499561],[163.201367,69.714746],[161.536914,69.379541],[161.565625,68.905176],[160.856055,68.53833],[161.309863,68.982275],[160.910742,69.606348],[159.729395,69.870215],[160.006445,70.309668],[159.350684,70.790723],[156.68457,71.09375],[152.508789,70.834473],[151.582422,71.286963],[150.097656,71.226562],[150.599805,71.520117],[148.968164,71.690479],[150.016895,71.895654],[149.501563,72.164307],[147.261816,72.327881],[146.073242,71.80835],[145.188574,71.695801],[145.758594,72.225879],[146.113281,71.944971],[146.831836,72.29541],[144.294922,72.192627],[146.25293,72.442236],[140.808203,72.890967],[141.079297,72.586914],[139.14082,72.329736],[140.187695,72.191309],[139.359277,71.951367],[139.98418,71.491504],[138.23418,71.596338],[137.939648,71.133398],[136.090332,71.61958],[133.688867,71.434229],[132.653906,71.925977],[131.021582,70.746094],[129.761914,71.119531],[128.843262,71.663477],[129.210254,71.916943],[128.911426,71.755322],[127.841406,72.308252],[129.410645,72.166309],[128.418262,72.535156],[129.250391,72.705176],[128.599023,72.895166],[129.100586,73.112354],[127.740332,73.481543],[126.552539,73.334912],[124.541211,73.75127],[123.491113,73.666357],[123.622266,73.193262],[122.260156,72.880566],[119.750391,72.979102],[118.430273,73.246533],[118.870898,73.537891],[115.337695,73.702588],[113.510352,73.50498],[113.664551,72.634521],[113.032813,73.913867],[112.147266,73.708936],[111.550586,74.028516],[110.261426,74.017432],[109.706738,73.74375],[110.868164,73.730713],[109.855273,73.472461],[105.143945,72.777051],[112.924902,75.015039],[113.726172,75.450635],[112.453027,75.830176],[113.567578,75.568408],[113.272656,76.25166],[112.65625,76.053564],[111.39248,76.68667],[106.413574,76.512256],[107.429785,76.926562],[104.202441,77.101807],[106.05957,77.390527],[104.014551,77.73042],[100.989941,76.990479],[101.597754,76.439209],[98.805664,76.480664],[99.540723,75.798584],[98.662012,76.242676],[96.49707,75.891211],[95.65332,75.892188],[95.578711,76.137305],[93.259277,76.098779],[92.89043,75.909961],[94.075195,75.912891],[87.005957,75.169824],[87.041797,74.778857],[85.791016,74.645117],[87.229688,74.363867],[86.001367,74.316016],[87.571191,73.810742],[85.938965,73.456494],[86.677051,73.106787],[85.792578,73.43833],[86.892969,73.887109],[80.583203,73.568457],[80.827051,72.488281],[83.534375,71.683936],[83.15127,71.103613],[83.735938,70.546484],[83.080762,70.093018],[82.869141,70.954834],[82.221191,70.395703],[82.163184,70.598145],[83.233594,71.668164],[81.661621,71.715967],[79.42207,72.380762],[77.471582,72.192139],[78.232422,71.952295],[77.777539,71.836426],[76.871387,72.033008],[76.032422,71.9104],[76.433398,71.55249],[78.942187,70.933789],[75.332031,71.341748],[75.741406,72.29624],[75.152441,72.852734],[74.992188,72.144824],[73.08623,71.444922],[74.343359,70.578711],[73.578125,69.802979],[73.836035,69.143213],[76.000977,69.235059],[77.650684,68.903027],[77.588281,67.751904],[78.922461,67.589111],[77.174414,67.778516],[77.238477,68.46958],[76.10752,68.975732],[74.57959,68.751221],[74.769531,67.766357],[72.321582,66.332129],[70.339453,66.342383],[69.194336,66.578662],[69.217773,66.828613],[70.690723,66.745312],[70.724902,66.519434],[71.539551,66.683105],[71.365234,66.961523],[73.066797,67.766943],[73.591699,68.481885],[72.576758,68.968701],[72.704492,70.963232],[71.867285,71.457373],[72.812109,72.691406],[69.611816,72.981934],[68.269238,71.682812],[66.639648,71.081396],[67.284766,70.738721],[66.89668,69.553809],[67.624121,69.584424],[68.542773,68.96709],[69.140527,68.950635],[68.371191,68.314258],[64.19043,69.534668],[60.909082,69.847119],[60.170605,69.590918],[60.933594,68.986768],[59.725684,68.351611],[59.099023,68.444336],[59.057324,69.006055],[57.126855,68.554004],[55.418066,68.567822],[54.861328,68.201855],[53.260547,68.26748],[53.930859,68.435547],[53.797656,68.907471],[54.491211,68.992334],[53.801953,68.995898],[52.344043,68.608154],[52.39668,68.351709],[51.994727,68.53877],[48.754297,67.895947],[48.833203,67.681494],[47.874707,67.58418],[47.655859,66.975928],[46.492383,66.800195],[44.902148,67.413135],[45.528711,67.757568],[46.69043,67.848828],[45.891992,68.479688],[43.333203,68.673389],[44.204688,68.25376],[44.104395,66.008594],[42.210547,66.519678],[39.816504,65.597949],[40.444922,64.778711],[39.758008,64.577051],[36.882812,65.172363],[36.624219,64.750537],[38.062207,64.091016],[37.442188,63.813379],[35.035352,64.440234],[34.406445,65.395752],[34.691797,65.951855],[31.895313,67.161426],[34.482617,66.550342],[38.653906,66.069043],[40.10332,66.299951],[41.188965,66.826172],[40.966406,67.713477],[35.85791,69.191748],[33.684375,69.310254],[33.141211,69.068701],[33.454297,69.428174],[32.377734,69.479102],[32.176758,69.674023],[33.007812,69.722119],[31.98457,69.953662],[31.546973,69.696924],[30.869727,69.783447],[30.860742,69.538428],[30.180176,69.63584],[28.96582,69.021973],[28.414062,68.90415],[28.685156,68.189795],[29.988086,67.668262],[29.066211,66.891748],[30.102734,65.72627],[29.604199,64.968408],[30.51377,64.2],[29.991504,63.735156],[31.533984,62.8854],[27.797656,60.536133],[28.512793,60.677295],[29.069141,60.191455],[30.172656,59.957129],[28.058008,59.781543],[28.0125,59.484277],[27.43418,58.787256],[27.778516,57.870703],[27.351953,57.528125],[27.828613,57.293311],[27.639453,56.845654],[28.147949,56.14292],[29.375,55.938721],[29.482227,55.68457],[30.233594,55.845215],[30.906836,55.57002],[30.798828,54.783252],[31.754199,53.810449],[32.706445,53.419434],[32.141992,53.091162],[31.417871,53.196045],[31.258789,53.016699],[31.763379,52.101074],[33.735254,52.344775],[34.397852,51.78042],[34.213867,51.255371],[35.311914,51.043896],[35.591113,50.36875],[36.619434,50.209229],[37.422852,50.411475],[38.046875,49.92002],[38.258594,50.052344],[40.080664,49.576855],[40.108789,49.251562],[39.686523,49.00791],[40.003613,48.82207],[39.644727,48.591211],[39.95791,48.268896],[39.778711,47.887549],[38.368848,47.609961],[38.214355,47.091455],[39.02373,47.272217],[39.293457,47.105762],[38.500977,46.663672],[37.766504,46.636133],[38.492285,46.090527],[37.933105,46.001709],[37.647168,45.377197],[36.865918,45.427051],[36.627637,45.151318],[38.717285,44.288086],[39.97832,43.419824],[40.648047,43.533887],[41.580566,43.219238],[42.760645,43.16958],[43.825977,42.571533],[44.870996,42.756396],[45.705273,42.498096],[45.638574,42.205078],[46.429883,41.890967],[47.791016,41.199268],[48.572852,41.844482],[47.463184,43.035059],[47.646484,43.884619],[47.462793,43.555029],[47.307031,44.103125],[46.707227,44.50332],[47.463281,45.679688],[48.72959,45.896826],[49.232227,46.337158],[48.541211,46.605615],[48.959375,46.774609],[48.166992,47.708789],[47.292383,47.740918],[46.660938,48.412256],[47.031348,49.150293],[46.889551,49.696973],[47.429199,50.357959],[48.334961,49.858252],[48.758984,49.92832],[48.625098,50.612695],[50.793945,51.729199],[51.344531,51.475342],[52.219141,51.709375],[53.338086,51.482373],[54.555273,50.535791],[54.641602,51.011572],[55.68623,50.582861],[56.491406,51.019531],[57.442188,50.888867],[57.838867,51.09165],[59.523047,50.492871],[60.058594,50.850293],[60.942285,50.695508],[61.389453,50.861035],[61.554688,51.324609],[60.030273,51.933252],[60.994531,52.336865],[60.774414,52.675781],[61.047461,52.972461],[62.082715,53.00542],[61.199219,53.287158],[61.534961,53.523291],[60.979492,53.621729],[61.231055,54.019482],[65.088379,54.340186],[65.476953,54.623291],[68.155859,54.976709],[68.977246,55.3896],[70.182422,55.162451],[70.738086,55.305176],[71.093164,54.212207],[72.186035,54.325635],[72.446777,53.941846],[72.622266,54.134326],[73.712402,54.042383],[73.406934,53.447559],[73.858984,53.619727],[74.351562,53.487646],[76.837305,54.442383],[76.484766,54.022559],[77.859961,53.269189],[79.98623,50.774561],[80.735254,51.293408],[81.465918,50.739844],[82.493945,50.727588],[83.357324,50.99458],[84.323242,50.23916],[84.989453,50.061426],[85.232617,49.61582],[86.180859,49.499316],[86.675488,49.777295],[87.322852,49.085791],[87.814258,49.162305],[88.192578,49.451709],[89.395605,49.611523],[90.053711,50.09375],[92.354785,50.86416],[94.251074,50.556396],[94.614746,50.02373],[97.359766,49.741455],[98.250293,50.302441],[97.835742,51.05166],[98.893164,52.117285],[102.111523,51.353467],[102.288379,50.585107],[103.304395,50.200293],[105.383594,50.47373],[106.711133,50.312598],[107.233301,49.989404],[107.916602,49.947803],[108.613672,49.322803],[110.709766,49.142969],[112.806445,49.523584],[114.29707,50.274414],[115.429199,49.896484],[116.216797,50.009277],[116.683301,49.823779],[117.873438,49.513477],[119.259863,50.066406],[119.163672,50.406006],[120.749805,52.096533],[120.656152,52.56665],[120.094531,52.787207],[120.985449,53.28457],[123.607813,53.546533],[125.649023,53.042285],[127.590234,50.208984],[127.550781,49.801807],[129.498145,49.388818],[130.553125,48.861182],[130.961914,47.709326],[132.47627,47.71499],[133.144043,48.105664],[134.293359,48.373438],[135.083406,48.436324],[134.665234,48.253906],[134.752344,47.71543],[134.167676,47.302197],[133.113477,45.130713],[131.851855,45.326855],[130.981641,44.844336],[131.257324,43.378076],[131.068555,42.902246],[130.424805,42.727051],[130.526953,42.5354],[130.687305,42.302539]]],[[[47.441992,80.853662],[44.90498,80.611279],[46.141406,80.446729],[47.705273,80.765186],[48.683594,80.633252],[47.441992,80.853662]]],[[[50.278125,80.927246],[49.087793,80.515771],[46.644434,80.300342],[47.737305,80.081689],[51.703613,80.687646],[50.278125,80.927246]]],[[[67.765332,76.237598],[68.941699,76.707666],[67.651855,77.011572],[64.463477,76.378174],[61.20166,76.282031],[58.88125,75.854785],[57.606836,75.34126],[55.810059,75.124902],[56.49873,74.95708],[55.582227,74.627686],[56.137109,74.496094],[53.762891,73.766162],[54.299902,73.350977],[56.963867,73.366553],[58.534668,74.498926],[59.674023,74.610156],[61.355957,75.314844],[67.765332,76.237598]]],[[[55.319824,73.308301],[53.251172,73.182959],[51.511328,71.648096],[53.411621,71.530127],[54.155664,71.125488],[53.383594,70.873535],[57.145898,70.589111],[57.625391,70.728809],[55.297852,71.935352],[56.42959,73.201172],[55.319824,73.308301]]],[[[96.526563,81.075586],[95.15957,81.270996],[92.710352,80.872168],[91.523828,80.358545],[93.654688,80.009619],[97.298438,80.272754],[97.869922,80.763281],[96.526563,81.075586]]],[[[97.674512,80.158252],[94.987305,80.096826],[93.070801,79.495312],[95.02041,79.052686],[98.411133,78.787793],[99.929297,78.961426],[99.041797,79.293018],[100.06123,79.7771],[98.596484,80.052197],[97.65166,79.760645],[97.674512,80.158252]]],[[[102.884766,79.253955],[101.590625,79.350439],[99.500293,77.976074],[105.312598,78.499902],[103.800781,79.149268],[102.412305,78.835449],[102.884766,79.253955]]],[[[140.04873,75.828955],[138.919531,76.196729],[138.207617,76.114941],[136.947656,75.325537],[139.099121,74.656543],[139.68125,74.964062],[142.472754,74.82041],[143.12793,74.970312],[142.30791,75.691699],[144.019727,75.044678],[145.359961,75.530469],[141.485449,76.137158],[140.815918,75.630713],[140.04873,75.828955]]],[[[146.795215,75.370752],[146.5375,75.581787],[146.148535,75.198291],[148.296875,74.800439],[150.646289,74.94458],[150.822363,75.156543],[146.795215,75.370752]]],[[[178.861523,70.826416],[180,70.993018],[180,71.537744],[178.683887,71.105664],[178.861523,70.826416]]],[[[142.761035,54.393945],[142.334961,54.280713],[142.705957,53.895703],[142.526172,53.447461],[141.823535,53.339502],[141.66084,52.272949],[142.206738,51.222559],[141.866309,48.750098],[142.181738,48.013379],[141.830371,46.451074],[142.077148,45.917041],[142.578027,46.700781],[143.282324,46.558984],[143.431641,46.028662],[143.580664,46.360693],[142.556934,47.737891],[143.10498,49.198828],[144.04873,49.24917],[144.71377,48.640283],[143.299512,51.632373],[143.324707,52.963086],[142.761035,54.393945]]],[[[-178.876465,71.577051],[-179.999951,71.537744],[-179.999951,70.993018],[-177.523584,71.166895],[-178.876465,71.577051]]],[[[52.90332,71.36499],[52.249609,71.284912],[53.022656,70.968701],[52.90332,71.36499]]],[[[96.285449,77.02666],[96.528418,77.205518],[95.270312,77.018848],[96.285449,77.02666]]],[[[74.660547,72.873438],[74.961523,73.0625],[74.198535,73.109082],[74.660547,72.873438]]],[[[58.622363,81.04165],[57.210938,81.01709],[58.285645,80.764893],[58.622363,81.04165]]],[[[50.265234,69.185596],[48.844922,69.494727],[48.439062,68.804883],[49.62627,68.859717],[50.265234,69.185596]]],[[[63.373828,80.700098],[65.437402,80.930713],[64.802051,81.197266],[62.592578,80.853027],[63.373828,80.700098]]],[[[57.95625,80.123242],[59.255469,80.343213],[57.075,80.493945],[57.95625,80.123242]]],[[[62.167773,80.834766],[59.592285,80.816504],[59.649805,80.43125],[61.05127,80.418604],[62.167773,80.834766]]],[[[61.14082,80.950342],[61.457422,81.103955],[60.07832,80.99917],[61.14082,80.950342]]],[[[53.521387,80.185205],[52.853906,80.402393],[52.343555,80.213232],[53.521387,80.185205]]],[[[57.078711,80.350928],[55.811621,80.087158],[56.986914,80.071484],[57.078711,80.350928]]],[[[57.810254,81.546045],[55.716699,81.188477],[57.769727,81.169727],[57.810254,81.546045]]],[[[54.718945,81.115967],[54.668164,80.738672],[57.580371,80.755469],[54.718945,81.115967]]],[[[92.683496,79.685205],[93.803125,79.904541],[91.229297,80.030713],[92.683496,79.685205]]],[[[141.010254,73.999463],[141.038574,74.242725],[140.193555,74.236719],[140.409473,73.92168],[141.010254,73.999463]]],[[[142.184863,73.895898],[141.084766,73.865869],[139.785547,73.355225],[143.451465,73.231299],[142.184863,73.895898]]],[[[137.940527,55.092627],[137.577344,55.197021],[137.23291,54.790576],[137.721484,54.663232],[138.206152,55.033545],[137.940527,55.092627]]],[[[169.200781,69.580469],[169.374805,69.882617],[167.864746,69.901074],[169.200781,69.580469]]],[[[163.635156,58.603369],[164.615723,58.885596],[164.572656,59.221143],[163.760938,59.015039],[163.635156,58.603369]]],[[[166.650293,54.839062],[166.275781,55.311963],[165.751074,55.294531],[166.650293,54.839062]]],[[[155.921094,50.302197],[156.096875,50.771875],[155.243066,50.094629],[155.921094,50.302197]]],[[[152.002051,46.897168],[152.288867,47.142188],[151.723438,46.828809],[152.002051,46.897168]]],[[[149.687695,45.642041],[150.553125,46.208545],[149.44707,45.593359],[149.687695,45.642041]]],[[[148.599512,45.317627],[148.812207,45.51001],[148.324219,45.282422],[147.924023,45.383301],[146.897461,44.404297],[148.599512,45.317627]]],[[[146.207617,44.497656],[145.461719,43.870898],[145.555859,43.6646],[146.567773,44.44043],[146.207617,44.497656]]],[[[113.387207,74.400439],[112.084473,74.548975],[111.503418,74.353076],[112.782422,74.095068],[113.387207,74.400439]]],[[[70.673926,73.09502],[71.626172,73.173975],[70.940234,73.514404],[69.995898,73.359375],[70.040723,73.037158],[70.673926,73.09502]]],[[[77.63252,72.29126],[78.365137,72.482422],[77.748535,72.631201],[76.871094,72.317041],[77.63252,72.29126]]],[[[79.501465,72.721924],[79.164258,73.094336],[78.633203,72.850732],[79.501465,72.721924]]],[[[60.450488,69.934863],[59.048047,70.460498],[58.519922,70.318311],[59.637012,69.721045],[60.440234,69.725928],[60.450488,69.934863]]],[[[20.957813,55.278906],[20.899805,55.28667],[19.604395,54.45918],[22.766211,54.356787],[22.567285,55.059131],[21.235742,55.264111],[20.995898,54.902686],[20.594824,54.982373],[20.957813,55.278906]]],[[[33.594141,46.09624],[32.508008,45.403809],[33.555176,45.097656],[33.450684,44.553662],[33.755664,44.398926],[35.472559,45.098486],[36.393359,45.065381],[36.575,45.393555],[35.45752,45.316309],[35.001674,45.733383],[33.806667,46.208288],[33.594141,46.09624]]]]}},{type:"Feature",properties:{name:"罗马尼亚",full_name:"罗马尼亚",iso_a2:"RO",iso_a3:"ROU",iso_n3:"642"},geometry:{type:"Polygon",coordinates:[[[28.2125,45.450439],[28.071777,46.978418],[26.618945,48.259863],[24.979102,47.724121],[23.202637,48.084521],[22.87666,47.947266],[21.999707,47.505029],[21.12168,46.282422],[20.241797,46.108594],[21.490234,45.1479],[21.360059,44.82666],[22.093066,44.541943],[22.64209,44.650977],[22.705078,44.237793],[23.028516,44.077979],[22.919043,43.834473],[25.49707,43.670801],[27.086914,44.167383],[28.585352,43.742236],[28.891504,44.918652],[29.55752,44.843408],[29.705859,45.259912],[28.2125,45.450439]]]}},{type:"Feature",properties:{name:"卡塔尔",full_name:"卡塔尔国",iso_a2:"QA",iso_a3:"QAT",iso_n3:"634"},geometry:{type:"Polygon",coordinates:[[[51.267969,24.607227],[51.608887,25.052881],[51.543066,25.902393],[51.262305,26.153271],[50.762891,25.444727],[50.804395,24.789258],[51.267969,24.607227]]]}},{type:"Feature",properties:{name:"葡萄牙",full_name:"葡萄牙共和国",iso_a2:"PT",iso_a3:"PRT",iso_n3:"620"},geometry:{type:"MultiPolygon",coordinates:[[[[-17.190869,32.868604],[-17.018262,32.662793],[-16.693262,32.758008],[-17.190869,32.868604]]],[[[-8.777148,41.941064],[-8.684619,40.752539],[-9.479736,38.798779],[-9.356738,38.6979],[-9.135791,38.742773],[-8.791602,39.078174],[-9.021484,38.746875],[-9.250391,38.656738],[-9.213281,38.448096],[-8.798877,38.518164],[-8.668311,38.424316],[-8.881104,38.44668],[-8.81416,37.430811],[-8.997803,37.032275],[-7.406152,37.179443],[-7.443945,37.728271],[-6.957568,38.187891],[-7.343018,38.457422],[-6.997949,39.056445],[-7.535693,39.661572],[-6.975391,39.798389],[-6.928467,41.009131],[-6.2125,41.532031],[-6.618262,41.942383],[-8.15249,41.811963],[-8.266064,42.137402],[-8.777148,41.941064]]]]}},{type:"Feature",properties:{name:"波兰",full_name:"波兰共和国",iso_a2:"PL",iso_a3:"POL",iso_n3:"616"},geometry:{type:"Polygon",coordinates:[[[23.605273,51.51792],[23.652441,52.040381],[23.175098,52.286621],[23.91543,52.770264],[23.484668,53.939795],[22.766211,54.356787],[19.604395,54.45918],[18.836426,54.36958],[18.43623,54.744727],[18.759277,54.68457],[18.323438,54.838184],[17.842969,54.816699],[14.211426,53.950342],[14.213672,53.870752],[14.583496,53.639355],[14.258887,53.729639],[14.128613,52.878223],[14.619434,52.528516],[15.016602,51.252734],[14.809375,50.858984],[14.99375,51.014355],[16.282227,50.655615],[16.63916,50.102148],[16.880078,50.427051],[17.702246,50.307178],[17.627051,50.116406],[18.562402,49.879346],[18.832227,49.510791],[19.149414,49.4],[19.441602,49.597705],[20.057617,49.181299],[20.362988,49.385254],[21.639648,49.411963],[22.538672,49.072705],[22.852051,49.062744],[22.706152,49.606201],[24.089941,50.530469],[23.605273,51.51792]]]}},{type:"Feature",properties:{name:"菲律宾",full_name:"菲律宾共和国",iso_a2:"PH",iso_a3:"PHL",iso_n3:"608"},geometry:{type:"MultiPolygon",coordinates:[[[[121.101562,18.615283],[120.599707,18.507861],[120.36875,16.10957],[119.772559,16.255127],[120.082129,14.851074],[120.43877,14.453369],[120.583691,14.88125],[120.941309,14.645068],[120.637109,13.804492],[121.344141,13.649121],[121.77793,13.937646],[122.599902,13.194141],[122.595215,13.907617],[123.310938,13.044092],[123.948535,12.916406],[124.059766,12.56709],[124.142773,13.035791],[123.785156,13.110547],[123.549609,13.645752],[123.815723,13.837109],[123.320312,14.06167],[123.101953,13.750244],[122.627148,14.317529],[122.199707,14.148047],[122.211719,13.930176],[121.766602,14.168066],[121.392285,15.324414],[121.595313,15.933252],[122.135156,16.184814],[122.519141,17.124854],[122.152344,17.664404],[122.265527,18.458838],[121.845605,18.29541],[121.101562,18.615283]]],[[[117.311133,8.4396],[119.686914,10.500342],[119.55332,11.313525],[119.223828,10.477295],[117.349902,8.713574],[117.311133,8.4396]]],[[[122.496191,11.615088],[121.916016,11.854346],[122.103516,11.64292],[121.954004,10.444385],[122.769922,10.823828],[123.119531,11.286816],[123.158301,11.535547],[122.496191,11.615088]]],[[[123.130859,9.064111],[123.320508,9.272949],[123.162012,9.864258],[123.567578,10.780762],[123.256641,10.993945],[122.983301,10.886621],[122.855566,10.086914],[122.399512,9.823047],[123.130859,9.064111]]],[[[124.574609,11.343066],[124.330664,11.535205],[124.445508,10.923584],[124.786719,10.781396],[124.780762,10.168066],[125.026563,10.033105],[124.9875,10.367578],[125.268457,10.307715],[125.026563,11.211719],[124.574609,11.343066]]],[[[125.239551,12.527881],[124.294727,12.569336],[124.445703,12.152783],[124.99502,11.764941],[125.034277,11.34126],[125.735645,11.049609],[125.535645,12.191406],[125.239551,12.527881]]],[[[120.704395,13.479492],[120.338477,13.412354],[121.236719,12.218799],[121.540625,12.638184],[121.522754,13.131201],[121.202734,13.432324],[120.704395,13.479492]]],[[[126.005957,9.320947],[125.471289,9.756787],[125.49873,9.014746],[124.868945,8.972266],[124.731152,8.562988],[124.404883,8.599854],[123.799414,8.049121],[123.849219,8.432715],[123.43457,8.70332],[122.911133,8.156445],[122.243359,7.945117],[121.964258,6.968213],[122.616211,7.763135],[123.390918,7.40752],[123.66582,7.817773],[124.206641,7.396436],[123.985254,6.993701],[124.078125,6.404443],[124.927344,5.875342],[125.231543,6.069531],[125.346484,5.598975],[125.667969,5.978662],[125.380664,6.689941],[125.689258,7.263037],[125.824414,7.333301],[126.189355,6.309668],[126.19209,6.852539],[126.581543,7.247754],[126.458691,8.202832],[126.139551,8.595654],[126.30459,8.952051],[126.005957,9.320947]]],[[[123.370313,9.449609],[124.00498,10.400098],[124.038867,11.273535],[123.38623,9.96709],[123.370313,9.449609]]],[[[121.159375,6.075635],[120.876367,5.952637],[121.411035,5.939844],[121.159375,6.075635]]],[[[120.1,12.167676],[119.885742,12.299854],[120.010547,12.008252],[120.314551,12.012402],[120.1,12.167676]]],[[[124.593848,9.787207],[124.335742,10.159912],[123.817187,9.817383],[124.122461,9.599316],[124.593848,9.787207]]],[[[122.092871,6.42832],[122.323535,6.602246],[121.832031,6.664062],[122.092871,6.42832]]],[[[125.690234,9.914453],[125.666797,10.440137],[125.494824,10.118701],[125.690234,9.914453]]],[[[121.914844,13.540332],[122.004883,13.20498],[122.114551,13.463184],[121.914844,13.540332]]],[[[122.094043,12.354883],[122.14502,12.652637],[122.013965,12.105615],[122.094043,12.354883]]],[[[123.281836,12.853418],[122.95752,13.107178],[123.367188,12.70083],[123.281836,12.853418]]],[[[123.716602,12.287354],[123.236426,12.583496],[123.157813,11.925635],[123.47373,12.21665],[124.045508,11.752441],[123.716602,12.287354]]],[[[124.353613,13.632227],[124.224902,14.077588],[124.038867,13.663135],[124.353613,13.632227]]],[[[122.033496,15.005029],[121.839844,15.038135],[121.933008,14.656055],[122.033496,15.005029]]]]}},{type:"Feature",properties:{name:"秘鲁",full_name:"秘鲁共和国",iso_a2:"PE",iso_a3:"PER",iso_n3:"604"},geometry:{type:"Polygon",coordinates:[[[-69.965918,-4.235938],[-70.339502,-3.814355],[-70.735107,-3.781543],[-70.09585,-2.658203],[-70.968555,-2.206836],[-72.941113,-2.394043],[-73.664307,-1.248828],[-74.246387,-.970605],[-74.801758,-.200098],[-75.284473,-.106543],[-75.62627,-.122852],[-75.259375,-.590137],[-75.570557,-1.53125],[-76.679102,-2.562598],[-77.860596,-2.981641],[-78.158496,-3.465137],[-78.345361,-3.397363],[-78.686035,-4.562402],[-79.033301,-4.969141],[-79.330957,-4.927832],[-79.638525,-4.454883],[-80.478564,-4.430078],[-80.490137,-4.010059],[-80.179248,-3.877734],[-80.324658,-3.387891],[-81.283203,-4.322266],[-81.336621,-4.669531],[-80.881934,-5.635059],[-81.142041,-6.056738],[-79.994971,-6.768945],[-78.762256,-8.616992],[-77.633203,-11.287793],[-76.223633,-13.371191],[-76.289014,-14.133105],[-75.104248,-15.411914],[-72.467676,-16.708105],[-70.418262,-18.345605],[-69.926367,-18.206055],[-69.8521,-17.703809],[-69.510938,-17.506055],[-69.624854,-17.200195],[-68.842773,-16.337891],[-69.217578,-16.149121],[-69.420898,-15.640625],[-69.172461,-15.236621],[-69.359473,-14.795312],[-68.870898,-14.169727],[-69.074121,-13.682813],[-68.978613,-12.880078],[-68.685254,-12.501953],[-69.578613,-10.951758],[-70.642334,-11.010254],[-70.541113,-9.4375],[-71.237939,-9.966016],[-72.142969,-10.005176],[-72.379053,-9.510156],[-73.209424,-9.411426],[-72.974023,-8.993164],[-74.002051,-7.556055],[-73.72041,-7.309277],[-73.758105,-6.905762],[-73.137354,-6.46582],[-73.235547,-6.098438],[-72.887061,-5.122754],[-70.799512,-4.17334],[-69.965918,-4.235938]]]}},{type:"Feature",properties:{name:"巴拉圭",full_name:"巴拉圭共和国",iso_a2:"PY",iso_a3:"PRY",iso_n3:"600"},geometry:{type:"Polygon",coordinates:[[[-58.159766,-20.164648],[-58.180176,-19.817871],[-59.090527,-19.28623],[-61.756836,-19.645312],[-62.276318,-20.5625],[-62.650977,-22.233691],[-61.03291,-23.755664],[-59.89248,-24.093555],[-57.643896,-25.328418],[-58.604834,-27.314355],[-56.437158,-27.553809],[-56.164062,-27.321484],[-55.714648,-27.414844],[-54.825488,-26.652246],[-54.615869,-25.576074],[-54.241797,-24.047266],[-54.625488,-23.8125],[-55.415918,-23.951367],[-55.84917,-22.307617],[-56.447803,-22.076172],[-56.937256,-22.271289],[-57.955908,-22.10918],[-57.830225,-20.997949],[-58.159766,-20.164648]]]}},{type:"Feature",properties:{name:"巴布亚新几内亚",full_name:"巴布亚新几内亚独立国",iso_a2:"PG",iso_a3:"PNG",iso_n3:"598"},geometry:{type:"MultiPolygon",coordinates:[[[[152.96582,-4.756348],[153.016797,-4.105664],[152.03291,-3.251367],[150.825391,-2.572949],[150.746094,-2.738867],[152.279395,-3.582422],[152.96582,-4.756348]]],[[[151.915625,-4.296777],[151.593066,-4.200781],[151.671191,-4.883301],[150.900293,-5.447168],[150.183105,-5.523633],[150.090039,-5.011816],[149.831445,-5.524121],[148.432031,-5.471777],[148.337207,-5.669434],[149.652539,-6.29043],[150.473535,-6.263379],[151.515137,-5.552344],[152.077051,-5.458301],[151.983691,-5.074414],[152.351172,-4.822168],[152.405664,-4.340723],[151.915625,-4.296777]]],[[[140.976172,-9.11875],[142.647168,-9.327832],[143.366211,-8.961035],[143.111816,-8.474512],[142.206836,-8.195801],[143.61377,-8.200391],[143.518164,-8.000684],[143.942285,-7.944238],[143.654883,-7.460352],[144.142871,-7.757227],[144.509863,-7.567383],[146.033203,-8.076367],[147.768652,-10.070117],[149.754102,-10.353027],[150.319922,-10.654883],[150.647168,-10.517969],[150.446094,-10.307324],[150.849512,-10.236035],[149.874414,-10.012988],[149.76123,-9.805859],[150.011035,-9.688184],[149.263184,-9.497852],[149.19834,-9.03125],[148.583105,-9.051758],[148.126758,-8.103613],[147.190039,-7.378125],[146.953613,-6.834082],[147.845508,-6.662402],[147.566699,-6.056934],[145.745215,-5.402441],[145.766992,-4.823047],[144.477734,-3.825293],[140.973438,-2.609766],[140.976172,-9.11875]]],[[[151.080957,-10.020117],[150.776074,-9.709082],[151.230859,-10.194727],[151.296484,-9.956738],[151.080957,-10.020117]]],[[[150.34541,-9.493848],[150.208301,-9.206348],[150.109766,-9.361914],[150.34541,-9.493848]]],[[[147.067578,-1.960156],[146.65625,-1.974023],[146.546484,-2.208594],[147.438086,-2.058984],[147.067578,-1.960156]]],[[[150.436621,-2.661816],[150.227148,-2.38418],[149.961621,-2.473828],[150.436621,-2.661816]]],[[[150.528418,-9.346582],[150.43623,-9.624609],[150.894043,-9.66748],[150.528418,-9.346582]]],[[[153.536133,-11.476172],[153.203613,-11.324121],[153.759863,-11.586328],[153.536133,-11.476172]]],[[[155.957617,-6.686816],[154.729297,-5.444434],[154.759277,-5.931348],[155.344043,-6.72168],[155.719336,-6.862793],[155.957617,-6.686816]]]]}},{type:"Feature",properties:{name:"巴拿马",full_name:"巴拿马共和国",iso_a2:"PA",iso_a3:"PAN",iso_n3:"591"},geometry:{type:"Polygon",coordinates:[[[-77.374219,8.658301],[-78.082764,9.236279],[-79.577295,9.597852],[-81.354785,8.780566],[-81.894482,9.14043],[-81.780225,8.957227],[-82.244189,9.031494],[-82.563574,9.57666],[-82.939844,9.44917],[-82.727832,8.916064],[-83.027344,8.337744],[-82.879346,8.070654],[-82.781152,8.303516],[-82.235449,8.311035],[-81.727637,8.137549],[-81.268408,7.625488],[-81.063867,7.899756],[-80.845557,7.220068],[-80.438867,7.274951],[-80.01123,7.500049],[-80.458984,8.213867],[-79.50708,8.970068],[-79.086377,8.997168],[-78.409863,8.355322],[-78.099463,8.496973],[-77.760547,8.133252],[-78.141895,8.386084],[-78.421582,8.060986],[-77.901172,7.229346],[-77.761914,7.698828],[-77.538281,7.56626],[-77.195996,7.972461],[-77.374219,8.658301]]]}},{type:"Feature",properties:{name:"帕劳",full_name:"帕劳共和国",iso_a2:"PW",iso_a3:"PLW",iso_n3:"585"},geometry:{type:"Polygon",coordinates:[[[134.59541,7.382031],[134.651172,7.712109],[134.515723,7.525781],[134.59541,7.382031]]]}},{type:"Feature",properties:{name:"巴基斯坦",full_name:"巴基斯坦伊斯兰共和国",iso_a2:"PK",iso_a3:"PAK",iso_n3:"586"},geometry:{type:"Polygon",coordinates:[[[76.766895,35.661719],[75.912305,36.048975],[75.772168,36.694922],[74.541406,37.022168],[72.249805,36.734717],[71.23291,36.121777],[71.620508,35.183008],[70.965625,34.530371],[71.051563,34.049707],[69.889648,34.007275],[70.261133,33.289014],[69.501562,33.020068],[69.279297,31.936816],[68.868945,31.634229],[68.161035,31.802979],[67.452832,31.234619],[66.829297,31.263672],[66.346875,30.802783],[66.23125,29.865723],[64.09873,29.391943],[62.476562,29.40835],[60.843359,29.858691],[61.889844,28.546533],[62.758008,28.243555],[62.762988,27.250195],[63.301563,27.151465],[63.157812,26.649756],[61.842383,26.225928],[61.587891,25.202344],[64.059375,25.40293],[64.658984,25.184082],[66.467676,25.445312],[66.131152,25.493262],[66.324219,25.601807],[66.698633,25.226318],[66.703027,24.860938],[67.171484,24.756104],[67.563086,23.881836],[68.165039,23.857324],[68.724121,23.964697],[68.781152,24.313721],[69.805176,24.165234],[71.044043,24.400098],[70.648438,25.666943],[70.100195,25.910059],[70.147656,26.506445],[69.506934,26.742676],[69.537012,27.122949],[70.403711,28.025049],[70.797949,27.709619],[71.870313,27.9625],[72.341895,28.751904],[72.90332,29.02876],[73.381641,29.934375],[73.80918,30.093359],[74.632812,31.034668],[74.555566,31.818555],[75.333496,32.279199],[74.685742,32.493799],[74.663281,32.757666],[74.35459,32.768701],[74.003809,33.189453],[73.976465,33.721289],[74.250879,33.946094],[73.904102,34.075684],[73.96123,34.653467],[75.70918,34.503076],[77.048633,35.109912],[76.766895,35.661719]]]}},{type:"Feature",properties:{name:"阿曼",full_name:"阿曼苏丹国",iso_a2:"OM",iso_a3:"OMN",iso_n3:"512"},geometry:{type:"MultiPolygon",coordinates:[[[[53.085645,16.648389],[54.068164,17.005518],[55.06416,17.038916],[55.479102,17.843262],[56.383496,17.987988],[56.825977,18.753516],[57.811621,19.01709],[57.861816,20.244141],[58.169434,20.589502],[58.474219,20.406885],[59.8,22.219922],[59.823242,22.508984],[59.429395,22.66084],[58.773047,23.517188],[57.123047,23.980713],[56.387988,24.979199],[56.063867,24.73877],[56.000586,24.953223],[55.795703,24.868115],[55.76084,24.242676],[55.985156,24.063379],[55.468457,23.941113],[55.18584,22.704102],[55.641016,22.001855],[54.977344,19.995947],[51.977637,18.996143],[53.085645,16.648389]]],[[[56.297852,25.650684],[56.413086,26.351172],[56.080469,26.062646],[56.297852,25.650684]]]]}},{type:"Feature",properties:{name:"挪威",full_name:"挪威王国",iso_a2:"NO",iso_a3:"NOR",iso_n3:"578"},geometry:{type:"MultiPolygon",coordinates:[[[[20.622168,69.036865],[21.59375,69.273584],[22.410938,68.719873],[23.854004,68.805908],[24.941406,68.593262],[26.072461,69.691553],[27.747852,70.064844],[29.141602,69.671436],[28.96582,69.021973],[30.180176,69.63584],[30.860742,69.538428],[30.869727,69.783447],[29.79209,69.727881],[28.804297,70.092529],[30.944141,70.274414],[30.065137,70.702979],[28.831543,70.863965],[28.192969,70.248584],[28.392285,70.975293],[27.59707,71.091309],[26.989355,70.511377],[26.585059,70.41001],[26.661328,70.939746],[25.043848,70.109033],[25.768164,70.853174],[24.658008,71.001025],[23.353906,69.983398],[22.68457,70.374756],[21.355762,70.233398],[21.974707,69.83457],[20.62207,69.913916],[20.739453,69.520508],[20.054492,69.332666],[20.324219,69.945312],[19.641504,69.424023],[19.722461,69.781641],[19.197266,69.747852],[18.915918,69.335596],[18.259766,69.470605],[18.101465,69.156299],[16.514355,68.532568],[17.552832,68.42627],[16.203809,68.316748],[16.312305,67.881445],[16.00791,68.228711],[14.798926,67.809326],[15.594434,67.348535],[14.961914,67.574268],[14.441699,67.271387],[15.415723,67.202441],[14.108789,67.119238],[13.211426,66.64082],[13.118848,66.230664],[14.03418,66.297559],[12.783789,66.100439],[12.133887,65.27915],[12.915527,65.339258],[11.489355,64.97583],[9.567285,63.706152],[10.055078,63.512695],[11.306641,64.048877],[11.370703,63.804834],[10.020996,63.39082],[9.696875,63.624561],[9.156055,63.459326],[8.576172,63.601172],[8.158008,63.161523],[8.623145,62.84624],[7.571875,63.099512],[6.734961,62.720703],[8.045508,62.77124],[7.653125,62.564014],[6.35293,62.611133],[6.136133,62.407471],[6.580078,62.407275],[5.143164,62.159912],[5.266895,61.935596],[6.730762,61.869775],[4.930078,61.87832],[5.106738,61.187549],[7.173535,61.165967],[7.442578,61.434619],[7.604492,61.210547],[7.038672,60.95293],[6.777832,61.142432],[5.008594,61.038184],[5.11582,60.635986],[5.64834,60.687988],[5.137109,60.445605],[5.688574,60.123193],[5.205664,60.087939],[5.145801,59.638818],[6.15332,60.34624],[6.995703,60.511963],[5.730469,59.863086],[6.216602,59.818359],[5.242188,59.564307],[5.173242,59.162549],[6.415332,59.547119],[5.88916,59.097949],[6.363281,59.000928],[5.555566,58.975195],[5.706836,58.523633],[7.004883,58.024219],[8.166113,58.145312],[9.557227,59.112695],[10.179395,59.009277],[10.595312,59.764551],[10.834473,59.183936],[11.388281,59.036523],[11.642773,58.926074],[11.680762,59.592285],[12.486133,60.106787],[12.294141,61.002686],[12.880762,61.352295],[12.155371,61.720752],[12.175195,63.595947],[12.792773,64],[14.141211,64.173535],[13.650293,64.581543],[14.479688,65.301465],[14.543262,66.129346],[15.483789,66.305957],[16.783594,67.89502],[17.324609,68.103809],[17.916699,67.964893],[18.303027,68.55542],[19.969824,68.356396],[20.116699,69.020898],[20.622168,69.036865]]],[[[23.440527,70.815771],[21.994531,70.657129],[22.829102,70.541553],[23.440527,70.815771]]],[[[15.207129,68.943115],[14.404688,68.663232],[15.22207,68.616309],[15.207129,68.943115]]],[[[19.255078,70.066406],[19.132715,70.244141],[18.129883,69.557861],[19.334766,69.820264],[19.255078,70.066406]]],[[[17.503027,69.59624],[17.08252,69.013672],[17.950684,69.198145],[17.503027,69.59624]]],[[[15.760352,68.56123],[16.048047,69.302051],[15.412598,68.61582],[14.25752,68.190771],[15.975293,68.40249],[16.328906,68.876318],[15.760352,68.56123]]],[[[32.525977,80.119141],[33.629297,80.217432],[31.481934,80.10791],[32.525977,80.119141]]],[[[21.608105,78.595703],[20.22793,78.477832],[21.653125,77.923535],[20.928125,77.459668],[22.685352,77.553516],[22.553711,77.26665],[24.901855,77.756592],[23.116699,77.991504],[21.608105,78.595703]]],[[[20.897852,80.249951],[19.733301,80.477832],[19.343359,80.116406],[17.916895,80.143115],[18.725,79.760742],[20.784082,79.748584],[20.128223,79.4896],[23.947754,79.194287],[25.641211,79.403027],[26.86084,80.16001],[24.297559,80.3604],[23.114551,80.186963],[23.008008,80.473975],[22.289746,80.049219],[20.897852,80.249951]]],[[[16.786719,79.906738],[16.245703,80.049463],[16.34375,78.976123],[14.593652,79.79873],[14.02959,79.344141],[12.555371,79.569482],[13.692871,79.860986],[10.804004,79.798779],[10.737598,79.520166],[13.150195,78.2375],[14.638281,78.4146],[14.689258,78.720947],[15.417383,78.473242],[16.782617,78.663623],[17.00293,78.369385],[13.680566,78.028125],[14.089941,77.771387],[16.914062,77.897998],[13.995703,77.508203],[16.700488,76.579297],[19.676758,78.60957],[21.38877,78.74043],[18.677832,79.261719],[18.397363,79.605176],[17.66875,79.385938],[16.786719,79.906738]]],[[[11.250293,78.610693],[10.558203,78.90293],[12.116406,78.232568],[11.250293,78.610693]]]]}},{type:"Feature",properties:{name:"朝鲜",full_name:"朝鲜民主主义人民共和国",iso_a2:"KP",iso_a3:"PRK",iso_n3:"408"},geometry:{type:"Polygon",coordinates:[[[128.374609,38.623438],[127.394531,39.20791],[127.568164,39.781982],[129.708691,40.857324],[129.756348,41.712256],[130.687305,42.302539],[130.526953,42.5354],[129.898242,42.998145],[129.697852,42.448145],[128.923438,42.038232],[128.045215,41.9875],[128.149414,41.387744],[126.743066,41.724854],[125.989062,40.904639],[124.362109,40.004053],[124.638281,39.615088],[124.775293,39.758057],[125.36084,39.526611],[125.168848,38.805518],[125.554492,38.68623],[124.690918,38.129199],[125.206738,38.081543],[124.98877,37.931445],[125.357813,37.724805],[125.769141,37.985352],[126.116699,37.74292],[126.633887,37.781836],[127.090332,38.283887],[128.038965,38.308545],[128.374609,38.623438]]]}},{type:"Feature",properties:{name:"尼日利亚",full_name:"尼日利亚联邦共和国",iso_a2:"NG",iso_a3:"NGA",iso_n3:"566"},geometry:{type:"Polygon",coordinates:[[[13.606348,13.70459],[12.463184,13.09375],[10.475879,13.330225],[9.615918,12.810645],[8.750586,12.908154],[7.830469,13.340918],[7.005078,12.995557],[6.299805,13.658789],[5.491992,13.872852],[4.664844,13.733203],[4.147559,13.457715],[4.03877,12.934668],[3.64668,12.52998],[3.59541,11.696289],[3.487793,11.39541],[3.834473,10.607422],[3.044922,9.083838],[2.774805,9.048535],[2.706445,6.369238],[3.716992,6.597949],[3.450781,6.427051],[4.431348,6.348584],[5.112402,5.641553],[5.456641,5.611719],[5.199219,5.533545],[5.549707,5.474219],[5.367969,5.337744],[5.493262,4.83877],[6.076563,4.290625],[6.860352,4.37334],[6.767676,4.724707],[6.923242,4.390674],[7.154688,4.514404],[7.076563,4.716162],[7.800781,4.522266],[8.293066,4.557617],[8.252734,4.923975],[8.555859,4.755225],[8.997168,5.917725],[9.779883,6.760156],[10.60625,7.063086],[11.237305,6.450537],[11.861426,7.116406],[12.233398,8.282324],[12.782227,8.817871],[13.699902,10.873145],[14.575391,11.532422],[14.619727,12.150977],[14.197461,12.383789],[14.063965,13.078516],[13.606348,13.70459]]]}},{type:"Feature",properties:{name:"尼日尔",full_name:"尼日尔共和国",iso_a2:"NE",iso_a3:"NER",iso_n3:"562"},geometry:{type:"Polygon",coordinates:[[[13.606348,13.70459],[13.448242,14.380664],[15.474316,16.908398],[15.735059,19.904053],[15.963184,20.346191],[15.181836,21.523389],[14.979004,22.996191],[14.215527,22.619678],[13.48125,23.180176],[11.967871,23.517871],[7.481738,20.873096],[5.836621,19.47915],[4.227637,19.142773],[4.234668,16.996387],[3.842969,15.701709],[3.504297,15.356348],[1.300195,15.272266],[.947461,14.982129],[.21748,14.911475],[.429199,13.972119],[1.201172,13.35752],[.988477,13.364844],[.987305,13.041895],[1.564941,12.6354],[2.10459,12.70127],[2.072949,12.309375],[2.38916,11.89707],[2.366016,12.221924],[2.805273,12.383838],[3.59541,11.696289],[3.64668,12.52998],[4.03877,12.934668],[4.147559,13.457715],[4.664844,13.733203],[5.491992,13.872852],[6.299805,13.658789],[7.005078,12.995557],[7.830469,13.340918],[8.750586,12.908154],[9.615918,12.810645],[10.475879,13.330225],[12.463184,13.09375],[13.606348,13.70459]]]}},{type:"Feature",properties:{name:"尼加拉瓜",full_name:"尼加拉瓜共和国",iso_a2:"NI",iso_a3:"NIC",iso_n3:"558"},geometry:{type:"Polygon",coordinates:[[[-83.15752,14.993066],[-84.453564,14.643701],[-84.985156,14.752441],[-85.733936,13.858691],[-86.040381,14.050146],[-86.733643,13.763477],[-86.729297,13.284375],[-87.337256,12.979248],[-87.667529,12.903564],[-85.744336,11.062109],[-84.63418,11.045605],[-83.919287,10.735352],[-83.641992,10.917236],[-83.867871,11.300049],[-83.651758,11.642041],[-83.754248,12.501953],[-83.593359,12.713086],[-83.510938,12.411816],[-83.567334,13.320312],[-83.187744,14.340088],[-83.413721,14.825342],[-83.15752,14.993066]]]}},{type:"Feature",properties:{name:"新西兰",full_name:"新西兰",iso_a2:"NZ",iso_a3:"NZL",iso_n3:"554"},geometry:{type:"MultiPolygon",coordinates:[[[[173.115332,-41.279297],[172.704395,-40.667773],[172.943652,-40.51875],[172.640625,-40.518262],[171.48623,-41.794727],[171.011719,-42.885059],[170.969922,-42.718359],[169.178906,-43.913086],[168.457422,-44.030566],[167.908984,-44.664746],[167.194531,-44.963477],[167.155664,-45.410938],[166.743066,-45.468457],[167.00332,-45.712109],[166.488281,-45.831836],[166.916699,-45.957227],[166.731543,-46.197852],[167.539453,-46.148535],[168.382129,-46.605371],[169.342285,-46.620508],[170.77627,-45.870898],[171.240723,-44.26416],[172.179785,-43.895996],[172.035547,-43.701758],[173.065625,-43.874609],[172.52666,-43.464746],[172.624023,-43.272461],[173.221191,-42.976562],[174.283105,-41.740625],[174.069336,-41.429492],[174.370117,-41.103711],[174.038574,-41.241895],[174.302539,-41.019531],[173.797852,-41.271973],[173.947168,-40.924121],[173.115332,-41.279297]]],[[[168.144922,-46.862207],[167.783984,-46.699805],[167.521973,-47.258691],[168.240918,-47.07002],[168.144922,-46.862207]]],[[[173.269434,-34.934766],[173.043945,-34.429102],[172.705957,-34.455176],[173.313965,-35.443359],[173.626172,-35.319141],[173.412207,-35.542578],[174.054688,-36.359766],[173.914453,-35.908691],[174.392773,-36.240039],[174.401562,-36.601953],[174.188867,-36.492285],[174.475586,-36.941895],[174.928906,-37.084766],[174.58584,-37.097754],[174.928027,-37.804492],[174.597363,-38.785059],[173.763672,-39.31875],[175.155957,-40.114941],[175.1625,-40.621582],[174.635352,-41.289453],[175.309766,-41.610645],[176.842188,-40.157812],[177.076758,-39.221777],[177.522949,-39.073828],[177.908789,-39.239551],[178.53623,-37.69209],[178.00918,-37.554883],[177.274023,-37.993457],[176.108398,-37.645117],[175.46084,-36.475684],[175.54248,-37.201367],[174.722461,-36.841211],[174.802148,-36.309473],[174.320312,-35.24668],[173.269434,-34.934766]]],[[[166.221094,-50.761523],[166.101367,-50.538965],[165.88916,-50.807715],[166.221094,-50.761523]]],[[[-176.177637,-43.740332],[-176.847656,-43.823926],[-176.515527,-44.116602],[-176.516553,-43.784766],[-176.177637,-43.740332]]]]}},{type:"Feature",properties:{name:"纽埃",full_name:"纽埃",iso_a2:"NU",iso_a3:"NIU",iso_n3:"570"},geometry:{type:"Polygon",coordinates:[[[-169.803418,-19.083008],[-169.834033,-18.966016],[-169.94834,-19.072852],[-169.803418,-19.083008]]]}},{type:"Feature",properties:{name:"库克群岛",full_name:"库克群岛",iso_a2:"CK",iso_a3:"COK",iso_n3:"184"},geometry:{type:"Polygon",coordinates:[[[-159.740527,-21.249219],[-159.768359,-21.188477],[-159.832031,-21.200488],[-159.740527,-21.249219]]]}},{type:"Feature",properties:{name:"荷兰",full_name:"荷兰王国",iso_a2:"NL",iso_a3:"NLD",iso_n3:"528"},geometry:{type:"MultiPolygon",coordinates:[[[[5.993945,50.750439],[5.94873,51.802686],[6.800391,51.967383],[7.035156,52.380225],[6.710742,52.617871],[7.033008,52.651367],[7.197266,53.282275],[6.062207,53.40708],[4.76875,52.941309],[3.946875,51.810547],[4.274121,51.471631],[3.448926,51.540771],[4.226172,51.386475],[5.030957,51.469092],[5.796484,51.153076],[5.639453,50.843604],[5.993945,50.750439]]],[[[4.226172,51.386475],[3.350098,51.377686],[3.902051,51.207666],[4.226172,51.386475]]]]}},{type:"Feature",properties:{name:"阿鲁巴",full_name:"阿鲁巴（荷兰）",iso_a2:"AW",iso_a3:"ABW",iso_n3:"533"},geometry:{type:"Polygon",coordinates:[[[-69.899121,12.452002],[-70.035107,12.614111],[-70.066113,12.546973],[-69.899121,12.452002]]]}},{type:"Feature",properties:{name:"库拉索",full_name:"库拉索岛（荷兰）",iso_a2:"CW",iso_a3:"CUW",iso_n3:"531"},geometry:{type:"Polygon",coordinates:[[[-68.751074,12.059766],[-69.158887,12.380273],[-68.995117,12.141846],[-68.751074,12.059766]]]}},{type:"Feature",properties:{name:"尼泊尔",full_name:"尼泊尔",iso_a2:"NP",iso_a3:"NPL",iso_n3:"524"},geometry:{type:"Polygon",coordinates:[[[88.109766,27.870605],[87.141406,27.83833],[86.137012,28.114355],[85.994531,27.9104],[85.67832,28.277441],[85.122461,28.315967],[85.159082,28.592236],[84.228711,28.911768],[84.101367,29.219971],[83.583496,29.183594],[82.043359,30.326758],[81.010254,30.164502],[80.401855,29.730273],[80.070703,28.830176],[82.733398,27.518994],[84.091016,27.491357],[85.794531,26.60415],[87.995117,26.382373],[88.109766,27.870605]]]}},{type:"Feature",properties:{name:"瑙鲁",full_name:"瑙鲁共和国",iso_a2:"NR",iso_a3:"NRU",iso_n3:"520"},geometry:{type:"Polygon",coordinates:[[[166.958398,-.516602],[166.907031,-.52373],[166.938965,-.550781],[166.958398,-.516602]]]}},{type:"Feature",properties:{name:"纳米比亚",full_name:"纳米比亚共和国",iso_a2:"NA",iso_a3:"NAM",iso_n3:"516"},geometry:{type:"Polygon",coordinates:[[[23.380664,-17.640625],[20.745508,-18.019727],[18.955273,-17.803516],[18.396387,-17.399414],[14.01748,-17.408887],[13.101172,-16.967676],[11.743066,-17.249219],[11.775879,-18.001758],[14.462793,-22.449121],[14.501562,-24.201953],[14.967773,-26.318066],[15.341504,-27.386523],[16.447559,-28.617578],[17.05625,-28.031055],[17.447949,-28.698145],[18.102734,-28.87168],[19.161719,-28.93877],[19.980469,-28.45127],[19.980469,-24.776758],[19.977344,-22.000195],[20.979492,-21.961914],[20.974121,-18.318848],[23.219336,-17.999707],[23.599707,-18.459961],[24.243945,-18.023438],[25.258789,-17.793555],[24.73291,-17.517773],[23.380664,-17.640625]]]}},{type:"Feature",properties:{name:"莫桑比克",full_name:"莫桑比克共和国",iso_a2:"MZ",iso_a3:"MOZ",iso_n3:"508"},geometry:{type:"Polygon",coordinates:[[[31.287891,-22.402051],[31.98584,-24.460645],[31.948242,-25.957617],[32.112891,-26.839453],[32.886133,-26.849316],[32.954883,-26.083594],[32.848828,-26.268066],[32.59043,-26.004102],[32.792188,-25.644336],[34.99209,-24.650586],[35.489648,-24.065527],[35.530078,-22.248145],[35.315723,-22.396875],[34.649414,-19.701367],[34.947852,-19.812695],[36.403711,-18.769727],[37.244531,-17.739941],[39.844629,-16.435645],[40.558984,-15.473438],[40.844531,-14.718652],[40.436816,-12.983105],[40.463574,-10.464355],[38.491797,-11.413281],[37.920215,-11.294727],[37.372852,-11.710449],[36.305664,-11.706348],[35.911328,-11.454688],[34.959473,-11.578125],[34.618555,-11.620215],[34.357813,-12.164746],[34.563672,-13.360156],[35.247461,-13.896875],[35.892773,-14.891797],[35.755273,-16.058301],[35.358496,-16.160547],[35.167188,-16.560254],[35.272559,-17.118457],[34.248242,-15.8875],[34.54082,-15.297266],[34.505273,-14.598145],[34.33252,-14.408594],[33.636426,-14.568164],[33.201758,-14.013379],[30.231836,-14.990332],[30.396094,-15.643066],[30.437793,-15.995313],[31.23623,-16.023633],[32.948047,-16.712305],[32.993066,-18.35957],[32.699707,-18.940918],[32.992773,-19.984863],[32.492383,-20.659766],[32.429785,-21.29707],[31.287891,-22.402051]]]}},{type:"Feature",properties:{name:"摩洛哥",full_name:"摩洛哥王国",iso_a2:"MA",iso_a3:"MAR",iso_n3:"504"},geometry:{type:"Polygon",coordinates:[[[-2.219629,35.104199],[-2.839941,35.127832],[-2.972217,35.407275],[-4.62832,35.206396],[-5.252686,35.614746],[-5.277832,35.902734],[-5.924805,35.785791],[-6.900977,33.969043],[-8.512842,33.252441],[-9.24585,32.572461],[-9.808691,31.424609],[-9.66709,30.109277],[-10.200586,29.380371],[-11.552686,28.310107],[-12.948926,27.91416],[-13.575781,26.735107],[-14.413867,26.253711],[-14.904297,24.719775],[-15.899316,23.844434],[-17.003076,21.420703],[-14.750977,21.500586],[-14.221191,22.310156],[-13.891113,23.691016],[-12.431152,24.830664],[-12.060986,25.99082],[-11.718213,26.104102],[-11.392578,26.883398],[-9.817871,26.850195],[-8.794873,27.120703],[-8.68335,27.656445],[-8.678418,28.689404],[-7.685156,29.349512],[-5.448779,29.956934],[-4.968262,30.465381],[-3.666797,30.964014],[-3.826758,31.661914],[-3.017383,31.834277],[-2.887207,32.068848],[-1.225928,32.107227],[-1.065527,32.468311],[-1.679199,33.318652],[-1.795605,34.751904],[-2.219629,35.104199]]]}},{type:"Feature",properties:{name:"西撒哈拉",full_name:"西撒哈拉",iso_a2:"EH",iso_a3:"ESH",iso_n3:"732"},geometry:{type:"Polygon",coordinates:[[[-8.68335,27.656445],[-8.794873,27.120703],[-9.817871,26.850195],[-11.392578,26.883398],[-11.718213,26.104102],[-12.060986,25.99082],[-12.431152,24.830664],[-13.891113,23.691016],[-14.221191,22.310156],[-14.750977,21.500586],[-17.003076,21.420703],[-17.048047,20.806152],[-16.964551,21.329248],[-13.016211,21.333936],[-13.153271,22.820508],[-12.023438,23.467578],[-12.016309,25.99541],[-8.682227,25.995508],[-8.68335,27.285938],[-8.68335,27.656445]]]}},{type:"Feature",properties:{name:"黑山",full_name:"黑山",iso_a2:"ME",iso_a3:"MNE",iso_n3:"499"},geometry:{type:"Polygon",coordinates:[[[19.194336,43.533301],[18.460156,42.9979],[18.436328,42.559717],[18.51748,42.43291],[19.342383,41.869092],[19.654492,42.628564],[20.063965,42.547266],[20.344336,42.82793],[19.194336,43.533301]]]}},{type:"Feature",properties:{name:"蒙古",full_name:"蒙古国",iso_a2:"MN",iso_a3:"MNG",iso_n3:"496"},geometry:{type:"Polygon",coordinates:[[[87.814258,49.162305],[87.979688,48.555127],[89.047656,48.002539],[90.02793,47.877686],[90.869922,46.954492],[90.877246,45.196094],[93.516211,44.944482],[95.350293,44.278076],[96.385449,42.720361],[101.495313,42.53877],[102.156641,42.158105],[103.711133,41.751318],[104.498242,41.877002],[104.498242,41.658691],[104.982031,41.595508],[106.77002,42.288721],[109.339844,42.438379],[110.400391,42.773682],[111.933203,43.711426],[111.402246,44.367285],[111.898047,45.064062],[113.587012,44.745703],[114.560156,45.38999],[115.681055,45.458252],[116.562598,46.289795],[117.333398,46.362012],[117.438086,46.58623],[119.867188,46.672168],[119.711133,47.15],[118.498438,47.983984],[117.768359,47.987891],[117.350781,47.652197],[116.760547,47.869775],[115.898242,47.686914],[115.616406,47.874805],[116.683301,49.823779],[116.216797,50.009277],[115.429199,49.896484],[114.29707,50.274414],[112.806445,49.523584],[110.709766,49.142969],[108.613672,49.322803],[107.916602,49.947803],[107.233301,49.989404],[106.711133,50.312598],[105.383594,50.47373],[103.304395,50.200293],[102.288379,50.585107],[102.111523,51.353467],[98.893164,52.117285],[97.835742,51.05166],[98.250293,50.302441],[97.359766,49.741455],[94.614746,50.02373],[94.251074,50.556396],[92.354785,50.86416],[90.053711,50.09375],[89.395605,49.611523],[88.192578,49.451709],[87.814258,49.162305]]]}},{type:"Feature",properties:{name:"摩尔多瓦",full_name:"摩尔多瓦共和国",iso_a2:"MD",iso_a3:"MDA",iso_n3:"498"},geometry:{type:"Polygon",coordinates:[[[26.618945,48.259863],[28.071777,46.978418],[28.2125,45.450439],[28.947754,46.049951],[28.958398,46.458496],[30.131055,46.423096],[29.134863,47.489697],[29.125391,47.964551],[27.549219,48.477734],[26.618945,48.259863]]]}},{type:"Feature",properties:{name:"摩纳哥",full_name:"摩纳哥公国",iso_a2:"MC",iso_a3:"MCO",iso_n3:"492"},geometry:{type:"Polygon",coordinates:[[[7.438672,43.750439],[7.39502,43.765332],[7.377734,43.731738],[7.438672,43.750439]]]}},{type:"Feature",properties:{name:"墨西哥",full_name:"墨西哥合众国",iso_a2:"MX",iso_a3:"MEX",iso_n3:"484"},geometry:{type:"MultiPolygon",coordinates:[[[[-117.128271,32.53335],[-115.673828,29.756396],[-114.048486,28.426172],[-114.265869,27.934473],[-114.069336,27.675684],[-114.300586,27.872998],[-114.993506,27.736035],[-113.598535,26.721289],[-113.155811,26.94624],[-113.020752,26.583252],[-112.377246,26.213916],[-112.069873,25.572852],[-112.072559,24.840039],[-110.362695,23.604932],[-110.00625,22.894043],[-109.495703,23.159814],[-109.42085,23.480127],[-110.262891,24.344531],[-110.367432,24.100488],[-110.659326,24.341455],[-111.569678,26.707617],[-111.795264,26.879688],[-111.699414,26.580957],[-111.862646,26.678516],[-112.734033,27.825977],[-112.87085,28.424219],[-114.550488,30.022266],[-114.933594,31.900732],[-113.046729,31.179248],[-113.057666,30.651025],[-112.161768,29.018896],[-111.121387,27.966992],[-110.529883,27.864209],[-110.377295,27.233301],[-109.27627,26.533887],[-109.116699,26.252734],[-109.425635,26.032568],[-109.384961,25.727148],[-108.886572,25.733447],[-109.028809,25.480469],[-108.051465,25.067041],[-108.280762,25.081543],[-107.951172,24.614893],[-107.511914,24.48916],[-107.764941,24.471924],[-105.791797,22.62749],[-105.649121,21.988086],[-105.208691,21.49082],[-105.51084,20.80874],[-105.260156,20.579053],[-105.669434,20.385596],[-104.938477,19.309375],[-103.912451,18.828467],[-103.441602,18.325391],[-101.918701,17.959766],[-100.847803,17.200488],[-97.754785,15.966846],[-96.213574,15.693066],[-94.799414,16.209668],[-95.02085,16.277637],[-94.858691,16.419727],[-94.587109,16.31582],[-94.661523,16.201904],[-94.00127,16.018945],[-94.37417,16.284766],[-93.166895,15.448047],[-92.235156,14.54541],[-92.204248,15.275],[-91.736572,16.070166],[-90.447168,16.072705],[-90.416992,16.391016],[-91.409619,17.255859],[-90.992969,17.252441],[-90.98916,17.816406],[-89.161475,17.814844],[-88.295654,18.472412],[-88.031738,18.838916],[-87.881982,18.273877],[-87.761816,18.446143],[-87.424756,19.58335],[-87.687695,19.637109],[-86.771777,21.150537],[-87.034766,21.592236],[-88.466699,21.569385],[-90.353125,21.009424],[-90.739258,19.352246],[-91.43667,18.889795],[-91.275244,18.624463],[-91.533984,18.456543],[-92.441016,18.675293],[-94.459766,18.16665],[-95.181836,18.700732],[-95.920361,18.81958],[-97.186328,20.717041],[-97.753809,22.02666],[-97.40918,21.272559],[-97.314502,21.564209],[-97.84248,22.510303],[-97.667676,24.38999],[-97.14624,25.961475],[-99.107764,26.446924],[-99.505322,27.54834],[-101.440381,29.776855],[-102.614941,29.752344],[-103.168311,28.998193],[-104.110596,29.386133],[-104.978809,30.645947],[-106.44541,31.768408],[-108.211816,31.779346],[-108.214453,31.329443],[-111.041992,31.324219],[-114.835938,32.508301],[-114.724756,32.715332],[-117.128271,32.53335]]],[[[-115.170605,28.069385],[-115.233545,28.368359],[-115.35293,28.103955],[-115.170605,28.069385]]],[[[-112.203076,29.005322],[-112.423535,29.203662],[-112.514062,28.847607],[-112.278418,28.769336],[-112.203076,29.005322]]],[[[-112.057275,24.545703],[-112.159424,25.285645],[-112.296777,24.789648],[-112.057275,24.545703]]]]}},{type:"Feature",properties:{name:"毛里求斯",full_name:"毛里求斯共和国",iso_a2:"MU",iso_a3:"MUS",iso_n3:"480"},geometry:{type:"Polygon",coordinates:[[[57.65127,-20.484863],[57.656543,-19.989941],[57.317676,-20.427637],[57.65127,-20.484863]]]}},{type:"Feature",properties:{name:"毛里塔尼亚",full_name:"毛里塔尼亚伊斯兰共和国",iso_a2:"MR",iso_a3:"MRT",iso_n3:"478"},geometry:{type:"Polygon",coordinates:[[[-12.280615,14.809033],[-11.940918,14.886914],[-11.502686,15.636816],[-10.895605,15.150488],[-10.696582,15.422656],[-9.446924,15.458203],[-9.350586,15.677393],[-9.176807,15.496094],[-5.5125,15.496289],[-5.359912,16.282861],[-5.628662,16.568652],[-5.941016,19.296191],[-6.594092,24.994629],[-4.822607,24.995605],[-8.68335,27.285938],[-8.682227,25.995508],[-12.016309,25.99541],[-12.023438,23.467578],[-13.153271,22.820508],[-13.016211,21.333936],[-16.964551,21.329248],[-17.048047,20.806152],[-16.92793,21.114795],[-16.210449,20.22793],[-16.514453,19.361963],[-16.213086,19.00332],[-16.030322,17.887939],[-16.535254,15.838379],[-16.239014,16.531299],[-14.53374,16.655957],[-13.409668,16.05918],[-12.280615,14.809033]]]}},{type:"Feature",properties:{name:"马耳他",full_name:"马耳他共和国",iso_a2:"MT",iso_a3:"MLT",iso_n3:"470"},geometry:{type:"Polygon",coordinates:[[[14.566211,35.852734],[14.35127,35.978418],[14.436426,35.82168],[14.566211,35.852734]]]}},{type:"Feature",properties:{name:"马里",full_name:"马里共和国",iso_a2:"ML",iso_a3:"MLI",iso_n3:"466"},geometry:{type:"Polygon",coordinates:[[[-11.389404,12.404395],[-11.502197,12.198633],[-11.305176,12.01543],[-10.933203,12.205176],[-10.709229,11.89873],[-10.274854,12.212646],[-9.754004,12.029932],[-9.358105,12.25542],[-9.395361,12.464648],[-9.043066,12.402344],[-8.822021,11.673242],[-8.398535,11.366553],[-8.666699,11.009473],[-8.337402,10.990625],[-7.990625,10.1625],[-7.497949,10.439795],[-7.01709,10.143262],[-6.65415,10.656445],[-6.261133,10.724072],[-6.196875,10.232129],[-5.523535,10.426025],[-5.288135,11.82793],[-4.428711,12.337598],[-4.151025,13.306201],[-3.301758,13.280762],[-3.248633,13.65835],[-2.95083,13.648438],[-2.586719,14.227588],[-2.113232,14.168457],[-1.973047,14.456543],[-.760449,15.047754],[.21748,14.911475],[.947461,14.982129],[1.300195,15.272266],[3.504297,15.356348],[3.842969,15.701709],[4.234668,16.996387],[4.227637,19.142773],[3.119727,19.103174],[3.130273,19.850195],[1.685449,20.378369],[1.145508,21.102246],[-4.822607,24.995605],[-6.594092,24.994629],[-5.941016,19.296191],[-5.628662,16.568652],[-5.359912,16.282861],[-5.5125,15.496289],[-9.176807,15.496094],[-9.350586,15.677393],[-9.446924,15.458203],[-10.696582,15.422656],[-10.895605,15.150488],[-11.502686,15.636816],[-11.940918,14.886914],[-12.280615,14.809033],[-12.054199,13.633057],[-11.390381,12.941992],[-11.389404,12.404395]]]}},{type:"Feature",properties:{name:"马尔代夫",full_name:"马尔代夫共和国",iso_a2:"MV",iso_a3:"MDV",iso_n3:"462"},geometry:{type:"Polygon",coordinates:[[[73.512207,4.164551],[73.517773,4.247656],[73.473047,4.170703],[73.512207,4.164551]]]}},{type:"Feature",properties:{name:"马来西亚",full_name:"马来西亚",iso_a2:"MY",iso_a3:"MYS",iso_n3:"458"},geometry:{type:"MultiPolygon",coordinates:[[[[100.119141,6.441992],[100.71543,3.966211],[101.299902,3.253271],[101.295508,2.885205],[103.480273,1.329492],[103.694531,1.449658],[103.991504,1.454785],[103.981445,1.623633],[104.250098,1.388574],[103.812207,2.580469],[103.439453,2.933105],[103.41582,4.850293],[103.09707,5.408447],[102.101074,6.242236],[101.873633,5.825293],[101.556055,5.907764],[101.113965,5.636768],[101.053516,6.242578],[100.261426,6.682715],[100.119141,6.441992]]],[[[117.574414,4.170605],[118.54834,4.379248],[118.260547,4.988867],[118.9125,5.0229],[119.266309,5.308105],[118.353125,5.806055],[117.973633,5.70625],[118.003809,6.05332],[117.501172,5.884668],[117.69375,6.35],[117.229883,6.93999],[116.788086,6.606104],[116.749805,6.9771],[115.877148,5.613525],[115.419043,5.413184],[115.554492,5.093555],[115.140039,4.899756],[115.290625,4.352588],[115.026758,4.899707],[114.74668,4.718066],[114.654102,4.037646],[114.063867,4.592676],[112.987891,3.161914],[111.5125,2.743018],[111.028711,1.557812],[111.223242,1.39585],[109.864844,1.764453],[109.628906,2.027539],[109.654004,1.614893],[110.505762,.861963],[111.808984,1.01167],[112.476172,1.559082],[113.622266,1.235938],[114.5125,1.452002],[114.786426,2.250488],[115.179102,2.523193],[115.117578,2.894873],[115.454395,3.034326],[115.678809,4.193018],[116.514746,4.370801],[117.574414,4.170605]]],[[[99.848047,6.465723],[99.646289,6.418359],[99.74375,6.263281],[99.848047,6.465723]]]]}},{type:"Feature",properties:{name:"马拉维",full_name:"马拉维共和国",iso_a2:"MW",iso_a3:"MWI",iso_n3:"454"},geometry:{type:"Polygon",coordinates:[[[33.201758,-14.013379],[33.636426,-14.568164],[34.33252,-14.408594],[34.505273,-14.598145],[34.54082,-15.297266],[34.248242,-15.8875],[35.272559,-17.118457],[35.167188,-16.560254],[35.358496,-16.160547],[35.755273,-16.058301],[35.892773,-14.891797],[35.247461,-13.896875],[34.563672,-13.360156],[34.357813,-12.164746],[34.618555,-11.620215],[34.959473,-11.578125],[34.60791,-11.080469],[34.320898,-9.731543],[33.995605,-9.49541],[33.888867,-9.670117],[32.919922,-9.407422],[33.661523,-10.553125],[33.261328,-10.893359],[33.252344,-12.112598],[33.512305,-12.347754],[33.021582,-12.630469],[32.67041,-13.59043],[33.201758,-14.013379]]]}},{type:"Feature",properties:{name:"马达加斯加",full_name:"马达加斯加共和国",iso_a2:"MG",iso_a3:"MDG",iso_n3:"450"},geometry:{type:"MultiPolygon",coordinates:[[[[49.538281,-12.432129],[49.207031,-12.07959],[48.786328,-12.470898],[48.796484,-13.26748],[48.255273,-13.719336],[47.941016,-13.662402],[47.77334,-14.369922],[47.96416,-14.672559],[47.47832,-15.009375],[47.351953,-14.766113],[47.099219,-15.43418],[46.942285,-15.219043],[46.475098,-15.513477],[46.399609,-15.924609],[46.15752,-15.738281],[44.476172,-16.217285],[43.979395,-17.391602],[44.404688,-19.92207],[43.501855,-21.356445],[43.264844,-22.383594],[44.035352,-24.995703],[45.205762,-25.570508],[46.728516,-25.149902],[47.177344,-24.787207],[49.362891,-18.336328],[49.449316,-17.240625],[49.839063,-16.486523],[49.664355,-15.521582],[49.892578,-15.457715],[50.208984,-15.960449],[50.482715,-15.385645],[49.9375,-13.072266],[49.538281,-12.432129]]],[[[49.936426,-16.90293],[50.023047,-16.695312],[49.824023,-17.086523],[49.936426,-16.90293]]]]}},{type:"Feature",properties:{name:"北马其顿",full_name:"北马其顿共和国",iso_a2:"MK",iso_a3:"MKD",iso_n3:"807"},geometry:{type:"Polygon",coordinates:[[[21.5625,42.24751],[20.566211,41.873682],[20.488965,41.272607],[20.964258,40.849902],[22.916016,41.336279],[23.003613,41.739844],[22.344043,42.313965],[21.5625,42.24751]]]}},{type:"Feature",properties:{name:"卢森堡",full_name:"卢森堡大公国",iso_a2:"LU",iso_a3:"LUX",iso_n3:"442"},geometry:{type:"Polygon",coordinates:[[[6.116504,50.120996],[5.744043,49.919629],[5.789746,49.538281],[6.344336,49.452734],[6.487305,49.798486],[6.116504,50.120996]]]}},{type:"Feature",properties:{name:"立陶宛",full_name:"立陶宛共和国",iso_a2:"LT",iso_a3:"LTU",iso_n3:"440"},geometry:{type:"MultiPolygon",coordinates:[[[[20.957813,55.278906],[21.114844,55.616504],[20.899805,55.28667],[20.957813,55.278906]]],[[[22.766211,54.356787],[23.484668,53.939795],[24.317969,53.892969],[25.461133,54.292773],[25.749219,54.156982],[25.780859,54.833252],[26.775684,55.273096],[26.457617,55.34248],[26.593555,55.667529],[24.841016,56.411182],[24.120703,56.264258],[22.08457,56.406738],[21.046094,56.070068],[21.235742,55.264111],[22.567285,55.059131],[22.766211,54.356787]]]]}},{type:"Feature",properties:{name:"列支敦士登",full_name:"列支敦士登公国",iso_a2:"LI",iso_a3:"LIE",iso_n3:"438"},geometry:{type:"Polygon",coordinates:[[[9.580273,47.057373],[9.527539,47.270752],[9.487695,47.062256],[9.580273,47.057373]]]}},{type:"Feature",properties:{name:"利比亚",full_name:"利比亚国",iso_a2:"LY",iso_a3:"LBY",iso_n3:"434"},geometry:{type:"Polygon",coordinates:[[[9.51875,30.229395],[9.310254,30.115234],[9.805273,29.176953],[9.916016,27.785693],[9.883203,26.630811],[9.448242,26.067139],[10.255859,24.591016],[11.507617,24.314355],[11.967871,23.517871],[13.48125,23.180176],[14.215527,22.619678],[14.979004,22.996191],[15.984082,23.445215],[20.147656,21.389258],[23.980273,19.496631],[23.980273,19.995947],[24.979492,20.002588],[24.980273,21.99585],[24.980273,29.181885],[24.703223,30.201074],[24.961426,30.678516],[24.852734,31.334814],[25.150488,31.65498],[24.878516,31.984277],[23.286328,32.213818],[23.090625,32.61875],[21.635938,32.937305],[20.121484,32.21875],[19.926367,31.817529],[20.111523,30.963721],[19.713281,30.488379],[19.12373,30.266113],[17.830469,30.927588],[15.705957,31.426416],[15.176563,32.391162],[13.283496,32.914648],[12.279883,32.858545],[11.50459,33.181934],[11.50498,32.413672],[10.274609,31.684961],[10.216406,30.783203],[9.51875,30.229395]]]}},{type:"Feature",properties:{name:"利比里亚",full_name:"利比里亚共和国",iso_a2:"LR",iso_a3:"LBR",iso_n3:"430"},geometry:{type:"Polygon",coordinates:[[[-11.50752,6.906543],[-9.132178,5.054639],[-7.544971,4.351318],[-7.454395,5.841309],[-8.603564,6.507812],[-8.302344,6.980957],[-8.486426,7.558496],[-8.659766,7.688379],[-9.117578,7.215918],[-9.463818,7.415869],[-9.518262,8.346094],[-10.283203,8.485156],[-10.647461,7.759375],[-11.50752,6.906543]]]}},{type:"Feature",properties:{name:"莱索托",full_name:"莱索托王国",iso_a2:"LS",iso_a3:"LSO",iso_n3:"426"},geometry:{type:"Polygon",coordinates:[[[28.736914,-30.101953],[29.098047,-29.919043],[29.390723,-29.269727],[28.625781,-28.581738],[27.735547,-28.940039],[27.056934,-29.625586],[27.753125,-30.6],[28.056836,-30.631055],[28.39209,-30.147559],[28.736914,-30.101953]]]}},{type:"Feature",properties:{name:"黎巴嫩",full_name:"黎巴嫩共和国",iso_a2:"LB",iso_a3:"LBN",iso_n3:"422"},geometry:{type:"Polygon",coordinates:[[[35.97627,34.629199],[35.108594,33.083691],[35.840723,33.415674],[35.869141,33.431738],[36.584961,34.22124],[36.383887,34.65791],[35.97627,34.629199]]]}},{type:"Feature",properties:{name:"拉脱维亚",full_name:"拉脱维亚共和国",iso_a2:"LV",iso_a3:"LVA",iso_n3:"428"},geometry:{type:"Polygon",coordinates:[[[26.593555,55.667529],[27.576758,55.798779],[28.147949,56.14292],[27.639453,56.845654],[27.828613,57.293311],[27.351953,57.528125],[26.462109,57.544482],[25.282617,58.048486],[24.322559,57.870605],[24.382617,57.250049],[23.647754,56.971045],[22.55459,57.724268],[21.728711,57.570996],[21.071289,56.82373],[21.046094,56.070068],[22.08457,56.406738],[24.120703,56.264258],[24.841016,56.411182],[26.593555,55.667529]]]}},{type:"Feature",properties:{name:"老挝",full_name:"老挝人民民主共和国",iso_a2:"LA",iso_a3:"LAO",iso_n3:"418"},geometry:{type:"Polygon",coordinates:[[[102.127441,22.379199],[101.73877,22.495264],[101.524512,22.253662],[101.800586,21.212598],[101.247852,21.197314],[101.138867,21.56748],[100.703125,21.251367],[100.622949,20.85957],[100.249316,20.730273],[100.122461,20.31665],[100.519531,20.17793],[100.513574,19.553467],[101.211914,19.54834],[100.955859,17.541113],[102.101465,18.210645],[102.680078,17.824121],[103.366992,18.42334],[103.949609,18.318994],[104.739648,17.46167],[104.819336,16.466064],[105.641016,15.656543],[105.497363,14.590674],[105.183301,14.34624],[106.066797,13.921191],[105.978906,14.343018],[106.501465,14.578223],[106.938086,14.327344],[107.519434,14.705078],[107.653125,15.255225],[107.165918,15.80249],[107.396387,16.043018],[106.656445,16.492627],[106.502246,16.954102],[105.114551,18.405273],[105.146484,18.650977],[103.891602,19.30498],[104.032031,19.675146],[104.587891,19.61875],[104.92793,20.018115],[104.367773,20.441406],[104.583203,20.64668],[104.101367,20.945508],[103.635059,20.69707],[103.104492,20.89165],[102.851172,21.265918],[102.949609,21.681348],[102.662012,21.676025],[102.127441,22.379199]]]}},{type:"Feature",properties:{name:"吉尔吉斯斯坦",full_name:"吉尔吉斯共和国",iso_a2:"KG",iso_a3:"KGZ",iso_n3:"417"},geometry:{type:"Polygon",coordinates:[[[70.958008,40.238867],[70.515137,39.949902],[69.966797,40.202246],[69.530273,40.097314],[69.297656,39.524805],[70.501172,39.587354],[70.799316,39.394727],[71.470312,39.603662],[72.22998,39.20752],[73.631641,39.448877],[73.991602,40.043115],[74.835156,40.482617],[75.555566,40.625195],[75.677148,40.305811],[76.318555,40.352246],[76.907715,41.02417],[78.123438,41.075635],[80.209375,42.190039],[79.12666,42.775732],[75.366211,42.836963],[74.209082,43.240381],[73.55625,43.002783],[73.492969,42.409033],[71.760547,42.821484],[71.256641,42.733545],[70.946777,42.248682],[71.228516,42.162891],[70.200879,41.514453],[71.393066,41.123389],[71.664941,41.541211],[72.187305,41.025928],[73.136914,40.810645],[71.69248,40.152344],[70.958008,40.238867]]]}},{type:"Feature",properties:{name:"科威特",full_name:"科威特国",iso_a2:"KW",iso_a3:"KWT",iso_n3:"414"},geometry:{type:"Polygon",coordinates:[[[48.44248,28.54292],[48.051465,29.355371],[47.722656,29.393018],[48.143457,29.572461],[47.978711,29.982812],[47.148242,30.000977],[46.531445,29.09624],[47.433203,28.989551],[47.671289,28.533154],[48.44248,28.54292]]]}},{type:"Feature",properties:{name:"基里巴斯",full_name:"基里巴斯共和国",iso_a2:"KI",iso_a3:"KIR",iso_n3:"296"},geometry:{type:"Polygon",coordinates:[[[-157.342139,1.855566],[-157.578955,1.902051],[-157.175781,1.739844],[-157.342139,1.855566]]]}},{type:"Feature",properties:{name:"肯尼亚",full_name:"肯尼亚共和国",iso_a2:"KE",iso_a3:"KEN",iso_n3:"404"},geometry:{type:"Polygon",coordinates:[[[33.903223,-1.002051],[37.643848,-3.04541],[37.608203,-3.49707],[39.221777,-4.692383],[40.11543,-3.250586],[40.222461,-2.688379],[41.532715,-1.695312],[40.978711,-.870313],[40.964453,2.814648],[41.883984,3.977734],[41.14043,3.962988],[40.765234,4.273047],[39.494434,3.456104],[38.086133,3.648828],[36.905566,4.411475],[36.021973,4.468115],[35.74502,5.343994],[35.268359,5.492285],[33.976074,4.220215],[34.437695,3.650586],[34.978223,1.773633],[33.943164,.173779],[33.903223,-1.002051]]]}},{type:"Feature",properties:{name:"哈萨克斯坦",full_name:"哈萨克斯坦共和国",iso_a2:"KZ",iso_a3:"KAZ",iso_n3:"398"},geometry:{type:"Polygon",coordinates:[[[70.946777,42.248682],[71.256641,42.733545],[71.760547,42.821484],[73.492969,42.409033],[73.55625,43.002783],[74.209082,43.240381],[75.366211,42.836963],[79.12666,42.775732],[80.209375,42.190039],[80.202246,42.734473],[80.785742,43.161572],[80.355273,44.097266],[80.481543,44.714648],[79.871875,44.883789],[81.691992,45.349365],[82.521484,45.125488],[82.315234,45.594922],[83.029492,47.185938],[84.786133,46.830713],[85.484766,47.063525],[85.749414,48.385059],[86.549414,48.528613],[86.808301,49.049707],[87.322852,49.085791],[86.675488,49.777295],[86.180859,49.499316],[85.232617,49.61582],[84.989453,50.061426],[84.323242,50.23916],[83.357324,50.99458],[82.493945,50.727588],[81.465918,50.739844],[80.735254,51.293408],[79.98623,50.774561],[77.859961,53.269189],[76.484766,54.022559],[76.837305,54.442383],[74.351562,53.487646],[73.858984,53.619727],[73.406934,53.447559],[73.712402,54.042383],[72.622266,54.134326],[72.446777,53.941846],[72.186035,54.325635],[71.093164,54.212207],[70.738086,55.305176],[70.182422,55.162451],[68.977246,55.3896],[68.155859,54.976709],[65.476953,54.623291],[65.088379,54.340186],[61.231055,54.019482],[60.979492,53.621729],[61.534961,53.523291],[61.199219,53.287158],[62.082715,53.00542],[61.047461,52.972461],[60.774414,52.675781],[60.994531,52.336865],[60.030273,51.933252],[61.554688,51.324609],[61.389453,50.861035],[60.942285,50.695508],[60.058594,50.850293],[59.523047,50.492871],[57.838867,51.09165],[57.442188,50.888867],[56.491406,51.019531],[55.68623,50.582861],[54.641602,51.011572],[54.555273,50.535791],[53.338086,51.482373],[52.219141,51.709375],[51.344531,51.475342],[50.793945,51.729199],[48.625098,50.612695],[48.758984,49.92832],[48.334961,49.858252],[47.429199,50.357959],[46.889551,49.696973],[47.031348,49.150293],[46.660938,48.412256],[47.292383,47.740918],[48.166992,47.708789],[48.959375,46.774609],[48.541211,46.605615],[49.232227,46.337158],[51.178027,47.110156],[52.138281,46.828613],[52.483203,46.990674],[53.069434,46.856055],[53.135254,46.19165],[52.773828,45.572754],[53.200391,45.331982],[51.415723,45.357861],[51.009375,44.921826],[51.543555,44.531006],[50.409473,44.624023],[50.25293,44.461523],[50.830762,44.192773],[51.29541,43.174121],[52.596582,42.760156],[52.493848,41.780371],[53.055859,42.147754],[54.120996,42.335205],[55.434375,41.296289],[55.977441,41.322217],[55.975684,44.994922],[58.555273,45.555371],[61.00791,44.393799],[61.990234,43.492139],[64.905469,43.714697],[65.803027,42.876953],[66.100293,42.99082],[66.00957,42.004883],[66.498633,41.994873],[66.709668,41.17915],[67.935742,41.196582],[68.291895,40.656104],[68.572656,40.622656],[69.153613,41.425244],[70.946777,42.248682]]]}},{type:"Feature",properties:{name:"约旦",full_name:"约旦哈希姆王国",iso_a2:"JO",iso_a3:"JOR",iso_n3:"400"},geometry:{type:"Polygon",coordinates:[[[35.787305,32.734912],[35.551465,32.395508],[35.450586,31.479297],[34.973438,29.555029],[34.950781,29.353516],[36.068457,29.200537],[36.755273,29.866016],[37.469238,29.995068],[37.980078,30.5],[36.958594,31.491504],[39.14541,32.124512],[38.773535,33.372217],[36.818359,32.317285],[35.787305,32.734912]]]}},{type:"Feature",properties:{name:"日本",full_name:"日本国",iso_a2:"JP",iso_a3:"JPN",iso_n3:"392"},geometry:{type:"MultiPolygon",coordinates:[[[[134.932812,34.288135],[135.004688,34.544043],[134.667871,34.294141],[134.932812,34.288135]]],[[[143.824316,44.116992],[141.937695,45.509521],[141.667969,45.40127],[141.760938,44.48252],[141.374121,43.279639],[140.392383,43.303125],[140.432227,42.954102],[139.860156,42.581738],[140.085156,41.434082],[140.659863,41.815576],[141.150977,41.805078],[140.32666,42.293359],[140.480469,42.559375],[140.986133,42.342139],[141.851367,42.579053],[143.236523,42.000195],[143.969336,42.881396],[145.833008,43.385938],[145.34082,43.302539],[145.139648,43.6625],[145.369531,44.327393],[144.715234,43.927979],[143.824316,44.116992]]],[[[131.174609,33.602588],[130.715625,33.927783],[129.580078,33.236279],[129.991699,32.851562],[129.679102,33.059961],[129.768555,32.570996],[130.34043,32.701855],[130.2375,33.177637],[130.547266,32.831592],[130.147266,31.408496],[130.58877,31.178516],[130.77627,31.706299],[130.685742,31.015137],[131.070801,31.436865],[131.337207,31.404688],[132.002148,32.882373],[131.896582,33.25459],[131.537402,33.274072],[131.696289,33.602832],[131.174609,33.602588]]],[[[134.357422,34.256348],[133.94834,34.348047],[133.193066,33.933203],[132.935156,34.095312],[132.032617,33.33999],[132.412793,33.430469],[132.495117,32.916602],[132.804297,32.752002],[133.632031,33.510986],[134.181641,33.247217],[134.738867,33.820508],[134.6375,34.226611],[134.357422,34.256348]]],[[[141.229297,41.372656],[140.936914,41.505566],[140.801855,41.253662],[141.244238,41.205615],[141.118555,40.882275],[140.748633,40.830322],[140.627637,41.19541],[140.344434,41.20332],[139.741504,39.92085],[140.064746,39.624414],[139.801953,38.881592],[139.363867,38.099023],[138.319922,37.218408],[137.246289,36.753174],[136.899902,37.117676],[137.322656,37.52207],[136.843457,37.382129],[135.903125,35.606885],[135.326953,35.525537],[135.174316,35.74707],[132.922949,35.511279],[131.354395,34.413184],[131.004199,34.392578],[130.918848,33.975732],[131.740527,34.052051],[132.146484,33.83877],[132.312598,34.324951],[133.142383,34.302441],[134.740039,34.765234],[135.415918,34.61748],[135.12793,34.006982],[135.695312,33.486963],[136.329883,34.176855],[136.853711,34.324072],[136.533008,34.678369],[136.804199,35.050293],[136.871289,34.733105],[137.275195,34.77251],[137.061719,34.582812],[138.189063,34.596338],[138.719629,35.124072],[138.8375,34.619238],[139.249414,35.278027],[139.675,35.149268],[139.834766,35.658057],[140.096875,35.585156],[139.843945,34.914893],[140.354688,35.181445],[140.874023,35.724951],[140.573535,36.231348],[141.00166,37.114648],[140.962109,38.148877],[141.46748,38.40415],[141.976953,39.428809],[141.430469,40.72334],[141.455469,41.404736],[141.229297,41.372656]]],[[[128.258789,26.652783],[128.254883,26.881885],[127.907227,26.693604],[127.653125,26.094727],[128.258789,26.652783]]],[[[129.452539,28.208984],[129.689551,28.51748],[129.164648,28.249756],[129.452539,28.208984]]]]}},{type:"Feature",properties:{name:"牙买加",full_name:"牙买加",iso_a2:"JM",iso_a3:"JAM",iso_n3:"388"},geometry:{type:"Polygon",coordinates:[[[-77.261475,18.457422],[-77.873438,18.522217],[-78.339502,18.287207],[-77.20498,17.714941],[-76.853223,17.97373],[-76.210791,17.913525],[-77.261475,18.457422]]]}},{type:"Feature",properties:{name:"意大利",full_name:"意大利共和国",iso_a2:"IT",iso_a3:"ITA",iso_n3:"380"},geometry:{type:"MultiPolygon",coordinates:[[[[7.021094,45.925781],[6.790918,45.740869],[7.146387,45.381738],[6.634766,45.068164],[6.992676,44.827295],[6.900195,44.335742],[7.637207,44.164844],[7.493164,43.767139],[8.76582,44.422314],[10.188086,43.94751],[10.514844,42.967529],[11.141211,42.389893],[15.692773,39.990186],[16.209961,38.941113],[15.645801,38.034229],[16.056836,37.941846],[16.616699,38.800146],[17.174609,38.998096],[17.114551,39.380615],[16.521875,39.747559],[16.928223,40.458057],[17.865039,40.280176],[18.34375,39.821387],[18.460645,40.221045],[15.900488,41.512061],[16.164648,41.896191],[15.16875,41.934033],[14.540723,42.244287],[13.56416,43.571289],[12.396289,44.223877],[12.274316,45.446045],[13.206348,45.771387],[13.719824,45.587598],[13.378223,46.261621],[13.7,46.520264],[12.388281,46.702637],[12.169434,47.082129],[10.993262,46.777002],[10.452832,46.864941],[10.12832,46.238232],[9.260156,46.475195],[9.02373,45.845703],[8.422559,46.446045],[7.787891,45.921826],[7.021094,45.925781]],[[12.43916,41.898389],[12.430566,41.897559],[12.430566,41.905469],[12.43916,41.898389]],[[12.485254,43.901416],[12.396875,43.93457],[12.503711,43.989746],[12.485254,43.901416]]],[[[15.576563,38.220312],[13.788867,37.981201],[12.734375,38.183057],[12.435547,37.819775],[15.112598,36.687842],[15.295703,37.055176],[15.099512,37.458594],[15.576563,38.220312]]],[[[9.632031,40.882031],[9.228418,41.25708],[8.571875,40.850195],[8.224219,40.91333],[8.648535,38.926562],[9.056348,39.23916],[9.5625,39.166016],[9.632031,40.882031]]]]}},{type:"Feature",properties:{name:"以色列",full_name:"以色列国",iso_a2:"IL",iso_a3:"ISR",iso_n3:"376"},geometry:{type:"Polygon",coordinates:[[[35.840723,33.415674],[35.108594,33.083691],[34.477344,31.584863],[34.245313,31.208301],[34.904297,29.477344],[34.973438,29.555029],[35.450586,31.479297],[34.872754,31.396875],[35.203711,31.75],[34.953809,31.84126],[35.065039,32.460449],[35.551465,32.395508],[35.787305,32.734912],[35.816125,33.361879],[35.840723,33.415674]]]}},{type:"Feature",properties:{name:"巴勒斯坦",full_name:"巴勒斯坦国",iso_a2:"PS",iso_a3:"PSE",iso_n3:"275"},geometry:{type:"MultiPolygon",coordinates:[[[[34.477344,31.584863],[34.198145,31.322607],[34.245313,31.208301],[34.477344,31.584863]]],[[[35.551465,32.395508],[35.065039,32.460449],[34.953809,31.84126],[35.203711,31.75],[34.872754,31.396875],[35.450586,31.479297],[35.551465,32.395508]]]]}},{type:"Feature",properties:{name:"爱尔兰",full_name:"爱尔兰",iso_a2:"IE",iso_a3:"IRL",iso_n3:"372"},geometry:{type:"Polygon",coordinates:[[[-7.218652,55.091992],[-6.96167,55.237891],[-7.308789,55.36582],[-7.65874,54.970947],[-7.66709,55.256494],[-8.274609,55.146289],[-8.763916,54.681201],[-8.133447,54.64082],[-8.545557,54.241211],[-10.056396,54.257812],[-9.578223,53.80542],[-10.09126,53.412842],[-8.930127,53.20708],[-9.916602,52.569727],[-8.783447,52.679639],[-10.356689,52.206934],[-9.909668,52.122949],[-10.341064,51.798926],[-9.598828,51.874414],[-10.120752,51.600684],[-8.813428,51.584912],[-8.40918,51.88877],[-6.325,52.24668],[-6.027393,52.9271],[-6.218018,54.088721],[-6.649805,54.058643],[-7.007715,54.406689],[-7.606543,54.143848],[-8.118262,54.414258],[-7.218652,55.091992]]]}},{type:"Feature",properties:{name:"伊拉克",full_name:"伊拉克共和国",iso_a2:"IQ",iso_a3:"IRQ",iso_n3:"368"},geometry:{type:"Polygon",coordinates:[[[42.358984,37.108594],[41.295996,36.38335],[40.987012,34.429053],[38.773535,33.372217],[39.14541,32.124512],[40.369336,31.938965],[42.074414,31.080371],[44.69082,29.202344],[46.531445,29.09624],[47.148242,30.000977],[47.978711,29.982812],[48.546484,29.962354],[48.014941,30.465625],[48.010645,30.989795],[47.679492,31.002393],[47.82998,31.794434],[47.371289,32.42373],[46.112793,32.957666],[46.019922,33.415723],[45.39707,33.97085],[46.273438,35.773242],[45.361621,36.015332],[44.765137,37.142432],[44.281836,36.978027],[44.114453,37.301855],[42.774609,37.371875],[42.358984,37.108594]]]}},{type:"Feature",properties:{name:"伊朗",full_name:"伊朗伊斯兰共和国",iso_a2:"IR",iso_a3:"IRN",iso_n3:"364"},geometry:{type:"MultiPolygon",coordinates:[[[[56.187988,26.921143],[55.757617,26.947656],[55.762598,26.811963],[55.311523,26.592627],[56.187988,26.921143]]],[[[53.91416,37.343555],[53.970117,36.818311],[52.190137,36.621729],[51.118555,36.742578],[50.130469,37.407129],[49.171191,37.600586],[48.86875,38.435498],[47.996484,38.85376],[48.322168,39.399072],[47.995898,39.683936],[46.490625,38.906689],[46.114453,38.877783],[45.479688,39.00625],[44.817188,39.650439],[44.587109,39.768555],[44.389355,39.422119],[44.023242,39.377441],[44.449902,38.334229],[44.211328,37.908057],[44.589941,37.710352],[44.765137,37.142432],[45.361621,36.015332],[46.273438,35.773242],[45.39707,33.97085],[46.019922,33.415723],[46.112793,32.957666],[47.371289,32.42373],[47.82998,31.794434],[47.679492,31.002393],[48.010645,30.989795],[48.014941,30.465625],[48.546484,29.962354],[48.919141,30.120898],[49.001953,30.506543],[49.554883,30.028955],[50.071582,30.198535],[51.278906,28.131348],[53.705762,26.725586],[54.759277,26.505078],[55.424023,26.770557],[55.650293,26.977539],[56.356152,27.200244],[56.982227,26.905469],[57.33457,25.791553],[59.046094,25.417285],[61.587891,25.202344],[61.842383,26.225928],[63.157812,26.649756],[63.301563,27.151465],[62.762988,27.250195],[62.758008,28.243555],[61.889844,28.546533],[60.843359,29.858691],[61.81084,30.913281],[61.660156,31.382422],[60.820703,31.495166],[60.561914,33.058789],[60.916992,33.505225],[60.51084,33.638916],[60.485742,34.094775],[60.889453,34.319434],[60.72627,34.518262],[61.262012,35.61958],[61.119629,36.642578],[60.341309,36.637646],[59.301758,37.510645],[58.261621,37.66582],[57.193555,38.216406],[55.380859,38.051123],[54.699414,37.470166],[53.91416,37.343555]]]]}},{type:"Feature",properties:{name:"印度尼西亚",full_name:"印度尼西亚共和国",iso_a2:"ID",iso_a3:"IDN",iso_n3:"360"},geometry:{type:"MultiPolygon",coordinates:[[[[97.481543,1.465088],[97.079199,1.425488],[97.82041,.564453],[97.931934,.973926],[97.481543,1.465088]]],[[[99.163867,-1.77793],[98.932617,-.954004],[98.676074,-.970508],[98.827734,-1.609961],[99.163867,-1.77793]]],[[[116.64082,-8.613867],[116.718945,-8.336035],[116.401563,-8.204199],[115.857324,-8.787891],[116.586523,-8.886133],[116.64082,-8.613867]]],[[[115.447852,-8.155176],[114.467578,-8.166309],[115.055078,-8.573047],[115.144922,-8.849023],[115.704297,-8.407129],[115.447852,-8.155176]]],[[[106.045703,-1.669434],[105.45957,-1.574707],[105.133398,-2.042578],[105.78584,-2.181348],[105.99873,-2.824902],[106.667188,-3.071777],[106.818457,-2.57334],[106.365918,-2.464844],[106.045703,-1.669434]]],[[[123.179785,-4.551172],[123.074609,-4.386914],[122.85332,-4.618359],[122.64502,-5.663379],[123.187305,-5.333008],[122.97168,-5.138477],[123.179785,-4.551172]]],[[[122.645117,-5.269434],[122.701953,-4.618652],[122.368945,-4.767188],[122.283105,-5.319531],[122.645117,-5.269434]]],[[[108.316016,3.689648],[108.24834,4.217139],[108.002344,3.982861],[108.316016,3.689648]]],[[[108.207227,-2.997656],[108.215137,-2.696973],[107.666309,-2.566309],[107.614453,-3.209375],[108.055273,-3.226855],[108.207227,-2.997656]]],[[[135.383008,-.651367],[135.915039,-1.178418],[136.375293,-1.094043],[135.383008,-.651367]]],[[[135.474219,-1.591797],[136.228125,-1.893652],[136.892578,-1.799707],[135.474219,-1.591797]]],[[[130.813281,-.004102],[130.236621,-.209668],[130.750195,-.443848],[130.899219,-.344434],[130.622168,-.085938],[131.005371,-.360742],[131.339746,-.290332],[130.813281,-.004102]]],[[[128.453906,2.051758],[128.602148,2.597607],[128.217969,2.297461],[128.453906,2.051758]]],[[[128.153027,-1.660547],[127.64668,-1.332422],[127.39502,-1.589844],[128.153027,-1.660547]]],[[[126.024219,-1.789746],[125.387207,-1.843066],[126.331738,-1.822852],[126.024219,-1.789746]]],[[[124.969531,-1.705469],[124.417578,-1.659277],[124.329688,-1.858887],[125.314063,-1.877148],[124.969531,-1.705469]]],[[[131.325586,-7.999512],[131.624414,-7.626172],[131.643457,-7.112793],[131.137793,-7.684863],[131.11377,-7.997363],[131.325586,-7.999512]]],[[[126.800977,-7.667871],[125.975293,-7.663379],[125.798242,-7.98457],[126.47207,-7.950391],[126.800977,-7.667871]]],[[[124.575586,-8.14082],[124.380664,-8.415137],[125.131738,-8.326465],[124.575586,-8.14082]]],[[[131.001855,-1.315527],[131.033008,-.917578],[130.672949,-.959766],[131.001855,-1.315527]]],[[[96.492578,5.229346],[95.227832,5.564795],[95.578613,4.661963],[96.968945,3.575146],[97.59082,2.846582],[97.700781,2.358545],[98.595313,1.8646],[99.15918,.351758],[99.669824,.045068],[100.308203,-.82666],[100.889551,-2.248535],[101.578613,-3.166992],[104.601562,-5.90459],[104.639551,-5.52041],[105.081348,-5.745508],[105.349414,-5.549512],[105.74834,-5.818262],[106.044336,-3.10625],[105.396973,-2.380176],[104.650781,-2.595215],[104.845215,-2.092969],[104.515918,-1.819434],[104.360547,-1.038379],[103.721094,-.886719],[103.438574,-.575586],[103.428516,-.191797],[103.786719,.046973],[103.672656,.288916],[103.338965,.513721],[102.55,.216455],[103.031836,.578906],[102.389941,.841992],[102.019922,1.442139],[101.47666,1.693066],[101.046191,2.257471],[100.828223,2.242578],[100.887891,1.948242],[100.523828,2.18916],[99.732324,3.183057],[98.307324,4.092871],[97.547168,5.205859],[96.492578,5.229346]]],[[[122.78291,-8.611719],[122.916992,-8.105566],[122.323242,-8.62832],[120.610254,-8.24043],[119.874805,-8.419824],[119.80791,-8.697656],[121.035254,-8.935449],[122.78291,-8.611719]]],[[[120.0125,-9.374707],[118.958789,-9.519336],[120.144824,-10.200098],[120.698047,-10.206641],[120.784473,-9.957031],[120.0125,-9.374707]]],[[[118.242383,-8.317773],[117.755273,-8.149512],[118.234863,-8.591895],[117.969531,-8.728027],[117.164844,-8.367188],[116.835059,-8.532422],[116.788477,-9.006348],[119.129687,-8.668164],[118.926172,-8.297656],[118.242383,-8.317773]]],[[[124.888867,.995312],[125.233789,1.502295],[125.110938,1.685693],[123.930762,.850439],[122.838281,.845703],[121.081738,1.327637],[120.602539,.854395],[120.269531,.970801],[119.721875,-.088477],[119.844336,-.861914],[119.711328,-.680762],[119.508203,-.906738],[119.321875,-1.929688],[118.783301,-2.720801],[118.867676,-3.398047],[119.46748,-3.512988],[119.623633,-4.034375],[119.360352,-5.31416],[119.557422,-5.611035],[120.430371,-5.591016],[120.261035,-2.949316],[120.653613,-2.667578],[121.052148,-2.75166],[120.891797,-3.520605],[121.618066,-4.092676],[121.588672,-4.75957],[122.038086,-4.832422],[122.114258,-4.540234],[122.872266,-4.391992],[122.847949,-4.064551],[122.25293,-3.62041],[122.291699,-2.907617],[121.355469,-1.878223],[122.250684,-1.555273],[122.902832,-.900977],[123.37793,-1.004102],[123.43418,-.778223],[123.171484,-.570703],[121.969629,-.933301],[121.575586,-.828516],[121.148535,-1.339453],[120.667383,-1.370117],[120.062891,-.555566],[120.192285,.268506],[120.579004,.52832],[123.753809,.305518],[124.427539,.470605],[124.888867,.995312]]],[[[107.373926,-6.007617],[106.075,-5.91416],[105.255469,-6.835254],[106.198242,-6.927832],[106.519727,-7.053711],[106.455273,-7.368652],[107.91748,-7.724121],[109.281641,-7.704883],[111.509961,-8.305078],[113.25332,-8.286719],[114.583789,-8.769629],[114.386914,-8.405176],[114.409277,-7.79248],[113.013574,-7.657715],[112.539258,-6.926465],[111.181543,-6.686719],[110.834766,-6.424219],[110.42627,-6.947266],[108.677832,-6.790527],[108.330176,-6.286035],[107.373926,-6.007617]]],[[[109.628906,2.027539],[109.075879,1.495898],[108.944531,.355664],[109.25752,.031152],[109.258789,-.807422],[109.983301,-1.274805],[110.256055,-2.966113],[111.694727,-2.889453],[111.858105,-3.551855],[112.758008,-3.322168],[113.033984,-2.933496],[113.705078,-3.455273],[114.344336,-3.235156],[114.693555,-4.169727],[115.956152,-3.59502],[116.257227,-3.126367],[116.166309,-2.93457],[116.56543,-2.299707],[116.275488,-1.784863],[116.753418,-1.327344],[116.739844,-1.044238],[116.913965,-1.223633],[117.5625,-.770898],[117.522168,.235889],[117.911621,1.098682],[118.534766,.813525],[118.984961,.982129],[117.789258,2.026855],[118.066602,2.317822],[117.055957,3.622656],[117.777246,3.689258],[117.574414,4.170605],[116.514746,4.370801],[115.678809,4.193018],[115.454395,3.034326],[115.117578,2.894873],[115.179102,2.523193],[114.786426,2.250488],[114.5125,1.452002],[113.622266,1.235938],[112.476172,1.559082],[111.808984,1.01167],[110.505762,.861963],[109.654004,1.614893],[109.628906,2.027539]]],[[[127.732715,.848145],[127.652832,1.013867],[128.011719,1.331738],[128.036426,2.199023],[127.631738,1.843701],[127.428516,1.13999],[127.691602,-.241895],[128.425488,-.892676],[127.887402,.29834],[127.983105,.471875],[128.899609,.21626],[128.260645,.733789],[128.702637,1.106396],[128.688379,1.572559],[127.732715,.848145]]],[[[129.754688,-2.86582],[128.198535,-2.865918],[127.902344,-3.496289],[128.132031,-3.157422],[128.516602,-3.449121],[128.8625,-3.234961],[129.467676,-3.453223],[129.844141,-3.327148],[130.805078,-3.857715],[130.569922,-3.130859],[129.754688,-2.86582]]],[[[126.861133,-3.087891],[126.088281,-3.105469],[126.056543,-3.420996],[126.686328,-3.823633],[127.22959,-3.633008],[126.861133,-3.087891]]],[[[124.922266,-8.94248],[124.444434,-9.190332],[124.282324,-9.42793],[124.036328,-9.341602],[123.589258,-9.966797],[123.747266,-10.347168],[124.427539,-10.148633],[125.068164,-9.511914],[124.960156,-9.21377],[125.149023,-9.042578],[124.922266,-8.94248]]],[[[134.746973,-5.707031],[134.570801,-5.427344],[134.205371,-5.707227],[134.343066,-5.833008],[134.154883,-6.062891],[134.441113,-6.334863],[134.71416,-6.295117],[134.746973,-5.707031]]],[[[134.536816,-6.442285],[134.114648,-6.19082],[134.09082,-6.833789],[134.322754,-6.84873],[134.536816,-6.442285]]],[[[138.535352,-8.273633],[138.989063,-7.696094],[138.769824,-7.39043],[138.081836,-7.566211],[137.650391,-8.386133],[138.535352,-8.273633]]],[[[140.973438,-2.609766],[139.789551,-2.348242],[137.80625,-1.483203],[137.123438,-1.840918],[137.07207,-2.105078],[136.389941,-2.27334],[135.85918,-2.995313],[135.251563,-3.368555],[134.886816,-3.209863],[134.627441,-2.536719],[134.459961,-2.832324],[134.194824,-2.309082],[134.25957,-1.362988],[133.974512,-.744336],[132.39375,-.355469],[131.257227,-.855469],[130.995898,-1.424707],[131.930371,-1.559668],[132.307617,-2.242285],[133.921582,-2.102051],[133.700098,-2.624609],[133.191016,-2.437793],[132.725,-2.789062],[131.971191,-2.788574],[132.751367,-3.294629],[132.914453,-4.056934],[133.400879,-3.899023],[133.841504,-3.054785],[133.67832,-3.479492],[133.973828,-3.817969],[134.886523,-3.938477],[134.679688,-4.079102],[135.195605,-4.450684],[137.279785,-4.94541],[138.06084,-5.465234],[138.087109,-5.70918],[138.339648,-5.675684],[138.199609,-5.807031],[138.864551,-6.858398],[138.601367,-6.936523],[139.176855,-7.19043],[138.747949,-7.251465],[139.087988,-7.587207],[138.890625,-8.237793],[139.248828,-7.982422],[139.385645,-8.189062],[140.116992,-7.92373],[140.00293,-8.195508],[140.976172,-9.11875],[140.973438,-2.609766]]],[[[138.895117,-8.388672],[138.796191,-8.173633],[138.563379,-8.309082],[138.895117,-8.388672]]],[[[101.708105,2.078418],[101.409668,2.02168],[101.500781,1.733203],[101.719434,1.78916],[101.708105,2.078418]]],[[[103.027539,.746631],[102.506641,1.08877],[102.49043,.856641],[103.027539,.746631]]],[[[104.585352,1.216113],[104.251953,1.014893],[104.575195,.831934],[104.585352,1.216113]]],[[[104.778613,-.175977],[104.542676,.017725],[104.44707,-.18916],[105.005371,-.282812],[104.778613,-.175977]]],[[[104.474219,-.334668],[104.257129,-.463281],[104.363184,-.658594],[104.590137,-.466602],[104.474219,-.334668]]],[[[109.710254,-1.180664],[109.475977,-.985352],[109.463672,-1.277539],[109.710254,-1.180664]]],[[[113.844531,-7.105371],[114.073633,-6.960156],[113.067383,-6.87998],[112.725879,-7.072754],[113.844531,-7.105371]]],[[[127.566992,-.318945],[127.3,-.500293],[127.761133,-.883691],[127.566992,-.318945]]],[[[128.275586,-3.674609],[128.329102,-3.515918],[127.925,-3.699316],[128.275586,-3.674609]]],[[[130.35332,-1.690527],[129.737695,-1.866895],[130.248047,-2.047754],[130.35332,-1.690527]]],[[[100.425098,-3.18291],[100.198535,-2.785547],[100.465137,-3.328516],[100.425098,-3.18291]]],[[[100.204102,-2.741016],[99.987891,-2.525391],[100.014941,-2.819727],[100.204102,-2.741016]]],[[[98.459277,-.530469],[98.544141,-.257617],[98.322949,-781e-6],[98.459277,-.530469]]],[[[122.042969,-5.437988],[121.913672,-5.072266],[121.808496,-5.256152],[122.042969,-5.437988]]],[[[123.212305,-1.171289],[122.908008,-1.182227],[122.89043,-1.587207],[123.150391,-1.304492],[123.172949,-1.616016],[123.511914,-1.447363],[123.212305,-1.171289]]],[[[120.52832,-6.298438],[120.477344,-5.775293],[120.487305,-6.464844],[120.52832,-6.298438]]],[[[115.377051,-6.970801],[115.546094,-6.938672],[115.240527,-6.86123],[115.377051,-6.970801]]],[[[116.30332,-3.868164],[116.269727,-3.251074],[116.058789,-4.006934],[116.30332,-3.868164]]],[[[122.948926,-10.909277],[123.418164,-10.65127],[123.371094,-10.474902],[122.845703,-10.761816],[122.948926,-10.909277]]],[[[123.924805,-8.272461],[123.391211,-8.280469],[123.230078,-8.530664],[123.924805,-8.272461]]],[[[123.242383,-4.112988],[122.969043,-4.02998],[123.076172,-4.227148],[123.242383,-4.112988]]],[[[117.649023,4.168994],[117.736816,4.004004],[117.884766,4.186133],[117.649023,4.168994]]],[[[121.883008,-10.590332],[121.99834,-10.446973],[121.704688,-10.555664],[121.883008,-10.590332]]]]}},{type:"Feature",properties:{name:"印度",full_name:"印度共和国",iso_a2:"IN",iso_a3:"IND",iso_n3:"356"},geometry:{type:"MultiPolygon",coordinates:[[[[68.165039,23.857324],[68.234961,23.596973],[68.776758,23.8521],[68.41748,23.571484],[69.235937,22.848535],[69.664648,22.759082],[70.489258,23.089502],[70.177246,22.572754],[68.969922,22.290283],[70.485059,20.840186],[71.024609,20.738867],[72.015234,21.155713],[72.254004,21.531006],[72.037207,21.823047],[72.182813,22.269727],[72.80918,22.233301],[72.553027,22.159961],[72.543066,21.696582],[73.1125,21.750439],[72.613281,21.461816],[72.89375,20.672754],[72.667773,19.830957],[72.987207,19.277441],[72.803027,19.079297],[72.97207,19.15332],[72.875488,18.642822],[73.476074,16.054248],[74.382227,14.494727],[74.945508,12.564551],[75.723828,11.361768],[76.553418,8.902783],[77.517578,8.07832],[78.060156,8.38457],[78.421484,9.105029],[79.411426,9.192383],[78.939941,9.565771],[79.314551,10.256689],[79.838184,10.322559],[79.693164,11.312549],[80.342383,13.361328],[80.062109,13.60625],[80.306543,13.485059],[80.053418,15.074023],[80.293457,15.710742],[80.646582,15.89502],[80.978711,15.75835],[81.286133,16.337061],[82.258789,16.559863],[82.35957,17.096191],[84.104102,18.292676],[85.441602,19.626562],[85.180762,19.594873],[85.248633,19.757666],[86.279492,19.919434],[86.975488,20.700146],[86.954102,21.365332],[87.82373,21.727344],[88.159277,22.121729],[87.941406,22.374316],[88.196289,22.139551],[88.12207,21.635791],[88.584668,21.659717],[88.641602,22.121973],[88.74502,21.584375],[89.05166,21.654102],[89.051465,22.093164],[88.928125,23.186621],[88.567383,23.674414],[88.723535,24.274902],[88.023438,24.627832],[88.45625,25.188428],[88.95166,25.259277],[88.08457,25.888232],[88.418164,26.571533],[88.828027,26.252197],[89.018652,26.410254],[89.369727,26.006104],[89.670898,26.213818],[89.833301,25.292773],[92.049707,25.169482],[92.468359,24.944141],[91.876953,24.195312],[91.36709,24.093506],[91.160449,23.660645],[91.315234,23.104395],[91.619531,22.979688],[91.92959,23.685986],[92.246094,23.683594],[92.574902,21.978076],[93.151172,22.230615],[93.32627,24.064209],[94.127637,23.876465],[94.707617,25.04873],[94.579883,25.319824],[95.132422,26.04126],[95.128711,26.597266],[96.19082,27.261279],[96.731641,27.331494],[97.102051,27.11543],[96.876855,27.586719],[97.086778,27.7475],[96.275479,28.228241],[95.832003,28.295186],[95.39715,28.142259],[95.28628,27.939955],[94.88592,27.743098],[94.277372,27.58143],[93.817265,27.025183],[93.111399,26.880082],[92.64698,26.952656],[91.99834,26.85498],[89.609961,26.719434],[88.857617,26.961475],[88.891406,27.316064],[88.803711,28.006934],[88.109766,27.870605],[87.995117,26.382373],[85.794531,26.60415],[84.091016,27.491357],[82.733398,27.518994],[80.070703,28.830176],[80.401855,29.730273],[81.010254,30.164502],[79.707774,31.013593],[78.807678,31.099982],[78.389648,32.519873],[78.700879,32.597021],[78.918945,32.358203],[79.219336,32.501074],[78.72666,34.013379],[78.970117,34.302637],[78.326953,34.606396],[78.042676,35.479785],[77.799414,35.495898],[77.048633,35.109912],[75.70918,34.503076],[73.96123,34.653467],[73.904102,34.075684],[74.250879,33.946094],[73.976465,33.721289],[74.003809,33.189453],[74.35459,32.768701],[74.663281,32.757666],[74.685742,32.493799],[75.333496,32.279199],[74.555566,31.818555],[74.632812,31.034668],[73.80918,30.093359],[73.381641,29.934375],[72.90332,29.02876],[72.341895,28.751904],[71.870313,27.9625],[70.797949,27.709619],[70.403711,28.025049],[69.537012,27.122949],[69.506934,26.742676],[70.147656,26.506445],[70.100195,25.910059],[70.648438,25.666943],[71.044043,24.400098],[69.805176,24.165234],[68.781152,24.313721],[68.724121,23.964697],[68.165039,23.857324]]],[[[93.890039,6.831055],[93.822461,7.236621],[93.658008,7.016064],[93.890039,6.831055]]],[[[92.502832,10.554883],[92.510352,10.897461],[92.352832,10.751123],[92.502832,10.554883]]],[[[92.722754,11.536084],[93.062305,13.545459],[92.533887,11.873389],[92.722754,11.536084]]]]}},{type:"Feature",properties:{name:"冰岛",full_name:"冰岛共和国",iso_a2:"IS",iso_a3:"ISL",iso_n3:"352"},geometry:{type:"Polygon",coordinates:[[[-15.543115,66.228516],[-16.249316,66.5229],[-16.48501,66.195947],[-17.550439,65.964404],[-18.297168,66.157422],[-18.141943,65.734082],[-18.845898,66.183936],[-19.489697,65.768066],[-20.20752,66.100098],[-21.129687,65.266602],[-21.406885,66.025586],[-22.944336,66.429443],[-22.441699,65.908301],[-23.452539,66.181006],[-23.832617,65.849219],[-23.285352,65.75],[-24.092627,65.776465],[-23.856738,65.538379],[-24.475684,65.525195],[-21.844385,65.447363],[-22.509082,65.196777],[-21.892139,65.048779],[-24.026172,64.863428],[-21.590625,64.626367],[-22.053369,64.313916],[-21.46333,64.37915],[-22.701172,64.083203],[-22.652197,63.827734],[-21.152393,63.944531],[-20.198145,63.555811],[-18.653613,63.406689],[-14.927393,64.319678],[-13.599316,65.035938],[-13.617871,65.519336],[-14.8271,65.764258],[-15.117383,66.125635],[-14.59585,66.381543],[-15.543115,66.228516]]]}},{type:"Feature",properties:{name:"匈牙利",full_name:"匈牙利",iso_a2:"HU",iso_a3:"HUN",iso_n3:"348"},geometry:{type:"Polygon",coordinates:[[[22.131836,48.405322],[20.490039,48.526904],[19.950391,48.146631],[18.791895,48.000293],[18.724219,47.787158],[17.761914,47.770166],[17.147363,48.005957],[17.066602,47.707568],[16.421289,47.674463],[16.676563,47.536035],[16.093066,46.863281],[16.516211,46.499902],[17.807129,45.79043],[18.905371,45.931738],[20.241797,46.108594],[21.12168,46.282422],[21.999707,47.505029],[22.87666,47.947266],[22.131836,48.405322]]]}},{type:"Feature",properties:{name:"洪都拉斯",full_name:"洪都拉斯共和国",iso_a2:"HN",iso_a3:"HND",iso_n3:"340"},geometry:{type:"Polygon",coordinates:[[[-83.15752,14.993066],[-84.095068,15.400928],[-83.765283,15.405469],[-84.261426,15.822607],[-84.97373,15.989893],[-88.22832,15.729004],[-89.142578,15.072314],[-89.362598,14.416016],[-88.482666,13.854248],[-87.802246,13.88999],[-87.814209,13.39917],[-87.489111,13.35293],[-87.337256,12.979248],[-86.729297,13.284375],[-86.733643,13.763477],[-86.040381,14.050146],[-85.733936,13.858691],[-84.985156,14.752441],[-84.453564,14.643701],[-83.15752,14.993066]]]}},{type:"Feature",properties:{name:"海地",full_name:"海地共和国",iso_a2:"HT",iso_a3:"HTI",iso_n3:"332"},geometry:{type:"Polygon",coordinates:[[[-71.779248,19.718164],[-73.400537,19.807422],[-72.703223,19.441064],[-72.811084,19.071582],[-72.376074,18.574463],[-72.789355,18.434814],[-74.227734,18.662695],[-74.478125,18.45],[-73.884961,18.041895],[-73.385156,18.251172],[-71.768311,18.03916],[-72.000391,18.5979],[-71.645312,19.163525],[-71.779248,19.718164]]]}},{type:"Feature",properties:{name:"圭亚那",full_name:"圭亚那合作共和国",iso_a2:"GY",iso_a3:"GUY",iso_n3:"328"},geometry:{type:"Polygon",coordinates:[[[-60.742139,5.202051],[-60.142041,5.238818],[-59.990674,5.082861],[-60.148633,4.533252],[-59.703271,4.381104],[-59.551123,3.933545],[-59.854395,3.5875],[-59.994336,2.68999],[-59.666602,1.746289],[-59.231201,1.376025],[-58.821777,1.201221],[-57.31748,1.963477],[-56.482812,1.942139],[-57.197363,2.853271],[-57.303662,3.3771],[-57.646729,3.394531],[-58.054297,4.10166],[-57.917041,4.82041],[-57.331006,5.020166],[-57.194775,5.548438],[-57.227539,6.178418],[-57.982568,6.785889],[-58.41499,6.851172],[-58.672949,6.390771],[-58.511084,7.398047],[-60.017529,8.549316],[-59.849072,8.248682],[-60.718652,7.535937],[-60.3521,7.002881],[-61.145605,6.694531],[-61.128711,6.214307],[-61.39082,5.93877],[-60.742139,5.202051]]]}},{type:"Feature",properties:{name:"几内亚比绍",full_name:"几内亚比绍共和国",iso_a2:"GW",iso_a3:"GNB",iso_n3:"624"},geometry:{type:"Polygon",coordinates:[[[-16.711816,12.354834],[-16.24458,12.237109],[-16.328076,12.051611],[-15.941748,11.786621],[-15.078271,11.968994],[-15.501904,11.723779],[-15.072656,11.597803],[-15.479492,11.410303],[-15.043018,10.940137],[-14.682959,11.508496],[-13.732764,11.736035],[-13.948877,12.178174],[-13.70791,12.312695],[-13.729248,12.673926],[-15.196094,12.679932],[-16.711816,12.354834]]]}},{type:"Feature",properties:{name:"几内亚",full_name:"几内亚共和国",iso_a2:"GN",iso_a3:"GIN",iso_n3:"324"},geometry:{type:"Polygon",coordinates:[[[-10.283203,8.485156],[-9.518262,8.346094],[-9.463818,7.415869],[-9.117578,7.215918],[-8.659766,7.688379],[-8.486426,7.558496],[-8.231885,7.556738],[-8.009863,8.078516],[-8.236963,8.455664],[-7.681201,8.410352],[-7.950977,8.786816],[-7.896191,9.415869],[-8.136963,9.495703],[-7.990625,10.1625],[-8.337402,10.990625],[-8.666699,11.009473],[-8.398535,11.366553],[-8.822021,11.673242],[-9.043066,12.402344],[-9.395361,12.464648],[-9.358105,12.25542],[-9.754004,12.029932],[-10.274854,12.212646],[-10.709229,11.89873],[-10.933203,12.205176],[-11.305176,12.01543],[-11.502197,12.198633],[-11.389404,12.404395],[-12.399072,12.340088],[-13.729248,12.673926],[-13.70791,12.312695],[-13.948877,12.178174],[-13.732764,11.736035],[-14.682959,11.508496],[-15.043018,10.940137],[-14.593506,10.766699],[-14.426904,10.24834],[-13.689795,9.927783],[-13.691357,9.535791],[-13.292676,9.049219],[-12.427979,9.898145],[-11.273633,9.996533],[-10.690527,9.314258],[-10.500537,8.687549],[-10.712109,8.335254],[-10.283203,8.485156]]]}},{type:"Feature",properties:{name:"危地马拉",full_name:"危地马拉共和国",iso_a2:"GT",iso_a3:"GTM",iso_n3:"320"},geometry:{type:"Polygon",coordinates:[[[-92.235156,14.54541],[-91.377344,13.990186],[-90.095215,13.736523],[-89.362598,14.416016],[-89.142578,15.072314],[-88.22832,15.729004],[-88.894043,15.890625],[-89.2375,15.894434],[-89.161475,17.814844],[-90.98916,17.816406],[-90.992969,17.252441],[-91.409619,17.255859],[-90.416992,16.391016],[-90.447168,16.072705],[-91.736572,16.070166],[-92.204248,15.275],[-92.235156,14.54541]]]}},{type:"Feature",properties:{name:"格林纳达",full_name:"格林纳达",iso_a2:"GD",iso_a3:"GRD",iso_n3:"308"},geometry:{type:"Polygon",coordinates:[[[-61.715527,12.012646],[-61.607031,12.223291],[-61.71499,12.185156],[-61.715527,12.012646]]]}},{type:"Feature",properties:{name:"希腊",full_name:"希腊共和国",iso_a2:"GR",iso_a3:"GRC",iso_n3:"300"},geometry:{type:"MultiPolygon",coordinates:[[[[20.612305,38.38335],[20.352539,38.179883],[20.761328,38.070557],[20.612305,38.38335]]],[[[20.07793,39.432715],[19.926074,39.77373],[19.646484,39.76709],[20.07793,39.432715]]],[[[23.41543,38.958643],[22.870313,38.870508],[24.536523,37.979736],[24.127539,38.648486],[23.41543,38.958643]]],[[[26.824414,37.811426],[26.581055,37.72373],[27.055078,37.709277],[26.824414,37.811426]]],[[[26.094043,38.218066],[26.160352,38.540723],[25.846094,38.574023],[26.094043,38.218066]]],[[[26.410156,39.329443],[25.844141,39.200049],[26.46875,38.972803],[26.410156,39.329443]]],[[[27.842773,35.929297],[28.231836,36.433643],[27.716309,36.171582],[27.842773,35.929297]]],[[[23.852246,35.535449],[23.569824,35.534766],[23.592773,35.257227],[24.799805,34.934473],[26.165625,35.018604],[26.320215,35.315137],[25.791309,35.122852],[25.730176,35.348584],[23.852246,35.535449]]],[[[26.320898,41.716553],[25.92334,41.311914],[25.251172,41.243555],[24.487891,41.555225],[22.916016,41.336279],[20.964258,40.849902],[20.657422,40.117383],[20.00127,39.709424],[20.713379,39.035156],[21.118359,39.02998],[20.768555,38.874414],[21.182617,38.345557],[22.42168,38.438525],[23.148926,38.176074],[22.920313,37.958301],[21.824707,38.328125],[21.124707,37.891602],[21.678906,37.387207],[21.58291,37.080957],[21.892383,36.737305],[22.080469,37.028955],[22.427734,36.475781],[22.717188,36.793945],[23.160156,36.448096],[22.725391,37.542139],[23.489258,37.440186],[23.036328,37.878369],[23.501758,38.034863],[24.019727,37.677734],[24.024512,38.139795],[22.569141,38.86748],[23.066699,39.037939],[22.921387,39.306348],[23.327734,39.174902],[22.592188,40.036914],[22.629492,40.495557],[22.922266,40.590869],[23.627344,39.924072],[23.42627,40.263965],[23.94707,39.965576],[23.72793,40.329736],[24.343359,40.147705],[23.762793,40.747803],[25.104492,40.994727],[26.038965,40.726758],[26.624902,41.401758],[26.320898,41.716553]]]]}},{type:"Feature",properties:{name:"加纳",full_name:"加纳共和国",iso_a2:"GH",iso_a3:"GHA",iso_n3:"288"},geometry:{type:"Polygon",coordinates:[[[-.068604,11.115625],[-.627148,10.927393],[-2.829932,10.998389],[-2.69585,9.481348],[-2.505859,8.20874],[-3.235791,6.807227],[-2.75498,5.43252],[-3.019141,5.130811],[-3.086719,5.12832],[-3.114014,5.088672],[-2.001855,4.762451],[.259668,5.757324],[.949707,5.810254],[1.187207,6.089404],[.525586,6.850928],[.686328,8.354883],[.372559,8.759277],[.525684,9.398486],[.233398,9.463525],[.380859,10.291846],[-.086328,10.673047],[-.068604,11.115625]]]}},{type:"Feature",properties:{name:"德国",full_name:"德意志联邦共和国",iso_a2:"DE",iso_a3:"DEU",iso_n3:"276"},geometry:{type:"MultiPolygon",coordinates:[[[[9.524023,47.524219],[10.183008,47.278809],[10.439453,47.551562],[11.041992,47.393115],[12.209277,47.718262],[13.014355,47.478076],[12.760352,48.106982],[13.814746,48.766943],[12.681152,49.414502],[12.089844,50.301758],[12.942676,50.406445],[14.319727,51.037793],[14.809375,50.858984],[15.016602,51.252734],[14.619434,52.528516],[14.128613,52.878223],[14.258887,53.729639],[12.575391,54.467383],[11.399609,53.944629],[10.85459,54.009814],[11.013379,54.37915],[9.868652,54.472461],[9.739746,54.825537],[8.670313,54.903418],[8.92041,53.965332],[9.783984,53.554639],[8.618945,53.875],[8.495215,53.394238],[8.009277,53.690723],[7.285254,53.681348],[7.197266,53.282275],[7.033008,52.651367],[6.710742,52.617871],[7.035156,52.380225],[6.800391,51.967383],[5.94873,51.802686],[5.993945,50.750439],[6.340918,50.451758],[6.116504,50.120996],[6.487305,49.798486],[6.344336,49.452734],[6.735449,49.160596],[8.134863,48.973584],[7.615625,47.592725],[8.454004,47.596191],[8.572656,47.775635],[9.524023,47.524219]]],[[[13.70918,54.382715],[13.336816,54.697119],[13.190039,54.325635],[13.70918,54.382715]]],[[[14.211426,53.950342],[13.827734,54.127246],[14.213672,53.870752],[14.211426,53.950342]]]]}},{type:"Feature",properties:{name:"格鲁吉亚",full_name:"格鲁吉亚",iso_a2:"GE",iso_a3:"GEO",iso_n3:"268"},geometry:{type:"Polygon",coordinates:[[[43.439453,41.107129],[45.001367,41.290967],[45.280957,41.449561],[46.534375,41.088574],[46.672559,41.286816],[46.182129,41.65708],[46.429883,41.890967],[45.638574,42.205078],[45.705273,42.498096],[44.870996,42.756396],[43.825977,42.571533],[42.760645,43.16958],[41.580566,43.219238],[40.648047,43.533887],[39.97832,43.419824],[41.48877,42.659326],[41.762988,41.97002],[41.510059,41.51748],[42.754102,41.578906],[43.439453,41.107129]]]}},{type:"Feature",properties:{name:"冈比亚",full_name:"冈比亚共和国",iso_a2:"GM",iso_a3:"GMB",iso_n3:"270"},geometry:{type:"Polygon",coordinates:[[[-16.562305,13.587305],[-16.351807,13.343359],[-15.42749,13.468359],[-16.413379,13.269727],[-16.669336,13.475],[-16.76333,13.06416],[-15.834277,13.156445],[-15.151123,13.556494],[-14.246777,13.23584],[-13.826709,13.407812],[-15.10835,13.812109],[-15.509668,13.58623],[-16.562305,13.587305]]]}},{type:"Feature",properties:{name:"加蓬",full_name:"加蓬共和国",iso_a2:"GA",iso_a3:"GAB",iso_n3:"266"},geometry:{type:"Polygon",coordinates:[[[13.293555,2.161572],[11.328711,2.167432],[11.335352,.999707],[9.59082,1.031982],[9.617969,.576514],[9.324805,.5521],[10.001465,.194971],[9.796777,.044238],[9.354883,.343604],[9.29668,-.35127],[8.946387,-.68877],[8.703125,-.591016],[9.064648,-1.29834],[9.501074,-1.555176],[9.318848,-1.632031],[9.036328,-1.308887],[9.624609,-2.36709],[10.062012,-2.549902],[9.72207,-2.467578],[11.130176,-3.916309],[11.504297,-3.520312],[11.879883,-3.665918],[11.93418,-3.318555],[11.537793,-2.836719],[11.605469,-2.342578],[12.446387,-2.32998],[12.59043,-1.826855],[12.991992,-2.313379],[13.464941,-2.39541],[13.733789,-2.138477],[13.993848,-2.490625],[14.383984,-1.890039],[14.474121,-.573438],[13.860059,-.20332],[13.949609,.353809],[14.429883,.901465],[14.180859,1.370215],[13.216309,1.248438],[13.293555,2.161572]]]}},{type:"Feature",properties:{name:"法国",full_name:"法兰西共和国",iso_a2:"FR",iso_a3:"FRA",iso_n3:"250"},geometry:{type:"MultiPolygon",coordinates:[[[[9.480371,42.80542],[9.363184,43.017383],[9.313379,42.713184],[8.565625,42.357715],[8.80752,41.588379],[9.186133,41.384912],[9.550684,42.129736],[9.480371,42.80542]]],[[[7.615625,47.592725],[8.134863,48.973584],[6.735449,49.160596],[6.344336,49.452734],[5.789746,49.538281],[4.867578,49.788135],[4.818652,50.153174],[4.149316,49.971582],[4.174609,50.246484],[2.759375,50.750635],[2.524902,51.097119],[1.672266,50.88501],[1.592773,50.252197],[.186719,49.703027],[.416895,49.448389],[-1.138525,49.387891],[-1.258643,49.680176],[-1.856445,49.683789],[-1.376465,48.652588],[-2.692334,48.536816],[-3.231445,48.84082],[-4.7625,48.450244],[-4.241406,48.303662],[-4.678809,48.039502],[-4.312109,47.8229],[-1.742529,47.215967],[-2.19707,47.162939],[-2.059375,46.810303],[-1.146289,46.311377],[-1.195996,45.714453],[-.548486,45.000586],[-1.081006,45.532422],[-1.076953,44.689844],[-1.484863,43.56377],[-1.794043,43.407324],[-1.46084,43.051758],[-.586426,42.798975],[.631641,42.6896],[.696875,42.845117],[1.42832,42.595898],[1.706055,42.50332],[3.211426,42.431152],[3.051758,42.915137],[3.91084,43.563086],[6.115918,43.072363],[7.377734,43.731738],[7.39502,43.765332],[7.438672,43.750439],[7.493164,43.767139],[7.637207,44.164844],[6.900195,44.335742],[6.992676,44.827295],[6.634766,45.068164],[7.146387,45.381738],[6.790918,45.740869],[7.021094,45.925781],[6.758105,46.415771],[5.97002,46.214697],[6.968359,47.453223],[7.615625,47.592725]]],[[[55.797363,-21.339355],[55.661914,-20.90625],[55.311328,-20.904102],[55.362695,-21.273633],[55.797363,-21.339355]]],[[[-60.82627,14.494482],[-61.21333,14.848584],[-61.063721,14.46709],[-60.82627,14.494482]]],[[[-61.327148,16.23042],[-61.172607,16.256104],[-61.471191,16.506641],[-61.522168,16.228027],[-61.327148,16.23042]]],[[[-54.61626,2.326758],[-54.130078,2.121045],[-53.767773,2.354834],[-52.903467,2.211523],[-51.652539,4.061279],[-51.827539,4.635693],[-52.00293,4.352295],[-52.058105,4.717383],[-52.899316,5.425049],[-53.847168,5.782227],[-54.155957,5.358984],[-54.479688,4.836523],[-54.00957,3.448535],[-54.61626,2.326758]]]]}},{type:"Feature",properties:{name:"圣皮埃尔和密克隆群岛",full_name:"圣皮埃尔和密克隆群岛（法国）",iso_a2:"PM",iso_a3:"SPM",iso_n3:"666"},geometry:{type:"Polygon",coordinates:[[[-56.26709,46.838477],[-56.364648,47.098975],[-56.384766,46.819434],[-56.26709,46.838477]]]}},{type:"Feature",properties:{name:"瓦利斯和富图纳群岛",full_name:"瓦利斯和富图纳群岛",iso_a2:"WF",iso_a3:"WLF",iso_n3:"876"},geometry:{type:"Polygon",coordinates:[[[-178.04668,-14.318359],[-178.194385,-14.255469],[-178.158594,-14.311914],[-178.04668,-14.318359]]]}},{type:"Feature",properties:{name:"法属圣马丁",full_name:"法属圣马丁岛",iso_a2:"MF",iso_a3:"MAF",iso_n3:"663"},geometry:{type:"Polygon",coordinates:[[[-63.011182,18.068945],[-63.063086,18.115332],[-63.123047,18.068945],[-63.011182,18.068945]]]}},{type:"Feature",properties:{name:"圣巴泰勒米",full_name:"圣巴泰勒米（法国）",iso_a2:"BL",iso_a3:"BLM",iso_n3:"652"},geometry:{type:"Polygon",coordinates:[[[-62.831934,17.876465],[-62.799707,17.908691],[-62.874219,17.922266],[-62.831934,17.876465]]]}},{type:"Feature",properties:{name:"法属波利尼西亚",full_name:"法属波利尼西亚",iso_a2:"PF",iso_a3:"PYF",iso_n3:"258"},geometry:{type:"MultiPolygon",coordinates:[[[[-149.321533,-17.690039],[-149.63501,-17.564258],[-149.181787,-17.862305],[-149.321533,-17.690039]]],[[[-139.024316,-9.695215],[-139.134082,-9.829492],[-138.827344,-9.741602],[-139.024316,-9.695215]]]]}},{type:"Feature",properties:{name:"新喀里多尼亚",full_name:"新喀里多尼亚",iso_a2:"NC",iso_a3:"NCL",iso_n3:"540"},geometry:{type:"MultiPolygon",coordinates:[[[[164.202344,-20.246094],[164.059668,-20.141504],[164.927441,-21.289844],[166.467969,-22.256055],[166.970313,-22.322852],[166.942383,-22.090137],[165.191797,-20.768848],[164.202344,-20.246094]]],[[[168.010938,-21.42998],[167.81543,-21.392676],[167.966797,-21.641602],[168.010938,-21.42998]]],[[[167.400879,-21.160645],[167.297949,-20.73252],[167.055762,-20.720215],[167.072656,-20.997266],[167.400879,-21.160645]]]]}},{type:"Feature",properties:{name:"法属南部和南极领地",full_name:"法属南部和南极领地",iso_a2:"TF",iso_a3:"ATF",iso_n3:"260"},geometry:{type:"Polygon",coordinates:[[[69.184863,-49.10957],[69.002441,-48.66123],[68.814746,-49.699609],[69.153125,-49.529688],[70.124316,-49.704395],[70.247754,-49.530664],[69.759961,-49.430176],[70.386133,-49.433984],[70.555469,-49.201465],[70.320215,-49.058594],[69.542383,-49.255664],[69.592773,-48.970996],[69.184863,-49.10957]]]}},{type:"Feature",properties:{name:"奥兰群岛",full_name:"奥兰群岛（芬兰）",iso_a2:"AX",iso_a3:"ALA",iso_n3:"248"},geometry:{type:"Polygon",coordinates:[[[19.989551,60.351172],[19.799805,60.081738],[20.258887,60.261279],[19.989551,60.351172]]]}},{type:"Feature",properties:{name:"芬兰",full_name:"芬兰共和国",iso_a2:"FI",iso_a3:"FIN",iso_n3:"246"},geometry:{type:"Polygon",coordinates:[[[24.155469,65.805273],[24.628027,65.85918],[25.347852,65.479248],[25.288184,64.860352],[24.55791,64.801025],[21.143848,62.73999],[21.436035,60.596387],[22.584961,60.380566],[22.462695,60.029199],[22.911719,60.209717],[23.021289,59.816016],[25.758008,60.267529],[26.569336,60.624561],[26.534668,60.412891],[27.797656,60.536133],[31.533984,62.8854],[29.991504,63.735156],[30.51377,64.2],[29.604199,64.968408],[30.102734,65.72627],[29.066211,66.891748],[29.988086,67.668262],[28.685156,68.189795],[28.414062,68.90415],[28.96582,69.021973],[29.141602,69.671436],[27.747852,70.064844],[26.072461,69.691553],[24.941406,68.593262],[23.854004,68.805908],[22.410938,68.719873],[21.59375,69.273584],[20.622168,69.036865],[23.638867,67.954395],[24.155469,65.805273]]]}},{type:"Feature",properties:{name:"斐济",full_name:"斐济共和国",iso_a2:"FJ",iso_a3:"FJI",iso_n3:"242"},geometry:{type:"MultiPolygon",coordinates:[[[[179.999219,-16.168555],[180,-16.15293],[178.497461,-16.787891],[178.706641,-16.976172],[179.202344,-16.712695],[179.92793,-16.744434],[179.930371,-16.519434],[179.56416,-16.636914],[179.999219,-16.168555]]],[[[178.280176,-17.371973],[177.504492,-17.539551],[177.321387,-18.077539],[177.955469,-18.264062],[178.667676,-18.080859],[178.280176,-17.371973]]]]}},{type:"Feature",properties:{name:"埃塞俄比亚",full_name:"埃塞俄比亚联邦民主共和国",iso_a2:"ET",iso_a3:"ETH",iso_n3:"231"},geometry:{type:"Polygon",coordinates:[[[35.268359,5.492285],[35.74502,5.343994],[36.021973,4.468115],[36.905566,4.411475],[38.086133,3.648828],[39.494434,3.456104],[40.765234,4.273047],[41.14043,3.962988],[41.883984,3.977734],[43.583496,4.85498],[44.940527,4.912012],[47.978223,7.99707],[46.978223,7.99707],[43.983789,9.008838],[42.841602,10.203076],[42.656445,10.6],[42.922754,10.999316],[41.798242,10.980469],[41.792676,11.686035],[42.378516,12.466406],[40.820117,14.11167],[40.140625,14.456055],[39.023828,14.628223],[38.431445,14.428613],[37.88418,14.852295],[37.571191,14.149072],[37.257227,14.45376],[36.524316,14.256836],[36.125195,12.757031],[35.670215,12.62373],[35.112305,11.816553],[34.931445,10.864795],[34.343945,10.658643],[34.078125,9.461523],[34.072754,8.545264],[33.281055,8.437256],[32.998926,7.899512],[33.902441,7.509521],[34.710645,6.660303],[35.268359,5.492285]]]}},{type:"Feature",properties:{name:"爱沙尼亚",full_name:"爱沙尼亚共和国",iso_a2:"EE",iso_a3:"EST",iso_n3:"233"},geometry:{type:"MultiPolygon",coordinates:[[[[27.351953,57.528125],[27.778516,57.870703],[27.43418,58.787256],[28.0125,59.484277],[25.509277,59.639014],[23.494434,59.195654],[23.767578,58.36084],[24.529102,58.354248],[24.322559,57.870605],[25.282617,58.048486],[26.462109,57.544482],[27.351953,57.528125]]],[[[22.617383,58.62124],[21.862305,58.497168],[21.996875,57.931348],[23.323242,58.45083],[22.617383,58.62124]]],[[[22.92373,58.826904],[22.649414,59.087109],[22.05625,58.943604],[22.542188,58.68999],[22.92373,58.826904]]]]}},{type:"Feature",properties:{name:"厄立特里亚",full_name:"厄立特里亚国",iso_a2:"ER",iso_a3:"ERI",iso_n3:"232"},geometry:{type:"MultiPolygon",coordinates:[[[[36.524316,14.256836],[37.257227,14.45376],[37.571191,14.149072],[37.88418,14.852295],[38.431445,14.428613],[39.023828,14.628223],[40.140625,14.456055],[40.820117,14.11167],[42.378516,12.466406],[42.703711,12.380322],[43.116699,12.708594],[41.176465,14.620312],[40.204102,15.014111],[39.86377,15.470312],[39.785547,15.124854],[38.609473,18.005078],[37.411035,17.061719],[37.008984,17.058887],[36.426758,15.13208],[36.524316,14.256836]]],[[[40.141211,15.696143],[39.956738,15.889404],[39.975195,15.612451],[40.399023,15.579883],[40.141211,15.696143]]]]}},{type:"Feature",properties:{name:"赤道几内亚",full_name:"赤道几内亚共和国",iso_a2:"GQ",iso_a3:"GNQ",iso_n3:"226"},geometry:{type:"MultiPolygon",coordinates:[[[[8.735742,3.758301],[8.474902,3.264648],[8.704004,3.223633],[8.946094,3.627539],[8.735742,3.758301]]],[[[11.328711,2.167432],[9.800781,2.304443],[9.385938,1.139258],[9.59082,1.031982],[11.335352,.999707],[11.328711,2.167432]]]]}},{type:"Feature",properties:{name:"萨尔瓦多",full_name:"萨尔瓦多共和国",iso_a2:"SV",iso_a3:"SLV",iso_n3:"222"},geometry:{type:"Polygon",coordinates:[[[-89.362598,14.416016],[-90.095215,13.736523],[-88.512012,13.183936],[-88.685645,13.281494],[-87.930859,13.180664],[-87.814209,13.39917],[-87.802246,13.88999],[-88.482666,13.854248],[-89.362598,14.416016]]]}},{type:"Feature",properties:{name:"埃及",full_name:"阿拉伯埃及共和国",iso_a2:"EG",iso_a3:"EGY",iso_n3:"818"},geometry:{type:"Polygon",coordinates:[[[36.871387,21.996729],[35.697852,22.946191],[35.504395,23.779297],[35.783887,23.937793],[35.194141,24.475146],[33.959082,26.649023],[33.54707,27.898145],[32.359766,29.630664],[32.565723,29.973975],[33.247754,28.567725],[34.220117,27.764307],[34.904297,29.477344],[34.245313,31.208301],[34.198145,31.322607],[32.60332,31.06875],[32.216211,31.29375],[32.101758,31.092822],[31.771094,31.292578],[31.892188,31.482471],[32.136035,31.341064],[31.888965,31.541406],[31.08291,31.60332],[29.07207,30.830273],[25.150488,31.65498],[24.852734,31.334814],[24.961426,30.678516],[24.703223,30.201074],[24.980273,29.181885],[24.980273,21.99585],[31.092676,21.994873],[31.400293,22.202441],[31.434473,21.99585],[36.871387,21.996729]]]}},{type:"Feature",properties:{name:"厄瓜多尔",full_name:"厄瓜多尔共和国",iso_a2:"EC",iso_a3:"ECU",iso_n3:"218"},geometry:{type:"MultiPolygon",coordinates:[[[[-75.284473,-.106543],[-76.270605,.439404],[-76.494629,.235449],[-77.396338,.393896],[-77.702881,.837842],[-78.859668,1.455371],[-78.899658,1.20625],[-80.088281,.784766],[-80.046143,.155371],[-80.482275,-.368262],[-80.282373,-.620508],[-80.902393,-1.078906],[-80.760596,-1.93457],[-80.932178,-2.269141],[-80.284717,-2.706738],[-80.006641,-2.353809],[-79.925586,-2.548535],[-79.842139,-2.067383],[-79.729883,-2.579102],[-79.96333,-3.157715],[-80.324658,-3.387891],[-80.179248,-3.877734],[-80.490137,-4.010059],[-80.478564,-4.430078],[-79.638525,-4.454883],[-79.330957,-4.927832],[-79.033301,-4.969141],[-78.686035,-4.562402],[-78.345361,-3.397363],[-78.158496,-3.465137],[-77.860596,-2.981641],[-76.679102,-2.562598],[-75.570557,-1.53125],[-75.259375,-.590137],[-75.62627,-.122852],[-75.284473,-.106543]]],[[[-80.131592,-2.973145],[-79.909033,-2.725586],[-80.223682,-2.753125],[-80.131592,-2.973145]]],[[[-90.334863,-.771582],[-90.269385,-.484668],[-90.531689,-.581445],[-90.334863,-.771582]]],[[[-89.418896,-.911035],[-89.287842,-.689844],[-89.608594,-.888574],[-89.418896,-.911035]]],[[[-91.272168,.025146],[-91.596826,.0021],[-91.120947,-.559082],[-91.49541,-.860938],[-91.131055,-1.019629],[-90.799658,-.752051],[-91.272168,.025146]]]]}},{type:"Feature",properties:{name:"多米尼加",full_name:"多米尼加共和国",iso_a2:"DO",iso_a3:"DOM",iso_n3:"214"},geometry:{type:"Polygon",coordinates:[[[-71.768311,18.03916],[-71.438965,17.635596],[-71.027832,18.273193],[-69.274512,18.439844],[-68.687402,18.214941],[-68.33916,18.611523],[-69.623633,19.117822],[-69.232471,19.271826],[-69.739404,19.299219],[-69.956836,19.671875],[-70.95415,19.913965],[-71.779248,19.718164],[-71.645312,19.163525],[-72.000391,18.5979],[-71.768311,18.03916]]]}},{type:"Feature",properties:{name:"多米尼克",full_name:"多米尼克国",iso_a2:"DM",iso_a3:"DMA",iso_n3:"212"},geometry:{type:"Polygon",coordinates:[[[-61.281689,15.249023],[-61.277246,15.526709],[-61.458105,15.633105],[-61.281689,15.249023]]]}},{type:"Feature",properties:{name:"美国本土外小岛屿",full_name:"美国本土外小岛屿",iso_a2:"UM",iso_a3:"UMI",iso_n3:"581"},geometry:{type:"Polygon",coordinates:[[[166.61939537900003,19.281642971000053],[166.64421634200005,19.27558014500005],[166.63819420700008,19.286444403000075],[166.61939537900003,19.281642971000053]]]}},{type:"Feature",properties:{name:"吉布提",full_name:"吉布提共和国",iso_a2:"DJ",iso_a3:"DJI",iso_n3:"262"},geometry:{type:"Polygon",coordinates:[[[43.245996,11.499805],[42.521777,11.572168],[43.380273,12.09126],[43.116699,12.708594],[42.703711,12.380322],[42.378516,12.466406],[41.792676,11.686035],[41.798242,10.980469],[42.922754,10.999316],[43.245996,11.499805]]]}},{type:"Feature",properties:{name:"格陵兰",full_name:"格陵兰",iso_a2:"GL",iso_a3:"GRL",iso_n3:"304"},geometry:{type:"MultiPolygon",coordinates:[[[[-29.952881,83.564844],[-37.72334,83.497754],[-38.15625,82.998633],[-40.356836,83.332178],[-41.300146,83.100781],[-43.009277,83.2646],[-46.169043,83.063867],[-46.136816,82.858838],[-41.369629,82.75],[-45.556543,82.747021],[-44.238867,82.368164],[-44.729492,81.779834],[-50.037109,82.472412],[-49.541064,81.918066],[-53.022559,82.321729],[-53.555664,81.653271],[-54.548877,82.350635],[-59.261816,82.006641],[-56.615137,81.362891],[-59.281934,81.884033],[-60.842871,81.855371],[-61.435986,81.133594],[-62.903369,81.218359],[-63.028662,80.889551],[-64.515527,81],[-67.050635,80.384521],[-66.843652,80.076221],[-64.17915,80.099268],[-65.825537,79.17373],[-71.651318,78.623145],[-72.818066,78.194336],[-69.351367,77.467139],[-66.691211,77.681201],[-66.389453,77.280273],[-68.135547,77.37959],[-71.141455,77.028662],[-68.114258,76.650635],[-69.484082,76.39917],[-68.14873,76.067041],[-66.674805,75.977393],[-66.992578,76.212939],[-63.291309,76.352051],[-58.516211,75.689062],[-58.565527,75.352734],[-56.255469,74.526807],[-57.230566,74.125293],[-56.225391,74.129102],[-55.288281,73.3271],[-55.668555,73.00791],[-54.737939,72.87251],[-55.601709,72.453467],[-55.581445,72.178857],[-54.840137,72.356104],[-55.594043,71.553516],[-53.962988,71.458984],[-53.652148,72.362646],[-53.440088,71.579004],[-51.769922,71.671729],[-53.007568,71.17998],[-51.018945,71.001318],[-51.774316,71.010449],[-50.872363,70.364893],[-52.801953,70.750586],[-54.530762,70.699268],[-52.254639,70.058936],[-50.291699,70.014453],[-50.945703,68.682666],[-51.623145,68.534814],[-52.60459,68.70874],[-53.383154,68.297363],[-51.210156,68.419922],[-51.456494,68.116064],[-53.151562,68.207764],[-53.735205,67.549023],[-52.344824,67.836914],[-50.968848,67.806641],[-50.613477,67.52793],[-52.666455,67.749707],[-53.884424,67.135547],[-52.386865,66.881152],[-53.41875,66.648535],[-53.53877,66.139355],[-51.225,66.881543],[-53.392041,66.04834],[-53.198975,65.594043],[-52.55127,65.461377],[-51.091895,65.775781],[-52.537695,65.328809],[-51.922607,64.21875],[-50.721582,64.797607],[-50.960645,65.201123],[-50.121631,64.70376],[-50.008984,64.447266],[-50.49209,64.693164],[-51.40376,64.463184],[-51.584912,64.103174],[-50.260693,64.214258],[-51.54751,64.006104],[-51.468848,63.642285],[-50.390088,62.822021],[-49.793115,63.044629],[-50.319238,62.473193],[-49.553467,62.232715],[-49.623779,61.998584],[-48.828711,62.079688],[-49.380273,61.890186],[-49.289062,61.589941],[-48.386426,61.004736],[-47.770312,60.997754],[-48.180811,60.769238],[-46.874463,60.816406],[-45.870215,61.218311],[-46.046631,60.615723],[-45.380518,60.444922],[-44.756738,60.6646],[-45.379248,60.20293],[-44.613281,60.01665],[-44.224365,60.273535],[-44.412939,59.922607],[-43.906543,59.815479],[-43.955029,60.025488],[-43.1229,60.06123],[-43.212988,60.390674],[-43.922705,60.595361],[-43.044092,60.523682],[-42.585303,61.71748],[-42.110205,61.857227],[-42.152979,62.568457],[-42.94165,62.720215],[-41.908984,62.737109],[-41.634473,62.972461],[-42.174512,63.208789],[-41.387891,63.061865],[-40.550391,63.725244],[-40.617773,64.131738],[-41.581006,64.29834],[-40.781738,64.221777],[-40.182227,64.479932],[-41.084424,65.10083],[-39.937256,65.141602],[-39.57793,65.340771],[-40.173535,65.556152],[-38.203369,65.711719],[-38.520361,66.009668],[-38.139941,65.903516],[-37.752344,66.261523],[-38.156641,66.385596],[-37.278711,66.304395],[-37.954785,65.633594],[-36.665186,65.790088],[-36.527246,66.007715],[-36.379199,65.830811],[-35.630078,66.139941],[-35.867236,66.441406],[-35.188574,66.250293],[-34.198242,66.655078],[-32.164551,67.991113],[-32.327441,68.437305],[-30.978564,68.061328],[-26.48291,68.675928],[-22.287061,70.033398],[-25.529883,70.353174],[-27.38418,69.991602],[-27.56084,70.124463],[-26.621777,70.463379],[-29.07207,70.444971],[-28.069873,70.699023],[-28.398438,70.99292],[-26.71792,70.950488],[-25.742236,71.183594],[-25.842725,71.480176],[-27.087207,71.626562],[-25.885156,71.571924],[-24.562207,71.223535],[-23.327832,70.450977],[-22.690674,70.437305],[-22.437012,70.86001],[-22.384131,70.462402],[-21.522656,70.526221],[-21.752246,71.47832],[-22.479639,71.383447],[-21.959668,71.744678],[-25.117871,72.346973],[-24.81333,72.901514],[-26.657617,72.71582],[-24.62998,73.037646],[-24.069043,72.49873],[-22.293213,72.119531],[-22.036328,72.918457],[-24.132666,73.409375],[-27.348047,73.067822],[-27.561621,73.138477],[-26.541846,73.248975],[-27.27041,73.436279],[-26.062305,73.253027],[-24.79126,73.511279],[-25.521289,73.851611],[-22.346875,73.269238],[-20.509668,73.492871],[-20.367285,73.848242],[-22.134814,73.990479],[-22.321582,74.302539],[-21.94292,74.565723],[-21.954932,74.244287],[-20.653125,74.137354],[-19.369141,74.284033],[-19.287012,74.546387],[-19.984912,74.975195],[-20.861572,74.635938],[-20.985791,75.074365],[-22.232861,75.119727],[-20.484961,75.314258],[-19.526367,75.180225],[-19.508984,75.75752],[-20.103613,76.219092],[-21.488232,76.271875],[-22.609326,76.704297],[-20.486719,76.920801],[-18.510303,76.778174],[-18.442627,77.259375],[-20.680811,77.618994],[-19.49043,77.718896],[-20.862598,77.911865],[-21.72959,77.708545],[-21.13374,78.658643],[-18.991992,79.178369],[-20.150146,80.01123],[-19.429199,80.257715],[-16.48877,80.251953],[-16.760596,80.573389],[-11.430664,81.456836],[-14.241992,81.813867],[-17.456055,81.397705],[-19.629932,81.639893],[-23.117725,80.778174],[-21.337988,82.068701],[-24.293066,81.700977],[-25.148828,82.001123],[-29.887402,82.054834],[-23.118066,82.324707],[-21.58252,82.63418],[-25.123389,83.159619],[-32.032715,82.983447],[-25.795068,83.260986],[-29.952881,83.564844]]],[[[-52.731152,69.944727],[-54.371631,70.317285],[-54.919141,69.713623],[-53.578418,69.256641],[-51.900195,69.604785],[-52.731152,69.944727]]],[[[-55.016895,72.791113],[-56.214795,72.719189],[-55.566602,72.564355],[-55.016895,72.791113]]],[[[-44.864551,82.083643],[-44.91748,82.480518],[-47.272266,82.656934],[-44.864551,82.083643]]],[[[-25.432324,70.921338],[-27.617236,70.91377],[-28.035254,70.486816],[-26.604687,70.553369],[-26.217871,70.454053],[-25.432324,70.921338]]],[[[-17.6125,79.825879],[-17.98291,80.055176],[-19.138281,79.852344],[-17.6125,79.825879]]],[[[-18.000537,75.407324],[-18.856055,75.319141],[-18.670801,75.00166],[-17.391992,75.036914],[-18.000537,75.407324]]],[[[-46.266699,60.781396],[-46.205225,60.943506],[-46.788086,60.758398],[-46.266699,60.781396]]]]}},{type:"Feature",properties:{name:"法罗群岛",full_name:"法罗群岛（丹麦）",iso_a2:"FO",iso_a3:"FRO",iso_n3:"234"},geometry:{type:"Polygon",coordinates:[[[-6.631055,62.227881],[-7.172168,62.285596],[-6.725195,61.951465],[-6.631055,62.227881]]]}},{type:"Feature",properties:{name:"丹麦",full_name:"丹麦王国",iso_a2:"DK",iso_a3:"DNK",iso_n3:"208"},geometry:{type:"MultiPolygon",coordinates:[[[[12.56875,55.785059],[12.218945,56.118652],[11.819727,55.697656],[11.627734,55.956885],[10.978906,55.721533],[11.862305,54.772607],[12.56875,55.785059]]],[[[9.739746,54.825537],[9.591113,55.493213],[10.926172,56.443262],[10.282715,56.620508],[10.609961,57.736914],[8.284082,56.852344],[8.468359,56.664551],[9.254883,57.011719],[8.67168,56.495654],[8.163965,56.606885],[8.132129,55.599805],[8.615918,55.418213],[8.670313,54.903418],[9.739746,54.825537]]],[[[10.645117,55.609814],[9.860645,55.515479],[9.98877,55.163184],[10.785254,55.133398],[10.645117,55.609814]]],[[[11.361426,54.89165],[11.035547,54.773096],[11.765918,54.679443],[11.361426,54.89165]]]]}},{type:"Feature",properties:{name:"捷克",full_name:"捷克共和国",iso_a2:"CZ",iso_a3:"CZE",iso_n3:"203"},geometry:{type:"Polygon",coordinates:[[[18.832227,49.510791],[18.562402,49.879346],[17.627051,50.116406],[17.702246,50.307178],[16.880078,50.427051],[16.63916,50.102148],[16.282227,50.655615],[14.99375,51.014355],[14.809375,50.858984],[14.319727,51.037793],[12.942676,50.406445],[12.089844,50.301758],[12.681152,49.414502],[13.814746,48.766943],[14.691309,48.599219],[15.066797,48.997852],[16.953125,48.598828],[18.832227,49.510791]]]}},{type:"Feature",properties:{name:"北塞浦路斯",full_name:"北塞浦路斯土耳其共和国",iso_a2:"-99",iso_a3:"-99",iso_n3:"-99"},geometry:{type:"Polygon",coordinates:[[[34.004492,35.065234],[33.941992,35.292041],[34.556055,35.662061],[32.712695,35.171045],[34.004492,35.065234]]]}},{type:"Feature",properties:{name:"塞浦路斯",full_name:"塞浦路斯共和国",iso_a2:"CY",iso_a3:"CYP",iso_n3:"196"},geometry:{type:"Polygon",coordinates:[[[32.712695,35.171045],[32.317188,34.95332],[33.00791,34.56958],[34.004492,35.065234],[32.712695,35.171045]]]}},{type:"Feature",properties:{name:"古巴",full_name:"古巴共和国",iso_a2:"CU",iso_a3:"CUB",iso_n3:"192"},geometry:{type:"MultiPolygon",coordinates:[[[[-81.837451,23.163037],[-84.044922,22.666016],[-84.361279,22.378906],[-84.326367,22.074316],[-84.887207,21.856982],[-84.030957,21.943115],[-82.738037,22.689258],[-81.838818,22.672461],[-81.710352,22.49668],[-82.077734,22.387695],[-81.849414,22.213672],[-81.185498,22.267969],[-79.357422,21.585156],[-78.727686,21.592725],[-78.116357,20.761865],[-77.22959,20.64375],[-77.103809,20.40752],[-77.715088,19.855469],[-75.116406,19.901416],[-74.153711,20.168555],[-74.882568,20.650635],[-75.724561,20.714551],[-75.722949,21.111035],[-77.252881,21.483496],[-77.366162,21.612646],[-77.144141,21.643604],[-77.497266,21.871631],[-79.275684,22.407617],[-79.820264,22.887012],[-81.837451,23.163037]]],[[[-82.561768,21.57168],[-82.991211,21.942725],[-82.973584,21.592285],[-83.183789,21.593457],[-82.561768,21.57168]]]]}},{type:"Feature",properties:{name:"克罗地亚",full_name:"克罗地亚共和国",iso_a2:"HR",iso_a3:"HRV",iso_n3:"191"},geometry:{type:"MultiPolygon",coordinates:[[[[13.57793,45.516895],[13.860742,44.837402],[14.550488,45.297705],[15.470996,44.271973],[15.18584,44.172119],[15.985547,43.519775],[16.903125,43.392432],[17.585156,42.938379],[15.736621,44.76582],[15.788086,45.178955],[16.293359,45.008838],[16.918652,45.276562],[19.007129,44.869189],[19.4,45.2125],[19.004688,45.399512],[18.905371,45.931738],[17.807129,45.79043],[16.516211,46.499902],[15.635938,46.200732],[15.339453,45.467041],[14.568848,45.657227],[13.57793,45.516895]]],[[[14.810254,44.977051],[14.571094,45.224756],[14.450391,45.079199],[14.810254,44.977051]]],[[[18.436328,42.559717],[17.667578,42.897119],[17.04541,43.014893],[18.51748,42.43291],[18.436328,42.559717]]]]}},{type:"Feature",properties:{name:"科特迪瓦",full_name:"科特迪瓦共和国",iso_a2:"CI",iso_a3:"CIV",iso_n3:"384"},geometry:{type:"Polygon",coordinates:[[[-7.990625,10.1625],[-8.136963,9.495703],[-7.896191,9.415869],[-7.950977,8.786816],[-7.681201,8.410352],[-8.236963,8.455664],[-8.009863,8.078516],[-8.231885,7.556738],[-8.486426,7.558496],[-8.302344,6.980957],[-8.603564,6.507812],[-7.454395,5.841309],[-7.544971,4.351318],[-5.061816,5.130664],[-5.282373,5.210254],[-3.347559,5.130664],[-3.199951,5.354492],[-3.019141,5.130811],[-2.75498,5.43252],[-3.235791,6.807227],[-2.505859,8.20874],[-2.69585,9.481348],[-3.223535,9.895459],[-4.62583,9.713574],[-5.523535,10.426025],[-6.196875,10.232129],[-6.261133,10.724072],[-6.65415,10.656445],[-7.01709,10.143262],[-7.497949,10.439795],[-7.990625,10.1625]]]}},{type:"Feature",properties:{name:"哥斯达黎加",full_name:"哥斯达黎加共和国",iso_a2:"CR",iso_a3:"CRI",iso_n3:"188"},geometry:{type:"Polygon",coordinates:[[[-82.563574,9.57666],[-83.641992,10.917236],[-83.919287,10.735352],[-84.63418,11.045605],[-85.744336,11.062109],[-85.908008,10.897559],[-85.667236,10.74502],[-85.849658,10.292041],[-85.681006,9.958594],[-85.114502,9.581787],[-84.886426,9.820947],[-85.263184,10.256641],[-85.025049,10.115723],[-84.581592,9.568359],[-83.637256,9.035352],[-83.604736,8.480322],[-83.291504,8.406006],[-83.469727,8.706836],[-83.285791,8.664355],[-82.879346,8.070654],[-83.027344,8.337744],[-82.727832,8.916064],[-82.939844,9.44917],[-82.563574,9.57666]]]}},{type:"Feature",properties:{name:"刚果（金）",full_name:"刚果民主共和国",iso_a2:"CD",iso_a3:"COD",iso_n3:"180"},geometry:{type:"Polygon",coordinates:[[[30.751172,-8.193652],[30.212695,-7.037891],[29.54082,-6.313867],[29.403223,-4.449316],[29.014355,-2.720215],[28.876367,-2.400293],[29.576953,-1.387891],[29.942871,.819238],[31.252734,2.04458],[30.728613,2.455371],[30.838574,3.490723],[29.676855,4.586914],[28.19209,4.350244],[27.40332,5.10918],[25.525098,5.312109],[25.065234,4.967432],[22.864551,4.723877],[22.422168,4.134961],[20.558105,4.462695],[19.500977,5.12749],[18.594141,4.34624],[18.610352,3.478418],[18.072168,2.013281],[17.752832,-.549023],[16.879883,-1.225879],[16.215332,-2.177832],[15.990039,-3.766211],[14.70791,-4.881738],[14.410742,-4.83125],[14.358301,-4.299414],[13.71709,-4.454492],[13.414941,-4.837402],[13.072754,-4.634766],[12.451465,-5.071484],[12.503711,-5.695801],[12.213672,-5.758691],[12.45293,-6.000488],[13.068164,-5.864844],[16.431445,-5.900195],[17.57959,-8.099023],[19.34082,-7.966602],[19.527637,-7.144434],[19.875195,-6.986328],[20.590039,-6.919922],[20.607813,-7.277734],[21.781641,-7.314648],[21.813184,-9.46875],[22.274512,-10.259082],[22.226172,-11.121973],[23.966504,-10.871777],[24.365723,-11.129883],[24.37793,-11.41709],[25.28877,-11.212402],[25.349414,-11.623047],[26.025977,-11.890137],[26.824023,-11.965234],[27.15918,-11.579199],[27.573828,-12.227051],[28.412891,-12.518066],[29.014258,-13.368848],[29.554199,-13.248926],[29.775195,-13.438086],[29.795117,-12.155469],[29.485547,-12.418457],[29.064355,-12.348828],[28.383398,-11.566699],[28.645508,-10.550195],[28.400684,-9.224805],[28.898145,-8.485449],[30.751172,-8.193652]]]}},{type:"Feature",properties:{name:"刚果（布）",full_name:"刚果共和国",iso_a2:"CG",iso_a3:"COG",iso_n3:"178"},geometry:{type:"Polygon",coordinates:[[[11.130176,-3.916309],[12.018359,-5.004297],[12.798242,-4.430566],[13.072754,-4.634766],[13.414941,-4.837402],[13.71709,-4.454492],[14.358301,-4.299414],[14.410742,-4.83125],[14.70791,-4.881738],[15.990039,-3.766211],[16.215332,-2.177832],[16.879883,-1.225879],[17.752832,-.549023],[18.072168,2.013281],[18.610352,3.478418],[17.491602,3.687305],[16.610742,3.505371],[16.183398,2.270068],[16.059375,1.676221],[14.578906,2.199121],[13.293555,2.161572],[13.216309,1.248438],[14.180859,1.370215],[14.429883,.901465],[13.949609,.353809],[13.860059,-.20332],[14.474121,-.573438],[14.383984,-1.890039],[13.993848,-2.490625],[13.733789,-2.138477],[13.464941,-2.39541],[12.991992,-2.313379],[12.59043,-1.826855],[12.446387,-2.32998],[11.605469,-2.342578],[11.537793,-2.836719],[11.93418,-3.318555],[11.879883,-3.665918],[11.504297,-3.520312],[11.130176,-3.916309]]]}},{type:"Feature",properties:{name:"科摩罗",full_name:"科摩罗联盟",iso_a2:"KM",iso_a3:"COM",iso_n3:"174"},geometry:{type:"MultiPolygon",coordinates:[[[[44.476367,-12.081543],[44.220117,-12.171387],[44.50498,-12.356543],[44.476367,-12.081543]]],[[[43.46582,-11.90127],[43.299023,-11.374512],[43.22666,-11.751855],[43.46582,-11.90127]]]]}},{type:"Feature",properties:{name:"哥伦比亚",full_name:"哥伦比亚共和国",iso_a2:"CO",iso_a3:"COL",iso_n3:"170"},geometry:{type:"Polygon",coordinates:[[[-71.319727,11.861914],[-71.137305,12.046338],[-71.262109,12.335303],[-71.714551,12.419971],[-73.313379,11.295752],[-74.14292,11.32085],[-74.400879,10.765234],[-74.330225,10.99668],[-74.84458,11.109717],[-75.70835,10.143408],[-75.538574,10.205176],[-75.639355,9.450439],[-76.920459,8.57373],[-76.786572,7.931592],[-77.374219,8.658301],[-77.195996,7.972461],[-77.538281,7.56626],[-77.761914,7.698828],[-77.901172,7.229346],[-77.368799,6.575586],[-77.469434,6.176758],[-77.249268,5.780176],[-77.534424,5.537109],[-77.286328,4.721729],[-77.520703,4.212793],[-77.076807,3.913281],[-77.813574,2.716357],[-78.591699,2.356641],[-78.576904,1.773779],[-79.025439,1.623682],[-78.859668,1.455371],[-77.702881,.837842],[-77.396338,.393896],[-76.494629,.235449],[-76.270605,.439404],[-75.284473,-.106543],[-74.801758,-.200098],[-74.246387,-.970605],[-73.664307,-1.248828],[-72.941113,-2.394043],[-70.968555,-2.206836],[-70.09585,-2.658203],[-70.735107,-3.781543],[-70.339502,-3.814355],[-69.965918,-4.235938],[-69.400244,-1.194922],[-69.633984,-.509277],[-70.070508,-.138867],[-70.053906,.578613],[-69.15332,.658789],[-69.311816,1.050488],[-69.852148,1.059521],[-69.848584,1.70874],[-68.176562,1.719824],[-68.193799,1.987012],[-67.93623,1.748486],[-67.400439,2.116699],[-67.082275,1.1854],[-66.876025,1.223047],[-67.21084,2.390137],[-67.859082,2.793604],[-67.311133,3.415869],[-67.855273,4.506885],[-67.481982,6.180273],[-69.427148,6.123975],[-70.129199,6.953613],[-72.006641,7.032617],[-72.471973,7.524268],[-72.390332,8.287061],[-72.796387,9.108984],[-73.366211,9.194141],[-72.690088,10.83584],[-71.958105,11.666406],[-71.319727,11.861914]]]}},{type:"Feature",properties:{name:"中国",full_name:"中华人民共和国",iso_a2:"CN",iso_a3:"CHN",iso_n3:"156"},geometry:{type:"MultiPolygon",coordinates:[[[[107.972656,21.507959],[108.502148,21.633447],[108.479883,21.904639],[109.081543,21.440283],[109.521484,21.693408],[109.930762,21.480566],[109.662598,20.916895],[110.123145,20.263721],[110.517578,20.46001],[110.154004,20.944629],[110.410937,21.338135],[110.567187,21.214062],[111.602734,21.559082],[111.943945,21.849658],[112.30498,21.741699],[112.359668,21.978027],[112.586328,21.776855],[113.08877,22.207959],[113.548145,22.222607],[113.331055,22.912012],[113.519727,23.1021],[114.01543,22.511914],[113.937305,22.36499],[114.267969,22.295557],[114.266016,22.540967],[116.470703,22.945898],[116.910645,23.64668],[117.367676,23.588623],[118.056055,24.246094],[117.842676,24.474316],[118.657031,24.621436],[118.977539,25.209277],[119.285547,25.232227],[119.180078,25.449805],[119.622461,25.391162],[119.61875,26.003564],[119.139453,26.121777],[119.463086,26.054688],[119.881055,26.33418],[119.588184,26.784961],[120.086719,26.671582],[120.747656,28.009961],[121.145703,28.32666],[121.609961,28.292139],[121.487109,29.193164],[121.917773,29.13501],[121.941211,29.605908],[121.50625,29.48457],[122.08291,29.870361],[121.258008,30.304102],[120.194629,30.241309],[121.87793,30.916992],[120.715527,31.98374],[120.035937,31.936279],[120.520117,32.105859],[121.856348,31.816455],[120.853223,32.661377],[120.266699,34.274023],[119.165332,34.848828],[120.284766,35.984424],[120.183301,36.202441],[120.637891,36.129932],[120.81084,36.632812],[121.932715,36.959473],[122.340918,36.832227],[122.666992,37.402832],[121.640234,37.460352],[120.75,37.833936],[119.760547,37.155078],[119.287402,37.138281],[118.952637,37.331152],[118.940039,38.042773],[117.766699,38.31167],[117.616699,38.852881],[117.865723,39.19126],[118.976953,39.182568],[119.391113,39.75249],[120.479102,40.230957],[121.174512,40.90127],[121.834863,40.974268],[122.275,40.541846],[121.26748,39.544678],[121.818457,39.386523],[121.106738,38.920801],[121.163574,38.731641],[122.840039,39.60083],[124.362109,40.004053],[125.989062,40.904639],[126.743066,41.724854],[128.149414,41.387744],[128.045215,41.9875],[128.923438,42.038232],[129.697852,42.448145],[129.898242,42.998145],[130.526953,42.5354],[130.424805,42.727051],[131.068555,42.902246],[131.257324,43.378076],[130.981641,44.844336],[131.851855,45.326855],[133.113477,45.130713],[134.167676,47.302197],[134.752344,47.71543],[134.665234,48.253906],[135.083406,48.436324],[134.293359,48.373438],[133.144043,48.105664],[132.47627,47.71499],[130.961914,47.709326],[130.553125,48.861182],[129.498145,49.388818],[127.550781,49.801807],[127.590234,50.208984],[125.649023,53.042285],[123.607813,53.546533],[120.985449,53.28457],[120.094531,52.787207],[120.656152,52.56665],[120.749805,52.096533],[119.163672,50.406006],[119.259863,50.066406],[117.873438,49.513477],[116.683301,49.823779],[115.616406,47.874805],[115.898242,47.686914],[116.760547,47.869775],[117.350781,47.652197],[117.768359,47.987891],[118.498438,47.983984],[119.711133,47.15],[119.867188,46.672168],[117.438086,46.58623],[117.333398,46.362012],[116.562598,46.289795],[115.681055,45.458252],[114.560156,45.38999],[113.587012,44.745703],[111.898047,45.064062],[111.402246,44.367285],[111.933203,43.711426],[110.400391,42.773682],[109.339844,42.438379],[106.77002,42.288721],[104.982031,41.595508],[104.498242,41.658691],[104.498242,41.877002],[103.711133,41.751318],[102.156641,42.158105],[101.495313,42.53877],[96.385449,42.720361],[95.350293,44.278076],[93.516211,44.944482],[90.877246,45.196094],[90.869922,46.954492],[90.02793,47.877686],[89.047656,48.002539],[87.979688,48.555127],[87.814258,49.162305],[87.322852,49.085791],[86.808301,49.049707],[86.549414,48.528613],[85.749414,48.385059],[85.484766,47.063525],[84.786133,46.830713],[83.029492,47.185938],[82.315234,45.594922],[82.521484,45.125488],[81.691992,45.349365],[79.871875,44.883789],[80.481543,44.714648],[80.355273,44.097266],[80.785742,43.161572],[80.202246,42.734473],[80.209375,42.190039],[78.123438,41.075635],[76.907715,41.02417],[76.318555,40.352246],[75.677148,40.305811],[75.555566,40.625195],[74.835156,40.482617],[73.991602,40.043115],[73.631641,39.448877],[73.80166,38.606885],[74.812305,38.460303],[75.11875,37.385693],[74.891309,37.231641],[74.372168,37.157715],[74.541406,37.022168],[75.772168,36.694922],[75.912305,36.048975],[76.766895,35.661719],[77.799414,35.495898],[78.042676,35.479785],[78.326953,34.606396],[78.970117,34.302637],[78.72666,34.013379],[79.219336,32.501074],[78.918945,32.358203],[78.700879,32.597021],[78.389648,32.519873],[78.807678,31.099982],[79.707774,31.013593],[81.010254,30.164502],[82.043359,30.326758],[83.583496,29.183594],[84.101367,29.219971],[84.228711,28.911768],[85.159082,28.592236],[85.122461,28.315967],[85.67832,28.277441],[85.994531,27.9104],[86.137012,28.114355],[87.141406,27.83833],[88.109766,27.870605],[88.803711,28.006934],[88.891406,27.316064],[89.981055,28.311182],[90.352734,28.080225],[91.273047,28.078369],[91.631934,27.759961],[91.594727,27.557666],[92.083398,27.290625],[91.99834,26.85498],[92.64698,26.952656],[93.111399,26.880082],[93.817265,27.025183],[94.277372,27.58143],[94.88592,27.743098],[95.28628,27.939955],[95.39715,28.142259],[95.832003,28.295186],[96.275479,28.228241],[97.086778,27.7475],[97.335156,27.937744],[97.322461,28.217969],[97.599219,28.517041],[98.061621,28.185889],[98.298828,27.550098],[98.651172,27.572461],[98.738477,26.785742],[98.65625,25.863574],[97.819531,25.251855],[97.583301,24.774805],[97.564551,23.911035],[98.835059,24.121191],[98.676758,23.905078],[98.86377,23.19126],[99.507129,22.959131],[99.192969,22.125977],[99.917676,22.028027],[100.147656,21.480518],[101.079785,21.755859],[101.138867,21.56748],[101.247852,21.197314],[101.800586,21.212598],[101.524512,22.253662],[101.73877,22.495264],[102.127441,22.379199],[102.470898,22.750928],[102.981934,22.448242],[103.32666,22.769775],[103.941504,22.540088],[105.275391,23.345215],[105.842969,22.922803],[106.780273,22.778906],[106.550391,22.501367],[106.663574,21.978906],[107.972656,21.507959]]],[[[110.88877,19.991943],[110.651758,20.137744],[109.263477,19.882666],[108.665527,19.304102],[108.701563,18.535254],[109.519336,18.218262],[110.067383,18.447559],[111.013672,19.655469],[110.88877,19.991943]]],[[[121.008789,22.620361],[121.397461,23.17251],[121.929004,24.97373],[121.593652,25.275342],[121.040625,25.032812],[120.132129,23.65293],[120.232813,22.71792],[120.839844,21.925],[121.008789,22.620361]]],[[[124.4751,25.9358],[124.4641,25.8592],[124.6536,25.9111],[124.5822,25.9655],[124.4751,25.9358]]],[[[123.7143,26.0025],[123.7967,25.921],[123.7198,25.8716],[123.5962,25.921],[123.7143,26.0025]]],[[[123.4946,25.7554],[123.5797,25.6861],[123.3325,25.6192],[123.2639,25.6712],[123.327,25.7306],[123.4946,25.7554]]],[[[116.769628,20.771721],[116.889736,20.683284],[116.749302,20.600958],[116.862635,20.588633],[116.925461,20.726949],[116.769628,20.771721]]],[[[111.7447,16.552],[111.7886,16.5125],[111.7392,16.4598],[111.7447,16.552]]],[[[111.8134,16.2621],[111.8161,16.2252],[111.5689,16.1619],[111.662292,16.260163],[111.8134,16.2621]]],[[[112.6126,16.059],[112.4753,16.0009],[112.4615,16.0432],[112.6126,16.059]]],[[[113.896887,7.607204],[114.058879,7.537794],[114.368696,7.638642],[114.540543,7.945783],[113.896887,7.607204]]],[[[109.463972,7.344339],[109.948716,7.522962],[109.653065,7.559745],[109.463972,7.344339]]],[[[116.48876,10.395686],[116.467202,10.309144],[116.644592,10.335051],[116.48876,10.395686]]],[[[122.518653,23.460785],[122.798614,24.573674],[122.779218,24.578553],[122.499257,23.465664],[122.518653,23.460785]]],[[[121.172026,20.805459],[121.909388,21.687433],[121.894044,21.700262],[121.156682,20.818287],[121.172026,20.805459]]],[[[119.473662,18.007073],[120.025697,19.024038],[120.00812,19.033579],[119.456084,18.016614],[119.473662,18.007073]]],[[[119.072182,15.007514],[119.072676,16.043885],[119.052676,16.043885],[119.052184,15.00781],[119.072182,15.007514]]],[[[118.686467,11.189592],[118.524042,10.912566],[118.540436,10.90292],[118.704762,11.181475],[118.874599,11.607472],[118.98895,11.985731],[118.969805,11.991519],[118.855579,11.613671],[118.686467,11.189592]]],[[[115.544669,7.146723],[116.250486,7.979279],[116.23523,7.992212],[115.529413,7.159656],[115.544669,7.146723]]],[[[112.307052,3.534873],[111.786901,3.416873],[111.791326,3.397368],[112.312489,3.515623],[112.521474,3.578591],[112.852064,3.732569],[112.843614,3.750696],[112.515016,3.597533],[112.307052,3.534873]]],[[[108.290133,6.012663],[108.308786,6.019877],[108.279563,6.095434],[108.256117,6.227526],[108.2168,6.538165],[108.218763,6.949641],[108.244195,7.073907],[108.224601,7.077917],[108.198768,6.950725],[108.196797,6.537606],[108.236307,6.224768],[108.26004,6.090984],[108.290133,6.012663]]],[[[110.128228,11.368945],[110.055537,11.253354],[110.072467,11.242707],[110.145887,11.359542],[110.207005,11.481288],[110.259018,11.604996],[110.304569,11.783642],[110.328228,11.945713],[110.334243,12.141598],[110.332274,12.240384],[110.312278,12.239982],[110.314245,12.141953],[110.308355,11.948035],[110.284855,11.787051],[110.239823,11.610665],[110.188981,11.489964],[110.128228,11.368945]]],[[[109.845225,15.153166],[109.864809,15.157224],[109.848892,15.233933],[109.789745,15.450683],[109.690053,15.675484],[109.591475,15.836774],[109.532015,15.922592],[109.30888,16.207258],[109.29314,16.194919],[109.515744,15.910958],[109.57456,15.826099],[109.672646,15.665615],[109.77065,15.444688],[109.829516,15.228968],[109.845225,15.153166]]]]}},{type:"Feature",properties:{name:"智利",full_name:"智利共和国",iso_a2:"CL",iso_a3:"CHL",iso_n3:"152"},geometry:{type:"MultiPolygon",coordinates:[[[[-70.418262,-18.345605],[-70.080029,-21.356836],[-70.593359,-23.255469],[-70.392334,-23.565918],[-70.445361,-25.172656],[-70.925781,-27.588672],[-71.519238,-28.926465],[-71.315723,-29.649707],[-71.708936,-30.628027],[-71.452246,-32.65957],[-72.223779,-35.096191],[-73.215967,-37.166895],[-73.662402,-37.341016],[-73.226465,-39.224414],[-73.965869,-41.118262],[-73.624023,-41.773633],[-72.318262,-41.499023],[-72.824072,-41.908789],[-72.499414,-41.980859],[-72.412354,-42.388184],[-72.773242,-42.257715],[-72.758008,-43.039453],[-73.224463,-43.897949],[-73.265088,-44.168652],[-72.663867,-44.436426],[-72.680078,-44.593945],[-73.444971,-45.238184],[-72.933838,-45.452344],[-73.730762,-45.47998],[-73.591846,-45.899121],[-73.845361,-46.566016],[-73.735254,-45.811719],[-73.967578,-46.154102],[-74.392969,-46.217383],[-74.019922,-46.055859],[-73.957178,-45.404395],[-74.157861,-45.767188],[-75.066699,-45.874902],[-74.924463,-46.159668],[-75.706396,-46.705273],[-75.430371,-46.93457],[-75.540332,-46.69873],[-74.98418,-46.512109],[-75.005957,-46.741113],[-74.313574,-46.788184],[-74.158398,-47.18252],[-74.482666,-47.430469],[-74.134082,-47.59082],[-74.654932,-47.702246],[-74.227051,-47.968945],[-73.715869,-47.655469],[-73.391064,-48.145898],[-74.584668,-47.999023],[-74.474414,-48.463965],[-74.009082,-48.475],[-74.341016,-48.595703],[-74.366553,-49.400488],[-73.934961,-49.020898],[-73.836377,-49.609375],[-74.29082,-49.604102],[-73.958594,-49.994727],[-74.62959,-50.194043],[-73.950342,-50.510547],[-74.185596,-50.485352],[-73.978027,-50.827051],[-73.654443,-50.492676],[-73.806543,-50.938379],[-74.139404,-50.817773],[-74.365576,-50.487891],[-74.644482,-50.360938],[-74.685742,-50.662012],[-75.094678,-50.68125],[-74.814746,-51.062891],[-73.939502,-51.266309],[-74.19668,-51.680566],[-73.518164,-52.041016],[-72.600049,-51.799121],[-73.16875,-51.453906],[-72.76123,-51.573242],[-72.489648,-51.763672],[-72.52334,-52.255469],[-72.677051,-52.384668],[-72.79502,-51.949512],[-73.834473,-52.233984],[-74.264941,-52.104883],[-74.014453,-52.639355],[-73.123926,-52.487988],[-73.645215,-52.837012],[-73.122461,-53.073926],[-72.712109,-52.535547],[-71.511279,-52.605371],[-72.727686,-52.762305],[-73.052734,-53.243457],[-72.548926,-53.460742],[-72.278027,-53.132324],[-71.227148,-52.810645],[-71.791455,-53.48457],[-71.941699,-53.234082],[-72.412891,-53.350195],[-71.297754,-53.883398],[-70.795117,-52.76875],[-69.241016,-52.205469],[-68.443359,-52.356641],[-69.960254,-52.008203],[-71.918652,-51.989551],[-72.407666,-51.54082],[-72.340234,-50.681836],[-73.15293,-50.738281],[-73.50127,-50.125293],[-73.554199,-49.463867],[-72.354736,-48.36582],[-72.51792,-47.876367],[-71.699658,-46.651367],[-71.746191,-45.578906],[-71.349316,-45.331934],[-72.063721,-44.771875],[-71.261133,-44.763086],[-71.159717,-44.560254],[-71.82002,-44.383105],[-71.750635,-43.237305],[-72.146436,-42.990039],[-72.108203,-42.251855],[-71.75,-42.046777],[-71.932129,-40.691699],[-71.401562,-38.935059],[-70.858643,-38.604492],[-71.192187,-36.843652],[-70.404785,-36.061719],[-70.555176,-35.246875],[-69.852441,-34.224316],[-69.819629,-33.283789],[-70.084863,-33.201758],[-70.51958,-31.148438],[-69.844287,-30.175],[-70.026807,-29.324023],[-69.656934,-28.413574],[-68.846338,-27.153711],[-68.318652,-26.973242],[-68.591602,-26.47041],[-68.384229,-25.091895],[-68.562012,-24.747363],[-67.356201,-24.033789],[-67.008789,-23.001367],[-67.194873,-22.82168],[-67.879443,-22.822949],[-68.197021,-21.300293],[-68.760547,-20.416211],[-68.462891,-19.432813],[-68.968311,-18.967969],[-69.093945,-18.050488],[-69.510938,-17.506055],[-69.8521,-17.703809],[-69.926367,-18.206055],[-70.418262,-18.345605]],[[-74.385742,-52.922363],[-74.712012,-52.74873],[-73.135205,-53.353906],[-74.385742,-52.922363]]],[[[-68.629932,-52.652637],[-69.414062,-52.48623],[-69.935449,-52.821094],[-70.380127,-52.751953],[-70.329297,-53.377637],[-69.355957,-53.416309],[-70.151123,-53.888086],[-69.044336,-54.406738],[-69.253174,-54.557422],[-70.535303,-54.136133],[-70.531299,-53.627344],[-70.863086,-54.110449],[-70.310986,-54.528516],[-70.797266,-54.327246],[-71.927734,-54.528711],[-68.653223,-54.853613],[-68.629932,-52.652637]]],[[[-67.079932,-55.153809],[-68.301367,-54.980664],[-68.07002,-55.221094],[-67.079932,-55.153809]]],[[[-73.773389,-43.345898],[-73.436328,-42.936523],[-73.789258,-42.585742],[-73.4229,-42.192871],[-73.527832,-41.896289],[-74.03667,-41.795508],[-74.387354,-43.231641],[-73.773389,-43.345898]]],[[[-74.476172,-49.147852],[-74.546094,-48.766895],[-74.89624,-48.733203],[-75.549805,-49.791309],[-75.066016,-49.852344],[-74.723828,-49.423828],[-74.594727,-50.006641],[-74.476172,-49.147852]]],[[[-75.510254,-48.763477],[-75.158496,-48.622656],[-75.391406,-48.019727],[-75.510254,-48.763477]]],[[[-74.567285,-48.591992],[-74.895654,-47.839355],[-75.212891,-48.141699],[-74.923047,-48.626465],[-74.567285,-48.591992]]],[[[-72.923242,-53.481641],[-73.845459,-53.545801],[-73.210645,-53.98584],[-72.76377,-53.864844],[-72.870996,-54.126562],[-72.20542,-53.807422],[-72.923242,-53.481641]]],[[[-74.822949,-51.630176],[-75.105371,-51.788867],[-74.694482,-52.279199],[-74.822949,-51.630176]]],[[[-69.702979,-54.919043],[-69.979785,-55.147461],[-69.411816,-55.444238],[-69.192627,-55.171875],[-68.04834,-55.643164],[-68.458008,-54.959668],[-69.702979,-54.919043]]],[[[-71.390479,-54.032812],[-71.996484,-53.884863],[-72.210449,-54.047754],[-71.948535,-54.300879],[-71.143262,-54.374023],[-71.021924,-54.111816],[-71.390479,-54.032812]]],[[[-73.735352,-44.394531],[-73.994922,-44.140234],[-74.617773,-44.647949],[-74.01626,-45.344922],[-73.728174,-45.195898],[-74.002051,-44.590918],[-73.735352,-44.394531]]],[[[-72.986133,-44.780078],[-72.776367,-44.508594],[-73.207715,-44.334961],[-73.39707,-44.774316],[-72.986133,-44.780078]]],[[[-75.302002,-50.67998],[-75.115332,-50.510449],[-75.427637,-50.480566],[-75.302002,-50.67998]]],[[[-75.106689,-48.836523],[-75.583105,-48.858887],[-75.641162,-49.19541],[-75.106689,-48.836523]]],[[[-74.558643,-51.277051],[-75.153662,-51.278809],[-75.289111,-51.625391],[-74.558643,-51.277051]]],[[[-75.054785,-50.296094],[-74.875977,-50.109961],[-75.32666,-50.011816],[-75.449121,-50.343359],[-75.054785,-50.296094]]],[[[-74.312891,-45.691504],[-74.310547,-45.172656],[-74.689844,-45.662598],[-74.312891,-45.691504]]],[[[-70.991602,-54.867969],[-71.437207,-54.889258],[-70.297852,-55.11377],[-70.991602,-54.867969]]]]}},{type:"Feature",properties:{name:"乍得",full_name:"乍得共和国",iso_a2:"TD",iso_a3:"TCD",iso_n3:"148"},geometry:{type:"Polygon",coordinates:[[[23.980273,19.496631],[20.147656,21.389258],[15.984082,23.445215],[14.979004,22.996191],[15.181836,21.523389],[15.963184,20.346191],[15.735059,19.904053],[15.474316,16.908398],[13.448242,14.380664],[13.606348,13.70459],[14.063965,13.078516],[14.461719,13.021777],[14.84707,12.5021],[15.132227,10.648486],[15.654883,10.007812],[14.243262,9.979736],[13.977246,9.691553],[15.116211,8.557324],[15.549805,7.787891],[15.480078,7.523779],[15.957617,7.507568],[16.545313,7.865479],[16.784766,7.550977],[17.649414,7.983594],[18.56416,8.045898],[19.108691,8.656152],[18.95625,8.938867],[20.34209,9.1271],[21.682715,10.289844],[21.771484,10.642822],[22.493848,10.99624],[22.860059,10.919678],[22.922656,11.344873],[22.591113,11.579883],[22.352344,12.660449],[21.825293,12.790527],[22.228125,13.32959],[22.106445,13.799805],[22.538574,14.161865],[22.381543,14.550488],[22.932324,15.162109],[22.933887,15.533105],[23.970801,15.721533],[23.980273,19.496631]]]}},{type:"Feature",properties:{name:"中非",full_name:"中非共和国",iso_a2:"CF",iso_a3:"CAF",iso_n3:"140"},geometry:{type:"Polygon",coordinates:[[[24.147363,8.665625],[23.537305,8.81582],[23.646289,9.8229],[22.860059,10.919678],[22.493848,10.99624],[21.771484,10.642822],[21.682715,10.289844],[20.34209,9.1271],[18.95625,8.938867],[19.108691,8.656152],[18.56416,8.045898],[17.649414,7.983594],[16.784766,7.550977],[16.545313,7.865479],[15.957617,7.507568],[15.480078,7.523779],[14.431152,6.038721],[14.73125,4.602393],[15.063574,4.284863],[15.128711,3.826904],[16.063477,2.908594],[16.183398,2.270068],[16.610742,3.505371],[17.491602,3.687305],[18.610352,3.478418],[18.594141,4.34624],[19.500977,5.12749],[20.558105,4.462695],[22.422168,4.134961],[22.864551,4.723877],[25.065234,4.967432],[25.525098,5.312109],[27.40332,5.10918],[27.143945,5.722949],[26.514258,6.069238],[26.361816,6.635303],[25.278906,7.42749],[24.85332,8.137549],[24.291406,8.291406],[24.147363,8.665625]]]}},{type:"Feature",properties:{name:"佛得角",full_name:"佛得角共和国",iso_a2:"CV",iso_a3:"CPV",iso_n3:"132"},geometry:{type:"MultiPolygon",coordinates:[[[[-25.169824,16.946484],[-25.034668,17.176465],[-25.337109,17.091016],[-25.169824,16.946484]]],[[[-23.444238,15.007959],[-23.748096,15.328516],[-23.705371,14.961328],[-23.444238,15.007959]]],[[[-22.917725,16.237256],[-22.959277,16.045117],[-22.710107,16.043359],[-22.917725,16.237256]]]]}},{type:"Feature",properties:{name:"加拿大",full_name:"加拿大",iso_a2:"CA",iso_a3:"CAN",iso_n3:"124"},geometry:{type:"MultiPolygon",coordinates:[[[[-132.655518,54.12749],[-133.048389,54.158936],[-133.079492,53.837012],[-132.347266,53.189209],[-131.957422,53.308691],[-131.667627,54.141357],[-132.534668,53.651709],[-132.166113,53.955225],[-132.655518,54.12749]]],[[[-131.753711,53.195557],[-132.546777,53.1375],[-131.221533,52.153613],[-131.455225,52.701709],[-131.971777,52.879834],[-131.634668,52.922168],[-131.753711,53.195557]]],[[[-127.197314,50.640381],[-127.918066,50.860547],[-128.346045,50.744238],[-128.05835,50.498486],[-127.465918,50.583105],[-127.486523,50.404639],[-127.905859,50.445215],[-127.863916,50.127734],[-127.249805,50.137988],[-127.114307,49.879736],[-126.134082,49.672314],[-126.519141,49.396777],[-125.9354,49.401465],[-125.489453,48.933789],[-124.812646,49.212646],[-125.120703,48.760791],[-123.310645,48.411035],[-125.48208,50.316797],[-127.197314,50.640381]]],[[[-130.025098,55.888232],[-130.048486,55.057275],[-129.795166,55.55957],[-129.560645,55.462549],[-130.430273,54.420996],[-129.626025,54.230273],[-130.335254,53.723926],[-129.563721,53.251465],[-128.959375,53.841455],[-128.532129,53.858105],[-128.675537,53.55459],[-127.927832,53.274707],[-128.905615,53.559326],[-128.85459,53.704541],[-129.171582,53.533594],[-128.365039,52.825781],[-128.053271,52.910693],[-128.271533,52.362988],[-127.940234,52.545166],[-128.357617,52.158887],[-128.102246,51.788428],[-127.791895,52.289355],[-126.951367,52.751025],[-127.193994,52.457666],[-126.713965,52.060693],[-127.437939,52.356152],[-127.795361,52.191016],[-127.850537,51.673193],[-127.668701,51.477588],[-127.338721,51.707373],[-126.691455,51.703418],[-127.419678,51.608057],[-127.708105,51.151172],[-127.057568,50.867529],[-126.517334,51.056836],[-126.514355,50.679395],[-125.904102,50.704932],[-126.447461,50.587744],[-126.094336,50.497607],[-125.058789,50.513867],[-124.859863,50.872412],[-125.056689,50.418652],[-124.782373,50.020117],[-124.141602,49.792676],[-123.880127,50.173633],[-123.874414,49.736816],[-123.582471,49.68125],[-124.028613,49.602881],[-123.530566,49.397314],[-123.1875,49.680322],[-123.276758,49.343945],[-122.879102,49.398926],[-123.196338,49.147705],[-122.78877,48.993018],[-114.585107,48.993066],[-106.483838,48.993115],[-97.529834,48.993164],[-95.162061,48.991748],[-95.155273,49.369678],[-94.620898,48.742627],[-92.99624,48.611816],[-91.518311,48.058301],[-90.916064,48.209131],[-89.455664,47.99624],[-88.378174,48.303076],[-84.875977,46.899902],[-84.561768,46.457373],[-84.149463,46.542773],[-83.977783,46.084912],[-83.615967,46.116846],[-83.592676,45.817139],[-82.551074,45.347363],[-82.137842,43.570898],[-82.545312,42.624707],[-83.149658,42.141943],[-82.690039,41.675195],[-79.036719,42.802344],[-79.171875,43.466553],[-78.72041,43.624951],[-76.819971,43.628809],[-76.151172,44.303955],[-74.708887,45.003857],[-73.973828,45.345117],[-74.315088,45.531055],[-73.476611,45.738232],[-72.981006,46.209717],[-71.87959,46.686816],[-71.267773,46.795947],[-70.705859,47.139795],[-69.994434,47.739893],[-69.865527,48.172266],[-71.018262,48.455615],[-69.673877,48.19917],[-68.281934,49.197168],[-67.372021,49.348438],[-66.495508,50.211865],[-62.71543,50.30166],[-61.724854,50.104053],[-59.886328,50.316406],[-58.510352,51.295068],[-56.975977,51.457666],[-55.695215,52.137793],[-56.011719,52.394482],[-55.746484,52.474561],[-56.324902,52.544531],[-55.802832,52.643164],[-55.797949,53.211963],[-56.46499,53.765039],[-57.331738,53.469092],[-57.416064,54.162744],[-58.19209,54.228174],[-57.935986,54.091162],[-60.329492,53.266113],[-60.100293,53.486963],[-60.39541,53.65332],[-58.633203,54.049561],[-57.404492,54.590869],[-57.962451,54.875732],[-58.780176,54.838379],[-59.25957,55.199951],[-59.837793,54.813965],[-59.437891,55.175928],[-59.758789,55.30957],[-60.617139,55.060205],[-60.341016,55.784668],[-61.449512,55.995703],[-61.364697,56.216016],[-61.713086,56.230957],[-61.425293,56.360645],[-62.497266,56.801709],[-61.371631,56.680811],[-61.33374,57.010596],[-62.495557,57.489209],[-61.967969,57.611914],[-61.958643,57.911768],[-62.48623,58.154053],[-63.261523,58.014697],[-62.593848,58.474023],[-63.537061,58.329932],[-62.873877,58.672461],[-63.248437,59.068311],[-63.971143,59.053809],[-63.415137,59.194385],[-63.945459,59.380176],[-64.283496,60.064062],[-64.768457,60.012109],[-64.499414,60.268262],[-64.817334,60.331055],[-65.028174,59.770703],[-65.433398,59.776514],[-65.038232,59.387891],[-65.475098,59.470312],[-65.383545,59.060205],[-66.043066,58.820654],[-66.002393,58.431201],[-66.362402,58.791162],[-67.678271,57.991113],[-68.021045,58.485303],[-68.413574,58.051758],[-69.04082,57.90249],[-68.356543,58.163232],[-68.381152,58.743506],[-68.698193,58.904541],[-70.154346,58.760596],[-69.531641,58.869238],[-69.344043,59.303076],[-69.681885,59.341748],[-69.733936,59.918018],[-70.654834,60.026221],[-69.67373,60.075879],[-69.50332,61.04043],[-69.992432,60.856494],[-71.422705,61.158936],[-71.638281,61.617188],[-72.215869,61.587256],[-72.686963,62.124561],[-73.705078,62.473145],[-74.632568,62.115674],[-77.372412,62.57251],[-78.133398,62.282275],[-77.514355,61.556299],[-78.181348,60.819141],[-77.589551,60.808594],[-77.349072,59.578955],[-77.726172,59.675879],[-78.515088,58.682373],[-76.809814,57.657959],[-76.604053,56.199561],[-77.775293,55.29126],[-79.712354,54.671826],[-78.996045,54.00249],[-78.448096,52.261377],[-78.981641,51.774561],[-78.903174,51.200293],[-79.338672,51.628174],[-79.737451,51.186279],[-79.3479,50.762646],[-80.103564,51.282861],[-80.851221,51.125],[-80.443311,51.388574],[-80.588037,51.667236],[-81.827881,52.224219],[-81.599414,52.432617],[-82.291553,53.030713],[-82.393262,55.067822],[-83.910596,55.314648],[-85.365283,55.079297],[-85.559326,55.540186],[-87.482422,56.021289],[-88.948486,56.851318],[-90.897461,57.256934],[-92.798145,56.921973],[-92.432812,57.320312],[-93.17876,58.725635],[-94.123193,58.736719],[-94.332227,58.297363],[-94.287061,58.716016],[-94.957324,59.068848],[-94.761719,60.498242],[-93.312012,61.767285],[-93.581787,61.942041],[-92.905518,62.215137],[-93.205371,62.364941],[-92.527979,62.168408],[-92.551416,62.546729],[-91.93584,62.592383],[-92.361279,62.819385],[-90.698584,63.063867],[-90.970068,63.442773],[-91.841846,63.697559],[-92.465088,63.555078],[-92.156885,63.691699],[-93.559814,63.865283],[-93.696338,64.147168],[-90.811914,63.580908],[-90.154736,63.689648],[-90.04165,64.140869],[-89.131543,63.968506],[-88.105615,64.183301],[-87.027539,65.198096],[-88.974023,65.348291],[-89.924072,65.780273],[-91.427246,65.9479],[-89.749414,65.936035],[-87.452881,65.338965],[-85.95874,66.119043],[-86.708154,66.523047],[-85.603857,66.568262],[-83.869043,66.213574],[-84.223047,66.682471],[-85.113721,66.906934],[-84.538477,66.972803],[-83.406445,66.37124],[-81.467578,67.069873],[-81.294336,67.497412],[-82.552686,68.446484],[-81.281543,68.657227],[-81.95791,68.883643],[-81.377832,69.185645],[-82.227539,69.248877],[-82.618359,69.691064],[-85.507373,69.845264],[-84.867578,68.77334],[-85.643164,68.699707],[-86.560791,67.482129],[-87.359375,67.177246],[-88.313818,67.950342],[-88.346973,68.288281],[-87.813574,68.345703],[-88.223535,68.915039],[-89.279541,69.255469],[-90.204785,68.257471],[-91.237207,69.285547],[-90.415576,69.456982],[-92.887793,69.668213],[-91.976709,70.038672],[-92.320508,70.235352],[-91.564062,70.178271],[-94.734863,71.982959],[-95.872314,71.573145],[-95.564258,71.336768],[-96.446582,71.239893],[-95.878613,70.548975],[-96.551367,70.210303],[-95.964941,69.802783],[-93.532275,69.480908],[-94.600439,68.803223],[-93.852441,69.000342],[-93.448926,68.618896],[-95.460693,68.021387],[-95.25874,67.262549],[-95.399658,66.949463],[-96.036865,66.9375],[-95.787549,66.616797],[-96.422559,67.051758],[-95.418896,67.013232],[-96.369141,67.509766],[-95.970312,68.249121],[-96.72207,68.03877],[-96.430664,68.310596],[-97.410352,68.496533],[-98.650488,68.363525],[-98.192529,67.922998],[-97.206543,67.855078],[-97.454932,67.616992],[-98.631543,68.072559],[-98.412109,67.807178],[-98.920459,67.725781],[-102.320361,67.735645],[-103.474121,68.115039],[-104.486816,68.063184],[-106.164453,68.919873],[-108.313477,68.610791],[-108.718115,68.297461],[-107.73418,68.17373],[-105.750195,68.592285],[-107.958398,67.818604],[-107.259473,66.398535],[-108.496045,67.092285],[-107.988721,67.256396],[-110.073926,67.99292],[-112.503027,67.681934],[-115.133203,67.819189],[-115.127051,68.132031],[-113.964404,68.399072],[-115.442285,68.940918],[-117.226953,68.913428],[-122.070068,69.816162],[-123.025781,69.81001],[-123.528418,69.389355],[-124.338086,69.364844],[-124.555029,70.151221],[-125.524951,69.351563],[-127.991016,70.573828],[-127.683789,70.260352],[-128.853027,69.751025],[-128.898926,69.966162],[-130.117627,69.720068],[-130.970654,69.209082],[-131.063428,69.450684],[-131.788379,69.431982],[-133.196826,68.739844],[-132.81748,69.205762],[-129.648291,69.997754],[-129.675635,70.192969],[-134.174316,69.252832],[-134.408936,69.681787],[-135.691455,69.311182],[-135.939014,68.97417],[-135.258838,68.684326],[-141.002148,69.650781],[-141.002148,64.975537],[-141.002148,60.300244],[-139.079248,60.343701],[-139.185156,60.083594],[-137.438574,58.903125],[-135.475928,59.793262],[-133.401123,58.410889],[-131.824268,56.58999],[-130.097852,56.109277],[-130.025098,55.888232]]],[[[-109.815967,78.650391],[-110.877588,78.735059],[-113.223047,78.2979],[-109.484473,78.316406],[-109.815967,78.650391]]],[[[-110.458057,78.103223],[-113.215186,77.903516],[-112.372656,77.364111],[-110.198486,77.524512],[-110.865625,77.834131],[-109.622266,78.074756],[-110.458057,78.103223]]],[[[-115.55127,77.363281],[-116.511328,77.547607],[-116.843555,77.339551],[-119.090186,77.305078],[-122.519385,76.353174],[-122.533057,75.950928],[-120.848389,76.182666],[-119.912891,75.858838],[-117.880811,76.805078],[-117.233594,76.281543],[-115.55127,77.363281]]],[[[-108.292383,76.057129],[-109.098242,76.811865],[-110.314453,76.369385],[-108.947168,75.541797],[-111.052686,75.548535],[-112.697607,76.201709],[-114.998486,76.497461],[-115.822168,76.27002],[-114.778613,76.172607],[-116.209863,76.194434],[-116.664551,75.957568],[-114.991504,75.896338],[-117.163623,75.644873],[-115.141846,75.678516],[-117.565234,75.23335],[-115.728857,74.968115],[-114.451758,75.087891],[-114.016504,75.434277],[-113.711768,75.068604],[-111.093457,75.256299],[-114.312695,74.715088],[-112.519336,74.416846],[-108.831299,75.064893],[-107.153418,74.927148],[-106.092627,75.089453],[-105.632666,75.945361],[-106.677002,76.02373],[-106.913525,75.679639],[-108.292383,76.057129]]],[[[-114.521533,72.59292],[-114.051709,73.070996],[-114.638232,73.372656],[-118.133105,72.632812],[-118.987695,71.764258],[-117.742334,71.659326],[-117.935645,71.39209],[-115.303418,71.493701],[-118.269092,71.034717],[-117.587061,70.629541],[-113.757275,70.690723],[-111.632568,70.308838],[-117.19541,70.054053],[-116.513477,69.424609],[-113.694141,69.19502],[-113.127734,68.494141],[-109.472119,68.676709],[-107.439893,69.002148],[-106.659082,69.4396],[-104.571436,68.872119],[-101.857129,69.023975],[-102.045947,69.464844],[-103.120215,69.20459],[-103.464893,69.644482],[-102.621094,69.551514],[-102.182129,69.845947],[-100.982373,69.679883],[-101.042676,70.110791],[-103.58457,70.630859],[-104.514795,71.064258],[-105.415137,72.78833],[-106.482129,73.196191],[-108.029053,73.34873],[-108.237402,73.149902],[-107.306006,71.894678],[-107.812842,71.626172],[-110.008447,72.983643],[-110.66084,73.008203],[-110.205127,72.661279],[-111.675098,72.300146],[-111.269727,72.713721],[-112.753613,72.986035],[-114.521533,72.59292]]],[[[-119.736328,74.112646],[-121.50415,74.545117],[-124.69624,74.348193],[-123.797266,73.768164],[-125.845312,71.978662],[-124.007764,71.677441],[-123.095654,71.093799],[-120.619336,71.505762],[-120.179883,72.212646],[-115.446875,73.438867],[-117.514844,74.231738],[-119.736328,74.112646]]],[[[-69.488867,83.016797],[-72.81167,83.081201],[-72.658691,82.721631],[-74.41416,83.013135],[-77.124902,83.008545],[-76.009375,82.535156],[-77.618066,82.89585],[-80.154932,82.911133],[-78.748779,82.679395],[-81.010156,82.779053],[-82.447559,82.39502],[-79.465625,81.851123],[-84.896826,82.449414],[-86.615625,82.218555],[-85.044824,81.982812],[-88.063184,82.096484],[-91.647559,81.683838],[-89.82168,81.634863],[-90.416309,81.405371],[-87.597021,81.52583],[-89.673682,81.328613],[-89.623047,81.032471],[-84.941211,81.28623],[-89.166895,80.941309],[-88.003662,80.675391],[-83.288818,81.147949],[-86.250342,80.565771],[-81.007031,80.654883],[-76.885107,81.430273],[-78.716211,80.95166],[-76.862988,80.864795],[-82.987012,80.322607],[-80.475928,79.60625],[-83.723633,80.228955],[-86.498535,80.258252],[-86.420752,79.845215],[-83.575879,79.053662],[-84.412012,78.996582],[-81.750098,78.975781],[-83.271436,78.770312],[-86.80791,78.774365],[-87.551758,78.176611],[-85.920068,78.342871],[-85.585938,78.10957],[-84.783203,78.527588],[-84.222705,78.176025],[-85.547559,77.927686],[-85.289355,77.559033],[-83.779395,77.532617],[-82.710352,77.849512],[-83.721289,77.414209],[-84.738672,77.361035],[-86.755078,77.863721],[-88.016992,77.784717],[-86.812256,77.184912],[-89.499756,76.826807],[-89.369629,76.474463],[-88.545801,76.420898],[-88.49585,76.772852],[-88.395996,76.405273],[-87.497559,76.386279],[-87.489795,76.58584],[-86.680225,76.376611],[-86.453711,76.584863],[-85.14126,76.30459],[-84.275342,76.356543],[-84.223779,76.675342],[-83.885693,76.453125],[-82.233154,76.46582],[-82.529834,76.723291],[-80.799707,76.173584],[-78.284326,76.57124],[-78.288867,76.977979],[-82.056787,77.296533],[-81.659082,77.525439],[-78.708496,77.342139],[-78.012598,77.946045],[-75.865967,78.009814],[-75.193457,78.327734],[-76.416113,78.511523],[-74.486328,78.750098],[-78.581641,79.075],[-74.640918,79.035547],[-76.898828,79.512305],[-73.361523,79.504004],[-74.394482,79.874072],[-71.387842,79.761768],[-70.568408,80.093701],[-72.055957,80.123242],[-70.264893,80.233594],[-70.712598,80.5396],[-69.550684,80.383252],[-64.780078,81.492871],[-68.688525,81.293311],[-61.615381,82.184424],[-63.641016,82.812598],[-68.469336,82.653369],[-66.422559,82.926855],[-69.488867,83.016797]]],[[[-95.484375,77.791992],[-95.987061,77.484131],[-93.543945,77.46665],[-93.300977,77.739795],[-95.484375,77.791992]]],[[[-93.542578,75.02793],[-94.878174,75.630029],[-96.599609,75.031787],[-94.534521,74.636719],[-93.573096,74.668848],[-93.542578,75.02793]]],[[[-100.001904,73.945898],[-100.962988,73.791406],[-100.52168,73.449316],[-101.523193,73.486377],[-99.825146,73.213867],[-100.536377,73.197852],[-100.128125,72.906689],[-101.273193,72.72168],[-102.204004,73.077295],[-102.70874,72.764502],[-98.662891,71.3021],[-98.322705,71.852344],[-97.582275,71.629688],[-96.613428,71.833838],[-96.445605,72.552441],[-97.636328,73.027637],[-98.421777,72.941016],[-97.170508,73.824854],[-99.157959,73.731592],[-100.001904,73.945898]]],[[[-84.919629,65.261084],[-85.554688,65.918652],[-86.2521,64.136865],[-87.151904,63.585645],[-85.768945,63.700342],[-85.392627,63.119678],[-83.303955,64.143799],[-81.046387,63.461572],[-80.302051,63.762207],[-80.828955,64.089941],[-81.887109,64.016406],[-82.05,64.644287],[-84.501123,65.458447],[-84.919629,65.261084]]],[[[-97.700928,76.466504],[-98.71084,76.693848],[-98.890332,76.465576],[-100.829736,76.523877],[-99.541064,76.146289],[-99.865479,75.924219],[-101.415186,76.424902],[-102.104688,76.331201],[-100.972803,75.798438],[-102.144727,75.875049],[-102.587402,75.513672],[-99.19458,75.698389],[-100.711914,75.406348],[-100.234375,75.007715],[-97.674316,75.127295],[-97.700928,76.466504]]],[[[-103.426025,79.315625],[-105.514551,79.24248],[-104.895508,78.808154],[-104.151953,78.989893],[-103.371582,78.736328],[-104.763574,78.35166],[-102.731348,78.371045],[-100.274658,77.832715],[-99.166406,77.856934],[-99.609424,78.583057],[-101.703662,79.078906],[-102.576172,78.879395],[-103.426025,79.315625]]],[[[-91.885547,81.132861],[-94.220117,81.330762],[-93.286719,81.100293],[-95.514746,80.838135],[-93.92793,80.55918],[-95.926953,80.720654],[-96.394092,80.315039],[-94.262598,80.194873],[-96.773242,80.135791],[-96.589062,79.91665],[-95.739355,79.660156],[-94.401855,79.736328],[-95.662891,79.527344],[-95.103174,79.289893],[-91.299902,79.372705],[-94.1146,78.928906],[-91.866895,78.542676],[-92.35127,78.312891],[-89.525684,78.159619],[-90.037109,78.606836],[-88.822412,78.185889],[-88.040186,78.995312],[-87.617383,78.676318],[-85.042139,79.28457],[-85.647852,79.611426],[-87.295166,79.580176],[-87.675,80.372119],[-88.857324,80.166211],[-91.885547,81.132861]]],[[[-94.294971,76.912451],[-95.849512,77.066211],[-96.880713,76.73833],[-95.273877,76.264404],[-93.091748,76.354004],[-91.549121,74.655566],[-90.880225,74.817773],[-89.558691,74.554736],[-88.534961,74.831738],[-88.423047,74.494141],[-84.425537,74.508105],[-83.531885,74.585693],[-83.52207,74.901465],[-82.735791,74.530273],[-80.262744,74.584473],[-80.347754,74.902979],[-79.401416,74.917627],[-80.381982,75.03418],[-79.509082,75.259814],[-80.321973,75.629102],[-83.931982,75.818945],[-85.951465,75.39502],[-88.644971,75.658447],[-88.916699,75.453955],[-91.407324,76.220068],[-89.284521,76.301611],[-91.415088,76.455859],[-90.542627,76.495752],[-91.305029,76.680762],[-93.53457,76.447705],[-93.230029,76.770264],[-94.294971,76.912451]]],[[[-96.204492,78.531299],[-98.332617,78.773535],[-96.989648,77.806006],[-94.934277,78.075635],[-94.915381,78.390527],[-96.204492,78.531299]]],[[[-93.17085,74.160986],[-94.973535,74.041406],[-94.697607,73.663574],[-95.63291,73.695459],[-95.007861,72.012793],[-94.037549,72.02876],[-93.555176,72.421143],[-94.211328,72.756934],[-92.11792,72.753809],[-90.381396,73.824756],[-93.17085,74.160986]]],[[[-97.439453,69.642676],[-98.200488,69.796973],[-98.041357,69.456641],[-98.545996,69.5729],[-99.494678,68.95957],[-96.401562,68.470703],[-95.267773,68.826074],[-97.439453,69.642676]]],[[[-61.105176,45.944727],[-60.494531,46.270264],[-60.408203,47.003516],[-61.408643,46.170361],[-61.449805,45.716211],[-60.672949,45.59082],[-59.842188,45.941553],[-60.297949,46.31123],[-60.737891,45.751416],[-61.059033,45.703369],[-60.865234,45.983496],[-61.105176,45.944727]]],[[[-67.124854,45.169434],[-66.439844,45.095898],[-66.026562,45.417578],[-65.884473,45.2229],[-64.778516,45.638428],[-64.632715,45.946631],[-64.314648,45.835693],[-64.873145,45.35459],[-63.368018,45.364795],[-64.135498,45.023047],[-64.448145,45.337451],[-66.090625,44.504932],[-65.868018,44.568799],[-66.125732,43.813818],[-65.481689,43.518066],[-64.286084,44.550342],[-63.609766,44.47998],[-63.604004,44.683203],[-61.031543,45.291748],[-61.955518,45.868164],[-62.750098,45.648242],[-64.541504,46.240332],[-64.831396,47.060791],[-65.318896,47.101221],[-64.703223,47.724854],[-65.607227,47.67002],[-66.704395,48.022461],[-65.926709,48.188867],[-65.259424,48.02124],[-64.348828,48.423193],[-64.513721,48.841113],[-64.216211,48.873633],[-64.836328,49.191748],[-66.178174,49.213135],[-68.238184,48.626416],[-70.519482,47.03252],[-71.261182,46.75625],[-72.109277,46.551221],[-73.15957,46.010059],[-73.558105,45.425098],[-74.708887,45.003857],[-71.517529,45.007568],[-71.327295,45.290088],[-70.865039,45.270703],[-69.242871,47.462988],[-68.937207,47.21123],[-68.235498,47.345947],[-67.806787,47.082812],[-67.802246,45.727539],[-67.124854,45.169434]]],[[[-55.45874,51.536523],[-56.025586,51.568359],[-57.035937,51.01084],[-57.791309,49.48999],[-58.213379,49.38667],[-57.990527,48.987939],[-58.403662,49.084326],[-58.716455,48.598047],[-58.841797,48.746436],[-59.167676,48.558496],[-58.330225,48.522119],[-59.320654,47.736914],[-59.116943,47.570703],[-58.336865,47.730859],[-56.774121,47.56499],[-55.85791,47.819189],[-56.127246,47.502832],[-55.576123,47.465234],[-54.784619,47.664746],[-55.919238,47.016895],[-55.788525,46.867236],[-54.488135,47.403857],[-54.191846,47.859814],[-53.849512,47.440332],[-54.17373,46.880371],[-53.597363,47.145996],[-53.589795,46.638867],[-53.114844,46.655811],[-52.653662,47.549414],[-52.782422,47.769434],[-53.169824,47.512109],[-52.866016,48.112988],[-53.672363,47.648242],[-53.86958,48.019678],[-53.027588,48.634717],[-54.114453,48.393604],[-53.706348,48.655518],[-54.161279,48.787695],[-53.619434,49.321631],[-54.448242,49.329443],[-54.502197,49.527344],[-55.353174,49.079443],[-55.229541,49.508154],[-56.087305,49.451953],[-55.869824,49.670166],[-56.140186,49.619141],[-55.50293,49.983154],[-56.161279,49.940137],[-56.179395,50.11499],[-56.822168,49.613477],[-55.8,51.033301],[-56.031104,51.328369],[-55.45874,51.536523]]],[[[-86.589355,71.010791],[-85.023389,71.353223],[-86.218457,71.899121],[-86.656299,72.724023],[-84.946777,73.721631],[-85.950781,73.850146],[-88.705176,73.403271],[-89.861523,72.411914],[-89.805371,71.462305],[-87.140088,71.011621],[-89.455908,71.061719],[-88.782715,70.494482],[-87.838135,70.246582],[-86.396875,70.465332],[-85.780029,70.03667],[-81.564697,69.942725],[-80.921729,69.730908],[-81.651953,70.094629],[-78.889648,69.97749],[-79.066406,70.603564],[-75.647754,69.212549],[-76.557227,69.009473],[-76.585059,68.69873],[-74.716699,69.045508],[-74.892969,68.808154],[-74.270117,68.541211],[-73.822119,68.685986],[-72.22002,67.254297],[-74.416406,66.16709],[-73.550781,65.485254],[-75.798682,65.29751],[-75.4521,64.841602],[-75.82832,65.227051],[-77.326709,65.453125],[-78.095605,64.939258],[-78.045215,64.499268],[-76.856152,64.237646],[-74.694727,64.496582],[-74.681396,64.830664],[-74.064795,64.424658],[-73.271289,64.58252],[-72.498438,63.823486],[-71.380859,63.580322],[-71.992236,63.416162],[-71.347266,63.066113],[-69.604736,62.767725],[-68.535889,62.255615],[-66.123877,61.893066],[-65.980176,62.208887],[-68.911084,63.703223],[-67.722559,63.422754],[-67.893262,63.73374],[-66.697461,63.069531],[-66.65498,63.264746],[-65.108496,62.626465],[-65.162793,62.932617],[-64.672363,62.921973],[-65.191846,63.764258],[-64.664648,63.245361],[-64.410937,63.706348],[-65.580322,64.293848],[-65.074609,64.43667],[-65.529346,64.504785],[-65.274805,64.631543],[-66.635498,65.000342],[-66.697412,64.815186],[-67.117969,65.440381],[-67.936768,65.564893],[-68.748926,66.200049],[-67.350439,65.929736],[-67.883398,66.467432],[-67.225391,66.310254],[-66.986328,66.62749],[-66.063721,66.132715],[-65.656348,66.204736],[-65.825732,65.996924],[-64.445361,66.317139],[-65.401611,65.764014],[-64.555078,65.116602],[-64.269678,65.400781],[-63.606592,64.928076],[-63.45874,65.853027],[-62.658887,65.639941],[-62.624121,66.01626],[-61.991602,66.035303],[-62.553125,66.406836],[-61.570801,66.3729],[-62.12334,66.643066],[-61.353418,66.689209],[-62.123584,67.046729],[-63.701562,66.822363],[-63.040137,67.23501],[-64.699951,67.350537],[-63.850195,67.566064],[-65.021094,67.787549],[-64.922314,68.031641],[-65.40127,67.674854],[-65.942383,68.070947],[-66.443945,67.833838],[-66.212402,68.28042],[-66.923096,68.065723],[-66.742725,68.457764],[-69.319092,68.856982],[-67.883203,68.783984],[-67.832617,69.065967],[-69.040625,69.097998],[-68.406299,69.232227],[-66.707422,69.168213],[-67.236963,69.460107],[-69.250781,69.511914],[-67.221631,69.730713],[-67.363672,70.034424],[-68.059082,70.317236],[-68.744043,69.941406],[-68.778223,70.203564],[-70.057715,70.042627],[-68.363525,70.48125],[-69.949805,70.84502],[-71.429443,70.127783],[-71.275879,70.500293],[-71.890186,70.431543],[-70.672656,71.052197],[-72.632715,70.830762],[-71.229395,71.33877],[-72.901953,71.677783],[-73.180615,71.282861],[-73.712842,71.587598],[-74.197266,71.40415],[-73.814062,71.771436],[-74.996191,71.218115],[-74.700781,71.675586],[-75.204785,71.709131],[-74.209326,71.978662],[-74.903174,72.100488],[-75.922803,71.717236],[-75.052686,72.226367],[-75.704297,72.571533],[-77.753223,72.724756],[-78.484277,72.470605],[-77.516504,72.177783],[-78.699268,72.351416],[-78.585107,71.880615],[-79.831299,72.446289],[-80.925146,71.907666],[-80.611475,72.45083],[-81.229346,72.311719],[-80.277246,72.770166],[-81.946143,73.729834],[-85.454736,73.105469],[-84.256641,72.796729],[-85.262109,72.954004],[-85.649902,72.722168],[-84.28374,72.044482],[-85.321875,72.233154],[-85.911621,71.986523],[-84.699414,71.631445],[-84.82373,71.028613],[-86.589355,71.010791]]],[[[-61.801123,49.093896],[-62.858545,49.705469],[-64.485205,49.886963],[-63.041504,49.224951],[-61.801123,49.093896]]],[[[-63.811279,46.468701],[-63.993555,47.061572],[-64.388037,46.640869],[-63.641016,46.230469],[-62.978467,46.316357],[-63.02207,46.066602],[-62.531348,45.977295],[-62.02373,46.421582],[-63.811279,46.468701]]],[[[-82.000488,62.954199],[-83.376416,62.904932],[-83.910498,62.45415],[-83.698877,62.160254],[-82.568262,62.403223],[-82.000488,62.954199]]],[[[-79.545312,62.411719],[-80.260059,62.109033],[-79.816113,61.594629],[-79.323926,62.026074],[-79.545312,62.411719]]],[[[-75.675879,68.32251],[-76.595801,68.278955],[-77.125879,67.94707],[-76.944189,67.250293],[-75.201953,67.45918],[-75.078125,68.173145],[-75.675879,68.32251]]],[[[-79.537305,73.654492],[-80.848877,73.72124],[-79.820703,72.826318],[-76.183398,72.843066],[-77.206543,73.499561],[-79.537305,73.654492]]],[[[-80.731689,52.747266],[-81.135596,53.205811],[-82.039258,53.049902],[-80.731689,52.747266]]],[[[-78.935596,56.266064],[-79.272412,56.600439],[-79.536328,56.180078],[-79.458887,56.539746],[-79.9875,55.892139],[-79.544727,56.128369],[-79.764746,55.806787],[-79.495117,55.874756],[-79.182129,56.212158],[-79.175488,55.885059],[-78.935596,56.266064]]],[[[-89.833252,77.267627],[-91.019043,77.643896],[-90.993213,77.329492],[-89.833252,77.267627]]],[[[-98.791602,79.981104],[-100.053271,80.093359],[-98.945215,79.724072],[-98.791602,79.981104]]],[[[-105.288916,72.919922],[-104.5875,73.578076],[-106.613965,73.695605],[-106.921533,73.479834],[-105.288916,72.919922]]],[[[-102.227344,76.014893],[-102.728027,76.307031],[-104.350635,76.182324],[-103.314746,75.764209],[-102.227344,76.014893]]],[[[-104.022852,76.583105],[-104.35752,76.334619],[-103.311377,76.347559],[-104.022852,76.583105]]],[[[-118.328125,75.579688],[-117.633691,76.115088],[-119.39458,75.617334],[-118.328125,75.579688]]],[[[-113.832471,77.754639],[-114.330371,78.077539],[-114.98042,77.91543],[-113.832471,77.754639]]],[[[-130.236279,53.958545],[-130.447998,54.089014],[-130.703174,53.892236],[-130.236279,53.958545]]],[[[-128.552441,52.939746],[-129.033252,53.279932],[-129.175928,52.964941],[-128.746338,52.763379],[-128.678955,52.289648],[-128.552441,52.939746]]],[[[-73.566504,45.469092],[-73.476074,45.704736],[-73.960547,45.441406],[-73.566504,45.469092]]],[[[-68.233789,60.240918],[-67.818848,60.449512],[-68.087598,60.587842],[-68.233789,60.240918]]],[[[-64.832617,61.366064],[-64.789648,61.662207],[-65.432129,61.649512],[-64.832617,61.366064]]],[[[-79.063086,75.925879],[-79.009326,76.145898],[-79.63877,75.84292],[-79.063086,75.925879]]],[[[-79.384277,51.951953],[-79.271289,52.086816],[-79.64375,52.010059],[-79.384277,51.951953]]],[[[-73.621729,67.783838],[-73.49375,68.000635],[-74.706543,68.06709],[-74.573389,67.828662],[-73.621729,67.783838]]],[[[-77.876709,63.470557],[-78.536768,63.42373],[-77.942432,63.114404],[-77.532715,63.233643],[-77.876709,63.470557]]],[[[-98.270361,73.868506],[-97.698242,74.108691],[-99.416992,73.89541],[-98.270361,73.868506]]],[[[-79.430664,69.787793],[-80.794775,69.689258],[-79.977832,69.509668],[-79.430664,69.787793]]],[[[-76.995361,69.14375],[-76.668848,69.366162],[-77.187549,69.440088],[-76.995361,69.14375]]],[[[-83.725977,65.796729],[-84.407178,66.131006],[-84.118262,65.771777],[-83.332422,65.631055],[-83.725977,65.796729]]],[[[-101.693555,77.696582],[-101.193213,77.829785],[-102.447705,77.880615],[-101.693555,77.696582]]],[[[-96.078564,75.510107],[-96.367822,75.654639],[-96.915137,75.379688],[-96.078564,75.510107]]],[[[-104.119922,75.036328],[-104.346191,75.429932],[-104.887402,75.147754],[-104.119922,75.036328]]]]}},{type:"Feature",properties:{name:"喀麦隆",full_name:"喀麦隆共和国",iso_a2:"CM",iso_a3:"CMR",iso_n3:"120"},geometry:{type:"Polygon",coordinates:[[[8.555859,4.755225],[8.574414,4.526221],[8.918262,4.55376],[9.000098,4.091602],[9.688867,4.056396],[9.556152,3.798047],[9.948438,3.079053],[9.800781,2.304443],[11.328711,2.167432],[13.293555,2.161572],[14.578906,2.199121],[16.059375,1.676221],[16.183398,2.270068],[16.063477,2.908594],[15.128711,3.826904],[15.063574,4.284863],[14.73125,4.602393],[14.431152,6.038721],[15.480078,7.523779],[15.549805,7.787891],[15.116211,8.557324],[13.977246,9.691553],[14.243262,9.979736],[15.654883,10.007812],[15.132227,10.648486],[14.84707,12.5021],[14.461719,13.021777],[14.063965,13.078516],[14.197461,12.383789],[14.619727,12.150977],[14.575391,11.532422],[13.699902,10.873145],[12.782227,8.817871],[12.233398,8.282324],[11.861426,7.116406],[11.237305,6.450537],[10.60625,7.063086],[9.779883,6.760156],[8.997168,5.917725],[8.555859,4.755225]]]}},{type:"Feature",properties:{name:"柬埔寨",full_name:"柬埔寨王国",iso_a2:"KH",iso_a3:"KHM",iso_n3:"116"},geometry:{type:"Polygon",coordinates:[[[107.519434,14.705078],[106.938086,14.327344],[106.501465,14.578223],[105.978906,14.343018],[106.066797,13.921191],[105.183301,14.34624],[103.199414,14.332617],[102.336328,13.560303],[102.933887,11.706689],[103.152832,10.913721],[103.532422,11.14668],[103.721875,10.890137],[103.587109,10.552197],[104.426367,10.41123],[104.850586,10.534473],[105.045703,10.911377],[105.755078,10.98999],[106.163965,10.794922],[105.851465,11.63501],[106.399219,11.687012],[106.413867,11.948438],[107.506445,12.364551],[107.605469,13.437793],[107.331445,14.126611],[107.519434,14.705078]]]}},{type:"Feature",properties:{name:"缅甸",full_name:"缅甸联邦共和国",iso_a2:"MM",iso_a3:"MMR",iso_n3:"104"},geometry:{type:"MultiPolygon",coordinates:[[[[100.122461,20.31665],[100.249316,20.730273],[100.622949,20.85957],[100.703125,21.251367],[101.138867,21.56748],[101.079785,21.755859],[100.147656,21.480518],[99.917676,22.028027],[99.192969,22.125977],[99.507129,22.959131],[98.86377,23.19126],[98.676758,23.905078],[98.835059,24.121191],[97.564551,23.911035],[97.583301,24.774805],[97.819531,25.251855],[98.65625,25.863574],[98.738477,26.785742],[98.651172,27.572461],[98.298828,27.550098],[98.061621,28.185889],[97.599219,28.517041],[97.322461,28.217969],[97.335156,27.937744],[96.876855,27.586719],[97.102051,27.11543],[96.731641,27.331494],[96.19082,27.261279],[95.128711,26.597266],[95.132422,26.04126],[94.579883,25.319824],[94.707617,25.04873],[94.127637,23.876465],[93.32627,24.064209],[93.151172,22.230615],[92.574902,21.978076],[92.631641,21.306201],[92.17959,21.293115],[92.324121,20.791846],[92.722852,20.295605],[92.735645,20.562695],[92.82832,20.177588],[93.066797,20.377637],[93.129492,19.858008],[93.25,20.070117],[93.707031,19.912158],[93.998145,19.440869],[93.824902,19.238477],[93.493066,19.369482],[93.929199,18.899658],[94.044922,19.287402],[94.588965,17.569336],[94.223828,16.016455],[94.70332,16.511914],[94.661523,15.904395],[94.893164,16.182812],[94.942578,15.818262],[95.176953,15.825684],[95.346777,16.097607],[95.389551,15.722754],[96.324316,16.444434],[96.189063,16.768311],[96.431152,16.504932],[96.76543,16.710352],[96.851465,17.401025],[97.375879,16.522949],[97.725977,16.568555],[97.584277,16.01958],[97.812305,14.858936],[98.110645,13.712891],[98.200391,13.980176],[98.575977,13.161914],[98.636328,11.738379],[98.875977,11.719727],[98.464941,10.67583],[98.562598,10.034961],[98.702539,10.190381],[98.757227,10.660937],[99.614746,11.781201],[99.123926,13.030762],[99.136816,13.716699],[98.202148,14.975928],[98.888281,16.351904],[98.660742,16.33042],[97.373926,18.517969],[97.745898,18.588184],[98.015039,19.749512],[98.916699,19.7729],[99.074219,20.099365],[99.485938,20.149854],[99.458887,20.363037],[100.122461,20.31665]]],[[[98.553809,11.744873],[98.376465,11.791504],[98.434766,11.56709],[98.553809,11.744873]]],[[[93.69082,18.684277],[93.744727,18.865527],[93.4875,18.867529],[93.69082,18.684277]]]]}},{type:"Feature",properties:{name:"布隆迪",full_name:"布隆迪共和国",iso_a2:"BI",iso_a3:"BDI",iso_n3:"108"},geometry:{type:"Polygon",coordinates:[[[30.553613,-2.400098],[29.930176,-2.339551],[29.698047,-2.794727],[29.014355,-2.720215],[29.403223,-4.449316],[29.947266,-4.307324],[30.790234,-3.274609],[30.780273,-2.984863],[30.433496,-2.874512],[30.553613,-2.400098]]]}},{type:"Feature",properties:{name:"布基纳法索",full_name:"布基纳法索",iso_a2:"BF",iso_a3:"BFA",iso_n3:"854"},geometry:{type:"Polygon",coordinates:[[[.900488,10.993262],[1.426758,11.447119],[1.980371,11.418408],[2.38916,11.89707],[2.072949,12.309375],[2.10459,12.70127],[1.564941,12.6354],[.987305,13.041895],[.988477,13.364844],[1.201172,13.35752],[.429199,13.972119],[.21748,14.911475],[-.760449,15.047754],[-1.973047,14.456543],[-2.113232,14.168457],[-2.586719,14.227588],[-2.95083,13.648438],[-3.248633,13.65835],[-3.301758,13.280762],[-4.151025,13.306201],[-4.428711,12.337598],[-5.288135,11.82793],[-5.523535,10.426025],[-4.62583,9.713574],[-3.223535,9.895459],[-2.69585,9.481348],[-2.829932,10.998389],[-.627148,10.927393],[-.068604,11.115625],[.900488,10.993262]]]}},{type:"Feature",properties:{name:"保加利亚",full_name:"保加利亚共和国",iso_a2:"BG",iso_a3:"BGR",iso_n3:"100"},geometry:{type:"Polygon",coordinates:[[[28.014453,41.969043],[27.484766,42.468066],[28.585352,43.742236],[27.086914,44.167383],[25.49707,43.670801],[22.919043,43.834473],[23.028516,44.077979],[22.705078,44.237793],[22.369629,43.781299],[22.967969,43.142041],[22.466797,42.84248],[22.344043,42.313965],[23.003613,41.739844],[22.916016,41.336279],[24.487891,41.555225],[25.251172,41.243555],[25.92334,41.311914],[26.320898,41.716553],[27.011719,42.058643],[28.014453,41.969043]]]}},{type:"Feature",properties:{name:"文莱",full_name:"文莱达鲁萨兰国",iso_a2:"BN",iso_a3:"BRN",iso_n3:"096"},geometry:{type:"MultiPolygon",coordinates:[[[[115.140039,4.899756],[115.026758,4.899707],[115.290625,4.352588],[115.140039,4.899756]]],[[[115.026758,4.899707],[114.063867,4.592676],[114.654102,4.037646],[114.74668,4.718066],[115.026758,4.899707]]]]}},{type:"Feature",properties:{name:"巴西",full_name:"巴西联邦共和国",iso_a2:"BR",iso_a3:"BRA",iso_n3:"076"},geometry:{type:"MultiPolygon",coordinates:[[[[-66.876025,1.223047],[-67.082275,1.1854],[-67.400439,2.116699],[-67.93623,1.748486],[-68.193799,1.987012],[-68.176562,1.719824],[-69.848584,1.70874],[-69.852148,1.059521],[-69.311816,1.050488],[-69.15332,.658789],[-70.053906,.578613],[-70.070508,-.138867],[-69.633984,-.509277],[-69.400244,-1.194922],[-69.965918,-4.235938],[-70.799512,-4.17334],[-72.887061,-5.122754],[-73.235547,-6.098438],[-73.137354,-6.46582],[-73.758105,-6.905762],[-73.72041,-7.309277],[-74.002051,-7.556055],[-72.974023,-8.993164],[-73.209424,-9.411426],[-72.379053,-9.510156],[-72.142969,-10.005176],[-71.237939,-9.966016],[-70.541113,-9.4375],[-70.642334,-11.010254],[-69.578613,-10.951758],[-68.622656,-11.10918],[-66.575342,-9.899902],[-65.396143,-9.712402],[-65.389893,-11.246289],[-64.992529,-11.975195],[-64.420508,-12.439746],[-63.06748,-12.669141],[-61.789941,-13.525586],[-61.077002,-13.489746],[-60.506592,-13.789844],[-60.27334,-15.08877],[-60.583203,-15.09834],[-60.242334,-15.47959],[-60.175586,-16.269336],[-58.345605,-16.284375],[-58.395996,-17.234277],[-57.832471,-17.512109],[-57.495654,-18.214648],[-58.131494,-19.744531],[-57.860742,-19.97959],[-58.159766,-20.164648],[-57.830225,-20.997949],[-57.955908,-22.10918],[-56.937256,-22.271289],[-56.447803,-22.076172],[-55.84917,-22.307617],[-55.415918,-23.951367],[-54.625488,-23.8125],[-54.241797,-24.047266],[-54.615869,-25.576074],[-53.891162,-25.668848],[-53.668555,-26.288184],[-53.838184,-27.121094],[-55.725488,-28.204102],[-57.608887,-30.187793],[-56.832715,-30.107227],[-56.044824,-30.777637],[-56.004687,-31.079199],[-55.603027,-30.850781],[-53.761719,-32.056836],[-53.125586,-32.736719],[-53.531348,-33.170898],[-53.370605,-33.742188],[-52.652246,-33.137793],[-51.972461,-31.383789],[-51.283057,-30.751562],[-51.298047,-30.034863],[-51.024951,-30.368652],[-50.563525,-30.253613],[-50.581934,-30.438867],[-51.272168,-31.476953],[-52.063232,-31.830371],[-52.039209,-32.114844],[-50.921387,-31.258398],[-49.745996,-29.363184],[-48.799658,-28.575293],[-48.55415,-27.195996],[-48.748291,-26.268652],[-48.401172,-25.597363],[-48.731738,-25.36875],[-48.202734,-25.416504],[-46.867285,-24.236328],[-45.97207,-23.795508],[-45.464307,-23.802539],[-44.569678,-23.274023],[-44.637256,-23.055469],[-43.22417,-22.991211],[-43.154297,-22.725195],[-42.958301,-22.96709],[-42.042383,-22.94707],[-41.705518,-22.309668],[-41.000293,-21.999023],[-40.954541,-21.237891],[-39.783301,-19.571777],[-39.650781,-18.252344],[-39.154004,-17.703906],[-38.880615,-15.864258],[-39.089355,-13.588184],[-38.851758,-12.790137],[-38.690967,-12.623926],[-38.498926,-12.956641],[-38.239746,-12.844238],[-37.359229,-11.252539],[-37.356006,-11.403906],[-35.340869,-9.230664],[-34.834668,-7.971484],[-34.805469,-7.288379],[-35.481689,-5.166016],[-37.174658,-4.912402],[-38.475781,-3.71748],[-39.964697,-2.861523],[-41.479932,-2.916504],[-43.380078,-2.376074],[-44.192676,-2.80957],[-44.228613,-2.471289],[-44.723047,-3.204785],[-44.381836,-2.365527],[-44.435449,-2.168066],[-44.756348,-2.265527],[-44.537793,-2.052734],[-44.65127,-1.745801],[-45.076367,-1.466406],[-45.32915,-1.717285],[-45.458594,-1.35625],[-47.398096,-.62666],[-48.115088,-.7375],[-48.449805,-1.145508],[-48.349805,-1.482129],[-48.71001,-1.487695],[-49.211035,-1.916504],[-49.636523,-2.656934],[-49.313672,-1.731738],[-50.403223,-2.015527],[-50.690039,-1.761719],[-50.894922,-.937598],[-51.947559,-1.586719],[-52.66416,-1.551758],[-51.980811,-1.367969],[-51.28291,-.085205],[-49.898877,1.162988],[-49.957129,1.659863],[-50.714404,2.134033],[-51.219922,4.093604],[-51.54707,4.310889],[-51.652539,4.061279],[-52.903467,2.211523],[-53.767773,2.354834],[-54.130078,2.121045],[-54.61626,2.326758],[-54.978662,2.597656],[-55.957471,2.520459],[-56.137695,2.259033],[-55.929639,1.8875],[-56.482812,1.942139],[-57.31748,1.963477],[-58.821777,1.201221],[-59.231201,1.376025],[-59.666602,1.746289],[-59.994336,2.68999],[-59.854395,3.5875],[-59.551123,3.933545],[-59.703271,4.381104],[-60.148633,4.533252],[-59.990674,5.082861],[-60.142041,5.238818],[-60.742139,5.202051],[-60.603857,4.949365],[-61.002832,4.535254],[-62.712109,4.01792],[-62.856982,3.593457],[-63.338672,3.943896],[-64.021484,3.929102],[-64.788672,4.276025],[-64.221094,3.587402],[-64.046582,2.502393],[-63.389258,2.411914],[-63.43252,2.155566],[-64.008496,1.931592],[-64.205029,1.529492],[-65.473389,.69126],[-65.681445,.983447],[-66.347119,.767188],[-66.876025,1.223047]]],[[[-49.628662,-.229199],[-50.645508,-.272852],[-50.796094,-.90625],[-50.507617,-1.787988],[-49.805127,-1.790234],[-48.833594,-1.390039],[-48.392676,-.297363],[-49.628662,-.229199]]],[[[-45.260254,-23.88916],[-45.302344,-23.727539],[-45.451416,-23.895605],[-45.260254,-23.88916]]],[[[-49.738232,.268164],[-50.272656,.231738],[-50.339453,.043359],[-49.91709,-.023193],[-49.738232,.268164]]],[[[-49.443896,-.112402],[-49.503467,.083691],[-49.830078,-.093896],[-49.443896,-.112402]]],[[[-50.426123,.139258],[-50.372754,.590869],[-50.623926,.054395],[-50.426123,.139258]]],[[[-50.15293,.393018],[-50.058838,.638037],[-50.281689,.516504],[-50.15293,.393018]]],[[[-51.83252,-1.433789],[-51.276318,-1.021777],[-51.254004,-.541406],[-51.546045,-.649609],[-51.83252,-1.433789]]]]}},{type:"Feature",properties:{name:"博茨瓦纳",full_name:"博茨瓦纳共和国",iso_a2:"BW",iso_a3:"BWA",iso_n3:"072"},geometry:{type:"Polygon",coordinates:[[[25.258789,-17.793555],[24.243945,-18.023438],[23.599707,-18.459961],[23.219336,-17.999707],[20.974121,-18.318848],[20.979492,-21.961914],[19.977344,-22.000195],[19.980469,-24.776758],[20.793164,-25.915625],[20.685059,-26.822461],[21.646289,-26.854199],[22.597656,-26.132715],[23.05752,-25.312305],[24.748145,-25.817383],[25.443652,-25.714453],[25.912109,-24.747461],[26.835059,-24.24082],[27.085547,-23.57793],[28.210156,-22.693652],[29.364844,-22.193945],[29.025586,-21.796875],[28.014063,-21.554199],[27.669434,-21.064258],[27.679297,-20.503027],[27.280762,-20.478711],[27.178223,-20.100977],[26.168066,-19.538281],[25.258789,-17.793555]]]}},{type:"Feature",properties:{name:"波黑",full_name:"波斯尼亚和黑塞哥维那",iso_a2:"BA",iso_a3:"BIH",iso_n3:"070"},geometry:{type:"Polygon",coordinates:[[[19.194336,43.533301],[19.495117,43.642871],[19.24502,43.965039],[19.583789,44.043457],[19.118457,44.359961],[19.348633,44.880908],[19.007129,44.869189],[16.918652,45.276562],[16.293359,45.008838],[15.788086,45.178955],[15.736621,44.76582],[17.585156,42.938379],[17.667578,42.897119],[18.436328,42.559717],[18.460156,42.9979],[19.194336,43.533301]]]}},{type:"Feature",properties:{name:"玻利维亚",full_name:"多民族玻利维亚国",iso_a2:"BO",iso_a3:"BOL",iso_n3:"068"},geometry:{type:"Polygon",coordinates:[[[-69.510938,-17.506055],[-69.093945,-18.050488],[-68.968311,-18.967969],[-68.462891,-19.432813],[-68.760547,-20.416211],[-68.197021,-21.300293],[-67.879443,-22.822949],[-67.194873,-22.82168],[-66.220166,-21.802539],[-65.771045,-22.099609],[-64.605518,-22.228809],[-64.325293,-22.827637],[-63.92168,-22.028613],[-62.843359,-21.997266],[-62.650977,-22.233691],[-62.276318,-20.5625],[-61.756836,-19.645312],[-59.090527,-19.28623],[-58.180176,-19.817871],[-58.159766,-20.164648],[-57.860742,-19.97959],[-58.131494,-19.744531],[-57.495654,-18.214648],[-57.832471,-17.512109],[-58.395996,-17.234277],[-58.345605,-16.284375],[-60.175586,-16.269336],[-60.242334,-15.47959],[-60.583203,-15.09834],[-60.27334,-15.08877],[-60.506592,-13.789844],[-61.077002,-13.489746],[-61.789941,-13.525586],[-63.06748,-12.669141],[-64.420508,-12.439746],[-64.992529,-11.975195],[-65.389893,-11.246289],[-65.396143,-9.712402],[-66.575342,-9.899902],[-68.622656,-11.10918],[-69.578613,-10.951758],[-68.685254,-12.501953],[-68.978613,-12.880078],[-69.074121,-13.682813],[-68.870898,-14.169727],[-69.359473,-14.795312],[-69.172461,-15.236621],[-69.420898,-15.640625],[-69.217578,-16.149121],[-68.842773,-16.337891],[-69.624854,-17.200195],[-69.510938,-17.506055]]]}},{type:"Feature",properties:{name:"不丹",full_name:"不丹王国",iso_a2:"BT",iso_a3:"BTN",iso_n3:"064"},geometry:{type:"Polygon",coordinates:[[[91.631934,27.759961],[91.273047,28.078369],[90.352734,28.080225],[89.981055,28.311182],[88.891406,27.316064],[88.857617,26.961475],[89.609961,26.719434],[91.99834,26.85498],[92.083398,27.290625],[91.594727,27.557666],[91.631934,27.759961]]]}},{type:"Feature",properties:{name:"贝宁",full_name:"贝宁共和国",iso_a2:"BJ",iso_a3:"BEN",iso_n3:"204"},geometry:{type:"Polygon",coordinates:[[[1.622656,6.216797],[2.706445,6.369238],[2.774805,9.048535],[3.044922,9.083838],[3.834473,10.607422],[3.487793,11.39541],[3.59541,11.696289],[2.805273,12.383838],[2.366016,12.221924],[2.38916,11.89707],[1.980371,11.418408],[1.426758,11.447119],[.900488,10.993262],[.763379,10.38667],[1.330078,9.996973],[1.600195,9.050049],[1.530957,6.992432],[1.77793,6.294629],[1.622656,6.216797]]]}},{type:"Feature",properties:{name:"伯利兹",full_name:"伯利兹",iso_a2:"BZ",iso_a3:"BLZ",iso_n3:"084"},geometry:{type:"Polygon",coordinates:[[[-89.161475,17.814844],[-89.2375,15.894434],[-88.894043,15.890625],[-88.313428,16.632764],[-88.085254,18.226123],[-88.295654,18.472412],[-89.161475,17.814844]]]}},{type:"Feature",properties:{name:"比利时",full_name:"比利时王国",iso_a2:"BE",iso_a3:"BEL",iso_n3:"056"},geometry:{type:"Polygon",coordinates:[[[4.226172,51.386475],[3.902051,51.207666],[3.350098,51.377686],[2.524902,51.097119],[2.759375,50.750635],[4.174609,50.246484],[4.149316,49.971582],[4.818652,50.153174],[4.867578,49.788135],[5.789746,49.538281],[5.744043,49.919629],[6.116504,50.120996],[6.340918,50.451758],[5.993945,50.750439],[5.639453,50.843604],[5.796484,51.153076],[5.030957,51.469092],[4.226172,51.386475]]]}},{type:"Feature",properties:{name:"白俄罗斯",full_name:"白俄罗斯共和国",iso_a2:"BY",iso_a3:"BLR",iso_n3:"112"},geometry:{type:"Polygon",coordinates:[[[31.763379,52.101074],[31.258789,53.016699],[31.417871,53.196045],[32.141992,53.091162],[32.706445,53.419434],[31.754199,53.810449],[30.798828,54.783252],[30.906836,55.57002],[30.233594,55.845215],[29.482227,55.68457],[29.375,55.938721],[28.147949,56.14292],[27.576758,55.798779],[26.593555,55.667529],[26.457617,55.34248],[26.775684,55.273096],[25.780859,54.833252],[25.749219,54.156982],[25.461133,54.292773],[24.317969,53.892969],[23.484668,53.939795],[23.91543,52.770264],[23.175098,52.286621],[23.652441,52.040381],[23.605273,51.51792],[25.267188,51.937744],[27.141992,51.752051],[27.7,51.477979],[28.73125,51.433398],[29.102051,51.627539],[29.346484,51.382568],[30.160742,51.477881],[30.544531,51.265039],[30.755273,51.895166],[31.763379,52.101074]]]}},{type:"Feature",properties:{name:"巴巴多斯",full_name:"巴巴多斯",iso_a2:"BB",iso_a3:"BRB",iso_n3:"052"},geometry:{type:"Polygon",coordinates:[[[-59.493311,13.081982],[-59.427637,13.152783],[-59.64668,13.303125],[-59.493311,13.081982]]]}},{type:"Feature",properties:{name:"孟加拉国",full_name:"孟加拉人民共和国",iso_a2:"BD",iso_a3:"BGD",iso_n3:"050"},geometry:{type:"MultiPolygon",coordinates:[[[[89.051465,22.093164],[89.353711,21.721094],[89.483203,22.275537],[89.568555,21.767432],[89.985156,22.466406],[89.918066,22.116162],[90.20957,22.156592],[90.230566,21.829785],[90.616113,22.362158],[90.435059,22.751904],[90.590918,23.266406],[90.269141,23.455859],[90.604004,23.591357],[90.945605,22.597021],[91.480078,22.884814],[91.863379,22.350488],[92.324121,20.791846],[92.17959,21.293115],[92.631641,21.306201],[92.574902,21.978076],[92.246094,23.683594],[91.92959,23.685986],[91.619531,22.979688],[91.315234,23.104395],[91.160449,23.660645],[91.36709,24.093506],[91.876953,24.195312],[92.468359,24.944141],[92.049707,25.169482],[89.833301,25.292773],[89.670898,26.213818],[89.369727,26.006104],[89.018652,26.410254],[88.828027,26.252197],[88.418164,26.571533],[88.08457,25.888232],[88.95166,25.259277],[88.45625,25.188428],[88.023438,24.627832],[88.723535,24.274902],[88.567383,23.674414],[88.928125,23.186621],[89.051465,22.093164]]],[[[90.777637,22.089307],[90.868164,22.484863],[90.596484,22.863525],[90.680469,22.32749],[90.515039,22.065137],[90.777637,22.089307]]]]}},{type:"Feature",properties:{name:"巴林",full_name:"巴林王国",iso_a2:"BH",iso_a3:"BHR",iso_n3:"048"},geometry:{type:"Polygon",coordinates:[[[50.607227,25.883105],[50.585938,26.240723],[50.469922,26.228955],[50.607227,25.883105]]]}},{type:"Feature",properties:{name:"巴哈马",full_name:"巴哈马国",iso_a2:"BS",iso_a3:"BHS",iso_n3:"044"},geometry:{type:"MultiPolygon",coordinates:[[[[-77.657715,24.249463],[-77.999902,24.219824],[-77.57373,23.73916],[-77.657715,24.249463]]],[[[-77.225635,25.904199],[-77.066357,26.530176],[-77.533887,26.903418],[-77.94375,26.903564],[-77.238623,26.561133],[-77.403174,26.024707],[-77.225635,25.904199]]],[[[-73.026855,21.192383],[-73.523096,21.19082],[-73.681152,20.975586],[-73.164551,20.97915],[-73.026855,21.192383]]],[[[-77.743848,24.707422],[-78.211377,25.19126],[-78.366504,24.544189],[-78.044922,24.287451],[-77.743848,24.707422]]],[[[-78.492871,26.729053],[-78.985645,26.689502],[-78.743652,26.500684],[-77.922461,26.691113],[-78.492871,26.729053]]],[[[-76.648828,25.487402],[-76.1604,25.119336],[-76.169531,24.649414],[-76.126611,25.140527],[-76.648828,25.487402]]],[[[-74.840479,22.894336],[-75.315967,23.668359],[-75.22334,23.165332],[-74.840479,22.894336]]],[[[-75.308398,24.2],[-75.72666,24.689355],[-75.503223,24.139062],[-75.308398,24.2]]]]}},{type:"Feature",properties:{name:"阿塞拜疆",full_name:"阿塞拜疆共和国",iso_a2:"AZ",iso_a3:"AZE",iso_n3:"031"},geometry:{type:"MultiPolygon",coordinates:[[[[44.817188,39.650439],[45.479688,39.00625],[46.114453,38.877783],[45.784473,39.545605],[44.768262,39.703516],[44.817188,39.650439]]],[[[48.86875,38.435498],[49.551172,40.194141],[50.365918,40.279492],[49.456738,40.799854],[48.572852,41.844482],[47.791016,41.199268],[46.429883,41.890967],[46.182129,41.65708],[46.672559,41.286816],[46.534375,41.088574],[45.280957,41.449561],[45.001367,41.290967],[45.5875,40.846924],[45.454395,40.532373],[45.964648,40.233789],[45.579785,39.977539],[46.481445,39.555176],[46.490625,38.906689],[47.995898,39.683936],[48.322168,39.399072],[47.996484,38.85376],[48.86875,38.435498]]]]}},{type:"Feature",properties:{name:"奥地利",full_name:"奥地利共和国",iso_a2:"AT",iso_a3:"AUT",iso_n3:"040"},geometry:{type:"Polygon",coordinates:[[[9.527539,47.270752],[9.580273,47.057373],[10.452832,46.864941],[10.993262,46.777002],[12.169434,47.082129],[12.388281,46.702637],[13.7,46.520264],[14.549805,46.399707],[16.093066,46.863281],[16.676563,47.536035],[16.421289,47.674463],[17.066602,47.707568],[17.147363,48.005957],[16.953125,48.598828],[15.066797,48.997852],[14.691309,48.599219],[13.814746,48.766943],[12.760352,48.106982],[13.014355,47.478076],[12.209277,47.718262],[11.041992,47.393115],[10.439453,47.551562],[10.183008,47.278809],[9.524023,47.524219],[9.527539,47.270752]]]}},{type:"Feature",properties:{name:"澳大利亚",full_name:"澳大利亚联邦",iso_a2:"AU",iso_a3:"AUS",iso_n3:"036"},geometry:{type:"MultiPolygon",coordinates:[[[[143.178906,-11.954492],[142.872559,-11.821387],[142.779688,-11.115332],[142.456445,-10.707324],[142.168359,-10.946582],[141.961133,-12.054297],[141.688574,-12.351074],[141.929785,-12.739844],[141.613574,-12.943457],[141.625488,-15.056641],[141.291406,-16.463477],[140.830469,-17.414453],[140.03584,-17.702637],[139.248438,-17.328613],[139.009863,-16.899316],[138.24502,-16.718359],[135.45332,-14.923145],[135.954492,-13.934863],[135.927344,-13.304297],[136.461035,-13.225195],[136.897461,-12.243555],[136.443359,-11.951465],[136.081836,-12.422461],[136.008496,-12.191406],[135.704395,-12.209863],[135.922461,-11.825781],[135.029688,-12.19375],[131.961523,-11.180859],[131.822461,-11.302441],[132.072852,-11.474707],[132.674219,-11.649023],[132.712793,-12.123438],[131.438281,-12.276953],[131.291602,-12.067871],[130.867383,-12.557813],[130.622656,-12.431055],[130.168164,-12.957422],[130.259766,-13.302246],[129.838867,-13.572949],[129.378711,-14.39248],[129.84873,-14.828906],[129.637109,-14.850977],[129.634766,-15.139746],[129.267578,-14.871484],[129.21582,-15.160254],[129.058203,-14.884375],[128.575781,-14.774512],[128.069434,-15.329297],[128.180469,-14.711621],[127.457617,-14.031445],[126.903223,-13.744141],[126.569727,-14.160938],[126.053906,-13.977246],[126.020703,-14.494531],[125.661621,-14.529492],[125.627734,-14.256641],[125.178711,-14.714746],[125.355664,-15.119824],[124.839063,-15.160742],[125.062988,-15.442285],[124.692578,-15.273633],[124.439551,-15.493555],[124.381641,-15.758203],[124.648535,-15.870215],[124.404883,-16.298926],[124.771973,-16.402637],[123.607031,-16.224023],[123.49043,-16.490723],[123.874414,-16.918652],[123.831055,-17.120801],[123.593555,-17.030371],[123.563086,-17.520898],[122.970703,-16.436816],[122.260938,-17.135742],[122.34541,-18.111914],[120.997949,-19.604395],[119.104492,-19.995313],[117.40625,-20.721191],[116.706738,-20.653809],[114.709277,-21.823438],[114.141602,-22.483105],[114.022852,-21.881445],[113.417676,-24.435645],[114.214258,-25.851562],[114.215723,-26.289453],[113.72373,-26.129785],[113.451367,-25.599121],[113.836426,-26.500586],[113.581641,-26.558105],[113.356055,-26.080469],[113.184766,-26.182227],[114.028125,-27.347266],[114.165137,-28.080664],[114.856836,-29.142969],[115.07793,-30.560449],[115.698438,-31.694531],[115.683008,-33.192871],[115.358789,-33.639941],[114.993848,-33.515332],[115.008789,-34.255859],[116.517188,-34.987891],[117.581934,-35.097754],[119.450586,-34.368262],[119.854102,-33.974707],[123.506836,-33.916211],[124.24375,-33.015234],[125.917188,-32.296973],[127.319824,-32.264062],[129.187695,-31.659961],[131.143652,-31.495703],[134.23418,-32.548535],[134.173535,-32.979102],[134.791016,-33.32832],[135.45,-34.581055],[135.123047,-34.585742],[135.647559,-34.939648],[135.969727,-34.981836],[135.891016,-34.660938],[136.430664,-34.02998],[137.237305,-33.629492],[137.783203,-32.578125],[137.931836,-33.579102],[137.493848,-34.161133],[137.391016,-34.913281],[137.014258,-34.91582],[136.883594,-35.239746],[137.691699,-35.142969],[138.089258,-34.169824],[138.511133,-35.024414],[138.184375,-35.612695],[139.28252,-35.375391],[139.289453,-35.611328],[138.968945,-35.580762],[139.729004,-36.371387],[139.784277,-37.245801],[140.39043,-37.89668],[141.424219,-38.363477],[142.455859,-38.386328],[143.538965,-38.820898],[144.891309,-37.899805],[145.119922,-38.091309],[144.717773,-38.340332],[144.95957,-38.500781],[145.475781,-38.24375],[145.397266,-38.535352],[146.4,-39.145508],[146.21748,-38.727441],[146.856836,-38.663477],[147.876758,-37.93418],[149.932715,-37.528516],[150.195312,-35.833594],[150.80459,-35.012891],[151.29209,-33.580957],[152.47041,-32.439062],[152.943945,-31.434863],[153.616895,-28.673047],[153.116797,-27.194434],[153.164941,-25.96416],[151.831641,-24.122949],[150.843164,-23.458008],[150.672461,-22.418164],[150.541309,-22.559082],[150.076172,-22.164453],[149.974414,-22.550684],[149.703906,-22.440527],[149.454102,-21.578711],[148.683691,-20.580176],[148.884766,-20.480859],[148.759375,-20.289551],[147.418555,-19.378125],[146.383398,-18.977051],[146.032227,-18.272852],[145.912109,-16.9125],[145.426074,-16.406152],[145.287695,-14.943164],[144.473047,-14.231836],[143.756348,-14.348828],[143.178906,-11.954492]]],[[[139.507812,-16.573047],[139.587891,-16.395215],[139.15957,-16.741699],[139.507812,-16.573047]]],[[[136.714648,-13.803906],[136.424707,-13.864844],[136.335449,-14.211816],[136.894336,-14.293066],[136.89082,-13.786621],[136.714648,-13.803906]]],[[[130.459277,-11.679297],[130.294922,-11.336816],[130.043262,-11.787305],[130.60625,-11.816602],[130.459277,-11.679297]]],[[[130.618848,-11.376074],[130.38457,-11.192188],[130.511914,-11.617871],[130.950977,-11.926465],[131.538574,-11.436914],[131.268262,-11.189844],[130.618848,-11.376074]]],[[[137.596484,-35.738672],[137.334082,-35.59248],[136.540625,-35.890137],[137.448438,-36.074805],[138.123438,-35.852344],[137.596484,-35.738672]]],[[[146.27832,-18.23125],[146.098828,-18.251758],[146.298828,-18.484766],[146.27832,-18.23125]]],[[[136.338672,-11.602344],[136.479297,-11.465918],[136.180273,-11.676758],[136.338672,-11.602344]]],[[[145.042969,-40.786719],[144.718555,-40.672266],[144.766113,-41.390039],[145.516602,-42.354492],[145.198828,-42.230859],[145.487598,-42.92666],[146.208008,-43.316211],[146.043164,-43.547168],[146.873926,-43.6125],[147.297949,-42.790918],[147.94541,-43.181836],[148.213672,-41.97002],[148.342578,-42.215332],[148.215234,-40.854883],[146.31748,-41.163477],[145.042969,-40.786719]]],[[[148.000391,-39.757617],[147.767188,-39.870313],[148.105664,-40.262109],[148.297363,-39.985742],[148.000391,-39.757617]]],[[[148.32627,-40.306934],[148.020117,-40.404199],[148.404004,-40.486523],[148.32627,-40.306934]]]]}},{type:"Feature",properties:{name:"圣诞岛",full_name:"圣诞岛（澳大利亚）",iso_a2:"CX",iso_a3:"CXR",iso_n3:"162"},geometry:{type:"Polygon",coordinates:[[[105.725391,-10.492969],[105.584082,-10.5125],[105.696875,-10.56416],[105.725391,-10.492969]]]}},{type:"Feature",properties:{name:"赫德岛和麦克唐纳群岛",full_name:"赫德岛和麦克唐纳群岛",iso_a2:"HM",iso_a3:"HMD",iso_n3:"334"},geometry:{type:"Polygon",coordinates:[[[73.707422,-53.137109],[73.251172,-52.975781],[73.465137,-53.18418],[73.707422,-53.137109]]]}},{type:"Feature",properties:{name:"诺福克岛",full_name:"诺福克岛（澳大利亚）",iso_a2:"NF",iso_a3:"NFK",iso_n3:"574"},geometry:{type:"Polygon",coordinates:[[[167.939453,-29.017676],[167.960742,-29.096289],[167.99043,-29.04209],[167.939453,-29.017676]]]}},{type:"Feature",properties:{name:"阿什莫尔和卡捷群岛",full_name:"阿什莫尔和卡捷群岛（澳大利亚）",iso_a2:"AU",iso_a3:"AUS",iso_n3:"036"},geometry:{type:"Polygon",coordinates:[[[123.594531,-12.425684],[123.572461,-12.423926],[123.573145,-12.43418],[123.594531,-12.425684]]]}},{type:"Feature",properties:{name:"亚美尼亚",full_name:"亚美尼亚共和国",iso_a2:"AM",iso_a3:"ARM",iso_n3:"051"},geometry:{type:"Polygon",coordinates:[[[44.768262,39.703516],[45.784473,39.545605],[46.114453,38.877783],[46.490625,38.906689],[46.481445,39.555176],[45.579785,39.977539],[45.964648,40.233789],[45.454395,40.532373],[45.5875,40.846924],[45.001367,41.290967],[43.439453,41.107129],[43.666211,40.126367],[44.768262,39.703516]]]}},{type:"Feature",properties:{name:"阿根廷",full_name:"阿根廷共和国",iso_a2:"AR",iso_a3:"ARG",iso_n3:"032"},geometry:{type:"MultiPolygon",coordinates:[[[[-57.608887,-30.187793],[-55.725488,-28.204102],[-53.838184,-27.121094],[-53.668555,-26.288184],[-53.891162,-25.668848],[-54.615869,-25.576074],[-54.825488,-26.652246],[-55.714648,-27.414844],[-56.164062,-27.321484],[-56.437158,-27.553809],[-58.604834,-27.314355],[-57.643896,-25.328418],[-59.89248,-24.093555],[-61.03291,-23.755664],[-62.650977,-22.233691],[-62.843359,-21.997266],[-63.92168,-22.028613],[-64.325293,-22.827637],[-64.605518,-22.228809],[-65.771045,-22.099609],[-66.220166,-21.802539],[-67.194873,-22.82168],[-67.008789,-23.001367],[-67.356201,-24.033789],[-68.562012,-24.747363],[-68.384229,-25.091895],[-68.591602,-26.47041],[-68.318652,-26.973242],[-68.846338,-27.153711],[-69.656934,-28.413574],[-70.026807,-29.324023],[-69.844287,-30.175],[-70.51958,-31.148438],[-70.084863,-33.201758],[-69.819629,-33.283789],[-69.852441,-34.224316],[-70.555176,-35.246875],[-70.404785,-36.061719],[-71.192187,-36.843652],[-70.858643,-38.604492],[-71.401562,-38.935059],[-71.932129,-40.691699],[-71.75,-42.046777],[-72.108203,-42.251855],[-72.146436,-42.990039],[-71.750635,-43.237305],[-71.82002,-44.383105],[-71.159717,-44.560254],[-71.261133,-44.763086],[-72.063721,-44.771875],[-71.349316,-45.331934],[-71.746191,-45.578906],[-71.699658,-46.651367],[-72.51792,-47.876367],[-72.354736,-48.36582],[-73.554199,-49.463867],[-73.50127,-50.125293],[-73.15293,-50.738281],[-72.340234,-50.681836],[-72.407666,-51.54082],[-71.918652,-51.989551],[-69.960254,-52.008203],[-68.443359,-52.356641],[-68.965332,-51.677148],[-69.46543,-51.584473],[-69.035303,-51.488965],[-69.358594,-51.028125],[-69.044775,-50.499121],[-68.421875,-50.15791],[-68.97959,-50.003027],[-68.667578,-49.752539],[-68.257227,-50.10459],[-67.825977,-49.919629],[-67.466309,-48.951758],[-65.810059,-47.941113],[-66.225244,-47.826758],[-65.738086,-47.344922],[-65.998535,-47.09375],[-66.776855,-47.005859],[-67.599561,-46.052539],[-66.941406,-45.257324],[-65.63877,-45.007812],[-65.252344,-43.571875],[-64.319141,-42.968945],[-64.970703,-42.666309],[-64.487842,-42.513477],[-64.034766,-42.88125],[-63.617334,-42.695801],[-63.795557,-42.113867],[-64.42041,-42.433789],[-64.986377,-42.102051],[-65.133398,-40.880664],[-64.869482,-40.73584],[-63.621777,-41.159766],[-62.39502,-40.89082],[-62.053662,-39.373828],[-62.334766,-38.800098],[-61.602539,-38.998828],[-59.82832,-38.838184],[-57.546973,-38.085645],[-56.672021,-36.85127],[-56.698096,-36.426465],[-57.335449,-36.026758],[-57.303662,-35.188477],[-58.28335,-34.683496],[-58.525488,-34.296191],[-58.39248,-34.192969],[-58.547217,-33.663477],[-58.424463,-33.111523],[-58.170996,-32.959277],[-58.201172,-32.47168],[-57.608887,-30.187793]]],[[[-68.653223,-54.853613],[-66.511133,-55.032129],[-65.179004,-54.678125],[-67.294238,-54.049805],[-68.488525,-53.260938],[-68.240137,-53.081836],[-68.629932,-52.652637],[-68.653223,-54.853613]]],[[[-64.54917,-54.716211],[-64.637354,-54.902539],[-63.81543,-54.725098],[-64.54917,-54.716211]]]]}},{type:"Feature",properties:{name:"安提瓜和巴布达",full_name:"安提瓜和巴布达",iso_a2:"AG",iso_a3:"ATG",iso_n3:"028"},geometry:{type:"Polygon",coordinates:[[[-61.716064,17.037012],[-61.817285,17.168945],[-61.887109,17.098145],[-61.716064,17.037012]]]}},{type:"Feature",properties:{name:"安哥拉",full_name:"安哥拉共和国",iso_a2:"AO",iso_a3:"AGO",iso_n3:"024"},geometry:{type:"MultiPolygon",coordinates:[[[[13.072754,-4.634766],[12.798242,-4.430566],[12.018359,-5.004297],[12.213672,-5.758691],[12.503711,-5.695801],[12.451465,-5.071484],[13.072754,-4.634766]]],[[[23.966504,-10.871777],[22.226172,-11.121973],[22.274512,-10.259082],[21.813184,-9.46875],[21.781641,-7.314648],[20.607813,-7.277734],[20.590039,-6.919922],[19.875195,-6.986328],[19.527637,-7.144434],[19.34082,-7.966602],[17.57959,-8.099023],[16.431445,-5.900195],[13.068164,-5.864844],[12.283301,-6.124316],[13.378516,-8.369727],[12.998535,-9.048047],[13.833594,-10.929688],[13.785352,-11.812793],[12.550488,-13.437793],[11.750879,-15.831934],[11.743066,-17.249219],[13.101172,-16.967676],[14.01748,-17.408887],[18.396387,-17.399414],[18.955273,-17.803516],[20.745508,-18.019727],[23.380664,-17.640625],[22.040234,-16.262793],[21.978906,-13.000977],[23.962988,-12.988477],[23.966504,-10.871777]]]]}},{type:"Feature",properties:{name:"安道尔",full_name:"安道尔公国",iso_a2:"AD",iso_a3:"AND",iso_n3:"020"},geometry:{type:"Polygon",coordinates:[[[1.706055,42.50332],[1.42832,42.595898],[1.448828,42.437451],[1.706055,42.50332]]]}},{type:"Feature",properties:{name:"阿尔及利亚",full_name:"阿尔及利亚民主人民共和国",iso_a2:"DZ",iso_a3:"DZA",iso_n3:"012"},geometry:{type:"Polygon",coordinates:[[[8.576563,36.937207],[6.486523,37.085742],[5.29541,36.648242],[4.758105,36.896338],[3.779004,36.896191],[1.257227,36.51958],[-.048242,35.832812],[-2.219629,35.104199],[-1.795605,34.751904],[-1.679199,33.318652],[-1.065527,32.468311],[-1.225928,32.107227],[-2.887207,32.068848],[-3.017383,31.834277],[-3.826758,31.661914],[-3.666797,30.964014],[-4.968262,30.465381],[-5.448779,29.956934],[-7.685156,29.349512],[-8.678418,28.689404],[-8.68335,27.656445],[-8.68335,27.285938],[-4.822607,24.995605],[1.145508,21.102246],[1.685449,20.378369],[3.130273,19.850195],[3.119727,19.103174],[4.227637,19.142773],[5.836621,19.47915],[7.481738,20.873096],[11.967871,23.517871],[11.507617,24.314355],[10.255859,24.591016],[9.448242,26.067139],[9.883203,26.630811],[9.916016,27.785693],[9.805273,29.176953],[9.310254,30.115234],[9.51875,30.229395],[9.044043,32.072363],[8.333398,32.543604],[7.500195,33.832471],[8.245605,34.734082],[8.207617,36.518945],[8.576563,36.937207]]]}},{type:"Feature",properties:{name:"阿尔巴尼亚",full_name:"阿尔巴尼亚共和国",iso_a2:"AL",iso_a3:"ALB",iso_n3:"008"},geometry:{type:"Polygon",coordinates:[[[19.342383,41.869092],[19.575684,41.64043],[19.322266,40.40708],[20.00127,39.709424],[20.657422,40.117383],[20.964258,40.849902],[20.488965,41.272607],[20.566211,41.873682],[20.063965,42.547266],[19.654492,42.628564],[19.342383,41.869092]]]}},{type:"Feature",properties:{name:"阿富汗",full_name:"阿富汗",iso_a2:"AF",iso_a3:"AFG",iso_n3:"004"},geometry:{type:"Polygon",coordinates:[[[66.522266,37.348486],[65.765039,37.569141],[65.55498,37.251172],[64.816309,37.13208],[64.511035,36.340674],[63.12998,35.846191],[63.056641,35.445801],[62.688086,35.255322],[62.307813,35.170801],[61.262012,35.61958],[60.72627,34.518262],[60.889453,34.319434],[60.485742,34.094775],[60.51084,33.638916],[60.916992,33.505225],[60.561914,33.058789],[60.820703,31.495166],[61.660156,31.382422],[61.81084,30.913281],[60.843359,29.858691],[62.476562,29.40835],[64.09873,29.391943],[66.23125,29.865723],[66.346875,30.802783],[66.829297,31.263672],[67.452832,31.234619],[68.161035,31.802979],[68.868945,31.634229],[69.279297,31.936816],[69.501562,33.020068],[70.261133,33.289014],[69.889648,34.007275],[71.051563,34.049707],[70.965625,34.530371],[71.620508,35.183008],[71.23291,36.121777],[72.249805,36.734717],[74.541406,37.022168],[74.372168,37.157715],[74.891309,37.231641],[74.349023,37.41875],[73.653516,37.239355],[73.720605,37.41875],[73.38291,37.462256],[71.665625,36.696924],[71.43291,37.127539],[71.582227,37.910107],[71.278516,37.918408],[71.255859,38.306982],[70.878906,38.456396],[70.214648,37.924414],[70.188672,37.582471],[69.49209,37.553076],[69.303906,37.116943],[68.911816,37.333936],[68.067773,36.949805],[67.758984,37.172217],[66.522266,37.348486]]]}},{type:"Feature",properties:{name:"锡亚琴冰川",full_name:"锡亚琴冰川",iso_a2:"-99",iso_a3:"-99",iso_n3:"-99"},geometry:{type:"Polygon",coordinates:[[[77.048633,35.109912],[77.799414,35.495898],[76.766895,35.661719],[77.048633,35.109912]]]}},{type:"Feature",properties:{name:"南极洲",full_name:"南极洲",iso_a2:"AQ",iso_a3:"ATA",iso_n3:"010"},geometry:{type:"MultiPolygon",coordinates:[[[[-57.020654,-63.372852],[-57.389648,-63.22627],[-58.87207,-63.551855],[-60.86416,-64.073438],[-61.631787,-64.604688],[-62.503467,-64.656445],[-63.059082,-65.139355],[-63.760254,-65.033496],[-63.818115,-65.531543],[-64.646582,-65.747852],[-64.613525,-66.019043],[-65.617285,-66.135254],[-65.766406,-66.624902],[-66.503613,-66.689844],[-66.498682,-67.289062],[-67.034473,-66.945117],[-67.493359,-67.112793],[-67.544531,-67.534668],[-66.677246,-67.560254],[-67.390527,-68.86123],[-66.974902,-69.161035],[-67.371777,-69.412305],[-68.707959,-69.432227],[-66.827734,-72.09043],[-68.000342,-72.935547],[-72.929199,-73.447949],[-73.996045,-73.699805],[-75.293066,-73.63877],[-77.048926,-73.844141],[-76.850488,-73.460449],[-78.78623,-73.506738],[-80.442236,-72.944531],[-80.336377,-73.41416],[-81.176416,-73.248828],[-81.30874,-73.738281],[-82.183496,-73.856836],[-85.801416,-73.19209],[-86.791016,-73.363672],[-88.419385,-73.229004],[-88.194092,-72.7875],[-88.77998,-72.683008],[-90.920947,-73.319141],[-92.828369,-73.164648],[-96.394238,-73.301172],[-98.208594,-73.022266],[-102.409277,-72.987402],[-102.855859,-72.716211],[-103.375,-72.818848],[-102.908789,-73.285156],[-98.896143,-73.611133],[-102.862744,-73.783594],[-101.251709,-74.485742],[-100.118604,-74.515039],[-100.47334,-74.872363],[-98.752344,-75.31709],[-101.039355,-75.421875],[-101.708105,-75.127344],[-103.121045,-75.095215],[-106.618848,-75.343945],[-111.358789,-75.219922],[-110.229785,-74.536328],[-111.180176,-74.188086],[-111.69624,-74.792188],[-114.110449,-74.981836],[-113.508496,-74.088867],[-114.62373,-73.90293],[-115.222607,-74.487402],[-118.655762,-74.392773],[-121.543945,-74.75],[-135.362061,-74.69043],[-136.649854,-75.161719],[-139.691162,-75.212793],[-141.22334,-75.545898],[-140.874316,-75.745898],[-142.329834,-75.490918],[-145.987744,-75.88877],[-145.44209,-76.40918],[-148.458984,-76.117969],[-149.654248,-76.365332],[-147.34043,-76.438379],[-145.750488,-76.749023],[-145.677148,-77.488086],[-148.572412,-77.105078],[-148.155713,-77.462305],[-149.717725,-77.797461],[-154.814941,-77.126953],[-158.213574,-77.157129],[-158.285889,-77.950781],[-157.266797,-78.199805],[-154.293018,-78.259082],[-156.114551,-78.744629],[-152.137695,-79.115918],[-148.176514,-79.775879],[-150.575391,-80.353711],[-148.023438,-80.835742],[-156.528223,-81.162305],[-157.03252,-81.319141],[-153.956641,-81.700195],[-153.009863,-82.449609],[-159.444385,-83.543164],[-174.235938,-82.793457],[-167.801221,-83.79082],[-164.950879,-83.805859],[-165.135352,-84.409863],[-156.986328,-84.811133],[-156.459131,-85.186035],[-171.703662,-84.542383],[-180,-84.351562],[-180,-85.05752],[-180,-85.763379],[-180,-86.469336],[-180,-87.175195],[-180,-87.881055],[-180,-88.587012],[-180,-89.292969],[-180,-89.58291],[-180,-89.998926],[-1.40625,-89.998926],[180,-89.998926],[180,-84.351562],[171.035742,-83.448438],[168.110059,-83.362012],[168.607324,-83.065332],[164.980078,-82.384961],[161.283203,-82.489941],[163.602344,-82.120605],[160.469824,-81.340625],[160.637305,-80.449902],[158.573633,-80.423438],[160.558789,-80.010547],[159.975879,-79.585645],[160.873535,-79.049707],[161.951465,-79.02998],[161.669238,-78.536133],[162.639453,-78.897754],[164.634766,-78.603223],[167.130273,-78.606152],[165.662988,-78.305664],[165.417578,-78.042188],[163.977637,-78.223828],[164.420898,-77.883496],[162.450293,-76.955664],[162.815723,-75.846191],[160.910742,-75.334668],[162.410059,-75.237598],[163.397852,-74.382129],[165.408594,-74.558594],[164.812988,-73.396777],[165.733691,-73.866699],[165.860156,-73.592676],[167.709082,-73.394238],[166.452832,-72.936035],[167.155664,-73.147266],[169.54502,-73.050391],[169.828613,-72.728809],[168.428418,-72.383398],[170.206445,-72.565332],[170.030078,-72.115527],[170.859082,-71.868555],[170.435742,-71.41875],[170.162305,-71.630469],[166.626953,-70.664258],[163.566504,-70.642285],[162.674805,-70.30459],[162.021973,-70.439844],[162.189453,-71.039551],[159.783984,-69.521875],[155.520313,-69.024414],[153.908008,-68.323145],[153.081836,-68.856836],[151.28877,-68.81709],[150.935938,-68.358496],[147.093652,-68.368652],[145.975195,-67.624219],[143.977344,-67.864551],[144.621191,-67.141406],[143.730371,-66.876758],[142.6875,-67.012793],[135.351953,-66.127148],[134.289453,-66.476758],[133.148242,-66.094824],[130.120508,-66.291504],[129.236914,-67.041602],[128.430566,-67.119141],[125.865625,-66.364453],[119.133008,-67.370703],[120.374805,-66.983789],[116.713477,-67.047168],[114.026563,-67.441211],[113.991211,-67.211914],[115.635352,-66.771191],[113.099414,-65.799902],[110.906738,-66.07666],[110.622266,-66.524023],[109.462793,-66.908691],[102.674219,-65.865137],[101.381348,-65.973047],[100.889063,-66.358008],[99.370117,-66.648242],[98.257617,-66.46748],[94.839844,-66.501367],[93.964258,-66.689648],[92.073438,-66.50791],[84.485156,-67.114453],[83.304297,-67.603027],[79.035156,-68.175391],[77.81748,-69.068945],[75.423828,-69.893066],[73.324805,-69.848926],[71.771387,-70.80127],[71.276758,-71.623926],[68.419824,-72.515039],[67.32207,-73.300293],[66.497656,-73.125488],[69.250195,-70.431055],[67.267969,-70.273145],[68.178125,-69.837305],[69.082617,-69.866602],[68.90625,-69.372754],[69.629492,-69.231641],[69.982227,-68.464258],[69.55918,-67.763184],[68.32793,-67.889551],[63.699023,-67.508301],[59.250781,-67.484961],[57.627441,-67.014063],[56.154883,-67.264551],[56.145898,-66.626074],[57.185449,-66.613281],[55.504492,-66.002637],[53.671777,-65.858691],[51.88457,-66.02002],[50.332422,-66.444629],[50.553027,-67.194336],[49.24707,-66.941602],[48.465234,-67.043457],[49.219336,-67.226855],[48.374512,-67.988086],[48.209961,-67.699316],[47.489844,-67.72793],[47.351562,-67.361914],[46.559668,-67.268164],[46.399023,-67.617578],[42.960938,-68.095312],[40.215625,-68.804883],[38.885547,-70.171875],[37.787109,-69.725684],[35.357031,-69.681348],[34.595898,-69.094531],[33.813672,-69.099316],[34.192871,-68.702441],[33.465625,-68.670703],[32.641602,-68.868945],[32.621289,-70.000586],[30.00332,-70.3],[26.498828,-71.019531],[24.756738,-70.89209],[24.024121,-70.413379],[23.149902,-70.796289],[22.44541,-70.739746],[21.70498,-70.258496],[21.070801,-70.843457],[19.651855,-70.920605],[19.009375,-70.212109],[18.124609,-70.540332],[16.381055,-70.145117],[13.822656,-70.343164],[13.065625,-70.053613],[11.70127,-70.766602],[9.141602,-70.183691],[8.523047,-70.473828],[7.676758,-70.356348],[2.609473,-70.900098],[-.543164,-71.712695],[-1.067773,-71.265625],[-6.11748,-71.325977],[-5.936328,-70.712695],[-7.752734,-70.842773],[-7.713721,-71.546484],[-8.497705,-71.674805],[-10.270605,-70.935742],[-10.825439,-71.55332],[-12.351318,-71.389746],[-11.009229,-71.75791],[-11.496973,-72.412891],[-13.208594,-72.785059],[-14.297754,-72.733008],[-14.164697,-73.102441],[-15.595996,-73.096777],[-16.435205,-73.425684],[-16.220117,-73.915723],[-14.573828,-73.9375],[-15.67251,-74.407324],[-17.43584,-74.379102],[-18.749219,-75.24209],[-18.30459,-75.431348],[-26.059326,-75.957227],[-34.075781,-77.425391],[-36.23916,-78.774219],[-32.994238,-79.228809],[-30.645264,-79.124121],[-29.949316,-79.599023],[-23.406836,-79.858984],[-31.01543,-80.308105],[-35.327002,-80.650684],[-37.209277,-81.063867],[-38.771729,-80.882324],[-41.125879,-81.214844],[-45.04375,-82.437988],[-46.516748,-82.45459],[-46.258057,-81.946973],[-48.360791,-81.892285],[-53.986084,-82.200586],[-59.516016,-83.458398],[-61.425293,-83.395605],[-62.735645,-82.527344],[-60.527734,-82.199902],[-64.91958,-82.370508],[-66.133838,-81.953418],[-62.490234,-81.556738],[-65.573682,-81.460547],[-70.687891,-80.62627],[-73.029492,-80.917285],[-75.075586,-80.860059],[-76.407324,-80.094922],[-79.6604,-79.996875],[-76.557861,-79.903516],[-76.217676,-79.387207],[-80.151172,-79.268066],[-80.891992,-79.501855],[-83.696631,-78.537305],[-83.779004,-77.983594],[-80.292285,-78.822754],[-77.54502,-78.65957],[-77.858105,-78.350977],[-81.580957,-77.846094],[-80.601562,-77.751953],[-74.812061,-78.177832],[-73.251562,-77.894238],[-72.851953,-77.590234],[-75.748145,-77.398438],[-77.190039,-76.629785],[-70.550781,-76.718066],[-63.363379,-75.451465],[-64.279541,-75.292871],[-63.231055,-75.153809],[-63.924707,-75.004492],[-63.178125,-74.68418],[-62.137793,-74.926367],[-62.235303,-74.441309],[-60.704297,-74.307129],[-61.842773,-74.289648],[-60.790283,-73.711816],[-62.008301,-73.147656],[-60.122217,-73.275293],[-60.009766,-72.937891],[-61.286133,-72.600781],[-60.719434,-72.072656],[-62.256641,-72.017578],[-60.949023,-71.747266],[-61.213574,-71.564062],[-61.958789,-71.657812],[-60.962256,-71.244629],[-62.04043,-70.801367],[-61.504687,-70.490527],[-62.377783,-70.364844],[-61.961084,-70.120117],[-63.747021,-68.70459],[-62.933301,-68.442578],[-63.924463,-68.497656],[-64.078467,-68.771191],[-65.15835,-68.617969],[-65.452002,-68.336719],[-64.829492,-68.127441],[-65.639502,-68.130566],[-65.503125,-67.377246],[-64.819287,-67.307324],[-64.686279,-66.80625],[-63.754736,-66.872949],[-63.752539,-66.277734],[-62.628906,-66.706152],[-62.682031,-66.237305],[-61.756006,-66.429199],[-61.431934,-66.144727],[-61.028418,-66.336523],[-60.618311,-65.933105],[-61.839062,-66.119531],[-62.293262,-65.916406],[-61.703125,-64.987207],[-61.059863,-64.98125],[-59.963086,-64.431348],[-59.645996,-64.583691],[-59.546777,-64.358789],[-58.786084,-64.524219],[-59.005322,-64.194922],[-57.460645,-63.513574],[-56.834766,-63.63125],[-57.020654,-63.372852]]],[[[-45.222656,-78.810742],[-43.947217,-78.597559],[-44.093994,-78.167285],[-45.993164,-77.826855],[-47.69209,-77.840137],[-50.14165,-78.556738],[-50.339258,-79.479492],[-52.297168,-80.141211],[-53.393896,-80.108789],[-54.1625,-80.870117],[-43.52793,-80.191406],[-43.544336,-78.901953],[-45.222656,-78.810742]]],[[[-59.733936,-80.344141],[-60.578809,-79.741016],[-61.633301,-80.344141],[-66.771143,-80.293848],[-60.582812,-80.948145],[-59.733936,-80.344141]]],[[[-70.051123,-69.189062],[-70.416992,-68.788965],[-72.137891,-69.114551],[-71.728516,-70.053711],[-69.618359,-70.398047],[-71.190039,-70.65957],[-69.875781,-70.875977],[-69.869775,-71.125684],[-70.380664,-70.946387],[-72.710449,-71.072949],[-72.21167,-71.335059],[-75.335449,-71.645215],[-73.995605,-72.169824],[-73.775977,-71.848926],[-72.927637,-71.92168],[-72.336621,-71.632227],[-70.820996,-71.906543],[-71.892188,-72.152832],[-70.206006,-72.227734],[-72.7375,-72.280566],[-72.36748,-72.669727],[-69.209326,-72.53418],[-68.241016,-71.822168],[-68.459473,-70.68291],[-70.051123,-69.189062]]],[[[-98.091113,-71.9125],[-98.61543,-71.76377],[-99.833203,-72.046094],[-100.218652,-71.83291],[-102.313623,-72.081055],[-98.407812,-72.547656],[-95.575391,-72.409961],[-95.6854,-72.056641],[-96.978906,-72.221875],[-96.38335,-71.836328],[-97.345215,-72.189062],[-97.584766,-71.882617],[-98.167969,-72.123047],[-98.091113,-71.9125]]],[[[-120.55625,-73.756055],[-123.112158,-73.682227],[-122.859082,-74.342676],[-121.002441,-74.326367],[-120.55625,-73.756055]]],[[[-126.329883,-73.28623],[-127.267627,-73.304004],[-127.211621,-73.724414],[-123.937402,-74.256152],[-124.128516,-73.833984],[-125.798584,-73.801953],[-125.263965,-73.666406],[-126.329883,-73.28623]]],[[[-159.05293,-79.807422],[-159.963525,-79.324316],[-163.256104,-78.72207],[-164.225781,-79.320801],[-159.05293,-79.807422]]],[[[167.084082,-77.32168],[166.506348,-77.189355],[166.729004,-77.850977],[169.352734,-77.524707],[167.084082,-77.32168]]],[[[-31.118848,-79.798438],[-31.68042,-79.634277],[-31.594238,-79.887695],[-29.614453,-79.90957],[-30.779932,-79.647363],[-31.118848,-79.798438]]],[[[-33.93418,-79.32041],[-35.534668,-79.090039],[-36.565967,-79.208789],[-33.93418,-79.32041]]],[[[-70.334082,-79.679883],[-67.038135,-78.315723],[-71.454004,-79.128906],[-71.68667,-79.568066],[-70.334082,-79.679883]]],[[[-57.845996,-64.053906],[-57.925684,-63.806055],[-58.424951,-64.067773],[-58.214062,-64.369727],[-57.294678,-64.366992],[-57.479736,-63.961621],[-57.845996,-64.053906]]],[[[-55.528027,-63.173535],[-56.462842,-63.418066],[-55.075195,-63.324316],[-55.528027,-63.173535]]],[[[-57.978418,-61.911914],[-59.003711,-62.209766],[-57.639551,-62.02041],[-57.978418,-61.911914]]],[[[-63.180566,-64.469531],[-63.485596,-64.260547],[-64.27207,-64.697559],[-63.739502,-64.834277],[-62.836523,-64.571875],[-63.180566,-64.469531]]],[[[-62.325781,-64.424414],[-62.058496,-64.138086],[-62.451416,-64.012402],[-62.781787,-64.479004],[-62.325781,-64.424414]]],[[[-67.988477,-67.474414],[-67.830518,-66.624316],[-69.120361,-67.57793],[-68.58042,-67.732813],[-67.988477,-67.474414]]],[[[-73.706641,-70.635156],[-74.400977,-70.575879],[-74.589697,-70.791992],[-74.953613,-70.590234],[-76.421484,-71.09043],[-74.205029,-70.924121],[-73.706641,-70.635156]]],[[[-74.987109,-69.727832],[-75.80415,-70.038184],[-74.848828,-70.179297],[-74.437988,-69.949609],[-74.987109,-69.727832]]],[[[-74.354443,-73.098438],[-75.376855,-72.82041],[-76.096387,-73.150488],[-74.574658,-73.611328],[-74.354443,-73.098438]]],[[[-91.160693,-73.182227],[-90.76333,-72.681055],[-91.303516,-72.547363],[-91.160693,-73.182227]]],[[[167.642773,-78.141406],[166.111133,-78.089648],[166.121875,-78.274609],[167.642773,-78.141406]]],[[[100.981445,-65.677539],[101.220605,-65.472266],[100.545117,-65.408984],[100.292578,-65.65127],[100.981445,-65.677539]]],[[[26.857227,-70.381152],[26.301074,-70.072461],[26.005371,-70.372949],[26.857227,-70.381152]]],[[[-66.173633,-80.077832],[-65.579248,-79.770801],[-67.687939,-79.528418],[-66.173633,-80.077832]]],[[[-67.261914,-79.452637],[-68.032568,-79.227148],[-68.548926,-79.437402],[-67.261914,-79.452637]]],[[[-55.16543,-61.22041],[-54.670996,-61.116992],[-55.387012,-61.072656],[-55.16543,-61.22041]]],[[[-61.997607,-69.721875],[-61.815967,-69.376172],[-62.442139,-69.145996],[-61.997607,-69.721875]]],[[[-60.625,-62.560059],[-61.149805,-62.63418],[-59.849561,-62.614941],[-60.625,-62.560059]]],[[[96.612695,-66.03584],[96.307031,-66.18584],[96.933984,-66.200781],[96.612695,-66.03584]]],[[[16.222656,-70.007617],[16.573438,-69.723242],[15.596875,-69.828027],[16.222656,-70.007617]]],[[[3.036914,-70.597363],[3.072168,-70.381641],[2.584668,-70.53457],[3.036914,-70.597363]]],[[[-2.532812,-70.767773],[-3.574658,-70.703125],[-2.783496,-71.16748],[-2.092285,-70.820898],[-2.532812,-70.767773]]],[[[-20.607422,-73.886621],[-20.580225,-73.619238],[-22.035352,-74.106543],[-20.489014,-74.492676],[-20.607422,-73.886621]]],[[[-67.348926,-67.766211],[-67.246729,-67.59873],[-67.743262,-67.66123],[-67.348926,-67.766211]]],[[[-116.738623,-74.165039],[-116.381299,-73.865527],[-117.376465,-74.082813],[-116.738623,-74.165039]]],[[[-131.066699,-74.583789],[-130.981104,-74.414062],[-132.162646,-74.425781],[-131.066699,-74.583789]]],[[[-149.230664,-77.120508],[-149.870605,-76.875],[-150.788525,-76.981641],[-149.230664,-77.120508]]]]}},{type:"Feature",properties:{name:"荷属圣马丁",full_name:"荷属圣马丁岛",iso_a2:"SX",iso_a3:"SXM",iso_n3:"534"},geometry:{type:"Polygon",coordinates:[[[-63.123047,18.068945],[-63.023047,18.019189],[-63.011182,18.068945],[-63.123047,18.068945]]]}},{type:"Feature",properties:{name:"图瓦卢",full_name:"图瓦卢",iso_a2:"TV",iso_a3:"TUV",iso_n3:"798"},geometry:{type:"Polygon",coordinates:[[[179.213672,-8.524219],[179.203027,-8.466309],[179.195703,-8.534766],[179.213672,-8.524219]]]}}],GC={type:XM,features:HM},KM="modulepreload",YM=function(i){return"/I_Drive/"+i},y8={},JM=function(a,p,y){if(!p||p.length===0)return a();const T=document.getElementsByTagName("link");return Promise.all(p.map(P=>{if(P=YM(P),P in y8)return;y8[P]=!0;const F=P.endsWith(".css"),t=F?'[rel="stylesheet"]':"";if(!!y)for(let ye=T.length-1;ye>=0;ye--){const he=T[ye];if(he.href===P&&(!F||he.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${P}"]${t}`))return;const ie=document.createElement("link");if(ie.rel=F?"stylesheet":KM,F||(ie.as="script",ie.crossOrigin=""),ie.href=P,document.head.appendChild(ie),F)return new Promise((ye,he)=>{ie.addEventListener("load",ye),ie.addEventListener("error",()=>he(new Error(`Unable to preload CSS for ${P}`)))})})).then(()=>a()).catch(P=>{const F=new Event("vite:preloadError",{cancelable:!0});if(F.payload=P,window.dispatchEvent(F),!F.defaultPrevented)throw P})};var yv={exports:{}};(function(i,a){(function(p,y){i.exports=y()})(C8,function(){var p,y,T;function P(t,j){if(!p)p=j;else if(!y)y=j;else{var ie="var sharedChunk = {}; ("+p+")(sharedChunk); ("+y+")(sharedChunk);",ye={};p(ye),T=j(ye),typeof window<"u"&&(T.workerUrl=window.URL.createObjectURL(new Blob([ie],{type:"text/javascript"})))}}P(["exports"],function(t){var j=ie;function ie(c,s,h,v){this.cx=3*c,this.bx=3*(h-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(v-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=s,this.p2x=h,this.p2y=v}function ye(c,s,h,v){const M=new j(c,s,h,v);return function(k){return M.solve(k)}}ie.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,s){if(s===void 0&&(s=1e-6),c<0)return 0;if(c>1)return 1;for(var h=c,v=0;v<8;v++){var M=this.sampleCurveX(h)-c;if(Math.abs(M)<s)return h;var k=this.sampleCurveDerivativeX(h);if(Math.abs(k)<1e-6)break;h-=M/k}var L=0,V=1;for(h=c,v=0;v<20&&(M=this.sampleCurveX(h),!(Math.abs(M-c)<s));v++)c>M?L=h:V=h,h=.5*(V-L)+L;return h},solve:function(c,s){return this.sampleCurveY(this.solveCurveX(c,s))}};const he=ye(.25,.1,.25,1);function ne(c,s,h){return Math.min(h,Math.max(s,c))}function Ye(c,s,h){const v=h-s,M=((c-s)%v+v)%v+s;return M===s?h:M}function lt(c,...s){for(const h of s)for(const v in h)c[v]=h[v];return c}let at=1;function Kt(c,s){c.forEach(h=>{s[h]&&(s[h]=s[h].bind(s))})}function Ne(c,s,h){const v={};for(const M in c)v[M]=s.call(h||this,c[M],M,c);return v}function Le(c,s,h){const v={};for(const M in c)s.call(h||this,c[M],M,c)&&(v[M]=c[M]);return v}function je(c){return Array.isArray(c)?c.map(je):typeof c=="object"&&c?Ne(c,je):c}const _t={};function St(c){_t[c]||(typeof console<"u"&&console.warn(c),_t[c]=!0)}function ci(c,s,h){return(h.y-c.y)*(s.x-c.x)>(s.y-c.y)*(h.x-c.x)}function dt(c){let s=0;for(let h,v,M=0,k=c.length,L=k-1;M<k;L=M++)h=c[M],v=c[L],s+=(v.x-h.x)*(h.y+v.y);return s}function ri(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function zt(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,v,M,k)=>{const L=M||k;return s[v]=!L||L.toLowerCase(),""}),s["max-age"]){const h=parseInt(s["max-age"],10);isNaN(h)?delete s["max-age"]:s["max-age"]=h}return s}let Ci,yr,ki=null;function fr(c){if(ki==null){const s=c.navigator?c.navigator.userAgent:null;ki=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return ki}function Qt(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const $t={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(c){const s=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(c,s=0){const h=window.document.createElement("canvas"),v=h.getContext("2d");if(!v)throw new Error("failed to create canvas 2d context");return h.width=c.width,h.height=c.height,v.drawImage(c,0,0,c.width,c.height),v.getImageData(-s,-s,c.width+2*s,c.height+2*s)},resolveURL:c=>(Ci||(Ci=document.createElement("a")),Ci.href=c,Ci.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(yr==null&&(yr=matchMedia("(prefers-reduced-motion: reduce)")),yr.matches)}};var Mt=ui;function ui(c,s){this.x=c,this.y=s}ui.prototype={clone:function(){return new ui(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,s){return this.clone()._rotateAround(c,s)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var s=c.x-this.x,h=c.y-this.y;return s*s+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult:function(c){var s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var s=Math.cos(c),h=Math.sin(c),v=h*this.x+s*this.y;return this.x=s*this.x-h*this.y,this.y=v,this},_rotateAround:function(c,s){var h=Math.cos(c),v=Math.sin(c),M=s.y+v*(this.x-s.x)+h*(this.y-s.y);return this.x=s.x+h*(this.x-s.x)-v*(this.y-s.y),this.y=M,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ui.convert=function(c){return c instanceof ui?c:Array.isArray(c)?new ui(c[0],c[1]):c};const pt={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},hi="mapbox-tiles";let Si,Wi,lr=500,mr=50;function Vr(){typeof caches>"u"||Si||(Si=caches.open(hi))}let rn=1/0;const nn={supported:!1,testSupport:function(c){!eo&&mo&&(Rs?Ir(c):on=c)}};let on,mo,eo=!1,Rs=!1;function Ir(c){const s=c.createTexture();c.bindTexture(c.TEXTURE_2D,s);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,mo),c.isContextLost())return;nn.supported=!0}catch{}c.deleteTexture(s),eo=!0}typeof document<"u"&&(mo=document.createElement("img"),mo.onload=function(){on&&Ir(on),on=null,Rs=!0},mo.onerror=function(){eo=!0,on=null},mo.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const wn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(wn);class hn extends Error{constructor(s,h,v,M){super(`AJAXError: ${h} (${s}): ${v}`),this.status=s,this.statusText=h,this.url=v,this.body=M}}const $s=ri()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function sn(c,s){const h=new AbortController,v=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:$s(),signal:h.signal});let M=!1,k=!1;return c.type==="json"&&v.headers.set("Accept","application/json"),((L,V,Z)=>{if(k)return;const J=Date.now();fetch(v).then(se=>se.ok?((ue,xe,Te)=>{(c.type==="arrayBuffer"?ue.arrayBuffer():c.type==="json"?ue.json():ue.text()).then(Se=>{k||(xe&&Te&&function(Qe,Xe,Et){if(Vr(),!Si)return;const Gt={status:Xe.status,statusText:Xe.statusText,headers:new Headers};Xe.headers.forEach((Ut,ai)=>Gt.headers.set(ai,Ut));const wt=zt(Xe.headers.get("Cache-Control")||"");wt["no-store"]||(wt["max-age"]&&Gt.headers.set("Expires",new Date(Et+1e3*wt["max-age"]).toUTCString()),new Date(Gt.headers.get("Expires")).getTime()-Et<42e4||function(Ut,ai){if(Wi===void 0)try{new Response(new ReadableStream),Wi=!0}catch{Wi=!1}Wi?ai(Ut.body):Ut.blob().then(ai)}(Xe,Ut=>{const ai=new Response(Ut,Gt);Vr(),Si&&Si.then(li=>li.put(function(Hi){const tr=Hi.indexOf("?");return tr<0?Hi:Hi.slice(0,tr)}(Qe.url),ai)).catch(li=>St(li.message))}))}(v,xe,Te),M=!0,s(null,Se,ue.headers.get("Cache-Control"),ue.headers.get("Expires")))}).catch(Se=>{k||s(new Error(Se.message))})})(se,null,J):se.blob().then(ue=>s(new hn(se.status,se.statusText,c.url,ue)))).catch(se=>{se.code!==20&&s(new Error(se.message))})})(),{cancel:()=>{k=!0,M||h.abort()}}}const Vn=function(c,s){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){if(ri()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s);if(!ri()){const v=c.url.substring(0,c.url.indexOf("://"));return(pt.REGISTERED_PROTOCOLS[v]||sn)(c,s)}}if(!(/^file:/.test(h=c.url)||/^file:/.test($s())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return sn(c,s);if(ri()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s,void 0,!0)}var h;return function(v,M){const k=new XMLHttpRequest;k.open(v.method||"GET",v.url,!0),v.type==="arrayBuffer"&&(k.responseType="arraybuffer");for(const L in v.headers)k.setRequestHeader(L,v.headers[L]);return v.type==="json"&&(k.responseType="text",k.setRequestHeader("Accept","application/json")),k.withCredentials=v.credentials==="include",k.onerror=()=>{M(new Error(k.statusText))},k.onload=()=>{if((k.status>=200&&k.status<300||k.status===0)&&k.response!==null){let L=k.response;if(v.type==="json")try{L=JSON.parse(k.response)}catch(V){return M(V)}M(null,L,k.getResponseHeader("Cache-Control"),k.getResponseHeader("Expires"))}else{const L=new Blob([k.response],{type:k.getResponseHeader("Content-Type")});M(new hn(k.status,k.statusText,v.url,L))}},k.send(v.body),{cancel:()=>k.abort()}}(c,s)},ra=function(c,s){return Vn(lt(c,{type:"arrayBuffer"}),s)};function ns(c){const s=window.document.createElement("a");return s.href=c,s.protocol===window.document.location.protocol&&s.host===window.document.location.host}const xr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Wo,os;Wo=[],os=0;const gs=function(c,s){if(nn.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),os>=pt.MAX_PARALLEL_IMAGE_REQUESTS){const k={requestParameters:c,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return Wo.push(k),k}os++;let h=!1;const v=()=>{if(!h)for(h=!0,os--;Wo.length&&os<pt.MAX_PARALLEL_IMAGE_REQUESTS;){const k=Wo.shift(),{requestParameters:L,callback:V,cancelled:Z}=k;Z||(k.cancel=gs(L,V).cancel)}},M=ra(c,(k,L,V,Z)=>{v(),k?s(k):L&&function(J,se){typeof createImageBitmap=="function"?function(ue,xe){const Te=new Blob([new Uint8Array(ue)],{type:"image/png"});createImageBitmap(Te).then(Se=>{xe(null,Se)}).catch(Se=>{xe(new Error(`Could not load image because of ${Se.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(J,se):function(ue,xe){const Te=new Image;Te.onload=()=>{xe(null,Te),URL.revokeObjectURL(Te.src),Te.onload=null,window.requestAnimationFrame(()=>{Te.src=xr})},Te.onerror=()=>xe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Se=new Blob([new Uint8Array(ue)],{type:"image/png"});Te.src=ue.byteLength?URL.createObjectURL(Se):xr}(J,se)}(L,(J,se)=>{J!=null?s(J):se!=null&&s(null,se,{cacheControl:V,expires:Z})})});return{cancel:()=>{M.cancel(),v()}}};function ys(c,s,h){h[c]&&h[c].indexOf(s)!==-1||(h[c]=h[c]||[],h[c].push(s))}function to(c,s,h){if(h&&h[c]){const v=h[c].indexOf(s);v!==-1&&h[c].splice(v,1)}}class Eo{constructor(s,h={}){lt(this,h),this.type=s}}class Zs extends Eo{constructor(s,h={}){super("error",lt({error:s},h))}}class qn{on(s,h){return this._listeners=this._listeners||{},ys(s,h,this._listeners),this}off(s,h){return to(s,h,this._listeners),to(s,h,this._oneTimeListeners),this}once(s,h){return this._oneTimeListeners=this._oneTimeListeners||{},ys(s,h,this._oneTimeListeners),this}fire(s,h){typeof s=="string"&&(s=new Eo(s,h||{}));const v=s.type;if(this.listens(v)){s.target=this;const M=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const V of M)V.call(this,s);const k=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const V of k)to(v,V,this._oneTimeListeners),V.call(this,s);const L=this._eventedParent;L&&(lt(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),L.fire(s))}else s instanceof Zs&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,h){return this._eventedParent=s,this._eventedParentData=h,this}}var qt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Mi{constructor(s,h,v,M){this.message=(s?`${s}: `:"")+v,M&&(this.identifier=M),h!=null&&h.__line__&&(this.line=h.__line__)}}function Xo(c){const s=c.value;return s?[new Mi(c.key,s,"constants have been deprecated as of v8")]:[]}function so(c,...s){for(const h of s)for(const v in h)c[v]=h[v];return c}function Gr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function zn(c){if(Array.isArray(c))return c.map(zn);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const h in c)s[h]=zn(c[h]);return s}return Gr(c)}class Hn extends Error{constructor(s,h){super(h),this.message=h,this.key=s}}class io{constructor(s,h=[]){this.parent=s,this.bindings={};for(const[v,M]of h)this.bindings[v]=M}concat(s){return new io(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Ao={kind:"null"},Ii={kind:"number"},Tr={kind:"string"},De={kind:"boolean"},de={kind:"color"},_e={kind:"object"},Ae={kind:"value"},Je={kind:"collator"},ot={kind:"formatted"},Tt={kind:"padding"},mt={kind:"resolvedImage"};function st(c,s){return{kind:"array",itemType:c,N:s}}function xt(c){if(c.kind==="array"){const s=xt(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const gi=[Ao,Ii,Tr,De,de,ot,_e,st(Ae),Tt,mt];function wi(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!wi(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const h of gi)if(!wi(h,s))return null}}return`Expected ${xt(c)} but found ${xt(s)} instead.`}function Pe(c,s){return s.some(h=>h.kind===c.kind)}function ct(c,s){return s.some(h=>h==="null"?c===null:h==="array"?Array.isArray(c):h==="object"?c&&!Array.isArray(c)&&typeof c=="object":h===typeof c)}var bt,jt={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function pe(c){return(c=Math.round(c))<0?0:c>255?255:c}function Y(c){return pe(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function re(c){return(s=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:s>1?1:s;var s}function fe(c,s,h){return h<0?h+=1:h>1&&(h-=1),6*h<1?c+(s-c)*h*6:2*h<1?s:3*h<2?c+(s-c)*(2/3-h)*6:c}try{bt={}.parseCSSColor=function(c){var s,h=c.replace(/ /g,"").toLowerCase();if(h in jt)return jt[h].slice();if(h[0]==="#")return h.length===4?(s=parseInt(h.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:h.length===7&&(s=parseInt(h.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var v=h.indexOf("("),M=h.indexOf(")");if(v!==-1&&M+1===h.length){var k=h.substr(0,v),L=h.substr(v+1,M-(v+1)).split(","),V=1;switch(k){case"rgba":if(L.length!==4)return null;V=re(L.pop());case"rgb":return L.length!==3?null:[Y(L[0]),Y(L[1]),Y(L[2]),V];case"hsla":if(L.length!==4)return null;V=re(L.pop());case"hsl":if(L.length!==3)return null;var Z=(parseFloat(L[0])%360+360)%360/360,J=re(L[1]),se=re(L[2]),ue=se<=.5?se*(J+1):se+J-se*J,xe=2*se-ue;return[pe(255*fe(xe,ue,Z+1/3)),pe(255*fe(xe,ue,Z)),pe(255*fe(xe,ue,Z-1/3)),V];default:return null}}return null}}catch{}class ge{constructor(s,h,v,M=1){this.r=s,this.g=h,this.b=v,this.a=M}static parse(s){if(!s)return;if(s instanceof ge)return s;if(typeof s!="string")return;const h=bt(s);return h?new ge(h[0]/255*h[3],h[1]/255*h[3],h[2]/255*h[3],h[3]):void 0}toString(){const[s,h,v,M]=this.toArray();return`rgba(${Math.round(s)},${Math.round(h)},${Math.round(v)},${M})`}toArray(){const{r:s,g:h,b:v,a:M}=this;return M===0?[0,0,0,0]:[255*s/M,255*h/M,255*v/M,M]}}ge.black=new ge(0,0,0,1),ge.white=new ge(1,1,1,1),ge.transparent=new ge(0,0,0,0),ge.red=new ge(1,0,0,1);class ke{constructor(s,h,v){this.sensitivity=s?h?"variant":"case":h?"accent":"base",this.locale=v,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,h){return this.collator.compare(s,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ze{constructor(s,h,v,M,k){this.text=s,this.image=h,this.scale=v,this.fontStack=M,this.textColor=k}}class $e{constructor(s){this.sections=s}static fromString(s){return new $e([new Ze(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof $e?s:$e.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}}class Ve{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof Ve)return s;if(typeof s=="number")return new Ve([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const h of s)if(typeof h!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new Ve(s)}}toString(){return JSON.stringify(this.values)}}class ut{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new ut({name:s,available:!1}):null}}function Dt(c,s,h,v){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof h=="number"&&h>=0&&h<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:`Invalid rgba value [${[c,s,h,v].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof v=="number"?[c,s,h,v]:[c,s,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ht(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof ge||c instanceof ke||c instanceof $e||c instanceof Ve||c instanceof ut)return!0;if(Array.isArray(c)){for(const s of c)if(!Ht(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!Ht(c[s]))return!1;return!0}return!1}function ft(c){if(c===null)return Ao;if(typeof c=="string")return Tr;if(typeof c=="boolean")return De;if(typeof c=="number")return Ii;if(c instanceof ge)return de;if(c instanceof ke)return Je;if(c instanceof $e)return ot;if(c instanceof Ve)return Tt;if(c instanceof ut)return mt;if(Array.isArray(c)){const s=c.length;let h;for(const v of c){const M=ft(v);if(h){if(h===M)continue;h=Ae;break}h=M}return st(h||Ae,s)}return _e}function ji(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof ge||c instanceof $e||c instanceof Ve||c instanceof ut?c.toString():JSON.stringify(c)}class Zi{constructor(s,h){this.type=s,this.value=h}static parse(s,h){if(s.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Ht(s[1]))return h.error("invalid value");const v=s[1];let M=ft(v);const k=h.expectedType;return M.kind!=="array"||M.N!==0||!k||k.kind!=="array"||typeof k.N=="number"&&k.N!==0||(M=k),new Zi(M,v)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ai{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Yi={string:Tr,number:Ii,boolean:De,object:_e};class rr{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");let v,M=1;const k=s[0];if(k==="array"){let V,Z;if(s.length>2){const J=s[1];if(typeof J!="string"||!(J in Yi)||J==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);V=Yi[J],M++}else V=Ae;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return h.error('The length argument to "array" must be a positive integer literal',2);Z=s[2],M++}v=st(V,Z)}else{if(!Yi[k])throw new Error(`Types doesn't contain name = ${k}`);v=Yi[k]}const L=[];for(;M<s.length;M++){const V=h.parse(s[M],M,Ae);if(!V)return null;L.push(V)}return new rr(v,L)}evaluate(s){for(let h=0;h<this.args.length;h++){const v=this.args[h].evaluate(s);if(!wi(this.type,ft(v)))return v;if(h===this.args.length-1)throw new Ai(`Expected value to be of type ${xt(this.type)}, but found ${xt(ft(v))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const br={"to-boolean":De,"to-color":de,"to-number":Ii,"to-string":Tr};class hr{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");const v=s[0];if(!br[v])throw new Error(`Can't parse ${v} as it is not part of the known types`);if((v==="to-boolean"||v==="to-string")&&s.length!==2)return h.error("Expected one argument.");const M=br[v],k=[];for(let L=1;L<s.length;L++){const V=h.parse(s[L],L,Ae);if(!V)return null;k.push(V)}return new hr(M,k)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let h,v;for(const M of this.args){if(h=M.evaluate(s),v=null,h instanceof ge)return h;if(typeof h=="string"){const k=s.parseColor(h);if(k)return k}else if(Array.isArray(h)&&(v=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Dt(h[0],h[1],h[2],h[3]),!v))return new ge(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Ai(v||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}if(this.type.kind==="padding"){let h;for(const v of this.args){h=v.evaluate(s);const M=Ve.parse(h);if(M)return M}throw new Ai(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}if(this.type.kind==="number"){let h=null;for(const v of this.args){if(h=v.evaluate(s),h===null)return 0;const M=Number(h);if(!isNaN(M))return M}throw new Ai(`Could not convert ${JSON.stringify(h)} to number.`)}return this.type.kind==="formatted"?$e.fromString(ji(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?ut.fromString(ji(this.args[0].evaluate(s))):ji(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const wr=["Unknown","Point","LineString","Polygon"];class Mr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?wr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let h=this._parseColorCache[s];return h||(h=this._parseColorCache[s]=ge.parse(s)),h}}class Qi{constructor(s,h,v,M){this.name=s,this.type=h,this._evaluate=v,this.args=M}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,h){const v=s[0],M=Qi.definitions[v];if(!M)return h.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(M)?M[0]:M.type,L=Array.isArray(M)?[[M[1],M[2]]]:M.overloads,V=L.filter(([J])=>!Array.isArray(J)||J.length===s.length-1);let Z=null;for(const[J,se]of V){Z=new bs(h.registry,h.path,null,h.scope);const ue=[];let xe=!1;for(let Te=1;Te<s.length;Te++){const Se=s[Te],Qe=Array.isArray(J)?J[Te-1]:J.type,Xe=Z.parse(Se,1+ue.length,Qe);if(!Xe){xe=!0;break}ue.push(Xe)}if(!xe)if(Array.isArray(J)&&J.length!==ue.length)Z.error(`Expected ${J.length} arguments, but found ${ue.length} instead.`);else{for(let Te=0;Te<ue.length;Te++){const Se=Array.isArray(J)?J[Te]:J.type,Qe=ue[Te];Z.concat(Te+1).checkSubtype(Se,Qe.type)}if(Z.errors.length===0)return new Qi(v,k,se,ue)}}if(V.length===1)h.errors.push(...Z.errors);else{const J=(V.length?V:L).map(([ue])=>{return xe=ue,Array.isArray(xe)?`(${xe.map(xt).join(", ")})`:`(${xt(xe.type)}...)`;var xe}).join(" | "),se=[];for(let ue=1;ue<s.length;ue++){const xe=h.parse(s[ue],1+se.length);if(!xe)return null;se.push(xt(xe.type))}h.error(`Expected arguments of type ${J}, but found (${se.join(", ")}) instead.`)}return null}static register(s,h){Qi.definitions=h;for(const v in h)s[v]=Qi}}class Pr{constructor(s,h,v){this.type=Je,this.locale=v,this.caseSensitive=s,this.diacriticSensitive=h}static parse(s,h){if(s.length!==2)return h.error("Expected one argument.");const v=s[1];if(typeof v!="object"||Array.isArray(v))return h.error("Collator options argument must be an object.");const M=h.parse(v["case-sensitive"]!==void 0&&v["case-sensitive"],1,De);if(!M)return null;const k=h.parse(v["diacritic-sensitive"]!==void 0&&v["diacritic-sensitive"],1,De);if(!k)return null;let L=null;return v.locale&&(L=h.parse(v.locale,1,Tr),!L)?null:new Pr(M,k,L)}evaluate(s){return new ke(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}const It=8192;function Tn(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function Cr(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function En(c,s){const h=(180+c[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,M=Math.pow(2,s.z);return[Math.round(h*M*It),Math.round(v*M*It)]}function ln(c,s,h){const v=c[0]-s[0],M=c[1]-s[1],k=c[0]-h[0],L=c[1]-h[1];return v*L-k*M==0&&v*k<=0&&M*L<=0}function xs(c,s){let h=!1;for(let L=0,V=s.length;L<V;L++){const Z=s[L];for(let J=0,se=Z.length;J<se-1;J++){if(ln(c,Z[J],Z[J+1]))return!1;(M=Z[J])[1]>(v=c)[1]!=(k=Z[J+1])[1]>v[1]&&v[0]<(k[0]-M[0])*(v[1]-M[1])/(k[1]-M[1])+M[0]&&(h=!h)}}var v,M,k;return h}function eu(c,s){for(let h=0;h<s.length;h++)if(xs(c,s[h]))return!0;return!1}function Eh(c,s,h,v){const M=v[0]-h[0],k=v[1]-h[1],L=(c[0]-h[0])*k-M*(c[1]-h[1]),V=(s[0]-h[0])*k-M*(s[1]-h[1]);return L>0&&V<0||L<0&&V>0}function $l(c,s,h){for(const J of h)for(let se=0;se<J.length-1;++se)if((V=[(L=J[se+1])[0]-(k=J[se])[0],L[1]-k[1]])[0]*(Z=[(M=s)[0]-(v=c)[0],M[1]-v[1]])[1]-V[1]*Z[0]!=0&&Eh(v,M,k,L)&&Eh(k,L,v,M))return!0;var v,M,k,L,V,Z;return!1}function Di(c,s){for(let h=0;h<c.length;++h)if(!xs(c[h],s))return!1;for(let h=0;h<c.length-1;++h)if($l(c[h],c[h+1],s))return!1;return!0}function $r(c,s){for(let h=0;h<s.length;h++)if(Di(c,s[h]))return!0;return!1}function Ar(c,s,h){const v=[];for(let M=0;M<c.length;M++){const k=[];for(let L=0;L<c[M].length;L++){const V=En(c[M][L],h);Tn(s,V),k.push(V)}v.push(k)}return v}function ss(c,s,h){const v=[];for(let M=0;M<c.length;M++){const k=Ar(c[M],s,h);v.push(k)}return v}function qs(c,s,h,v){if(c[0]<h[0]||c[0]>h[2]){const M=.5*v;let k=c[0]-h[0]>M?-v:h[0]-c[0]>M?v:0;k===0&&(k=c[0]-h[2]>M?-v:h[2]-c[0]>M?v:0),c[0]+=k}Tn(s,c)}function Br(c,s,h,v){const M=Math.pow(2,v.z)*It,k=[v.x*It,v.y*It],L=[];for(const V of c)for(const Z of V){const J=[Z.x+k[0],Z.y+k[1]];qs(J,s,h,M),L.push(J)}return L}function vs(c,s,h,v){const M=Math.pow(2,v.z)*It,k=[v.x*It,v.y*It],L=[];for(const Z of c){const J=[];for(const se of Z){const ue=[se.x+k[0],se.y+k[1]];Tn(s,ue),J.push(ue)}L.push(J)}if(s[2]-s[0]<=M/2){(V=s)[0]=V[1]=1/0,V[2]=V[3]=-1/0;for(const Z of L)for(const J of Z)qs(J,s,h,M)}var V;return L}class na{constructor(s,h){this.type=De,this.geojson=s,this.geometries=h}static parse(s,h){if(s.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Ht(s[1])){const v=s[1];if(v.type==="FeatureCollection")for(let M=0;M<v.features.length;++M){const k=v.features[M].geometry.type;if(k==="Polygon"||k==="MultiPolygon")return new na(v,v.features[M].geometry)}else if(v.type==="Feature"){const M=v.geometry.type;if(M==="Polygon"||M==="MultiPolygon")return new na(v,v.geometry)}else if(v.type==="Polygon"||v.type==="MultiPolygon")return new na(v,v)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(h,v){const M=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],L=h.canonicalID();if(v.type==="Polygon"){const V=Ar(v.coordinates,k,L),Z=Br(h.geometry(),M,k,L);if(!Cr(M,k))return!1;for(const J of Z)if(!xs(J,V))return!1}if(v.type==="MultiPolygon"){const V=ss(v.coordinates,k,L),Z=Br(h.geometry(),M,k,L);if(!Cr(M,k))return!1;for(const J of Z)if(!eu(J,V))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(h,v){const M=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],L=h.canonicalID();if(v.type==="Polygon"){const V=Ar(v.coordinates,k,L),Z=vs(h.geometry(),M,k,L);if(!Cr(M,k))return!1;for(const J of Z)if(!Di(J,V))return!1}if(v.type==="MultiPolygon"){const V=ss(v.coordinates,k,L),Z=vs(h.geometry(),M,k,L);if(!Cr(M,k))return!1;for(const J of Z)if(!$r(J,V))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function oa(c){if(c instanceof Qi&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof na)return!1;let s=!0;return c.eachChild(h=>{s&&!oa(h)&&(s=!1)}),s}function Po(c){if(c instanceof Qi&&c.name==="feature-state")return!1;let s=!0;return c.eachChild(h=>{s&&!Po(h)&&(s=!1)}),s}function Sn(c,s){if(c instanceof Qi&&s.indexOf(c.name)>=0)return!1;let h=!0;return c.eachChild(v=>{h&&!Sn(v,s)&&(h=!1)}),h}class tu{constructor(s,h){this.type=h.type,this.name=s,this.boundExpression=h}static parse(s,h){if(s.length!==2||typeof s[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const v=s[1];return h.scope.has(v)?new tu(v,h.scope.get(v)):h.error(`Unknown variable "${v}". Make sure "${v}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class bs{constructor(s,h=[],v,M=new io,k=[]){this.registry=s,this.path=h,this.key=h.map(L=>`[${L}]`).join(""),this.scope=M,this.errors=k,this.expectedType=v}parse(s,h,v,M,k={}){return h?this.concat(h,v,M)._parse(s,k):this._parse(s,k)}_parse(s,h){function v(M,k,L){return L==="assert"?new rr(k,[M]):L==="coerce"?new hr(k,[M]):M}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const M=s[0];if(typeof M!="string")return this.error(`Expression name must be a string, but found ${typeof M} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[M];if(k){let L=k.parse(s,this);if(!L)return null;if(this.expectedType){const V=this.expectedType,Z=L.type;if(V.kind!=="string"&&V.kind!=="number"&&V.kind!=="boolean"&&V.kind!=="object"&&V.kind!=="array"||Z.kind!=="value")if(V.kind!=="color"&&V.kind!=="formatted"&&V.kind!=="resolvedImage"||Z.kind!=="value"&&Z.kind!=="string")if(V.kind!=="padding"||Z.kind!=="value"&&Z.kind!=="number"&&Z.kind!=="array"){if(this.checkSubtype(V,Z))return null}else L=v(L,V,h.typeAnnotation||"coerce");else L=v(L,V,h.typeAnnotation||"coerce");else L=v(L,V,h.typeAnnotation||"assert")}if(!(L instanceof Zi)&&L.type.kind!=="resolvedImage"&&Zl(L)){const V=new Mr;try{L=new Zi(L.type,L.evaluate(V))}catch(Z){return this.error(Z.message),null}}return L}return this.error(`Unknown expression "${M}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,h,v){const M=typeof s=="number"?this.path.concat(s):this.path,k=v?this.scope.concat(v):this.scope;return new bs(this.registry,M,h||null,k,this.errors)}error(s,...h){const v=`${this.key}${h.map(M=>`[${M}]`).join("")}`;this.errors.push(new Hn(v,s))}checkSubtype(s,h){const v=wi(s,h);return v&&this.error(v),v}}function Zl(c){if(c instanceof tu)return Zl(c.boundExpression);if(c instanceof Qi&&c.name==="error"||c instanceof Pr||c instanceof na)return!1;const s=c instanceof hr||c instanceof rr;let h=!0;return c.eachChild(v=>{h=s?h&&Zl(v):h&&v instanceof Zi}),!!h&&oa(c)&&Sn(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function cl(c,s){const h=c.length-1;let v,M,k=0,L=h,V=0;for(;k<=L;)if(V=Math.floor((k+L)/2),v=c[V],M=c[V+1],v<=s){if(V===h||s<M)return V;k=V+1}else{if(!(v>s))throw new Ai("Input is not a number.");L=V-1}return 0}class ql{constructor(s,h,v){this.type=s,this.input=h,this.labels=[],this.outputs=[];for(const[M,k]of v)this.labels.push(M),this.outputs.push(k)}static parse(s,h){if(s.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return h.error("Expected an even number of arguments.");const v=h.parse(s[1],1,Ii);if(!v)return null;const M=[];let k=null;h.expectedType&&h.expectedType.kind!=="value"&&(k=h.expectedType);for(let L=1;L<s.length;L+=2){const V=L===1?-1/0:s[L],Z=s[L+1],J=L,se=L+1;if(typeof V!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',J);if(M.length&&M[M.length-1][0]>=V)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',J);const ue=h.parse(Z,se,k);if(!ue)return null;k=k||ue.type,M.push([V,ue])}return new ql(k,v,M)}evaluate(s){const h=this.labels,v=this.outputs;if(h.length===1)return v[0].evaluate(s);const M=this.input.evaluate(s);if(M<=h[0])return v[0].evaluate(s);const k=h.length;return M>=h[k-1]?v[k-1].evaluate(s):v[cl(h,M)].evaluate(s)}eachChild(s){s(this.input);for(const h of this.outputs)s(h)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Bn(c,s,h){return c*(1-h)+s*h}var Na=Object.freeze({__proto__:null,number:Bn,color:function(c,s,h){return new ge(Bn(c.r,s.r,h),Bn(c.g,s.g,h),Bn(c.b,s.b,h),Bn(c.a,s.a,h))},array:function(c,s,h){return c.map((v,M)=>Bn(v,s[M],h))},padding:function(c,s,h){const v=c.values,M=s.values;return new Ve([Bn(v[0],M[0],h),Bn(v[1],M[1],h),Bn(v[2],M[2],h),Bn(v[3],M[3],h)])}});const Tc=.95047,iu=1.08883,ul=4/29,ko=6/29,Kn=3*ko*ko,Sh=Math.PI/180,Mh=180/Math.PI;function Ho(c){return c>.008856451679035631?Math.pow(c,1/3):c/Kn+ul}function ws(c){return c>ko?c*c*c:Kn*(c-ul)}function Ou(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Wl(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function _r(c){const s=Wl(c.r),h=Wl(c.g),v=Wl(c.b),M=Ho((.4124564*s+.3575761*h+.1804375*v)/Tc),k=Ho((.2126729*s+.7151522*h+.072175*v)/1);return{l:116*k-16,a:500*(M-k),b:200*(k-Ho((.0193339*s+.119192*h+.9503041*v)/iu)),alpha:c.a}}function Ec(c){let s=(c.l+16)/116,h=isNaN(c.a)?s:s+c.a/500,v=isNaN(c.b)?s:s-c.b/200;return s=1*ws(s),h=Tc*ws(h),v=iu*ws(v),new ge(Ou(3.2404542*h-1.5371385*s-.4985314*v),Ou(-.969266*h+1.8760108*s+.041556*v),Ou(.0556434*h-.2040259*s+1.0572252*v),c.alpha)}function Ch(c,s,h){const v=s-c;return c+h*(v>180||v<-180?v-360*Math.round(v/360):v)}const sa={forward:_r,reverse:Ec,interpolate:function(c,s,h){return{l:Bn(c.l,s.l,h),a:Bn(c.a,s.a,h),b:Bn(c.b,s.b,h),alpha:Bn(c.alpha,s.alpha,h)}}},ao={forward:function(c){const{l:s,a:h,b:v}=_r(c),M=Math.atan2(v,h)*Mh;return{h:M<0?M+360:M,c:Math.sqrt(h*h+v*v),l:s,alpha:c.a}},reverse:function(c){const s=c.h*Sh,h=c.c;return Ec({l:c.l,a:Math.cos(s)*h,b:Math.sin(s)*h,alpha:c.alpha})},interpolate:function(c,s,h){return{h:Ch(c.h,s.h,h),c:Bn(c.c,s.c,h),l:Bn(c.l,s.l,h),alpha:Bn(c.alpha,s.alpha,h)}}};var Uu=Object.freeze({__proto__:null,lab:sa,hcl:ao});class as{constructor(s,h,v,M,k){this.type=s,this.operator=h,this.interpolation=v,this.input=M,this.labels=[],this.outputs=[];for(const[L,V]of k)this.labels.push(L),this.outputs.push(V)}static interpolationFactor(s,h,v,M){let k=0;if(s.name==="exponential")k=aa(h,s.base,v,M);else if(s.name==="linear")k=aa(h,1,v,M);else if(s.name==="cubic-bezier"){const L=s.controlPoints;k=new j(L[0],L[1],L[2],L[3]).solve(aa(h,1,v,M))}return k}static parse(s,h){let[v,M,k,...L]=s;if(!Array.isArray(M)||M.length===0)return h.error("Expected an interpolation type expression.",1);if(M[0]==="linear")M={name:"linear"};else if(M[0]==="exponential"){const J=M[1];if(typeof J!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);M={name:"exponential",base:J}}else{if(M[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(M[0])}`,1,0);{const J=M.slice(1);if(J.length!==4||J.some(se=>typeof se!="number"||se<0||se>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);M={name:"cubic-bezier",controlPoints:J}}}if(s.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(k=h.parse(k,2,Ii),!k)return null;const V=[];let Z=null;v==="interpolate-hcl"||v==="interpolate-lab"?Z=de:h.expectedType&&h.expectedType.kind!=="value"&&(Z=h.expectedType);for(let J=0;J<L.length;J+=2){const se=L[J],ue=L[J+1],xe=J+3,Te=J+4;if(typeof se!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',xe);if(V.length&&V[V.length-1][0]>=se)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',xe);const Se=h.parse(ue,Te,Z);if(!Se)return null;Z=Z||Se.type,V.push([se,Se])}return Z.kind==="number"||Z.kind==="color"||Z.kind==="padding"||Z.kind==="array"&&Z.itemType.kind==="number"&&typeof Z.N=="number"?new as(Z,v,M,k,V):h.error(`Type ${xt(Z)} is not interpolatable.`)}evaluate(s){const h=this.labels,v=this.outputs;if(h.length===1)return v[0].evaluate(s);const M=this.input.evaluate(s);if(M<=h[0])return v[0].evaluate(s);const k=h.length;if(M>=h[k-1])return v[k-1].evaluate(s);const L=cl(h,M),V=as.interpolationFactor(this.interpolation,M,h[L],h[L+1]),Z=v[L].evaluate(s),J=v[L+1].evaluate(s);return this.operator==="interpolate"?Na[this.type.kind.toLowerCase()](Z,J,V):this.operator==="interpolate-hcl"?ao.reverse(ao.interpolate(ao.forward(Z),ao.forward(J),V)):sa.reverse(sa.interpolate(sa.forward(Z),sa.forward(J),V))}eachChild(s){s(this.input);for(const h of this.outputs)s(h)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function aa(c,s,h,v){const M=v-h,k=c-h;return M===0?0:s===1?k/M:(Math.pow(s,k)-1)/(Math.pow(s,M)-1)}class la{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expectected at least one argument.");let v=null;const M=h.expectedType;M&&M.kind!=="value"&&(v=M);const k=[];for(const V of s.slice(1)){const Z=h.parse(V,1+k.length,v,void 0,{typeAnnotation:"omit"});if(!Z)return null;v=v||Z.type,k.push(Z)}if(!v)throw new Error("No output type");const L=M&&k.some(V=>wi(M,V.type));return new la(L?Ae:v,k)}evaluate(s){let h,v=null,M=0;for(const k of this.args)if(M++,v=k.evaluate(s),v&&v instanceof ut&&!v.available&&(h||(h=v.name),v=null,M===this.args.length&&(v=h)),v!==null)break;return v}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}class Xl{constructor(s,h){this.type=h.type,this.bindings=[].concat(s),this.result=h}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const h of this.bindings)s(h[1]);s(this.result)}static parse(s,h){if(s.length<4)return h.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const v=[];for(let k=1;k<s.length-1;k+=2){const L=s[k];if(typeof L!="string")return h.error(`Expected string, but found ${typeof L} instead.`,k);if(/[^a-zA-Z0-9_]/.test(L))return h.error("Variable names must contain only alphanumeric characters or '_'.",k);const V=h.parse(s[k+1],k+1);if(!V)return null;v.push([L,V])}const M=h.parse(s[s.length-1],s.length-1,h.expectedType,v);return M?new Xl(v,M):null}outputDefined(){return this.result.outputDefined()}}class Ih{constructor(s,h,v){this.type=s,this.index=h,this.input=v}static parse(s,h){if(s.length!==3)return h.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const v=h.parse(s[1],1,Ii),M=h.parse(s[2],2,st(h.expectedType||Ae));return v&&M?new Ih(M.type.itemType,v,M):null}evaluate(s){const h=this.index.evaluate(s),v=this.input.evaluate(s);if(h<0)throw new Ai(`Array index out of bounds: ${h} < 0.`);if(h>=v.length)throw new Ai(`Array index out of bounds: ${h} > ${v.length-1}.`);if(h!==Math.floor(h))throw new Ai(`Array index must be an integer, but found ${h} instead.`);return v[h]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class ru{constructor(s,h){this.type=De,this.needle=s,this.haystack=h}static parse(s,h){if(s.length!==3)return h.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const v=h.parse(s[1],1,Ae),M=h.parse(s[2],2,Ae);return v&&M?Pe(v.type,[De,Tr,Ii,Ao,Ae])?new ru(v,M):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${xt(v.type)} instead`):null}evaluate(s){const h=this.needle.evaluate(s),v=this.haystack.evaluate(s);if(!v)return!1;if(!ct(h,["boolean","string","number","null"]))throw new Ai(`Expected first argument to be of type boolean, string, number or null, but found ${xt(ft(h))} instead.`);if(!ct(v,["string","array"]))throw new Ai(`Expected second argument to be of type array or string, but found ${xt(ft(v))} instead.`);return v.indexOf(h)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Va{constructor(s,h,v){this.type=Ii,this.needle=s,this.haystack=h,this.fromIndex=v}static parse(s,h){if(s.length<=2||s.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const v=h.parse(s[1],1,Ae),M=h.parse(s[2],2,Ae);if(!v||!M)return null;if(!Pe(v.type,[De,Tr,Ii,Ao,Ae]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${xt(v.type)} instead`);if(s.length===4){const k=h.parse(s[3],3,Ii);return k?new Va(v,M,k):null}return new Va(v,M)}evaluate(s){const h=this.needle.evaluate(s),v=this.haystack.evaluate(s);if(!ct(h,["boolean","string","number","null"]))throw new Ai(`Expected first argument to be of type boolean, string, number or null, but found ${xt(ft(h))} instead.`);if(!ct(v,["string","array"]))throw new Ai(`Expected second argument to be of type array or string, but found ${xt(ft(v))} instead.`);if(this.fromIndex){const M=this.fromIndex.evaluate(s);return v.indexOf(h,M)}return v.indexOf(h)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class Ws{constructor(s,h,v,M,k,L){this.inputType=s,this.type=h,this.input=v,this.cases=M,this.outputs=k,this.otherwise=L}static parse(s,h){if(s.length<5)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return h.error("Expected an even number of arguments.");let v,M;h.expectedType&&h.expectedType.kind!=="value"&&(M=h.expectedType);const k={},L=[];for(let J=2;J<s.length-1;J+=2){let se=s[J];const ue=s[J+1];Array.isArray(se)||(se=[se]);const xe=h.concat(J);if(se.length===0)return xe.error("Expected at least one branch label.");for(const Se of se){if(typeof Se!="number"&&typeof Se!="string")return xe.error("Branch labels must be numbers or strings.");if(typeof Se=="number"&&Math.abs(Se)>Number.MAX_SAFE_INTEGER)return xe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Se=="number"&&Math.floor(Se)!==Se)return xe.error("Numeric branch labels must be integer values.");if(v){if(xe.checkSubtype(v,ft(Se)))return null}else v=ft(Se);if(k[String(Se)]!==void 0)return xe.error("Branch labels must be unique.");k[String(Se)]=L.length}const Te=h.parse(ue,J,M);if(!Te)return null;M=M||Te.type,L.push(Te)}const V=h.parse(s[1],1,Ae);if(!V)return null;const Z=h.parse(s[s.length-1],s.length-1,M);return Z?V.type.kind!=="value"&&h.concat(1).checkSubtype(v,V.type)?null:new Ws(v,M,V,k,L,Z):null}evaluate(s){const h=this.input.evaluate(s);return(ft(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class nu{constructor(s,h,v){this.type=s,this.branches=h,this.otherwise=v}static parse(s,h){if(s.length<4)return h.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return h.error("Expected an odd number of arguments.");let v;h.expectedType&&h.expectedType.kind!=="value"&&(v=h.expectedType);const M=[];for(let L=1;L<s.length-1;L+=2){const V=h.parse(s[L],L,De);if(!V)return null;const Z=h.parse(s[L+1],L+1,v);if(!Z)return null;M.push([V,Z]),v=v||Z.type}const k=h.parse(s[s.length-1],s.length-1,v);if(!k)return null;if(!v)throw new Error("Can't infer output type");return new nu(v,M,k)}evaluate(s){for(const[h,v]of this.branches)if(h.evaluate(s))return v.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[h,v]of this.branches)s(h),s(v);s(this.otherwise)}outputDefined(){return this.branches.every(([s,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class ya{constructor(s,h,v,M){this.type=s,this.input=h,this.beginIndex=v,this.endIndex=M}static parse(s,h){if(s.length<=2||s.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const v=h.parse(s[1],1,Ae),M=h.parse(s[2],2,Ii);if(!v||!M)return null;if(!Pe(v.type,[st(Ae),Tr,Ae]))return h.error(`Expected first argument to be of type array or string, but found ${xt(v.type)} instead`);if(s.length===4){const k=h.parse(s[3],3,Ii);return k?new ya(v.type,v,M,k):null}return new ya(v.type,v,M)}evaluate(s){const h=this.input.evaluate(s),v=this.beginIndex.evaluate(s);if(!ct(h,["string","array"]))throw new Ai(`Expected first argument to be of type array or string, but found ${xt(ft(h))} instead.`);if(this.endIndex){const M=this.endIndex.evaluate(s);return h.slice(v,M)}return h.slice(v)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function xa(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function Sc(c,s,h,v){return v.compare(s,h)===0}function Ts(c,s,h){const v=c!=="=="&&c!=="!=";return class xv{constructor(k,L,V){this.type=De,this.lhs=k,this.rhs=L,this.collator=V,this.hasUntypedArgument=k.type.kind==="value"||L.type.kind==="value"}static parse(k,L){if(k.length!==3&&k.length!==4)return L.error("Expected two or three arguments.");const V=k[0];let Z=L.parse(k[1],1,Ae);if(!Z)return null;if(!xa(V,Z.type))return L.concat(1).error(`"${V}" comparisons are not supported for type '${xt(Z.type)}'.`);let J=L.parse(k[2],2,Ae);if(!J)return null;if(!xa(V,J.type))return L.concat(2).error(`"${V}" comparisons are not supported for type '${xt(J.type)}'.`);if(Z.type.kind!==J.type.kind&&Z.type.kind!=="value"&&J.type.kind!=="value")return L.error(`Cannot compare types '${xt(Z.type)}' and '${xt(J.type)}'.`);v&&(Z.type.kind==="value"&&J.type.kind!=="value"?Z=new rr(J.type,[Z]):Z.type.kind!=="value"&&J.type.kind==="value"&&(J=new rr(Z.type,[J])));let se=null;if(k.length===4){if(Z.type.kind!=="string"&&J.type.kind!=="string"&&Z.type.kind!=="value"&&J.type.kind!=="value")return L.error("Cannot use collator to compare non-string types.");if(se=L.parse(k[3],3,Je),!se)return null}return new xv(Z,J,se)}evaluate(k){const L=this.lhs.evaluate(k),V=this.rhs.evaluate(k);if(v&&this.hasUntypedArgument){const Z=ft(L),J=ft(V);if(Z.kind!==J.kind||Z.kind!=="string"&&Z.kind!=="number")throw new Ai(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${Z.kind}, ${J.kind}) instead.`)}if(this.collator&&!v&&this.hasUntypedArgument){const Z=ft(L),J=ft(V);if(Z.kind!=="string"||J.kind!=="string")return s(k,L,V)}return this.collator?h(k,L,V,this.collator.evaluate(k)):s(k,L,V)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const Nu=Ts("==",function(c,s,h){return s===h},Sc),Mc=Ts("!=",function(c,s,h){return s!==h},function(c,s,h,v){return!Sc(0,s,h,v)}),ou=Ts("<",function(c,s,h){return s<h},function(c,s,h,v){return v.compare(s,h)<0}),p1=Ts(">",function(c,s,h){return s>h},function(c,s,h,v){return v.compare(s,h)>0}),Vu=Ts("<=",function(c,s,h){return s<=h},function(c,s,h,v){return v.compare(s,h)<=0}),Ah=Ts(">=",function(c,s,h){return s>=h},function(c,s,h,v){return v.compare(s,h)>=0});class su{constructor(s,h,v,M,k){this.type=Tr,this.number=s,this.locale=h,this.currency=v,this.minFractionDigits=M,this.maxFractionDigits=k}static parse(s,h){if(s.length!==3)return h.error("Expected two arguments.");const v=h.parse(s[1],1,Ii);if(!v)return null;const M=s[2];if(typeof M!="object"||Array.isArray(M))return h.error("NumberFormat options argument must be an object.");let k=null;if(M.locale&&(k=h.parse(M.locale,1,Tr),!k))return null;let L=null;if(M.currency&&(L=h.parse(M.currency,1,Tr),!L))return null;let V=null;if(M["min-fraction-digits"]&&(V=h.parse(M["min-fraction-digits"],1,Ii),!V))return null;let Z=null;return M["max-fraction-digits"]&&(Z=h.parse(M["max-fraction-digits"],1,Ii),!Z)?null:new su(v,k,L,V,Z)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class ja{constructor(s){this.type=ot,this.sections=s}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");const v=s[1];if(!Array.isArray(v)&&typeof v=="object")return h.error("First argument must be an image or text section.");const M=[];let k=!1;for(let L=1;L<=s.length-1;++L){const V=s[L];if(k&&typeof V=="object"&&!Array.isArray(V)){k=!1;let Z=null;if(V["font-scale"]&&(Z=h.parse(V["font-scale"],1,Ii),!Z))return null;let J=null;if(V["text-font"]&&(J=h.parse(V["text-font"],1,st(Tr)),!J))return null;let se=null;if(V["text-color"]&&(se=h.parse(V["text-color"],1,de),!se))return null;const ue=M[M.length-1];ue.scale=Z,ue.font=J,ue.textColor=se}else{const Z=h.parse(s[L],1,Ae);if(!Z)return null;const J=Z.type.kind;if(J!=="string"&&J!=="value"&&J!=="null"&&J!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,M.push({content:Z,scale:null,font:null,textColor:null})}}return new ja(M)}evaluate(s){return new $e(this.sections.map(h=>{const v=h.content.evaluate(s);return ft(v)===mt?new Ze("",v,null,null,null):new Ze(ji(v),null,h.scale?h.scale.evaluate(s):null,h.font?h.font.evaluate(s).join(","):null,h.textColor?h.textColor.evaluate(s):null)}))}eachChild(s){for(const h of this.sections)s(h.content),h.scale&&s(h.scale),h.font&&s(h.font),h.textColor&&s(h.textColor)}outputDefined(){return!1}}class Qr{constructor(s){this.type=mt,this.input=s}static parse(s,h){if(s.length!==2)return h.error("Expected two arguments.");const v=h.parse(s[1],1,Tr);return v?new Qr(v):h.error("No image name provided.")}evaluate(s){const h=this.input.evaluate(s),v=ut.fromString(h);return v&&s.availableImages&&(v.available=s.availableImages.indexOf(h)>-1),v}eachChild(s){s(this.input)}outputDefined(){return!1}}class Ph{constructor(s){this.type=Ii,this.input=s}static parse(s,h){if(s.length!==2)return h.error(`Expected 1 argument, but found ${s.length-1} instead.`);const v=h.parse(s[1],1);return v?v.type.kind!=="array"&&v.type.kind!=="string"&&v.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${xt(v.type)} instead.`):new Ph(v):null}evaluate(s){const h=this.input.evaluate(s);if(typeof h=="string"||Array.isArray(h))return h.length;throw new Ai(`Expected value to be of type string or array, but found ${xt(ft(h))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const hl={"==":Nu,"!=":Mc,">":p1,"<":ou,">=":Ah,"<=":Vu,array:rr,at:Ih,boolean:rr,case:nu,coalesce:la,collator:Pr,format:ja,image:Qr,in:ru,"index-of":Va,interpolate:as,"interpolate-hcl":as,"interpolate-lab":as,length:Ph,let:Xl,literal:Zi,match:Ws,number:rr,"number-format":su,object:rr,slice:ya,step:ql,string:rr,"to-boolean":hr,"to-color":hr,"to-number":hr,"to-string":hr,var:tu,within:na};function kh(c,[s,h,v,M]){s=s.evaluate(c),h=h.evaluate(c),v=v.evaluate(c);const k=M?M.evaluate(c):1,L=Dt(s,h,v,k);if(L)throw new Ai(L);return new ge(s/255*k,h/255*k,v/255*k,k)}function ju(c,s){return c in s}function au(c,s){const h=s[c];return h===void 0?null:h}function Ga(c){return{type:c}}function Hl(c){return{result:"success",value:c}}function $a(c){return{result:"error",value:c}}function _n(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function va(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function kr(c){return!!c.expression&&c.expression.interpolated}function en(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function Pn(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Mn(c){return c}function Kl(c,s){const h=s.type==="color",v=c.stops&&typeof c.stops[0][0]=="object",M=v||!(v||c.property!==void 0),k=c.type||(kr(s)?"exponential":"interval");if(h||s.type==="padding"){const J=h?ge.parse:Ve.parse;(c=so({},c)).stops&&(c.stops=c.stops.map(se=>[se[0],J(se[1])])),c.default=J(c.default?c.default:s.default)}if(c.colorSpace&&c.colorSpace!=="rgb"&&!Uu[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let L,V,Z;if(k==="exponential")L=Zu;else if(k==="interval")L=$u;else if(k==="categorical"){L=Gu,V=Object.create(null);for(const J of c.stops)V[J[0]]=J[1];Z=typeof c.stops[0][0]}else{if(k!=="identity")throw new Error(`Unknown function type "${k}"`);L=Kr}if(v){const J={},se=[];for(let Te=0;Te<c.stops.length;Te++){const Se=c.stops[Te],Qe=Se[0].zoom;J[Qe]===void 0&&(J[Qe]={zoom:Qe,type:c.type,property:c.property,default:c.default,stops:[]},se.push(Qe)),J[Qe].stops.push([Se[0].value,Se[1]])}const ue=[];for(const Te of se)ue.push([J[Te].zoom,Kl(J[Te],s)]);const xe={name:"linear"};return{kind:"composite",interpolationType:xe,interpolationFactor:as.interpolationFactor.bind(void 0,xe),zoomStops:ue.map(Te=>Te[0]),evaluate:({zoom:Te},Se)=>Zu({stops:ue,base:c.base},s,Te).evaluate(Te,Se)}}if(M){const J=k==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:J,interpolationFactor:as.interpolationFactor.bind(void 0,J),zoomStops:c.stops.map(se=>se[0]),evaluate:({zoom:se})=>L(c,s,se,V,Z)}}return{kind:"source",evaluate(J,se){const ue=se&&se.properties?se.properties[c.property]:void 0;return ue===void 0?dl(c.default,s.default):L(c,s,ue,V,Z)}}}function dl(c,s,h){return c!==void 0?c:s!==void 0?s:h!==void 0?h:void 0}function Gu(c,s,h,v,M){return dl(typeof h===M?v[h]:void 0,c.default,s.default)}function $u(c,s,h){if(en(h)!=="number")return dl(c.default,s.default);const v=c.stops.length;if(v===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[v-1][0])return c.stops[v-1][1];const M=cl(c.stops.map(k=>k[0]),h);return c.stops[M][1]}function Zu(c,s,h){const v=c.base!==void 0?c.base:1;if(en(h)!=="number")return dl(c.default,s.default);const M=c.stops.length;if(M===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[M-1][0])return c.stops[M-1][1];const k=cl(c.stops.map(se=>se[0]),h),L=function(se,ue,xe,Te){const Se=Te-xe,Qe=se-xe;return Se===0?0:ue===1?Qe/Se:(Math.pow(ue,Qe)-1)/(Math.pow(ue,Se)-1)}(h,v,c.stops[k][0],c.stops[k+1][0]),V=c.stops[k][1],Z=c.stops[k+1][1];let J=Na[s.type]||Mn;if(c.colorSpace&&c.colorSpace!=="rgb"){const se=Uu[c.colorSpace];J=(ue,xe)=>se.reverse(se.interpolate(se.forward(ue),se.forward(xe),L))}return typeof V.evaluate=="function"?{evaluate(...se){const ue=V.evaluate.apply(void 0,se),xe=Z.evaluate.apply(void 0,se);if(ue!==void 0&&xe!==void 0)return J(ue,xe,L)}}:J(V,Z,L)}function Kr(c,s,h){switch(s.type){case"color":h=ge.parse(h);break;case"formatted":h=$e.fromString(h.toString());break;case"resolvedImage":h=ut.fromString(h.toString());break;case"padding":h=Ve.parse(h);break;default:en(h)===s.type||s.type==="enum"&&s.values[h]||(h=void 0)}return dl(h,c.default,s.default)}Qi.register(hl,{error:[{kind:"error"},[Tr],(c,[s])=>{throw new Ai(s.evaluate(c))}],typeof:[Tr,[Ae],(c,[s])=>xt(ft(s.evaluate(c)))],"to-rgba":[st(Ii,4),[de],(c,[s])=>s.evaluate(c).toArray()],rgb:[de,[Ii,Ii,Ii],kh],rgba:[de,[Ii,Ii,Ii,Ii],kh],has:{type:De,overloads:[[[Tr],(c,[s])=>ju(s.evaluate(c),c.properties())],[[Tr,_e],(c,[s,h])=>ju(s.evaluate(c),h.evaluate(c))]]},get:{type:Ae,overloads:[[[Tr],(c,[s])=>au(s.evaluate(c),c.properties())],[[Tr,_e],(c,[s,h])=>au(s.evaluate(c),h.evaluate(c))]]},"feature-state":[Ae,[Tr],(c,[s])=>au(s.evaluate(c),c.featureState||{})],properties:[_e,[],c=>c.properties()],"geometry-type":[Tr,[],c=>c.geometryType()],id:[Ae,[],c=>c.id()],zoom:[Ii,[],c=>c.globals.zoom],"heatmap-density":[Ii,[],c=>c.globals.heatmapDensity||0],"line-progress":[Ii,[],c=>c.globals.lineProgress||0],accumulated:[Ae,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[Ii,Ga(Ii),(c,s)=>{let h=0;for(const v of s)h+=v.evaluate(c);return h}],"*":[Ii,Ga(Ii),(c,s)=>{let h=1;for(const v of s)h*=v.evaluate(c);return h}],"-":{type:Ii,overloads:[[[Ii,Ii],(c,[s,h])=>s.evaluate(c)-h.evaluate(c)],[[Ii],(c,[s])=>-s.evaluate(c)]]},"/":[Ii,[Ii,Ii],(c,[s,h])=>s.evaluate(c)/h.evaluate(c)],"%":[Ii,[Ii,Ii],(c,[s,h])=>s.evaluate(c)%h.evaluate(c)],ln2:[Ii,[],()=>Math.LN2],pi:[Ii,[],()=>Math.PI],e:[Ii,[],()=>Math.E],"^":[Ii,[Ii,Ii],(c,[s,h])=>Math.pow(s.evaluate(c),h.evaluate(c))],sqrt:[Ii,[Ii],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[Ii,[Ii],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[Ii,[Ii],(c,[s])=>Math.log(s.evaluate(c))],log2:[Ii,[Ii],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[Ii,[Ii],(c,[s])=>Math.sin(s.evaluate(c))],cos:[Ii,[Ii],(c,[s])=>Math.cos(s.evaluate(c))],tan:[Ii,[Ii],(c,[s])=>Math.tan(s.evaluate(c))],asin:[Ii,[Ii],(c,[s])=>Math.asin(s.evaluate(c))],acos:[Ii,[Ii],(c,[s])=>Math.acos(s.evaluate(c))],atan:[Ii,[Ii],(c,[s])=>Math.atan(s.evaluate(c))],min:[Ii,Ga(Ii),(c,s)=>Math.min(...s.map(h=>h.evaluate(c)))],max:[Ii,Ga(Ii),(c,s)=>Math.max(...s.map(h=>h.evaluate(c)))],abs:[Ii,[Ii],(c,[s])=>Math.abs(s.evaluate(c))],round:[Ii,[Ii],(c,[s])=>{const h=s.evaluate(c);return h<0?-Math.round(-h):Math.round(h)}],floor:[Ii,[Ii],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[Ii,[Ii],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[De,[Tr,Ae],(c,[s,h])=>c.properties()[s.value]===h.value],"filter-id-==":[De,[Ae],(c,[s])=>c.id()===s.value],"filter-type-==":[De,[Tr],(c,[s])=>c.geometryType()===s.value],"filter-<":[De,[Tr,Ae],(c,[s,h])=>{const v=c.properties()[s.value],M=h.value;return typeof v==typeof M&&v<M}],"filter-id-<":[De,[Ae],(c,[s])=>{const h=c.id(),v=s.value;return typeof h==typeof v&&h<v}],"filter->":[De,[Tr,Ae],(c,[s,h])=>{const v=c.properties()[s.value],M=h.value;return typeof v==typeof M&&v>M}],"filter-id->":[De,[Ae],(c,[s])=>{const h=c.id(),v=s.value;return typeof h==typeof v&&h>v}],"filter-<=":[De,[Tr,Ae],(c,[s,h])=>{const v=c.properties()[s.value],M=h.value;return typeof v==typeof M&&v<=M}],"filter-id-<=":[De,[Ae],(c,[s])=>{const h=c.id(),v=s.value;return typeof h==typeof v&&h<=v}],"filter->=":[De,[Tr,Ae],(c,[s,h])=>{const v=c.properties()[s.value],M=h.value;return typeof v==typeof M&&v>=M}],"filter-id->=":[De,[Ae],(c,[s])=>{const h=c.id(),v=s.value;return typeof h==typeof v&&h>=v}],"filter-has":[De,[Ae],(c,[s])=>s.value in c.properties()],"filter-has-id":[De,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[De,[st(Tr)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[De,[st(Ae)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[De,[Tr,st(Ae)],(c,[s,h])=>h.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[De,[Tr,st(Ae)],(c,[s,h])=>function(v,M,k,L){for(;k<=L;){const V=k+L>>1;if(M[V]===v)return!0;M[V]>v?L=V-1:k=V+1}return!1}(c.properties()[s.value],h.value,0,h.value.length-1)],all:{type:De,overloads:[[[De,De],(c,[s,h])=>s.evaluate(c)&&h.evaluate(c)],[Ga(De),(c,s)=>{for(const h of s)if(!h.evaluate(c))return!1;return!0}]]},any:{type:De,overloads:[[[De,De],(c,[s,h])=>s.evaluate(c)||h.evaluate(c)],[Ga(De),(c,s)=>{for(const h of s)if(h.evaluate(c))return!0;return!1}]]},"!":[De,[De],(c,[s])=>!s.evaluate(c)],"is-supported-script":[De,[Tr],(c,[s])=>{const h=c.globals&&c.globals.isSupportedScript;return!h||h(s.evaluate(c))}],upcase:[Tr,[Tr],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[Tr,[Tr],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[Tr,Ga(Ae),(c,s)=>s.map(h=>ji(h.evaluate(c))).join("")],"resolved-locale":[Tr,[Je],(c,[s])=>s.evaluate(c).resolvedLocale()]});class pl{constructor(s,h){this.expression=s,this._warningHistory={},this._evaluator=new Mr,this._defaultValue=h?function(v){return v.type==="color"&&Pn(v.default)?new ge(0,0,0,0):v.type==="color"?ge.parse(v.default)||null:v.type==="padding"?Ve.parse(v.default)||null:v.default===void 0?null:v.default}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(s,h,v,M,k,L){return this._evaluator.globals=s,this._evaluator.feature=h,this._evaluator.featureState=v,this._evaluator.canonical=M,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=L,this.expression.evaluate(this._evaluator)}evaluate(s,h,v,M,k,L){this._evaluator.globals=s,this._evaluator.feature=h||null,this._evaluator.featureState=v||null,this._evaluator.canonical=M,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=L||null;try{const V=this.expression.evaluate(this._evaluator);if(V==null||typeof V=="number"&&V!=V)return this._defaultValue;if(this._enumValues&&!(V in this._enumValues))throw new Ai(`Expected value to be one of ${Object.keys(this._enumValues).map(Z=>JSON.stringify(Z)).join(", ")}, but found ${JSON.stringify(V)} instead.`);return V}catch(V){return this._warningHistory[V.message]||(this._warningHistory[V.message]=!0,typeof console<"u"&&console.warn(V.message)),this._defaultValue}}}function Cc(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in hl}function Yl(c,s){const h=new bs(hl,[],s?function(M){const k={color:de,string:Tr,number:Ii,enum:Tr,boolean:De,formatted:ot,padding:Tt,resolvedImage:mt};return M.type==="array"?st(k[M.value]||Ae,M.length):k[M.type]}(s):void 0),v=h.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?Hl(new pl(v,s)):$a(h.errors)}class Ic{constructor(s,h){this.kind=s,this._styleExpression=h,this.isStateDependent=s!=="constant"&&!Po(h.expression)}evaluateWithoutErrorHandling(s,h,v,M,k,L){return this._styleExpression.evaluateWithoutErrorHandling(s,h,v,M,k,L)}evaluate(s,h,v,M,k,L){return this._styleExpression.evaluate(s,h,v,M,k,L)}}class Za{constructor(s,h,v,M){this.kind=s,this.zoomStops=v,this._styleExpression=h,this.isStateDependent=s!=="camera"&&!Po(h.expression),this.interpolationType=M}evaluateWithoutErrorHandling(s,h,v,M,k,L){return this._styleExpression.evaluateWithoutErrorHandling(s,h,v,M,k,L)}evaluate(s,h,v,M,k,L){return this._styleExpression.evaluate(s,h,v,M,k,L)}interpolationFactor(s,h,v){return this.interpolationType?as.interpolationFactor(this.interpolationType,s,h,v):0}}function qu(c,s){const h=Yl(c,s);if(h.result==="error")return h;const v=h.value.expression,M=oa(v);if(!M&&!_n(s))return $a([new Hn("","data expressions not supported")]);const k=Sn(v,["zoom"]);if(!k&&!va(s))return $a([new Hn("","zoom expressions not supported")]);const L=Xu(v);return L||k?L instanceof Hn?$a([L]):L instanceof as&&!kr(s)?$a([new Hn("",'"interpolate" expressions cannot be used with this property')]):Hl(L?new Za(M?"camera":"composite",h.value,L.labels,L instanceof as?L.interpolation:void 0):new Ic(M?"constant":"source",h.value)):$a([new Hn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wu{constructor(s,h){this._parameters=s,this._specification=h,so(this,Kl(this._parameters,this._specification))}static deserialize(s){return new Wu(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Xu(c){let s=null;if(c instanceof Xl)s=Xu(c.result);else if(c instanceof la){for(const h of c.args)if(s=Xu(h),s)break}else(c instanceof ql||c instanceof as)&&c.input instanceof Qi&&c.input.name==="zoom"&&(s=c);return s instanceof Hn||c.eachChild(h=>{const v=Xu(h);v instanceof Hn?s=v:!s&&v?s=new Hn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&v&&s!==v&&(s=new Hn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function ca(c){const s=c.key,h=c.value,v=c.valueSpec||{},M=c.objectElementValidators||{},k=c.style,L=c.styleSpec;let V=[];const Z=en(h);if(Z!=="object")return[new Mi(s,h,`object expected, ${Z} found`)];for(const J in h){const se=J.split(".")[0],ue=v[se]||v["*"];let xe;if(M[se])xe=M[se];else if(v[se])xe=zo;else if(M["*"])xe=M["*"];else{if(!v["*"]){V.push(new Mi(s,h[J],`unknown property "${J}"`));continue}xe=zo}V=V.concat(xe({key:(s&&`${s}.`)+J,value:h[J],valueSpec:ue,style:k,styleSpec:L,object:h,objectKey:J},h))}for(const J in v)M[J]||v[J].required&&v[J].default===void 0&&h[J]===void 0&&V.push(new Mi(s,h,`missing required property "${J}"`));return V}function Hu(c){const s=c.value,h=c.valueSpec,v=c.style,M=c.styleSpec,k=c.key,L=c.arrayElementValidator||zo;if(en(s)!=="array")return[new Mi(k,s,`array expected, ${en(s)} found`)];if(h.length&&s.length!==h.length)return[new Mi(k,s,`array length ${h.length} expected, length ${s.length} found`)];if(h["min-length"]&&s.length<h["min-length"])return[new Mi(k,s,`array length at least ${h["min-length"]} expected, length ${s.length} found`)];let V={type:h.value,values:h.values};M.$version<7&&(V.function=h.function),en(h.value)==="object"&&(V=h.value);let Z=[];for(let J=0;J<s.length;J++)Z=Z.concat(L({array:s,arrayIndex:J,value:s[J],valueSpec:V,style:v,styleSpec:M,key:`${k}[${J}]`}));return Z}function lu(c){const s=c.key,h=c.value,v=c.valueSpec;let M=en(h);return M==="number"&&h!=h&&(M="NaN"),M!=="number"?[new Mi(s,h,`number expected, ${M} found`)]:"minimum"in v&&h<v.minimum?[new Mi(s,h,`${h} is less than the minimum value ${v.minimum}`)]:"maximum"in v&&h>v.maximum?[new Mi(s,h,`${h} is greater than the maximum value ${v.maximum}`)]:[]}function Ku(c){const s=c.valueSpec,h=Gr(c.value.type);let v,M,k,L={};const V=h!=="categorical"&&c.value.property===void 0,Z=!V,J=en(c.value.stops)==="array"&&en(c.value.stops[0])==="array"&&en(c.value.stops[0][0])==="object",se=ca({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Te){if(h==="identity")return[new Mi(Te.key,Te.value,'identity function may not have a "stops" property')];let Se=[];const Qe=Te.value;return Se=Se.concat(Hu({key:Te.key,value:Qe,valueSpec:Te.valueSpec,style:Te.style,styleSpec:Te.styleSpec,arrayElementValidator:ue})),en(Qe)==="array"&&Qe.length===0&&Se.push(new Mi(Te.key,Qe,"array must have at least one stop")),Se},default:function(Te){return zo({key:Te.key,value:Te.value,valueSpec:s,style:Te.style,styleSpec:Te.styleSpec})}}});return h==="identity"&&V&&se.push(new Mi(c.key,c.value,'missing required property "property"')),h==="identity"||c.value.stops||se.push(new Mi(c.key,c.value,'missing required property "stops"')),h==="exponential"&&c.valueSpec.expression&&!kr(c.valueSpec)&&se.push(new Mi(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(Z&&!_n(c.valueSpec)?se.push(new Mi(c.key,c.value,"property functions not supported")):V&&!va(c.valueSpec)&&se.push(new Mi(c.key,c.value,"zoom functions not supported"))),h!=="categorical"&&!J||c.value.property!==void 0||se.push(new Mi(c.key,c.value,'"property" property is required')),se;function ue(Te){let Se=[];const Qe=Te.value,Xe=Te.key;if(en(Qe)!=="array")return[new Mi(Xe,Qe,`array expected, ${en(Qe)} found`)];if(Qe.length!==2)return[new Mi(Xe,Qe,`array length 2 expected, length ${Qe.length} found`)];if(J){if(en(Qe[0])!=="object")return[new Mi(Xe,Qe,`object expected, ${en(Qe[0])} found`)];if(Qe[0].zoom===void 0)return[new Mi(Xe,Qe,"object stop key must have zoom")];if(Qe[0].value===void 0)return[new Mi(Xe,Qe,"object stop key must have value")];if(k&&k>Gr(Qe[0].zoom))return[new Mi(Xe,Qe[0].zoom,"stop zoom values must appear in ascending order")];Gr(Qe[0].zoom)!==k&&(k=Gr(Qe[0].zoom),M=void 0,L={}),Se=Se.concat(ca({key:`${Xe}[0]`,value:Qe[0],valueSpec:{zoom:{}},style:Te.style,styleSpec:Te.styleSpec,objectElementValidators:{zoom:lu,value:xe}}))}else Se=Se.concat(xe({key:`${Xe}[0]`,value:Qe[0],valueSpec:{},style:Te.style,styleSpec:Te.styleSpec},Qe));return Cc(zn(Qe[1]))?Se.concat([new Mi(`${Xe}[1]`,Qe[1],"expressions are not allowed in function stops.")]):Se.concat(zo({key:`${Xe}[1]`,value:Qe[1],valueSpec:s,style:Te.style,styleSpec:Te.styleSpec}))}function xe(Te,Se){const Qe=en(Te.value),Xe=Gr(Te.value),Et=Te.value!==null?Te.value:Se;if(v){if(Qe!==v)return[new Mi(Te.key,Et,`${Qe} stop domain type must match previous stop domain type ${v}`)]}else v=Qe;if(Qe!=="number"&&Qe!=="string"&&Qe!=="boolean")return[new Mi(Te.key,Et,"stop domain value must be a number, string, or boolean")];if(Qe!=="number"&&h!=="categorical"){let Gt=`number expected, ${Qe} found`;return _n(s)&&h===void 0&&(Gt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Mi(Te.key,Et,Gt)]}return h!=="categorical"||Qe!=="number"||isFinite(Xe)&&Math.floor(Xe)===Xe?h!=="categorical"&&Qe==="number"&&M!==void 0&&Xe<M?[new Mi(Te.key,Et,"stop domain values must appear in ascending order")]:(M=Xe,h==="categorical"&&Xe in L?[new Mi(Te.key,Et,"stop domain values must be unique")]:(L[Xe]=!0,[])):[new Mi(Te.key,Et,`integer expected, found ${Xe}`)]}}function ba(c){const s=(c.expressionContext==="property"?qu:Yl)(zn(c.value),c.valueSpec);if(s.result==="error")return s.value.map(v=>new Mi(`${c.key}${v.key}`,c.value,v.message));const h=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!h.outputDefined())return[new Mi(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Po(h))return[new Mi(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Po(h))return[new Mi(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Sn(h,["zoom","feature-state"]))return[new Mi(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!oa(h))return[new Mi(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ac(c){const s=c.key,h=c.value,v=c.valueSpec,M=[];return Array.isArray(v.values)?v.values.indexOf(Gr(h))===-1&&M.push(new Mi(s,h,`expected one of [${v.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(v.values).indexOf(Gr(h))===-1&&M.push(new Mi(s,h,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(h)} found`)),M}function Jl(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!Jl(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const wd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function fl(c){if(c==null)return{filter:()=>!0,needGeometry:!1};Jl(c)||(c=qa(c));const s=Yl(c,wd);if(s.result==="error")throw new Error(s.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,v,M)=>s.value.evaluate(h,v,{},M),needGeometry:Yu(c)}}function Ql(c,s){return c<s?-1:c>s?1:0}function Yu(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let s=1;s<c.length;s++)if(Yu(c[s]))return!0;return!1}function qa(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?cu(c[1],c[2],"=="):s==="!="?_l(cu(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?cu(c[1],c[2],s):s==="any"?(h=c.slice(1),["any"].concat(h.map(qa))):s==="all"?["all"].concat(c.slice(1).map(qa)):s==="none"?["all"].concat(c.slice(1).map(qa).map(_l)):s==="in"?Bs(c[1],c.slice(2)):s==="!in"?_l(Bs(c[1],c.slice(2))):s==="has"?ml(c[1]):s==="!has"?_l(ml(c[1])):s!=="within"||c;var h}function cu(c,s,h){switch(c){case"$type":return[`filter-type-${h}`,s];case"$id":return[`filter-id-${h}`,s];default:return[`filter-${h}`,c,s]}}function Bs(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(h=>typeof h!=typeof s[0])?["filter-in-large",c,["literal",s.sort(Ql)]]:["filter-in-small",c,["literal",s]]}}function ml(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function _l(c){return["!",c]}function gl(c){return Jl(zn(c.value))?ba(so({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):zh(c)}function zh(c){const s=c.value,h=c.key;if(en(s)!=="array")return[new Mi(h,s,`array expected, ${en(s)} found`)];const v=c.styleSpec;let M,k=[];if(s.length<1)return[new Mi(h,s,"filter array must have at least 1 element")];switch(k=k.concat(Ac({key:`${h}[0]`,value:s[0],valueSpec:v.filter_operator,style:c.style,styleSpec:c.styleSpec})),Gr(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&Gr(s[1])==="$type"&&k.push(new Mi(h,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&k.push(new Mi(h,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(M=en(s[1]),M!=="string"&&k.push(new Mi(`${h}[1]`,s[1],`string expected, ${M} found`)));for(let L=2;L<s.length;L++)M=en(s[L]),Gr(s[1])==="$type"?k=k.concat(Ac({key:`${h}[${L}]`,value:s[L],valueSpec:v.geometry_type,style:c.style,styleSpec:c.styleSpec})):M!=="string"&&M!=="number"&&M!=="boolean"&&k.push(new Mi(`${h}[${L}]`,s[L],`string, number, or boolean expected, ${M} found`));break;case"any":case"all":case"none":for(let L=1;L<s.length;L++)k=k.concat(zh({key:`${h}[${L}]`,value:s[L],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":M=en(s[1]),s.length!==2?k.push(new Mi(h,s,`filter array for "${s[0]}" operator must have 2 elements`)):M!=="string"&&k.push(new Mi(`${h}[1]`,s[1],`string expected, ${M} found`));break;case"within":M=en(s[1]),s.length!==2?k.push(new Mi(h,s,`filter array for "${s[0]}" operator must have 2 elements`)):M!=="object"&&k.push(new Mi(`${h}[1]`,s[1],`object expected, ${M} found`))}return k}function ec(c,s){const h=c.key,v=c.style,M=c.styleSpec,k=c.value,L=c.objectKey,V=M[`${s}_${c.layerType}`];if(!V)return[];const Z=L.match(/^(.*)-transition$/);if(s==="paint"&&Z&&V[Z[1]]&&V[Z[1]].transition)return zo({key:h,value:k,valueSpec:M.transition,style:v,styleSpec:M});const J=c.valueSpec||V[L];if(!J)return[new Mi(h,k,`unknown property "${L}"`)];let se;if(en(k)==="string"&&_n(J)&&!J.tokens&&(se=/^{([^}]+)}$/.exec(k)))return[new Mi(h,k,`"${L}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(se[1])} }\`.`)];const ue=[];return c.layerType==="symbol"&&(L==="text-field"&&v&&!v.glyphs&&ue.push(new Mi(h,k,'use of "text-field" requires a style "glyphs" property')),L==="text-font"&&Pn(zn(k))&&Gr(k.type)==="identity"&&ue.push(new Mi(h,k,'"text-font" does not support identity functions'))),ue.concat(zo({key:c.key,value:k,valueSpec:J,style:v,styleSpec:M,expressionContext:"property",propertyType:s,propertyKey:L}))}function f1(c){return ec(c,"paint")}function Ju(c){return ec(c,"layout")}function uu(c){let s=[];const h=c.value,v=c.key,M=c.style,k=c.styleSpec;h.type||h.ref||s.push(new Mi(v,h,'either "type" or "ref" is required'));let L=Gr(h.type);const V=Gr(h.ref);if(h.id){const Z=Gr(h.id);for(let J=0;J<c.arrayIndex;J++){const se=M.layers[J];Gr(se.id)===Z&&s.push(new Mi(v,h.id,`duplicate layer id "${h.id}", previously used at line ${se.id.__line__}`))}}if("ref"in h){let Z;["type","source","source-layer","filter","layout"].forEach(J=>{J in h&&s.push(new Mi(v,h[J],`"${J}" is prohibited for ref layers`))}),M.layers.forEach(J=>{Gr(J.id)===V&&(Z=J)}),Z?Z.ref?s.push(new Mi(v,h.ref,"ref cannot reference another ref layer")):L=Gr(Z.type):s.push(new Mi(v,h.ref,`ref layer "${V}" not found`))}else if(L!=="background")if(h.source){const Z=M.sources&&M.sources[h.source],J=Z&&Gr(Z.type);Z?J==="vector"&&L==="raster"?s.push(new Mi(v,h.source,`layer "${h.id}" requires a raster source`)):J==="raster"&&L!=="raster"?s.push(new Mi(v,h.source,`layer "${h.id}" requires a vector source`)):J!=="vector"||h["source-layer"]?J==="raster-dem"&&L!=="hillshade"?s.push(new Mi(v,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):L!=="line"||!h.paint||!h.paint["line-gradient"]||J==="geojson"&&Z.lineMetrics||s.push(new Mi(v,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Mi(v,h,`layer "${h.id}" must specify a "source-layer"`)):s.push(new Mi(v,h.source,`source "${h.source}" not found`))}else s.push(new Mi(v,h,'missing required property "source"'));return s=s.concat(ca({key:v,value:h,valueSpec:k.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>zo({key:`${v}.type`,value:h.type,valueSpec:k.layer.type,style:c.style,styleSpec:c.styleSpec,object:h,objectKey:"type"}),filter:gl,layout:Z=>ca({layer:h,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":J=>Ju(so({layerType:L},J))}}),paint:Z=>ca({layer:h,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":J=>f1(so({layerType:L},J))}})}})),s}function wa(c){const s=c.value,h=c.key,v=en(s);return v!=="string"?[new Mi(h,s,`string expected, ${v} found`)]:[]}const Dh={promoteId:function({key:c,value:s}){if(en(s)==="string")return wa({key:c,value:s});{const h=[];for(const v in s)h.push(...wa({key:`${c}.${v}`,value:s[v]}));return h}}};function tc(c){const s=c.value,h=c.key,v=c.styleSpec,M=c.style;if(!s.type)return[new Mi(h,s,'"type" is required')];const k=Gr(s.type);let L;switch(k){case"vector":case"raster":case"raster-dem":return L=ca({key:h,value:s,valueSpec:v[`source_${k.replace("-","_")}`],style:c.style,styleSpec:v,objectElementValidators:Dh}),L;case"geojson":if(L=ca({key:h,value:s,valueSpec:v.source_geojson,style:M,styleSpec:v,objectElementValidators:Dh}),s.cluster)for(const V in s.clusterProperties){const[Z,J]=s.clusterProperties[V],se=typeof Z=="string"?[Z,["accumulated"],["get",V]]:Z;L.push(...ba({key:`${h}.${V}.map`,value:J,expressionContext:"cluster-map"})),L.push(...ba({key:`${h}.${V}.reduce`,value:se,expressionContext:"cluster-reduce"}))}return L;case"video":return ca({key:h,value:s,valueSpec:v.source_video,style:M,styleSpec:v});case"image":return ca({key:h,value:s,valueSpec:v.source_image,style:M,styleSpec:v});case"canvas":return[new Mi(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ac({key:`${h}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:M,styleSpec:v})}}function hu(c){const s=c.value,h=c.styleSpec,v=h.light,M=c.style;let k=[];const L=en(s);if(s===void 0)return k;if(L!=="object")return k=k.concat([new Mi("light",s,`object expected, ${L} found`)]),k;for(const V in s){const Z=V.match(/^(.*)-transition$/);k=k.concat(Z&&v[Z[1]]&&v[Z[1]].transition?zo({key:V,value:s[V],valueSpec:h.transition,style:M,styleSpec:h}):v[V]?zo({key:V,value:s[V],valueSpec:v[V],style:M,styleSpec:h}):[new Mi(V,s[V],`unknown property "${V}"`)])}return k}function ls(c){const s=c.value,h=c.styleSpec,v=h.terrain,M=c.style;let k=[];const L=en(s);if(s===void 0)return k;if(L!=="object")return k=k.concat([new Mi("terrain",s,`object expected, ${L} found`)]),k;for(const V in s)k=k.concat(v[V]?zo({key:V,value:s[V],valueSpec:v[V],style:M,styleSpec:h}):[new Mi(V,s[V],`unknown property "${V}"`)]);return k}const Pc={"*":()=>[],array:Hu,boolean:function(c){const s=c.value,h=c.key,v=en(s);return v!=="boolean"?[new Mi(h,s,`boolean expected, ${v} found`)]:[]},number:lu,color:function(c){const s=c.key,h=c.value,v=en(h);return v!=="string"?[new Mi(s,h,`color expected, ${v} found`)]:bt(h)===null?[new Mi(s,h,`color expected, "${h}" found`)]:[]},constants:Xo,enum:Ac,filter:gl,function:Ku,layer:uu,object:ca,source:tc,light:hu,terrain:ls,string:wa,formatted:function(c){return wa(c).length===0?[]:ba(c)},resolvedImage:function(c){return wa(c).length===0?[]:ba(c)},padding:function(c){const s=c.key,h=c.value;if(en(h)==="array"){if(h.length<1||h.length>4)return[new Mi(s,h,`padding requires 1 to 4 values; ${h.length} values found`)];const v={type:"number"};let M=[];for(let k=0;k<h.length;k++)M=M.concat(zo({key:`${s}[${k}]`,value:h[k],valueSpec:v}));return M}return lu({key:s,value:h,valueSpec:{}})}};function zo(c){const s=c.value,h=c.valueSpec,v=c.styleSpec;return h.expression&&Pn(Gr(s))?Ku(c):h.expression&&Cc(zn(s))?ba(c):h.type&&Pc[h.type]?Pc[h.type](c):ca(so({},c,{valueSpec:h.type?v[h.type]:h}))}function m1(c){const s=c.value,h=c.key,v=wa(c);return v.length||(s.indexOf("{fontstack}")===-1&&v.push(new Mi(h,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&v.push(new Mi(h,s,'"glyphs" url must include a "{range}" token'))),v}function ua(c,s=qt){let h=[];return h=h.concat(zo({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,objectElementValidators:{glyphs:m1,"*":()=>[]}})),c.constants&&(h=h.concat(Xo({key:"constants",value:c.constants,style:c,styleSpec:s}))),Lh(h)}function Lh(c){return[].concat(c).sort((s,h)=>s.line-h.line)}function Es(c){return function(...s){return Lh(c.apply(this,s))}}ua.source=Es(tc),ua.light=Es(hu),ua.terrain=Es(ls),ua.layer=Es(uu),ua.filter=Es(gl),ua.paintProperty=Es(f1),ua.layoutProperty=Es(Ju);const du=ua,Rh=du.light,Td=du.paintProperty,Ed=du.layoutProperty;function Qu(c,s){let h=!1;if(s&&s.length)for(const v of s)c.fire(new Zs(new Error(v.message))),h=!0;return h}class kc{constructor(s,h,v){const M=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const L=new Int32Array(this.arrayBuffer);s=L[0],this.d=(h=L[1])+2*(v=L[2]);for(let Z=0;Z<this.d*this.d;Z++){const J=L[3+Z],se=L[3+Z+1];M.push(J===se?null:L.subarray(J,se))}const V=L[3+M.length+1];this.keys=L.subarray(L[3+M.length],V),this.bboxes=L.subarray(V),this.insert=this._insertReadonly}else{this.d=h+2*v;for(let L=0;L<this.d*this.d;L++)M.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=s,this.padding=v,this.scale=h/s,this.uid=0;const k=v/h*s;this.min=-k,this.max=s+k}insert(s,h,v,M,k){this._forEachCell(h,v,M,k,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(M),this.bboxes.push(k)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,h,v,M,k,L){this.cells[k].push(L)}query(s,h,v,M,k){const L=this.min,V=this.max;if(s<=L&&h<=L&&V<=v&&V<=M&&!k)return Array.prototype.slice.call(this.keys);{const Z=[];return this._forEachCell(s,h,v,M,this._queryCell,Z,{},k),Z}}_queryCell(s,h,v,M,k,L,V,Z){const J=this.cells[k];if(J!==null){const se=this.keys,ue=this.bboxes;for(let xe=0;xe<J.length;xe++){const Te=J[xe];if(V[Te]===void 0){const Se=4*Te;(Z?Z(ue[Se+0],ue[Se+1],ue[Se+2],ue[Se+3]):s<=ue[Se+2]&&h<=ue[Se+3]&&v>=ue[Se+0]&&M>=ue[Se+1])?(V[Te]=!0,L.push(se[Te])):V[Te]=!1}}}}_forEachCell(s,h,v,M,k,L,V,Z){const J=this._convertToCellCoord(s),se=this._convertToCellCoord(h),ue=this._convertToCellCoord(v),xe=this._convertToCellCoord(M);for(let Te=J;Te<=ue;Te++)for(let Se=se;Se<=xe;Se++){const Qe=this.d*Se+Te;if((!Z||Z(this._convertFromCellCoord(Te),this._convertFromCellCoord(Se),this._convertFromCellCoord(Te+1),this._convertFromCellCoord(Se+1)))&&k.call(this,s,h,v,M,Qe,L,V,Z))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,h=3+this.cells.length+1+1;let v=0;for(let L=0;L<this.cells.length;L++)v+=this.cells[L].length;const M=new Int32Array(h+v+this.keys.length+this.bboxes.length);M[0]=this.extent,M[1]=this.n,M[2]=this.padding;let k=h;for(let L=0;L<s.length;L++){const V=s[L];M[3+L]=k,M.set(V,k),k+=V.length}return M[3+s.length]=k,M.set(this.keys,k),k+=this.keys.length,M[3+s.length+1]=k,M.set(this.bboxes,k),k+=this.bboxes.length,M.buffer}static serialize(s,h){const v=s.toArrayBuffer();return h&&h.push(v),{buffer:v}}static deserialize(s){return new kc(s.buffer)}}const Xs={};function Gi(c,s,h={}){if(Xs[c])throw new Error(`${c} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:c,writeable:!1}),Xs[c]={klass:s,omit:h.omit||[],shallow:h.shallow||[]}}Gi("Object",Object),Gi("TransferableGridIndex",kc),Gi("Color",ge),Gi("Error",Error),Gi("AJAXError",hn),Gi("ResolvedImage",ut),Gi("StylePropertyFunction",Wu),Gi("StyleExpression",pl,{omit:["_evaluator"]}),Gi("ZoomDependentExpression",Za),Gi("ZoomConstantExpression",Ic),Gi("CompoundExpression",Qi,{omit:["_evaluate"]});for(const c in hl)hl[c]._classRegistryKey||Gi(`Expression_${c}`,hl[c]);function Bh(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function yl(c,s){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob)return c;if(Bh(c)||Qt(c))return s&&s.push(c),c;if(ArrayBuffer.isView(c)){const h=c;return s&&s.push(h.buffer),h}if(c instanceof ImageData)return s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const h=[];for(const v of c)h.push(yl(v,s));return h}if(typeof c=="object"){const h=c.constructor,v=h._classRegistryKey;if(!v)throw new Error("can't serialize object of unregistered class");if(!Xs[v])throw new Error(`${v} is not registered.`);const M=h.serialize?h.serialize(c,s):{};if(h.serialize){if(s&&M===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const k in c){if(!c.hasOwnProperty(k)||Xs[v].omit.indexOf(k)>=0)continue;const L=c[k];M[k]=Xs[v].shallow.indexOf(k)>=0?L:yl(L,s)}c instanceof Error&&(M.message=c.message)}if(M.$name)throw new Error("$name property is reserved for worker serialization logic.");return v!=="Object"&&(M.$name=v),M}throw new Error("can't serialize object of type "+typeof c)}function Ko(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||Bh(c)||Qt(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(Ko);if(typeof c=="object"){const s=c.$name||"Object";if(!Xs[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:h}=Xs[s];if(!h)throw new Error(`can't deserialize unregistered class ${s}`);if(h.deserialize)return h.deserialize(c);const v=Object.create(h.prototype);for(const M of Object.keys(c)){if(M==="$name")continue;const k=c[M];v[M]=Xs[s].shallow.indexOf(M)>=0?k:Ko(k)}return v}throw new Error("can't deserialize object of type "+typeof c)}class zc{constructor(){this.first=!0}update(s,h){const v=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=v,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=v,!0):(this.lastFloorZoom>v?(this.lastIntegerZoom=v+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<v&&(this.lastIntegerZoom=v,this.lastIntegerZoomTime=h),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=v,!0))}}const Pi={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function xl(c){for(const s of c)if(vl(s.charCodeAt(0)))return!0;return!1}function _1(c){for(const s of c)if(!Wa(s.charCodeAt(0)))return!1;return!0}function Wa(c){return!(Pi.Arabic(c)||Pi["Arabic Supplement"](c)||Pi["Arabic Extended-A"](c)||Pi["Arabic Presentation Forms-A"](c)||Pi["Arabic Presentation Forms-B"](c))}function vl(c){return!(c!==746&&c!==747&&(c<4352||!(Pi["Bopomofo Extended"](c)||Pi.Bopomofo(c)||Pi["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Pi["CJK Compatibility Ideographs"](c)||Pi["CJK Compatibility"](c)||Pi["CJK Radicals Supplement"](c)||Pi["CJK Strokes"](c)||!(!Pi["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Pi["CJK Unified Ideographs Extension A"](c)||Pi["CJK Unified Ideographs"](c)||Pi["Enclosed CJK Letters and Months"](c)||Pi["Hangul Compatibility Jamo"](c)||Pi["Hangul Jamo Extended-A"](c)||Pi["Hangul Jamo Extended-B"](c)||Pi["Hangul Jamo"](c)||Pi["Hangul Syllables"](c)||Pi.Hiragana(c)||Pi["Ideographic Description Characters"](c)||Pi.Kanbun(c)||Pi["Kangxi Radicals"](c)||Pi["Katakana Phonetic Extensions"](c)||Pi.Katakana(c)&&c!==12540||!(!Pi["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Pi["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Pi["Unified Canadian Aboriginal Syllabics"](c)||Pi["Unified Canadian Aboriginal Syllabics Extended"](c)||Pi["Vertical Forms"](c)||Pi["Yijing Hexagram Symbols"](c)||Pi["Yi Syllables"](c)||Pi["Yi Radicals"](c))))}function pu(c){return!(vl(c)||function(s){return!!(Pi["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||Pi["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||Pi["Letterlike Symbols"](s)||Pi["Number Forms"](s)||Pi["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||Pi["Control Pictures"](s)&&s!==9251||Pi["Optical Character Recognition"](s)||Pi["Enclosed Alphanumerics"](s)||Pi["Geometric Shapes"](s)||Pi["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Pi["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Pi["CJK Symbols and Punctuation"](s)||Pi.Katakana(s)||Pi["Private Use Area"](s)||Pi["CJK Compatibility Forms"](s)||Pi["Small Form Variants"](s)||Pi["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(c))}function fu(c){return c>=1424&&c<=2303||Pi["Arabic Presentation Forms-A"](c)||Pi["Arabic Presentation Forms-B"](c)}function tn(c,s){return!(!s&&fu(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Pi.Khmer(c))}function Dc(c){for(const s of c)if(fu(s.charCodeAt(0)))return!0;return!1}const eh="deferred",Lc="loading",bl="loaded";let th=null,Do="unavailable",Yo=null;const Fh=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Do="error"),th&&th(c)};function Xa(){wl.fire(new Eo("pluginStateChange",{pluginStatus:Do,pluginURL:Yo}))}const wl=new qn,Ta=function(){return Do},ih=function(){if(Do!==eh||!Yo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Do=Lc,Xa(),Yo&&ra({url:Yo},c=>{c?Fh(c):(Do=bl,Xa())})},Jo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Do===bl||Jo.applyArabicShaping!=null,isLoading:()=>Do===Lc,setState(c){if(!ri())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Do=c.pluginStatus,Yo=c.pluginURL},isParsed(){if(!ri())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Jo.applyArabicShaping!=null&&Jo.processBidirectionalText!=null&&Jo.processStyledBidirectionalText!=null},getPluginURL(){if(!ri())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Yo}};class Cn{constructor(s,h){this.zoom=s,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new zc,this.transition={})}isSupportedScript(s){return function(h,v){for(const M of h)if(!tn(M.charCodeAt(0),v))return!1;return!0}(s,Jo.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,h=s-Math.floor(s),v=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*v}:{fromScale:.5,toScale:1,t:1-(1-v)*h}}}class Tl{constructor(s,h){this.property=s,this.value=h,this.expression=function(v,M){if(Pn(v))return new Wu(v,M);if(Cc(v)){const k=qu(v,M);if(k.result==="error")throw new Error(k.value.map(L=>`${L.key}: ${L.message}`).join(", "));return k.value}{let k=v;return M.type==="color"&&typeof v=="string"?k=ge.parse(v):M.type!=="padding"||typeof v!="number"&&!Array.isArray(v)||(k=Ve.parse(v)),{kind:"constant",evaluate:()=>k}}}(h===void 0?s.specification.default:h,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,h,v){return this.property.possiblyEvaluate(this,s,h,v)}}class ic{constructor(s){this.property=s,this.value=new Tl(s,void 0)}transitioned(s,h){return new Hs(this.property,this.value,h,lt({},s.transition,this.transition),s.now)}untransitioned(){return new Hs(this.property,this.value,null,{},0)}}class Fi{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return je(this._values[s].value.value)}setValue(s,h){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new ic(this._values[s].property)),this._values[s].value=new Tl(this._values[s].property,h===null?void 0:je(h))}getTransition(s){return je(this._values[s].transition)}setTransition(s,h){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new ic(this._values[s].property)),this._values[s].transition=je(h)||void 0}serialize(){const s={};for(const h of Object.keys(this._values)){const v=this.getValue(h);v!==void 0&&(s[h]=v);const M=this.getTransition(h);M!==void 0&&(s[`${h}-transition`]=M)}return s}transitioned(s,h){const v=new Oh(this._properties);for(const M of Object.keys(this._values))v._values[M]=this._values[M].transitioned(s,h._values[M]);return v}untransitioned(){const s=new Oh(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].untransitioned();return s}}class Hs{constructor(s,h,v,M,k){this.property=s,this.value=h,this.begin=k+M.delay||0,this.end=this.begin+M.duration||0,s.specification.transition&&(M.delay||M.duration)&&(this.prior=v)}possiblyEvaluate(s,h,v){const M=s.now||0,k=this.value.possiblyEvaluate(s,h,v),L=this.prior;if(L){if(M>this.end)return this.prior=null,k;if(this.value.isDataDriven())return this.prior=null,k;if(M<this.begin)return L.possiblyEvaluate(s,h,v);{const V=(M-this.begin)/(this.end-this.begin);return this.property.interpolate(L.possiblyEvaluate(s,h,v),k,function(Z){if(Z<=0)return 0;if(Z>=1)return 1;const J=Z*Z,se=J*Z;return 4*(Z<.5?se:3*(Z-J)+se-.75)}(V))}}return k}}class Oh{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,h,v){const M=new ro(this._properties);for(const k of Object.keys(this._values))M._values[k]=this._values[k].possiblyEvaluate(s,h,v);return M}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class mu{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return je(this._values[s].value)}setValue(s,h){this._values[s]=new Tl(this._values[s].property,h===null?void 0:je(h))}serialize(){const s={};for(const h of Object.keys(this._values)){const v=this.getValue(h);v!==void 0&&(s[h]=v)}return s}possiblyEvaluate(s,h,v){const M=new ro(this._properties);for(const k of Object.keys(this._values))M._values[k]=this._values[k].possiblyEvaluate(s,h,v);return M}}class Ss{constructor(s,h,v){this.property=s,this.value=h,this.parameters=v}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,h,v,M){return this.property.evaluate(this.value,this.parameters,s,h,v,M)}}class ro{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Ji{constructor(s){this.specification=s}possiblyEvaluate(s,h){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(h)}interpolate(s,h,v){const M=Na[this.specification.type];return M?M(s,h,v):s}}class dr{constructor(s,h){this.specification=s,this.overrides=h}possiblyEvaluate(s,h,v,M){return new Ss(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(h,null,{},v,M)}:s.expression,h)}interpolate(s,h,v){if(s.value.kind!=="constant"||h.value.kind!=="constant")return s;if(s.value.value===void 0||h.value.value===void 0)return new Ss(this,{kind:"constant",value:void 0},s.parameters);const M=Na[this.specification.type];return M?new Ss(this,{kind:"constant",value:M(s.value.value,h.value.value,v)},s.parameters):s}evaluate(s,h,v,M,k,L){return s.kind==="constant"?s.value:s.evaluate(h,v,M,k,L)}}class El extends dr{possiblyEvaluate(s,h,v,M){if(s.value===void 0)return new Ss(this,{kind:"constant",value:void 0},h);if(s.expression.kind==="constant"){const k=s.expression.evaluate(h,null,{},v,M),L=s.property.specification.type==="resolvedImage"&&typeof k!="string"?k.name:k,V=this._calculate(L,L,L,h);return new Ss(this,{kind:"constant",value:V},h)}if(s.expression.kind==="camera"){const k=this._calculate(s.expression.evaluate({zoom:h.zoom-1}),s.expression.evaluate({zoom:h.zoom}),s.expression.evaluate({zoom:h.zoom+1}),h);return new Ss(this,{kind:"constant",value:k},h)}return new Ss(this,s.expression,h)}evaluate(s,h,v,M,k,L){if(s.kind==="source"){const V=s.evaluate(h,v,M,k,L);return this._calculate(V,V,V,h)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(h.zoom)-1},v,M),s.evaluate({zoom:Math.floor(h.zoom)},v,M),s.evaluate({zoom:Math.floor(h.zoom)+1},v,M),h):s.value}_calculate(s,h,v,M){return M.zoom>M.zoomHistory.lastIntegerZoom?{from:s,to:h}:{from:v,to:h}}interpolate(s){return s}}class Rc{constructor(s){this.specification=s}possiblyEvaluate(s,h,v,M){if(s.value!==void 0){if(s.expression.kind==="constant"){const k=s.expression.evaluate(h,null,{},v,M);return this._calculate(k,k,k,h)}return this._calculate(s.expression.evaluate(new Cn(Math.floor(h.zoom-1),h)),s.expression.evaluate(new Cn(Math.floor(h.zoom),h)),s.expression.evaluate(new Cn(Math.floor(h.zoom+1),h)),h)}}_calculate(s,h,v,M){return M.zoom>M.zoomHistory.lastIntegerZoom?{from:s,to:h}:{from:v,to:h}}interpolate(s){return s}}class Ha{constructor(s){this.specification=s}possiblyEvaluate(s,h,v,M){return!!s.expression.evaluate(h,null,{},v,M)}interpolate(){return!1}}class ho{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in s){const v=s[h];v.specification.overridable&&this.overridableProperties.push(h);const M=this.defaultPropertyValues[h]=new Tl(v,void 0),k=this.defaultTransitionablePropertyValues[h]=new ic(v);this.defaultTransitioningPropertyValues[h]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=M.possiblyEvaluate({})}}}Gi("DataDrivenProperty",dr),Gi("DataConstantProperty",Ji),Gi("CrossFadedDataDrivenProperty",El),Gi("CrossFadedProperty",Rc),Gi("ColorRampProperty",Ha);const Fs="-transition";class Ks extends qn{constructor(s,h){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),h.layout&&(this._unevaluatedLayout=new mu(h.layout)),h.paint)){this._transitionablePaint=new Fi(h.paint);for(const v in s.paint)this.setPaintProperty(v,s.paint[v],{validate:!1});for(const v in s.layout)this.setLayoutProperty(v,s.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ro(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,h,v={}){h!=null&&this._validate(Ed,`layers.${this.id}.layout.${s}`,s,h,v)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,h):this.visibility=h)}getPaintProperty(s){return s.endsWith(Fs)?this._transitionablePaint.getTransition(s.slice(0,-Fs.length)):this._transitionablePaint.getValue(s)}setPaintProperty(s,h,v={}){if(h!=null&&this._validate(Td,`layers.${this.id}.paint.${s}`,s,h,v))return!1;if(s.endsWith(Fs))return this._transitionablePaint.setTransition(s.slice(0,-Fs.length),h||void 0),!1;{const M=this._transitionablePaint._values[s],k=M.property.specification["property-type"]==="cross-faded-data-driven",L=M.value.isDataDriven(),V=M.value;this._transitionablePaint.setValue(s,h),this._handleSpecialPaintPropertyUpdate(s);const Z=this._transitionablePaint._values[s].value;return Z.isDataDriven()||L||k||this._handleOverridablePaintPropertyUpdate(s,V,Z)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,h,v){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,h){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,h)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),Le(s,(h,v)=>!(h===void 0||v==="layout"&&!Object.keys(h).length||v==="paint"&&!Object.keys(h).length))}_validate(s,h,v,M,k={}){return(!k||k.validate!==!1)&&Qu(this,s.call(du,{key:h,layerType:this.type,objectKey:v,value:M,styleSpec:qt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const h=this.paint.get(s);if(h instanceof Ss&&_n(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const g1={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ka{constructor(s,h){this._structArray=s,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Dn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,h){return s._trim(),h&&(s.isTransferred=!0,h.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const h=Object.create(this.prototype);return h.arrayBuffer=s.arrayBuffer,h.length=s.length,h.capacity=s.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function no(c,s=1){let h=0,v=0;return{members:c.map(M=>{const k=g1[M.type].BYTES_PER_ELEMENT,L=h=_u(h,Math.max(s,k)),V=M.components||1;return v=Math.max(v,k),h+=k*V,{name:M.name,type:M.type,components:V,offset:L}}),size:_u(h,Math.max(v,s)),alignment:s}}function _u(c,s){return Math.ceil(c/s)*s}class Ya extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h){const v=this.length;return this.resize(v+1),this.emplace(v,s,h)}emplace(s,h,v){const M=2*s;return this.int16[M+0]=h,this.int16[M+1]=v,s}}Ya.prototype.bytesPerElement=4,Gi("StructArrayLayout2i4",Ya);class S extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,v,M){const k=this.length;return this.resize(k+1),this.emplace(k,s,h,v,M)}emplace(s,h,v,M,k){const L=4*s;return this.int16[L+0]=h,this.int16[L+1]=v,this.int16[L+2]=M,this.int16[L+3]=k,s}}S.prototype.bytesPerElement=8,Gi("StructArrayLayout4i8",S);class l extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k,L){const V=this.length;return this.resize(V+1),this.emplace(V,s,h,v,M,k,L)}emplace(s,h,v,M,k,L,V){const Z=6*s;return this.int16[Z+0]=h,this.int16[Z+1]=v,this.int16[Z+2]=M,this.int16[Z+3]=k,this.int16[Z+4]=L,this.int16[Z+5]=V,s}}l.prototype.bytesPerElement=12,Gi("StructArrayLayout2i4i12",l);class m extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k,L){const V=this.length;return this.resize(V+1),this.emplace(V,s,h,v,M,k,L)}emplace(s,h,v,M,k,L,V){const Z=4*s,J=8*s;return this.int16[Z+0]=h,this.int16[Z+1]=v,this.uint8[J+4]=M,this.uint8[J+5]=k,this.uint8[J+6]=L,this.uint8[J+7]=V,s}}m.prototype.bytesPerElement=8,Gi("StructArrayLayout2i4ub8",m);class w extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h){const v=this.length;return this.resize(v+1),this.emplace(v,s,h)}emplace(s,h,v){const M=2*s;return this.float32[M+0]=h,this.float32[M+1]=v,s}}w.prototype.bytesPerElement=8,Gi("StructArrayLayout2f8",w);class C extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k,L,V,Z,J,se){const ue=this.length;return this.resize(ue+1),this.emplace(ue,s,h,v,M,k,L,V,Z,J,se)}emplace(s,h,v,M,k,L,V,Z,J,se,ue){const xe=10*s;return this.uint16[xe+0]=h,this.uint16[xe+1]=v,this.uint16[xe+2]=M,this.uint16[xe+3]=k,this.uint16[xe+4]=L,this.uint16[xe+5]=V,this.uint16[xe+6]=Z,this.uint16[xe+7]=J,this.uint16[xe+8]=se,this.uint16[xe+9]=ue,s}}C.prototype.bytesPerElement=20,Gi("StructArrayLayout10ui20",C);class D extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k,L,V,Z,J,se,ue,xe){const Te=this.length;return this.resize(Te+1),this.emplace(Te,s,h,v,M,k,L,V,Z,J,se,ue,xe)}emplace(s,h,v,M,k,L,V,Z,J,se,ue,xe,Te){const Se=12*s;return this.int16[Se+0]=h,this.int16[Se+1]=v,this.int16[Se+2]=M,this.int16[Se+3]=k,this.uint16[Se+4]=L,this.uint16[Se+5]=V,this.uint16[Se+6]=Z,this.uint16[Se+7]=J,this.int16[Se+8]=se,this.int16[Se+9]=ue,this.int16[Se+10]=xe,this.int16[Se+11]=Te,s}}D.prototype.bytesPerElement=24,Gi("StructArrayLayout4i4ui4i24",D);class U extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,v){const M=this.length;return this.resize(M+1),this.emplace(M,s,h,v)}emplace(s,h,v,M){const k=3*s;return this.float32[k+0]=h,this.float32[k+1]=v,this.float32[k+2]=M,s}}U.prototype.bytesPerElement=12,Gi("StructArrayLayout3f12",U);class q extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.uint32[1*s+0]=h,s}}q.prototype.bytesPerElement=4,Gi("StructArrayLayout1ul4",q);class K extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k,L,V,Z,J){const se=this.length;return this.resize(se+1),this.emplace(se,s,h,v,M,k,L,V,Z,J)}emplace(s,h,v,M,k,L,V,Z,J,se){const ue=10*s,xe=5*s;return this.int16[ue+0]=h,this.int16[ue+1]=v,this.int16[ue+2]=M,this.int16[ue+3]=k,this.int16[ue+4]=L,this.int16[ue+5]=V,this.uint32[xe+3]=Z,this.uint16[ue+8]=J,this.uint16[ue+9]=se,s}}K.prototype.bytesPerElement=20,Gi("StructArrayLayout6i1ul2ui20",K);class ee extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k,L){const V=this.length;return this.resize(V+1),this.emplace(V,s,h,v,M,k,L)}emplace(s,h,v,M,k,L,V){const Z=6*s;return this.int16[Z+0]=h,this.int16[Z+1]=v,this.int16[Z+2]=M,this.int16[Z+3]=k,this.int16[Z+4]=L,this.int16[Z+5]=V,s}}ee.prototype.bytesPerElement=12,Gi("StructArrayLayout2i2i2i12",ee);class le extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k){const L=this.length;return this.resize(L+1),this.emplace(L,s,h,v,M,k)}emplace(s,h,v,M,k,L){const V=4*s,Z=8*s;return this.float32[V+0]=h,this.float32[V+1]=v,this.float32[V+2]=M,this.int16[Z+6]=k,this.int16[Z+7]=L,s}}le.prototype.bytesPerElement=16,Gi("StructArrayLayout2f1f2i16",le);class me extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,v,M){const k=this.length;return this.resize(k+1),this.emplace(k,s,h,v,M)}emplace(s,h,v,M,k){const L=12*s,V=3*s;return this.uint8[L+0]=h,this.uint8[L+1]=v,this.float32[V+1]=M,this.float32[V+2]=k,s}}me.prototype.bytesPerElement=12,Gi("StructArrayLayout2ub2f12",me);class be extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,v){const M=this.length;return this.resize(M+1),this.emplace(M,s,h,v)}emplace(s,h,v,M){const k=3*s;return this.uint16[k+0]=h,this.uint16[k+1]=v,this.uint16[k+2]=M,s}}be.prototype.bytesPerElement=6,Gi("StructArrayLayout3ui6",be);class qe extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k,L,V,Z,J,se,ue,xe,Te,Se,Qe,Xe,Et){const Gt=this.length;return this.resize(Gt+1),this.emplace(Gt,s,h,v,M,k,L,V,Z,J,se,ue,xe,Te,Se,Qe,Xe,Et)}emplace(s,h,v,M,k,L,V,Z,J,se,ue,xe,Te,Se,Qe,Xe,Et,Gt){const wt=24*s,Ut=12*s,ai=48*s;return this.int16[wt+0]=h,this.int16[wt+1]=v,this.uint16[wt+2]=M,this.uint16[wt+3]=k,this.uint32[Ut+2]=L,this.uint32[Ut+3]=V,this.uint32[Ut+4]=Z,this.uint16[wt+10]=J,this.uint16[wt+11]=se,this.uint16[wt+12]=ue,this.float32[Ut+7]=xe,this.float32[Ut+8]=Te,this.uint8[ai+36]=Se,this.uint8[ai+37]=Qe,this.uint8[ai+38]=Xe,this.uint32[Ut+10]=Et,this.int16[wt+22]=Gt,s}}qe.prototype.bytesPerElement=48,Gi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",qe);class Oe extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,v,M,k,L,V,Z,J,se,ue,xe,Te,Se,Qe,Xe,Et,Gt,wt,Ut,ai,li,Hi,tr,Vi,Li,zi,$i){const Ni=this.length;return this.resize(Ni+1),this.emplace(Ni,s,h,v,M,k,L,V,Z,J,se,ue,xe,Te,Se,Qe,Xe,Et,Gt,wt,Ut,ai,li,Hi,tr,Vi,Li,zi,$i)}emplace(s,h,v,M,k,L,V,Z,J,se,ue,xe,Te,Se,Qe,Xe,Et,Gt,wt,Ut,ai,li,Hi,tr,Vi,Li,zi,$i,Ni){const bi=34*s,ar=17*s;return this.int16[bi+0]=h,this.int16[bi+1]=v,this.int16[bi+2]=M,this.int16[bi+3]=k,this.int16[bi+4]=L,this.int16[bi+5]=V,this.int16[bi+6]=Z,this.int16[bi+7]=J,this.uint16[bi+8]=se,this.uint16[bi+9]=ue,this.uint16[bi+10]=xe,this.uint16[bi+11]=Te,this.uint16[bi+12]=Se,this.uint16[bi+13]=Qe,this.uint16[bi+14]=Xe,this.uint16[bi+15]=Et,this.uint16[bi+16]=Gt,this.uint16[bi+17]=wt,this.uint16[bi+18]=Ut,this.uint16[bi+19]=ai,this.uint16[bi+20]=li,this.uint16[bi+21]=Hi,this.uint16[bi+22]=tr,this.uint32[ar+12]=Vi,this.float32[ar+13]=Li,this.float32[ar+14]=zi,this.float32[ar+15]=$i,this.float32[ar+16]=Ni,s}}Oe.prototype.bytesPerElement=68,Gi("StructArrayLayout8i15ui1ul4f68",Oe);class Fe extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.float32[1*s+0]=h,s}}Fe.prototype.bytesPerElement=4,Gi("StructArrayLayout1f4",Fe);class ht extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,v){const M=this.length;return this.resize(M+1),this.emplace(M,s,h,v)}emplace(s,h,v,M){const k=3*s;return this.int16[k+0]=h,this.int16[k+1]=v,this.int16[k+2]=M,s}}ht.prototype.bytesPerElement=6,Gi("StructArrayLayout3i6",ht);class vt extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,v){const M=this.length;return this.resize(M+1),this.emplace(M,s,h,v)}emplace(s,h,v,M){const k=4*s;return this.uint32[2*s+0]=h,this.uint16[k+2]=v,this.uint16[k+3]=M,s}}vt.prototype.bytesPerElement=8,Gi("StructArrayLayout1ul2ui8",vt);class Pt extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h){const v=this.length;return this.resize(v+1),this.emplace(v,s,h)}emplace(s,h,v){const M=2*s;return this.uint16[M+0]=h,this.uint16[M+1]=v,s}}Pt.prototype.bytesPerElement=4,Gi("StructArrayLayout2ui4",Pt);class Ke extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.uint16[1*s+0]=h,s}}Ke.prototype.bytesPerElement=2,Gi("StructArrayLayout1ui2",Ke);class Rt extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,v,M){const k=this.length;return this.resize(k+1),this.emplace(k,s,h,v,M)}emplace(s,h,v,M,k){const L=4*s;return this.float32[L+0]=h,this.float32[L+1]=v,this.float32[L+2]=M,this.float32[L+3]=k,s}}Rt.prototype.bytesPerElement=16,Gi("StructArrayLayout4f16",Rt);class Bt extends Ka{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Mt(this.anchorPointX,this.anchorPointY)}}Bt.prototype.size=20;class ii extends K{get(s){return new Bt(this,s)}}Gi("CollisionBoxArray",ii);class Yt extends Ka{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Yt.prototype.size=48;class di extends qe{get(s){return new Yt(this,s)}}Gi("PlacedSymbolArray",di);class Wt extends Ka{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Wt.prototype.size=68;class Ui extends Oe{get(s){return new Wt(this,s)}}Gi("SymbolInstanceArray",Ui);class Ft extends Fe{getoffsetX(s){return this.float32[1*s+0]}}Gi("GlyphOffsetArray",Ft);class qi extends ht{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}Gi("SymbolLineVertexArray",qi);class Er extends Ka{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Er.prototype.size=8;class Sr extends vt{get(s){return new Er(this,s)}}Gi("FeatureIndexArray",Sr);class ir extends Ya{}class pi extends Ya{}class cn extends Ya{}class Yr extends l{}class Jr extends m{}class dn extends w{}class _o extends C{}class ha extends D{}class da extends U{}class Ea extends q{}class Sa extends ee{}class Ms extends me{}class Qo extends be{}class Cs extends Pt{}const _=no([{name:"a_pos",components:2,type:"Int16"}],4),{members:o}=_;class d{constructor(s=[]){this.segments=s}prepareSegment(s,h,v,M){let k=this.segments[this.segments.length-1];return s>d.MAX_VERTEX_ARRAY_LENGTH&&St(`Max vertices per segment is ${d.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!k||k.vertexLength+s>d.MAX_VERTEX_ARRAY_LENGTH||k.sortKey!==M)&&(k={vertexOffset:h.length,primitiveOffset:v.length,vertexLength:0,primitiveLength:0},M!==void 0&&(k.sortKey=M),this.segments.push(k)),k}get(){return this.segments}destroy(){for(const s of this.segments)for(const h in s.vaos)s.vaos[h].destroy()}static simpleSegment(s,h,v,M){return new d([{vertexOffset:s,primitiveOffset:h,vertexLength:v,primitiveLength:M,vaos:{},sortKey:0}])}}function x(c,s){return 256*(c=ne(Math.floor(c),0,255))+ne(Math.floor(s),0,255)}d.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gi("SegmentVector",d);const E=no([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var A={exports:{}},B={exports:{}};B.exports=function(c,s){var h,v,M,k,L,V,Z,J;for(v=c.length-(h=3&c.length),M=s,L=3432918353,V=461845907,J=0;J<v;)Z=255&c.charCodeAt(J)|(255&c.charCodeAt(++J))<<8|(255&c.charCodeAt(++J))<<16|(255&c.charCodeAt(++J))<<24,++J,M=27492+(65535&(k=5*(65535&(M=(M^=Z=(65535&(Z=(Z=(65535&Z)*L+(((Z>>>16)*L&65535)<<16)&4294967295)<<15|Z>>>17))*V+(((Z>>>16)*V&65535)<<16)&4294967295)<<13|M>>>19))+((5*(M>>>16)&65535)<<16)&4294967295))+((58964+(k>>>16)&65535)<<16);switch(Z=0,h){case 3:Z^=(255&c.charCodeAt(J+2))<<16;case 2:Z^=(255&c.charCodeAt(J+1))<<8;case 1:M^=Z=(65535&(Z=(Z=(65535&(Z^=255&c.charCodeAt(J)))*L+(((Z>>>16)*L&65535)<<16)&4294967295)<<15|Z>>>17))*V+(((Z>>>16)*V&65535)<<16)&4294967295}return M^=c.length,M=2246822507*(65535&(M^=M>>>16))+((2246822507*(M>>>16)&65535)<<16)&4294967295,M=3266489909*(65535&(M^=M>>>13))+((3266489909*(M>>>16)&65535)<<16)&4294967295,(M^=M>>>16)>>>0};var O={exports:{}};O.exports=function(c,s){for(var h,v=c.length,M=s^v,k=0;v>=4;)h=1540483477*(65535&(h=255&c.charCodeAt(k)|(255&c.charCodeAt(++k))<<8|(255&c.charCodeAt(++k))<<16|(255&c.charCodeAt(++k))<<24))+((1540483477*(h>>>16)&65535)<<16),M=1540483477*(65535&M)+((1540483477*(M>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),v-=4,++k;switch(v){case 3:M^=(255&c.charCodeAt(k+2))<<16;case 2:M^=(255&c.charCodeAt(k+1))<<8;case 1:M=1540483477*(65535&(M^=255&c.charCodeAt(k)))+((1540483477*(M>>>16)&65535)<<16)}return M=1540483477*(65535&(M^=M>>>13))+((1540483477*(M>>>16)&65535)<<16),(M^=M>>>15)>>>0};var G=B.exports,H=O.exports;A.exports=G,A.exports.murmur3=G,A.exports.murmur2=H;class X{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,h,v,M){this.ids.push(oe(s)),this.positions.push(h,v,M)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=oe(s);let v=0,M=this.ids.length-1;for(;v<M;){const L=v+M>>1;this.ids[L]>=h?M=L:v=L+1}const k=[];for(;this.ids[v]===h;)k.push({index:this.positions[3*v],start:this.positions[3*v+1],end:this.positions[3*v+2]}),v++;return k}static serialize(s,h){const v=new Float64Array(s.ids),M=new Uint32Array(s.positions);return ve(v,M,0,v.length-1),h&&h.push(v.buffer,M.buffer),{ids:v,positions:M}}static deserialize(s){const h=new X;return h.ids=s.ids,h.positions=s.positions,h.indexed=!0,h}}function oe(c){const s=+c;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:A.exports(String(c))}function ve(c,s,h,v){for(;h<v;){const M=c[h+v>>1];let k=h-1,L=v+1;for(;;){do k++;while(c[k]<M);do L--;while(c[L]>M);if(k>=L)break;Ee(c,k,L),Ee(s,3*k,3*L),Ee(s,3*k+1,3*L+1),Ee(s,3*k+2,3*L+2)}L-h<v-L?(ve(c,s,h,L),h=L+1):(ve(c,s,L+1,v),v=L)}}function Ee(c,s,h){const v=c[s];c[s]=c[h],c[h]=v}Gi("FeaturePositionMap",X);class Ie{constructor(s,h){this.gl=s.gl,this.location=h}}class Ce extends Ie{constructor(s,h){super(s,h),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class ze extends Ie{constructor(s,h){super(s,h),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class ae extends Ie{constructor(s,h){super(s,h),this.current=ge.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const Me=new Float32Array(16);function Ue(c){return[x(255*c.r,255*c.g),x(255*c.b,255*c.a)]}class Ge{constructor(s,h,v){this.value=s,this.uniformNames=h.map(M=>`u_${M}`),this.type=v}setUniform(s,h,v){s.set(v.constantOr(this.value))}getBinding(s,h,v){return this.type==="color"?new ae(s,h):new Ce(s,h)}}class rt{constructor(s,h){this.uniformNames=h.map(v=>`u_${v}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=s.tlbr}setUniform(s,h,v,M){const k=M==="u_pattern_to"?this.patternTo:M==="u_pattern_from"?this.patternFrom:M==="u_pixel_ratio_to"?this.pixelRatioTo:M==="u_pixel_ratio_from"?this.pixelRatioFrom:null;k&&s.set(k)}getBinding(s,h,v){return v.substr(0,9)==="u_pattern"?new ze(s,h):new Ce(s,h)}}class nt{constructor(s,h,v,M){this.expression=s,this.type=v,this.maxValue=0,this.paintVertexAttributes=h.map(k=>({name:`a_${k}`,type:"Float32",components:v==="color"?2:1,offset:0})),this.paintVertexArray=new M}populatePaintArray(s,h,v,M,k){const L=this.paintVertexArray.length,V=this.expression.evaluate(new Cn(0),h,{},M,[],k);this.paintVertexArray.resize(s),this._setPaintValue(L,s,V)}updatePaintArray(s,h,v,M){const k=this.expression.evaluate({zoom:0},v,M);this._setPaintValue(s,h,k)}_setPaintValue(s,h,v){if(this.type==="color"){const M=Ue(v);for(let k=s;k<h;k++)this.paintVertexArray.emplace(k,M[0],M[1])}else{for(let M=s;M<h;M++)this.paintVertexArray.emplace(M,v);this.maxValue=Math.max(this.maxValue,Math.abs(v))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class tt{constructor(s,h,v,M,k,L){this.expression=s,this.uniformNames=h.map(V=>`u_${V}_t`),this.type=v,this.useIntegerZoom=M,this.zoom=k,this.maxValue=0,this.paintVertexAttributes=h.map(V=>({name:`a_${V}`,type:"Float32",components:v==="color"?4:2,offset:0})),this.paintVertexArray=new L}populatePaintArray(s,h,v,M,k){const L=this.expression.evaluate(new Cn(this.zoom),h,{},M,[],k),V=this.expression.evaluate(new Cn(this.zoom+1),h,{},M,[],k),Z=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(Z,s,L,V)}updatePaintArray(s,h,v,M){const k=this.expression.evaluate({zoom:this.zoom},v,M),L=this.expression.evaluate({zoom:this.zoom+1},v,M);this._setPaintValue(s,h,k,L)}_setPaintValue(s,h,v,M){if(this.type==="color"){const k=Ue(v),L=Ue(M);for(let V=s;V<h;V++)this.paintVertexArray.emplace(V,k[0],k[1],L[0],L[1])}else{for(let k=s;k<h;k++)this.paintVertexArray.emplace(k,v,M);this.maxValue=Math.max(this.maxValue,Math.abs(v),Math.abs(M))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,h){const v=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,M=ne(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);s.set(M)}getBinding(s,h,v){return new Ce(s,h)}}class gt{constructor(s,h,v,M,k,L){this.expression=s,this.type=h,this.useIntegerZoom=v,this.zoom=M,this.layerId=L,this.zoomInPaintVertexArray=new k,this.zoomOutPaintVertexArray=new k}populatePaintArray(s,h,v){const M=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(M,s,h.patterns&&h.patterns[this.layerId],v)}updatePaintArray(s,h,v,M,k){this._setPaintValues(s,h,v.patterns&&v.patterns[this.layerId],k)}_setPaintValues(s,h,v,M){if(!M||!v)return;const{min:k,mid:L,max:V}=v,Z=M[k],J=M[L],se=M[V];if(Z&&J&&se)for(let ue=s;ue<h;ue++)this.zoomInPaintVertexArray.emplace(ue,J.tl[0],J.tl[1],J.br[0],J.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],J.pixelRatio,Z.pixelRatio),this.zoomOutPaintVertexArray.emplace(ue,J.tl[0],J.tl[1],J.br[0],J.br[1],se.tl[0],se.tl[1],se.br[0],se.br[1],J.pixelRatio,se.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,E.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,E.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class yt{constructor(s,h,v){this.binders={},this._buffers=[];const M=[];for(const k in s.paint._values){if(!v(k))continue;const L=s.paint.get(k);if(!(L instanceof Ss&&_n(L.property.specification)))continue;const V=yi(k,s.type),Z=L.value,J=L.property.specification.type,se=L.property.useIntegerZoom,ue=L.property.specification["property-type"],xe=ue==="cross-faded"||ue==="cross-faded-data-driven";if(Z.kind==="constant")this.binders[k]=xe?new rt(Z.value,V):new Ge(Z.value,V,J),M.push(`/u_${k}`);else if(Z.kind==="source"||xe){const Te=At(k,J,"source");this.binders[k]=xe?new gt(Z,J,se,h,Te,s.id):new nt(Z,V,J,Te),M.push(`/a_${k}`)}else{const Te=At(k,J,"composite");this.binders[k]=new tt(Z,V,J,se,h,Te),M.push(`/z_${k}`)}}this.cacheKey=M.sort().join("")}getMaxValue(s){const h=this.binders[s];return h instanceof nt||h instanceof tt?h.maxValue:0}populatePaintArrays(s,h,v,M,k){for(const L in this.binders){const V=this.binders[L];(V instanceof nt||V instanceof tt||V instanceof gt)&&V.populatePaintArray(s,h,v,M,k)}}setConstantPatternPositions(s,h){for(const v in this.binders){const M=this.binders[v];M instanceof rt&&M.setConstantPatternPositions(s,h)}}updatePaintArrays(s,h,v,M,k){let L=!1;for(const V in s){const Z=h.getPositions(V);for(const J of Z){const se=v.feature(J.index);for(const ue in this.binders){const xe=this.binders[ue];if((xe instanceof nt||xe instanceof tt||xe instanceof gt)&&xe.expression.isStateDependent===!0){const Te=M.paint.get(ue);xe.expression=Te.value,xe.updatePaintArray(J.start,J.end,se,s[V],k),L=!0}}}}return L}defines(){const s=[];for(const h in this.binders){const v=this.binders[h];(v instanceof Ge||v instanceof rt)&&s.push(...v.uniformNames.map(M=>`#define HAS_UNIFORM_${M}`))}return s}getBinderAttributes(){const s=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof nt||v instanceof tt)for(let M=0;M<v.paintVertexAttributes.length;M++)s.push(v.paintVertexAttributes[M].name);else if(v instanceof gt)for(let M=0;M<E.members.length;M++)s.push(E.members[M].name)}return s}getBinderUniforms(){const s=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof Ge||v instanceof rt||v instanceof tt)for(const M of v.uniformNames)s.push(M)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,h){const v=[];for(const M in this.binders){const k=this.binders[M];if(k instanceof Ge||k instanceof rt||k instanceof tt){for(const L of k.uniformNames)if(h[L]){const V=k.getBinding(s,h[L],L);v.push({name:L,property:M,binding:V})}}}return v}setUniforms(s,h,v,M){for(const{name:k,property:L,binding:V}of h)this.binders[L].setUniform(V,M,v.get(L),k)}updatePaintBuffers(s){this._buffers=[];for(const h in this.binders){const v=this.binders[h];if(s&&v instanceof gt){const M=s.fromScale===2?v.zoomInPaintVertexBuffer:v.zoomOutPaintVertexBuffer;M&&this._buffers.push(M)}else(v instanceof nt||v instanceof tt)&&v.paintVertexBuffer&&this._buffers.push(v.paintVertexBuffer)}}upload(s){for(const h in this.binders){const v=this.binders[h];(v instanceof nt||v instanceof tt||v instanceof gt)&&v.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const h=this.binders[s];(h instanceof nt||h instanceof tt||h instanceof gt)&&h.destroy()}}}class kt{constructor(s,h,v=()=>!0){this.programConfigurations={};for(const M of s)this.programConfigurations[M.id]=new yt(M,h,v);this.needsUpload=!1,this._featureMap=new X,this._bufferOffset=0}populatePaintArrays(s,h,v,M,k,L){for(const V in this.programConfigurations)this.programConfigurations[V].populatePaintArrays(s,h,M,k,L);h.id!==void 0&&this._featureMap.add(h.id,v,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,h,v,M){for(const k of v)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(s,this._featureMap,h,k,M)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function yi(c,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}function At(c,s,h){const v={color:{source:w,composite:Rt},number:{source:Fe,composite:w}},M=function(k){return{"line-pattern":{source:_o,composite:_o},"fill-pattern":{source:_o,composite:_o},"fill-extrusion-pattern":{source:_o,composite:_o}}[k]}(c);return M&&M[h]||v[s][h]}Gi("ConstantBinder",Ge),Gi("CrossFadedConstantBinder",rt),Gi("SourceExpressionBinder",nt),Gi("CrossFadedCompositeBinder",gt),Gi("CompositeExpressionBinder",tt),Gi("ProgramConfiguration",yt,{omit:["_buffers"]}),Gi("ProgramConfigurationSet",kt);var Zt=8192;const Nt=Math.pow(2,14)-1,mi=-Nt-1;function Ct(c){const s=Zt/c.extent,h=c.loadGeometry();for(let v=0;v<h.length;v++){const M=h[v];for(let k=0;k<M.length;k++){const L=M[k],V=Math.round(L.x*s),Z=Math.round(L.y*s);L.x=ne(V,mi,Nt),L.y=ne(Z,mi,Nt),(V<L.x||V>L.x+1||Z<L.y||Z>L.y+1)&&St("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function ei(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?Ct(c):[]}}function _i(c,s,h,v,M){c.emplaceBack(2*s+(v+1)/2,2*h+(M+1)/2)}class si{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new pi,this.indexArray=new Qo,this.segments=new d,this.programConfigurations=new kt(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,v){const M=this.layers[0],k=[];let L=null,V=!1;M.type==="circle"&&(L=M.layout.get("circle-sort-key"),V=!L.isConstant());for(const{feature:Z,id:J,index:se,sourceLayerIndex:ue}of s){const xe=this.layers[0]._featureFilter.needGeometry,Te=ei(Z,xe);if(!this.layers[0]._featureFilter.filter(new Cn(this.zoom),Te,v))continue;const Se=V?L.evaluate(Te,{},v):void 0,Qe={id:J,properties:Z.properties,type:Z.type,sourceLayerIndex:ue,index:se,geometry:xe?Te.geometry:Ct(Z),patterns:{},sortKey:Se};k.push(Qe)}V&&k.sort((Z,J)=>Z.sortKey-J.sortKey);for(const Z of k){const{geometry:J,index:se,sourceLayerIndex:ue}=Z,xe=s[se].feature;this.addFeature(Z,J,se,v),h.featureIndex.insert(xe,J,se,ue,this.index)}}update(s,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,h,this.stateDependentLayers,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,o),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,h,v,M){for(const k of h)for(const L of k){const V=L.x,Z=L.y;if(V<0||V>=Zt||Z<0||Z>=Zt)continue;const J=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),se=J.vertexLength;_i(this.layoutVertexArray,V,Z,-1,-1),_i(this.layoutVertexArray,V,Z,1,-1),_i(this.layoutVertexArray,V,Z,1,1),_i(this.layoutVertexArray,V,Z,-1,1),this.indexArray.emplaceBack(se,se+1,se+2),this.indexArray.emplaceBack(se,se+3,se+2),J.vertexLength+=4,J.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,v,{},M)}}function xi(c,s){for(let h=0;h<c.length;h++)if(un(s,c[h]))return!0;for(let h=0;h<s.length;h++)if(un(c,s[h]))return!0;return!!cr(c,s)}function or(c,s,h){return!!un(c,s)||!!Fr(s,c,h)}function vr(c,s){if(c.length===1)return pn(s,c[0]);for(let h=0;h<s.length;h++){const v=s[h];for(let M=0;M<v.length;M++)if(un(c,v[M]))return!0}for(let h=0;h<c.length;h++)if(pn(s,c[h]))return!0;for(let h=0;h<s.length;h++)if(cr(c,s[h]))return!0;return!1}function Xi(c,s,h){if(c.length>1){if(cr(c,s))return!0;for(let v=0;v<s.length;v++)if(Fr(s[v],c,h))return!0}for(let v=0;v<c.length;v++)if(Fr(c[v],s,h))return!0;return!1}function cr(c,s){if(c.length===0||s.length===0)return!1;for(let h=0;h<c.length-1;h++){const v=c[h],M=c[h+1];for(let k=0;k<s.length-1;k++)if(Zr(v,M,s[k],s[k+1]))return!0}return!1}function Zr(c,s,h,v){return ci(c,h,v)!==ci(s,h,v)&&ci(c,s,h)!==ci(c,s,v)}function Fr(c,s,h){const v=h*h;if(s.length===1)return c.distSqr(s[0])<v;for(let M=1;M<s.length;M++)if(er(c,s[M-1],s[M])<v)return!0;return!1}function er(c,s,h){const v=s.distSqr(h);if(v===0)return c.distSqr(s);const M=((c.x-s.x)*(h.x-s.x)+(c.y-s.y)*(h.y-s.y))/v;return c.distSqr(M<0?s:M>1?h:h.sub(s)._mult(M)._add(s))}function pn(c,s){let h,v,M,k=!1;for(let L=0;L<c.length;L++){h=c[L];for(let V=0,Z=h.length-1;V<h.length;Z=V++)v=h[V],M=h[Z],v.y>s.y!=M.y>s.y&&s.x<(M.x-v.x)*(s.y-v.y)/(M.y-v.y)+v.x&&(k=!k)}return k}function un(c,s){let h=!1;for(let v=0,M=c.length-1;v<c.length;M=v++){const k=c[v],L=c[M];k.y>s.y!=L.y>s.y&&s.x<(L.x-k.x)*(s.y-k.y)/(L.y-k.y)+k.x&&(h=!h)}return h}function kn(c,s,h){const v=h[0],M=h[2];if(c.x<v.x&&s.x<v.x||c.x>M.x&&s.x>M.x||c.y<v.y&&s.y<v.y||c.y>M.y&&s.y>M.y)return!1;const k=ci(c,s,h[0]);return k!==ci(c,s,h[1])||k!==ci(c,s,h[2])||k!==ci(c,s,h[3])}function fn(c,s,h){const v=s.paint.get(c).value;return v.kind==="constant"?v.value:h.programConfigurations.get(s.id).getMaxValue(c)}function Lo(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function go(c,s,h,v,M){if(!s[0]&&!s[1])return c;const k=Mt.convert(s)._mult(M);h==="viewport"&&k._rotate(-v);const L=[];for(let V=0;V<c.length;V++)L.push(c[V].sub(k));return L}Gi("CircleBucket",si,{omit:["layers"]});const Ma=new ho({"circle-sort-key":new dr(qt.layout_circle["circle-sort-key"])});var Sl={paint:new ho({"circle-radius":new dr(qt.paint_circle["circle-radius"]),"circle-color":new dr(qt.paint_circle["circle-color"]),"circle-blur":new dr(qt.paint_circle["circle-blur"]),"circle-opacity":new dr(qt.paint_circle["circle-opacity"]),"circle-translate":new Ji(qt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ji(qt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ji(qt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ji(qt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new dr(qt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new dr(qt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new dr(qt.paint_circle["circle-stroke-opacity"])}),layout:Ma},Wr=1e-6,jr=typeof Float32Array<"u"?Float32Array:Array;function an(){var c=new jr(9);return jr!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function lo(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Is(c,s,h){var v=s[0],M=s[1],k=s[2],L=s[3],V=s[4],Z=s[5],J=s[6],se=s[7],ue=s[8],xe=s[9],Te=s[10],Se=s[11],Qe=s[12],Xe=s[13],Et=s[14],Gt=s[15],wt=h[0],Ut=h[1],ai=h[2],li=h[3];return c[0]=wt*v+Ut*V+ai*ue+li*Qe,c[1]=wt*M+Ut*Z+ai*xe+li*Xe,c[2]=wt*k+Ut*J+ai*Te+li*Et,c[3]=wt*L+Ut*se+ai*Se+li*Gt,c[4]=(wt=h[4])*v+(Ut=h[5])*V+(ai=h[6])*ue+(li=h[7])*Qe,c[5]=wt*M+Ut*Z+ai*xe+li*Xe,c[6]=wt*k+Ut*J+ai*Te+li*Et,c[7]=wt*L+Ut*se+ai*Se+li*Gt,c[8]=(wt=h[8])*v+(Ut=h[9])*V+(ai=h[10])*ue+(li=h[11])*Qe,c[9]=wt*M+Ut*Z+ai*xe+li*Xe,c[10]=wt*k+Ut*J+ai*Te+li*Et,c[11]=wt*L+Ut*se+ai*Se+li*Gt,c[12]=(wt=h[12])*v+(Ut=h[13])*V+(ai=h[14])*ue+(li=h[15])*Qe,c[13]=wt*M+Ut*Z+ai*xe+li*Xe,c[14]=wt*k+Ut*J+ai*Te+li*Et,c[15]=wt*L+Ut*se+ai*Se+li*Gt,c}Math.hypot||(Math.hypot=function(){for(var c=0,s=arguments.length;s--;)c+=arguments[s]*arguments[s];return Math.sqrt(c)});var In,Ys=Is;function Uh(){var c=new jr(3);return jr!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function Bc(c,s,h){var v=new jr(3);return v[0]=c,v[1]=s,v[2]=h,v}function Fc(c,s,h){var v=s[0],M=s[1],k=s[2],L=s[3];return c[0]=h[0]*v+h[4]*M+h[8]*k+h[12]*L,c[1]=h[1]*v+h[5]*M+h[9]*k+h[13]*L,c[2]=h[2]*v+h[6]*M+h[10]*k+h[14]*L,c[3]=h[3]*v+h[7]*M+h[11]*k+h[15]*L,c}function Ml(){var c=new jr(4);return jr!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function rc(c,s){const h=Fc([],[c.x,c.y,0,1],s);return new Mt(h[0]/h[3],h[1]/h[3])}Uh(),In=new jr(4),jr!=Float32Array&&(In[0]=0,In[1]=0,In[2]=0,In[3]=0),Uh(),Bc(1,0,0),Bc(0,1,0),Ml(),Ml(),an(),function(){var c;c=new jr(2),jr!=Float32Array&&(c[0]=0,c[1]=0)}();class Oc extends si{}Gi("HeatmapBucket",Oc,{omit:["layers"]});var y1={paint:new ho({"heatmap-radius":new dr(qt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new dr(qt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ji(qt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ha(qt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ji(qt.paint_heatmap["heatmap-opacity"])})};function gu(c,{width:s,height:h},v,M){if(M){if(M instanceof Uint8ClampedArray)M=new Uint8Array(M.buffer);else if(M.length!==s*h*v)throw new RangeError(`mismatched image size. expected: ${M.length} but got: ${s*h*v}`)}else M=new Uint8Array(s*h*v);return c.width=s,c.height=h,c.data=M,c}function x1(c,{width:s,height:h},v){if(s===c.width&&h===c.height)return;const M=gu({},{width:s,height:h},v);_p(c,M,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,s),height:Math.min(c.height,h)},v),c.width=s,c.height=h,c.data=M.data}function _p(c,s,h,v,M,k){if(M.width===0||M.height===0)return s;if(M.width>c.width||M.height>c.height||h.x>c.width-M.width||h.y>c.height-M.height)throw new RangeError("out of range source coordinates for image copy");if(M.width>s.width||M.height>s.height||v.x>s.width-M.width||v.y>s.height-M.height)throw new RangeError("out of range destination coordinates for image copy");const L=c.data,V=s.data;if(L===V)throw new Error("srcData equals dstData, so image is already copied");for(let Z=0;Z<M.height;Z++){const J=((h.y+Z)*c.width+h.x)*k,se=((v.y+Z)*s.width+v.x)*k;for(let ue=0;ue<M.width*k;ue++)V[se+ue]=L[J+ue]}return s}class v1{constructor(s,h){gu(this,s,1,h)}resize(s){x1(this,s,1)}clone(){return new v1({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,h,v,M,k){_p(s,h,v,M,k,1)}}class Ja{constructor(s,h){gu(this,s,4,h)}resize(s){x1(this,s,4)}replace(s,h){h?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Ja({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,h,v,M,k){_p(s,h,v,M,k,4)}}function gp(c){const s={},h=c.resolution||256,v=c.clips?c.clips.length:1,M=c.image||new Ja({width:h,height:v});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const k=(L,V,Z)=>{s[c.evaluationKey]=Z;const J=c.expression.evaluate(s);M.data[L+V+0]=Math.floor(255*J.r/J.a),M.data[L+V+1]=Math.floor(255*J.g/J.a),M.data[L+V+2]=Math.floor(255*J.b/J.a),M.data[L+V+3]=Math.floor(255*J.a)};if(c.clips)for(let L=0,V=0;L<v;++L,V+=4*h)for(let Z=0,J=0;Z<h;Z++,J+=4){const se=Z/(h-1),{start:ue,end:xe}=c.clips[L];k(V,J,ue*(1-se)+xe*se)}else for(let L=0,V=0;L<h;L++,V+=4)k(0,V,L/(h-1));return M}Gi("AlphaImage",v1),Gi("RGBAImage",Ja);var yp={paint:new ho({"hillshade-illumination-direction":new Ji(qt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ji(qt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ji(qt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ji(qt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ji(qt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ji(qt.paint_hillshade["hillshade-accent-color"])})};const X2=no([{name:"a_pos",components:2,type:"Int16"}],4),{members:Z0}=X2;var Nh={exports:{}};function Cl(c,s,h){h=h||2;var v,M,k,L,V,Z,J,se=s&&s.length,ue=se?s[0]*h:c.length,xe=Sd(c,0,ue,h,!0),Te=[];if(!xe||xe.next===xe.prev)return Te;if(se&&(xe=function(Qe,Xe,Et,Gt){var wt,Ut,ai,li=[];for(wt=0,Ut=Xe.length;wt<Ut;wt++)(ai=Sd(Qe,Xe[wt]*Gt,wt<Ut-1?Xe[wt+1]*Gt:Qe.length,Gt,!1))===ai.next&&(ai.steiner=!0),li.push(nh(ai));for(li.sort(Md),wt=0;wt<li.length;wt++)Et=w1(li[wt],Et);return Et}(c,s,xe,h)),c.length>80*h){v=k=c[0],M=L=c[1];for(var Se=h;Se<ue;Se+=h)(V=c[Se])<v&&(v=V),(Z=c[Se+1])<M&&(M=Z),V>k&&(k=V),Z>L&&(L=Z);J=(J=Math.max(k-v,L-M))!==0?32767/J:0}return b1(xe,Te,h,v,M,J,0),Te}function Sd(c,s,h,v,M){var k,L;if(M===sr(c,s,h,v)>0)for(k=s;k<h;k+=v)L=K2(k,c[k],c[k+1],L);else for(k=h-v;k>=s;k-=v)L=K2(k,c[k],c[k+1],L);return L&&xp(L,L.next)&&(Id(L),L=L.next),L}function rh(c,s){if(!c)return c;s||(s=c);var h,v=c;do if(h=!1,v.steiner||!xp(v,v.next)&&yo(v.prev,v,v.next)!==0)v=v.next;else{if(Id(v),(v=s=v.prev)===v.next)break;h=!0}while(h||v!==s);return s}function b1(c,s,h,v,M,k,L){if(c){!L&&k&&function(se,ue,xe,Te){var Se=se;do Se.z===0&&(Se.z=Qa(Se.x,Se.y,ue,xe,Te)),Se.prevZ=Se.prev,Se.nextZ=Se.next,Se=Se.next;while(Se!==se);Se.prevZ.nextZ=null,Se.prevZ=null,function(Qe){var Xe,Et,Gt,wt,Ut,ai,li,Hi,tr=1;do{for(Et=Qe,Qe=null,Ut=null,ai=0;Et;){for(ai++,Gt=Et,li=0,Xe=0;Xe<tr&&(li++,Gt=Gt.nextZ);Xe++);for(Hi=tr;li>0||Hi>0&&Gt;)li!==0&&(Hi===0||!Gt||Et.z<=Gt.z)?(wt=Et,Et=Et.nextZ,li--):(wt=Gt,Gt=Gt.nextZ,Hi--),Ut?Ut.nextZ=wt:Qe=wt,wt.prevZ=Ut,Ut=wt;Et=Gt}Ut.nextZ=null,tr*=2}while(ai>1)}(Se)}(c,v,M,k);for(var V,Z,J=c;c.prev!==c.next;)if(V=c.prev,Z=c.next,k?N5(c,v,M,k):U5(c))s.push(V.i/h|0),s.push(c.i/h|0),s.push(Z.i/h|0),Id(c),c=Z.next,J=Z.next;else if((c=Z)===J){L?L===1?b1(c=V5(rh(c),s,h),s,h,v,M,k,2):L===2&&q0(c,s,h,v,M,k):b1(rh(c),s,h,v,M,k,1);break}}}function U5(c){var s=c.prev,h=c,v=c.next;if(yo(s,h,v)>=0)return!1;for(var M=s.x,k=h.x,L=v.x,V=s.y,Z=h.y,J=v.y,se=M<k?M<L?M:L:k<L?k:L,ue=V<Z?V<J?V:J:Z<J?Z:J,xe=M>k?M>L?M:L:k>L?k:L,Te=V>Z?V>J?V:J:Z>J?Z:J,Se=v.next;Se!==s;){if(Se.x>=se&&Se.x<=xe&&Se.y>=ue&&Se.y<=Te&&el(M,V,k,Z,L,J,Se.x,Se.y)&&yo(Se.prev,Se,Se.next)>=0)return!1;Se=Se.next}return!0}function N5(c,s,h,v){var M=c.prev,k=c,L=c.next;if(yo(M,k,L)>=0)return!1;for(var V=M.x,Z=k.x,J=L.x,se=M.y,ue=k.y,xe=L.y,Te=V<Z?V<J?V:J:Z<J?Z:J,Se=se<ue?se<xe?se:xe:ue<xe?ue:xe,Qe=V>Z?V>J?V:J:Z>J?Z:J,Xe=se>ue?se>xe?se:xe:ue>xe?ue:xe,Et=Qa(Te,Se,s,h,v),Gt=Qa(Qe,Xe,s,h,v),wt=c.prevZ,Ut=c.nextZ;wt&&wt.z>=Et&&Ut&&Ut.z<=Gt;){if(wt.x>=Te&&wt.x<=Qe&&wt.y>=Se&&wt.y<=Xe&&wt!==M&&wt!==L&&el(V,se,Z,ue,J,xe,wt.x,wt.y)&&yo(wt.prev,wt,wt.next)>=0||(wt=wt.prevZ,Ut.x>=Te&&Ut.x<=Qe&&Ut.y>=Se&&Ut.y<=Xe&&Ut!==M&&Ut!==L&&el(V,se,Z,ue,J,xe,Ut.x,Ut.y)&&yo(Ut.prev,Ut,Ut.next)>=0))return!1;Ut=Ut.nextZ}for(;wt&&wt.z>=Et;){if(wt.x>=Te&&wt.x<=Qe&&wt.y>=Se&&wt.y<=Xe&&wt!==M&&wt!==L&&el(V,se,Z,ue,J,xe,wt.x,wt.y)&&yo(wt.prev,wt,wt.next)>=0)return!1;wt=wt.prevZ}for(;Ut&&Ut.z<=Gt;){if(Ut.x>=Te&&Ut.x<=Qe&&Ut.y>=Se&&Ut.y<=Xe&&Ut!==M&&Ut!==L&&el(V,se,Z,ue,J,xe,Ut.x,Ut.y)&&yo(Ut.prev,Ut,Ut.next)>=0)return!1;Ut=Ut.nextZ}return!0}function V5(c,s,h){var v=c;do{var M=v.prev,k=v.next.next;!xp(M,k)&&H2(M,v,v.next,k)&&T1(M,k)&&T1(k,M)&&(s.push(M.i/h|0),s.push(v.i/h|0),s.push(k.i/h|0),Id(v),Id(v.next),v=c=k),v=v.next}while(v!==c);return rh(v)}function q0(c,s,h,v,M,k){var L=c;do{for(var V=L.next.next;V!==L.prev;){if(L.i!==V.i&&Vh(L,V)){var Z=Il(L,V);return L=rh(L,L.next),Z=rh(Z,Z.next),b1(L,s,h,v,M,k,0),void b1(Z,s,h,v,M,k,0)}V=V.next}L=L.next}while(L!==c)}function Md(c,s){return c.x-s.x}function w1(c,s){var h=function(M,k){var L,V=k,Z=M.x,J=M.y,se=-1/0;do{if(J<=V.y&&J>=V.next.y&&V.next.y!==V.y){var ue=V.x+(J-V.y)*(V.next.x-V.x)/(V.next.y-V.y);if(ue<=Z&&ue>se&&(se=ue,L=V.x<V.next.x?V:V.next,ue===Z))return L}V=V.next}while(V!==k);if(!L)return null;var xe,Te=L,Se=L.x,Qe=L.y,Xe=1/0;V=L;do Z>=V.x&&V.x>=Se&&Z!==V.x&&el(J<Qe?Z:se,J,Se,Qe,J<Qe?se:Z,J,V.x,V.y)&&(xe=Math.abs(J-V.y)/(Z-V.x),T1(V,M)&&(xe<Xe||xe===Xe&&(V.x>L.x||V.x===L.x&&yu(L,V)))&&(L=V,Xe=xe)),V=V.next;while(V!==Te);return L}(c,s);if(!h)return s;var v=Il(h,c);return rh(v,v.next),rh(h,h.next)}function yu(c,s){return yo(c.prev,c,s.prev)<0&&yo(s.next,c,c.next)<0}function Qa(c,s,h,v,M){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-h)*M|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-v)*M|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function nh(c){var s=c,h=c;do(s.x<h.x||s.x===h.x&&s.y<h.y)&&(h=s),s=s.next;while(s!==c);return h}function el(c,s,h,v,M,k,L,V){return(M-L)*(s-V)>=(c-L)*(k-V)&&(c-L)*(v-V)>=(h-L)*(s-V)&&(h-L)*(k-V)>=(M-L)*(v-V)}function Vh(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!function(h,v){var M=h;do{if(M.i!==h.i&&M.next.i!==h.i&&M.i!==v.i&&M.next.i!==v.i&&H2(M,M.next,h,v))return!0;M=M.next}while(M!==h);return!1}(c,s)&&(T1(c,s)&&T1(s,c)&&function(h,v){var M=h,k=!1,L=(h.x+v.x)/2,V=(h.y+v.y)/2;do M.y>V!=M.next.y>V&&M.next.y!==M.y&&L<(M.next.x-M.x)*(V-M.y)/(M.next.y-M.y)+M.x&&(k=!k),M=M.next;while(M!==h);return k}(c,s)&&(yo(c.prev,c,s.prev)||yo(c,s.prev,s))||xp(c,s)&&yo(c.prev,c,c.next)>0&&yo(s.prev,s,s.next)>0)}function yo(c,s,h){return(s.y-c.y)*(h.x-s.x)-(s.x-c.x)*(h.y-s.y)}function xp(c,s){return c.x===s.x&&c.y===s.y}function H2(c,s,h,v){var M=Cd(yo(c,s,h)),k=Cd(yo(c,s,v)),L=Cd(yo(h,v,c)),V=Cd(yo(h,v,s));return M!==k&&L!==V||!(M!==0||!vp(c,h,s))||!(k!==0||!vp(c,v,s))||!(L!==0||!vp(h,c,v))||!(V!==0||!vp(h,s,v))}function vp(c,s,h){return s.x<=Math.max(c.x,h.x)&&s.x>=Math.min(c.x,h.x)&&s.y<=Math.max(c.y,h.y)&&s.y>=Math.min(c.y,h.y)}function Cd(c){return c>0?1:c<0?-1:0}function T1(c,s){return yo(c.prev,c,c.next)<0?yo(c,s,c.next)>=0&&yo(c,c.prev,s)>=0:yo(c,s,c.prev)<0||yo(c,c.next,s)<0}function Il(c,s){var h=new co(c.i,c.x,c.y),v=new co(s.i,s.x,s.y),M=c.next,k=s.prev;return c.next=s,s.prev=c,h.next=M,M.prev=h,v.next=h,h.prev=v,k.next=v,v.prev=k,v}function K2(c,s,h,v){var M=new co(c,s,h);return v?(M.next=v.next,M.prev=v,v.next.prev=M,v.next=M):(M.prev=M,M.next=M),M}function Id(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function co(c,s,h){this.i=c,this.x=s,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function sr(c,s,h,v){for(var M=0,k=s,L=h-v;k<h;k+=v)M+=(c[L]-c[k])*(c[k+1]+c[L+1]),L=k;return M}function oh(c,s,h,v,M){Ad(c,s,h||0,v||c.length-1,M||Y2)}function Ad(c,s,h,v,M){for(;v>h;){if(v-h>600){var k=v-h+1,L=s-h+1,V=Math.log(k),Z=.5*Math.exp(2*V/3),J=.5*Math.sqrt(V*Z*(k-Z)/k)*(L-k/2<0?-1:1);Ad(c,s,Math.max(h,Math.floor(s-L*Z/k+J)),Math.min(v,Math.floor(s+(k-L)*Z/k+J)),M)}var se=c[s],ue=h,xe=v;for(As(c,h,s),M(c[v],se)>0&&As(c,h,v);ue<xe;){for(As(c,ue,xe),ue++,xe--;M(c[ue],se)<0;)ue++;for(;M(c[xe],se)>0;)xe--}M(c[h],se)===0?As(c,h,xe):As(c,++xe,v),xe<=s&&(h=xe+1),s<=xe&&(v=xe-1)}}function As(c,s,h){var v=c[s];c[s]=c[h],c[h]=v}function Y2(c,s){return c<s?-1:c>s?1:0}function bp(c,s){const h=c.length;if(h<=1)return[c];const v=[];let M,k;for(let L=0;L<h;L++){const V=dt(c[L]);V!==0&&(c[L].area=Math.abs(V),k===void 0&&(k=V<0),k===V<0?(M&&v.push(M),M=[c[L]]):M.push(c[L]))}if(M&&v.push(M),s>1)for(let L=0;L<v.length;L++)v[L].length<=s||(oh(v[L],s,1,v[L].length-1,nc),v[L]=v[L].slice(0,s));return v}function nc(c,s){return s.area-c.area}function Pd(c,s,h){const v=h.patternDependencies;let M=!1;for(const k of s){const L=k.paint.get(`${c}-pattern`);L.isConstant()||(M=!0);const V=L.constantOr(null);V&&(M=!0,v[V.to]=!0,v[V.from]=!0)}return M}function xu(c,s,h,v,M){const k=M.patternDependencies;for(const L of s){const V=L.paint.get(`${c}-pattern`).value;if(V.kind!=="constant"){let Z=V.evaluate({zoom:v-1},h,{},M.availableImages),J=V.evaluate({zoom:v},h,{},M.availableImages),se=V.evaluate({zoom:v+1},h,{},M.availableImages);Z=Z&&Z.name?Z.name:Z,J=J&&J.name?J.name:J,se=se&&se.name?se.name:se,k[Z]=!0,k[J]=!0,k[se]=!0,h.patterns[L.id]={min:Z,mid:J,max:se}}}return h}Nh.exports=Cl,Nh.exports.default=Cl,Cl.deviation=function(c,s,h,v){var M=s&&s.length,k=Math.abs(sr(c,0,M?s[0]*h:c.length,h));if(M)for(var L=0,V=s.length;L<V;L++)k-=Math.abs(sr(c,s[L]*h,L<V-1?s[L+1]*h:c.length,h));var Z=0;for(L=0;L<v.length;L+=3){var J=v[L]*h,se=v[L+1]*h,ue=v[L+2]*h;Z+=Math.abs((c[J]-c[ue])*(c[se+1]-c[J+1])-(c[J]-c[se])*(c[ue+1]-c[J+1]))}return k===0&&Z===0?0:Math.abs((Z-k)/k)},Cl.flatten=function(c){for(var s=c[0][0].length,h={vertices:[],holes:[],dimensions:s},v=0,M=0;M<c.length;M++){for(var k=0;k<c[M].length;k++)for(var L=0;L<s;L++)h.vertices.push(c[M][k][L]);M>0&&h.holes.push(v+=c[M-1].length)}return h};class jh{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new cn,this.indexArray=new Qo,this.indexArray2=new Cs,this.programConfigurations=new kt(s.layers,s.zoom),this.segments=new d,this.segments2=new d,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,v){this.hasPattern=Pd("fill",this.layers,h);const M=this.layers[0].layout.get("fill-sort-key"),k=!M.isConstant(),L=[];for(const{feature:V,id:Z,index:J,sourceLayerIndex:se}of s){const ue=this.layers[0]._featureFilter.needGeometry,xe=ei(V,ue);if(!this.layers[0]._featureFilter.filter(new Cn(this.zoom),xe,v))continue;const Te=k?M.evaluate(xe,{},v,h.availableImages):void 0,Se={id:Z,properties:V.properties,type:V.type,sourceLayerIndex:se,index:J,geometry:ue?xe.geometry:Ct(V),patterns:{},sortKey:Te};L.push(Se)}k&&L.sort((V,Z)=>V.sortKey-Z.sortKey);for(const V of L){const{geometry:Z,index:J,sourceLayerIndex:se}=V;if(this.hasPattern){const ue=xu("fill",this.layers,V,this.zoom,h);this.patternFeatures.push(ue)}else this.addFeature(V,Z,J,v,{});h.featureIndex.insert(s[J].feature,Z,J,se,this.index)}}update(s,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,h,this.stateDependentLayers,v)}addFeatures(s,h,v){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,h,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Z0),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,h,v,M,k){for(const L of bp(h,500)){let V=0;for(const Te of L)V+=Te.length;const Z=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray),J=Z.vertexLength,se=[],ue=[];for(const Te of L){if(Te.length===0)continue;Te!==L[0]&&ue.push(se.length/2);const Se=this.segments2.prepareSegment(Te.length,this.layoutVertexArray,this.indexArray2),Qe=Se.vertexLength;this.layoutVertexArray.emplaceBack(Te[0].x,Te[0].y),this.indexArray2.emplaceBack(Qe+Te.length-1,Qe),se.push(Te[0].x),se.push(Te[0].y);for(let Xe=1;Xe<Te.length;Xe++)this.layoutVertexArray.emplaceBack(Te[Xe].x,Te[Xe].y),this.indexArray2.emplaceBack(Qe+Xe-1,Qe+Xe),se.push(Te[Xe].x),se.push(Te[Xe].y);Se.vertexLength+=Te.length,Se.primitiveLength+=Te.length}const xe=Nh.exports(se,ue);for(let Te=0;Te<xe.length;Te+=3)this.indexArray.emplaceBack(J+xe[Te],J+xe[Te+1],J+xe[Te+2]);Z.vertexLength+=V,Z.primitiveLength+=xe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,v,k,M)}}Gi("FillBucket",jh,{omit:["layers","patternFeatures"]});const Gh=new ho({"fill-sort-key":new dr(qt.layout_fill["fill-sort-key"])});var W0={paint:new ho({"fill-antialias":new Ji(qt.paint_fill["fill-antialias"]),"fill-opacity":new dr(qt.paint_fill["fill-opacity"]),"fill-color":new dr(qt.paint_fill["fill-color"]),"fill-outline-color":new dr(qt.paint_fill["fill-outline-color"]),"fill-translate":new Ji(qt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ji(qt.paint_fill["fill-translate-anchor"]),"fill-pattern":new El(qt.paint_fill["fill-pattern"])}),layout:Gh};const wp=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),J2=no([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Q2}=wp;var sh={},X0=Mt,H0=Uc;function Uc(c,s,h,v,M){this.properties={},this.extent=h,this.type=0,this._pbf=c,this._geometry=-1,this._keys=v,this._values=M,c.readFields(E1,this,s)}function E1(c,s,h){c==1?s.id=h.readVarint():c==2?function(v,M){for(var k=v.readVarint()+v.pos;v.pos<k;){var L=M._keys[v.readVarint()],V=M._values[v.readVarint()];M.properties[L]=V}}(h,s):c==3?s.type=h.readVarint():c==4&&(s._geometry=h.pos)}function vu(c){for(var s,h,v=0,M=0,k=c.length,L=k-1;M<k;L=M++)v+=((h=c[L]).x-(s=c[M]).x)*(s.y+h.y);return v}Uc.types=["Unknown","Point","LineString","Polygon"],Uc.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var s,h=c.readVarint()+c.pos,v=1,M=0,k=0,L=0,V=[];c.pos<h;){if(M<=0){var Z=c.readVarint();v=7&Z,M=Z>>3}if(M--,v===1||v===2)k+=c.readSVarint(),L+=c.readSVarint(),v===1&&(s&&V.push(s),s=[]),s.push(new X0(k,L));else{if(v!==7)throw new Error("unknown command "+v);s&&s.push(s[0].clone())}}return s&&V.push(s),V},Uc.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var s=c.readVarint()+c.pos,h=1,v=0,M=0,k=0,L=1/0,V=-1/0,Z=1/0,J=-1/0;c.pos<s;){if(v<=0){var se=c.readVarint();h=7&se,v=se>>3}if(v--,h===1||h===2)(M+=c.readSVarint())<L&&(L=M),M>V&&(V=M),(k+=c.readSVarint())<Z&&(Z=k),k>J&&(J=k);else if(h!==7)throw new Error("unknown command "+h)}return[L,Z,V,J]},Uc.prototype.toGeoJSON=function(c,s,h){var v,M,k=this.extent*Math.pow(2,h),L=this.extent*c,V=this.extent*s,Z=this.loadGeometry(),J=Uc.types[this.type];function se(Te){for(var Se=0;Se<Te.length;Se++){var Qe=Te[Se];Te[Se]=[360*(Qe.x+L)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(Qe.y+V)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var ue=[];for(v=0;v<Z.length;v++)ue[v]=Z[v][0];se(Z=ue);break;case 2:for(v=0;v<Z.length;v++)se(Z[v]);break;case 3:for(Z=function(Te){var Se=Te.length;if(Se<=1)return[Te];for(var Qe,Xe,Et=[],Gt=0;Gt<Se;Gt++){var wt=vu(Te[Gt]);wt!==0&&(Xe===void 0&&(Xe=wt<0),Xe===wt<0?(Qe&&Et.push(Qe),Qe=[Te[Gt]]):Qe.push(Te[Gt]))}return Qe&&Et.push(Qe),Et}(Z),v=0;v<Z.length;v++)for(M=0;M<Z[v].length;M++)se(Z[v][M])}Z.length===1?Z=Z[0]:J="Multi"+J;var xe={type:"Feature",geometry:{type:J,coordinates:Z},properties:this.properties};return"id"in this&&(xe.id=this.id),xe};var K0=H0,Y0=S1;function S1(c,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(kd,this,s),this.length=this._features.length}function kd(c,s,h){c===15?s.version=h.readVarint():c===1?s.name=h.readString():c===5?s.extent=h.readVarint():c===2?s._features.push(h.pos):c===3?s._keys.push(h.readString()):c===4&&s._values.push(function(v){for(var M=null,k=v.readVarint()+v.pos;v.pos<k;){var L=v.readVarint()>>3;M=L===1?v.readString():L===2?v.readFloat():L===3?v.readDouble():L===4?v.readVarint64():L===5?v.readVarint():L===6?v.readSVarint():L===7?v.readBoolean():null}return M}(h))}S1.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var s=this._pbf.readVarint()+this._pbf.pos;return new K0(this._pbf,s,this.extent,this._keys,this._values)};var tl=Y0;function zd(c,s,h){if(c===3){var v=new tl(h,h.readVarint()+h.pos);v.length&&(s[v.name]=v)}}sh.VectorTile=function(c,s){this.layers=c.readFields(zd,{},s)},sh.VectorTileFeature=H0,sh.VectorTileLayer=Y0;const Js=sh.VectorTileFeature.types,Ca=Math.pow(2,13);function $h(c,s,h,v,M,k,L,V){c.emplaceBack(s,h,2*Math.floor(v*Ca)+L,M*Ca*2,k*Ca*2,Math.round(V))}class oo{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Yr,this.centroidVertexArray=new ir,this.indexArray=new Qo,this.programConfigurations=new kt(s.layers,s.zoom),this.segments=new d,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,v){this.features=[],this.hasPattern=Pd("fill-extrusion",this.layers,h);for(const{feature:M,id:k,index:L,sourceLayerIndex:V}of s){const Z=this.layers[0]._featureFilter.needGeometry,J=ei(M,Z);if(!this.layers[0]._featureFilter.filter(new Cn(this.zoom),J,v))continue;const se={id:k,sourceLayerIndex:V,index:L,geometry:Z?J.geometry:Ct(M),properties:M.properties,type:M.type,patterns:{}};this.hasPattern?this.features.push(xu("fill-extrusion",this.layers,se,this.zoom,h)):this.addFeature(se,se.geometry,L,v,{}),h.featureIndex.insert(M,se.geometry,L,V,this.index,!0)}}addFeatures(s,h,v){for(const M of this.features){const{geometry:k}=M;this.addFeature(M,k,M.index,h,v)}}update(s,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,h,this.stateDependentLayers,v)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Q2),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,J2.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,h,v,M,k){const L={x:0,y:0,vertexCount:0};for(const V of bp(h,500)){let Z=0;for(const Se of V)Z+=Se.length;let J=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Se of V){if(Se.length===0||Dd(Se))continue;let Qe=0;for(let Xe=0;Xe<Se.length;Xe++){const Et=Se[Xe];if(Xe>=1){const Gt=Se[Xe-1];if(!em(Et,Gt)){J.vertexLength+4>d.MAX_VERTEX_ARRAY_LENGTH&&(J=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const wt=Et.sub(Gt)._perp()._unit(),Ut=Gt.dist(Et);Qe+Ut>32768&&(Qe=0),$h(this.layoutVertexArray,Et.x,Et.y,wt.x,wt.y,0,0,Qe),$h(this.layoutVertexArray,Et.x,Et.y,wt.x,wt.y,0,1,Qe),L.x+=2*Et.x,L.y+=2*Et.y,L.vertexCount+=2,Qe+=Ut,$h(this.layoutVertexArray,Gt.x,Gt.y,wt.x,wt.y,0,0,Qe),$h(this.layoutVertexArray,Gt.x,Gt.y,wt.x,wt.y,0,1,Qe),L.x+=2*Gt.x,L.y+=2*Gt.y,L.vertexCount+=2;const ai=J.vertexLength;this.indexArray.emplaceBack(ai,ai+2,ai+1),this.indexArray.emplaceBack(ai+1,ai+2,ai+3),J.vertexLength+=4,J.primitiveLength+=2}}}}if(J.vertexLength+Z>d.MAX_VERTEX_ARRAY_LENGTH&&(J=this.segments.prepareSegment(Z,this.layoutVertexArray,this.indexArray)),Js[s.type]!=="Polygon")continue;const se=[],ue=[],xe=J.vertexLength;for(const Se of V)if(Se.length!==0){Se!==V[0]&&ue.push(se.length/2);for(let Qe=0;Qe<Se.length;Qe++){const Xe=Se[Qe];$h(this.layoutVertexArray,Xe.x,Xe.y,0,0,1,1,0),L.x+=Xe.x,L.y+=Xe.y,L.vertexCount+=1,se.push(Xe.x),se.push(Xe.y)}}const Te=Nh.exports(se,ue);for(let Se=0;Se<Te.length;Se+=3)this.indexArray.emplaceBack(xe+Te[Se],xe+Te[Se+2],xe+Te[Se+1]);J.primitiveLength+=Te.length/3,J.vertexLength+=Z}for(let V=0;V<L.vertexCount;V++)this.centroidVertexArray.emplaceBack(Math.floor(L.x/L.vertexCount),Math.floor(L.y/L.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,v,k,M)}}function em(c,s){return c.x===s.x&&(c.x<0||c.x>Zt)||c.y===s.y&&(c.y<0||c.y>Zt)}function Dd(c){return c.every(s=>s.x<0)||c.every(s=>s.x>Zt)||c.every(s=>s.y<0)||c.every(s=>s.y>Zt)}Gi("FillExtrusionBucket",oo,{omit:["layers","features"]});var oc={paint:new ho({"fill-extrusion-opacity":new Ji(qt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new dr(qt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ji(qt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ji(qt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new El(qt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new dr(qt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new dr(qt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ji(qt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Ld(c,s){return c.x*s.x+c.y*s.y}function tm(c,s){if(c.length===1){let h=0;const v=s[h++];let M;for(;!M||v.equals(M);)if(M=s[h++],!M)return 1/0;for(;h<s.length;h++){const k=s[h],L=c[0],V=M.sub(v),Z=k.sub(v),J=L.sub(v),se=Ld(V,V),ue=Ld(V,Z),xe=Ld(Z,Z),Te=Ld(J,V),Se=Ld(J,Z),Qe=se*xe-ue*ue,Xe=(xe*Te-ue*Se)/Qe,Et=(se*Se-ue*Te)/Qe,Gt=v.z*(1-Xe-Et)+M.z*Xe+k.z*Et;if(isFinite(Gt))return Gt}return 1/0}{let h=1/0;for(const v of s)h=Math.min(h,v.z);return h}}const im=no([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:rm}=im,Zh=no([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:nm}=Zh,om=sh.VectorTileFeature.types,sm=Math.cos(Math.PI/180*37.5),J0=Math.pow(2,14)/.5;class Q0{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new Jr,this.layoutVertexArray2=new dn,this.indexArray=new Qo,this.programConfigurations=new kt(s.layers,s.zoom),this.segments=new d,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,v){this.hasPattern=Pd("line",this.layers,h);const M=this.layers[0].layout.get("line-sort-key"),k=!M.isConstant(),L=[];for(const{feature:V,id:Z,index:J,sourceLayerIndex:se}of s){const ue=this.layers[0]._featureFilter.needGeometry,xe=ei(V,ue);if(!this.layers[0]._featureFilter.filter(new Cn(this.zoom),xe,v))continue;const Te=k?M.evaluate(xe,{},v):void 0,Se={id:Z,properties:V.properties,type:V.type,sourceLayerIndex:se,index:J,geometry:ue?xe.geometry:Ct(V),patterns:{},sortKey:Te};L.push(Se)}k&&L.sort((V,Z)=>V.sortKey-Z.sortKey);for(const V of L){const{geometry:Z,index:J,sourceLayerIndex:se}=V;if(this.hasPattern){const ue=xu("line",this.layers,V,this.zoom,h);this.patternFeatures.push(ue)}else this.addFeature(V,Z,J,v,{});h.featureIndex.insert(s[J].feature,Z,J,se,this.index)}}update(s,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,h,this.stateDependentLayers,v)}addFeatures(s,h,v){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,h,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,nm)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,rm),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,h,v,M,k){const L=this.layers[0].layout,V=L.get("line-join").evaluate(s,{}),Z=L.get("line-cap"),J=L.get("line-miter-limit"),se=L.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const ue of h)this.addLine(ue,s,V,Z,J,se);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,v,k,M)}addLine(s,h,v,M,k,L){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Et=0;Et<s.length-1;Et++)this.totalDistance+=s[Et].dist(s[Et+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const V=om[h.type]==="Polygon";let Z=s.length;for(;Z>=2&&s[Z-1].equals(s[Z-2]);)Z--;let J=0;for(;J<Z-1&&s[J].equals(s[J+1]);)J++;if(Z<(V?3:2))return;v==="bevel"&&(k=1.05);const se=this.overscaling<=16?122880/(512*this.overscaling):0,ue=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray);let xe,Te,Se,Qe,Xe;this.e1=this.e2=-1,V&&(xe=s[Z-2],Xe=s[J].sub(xe)._unit()._perp());for(let Et=J;Et<Z;Et++){if(Se=Et===Z-1?V?s[J+1]:void 0:s[Et+1],Se&&s[Et].equals(Se))continue;Xe&&(Qe=Xe),xe&&(Te=xe),xe=s[Et],Xe=Se?Se.sub(xe)._unit()._perp():Qe,Qe=Qe||Xe;let Gt=Qe.add(Xe);Gt.x===0&&Gt.y===0||Gt._unit();const wt=Qe.x*Xe.x+Qe.y*Xe.y,Ut=Gt.x*Xe.x+Gt.y*Xe.y,ai=Ut!==0?1/Ut:1/0,li=2*Math.sqrt(2-2*Ut),Hi=Ut<sm&&Te&&Se,tr=Qe.x*Xe.y-Qe.y*Xe.x>0;if(Hi&&Et>J){const zi=xe.dist(Te);if(zi>2*se){const $i=xe.sub(xe.sub(Te)._mult(se/zi)._round());this.updateDistance(Te,$i),this.addCurrentVertex($i,Qe,0,0,ue),Te=$i}}const Vi=Te&&Se;let Li=Vi?v:V?"butt":M;if(Vi&&Li==="round"&&(ai<L?Li="miter":ai<=2&&(Li="fakeround")),Li==="miter"&&ai>k&&(Li="bevel"),Li==="bevel"&&(ai>2&&(Li="flipbevel"),ai<k&&(Li="miter")),Te&&this.updateDistance(Te,xe),Li==="miter")Gt._mult(ai),this.addCurrentVertex(xe,Gt,0,0,ue);else if(Li==="flipbevel"){if(ai>100)Gt=Xe.mult(-1);else{const zi=ai*Qe.add(Xe).mag()/Qe.sub(Xe).mag();Gt._perp()._mult(zi*(tr?-1:1))}this.addCurrentVertex(xe,Gt,0,0,ue),this.addCurrentVertex(xe,Gt.mult(-1),0,0,ue)}else if(Li==="bevel"||Li==="fakeround"){const zi=-Math.sqrt(ai*ai-1),$i=tr?zi:0,Ni=tr?0:zi;if(Te&&this.addCurrentVertex(xe,Qe,$i,Ni,ue),Li==="fakeround"){const bi=Math.round(180*li/Math.PI/20);for(let ar=1;ar<bi;ar++){let nr=ar/bi;if(nr!==.5){const jn=nr-.5;nr+=nr*jn*(nr-1)*((1.0904+wt*(wt*(3.55645-1.43519*wt)-3.2452))*jn*jn+(.848013+wt*(.215638*wt-1.06021)))}const zr=Xe.sub(Qe)._mult(nr)._add(Qe)._unit()._mult(tr?-1:1);this.addHalfVertex(xe,zr.x,zr.y,!1,tr,0,ue)}}Se&&this.addCurrentVertex(xe,Xe,-$i,-Ni,ue)}else if(Li==="butt")this.addCurrentVertex(xe,Gt,0,0,ue);else if(Li==="square"){const zi=Te?1:-1;this.addCurrentVertex(xe,Gt,zi,zi,ue)}else Li==="round"&&(Te&&(this.addCurrentVertex(xe,Qe,0,0,ue),this.addCurrentVertex(xe,Qe,1,1,ue,!0)),Se&&(this.addCurrentVertex(xe,Xe,-1,-1,ue,!0),this.addCurrentVertex(xe,Xe,0,0,ue)));if(Hi&&Et<Z-1){const zi=xe.dist(Se);if(zi>2*se){const $i=xe.add(Se.sub(xe)._mult(se/zi)._round());this.updateDistance(xe,$i),this.addCurrentVertex($i,Xe,0,0,ue),xe=$i}}}}addCurrentVertex(s,h,v,M,k,L=!1){const V=h.y*M-h.x,Z=-h.y-h.x*M;this.addHalfVertex(s,h.x+h.y*v,h.y-h.x*v,L,!1,v,k),this.addHalfVertex(s,V,Z,L,!0,-M,k),this.distance>J0/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(s,h,v,M,k,L))}addHalfVertex({x:s,y:h},v,M,k,L,V,Z){const J=.5*(this.lineClips?this.scaledDistance*(J0-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(k?1:0),(h<<1)+(L?1:0),Math.round(63*v)+128,Math.round(63*M)+128,1+(V===0?0:V<0?-1:1)|(63&J)<<2,J>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const se=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,se),Z.primitiveLength++),L?this.e2=se:this.e1=se}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,h){this.distance+=s.dist(h),this.updateScaledDistance()}}Gi("LineBucket",Q0,{omit:["layers","patternFeatures"]});const j5=new ho({"line-cap":new Ji(qt.layout_line["line-cap"]),"line-join":new dr(qt.layout_line["line-join"]),"line-miter-limit":new Ji(qt.layout_line["line-miter-limit"]),"line-round-limit":new Ji(qt.layout_line["line-round-limit"]),"line-sort-key":new dr(qt.layout_line["line-sort-key"])});var ef={paint:new ho({"line-opacity":new dr(qt.paint_line["line-opacity"]),"line-color":new dr(qt.paint_line["line-color"]),"line-translate":new Ji(qt.paint_line["line-translate"]),"line-translate-anchor":new Ji(qt.paint_line["line-translate-anchor"]),"line-width":new dr(qt.paint_line["line-width"]),"line-gap-width":new dr(qt.paint_line["line-gap-width"]),"line-offset":new dr(qt.paint_line["line-offset"]),"line-blur":new dr(qt.paint_line["line-blur"]),"line-dasharray":new Rc(qt.paint_line["line-dasharray"]),"line-pattern":new El(qt.paint_line["line-pattern"]),"line-gradient":new Ha(qt.paint_line["line-gradient"])}),layout:j5};const tf=new class extends dr{possiblyEvaluate(c,s){return s=new Cn(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(c,s)}evaluate(c,s,h,v){return s=lt({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(c,s,h,v)}}(ef.paint.properties["line-width"].specification);function M1(c,s){return s>0?s+2*c:c}tf.useIntegerZoom=!0;const rf=no([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nf=no([{name:"a_projected_pos",components:3,type:"Float32"}],4);no([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const of=no([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);no([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Os=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sf=no([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function am(c,s,h){return c.sections.forEach(v=>{v.text=function(M,k,L){const V=k.layout.get("text-transform").evaluate(L,{});return V==="uppercase"?M=M.toLocaleUpperCase():V==="lowercase"&&(M=M.toLocaleLowerCase()),Jo.applyArabicShaping&&(M=Jo.applyArabicShaping(M)),M}(v.text,s,h)}),c}no([{name:"triangle",components:3,type:"Uint16"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),no([{type:"Float32",name:"offsetX"}]),no([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Ia={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var cs=24,bu=Hr,C1=function(c,s,h,v,M){var k,L,V=8*M-v-1,Z=(1<<V)-1,J=Z>>1,se=-7,ue=h?M-1:0,xe=h?-1:1,Te=c[s+ue];for(ue+=xe,k=Te&(1<<-se)-1,Te>>=-se,se+=V;se>0;k=256*k+c[s+ue],ue+=xe,se-=8);for(L=k&(1<<-se)-1,k>>=-se,se+=v;se>0;L=256*L+c[s+ue],ue+=xe,se-=8);if(k===0)k=1-J;else{if(k===Z)return L?NaN:1/0*(Te?-1:1);L+=Math.pow(2,v),k-=J}return(Te?-1:1)*L*Math.pow(2,k-v)},il=function(c,s,h,v,M,k){var L,V,Z,J=8*k-M-1,se=(1<<J)-1,ue=se>>1,xe=M===23?Math.pow(2,-24)-Math.pow(2,-77):0,Te=v?0:k-1,Se=v?1:-1,Qe=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(V=isNaN(s)?1:0,L=se):(L=Math.floor(Math.log(s)/Math.LN2),s*(Z=Math.pow(2,-L))<1&&(L--,Z*=2),(s+=L+ue>=1?xe/Z:xe*Math.pow(2,1-ue))*Z>=2&&(L++,Z/=2),L+ue>=se?(V=0,L=se):L+ue>=1?(V=(s*Z-1)*Math.pow(2,M),L+=ue):(V=s*Math.pow(2,ue-1)*Math.pow(2,M),L=0));M>=8;c[h+Te]=255&V,Te+=Se,V/=256,M-=8);for(L=L<<M|V,J+=M;J>0;c[h+Te]=255&L,Te+=Se,L/=256,J-=8);c[h+Te-Se]|=128*Qe};function Hr(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Hr.Varint=0,Hr.Fixed64=1,Hr.Bytes=2,Hr.Fixed32=5;var ah,I1=4294967296,af=1/I1,lm=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function sc(c){return c.type===Hr.Bytes?c.readVarint()+c.pos:c.pos+1}function pa(c,s,h){return h?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function lh(c,s,h){var v=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));h.realloc(v);for(var M=h.pos-1;M>=c;M--)h.buf[M+v]=h.buf[M]}function cm(c,s){for(var h=0;h<c.length;h++)s.writeVarint(c[h])}function um(c,s){for(var h=0;h<c.length;h++)s.writeSVarint(c[h])}function G5(c,s){for(var h=0;h<c.length;h++)s.writeFloat(c[h])}function Tp(c,s){for(var h=0;h<c.length;h++)s.writeDouble(c[h])}function lf(c,s){for(var h=0;h<c.length;h++)s.writeBoolean(c[h])}function A1(c,s){for(var h=0;h<c.length;h++)s.writeFixed32(c[h])}function P1(c,s){for(var h=0;h<c.length;h++)s.writeSFixed32(c[h])}function Rd(c,s){for(var h=0;h<c.length;h++)s.writeFixed64(c[h])}function Ep(c,s){for(var h=0;h<c.length;h++)s.writeSFixed64(c[h])}function Bd(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+16777216*c[s+3]}function Nc(c,s,h){c[h]=s,c[h+1]=s>>>8,c[h+2]=s>>>16,c[h+3]=s>>>24}function Sp(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+(c[s+3]<<24)}function hm(c,s,h){c===1&&h.readMessage(k1,s)}function k1(c,s,h){if(c===3){const{id:v,bitmap:M,width:k,height:L,left:V,top:Z,advance:J}=h.readMessage(dm,{});s.push({id:v,bitmap:new v1({width:k+6,height:L+6},M),metrics:{width:k,height:L,left:V,top:Z,advance:J}})}}function dm(c,s,h){c===1?s.id=h.readVarint():c===2?s.bitmap=h.readBytes():c===3?s.width=h.readVarint():c===4?s.height=h.readVarint():c===5?s.left=h.readSVarint():c===6?s.top=h.readSVarint():c===7&&(s.advance=h.readVarint())}function Mp(c){let s=0,h=0;for(const L of c)s+=L.w*L.h,h=Math.max(h,L.w);c.sort((L,V)=>V.h-L.h);const v=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),h),h:1/0}];let M=0,k=0;for(const L of c)for(let V=v.length-1;V>=0;V--){const Z=v[V];if(!(L.w>Z.w||L.h>Z.h)){if(L.x=Z.x,L.y=Z.y,k=Math.max(k,L.y+L.h),M=Math.max(M,L.x+L.w),L.w===Z.w&&L.h===Z.h){const J=v.pop();V<v.length&&(v[V]=J)}else L.h===Z.h?(Z.x+=L.w,Z.w-=L.w):L.w===Z.w?(Z.y+=L.h,Z.h-=L.h):(v.push({x:Z.x+L.w,y:Z.y,w:Z.w-L.w,h:L.h}),Z.y+=L.h,Z.h-=L.h);break}}return{w:M,h:k,fill:s/(M*k)||0}}Hr.prototype={destroy:function(){this.buf=null},readFields:function(c,s,h){for(h=h||this.length;this.pos<h;){var v=this.readVarint(),M=v>>3,k=this.pos;this.type=7&v,c(M,s,this),this.pos===k&&this.skip(v)}return s},readMessage:function(c,s){return this.readFields(c,s,this.readVarint()+this.pos)},readFixed32:function(){var c=Bd(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=Sp(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=Bd(this.buf,this.pos)+Bd(this.buf,this.pos+4)*I1;return this.pos+=8,c},readSFixed64:function(){var c=Bd(this.buf,this.pos)+Sp(this.buf,this.pos+4)*I1;return this.pos+=8,c},readFloat:function(){var c=C1(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=C1(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var s,h,v=this.buf;return s=127&(h=v[this.pos++]),h<128?s:(s|=(127&(h=v[this.pos++]))<<7,h<128?s:(s|=(127&(h=v[this.pos++]))<<14,h<128?s:(s|=(127&(h=v[this.pos++]))<<21,h<128?s:function(M,k,L){var V,Z,J=L.buf;if(V=(112&(Z=J[L.pos++]))>>4,Z<128||(V|=(127&(Z=J[L.pos++]))<<3,Z<128)||(V|=(127&(Z=J[L.pos++]))<<10,Z<128)||(V|=(127&(Z=J[L.pos++]))<<17,Z<128)||(V|=(127&(Z=J[L.pos++]))<<24,Z<128)||(V|=(1&(Z=J[L.pos++]))<<31,Z<128))return pa(M,V,k);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(h=v[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,s=this.pos;return this.pos=c,c-s>=12&&lm?function(h,v,M){return lm.decode(h.subarray(v,M))}(this.buf,s,c):function(h,v,M){for(var k="",L=v;L<M;){var V,Z,J,se=h[L],ue=null,xe=se>239?4:se>223?3:se>191?2:1;if(L+xe>M)break;xe===1?se<128&&(ue=se):xe===2?(192&(V=h[L+1]))==128&&(ue=(31&se)<<6|63&V)<=127&&(ue=null):xe===3?(Z=h[L+2],(192&(V=h[L+1]))==128&&(192&Z)==128&&((ue=(15&se)<<12|(63&V)<<6|63&Z)<=2047||ue>=55296&&ue<=57343)&&(ue=null)):xe===4&&(Z=h[L+2],J=h[L+3],(192&(V=h[L+1]))==128&&(192&Z)==128&&(192&J)==128&&((ue=(15&se)<<18|(63&V)<<12|(63&Z)<<6|63&J)<=65535||ue>=1114112)&&(ue=null)),ue===null?(ue=65533,xe=1):ue>65535&&(ue-=65536,k+=String.fromCharCode(ue>>>10&1023|55296),ue=56320|1023&ue),k+=String.fromCharCode(ue),L+=xe}return k}(this.buf,s,c)},readBytes:function(){var c=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,c);return this.pos=c,s},readPackedVarint:function(c,s){if(this.type!==Hr.Bytes)return c.push(this.readVarint(s));var h=sc(this);for(c=c||[];this.pos<h;)c.push(this.readVarint(s));return c},readPackedSVarint:function(c){if(this.type!==Hr.Bytes)return c.push(this.readSVarint());var s=sc(this);for(c=c||[];this.pos<s;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Hr.Bytes)return c.push(this.readBoolean());var s=sc(this);for(c=c||[];this.pos<s;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Hr.Bytes)return c.push(this.readFloat());var s=sc(this);for(c=c||[];this.pos<s;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Hr.Bytes)return c.push(this.readDouble());var s=sc(this);for(c=c||[];this.pos<s;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Hr.Bytes)return c.push(this.readFixed32());var s=sc(this);for(c=c||[];this.pos<s;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Hr.Bytes)return c.push(this.readSFixed32());var s=sc(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Hr.Bytes)return c.push(this.readFixed64());var s=sc(this);for(c=c||[];this.pos<s;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Hr.Bytes)return c.push(this.readSFixed64());var s=sc(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed64());return c},skip:function(c){var s=7&c;if(s===Hr.Varint)for(;this.buf[this.pos++]>127;);else if(s===Hr.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Hr.Fixed32)this.pos+=4;else{if(s!==Hr.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(c,s){this.writeVarint(c<<3|s)},realloc:function(c){for(var s=this.length||16;s<this.pos+c;)s*=2;if(s!==this.length){var h=new Uint8Array(s);h.set(this.buf),this.buf=h,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),Nc(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),Nc(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),Nc(this.buf,-1&c,this.pos),Nc(this.buf,Math.floor(c*af),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),Nc(this.buf,-1&c,this.pos),Nc(this.buf,Math.floor(c*af),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(s,h){var v,M;if(s>=0?(v=s%4294967296|0,M=s/4294967296|0):(M=~(-s/4294967296),4294967295^(v=~(-s%4294967296))?v=v+1|0:(v=0,M=M+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(k,L,V){V.buf[V.pos++]=127&k|128,k>>>=7,V.buf[V.pos++]=127&k|128,k>>>=7,V.buf[V.pos++]=127&k|128,k>>>=7,V.buf[V.pos++]=127&k|128,V.buf[V.pos]=127&(k>>>=7)}(v,0,h),function(k,L){var V=(7&k)<<4;L.buf[L.pos++]|=V|((k>>>=3)?128:0),k&&(L.buf[L.pos++]=127&k|((k>>>=7)?128:0),k&&(L.buf[L.pos++]=127&k|((k>>>=7)?128:0),k&&(L.buf[L.pos++]=127&k|((k>>>=7)?128:0),k&&(L.buf[L.pos++]=127&k|((k>>>=7)?128:0),k&&(L.buf[L.pos++]=127&k)))))}(M,h)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var s=this.pos;this.pos=function(v,M,k){for(var L,V,Z=0;Z<M.length;Z++){if((L=M.charCodeAt(Z))>55295&&L<57344){if(!V){L>56319||Z+1===M.length?(v[k++]=239,v[k++]=191,v[k++]=189):V=L;continue}if(L<56320){v[k++]=239,v[k++]=191,v[k++]=189,V=L;continue}L=V-55296<<10|L-56320|65536,V=null}else V&&(v[k++]=239,v[k++]=191,v[k++]=189,V=null);L<128?v[k++]=L:(L<2048?v[k++]=L>>6|192:(L<65536?v[k++]=L>>12|224:(v[k++]=L>>18|240,v[k++]=L>>12&63|128),v[k++]=L>>6&63|128),v[k++]=63&L|128)}return k}(this.buf,c,this.pos);var h=this.pos-s;h>=128&&lh(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h},writeFloat:function(c){this.realloc(4),il(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),il(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var s=c.length;this.writeVarint(s),this.realloc(s);for(var h=0;h<s;h++)this.buf[this.pos++]=c[h]},writeRawMessage:function(c,s){this.pos++;var h=this.pos;c(s,this);var v=this.pos-h;v>=128&&lh(h,v,this),this.pos=h-1,this.writeVarint(v),this.pos+=v},writeMessage:function(c,s,h){this.writeTag(c,Hr.Bytes),this.writeRawMessage(s,h)},writePackedVarint:function(c,s){s.length&&this.writeMessage(c,cm,s)},writePackedSVarint:function(c,s){s.length&&this.writeMessage(c,um,s)},writePackedBoolean:function(c,s){s.length&&this.writeMessage(c,lf,s)},writePackedFloat:function(c,s){s.length&&this.writeMessage(c,G5,s)},writePackedDouble:function(c,s){s.length&&this.writeMessage(c,Tp,s)},writePackedFixed32:function(c,s){s.length&&this.writeMessage(c,A1,s)},writePackedSFixed32:function(c,s){s.length&&this.writeMessage(c,P1,s)},writePackedFixed64:function(c,s){s.length&&this.writeMessage(c,Rd,s)},writePackedSFixed64:function(c,s){s.length&&this.writeMessage(c,Ep,s)},writeBytesField:function(c,s){this.writeTag(c,Hr.Bytes),this.writeBytes(s)},writeFixed32Field:function(c,s){this.writeTag(c,Hr.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(c,s){this.writeTag(c,Hr.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(c,s){this.writeTag(c,Hr.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(c,s){this.writeTag(c,Hr.Fixed64),this.writeSFixed64(s)},writeVarintField:function(c,s){this.writeTag(c,Hr.Varint),this.writeVarint(s)},writeSVarintField:function(c,s){this.writeTag(c,Hr.Varint),this.writeSVarint(s)},writeStringField:function(c,s){this.writeTag(c,Hr.Bytes),this.writeString(s)},writeFloatField:function(c,s){this.writeTag(c,Hr.Fixed32),this.writeFloat(s)},writeDoubleField:function(c,s){this.writeTag(c,Hr.Fixed64),this.writeDouble(s)},writeBooleanField:function(c,s){this.writeVarintField(c,!!s)}};class Cp{constructor(s,{pixelRatio:h,version:v,stretchX:M,stretchY:k,content:L}){this.paddedRect=s,this.pixelRatio=h,this.stretchX=M,this.stretchY=k,this.content=L,this.version=v}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class pm{constructor(s,h){const v={},M={};this.haveRenderCallbacks=[];const k=[];this.addImages(s,v,k),this.addImages(h,M,k);const{w:L,h:V}=Mp(k),Z=new Ja({width:L||1,height:V||1});for(const J in s){const se=s[J],ue=v[J].paddedRect;Ja.copy(se.data,Z,{x:0,y:0},{x:ue.x+1,y:ue.y+1},se.data)}for(const J in h){const se=h[J],ue=M[J].paddedRect,xe=ue.x+1,Te=ue.y+1,Se=se.data.width,Qe=se.data.height;Ja.copy(se.data,Z,{x:0,y:0},{x:xe,y:Te},se.data),Ja.copy(se.data,Z,{x:0,y:Qe-1},{x:xe,y:Te-1},{width:Se,height:1}),Ja.copy(se.data,Z,{x:0,y:0},{x:xe,y:Te+Qe},{width:Se,height:1}),Ja.copy(se.data,Z,{x:Se-1,y:0},{x:xe-1,y:Te},{width:1,height:Qe}),Ja.copy(se.data,Z,{x:0,y:0},{x:xe+Se,y:Te},{width:1,height:Qe})}this.image=Z,this.iconPositions=v,this.patternPositions=M}addImages(s,h,v){for(const M in s){const k=s[M],L={x:0,y:0,w:k.data.width+2,h:k.data.height+2};v.push(L),h[M]=new Cp(L,k),k.hasRenderCallback&&this.haveRenderCallbacks.push(M)}}patchUpdatedImages(s,h){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const v in s.updatedImages)this.patchUpdatedImage(this.iconPositions[v],s.getImage(v),h),this.patchUpdatedImage(this.patternPositions[v],s.getImage(v),h)}patchUpdatedImage(s,h,v){if(!s||!h||s.version===h.version)return;s.version=h.version;const[M,k]=s.tl;v.update(h.data,void 0,{x:M,y:k})}}Gi("ImagePosition",Cp),Gi("ImageAtlas",pm),t.WritingMode=void 0,(ah=t.WritingMode||(t.WritingMode={}))[ah.none=0]="none",ah[ah.horizontal=1]="horizontal",ah[ah.vertical=2]="vertical",ah[ah.horizontalOnly=3]="horizontalOnly";const Ip=-17;class wu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,h){const v=new wu;return v.scale=s||1,v.fontStack=h,v}static forImage(s){const h=new wu;return h.imageName=s,h}}class qh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,h){const v=new qh;for(let M=0;M<s.sections.length;M++){const k=s.sections[M];k.image?v.addImageSection(k):v.addTextSection(k,h)}return v}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let h="";for(let v=0;v<s.length;v++){const M=s.charCodeAt(v+1)||null,k=s.charCodeAt(v-1)||null;h+=M&&pu(M)&&!Ia[s[v+1]]||k&&pu(k)&&!Ia[s[v-1]]||!Ia[s[v]]?s[v]:Ia[s[v]]}return h}(this.text)}trim(){let s=0;for(let v=0;v<this.text.length&&gn[this.text.charCodeAt(v)];v++)s++;let h=this.text.length;for(let v=this.text.length-1;v>=0&&v>=s&&gn[this.text.charCodeAt(v)];v--)h--;this.text=this.text.substring(s,h),this.sectionIndex=this.sectionIndex.slice(s,h)}substring(s,h){const v=new qh;return v.text=this.text.substring(s,h),v.sectionIndex=this.sectionIndex.slice(s,h),v.sections=this.sections,v}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,h)=>Math.max(s,this.sections[h].scale),0)}addTextSection(s,h){this.text+=s.text,this.sections.push(wu.forText(s.scale,s.fontStack||h));const v=this.sections.length-1;for(let M=0;M<s.text.length;++M)this.sectionIndex.push(v)}addImageSection(s){const h=s.image?s.image.name:"";if(h.length===0)return void St("Can't add FormattedSection with an empty image.");const v=this.getNextImageSectionCharCode();v?(this.text+=String.fromCharCode(v),this.sections.push(wu.forImage(h)),this.sectionIndex.push(this.sections.length-1)):St("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ac(c,s,h,v,M,k,L,V,Z,J,se,ue,xe,Te,Se,Qe){const Xe=qh.fromFeature(c,M);let Et;ue===t.WritingMode.vertical&&Xe.verticalizePunctuation();const{processBidirectionalText:Gt,processStyledBidirectionalText:wt}=Jo;if(Gt&&Xe.sections.length===1){Et=[];const li=Gt(Xe.toString(),Ap(Xe,J,k,s,v,Te,Se));for(const Hi of li){const tr=new qh;tr.text=Hi,tr.sections=Xe.sections;for(let Vi=0;Vi<Hi.length;Vi++)tr.sectionIndex.push(0);Et.push(tr)}}else if(wt){Et=[];const li=wt(Xe.text,Xe.sectionIndex,Ap(Xe,J,k,s,v,Te,Se));for(const Hi of li){const tr=new qh;tr.text=Hi[0],tr.sectionIndex=Hi[1],tr.sections=Xe.sections,Et.push(tr)}}else Et=function(li,Hi){const tr=[],Vi=li.text;let Li=0;for(const zi of Hi)tr.push(li.substring(Li,zi)),Li=zi;return Li<Vi.length&&tr.push(li.substring(Li,Vi.length)),tr}(Xe,Ap(Xe,J,k,s,v,Te,Se));const Ut=[],ai={positionedLines:Ut,text:Xe.toString(),top:se[1],bottom:se[1],left:se[0],right:se[0],writingMode:ue,iconsInText:!1,verticalizable:!1};return function(li,Hi,tr,Vi,Li,zi,$i,Ni,bi,ar,nr,zr){let jn=0,Yn=Ip,So=0,Pa=0;const hs=Ni==="right"?1:Ni==="left"?0:.5;let xo=0;for(const vo of Li){vo.trim();const Bo=vo.getMaxScale(),Ps=(Bo-1)*cs,Ln={positionedGlyphs:[],lineOffset:0};li.positionedLines[xo]=Ln;const ps=Ln.positionedGlyphs;let ts=0;if(!vo.length()){Yn+=zi,++xo;continue}for(let Fo=0;Fo<vo.length();Fo++){const Xr=vo.getSection(Fo),ka=vo.getSectionIndex(Fo),ks=vo.getCharCode(Fo);let Ns=0,Al=null,hc=null,dc=null,Pl=cs;const kl=!(bi===t.WritingMode.horizontal||!nr&&!vl(ks)||nr&&(gn[ks]||(Ro=ks,Pi.Arabic(Ro)||Pi["Arabic Supplement"](Ro)||Pi["Arabic Extended-A"](Ro)||Pi["Arabic Presentation Forms-A"](Ro)||Pi["Arabic Presentation Forms-B"](Ro))));if(Xr.imageName){const za=Vi[Xr.imageName];if(!za)continue;dc=Xr.imageName,li.iconsInText=li.iconsInText||!0,hc=za.paddedRect;const ea=za.displaySize;Xr.scale=Xr.scale*cs/zr,Al={width:ea[0],height:ea[1],left:1,top:-3,advance:kl?ea[1]:ea[0]},Ns=Ps+(cs-ea[1]*Xr.scale),Pl=Al.advance;const Gc=kl?ea[0]*Xr.scale-cs*Bo:ea[1]*Xr.scale-cs*Bo;Gc>0&&Gc>ts&&(ts=Gc)}else{const za=tr[Xr.fontStack],ea=za&&za[ks];if(ea&&ea.rect)hc=ea.rect,Al=ea.metrics;else{const Gc=Hi[Xr.fontStack],jd=Gc&&Gc[ks];if(!jd)continue;Al=jd.metrics}Ns=(Bo-Xr.scale)*cs}kl?(li.verticalizable=!0,ps.push({glyph:ks,imageName:dc,x:jn,y:Yn+Ns,vertical:kl,scale:Xr.scale,fontStack:Xr.fontStack,sectionIndex:ka,metrics:Al,rect:hc}),jn+=Pl*Xr.scale+ar):(ps.push({glyph:ks,imageName:dc,x:jn,y:Yn+Ns,vertical:kl,scale:Xr.scale,fontStack:Xr.fontStack,sectionIndex:ka,metrics:Al,rect:hc}),jn+=Al.advance*Xr.scale+ar)}ps.length!==0&&(So=Math.max(jn-ar,So),fm(ps,0,ps.length-1,hs,ts)),jn=0;const Fn=zi*Bo+ts;Ln.lineOffset=Math.max(ts,Ps),Yn+=Fn,Pa=Math.max(Fn,Pa),++xo}var Ro;const ds=Yn-Ip,{horizontalAlign:Us,verticalAlign:fa}=es($i);(function(vo,Bo,Ps,Ln,ps,ts,Fn,Fo,Xr){const ka=(Bo-Ps)*ps;let ks=0;ks=ts!==Fn?-Fo*Ln-Ip:(-Ln*Xr+.5)*Fn;for(const Ns of vo)for(const Al of Ns.positionedGlyphs)Al.x+=ka,Al.y+=ks})(li.positionedLines,hs,Us,fa,So,Pa,zi,ds,Li.length),li.top+=-fa*ds,li.bottom=li.top+ds,li.left+=-Us*So,li.right=li.left+So}(ai,s,h,v,Et,L,V,Z,ue,J,xe,Qe),!function(li){for(const Hi of li)if(Hi.positionedGlyphs.length!==0)return!1;return!0}(Ut)&&ai}const gn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},cf={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function lc(c,s,h,v,M,k){if(s.imageName){const L=v[s.imageName];return L?L.displaySize[0]*s.scale*cs/k+M:0}{const L=h[s.fontStack],V=L&&L[c];return V?V.metrics.advance*s.scale+M:0}}function cc(c,s,h,v){const M=Math.pow(c-s,2);return v?c<s?M/2:2*M:M+Math.abs(h)*h}function uc(c,s,h){let v=0;return c===10&&(v-=1e4),h&&(v+=150),c!==40&&c!==65288||(v+=50),s!==41&&s!==65289||(v+=50),v}function Aa(c,s,h,v,M,k){let L=null,V=cc(s,h,M,k);for(const Z of v){const J=cc(s-Z.x,h,M,k)+Z.badness;J<=V&&(L=Z,V=J)}return{index:c,x:s,priorBreak:L,badness:V}}function us(c){return c?us(c.priorBreak).concat(c.index):[]}function Ap(c,s,h,v,M,k,L){if(k!=="point")return[];if(!c)return[];const V=[],Z=function(xe,Te,Se,Qe,Xe,Et){let Gt=0;for(let wt=0;wt<xe.length();wt++){const Ut=xe.getSection(wt);Gt+=lc(xe.getCharCode(wt),Ut,Qe,Xe,Te,Et)}return Gt/Math.max(1,Math.ceil(Gt/Se))}(c,s,h,v,M,L),J=c.text.indexOf("​")>=0;let se=0;for(let xe=0;xe<c.length();xe++){const Te=c.getSection(xe),Se=c.getCharCode(xe);if(gn[Se]||(se+=lc(Se,Te,v,M,s,L)),xe<c.length()-1){const Qe=!((ue=Se)<11904||!(Pi["Bopomofo Extended"](ue)||Pi.Bopomofo(ue)||Pi["CJK Compatibility Forms"](ue)||Pi["CJK Compatibility Ideographs"](ue)||Pi["CJK Compatibility"](ue)||Pi["CJK Radicals Supplement"](ue)||Pi["CJK Strokes"](ue)||Pi["CJK Symbols and Punctuation"](ue)||Pi["CJK Unified Ideographs Extension A"](ue)||Pi["CJK Unified Ideographs"](ue)||Pi["Enclosed CJK Letters and Months"](ue)||Pi["Halfwidth and Fullwidth Forms"](ue)||Pi.Hiragana(ue)||Pi["Ideographic Description Characters"](ue)||Pi["Kangxi Radicals"](ue)||Pi["Katakana Phonetic Extensions"](ue)||Pi.Katakana(ue)||Pi["Vertical Forms"](ue)||Pi["Yi Radicals"](ue)||Pi["Yi Syllables"](ue)));(cf[Se]||Qe||Te.imageName)&&V.push(Aa(xe+1,se,Z,V,uc(Se,c.getCharCode(xe+1),Qe&&J),!1))}}var ue;return us(Aa(c.length(),se,Z,V,0,!0))}function es(c){let s=.5,h=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:s,verticalAlign:h}}function fm(c,s,h,v,M){if(!v&&!M)return;const k=c[h],L=(c[h].x+k.metrics.advance*k.scale)*v;for(let V=s;V<=h;V++)c[V].x-=L,c[V].y+=M}function z1(c,s,h){const{horizontalAlign:v,verticalAlign:M}=es(h),k=s[0]-c.displaySize[0]*v,L=s[1]-c.displaySize[1]*M;return{image:c,top:L,bottom:L+c.displaySize[1],left:k,right:k+c.displaySize[0]}}function Pp(c,s,h,v,M,k){const L=c.image;let V;if(L.content){const Xe=L.content,Et=L.pixelRatio||1;V=[Xe[0]/Et,Xe[1]/Et,L.displaySize[0]-Xe[2]/Et,L.displaySize[1]-Xe[3]/Et]}const Z=s.left*k,J=s.right*k;let se,ue,xe,Te;h==="width"||h==="both"?(Te=M[0]+Z-v[3],ue=M[0]+J+v[1]):(Te=M[0]+(Z+J-L.displaySize[0])/2,ue=Te+L.displaySize[0]);const Se=s.top*k,Qe=s.bottom*k;return h==="height"||h==="both"?(se=M[1]+Se-v[0],xe=M[1]+Qe+v[2]):(se=M[1]+(Se+Qe-L.displaySize[1])/2,xe=se+L.displaySize[1]),{image:L,top:se,right:ue,bottom:xe,left:Te,collisionPadding:V}}const Vc=128;function kp(c,s){const{expression:h}=s;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Cn(c+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:v,interpolationType:M}=h;let k=0;for(;k<v.length&&v[k]<=c;)k++;k=Math.max(0,k-1);let L=k;for(;L<v.length&&v[L]<c+1;)L++;L=Math.min(v.length-1,L);const V=v[k],Z=v[L];return h.kind==="composite"?{kind:"composite",minZoom:V,maxZoom:Z,interpolationType:M}:{kind:"camera",minZoom:V,maxZoom:Z,minSize:h.evaluate(new Cn(V)),maxSize:h.evaluate(new Cn(Z)),interpolationType:M}}}class ch extends Mt{constructor(s,h,v,M){super(s,h),this.angle=v,M!==void 0&&(this.segment=M)}clone(){return new ch(this.x,this.y,this.angle,this.segment)}}function zp(c,s,h,v,M){if(s.segment===void 0)return!0;let k=s,L=s.segment+1,V=0;for(;V>-h/2;){if(L--,L<0)return!1;V-=c[L].dist(k),k=c[L]}V+=c[L].dist(c[L+1]),L++;const Z=[];let J=0;for(;V<h/2;){const se=c[L],ue=c[L+1];if(!ue)return!1;let xe=c[L-1].angleTo(se)-se.angleTo(ue);for(xe=Math.abs((xe+3*Math.PI)%(2*Math.PI)-Math.PI),Z.push({distance:V,angleDelta:xe}),J+=xe;V-Z[0].distance>v;)J-=Z.shift().angleDelta;if(J>M)return!1;L++,V+=se.dist(ue)}return!0}function uf(c){let s=0;for(let h=0;h<c.length-1;h++)s+=c[h].dist(c[h+1]);return s}function mm(c,s,h){return c?.6*s*h:0}function jc(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function Wh(c,s,h,v,M,k){const L=mm(h,M,k),V=jc(h,v)*k;let Z=0;const J=uf(c)/2;for(let se=0;se<c.length-1;se++){const ue=c[se],xe=c[se+1],Te=ue.dist(xe);if(Z+Te>J){const Se=(J-Z)/Te,Qe=Bn(ue.x,xe.x,Se),Xe=Bn(ue.y,xe.y,Se),Et=new ch(Qe,Xe,xe.angleTo(ue),se);return Et._round(),!L||zp(c,Et,V,L,s)?Et:void 0}Z+=Te}}function Dp(c,s,h,v,M,k,L,V,Z){const J=mm(v,k,L),se=jc(v,M),ue=se*L,xe=c[0].x===0||c[0].x===Z||c[0].y===0||c[0].y===Z;return s-ue<s/4&&(s=ue+s/4),Fd(c,xe?s/2*V%s:(se/2+2*k)*L*V%s,s,J,h,ue,xe,!1,Z)}function Fd(c,s,h,v,M,k,L,V,Z){const J=k/2,se=uf(c);let ue=0,xe=s-h,Te=[];for(let Se=0;Se<c.length-1;Se++){const Qe=c[Se],Xe=c[Se+1],Et=Qe.dist(Xe),Gt=Xe.angleTo(Qe);for(;xe+h<ue+Et;){xe+=h;const wt=(xe-ue)/Et,Ut=Bn(Qe.x,Xe.x,wt),ai=Bn(Qe.y,Xe.y,wt);if(Ut>=0&&Ut<Z&&ai>=0&&ai<Z&&xe-J>=0&&xe+J<=se){const li=new ch(Ut,ai,Gt,Se);li._round(),v&&!zp(c,li,k,v,M)||Te.push(li)}}ue+=Et}return V||Te.length||L||(Te=Fd(c,ue/2,h,v,M,k,L,!0,Z)),Te}function Lp(c,s,h,v,M){const k=[];for(let L=0;L<c.length;L++){const V=c[L];let Z;for(let J=0;J<V.length-1;J++){let se=V[J],ue=V[J+1];se.x<s&&ue.x<s||(se.x<s?se=new Mt(s,se.y+(s-se.x)/(ue.x-se.x)*(ue.y-se.y))._round():ue.x<s&&(ue=new Mt(s,se.y+(s-se.x)/(ue.x-se.x)*(ue.y-se.y))._round()),se.y<h&&ue.y<h||(se.y<h?se=new Mt(se.x+(h-se.y)/(ue.y-se.y)*(ue.x-se.x),h)._round():ue.y<h&&(ue=new Mt(se.x+(h-se.y)/(ue.y-se.y)*(ue.x-se.x),h)._round()),se.x>=v&&ue.x>=v||(se.x>=v?se=new Mt(v,se.y+(v-se.x)/(ue.x-se.x)*(ue.y-se.y))._round():ue.x>=v&&(ue=new Mt(v,se.y+(v-se.x)/(ue.x-se.x)*(ue.y-se.y))._round()),se.y>=M&&ue.y>=M||(se.y>=M?se=new Mt(se.x+(M-se.y)/(ue.y-se.y)*(ue.x-se.x),M)._round():ue.y>=M&&(ue=new Mt(se.x+(M-se.y)/(ue.y-se.y)*(ue.x-se.x),M)._round()),Z&&se.equals(Z[Z.length-1])||(Z=[se],k.push(Z)),Z.push(ue)))))}}return k}function hf(c,s,h,v){const M=[],k=c.image,L=k.pixelRatio,V=k.paddedRect.w-2,Z=k.paddedRect.h-2,J=c.right-c.left,se=c.bottom-c.top,ue=k.stretchX||[[0,V]],xe=k.stretchY||[[0,Z]],Te=(zi,$i)=>zi+$i[1]-$i[0],Se=ue.reduce(Te,0),Qe=xe.reduce(Te,0),Xe=V-Se,Et=Z-Qe;let Gt=0,wt=Se,Ut=0,ai=Qe,li=0,Hi=Xe,tr=0,Vi=Et;if(k.content&&v){const zi=k.content;Gt=Rp(ue,0,zi[0]),Ut=Rp(xe,0,zi[1]),wt=Rp(ue,zi[0],zi[2]),ai=Rp(xe,zi[1],zi[3]),li=zi[0]-Gt,tr=zi[1]-Ut,Hi=zi[2]-zi[0]-wt,Vi=zi[3]-zi[1]-ai}const Li=(zi,$i,Ni,bi)=>{const ar=Bp(zi.stretch-Gt,wt,J,c.left),nr=D1(zi.fixed-li,Hi,zi.stretch,Se),zr=Bp($i.stretch-Ut,ai,se,c.top),jn=D1($i.fixed-tr,Vi,$i.stretch,Qe),Yn=Bp(Ni.stretch-Gt,wt,J,c.left),So=D1(Ni.fixed-li,Hi,Ni.stretch,Se),Pa=Bp(bi.stretch-Ut,ai,se,c.top),hs=D1(bi.fixed-tr,Vi,bi.stretch,Qe),xo=new Mt(ar,zr),Ro=new Mt(Yn,zr),ds=new Mt(Yn,Pa),Us=new Mt(ar,Pa),fa=new Mt(nr/L,jn/L),vo=new Mt(So/L,hs/L),Bo=s*Math.PI/180;if(Bo){const ps=Math.sin(Bo),ts=Math.cos(Bo),Fn=[ts,-ps,ps,ts];xo._matMult(Fn),Ro._matMult(Fn),Us._matMult(Fn),ds._matMult(Fn)}const Ps=zi.stretch+zi.fixed,Ln=$i.stretch+$i.fixed;return{tl:xo,tr:Ro,bl:Us,br:ds,tex:{x:k.paddedRect.x+1+Ps,y:k.paddedRect.y+1+Ln,w:Ni.stretch+Ni.fixed-Ps,h:bi.stretch+bi.fixed-Ln},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fa,pixelOffsetBR:vo,minFontScaleX:Hi/L/J,minFontScaleY:Vi/L/se,isSDF:h}};if(v&&(k.stretchX||k.stretchY)){const zi=df(ue,Xe,Se),$i=df(xe,Et,Qe);for(let Ni=0;Ni<zi.length-1;Ni++){const bi=zi[Ni],ar=zi[Ni+1];for(let nr=0;nr<$i.length-1;nr++)M.push(Li(bi,$i[nr],ar,$i[nr+1]))}}else M.push(Li({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:V+1},{fixed:0,stretch:Z+1}));return M}function Rp(c,s,h){let v=0;for(const M of c)v+=Math.max(s,Math.min(h,M[1]))-Math.max(s,Math.min(h,M[0]));return v}function df(c,s,h){const v=[{fixed:-1,stretch:0}];for(const[M,k]of c){const L=v[v.length-1];v.push({fixed:M-L.stretch,stretch:L.stretch}),v.push({fixed:M-L.stretch,stretch:L.stretch+(k-M)})}return v.push({fixed:s+1,stretch:h}),v}function Bp(c,s,h,v){return c/s*h+v}function D1(c,s,h,v){return c-s*h/v}Gi("Anchor",ch);class Fp{constructor(s,h,v,M,k,L,V,Z,J,se){if(this.boxStartIndex=s.length,J){let ue=L.top,xe=L.bottom;const Te=L.collisionPadding;Te&&(ue-=Te[1],xe+=Te[3]);let Se=xe-ue;Se>0&&(Se=Math.max(10,Se),this.circleDiameter=Se)}else{let ue=L.top*V-Z[0],xe=L.bottom*V+Z[2],Te=L.left*V-Z[3],Se=L.right*V+Z[1];const Qe=L.collisionPadding;if(Qe&&(Te-=Qe[0]*V,ue-=Qe[1]*V,Se+=Qe[2]*V,xe+=Qe[3]*V),se){const Xe=new Mt(Te,ue),Et=new Mt(Se,ue),Gt=new Mt(Te,xe),wt=new Mt(Se,xe),Ut=se*Math.PI/180;Xe._rotate(Ut),Et._rotate(Ut),Gt._rotate(Ut),wt._rotate(Ut),Te=Math.min(Xe.x,Et.x,Gt.x,wt.x),Se=Math.max(Xe.x,Et.x,Gt.x,wt.x),ue=Math.min(Xe.y,Et.y,Gt.y,wt.y),xe=Math.max(Xe.y,Et.y,Gt.y,wt.y)}s.emplaceBack(h.x,h.y,Te,ue,Se,xe,v,M,k)}this.boxEndIndex=s.length}}class pf{constructor(s=[],h=_m){if(this.data=s,this.length=this.data.length,this.compare=h,this.length>0)for(let v=(this.length>>1)-1;v>=0;v--)this._down(v)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:h,compare:v}=this,M=h[s];for(;s>0;){const k=s-1>>1,L=h[k];if(v(M,L)>=0)break;h[s]=L,s=k}h[s]=M}_down(s){const{data:h,compare:v}=this,M=this.length>>1,k=h[s];for(;s<M;){let L=1+(s<<1),V=h[L];const Z=L+1;if(Z<this.length&&v(h[Z],V)<0&&(L=Z,V=h[Z]),v(V,k)>=0)break;h[s]=V,s=L}h[s]=k}}function _m(c,s){return c<s?-1:c>s?1:0}function gm(c,s=1,h=!1){let v=1/0,M=1/0,k=-1/0,L=-1/0;const V=c[0];for(let Te=0;Te<V.length;Te++){const Se=V[Te];(!Te||Se.x<v)&&(v=Se.x),(!Te||Se.y<M)&&(M=Se.y),(!Te||Se.x>k)&&(k=Se.x),(!Te||Se.y>L)&&(L=Se.y)}const Z=Math.min(k-v,L-M);let J=Z/2;const se=new pf([],Xh);if(Z===0)return new Mt(v,M);for(let Te=v;Te<k;Te+=Z)for(let Se=M;Se<L;Se+=Z)se.push(new Hh(Te+J,Se+J,J,c));let ue=function(Te){let Se=0,Qe=0,Xe=0;const Et=Te[0];for(let Gt=0,wt=Et.length,Ut=wt-1;Gt<wt;Ut=Gt++){const ai=Et[Gt],li=Et[Ut],Hi=ai.x*li.y-li.x*ai.y;Qe+=(ai.x+li.x)*Hi,Xe+=(ai.y+li.y)*Hi,Se+=3*Hi}return new Hh(Qe/Se,Xe/Se,0,Te)}(c),xe=se.length;for(;se.length;){const Te=se.pop();(Te.d>ue.d||!ue.d)&&(ue=Te,h&&console.log("found best %d after %d probes",Math.round(1e4*Te.d)/1e4,xe)),Te.max-ue.d<=s||(J=Te.h/2,se.push(new Hh(Te.p.x-J,Te.p.y-J,J,c)),se.push(new Hh(Te.p.x+J,Te.p.y-J,J,c)),se.push(new Hh(Te.p.x-J,Te.p.y+J,J,c)),se.push(new Hh(Te.p.x+J,Te.p.y+J,J,c)),xe+=4)}return h&&(console.log(`num probes: ${xe}`),console.log(`best distance: ${ue.d}`)),ue.p}function Xh(c,s){return s.max-c.max}function Hh(c,s,h,v){this.p=new Mt(c,s),this.h=h,this.d=function(M,k){let L=!1,V=1/0;for(let Z=0;Z<k.length;Z++){const J=k[Z];for(let se=0,ue=J.length,xe=ue-1;se<ue;xe=se++){const Te=J[se],Se=J[xe];Te.y>M.y!=Se.y>M.y&&M.x<(Se.x-Te.x)*(M.y-Te.y)/(Se.y-Te.y)+Te.x&&(L=!L),V=Math.min(V,er(M,Te,Se))}}return(L?1:-1)*Math.sqrt(V)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}const ff=Number.POSITIVE_INFINITY;function Kh(c,s){return s[1]!==ff?function(h,v,M){let k=0,L=0;switch(v=Math.abs(v),M=Math.abs(M),h){case"top-right":case"top-left":case"top":L=M-7;break;case"bottom-right":case"bottom-left":case"bottom":L=7-M}switch(h){case"top-right":case"bottom-right":case"right":k=-v;break;case"top-left":case"bottom-left":case"left":k=v}return[k,L]}(c,s[0],s[1]):function(h,v){let M=0,k=0;v<0&&(v=0);const L=v/Math.sqrt(2);switch(h){case"top-right":case"top-left":k=L-7;break;case"bottom-right":case"bottom-left":k=7-L;break;case"bottom":k=7-v;break;case"top":k=v-7}switch(h){case"top-right":case"bottom-right":M=-L;break;case"top-left":case"bottom-left":M=L;break;case"left":M=v;break;case"right":M=-v}return[M,k]}(c,s[0])}function L1(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ym(c,s,h,v,M,k,L,V,Z,J,se){let ue=k.textMaxSize.evaluate(s,{});ue===void 0&&(ue=L);const xe=c.layers[0].layout,Te=xe.get("icon-offset").evaluate(s,{},se),Se=vm(h.horizontal),Qe=L/24,Xe=c.tilePixelRatio*Qe,Et=c.tilePixelRatio*ue/24,Gt=c.tilePixelRatio*V,wt=c.tilePixelRatio*xe.get("symbol-spacing"),Ut=xe.get("text-padding")*c.tilePixelRatio,ai=function(bi,ar,nr,zr=1){const jn=bi.get("icon-padding").evaluate(ar,{},nr),Yn=jn&&jn.values;return[Yn[0]*zr,Yn[1]*zr,Yn[2]*zr,Yn[3]*zr]}(xe,s,se,c.tilePixelRatio),li=xe.get("text-max-angle")/180*Math.PI,Hi=xe.get("text-rotation-alignment")!=="viewport"&&xe.get("symbol-placement")!=="point",tr=xe.get("icon-rotation-alignment")==="map"&&xe.get("symbol-placement")!=="point",Vi=xe.get("symbol-placement"),Li=wt/2,zi=xe.get("icon-text-fit");let $i;v&&zi!=="none"&&(c.allowVerticalPlacement&&h.vertical&&($i=Pp(v,h.vertical,zi,xe.get("icon-text-fit-padding"),Te,Qe)),Se&&(v=Pp(v,Se,zi,xe.get("icon-text-fit-padding"),Te,Qe)));const Ni=(bi,ar)=>{ar.x<0||ar.x>=Zt||ar.y<0||ar.y>=Zt||function(nr,zr,jn,Yn,So,Pa,hs,xo,Ro,ds,Us,fa,vo,Bo,Ps,Ln,ps,ts,Fn,Fo,Xr,ka,ks,Ns,Al){const hc=nr.addToLineVertexArray(zr,jn);let dc,Pl,kl,za,ea=0,Gc=0,jd=0,Lm=0,Tf=-1,Ef=-1;const Su={};let Sf=A.exports(""),Mf=0,Oo=0;if(xo._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Mf,Oo]=xo.layout.get("text-offset").evaluate(Xr,{},Ns).map(qr=>qr*cs):(Mf=xo.layout.get("text-radial-offset").evaluate(Xr,{},Ns)*cs,Oo=ff),nr.allowVerticalPlacement&&Yn.vertical){const qr=xo.layout.get("text-rotate").evaluate(Xr,{},Ns)+90;kl=new Fp(Ro,zr,ds,Us,fa,Yn.vertical,vo,Bo,Ps,qr),hs&&(za=new Fp(Ro,zr,ds,Us,fa,hs,ps,ts,Ps,qr))}if(So){const qr=xo.layout.get("icon-rotate").evaluate(Xr,{}),Ll=xo.layout.get("icon-text-fit")!=="none",N1=hf(So,qr,ks,Ll),V1=hs?hf(hs,qr,ks,Ll):void 0;Pl=new Fp(Ro,zr,ds,Us,fa,So,ps,ts,!1,qr),ea=4*N1.length;const $c=nr.iconSizeData;let Rl=null;$c.kind==="source"?(Rl=[Vc*xo.layout.get("icon-size").evaluate(Xr,{})],Rl[0]>Tu&&St(`${nr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):$c.kind==="composite"&&(Rl=[Vc*ka.compositeIconSizes[0].evaluate(Xr,{},Ns),Vc*ka.compositeIconSizes[1].evaluate(Xr,{},Ns)],(Rl[0]>Tu||Rl[1]>Tu)&&St(`${nr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),nr.addSymbols(nr.icon,N1,Rl,Fo,Fn,Xr,t.WritingMode.none,zr,hc.lineStartIndex,hc.lineLength,-1,Ns),Tf=nr.icon.placedSymbolArray.length-1,V1&&(Gc=4*V1.length,nr.addSymbols(nr.icon,V1,Rl,Fo,Fn,Xr,t.WritingMode.vertical,zr,hc.lineStartIndex,hc.lineLength,-1,Ns),Ef=nr.icon.placedSymbolArray.length-1)}const zl=Object.keys(Yn.horizontal);for(const qr of zl){const Ll=Yn.horizontal[qr];if(!dc){Sf=A.exports(Ll.text);const V1=xo.layout.get("text-rotate").evaluate(Xr,{},Ns);dc=new Fp(Ro,zr,ds,Us,fa,Ll,vo,Bo,Ps,V1)}const N1=Ll.positionedLines.length===1;if(jd+=xm(nr,zr,Ll,Pa,xo,Ps,Xr,Ln,hc,Yn.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,N1?zl:[qr],Su,Tf,ka,Ns),N1)break}Yn.vertical&&(Lm+=xm(nr,zr,Yn.vertical,Pa,xo,Ps,Xr,Ln,hc,t.WritingMode.vertical,["vertical"],Su,Ef,ka,Ns));const Cf=dc?dc.boxStartIndex:nr.collisionBoxArray.length,jp=dc?dc.boxEndIndex:nr.collisionBoxArray.length,U1=kl?kl.boxStartIndex:nr.collisionBoxArray.length,W5=kl?kl.boxEndIndex:nr.collisionBoxArray.length,X5=Pl?Pl.boxStartIndex:nr.collisionBoxArray.length,Gd=Pl?Pl.boxEndIndex:nr.collisionBoxArray.length,H5=za?za.boxStartIndex:nr.collisionBoxArray.length,K5=za?za.boxEndIndex:nr.collisionBoxArray.length;let Dl=-1;const $d=(qr,Ll)=>qr&&qr.circleDiameter?Math.max(qr.circleDiameter,Ll):Ll;Dl=$d(dc,Dl),Dl=$d(kl,Dl),Dl=$d(Pl,Dl),Dl=$d(za,Dl);const If=Dl>-1?1:0;If&&(Dl*=Al/cs),nr.glyphOffsetArray.length>=uh.MAX_GLYPHS&&St("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Xr.sortKey!==void 0&&nr.addToSortKeyRanges(nr.symbolInstances.length,Xr.sortKey),nr.symbolInstances.emplaceBack(zr.x,zr.y,Su.right>=0?Su.right:-1,Su.center>=0?Su.center:-1,Su.left>=0?Su.left:-1,Su.vertical||-1,Tf,Ef,Sf,Cf,jp,U1,W5,X5,Gd,H5,K5,ds,jd,Lm,ea,Gc,If,0,vo,Mf,Oo,Dl)}(c,ar,bi,h,v,M,$i,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,Xe,[Ut,Ut,Ut,Ut],Hi,Z,Gt,ai,tr,Te,s,k,J,se,L)};if(Vi==="line")for(const bi of Lp(s.geometry,0,0,Zt,Zt)){const ar=Dp(bi,wt,li,h.vertical||Se,v,24,Et,c.overscaling,Zt);for(const nr of ar){const zr=Se;zr&&bm(c,zr.text,Li,nr)||Ni(bi,nr)}}else if(Vi==="line-center"){for(const bi of s.geometry)if(bi.length>1){const ar=Wh(bi,li,h.vertical||Se,v,24,Et);ar&&Ni(bi,ar)}}else if(s.type==="Polygon")for(const bi of bp(s.geometry,0)){const ar=gm(bi,16);Ni(bi[0],new ch(ar.x,ar.y,0))}else if(s.type==="LineString")for(const bi of s.geometry)Ni(bi,new ch(bi[0].x,bi[0].y,0));else if(s.type==="Point")for(const bi of s.geometry)for(const ar of bi)Ni([ar],new ch(ar.x,ar.y,0))}const Tu=32640;function xm(c,s,h,v,M,k,L,V,Z,J,se,ue,xe,Te,Se){const Qe=function(Gt,wt,Ut,ai,li,Hi,tr,Vi){const Li=ai.layout.get("text-rotate").evaluate(Hi,{})*Math.PI/180,zi=[];for(const $i of wt.positionedLines)for(const Ni of $i.positionedGlyphs){if(!Ni.rect)continue;const bi=Ni.rect||{};let ar=4,nr=!0,zr=1,jn=0;const Yn=(li||Vi)&&Ni.vertical,So=Ni.metrics.advance*Ni.scale/2;if(Vi&&wt.verticalizable){const Fn=(Ni.scale-1)*cs,Fo=(cs-Ni.metrics.width*Ni.scale)/2;jn=$i.lineOffset/2-(Ni.imageName?-Fo:Fn)}if(Ni.imageName){const Fn=tr[Ni.imageName];nr=Fn.sdf,zr=Fn.pixelRatio,ar=1/zr}const Pa=li?[Ni.x+So,Ni.y]:[0,0];let hs=li?[0,0]:[Ni.x+So+Ut[0],Ni.y+Ut[1]-jn],xo=[0,0];Yn&&(xo=hs,hs=[0,0]);const Ro=(Ni.metrics.left-ar)*Ni.scale-So+hs[0],ds=(-Ni.metrics.top-ar)*Ni.scale+hs[1],Us=Ro+bi.w*Ni.scale/zr,fa=ds+bi.h*Ni.scale/zr,vo=new Mt(Ro,ds),Bo=new Mt(Us,ds),Ps=new Mt(Ro,fa),Ln=new Mt(Us,fa);if(Yn){const Fn=new Mt(-So,So-Ip),Fo=-Math.PI/2,Xr=12-So,ka=new Mt(22-Xr,-(Ni.imageName?Xr:0)),ks=new Mt(...xo);vo._rotateAround(Fo,Fn)._add(ka)._add(ks),Bo._rotateAround(Fo,Fn)._add(ka)._add(ks),Ps._rotateAround(Fo,Fn)._add(ka)._add(ks),Ln._rotateAround(Fo,Fn)._add(ka)._add(ks)}if(Li){const Fn=Math.sin(Li),Fo=Math.cos(Li),Xr=[Fo,-Fn,Fn,Fo];vo._matMult(Xr),Bo._matMult(Xr),Ps._matMult(Xr),Ln._matMult(Xr)}const ps=new Mt(0,0),ts=new Mt(0,0);zi.push({tl:vo,tr:Bo,bl:Ps,br:Ln,tex:bi,writingMode:wt.writingMode,glyphOffset:Pa,sectionIndex:Ni.sectionIndex,isSDF:nr,pixelOffsetTL:ps,pixelOffsetBR:ts,minFontScaleX:0,minFontScaleY:0})}return zi}(0,h,V,M,k,L,v,c.allowVerticalPlacement),Xe=c.textSizeData;let Et=null;Xe.kind==="source"?(Et=[Vc*M.layout.get("text-size").evaluate(L,{})],Et[0]>Tu&&St(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Xe.kind==="composite"&&(Et=[Vc*Te.compositeTextSizes[0].evaluate(L,{},Se),Vc*Te.compositeTextSizes[1].evaluate(L,{},Se)],(Et[0]>Tu||Et[1]>Tu)&&St(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,Qe,Et,V,k,L,J,s,Z.lineStartIndex,Z.lineLength,xe,Se);for(const Gt of se)ue[Gt]=c.text.placedSymbolArray.length-1;return 4*Qe.length}function vm(c){for(const s in c)return c[s];return null}function bm(c,s,h,v){const M=c.compareText;if(s in M){const k=M[s];for(let L=k.length-1;L>=0;L--)if(v.dist(k[L])<h)return!0}else M[s]=[];return M[s].push(v),!1}const $5=sh.VectorTileFeature.types,wm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Op(c,s,h,v,M,k,L,V,Z,J,se,ue,xe){const Te=V?Math.min(Tu,Math.round(V[0])):0,Se=V?Math.min(Tu,Math.round(V[1])):0;c.emplaceBack(s,h,Math.round(32*v),Math.round(32*M),k,L,(Te<<1)+(Z?1:0),Se,16*J,16*se,256*ue,256*xe)}function mf(c,s,h){c.emplaceBack(s.x,s.y,h),c.emplaceBack(s.x,s.y,h),c.emplaceBack(s.x,s.y,h),c.emplaceBack(s.x,s.y,h)}function Tm(c){for(const s of c.sections)if(Dc(s.text))return!0;return!1}class Up{constructor(s){this.layoutVertexArray=new ha,this.indexArray=new Qo,this.programConfigurations=s,this.segments=new d,this.dynamicLayoutVertexArray=new da,this.opacityVertexArray=new Ea,this.placedSymbolArray=new di}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,h,v,M){this.isEmpty()||(v&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,rf.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,nf.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,wm,!0),this.opacityVertexBuffer.itemSize=1),(v||M)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Gi("SymbolBuffers",Up);class Np{constructor(s,h,v){this.layoutVertexArray=new s,this.layoutAttributes=h,this.indexArray=new v,this.segments=new d,this.collisionVertexArray=new Ms}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,of.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Gi("CollisionBuffers",Np);class uh{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(L=>L.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=lo([]),this.placementViewportMatrix=lo([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=kp(this.zoom,h["text-size"]),this.iconSizeData=kp(this.zoom,h["icon-size"]);const v=this.layers[0].layout,M=v.get("symbol-sort-key"),k=v.get("symbol-z-order");this.canOverlap=_f(v,"text-overlap","text-allow-overlap")!=="never"||_f(v,"icon-overlap","icon-allow-overlap")!=="never"||v.get("text-ignore-placement")||v.get("icon-ignore-placement"),this.sortFeaturesByKey=k!=="viewport-y"&&!M.isConstant(),this.sortFeaturesByY=(k==="viewport-y"||k==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,v.get("symbol-placement")==="point"&&(this.writingModes=v.get("text-writing-mode").map(L=>t.WritingMode[L])),this.stateDependentLayerIds=this.layers.filter(L=>L.isStateDependent()).map(L=>L.id),this.sourceID=s.sourceID}createArrays(){this.text=new Up(new kt(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new Up(new kt(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new Ft,this.lineVertexArray=new qi,this.symbolInstances=new Ui}calculateGlyphDependencies(s,h,v,M,k){for(let L=0;L<s.length;L++)if(h[s.charCodeAt(L)]=!0,(v||M)&&k){const V=Ia[s.charAt(L)];V&&(h[V.charCodeAt(0)]=!0)}}populate(s,h,v){const M=this.layers[0],k=M.layout,L=k.get("text-font"),V=k.get("text-field"),Z=k.get("icon-image"),J=(V.value.kind!=="constant"||V.value.value instanceof $e&&!V.value.value.isEmpty()||V.value.value.toString().length>0)&&(L.value.kind!=="constant"||L.value.value.length>0),se=Z.value.kind!=="constant"||!!Z.value.value||Object.keys(Z.parameters).length>0,ue=k.get("symbol-sort-key");if(this.features=[],!J&&!se)return;const xe=h.iconDependencies,Te=h.glyphDependencies,Se=h.availableImages,Qe=new Cn(this.zoom);for(const{feature:Xe,id:Et,index:Gt,sourceLayerIndex:wt}of s){const Ut=M._featureFilter.needGeometry,ai=ei(Xe,Ut);if(!M._featureFilter.filter(Qe,ai,v))continue;let li,Hi;if(Ut||(ai.geometry=Ct(Xe)),J){const Vi=M.getValueAndResolveTokens("text-field",ai,v,Se),Li=$e.factory(Vi);Tm(Li)&&(this.hasRTLText=!0),(!this.hasRTLText||Ta()==="unavailable"||this.hasRTLText&&Jo.isParsed())&&(li=am(Li,M,ai))}if(se){const Vi=M.getValueAndResolveTokens("icon-image",ai,v,Se);Hi=Vi instanceof ut?Vi:ut.fromString(Vi)}if(!li&&!Hi)continue;const tr=this.sortFeaturesByKey?ue.evaluate(ai,{},v):void 0;if(this.features.push({id:Et,text:li,icon:Hi,index:Gt,sourceLayerIndex:wt,geometry:ai.geometry,properties:Xe.properties,type:$5[Xe.type],sortKey:tr}),Hi&&(xe[Hi.name]=!0),li){const Vi=L.evaluate(ai,{},v).join(","),Li=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(t.WritingMode.vertical)>=0;for(const zi of li.sections)if(zi.image)xe[zi.image.name]=!0;else{const $i=xl(li.toString()),Ni=zi.fontStack||Vi,bi=Te[Ni]=Te[Ni]||{};this.calculateGlyphDependencies(zi.text,bi,Li,this.allowVerticalPlacement,$i)}}}k.get("symbol-placement")==="line"&&(this.features=function(Xe){const Et={},Gt={},wt=[];let Ut=0;function ai(Vi){wt.push(Xe[Vi]),Ut++}function li(Vi,Li,zi){const $i=Gt[Vi];return delete Gt[Vi],Gt[Li]=$i,wt[$i].geometry[0].pop(),wt[$i].geometry[0]=wt[$i].geometry[0].concat(zi[0]),$i}function Hi(Vi,Li,zi){const $i=Et[Li];return delete Et[Li],Et[Vi]=$i,wt[$i].geometry[0].shift(),wt[$i].geometry[0]=zi[0].concat(wt[$i].geometry[0]),$i}function tr(Vi,Li,zi){const $i=zi?Li[0][Li[0].length-1]:Li[0][0];return`${Vi}:${$i.x}:${$i.y}`}for(let Vi=0;Vi<Xe.length;Vi++){const Li=Xe[Vi],zi=Li.geometry,$i=Li.text?Li.text.toString():null;if(!$i){ai(Vi);continue}const Ni=tr($i,zi),bi=tr($i,zi,!0);if(Ni in Gt&&bi in Et&&Gt[Ni]!==Et[bi]){const ar=Hi(Ni,bi,zi),nr=li(Ni,bi,wt[ar].geometry);delete Et[Ni],delete Gt[bi],Gt[tr($i,wt[nr].geometry,!0)]=nr,wt[ar].geometry=null}else Ni in Gt?li(Ni,bi,zi):bi in Et?Hi(Ni,bi,zi):(ai(Vi),Et[Ni]=Ut-1,Gt[bi]=Ut-1)}return wt.filter(Vi=>Vi.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Xe,Et)=>Xe.sortKey-Et.sortKey)}update(s,h,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,h,this.layers,v),this.icon.programConfigurations.updatePaintArrays(s,h,this.layers,v))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,h){const v=this.lineVertexArray.length;if(s.segment!==void 0){let M=s.dist(h[s.segment+1]),k=s.dist(h[s.segment]);const L={};for(let V=s.segment+1;V<h.length;V++)L[V]={x:h[V].x,y:h[V].y,tileUnitDistanceFromAnchor:M},V<h.length-1&&(M+=h[V+1].dist(h[V]));for(let V=s.segment||0;V>=0;V--)L[V]={x:h[V].x,y:h[V].y,tileUnitDistanceFromAnchor:k},V>0&&(k+=h[V-1].dist(h[V]));for(let V=0;V<h.length;V++){const Z=L[V];this.lineVertexArray.emplaceBack(Z.x,Z.y,Z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:v,lineLength:this.lineVertexArray.length-v}}addSymbols(s,h,v,M,k,L,V,Z,J,se,ue,xe){const Te=s.indexArray,Se=s.layoutVertexArray,Qe=s.segments.prepareSegment(4*h.length,Se,Te,this.canOverlap?L.sortKey:void 0),Xe=this.glyphOffsetArray.length,Et=Qe.vertexLength,Gt=this.allowVerticalPlacement&&V===t.WritingMode.vertical?Math.PI/2:0,wt=L.text&&L.text.sections;for(let Ut=0;Ut<h.length;Ut++){const{tl:ai,tr:li,bl:Hi,br:tr,tex:Vi,pixelOffsetTL:Li,pixelOffsetBR:zi,minFontScaleX:$i,minFontScaleY:Ni,glyphOffset:bi,isSDF:ar,sectionIndex:nr}=h[Ut],zr=Qe.vertexLength,jn=bi[1];Op(Se,Z.x,Z.y,ai.x,jn+ai.y,Vi.x,Vi.y,v,ar,Li.x,Li.y,$i,Ni),Op(Se,Z.x,Z.y,li.x,jn+li.y,Vi.x+Vi.w,Vi.y,v,ar,zi.x,Li.y,$i,Ni),Op(Se,Z.x,Z.y,Hi.x,jn+Hi.y,Vi.x,Vi.y+Vi.h,v,ar,Li.x,zi.y,$i,Ni),Op(Se,Z.x,Z.y,tr.x,jn+tr.y,Vi.x+Vi.w,Vi.y+Vi.h,v,ar,zi.x,zi.y,$i,Ni),mf(s.dynamicLayoutVertexArray,Z,Gt),Te.emplaceBack(zr,zr+1,zr+2),Te.emplaceBack(zr+1,zr+2,zr+3),Qe.vertexLength+=4,Qe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(bi[0]),Ut!==h.length-1&&nr===h[Ut+1].sectionIndex||s.programConfigurations.populatePaintArrays(Se.length,L,L.index,{},xe,wt&&wt[nr])}s.placedSymbolArray.emplaceBack(Z.x,Z.y,Xe,this.glyphOffsetArray.length-Xe,Et,J,se,Z.segment,v?v[0]:0,v?v[1]:0,M[0],M[1],V,0,!1,0,ue)}_addCollisionDebugVertex(s,h,v,M,k,L){return h.emplaceBack(0,0),s.emplaceBack(v.x,v.y,M,k,Math.round(L.x),Math.round(L.y))}addCollisionDebugVertices(s,h,v,M,k,L,V){const Z=k.segments.prepareSegment(4,k.layoutVertexArray,k.indexArray),J=Z.vertexLength,se=k.layoutVertexArray,ue=k.collisionVertexArray,xe=V.anchorX,Te=V.anchorY;this._addCollisionDebugVertex(se,ue,L,xe,Te,new Mt(s,h)),this._addCollisionDebugVertex(se,ue,L,xe,Te,new Mt(v,h)),this._addCollisionDebugVertex(se,ue,L,xe,Te,new Mt(v,M)),this._addCollisionDebugVertex(se,ue,L,xe,Te,new Mt(s,M)),Z.vertexLength+=4;const Se=k.indexArray;Se.emplaceBack(J,J+1),Se.emplaceBack(J+1,J+2),Se.emplaceBack(J+2,J+3),Se.emplaceBack(J+3,J),Z.primitiveLength+=4}addDebugCollisionBoxes(s,h,v,M){for(let k=s;k<h;k++){const L=this.collisionBoxArray.get(k);this.addCollisionDebugVertices(L.x1,L.y1,L.x2,L.y2,M?this.textCollisionBox:this.iconCollisionBox,L.anchorPoint,v)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Np(Sa,Os.members,Cs),this.iconCollisionBox=new Np(Sa,Os.members,Cs);for(let s=0;s<this.symbolInstances.length;s++){const h=this.symbolInstances.get(s);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(s,h,v,M,k,L,V,Z,J){const se={};for(let ue=h;ue<v;ue++){const xe=s.get(ue);se.textBox={x1:xe.x1,y1:xe.y1,x2:xe.x2,y2:xe.y2,anchorPointX:xe.anchorPointX,anchorPointY:xe.anchorPointY},se.textFeatureIndex=xe.featureIndex;break}for(let ue=M;ue<k;ue++){const xe=s.get(ue);se.verticalTextBox={x1:xe.x1,y1:xe.y1,x2:xe.x2,y2:xe.y2,anchorPointX:xe.anchorPointX,anchorPointY:xe.anchorPointY},se.verticalTextFeatureIndex=xe.featureIndex;break}for(let ue=L;ue<V;ue++){const xe=s.get(ue);se.iconBox={x1:xe.x1,y1:xe.y1,x2:xe.x2,y2:xe.y2,anchorPointX:xe.anchorPointX,anchorPointY:xe.anchorPointY},se.iconFeatureIndex=xe.featureIndex;break}for(let ue=Z;ue<J;ue++){const xe=s.get(ue);se.verticalIconBox={x1:xe.x1,y1:xe.y1,x2:xe.x2,y2:xe.y2,anchorPointX:xe.anchorPointX,anchorPointY:xe.anchorPointY},se.verticalIconFeatureIndex=xe.featureIndex;break}return se}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,v.textBoxStartIndex,v.textBoxEndIndex,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v.iconBoxStartIndex,v.iconBoxEndIndex,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,h){const v=s.placedSymbolArray.get(h),M=v.vertexStartIndex+4*v.numGlyphs;for(let k=v.vertexStartIndex;k<M;k+=4)s.indexArray.emplaceBack(k,k+1,k+2),s.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(s),v=Math.cos(s),M=[],k=[],L=[];for(let V=0;V<this.symbolInstances.length;++V){L.push(V);const Z=this.symbolInstances.get(V);M.push(0|Math.round(h*Z.anchorX+v*Z.anchorY)),k.push(Z.featureIndex)}return L.sort((V,Z)=>M[V]-M[Z]||k[Z]-k[V]),L}addToSortKeyRanges(s,h){const v=this.sortKeyRanges[this.sortKeyRanges.length-1];v&&v.sortKey===h?v.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const v=this.symbolInstances.get(h);this.featureSortOrder.push(v.featureIndex),[v.rightJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.leftJustifiedTextSymbolIndex].forEach((M,k,L)=>{M>=0&&L.indexOf(M)===k&&this.addIndicesForPlacedSymbol(this.text,M)}),v.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,v.verticalPlacedTextSymbolIndex),v.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.placedIconSymbolIndex),v.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Gi("SymbolBucket",uh,{omit:["layers","collisionBoxArray","features","compareText"]}),uh.MAX_GLYPHS=65535,uh.addDynamicAttributes=mf;const Eu=new ho({"symbol-placement":new Ji(qt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ji(qt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ji(qt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new dr(qt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ji(qt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ji(qt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ji(qt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ji(qt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ji(qt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ji(qt.layout_symbol["icon-rotation-alignment"]),"icon-size":new dr(qt.layout_symbol["icon-size"]),"icon-text-fit":new Ji(qt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ji(qt.layout_symbol["icon-text-fit-padding"]),"icon-image":new dr(qt.layout_symbol["icon-image"]),"icon-rotate":new dr(qt.layout_symbol["icon-rotate"]),"icon-padding":new dr(qt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ji(qt.layout_symbol["icon-keep-upright"]),"icon-offset":new dr(qt.layout_symbol["icon-offset"]),"icon-anchor":new dr(qt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ji(qt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ji(qt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ji(qt.layout_symbol["text-rotation-alignment"]),"text-field":new dr(qt.layout_symbol["text-field"]),"text-font":new dr(qt.layout_symbol["text-font"]),"text-size":new dr(qt.layout_symbol["text-size"]),"text-max-width":new dr(qt.layout_symbol["text-max-width"]),"text-line-height":new Ji(qt.layout_symbol["text-line-height"]),"text-letter-spacing":new dr(qt.layout_symbol["text-letter-spacing"]),"text-justify":new dr(qt.layout_symbol["text-justify"]),"text-radial-offset":new dr(qt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ji(qt.layout_symbol["text-variable-anchor"]),"text-anchor":new dr(qt.layout_symbol["text-anchor"]),"text-max-angle":new Ji(qt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ji(qt.layout_symbol["text-writing-mode"]),"text-rotate":new dr(qt.layout_symbol["text-rotate"]),"text-padding":new Ji(qt.layout_symbol["text-padding"]),"text-keep-upright":new Ji(qt.layout_symbol["text-keep-upright"]),"text-transform":new dr(qt.layout_symbol["text-transform"]),"text-offset":new dr(qt.layout_symbol["text-offset"]),"text-allow-overlap":new Ji(qt.layout_symbol["text-allow-overlap"]),"text-overlap":new Ji(qt.layout_symbol["text-overlap"]),"text-ignore-placement":new Ji(qt.layout_symbol["text-ignore-placement"]),"text-optional":new Ji(qt.layout_symbol["text-optional"])});var Qs={paint:new ho({"icon-opacity":new dr(qt.paint_symbol["icon-opacity"]),"icon-color":new dr(qt.paint_symbol["icon-color"]),"icon-halo-color":new dr(qt.paint_symbol["icon-halo-color"]),"icon-halo-width":new dr(qt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new dr(qt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ji(qt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ji(qt.paint_symbol["icon-translate-anchor"]),"text-opacity":new dr(qt.paint_symbol["text-opacity"]),"text-color":new dr(qt.paint_symbol["text-color"],{runtimeType:de,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new dr(qt.paint_symbol["text-halo-color"]),"text-halo-width":new dr(qt.paint_symbol["text-halo-width"]),"text-halo-blur":new dr(qt.paint_symbol["text-halo-blur"]),"text-translate":new Ji(qt.paint_symbol["text-translate"]),"text-translate-anchor":new Ji(qt.paint_symbol["text-translate-anchor"])}),layout:Eu};class Em{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:Ao,this.defaultValue=s}evaluate(s){if(s.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(s.formattedSection))return h.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Gi("FormatSectionOverride",Em,{omit:["defaultValue"]});class R1 extends Ks{constructor(s){super(s,Qs)}recalculate(s,h){if(super.recalculate(s,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const v=this.layout.get("text-writing-mode");if(v){const M=[];for(const k of v)M.indexOf(k)<0&&M.push(k);this.layout._values["text-writing-mode"]=M}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,h,v,M){const k=this.layout.get(s).evaluate(h,{},v,M),L=this._unevaluatedLayout._values[s];return L.isDataDriven()||Cc(L.value)||!k?k:function(V,Z){return Z.replace(/{([^{}]+)}/g,(J,se)=>se in V?String(V[se]):"")}(h.properties,k)}createBucket(s){return new uh(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of Qs.paint.overridableProperties){if(!R1.hasPaintOverride(this.layout,s))continue;const h=this.paint.get(s),v=new Em(h),M=new pl(v,h.property.specification);let k=null;k=h.value.kind==="constant"||h.value.kind==="source"?new Ic("source",M):new Za("composite",M,h.value.zoomStops),this.paint._values[s]=new Ss(h.property,k,h.parameters)}}_handleOverridablePaintPropertyUpdate(s,h,v){return!(!this.layout||h.isDataDriven()||v.isDataDriven())&&R1.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,h){const v=s.get("text-field"),M=Qs.paint.properties[h];let k=!1;const L=V=>{for(const Z of V)if(M.overrides&&M.overrides.hasOverride(Z))return void(k=!0)};if(v.value.kind==="constant"&&v.value.value instanceof $e)L(v.value.value.sections);else if(v.value.kind==="source"){const V=J=>{k||(J instanceof Zi&&ft(J.value)===ot?L(J.value.sections):J instanceof ja?L(J.sections):J.eachChild(V))},Z=v.value;Z._styleExpression&&V(Z._styleExpression.expression)}return k}}function _f(c,s,h){let v="never";const M=c.get(s);return M?v=M:c.get(h)&&(v="always"),v}var Z5={paint:new ho({"background-color":new Ji(qt.paint_background["background-color"]),"background-pattern":new Rc(qt.paint_background["background-pattern"]),"background-opacity":new Ji(qt.paint_background["background-opacity"])})},q5={paint:new ho({"raster-opacity":new Ji(qt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ji(qt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ji(qt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ji(qt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ji(qt.paint_raster["raster-saturation"]),"raster-contrast":new Ji(qt.paint_raster["raster-contrast"]),"raster-resampling":new Ji(qt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ji(qt.paint_raster["raster-fade-duration"])})};class gf extends Ks{constructor(s){super(s,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const Vp={circle:class extends Ks{constructor(c){super(c,Sl)}createBucket(c){return new si(c)}queryRadius(c){const s=c;return fn("circle-radius",this,s)+fn("circle-stroke-width",this,s)+Lo(this.paint.get("circle-translate"))}queryIntersectsFeature(c,s,h,v,M,k,L,V){const Z=go(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,L),J=this.paint.get("circle-radius").evaluate(s,h)+this.paint.get("circle-stroke-width").evaluate(s,h),se=this.paint.get("circle-pitch-alignment")==="map",ue=se?Z:function(Te,Se){return Te.map(Qe=>rc(Qe,Se))}(Z,V),xe=se?J*L:J;for(const Te of v)for(const Se of Te){const Qe=se?Se:rc(Se,V);let Xe=xe;const Et=Fc([],[Se.x,Se.y,0,1],V);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Xe*=Et[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Xe*=k.cameraToCenterDistance/Et[3]),or(ue,Qe,Xe))return!0}return!1}},heatmap:class extends Ks{constructor(c){super(c,y1),this._updateColorRamp()}createBucket(c){return new Oc(c)}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=gp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Ks{constructor(c){super(c,yp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Ks{constructor(c){super(c,W0)}recalculate(c,s){super.recalculate(c,s);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new jh(c)}queryRadius(){return Lo(this.paint.get("fill-translate"))}queryIntersectsFeature(c,s,h,v,M,k,L){return vr(go(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,L),v)}isTileClipped(){return!0}},"fill-extrusion":class extends Ks{constructor(c){super(c,oc)}createBucket(c){return new oo(c)}queryRadius(){return Lo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(c,s,h,v,M,k,L,V){const Z=go(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,L),J=this.paint.get("fill-extrusion-height").evaluate(s,h),se=this.paint.get("fill-extrusion-base").evaluate(s,h),ue=function(Te,Se,Qe,Xe){const Et=[];for(const Gt of Te){const wt=[Gt.x,Gt.y,0,1];Fc(wt,wt,Se),Et.push(new Mt(wt[0]/wt[3],wt[1]/wt[3]))}return Et}(Z,V),xe=function(Te,Se,Qe,Xe){const Et=[],Gt=[],wt=Xe[8]*Se,Ut=Xe[9]*Se,ai=Xe[10]*Se,li=Xe[11]*Se,Hi=Xe[8]*Qe,tr=Xe[9]*Qe,Vi=Xe[10]*Qe,Li=Xe[11]*Qe;for(const zi of Te){const $i=[],Ni=[];for(const bi of zi){const ar=bi.x,nr=bi.y,zr=Xe[0]*ar+Xe[4]*nr+Xe[12],jn=Xe[1]*ar+Xe[5]*nr+Xe[13],Yn=Xe[2]*ar+Xe[6]*nr+Xe[14],So=Xe[3]*ar+Xe[7]*nr+Xe[15],Pa=Yn+ai,hs=So+li,xo=zr+Hi,Ro=jn+tr,ds=Yn+Vi,Us=So+Li,fa=new Mt((zr+wt)/hs,(jn+Ut)/hs);fa.z=Pa/hs,$i.push(fa);const vo=new Mt(xo/Us,Ro/Us);vo.z=ds/Us,Ni.push(vo)}Et.push($i),Gt.push(Ni)}return[Et,Gt]}(v,se,J,V);return function(Te,Se,Qe){let Xe=1/0;vr(Qe,Se)&&(Xe=tm(Qe,Se[0]));for(let Et=0;Et<Se.length;Et++){const Gt=Se[Et],wt=Te[Et];for(let Ut=0;Ut<Gt.length-1;Ut++){const ai=Gt[Ut],li=[ai,Gt[Ut+1],wt[Ut+1],wt[Ut],ai];xi(Qe,li)&&(Xe=Math.min(Xe,tm(Qe,li)))}}return Xe!==1/0&&Xe}(xe[0],xe[1],ue)}},line:class extends Ks{constructor(c){super(c,ef),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){c==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ql,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,s){super.recalculate(c,s),this.paint._values["line-floorwidth"]=tf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new Q0(c)}queryRadius(c){const s=c,h=M1(fn("line-width",this,s),fn("line-gap-width",this,s)),v=fn("line-offset",this,s);return h/2+Math.abs(v)+Lo(this.paint.get("line-translate"))}queryIntersectsFeature(c,s,h,v,M,k,L){const V=go(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,L),Z=L/2*M1(this.paint.get("line-width").evaluate(s,h),this.paint.get("line-gap-width").evaluate(s,h)),J=this.paint.get("line-offset").evaluate(s,h);return J&&(v=function(se,ue){const xe=[];for(let Te=0;Te<se.length;Te++){const Se=se[Te],Qe=[];for(let Xe=0;Xe<Se.length;Xe++){const Et=Se[Xe-1],Gt=Se[Xe],wt=Se[Xe+1],Ut=Xe===0?new Mt(0,0):Gt.sub(Et)._unit()._perp(),ai=Xe===Se.length-1?new Mt(0,0):wt.sub(Gt)._unit()._perp(),li=Ut._add(ai)._unit(),Hi=li.x*ai.x+li.y*ai.y;Hi!==0&&li._mult(1/Hi),Qe.push(li._mult(ue)._add(Gt))}xe.push(Qe)}return xe}(v,J*L)),function(se,ue,xe){for(let Te=0;Te<ue.length;Te++){const Se=ue[Te];if(se.length>=3){for(let Qe=0;Qe<Se.length;Qe++)if(un(se,Se[Qe]))return!0}if(Xi(se,Se,xe))return!0}return!1}(V,v,Z)}isTileClipped(){return!0}},symbol:R1,background:class extends Ks{constructor(c){super(c,Z5)}},raster:class extends Ks{constructor(c){super(c,q5)}}};class Sm{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const hh=63710088e-1;class Wn{constructor(s,h){if(isNaN(s)||isNaN(h))throw new Error(`Invalid LngLat object: (${s}, ${h})`);if(this.lng=+s,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Wn(Ye(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const h=Math.PI/180,v=this.lat*h,M=s.lat*h,k=Math.sin(v)*Math.sin(M)+Math.cos(v)*Math.cos(M)*Math.cos((s.lng-this.lng)*h);return hh*Math.acos(Math.min(k,1))}toBounds(s=0){const h=360*s/40075017,v=h/Math.cos(Math.PI/180*this.lat);return new Yh(new Wn(this.lng-v,this.lat-h),new Wn(this.lng+v,this.lat+h))}static convert(s){if(s instanceof Wn)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Wn(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Wn(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Yh{constructor(s,h){s&&(h?this.setSouthWest(s).setNorthEast(h):s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof Wn?new Wn(s.lng,s.lat):Wn.convert(s),this}setSouthWest(s){return this._sw=s instanceof Wn?new Wn(s.lng,s.lat):Wn.convert(s),this}extend(s){const h=this._sw,v=this._ne;let M,k;if(s instanceof Wn)M=s,k=s;else{if(!(s instanceof Yh))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(Yh.convert(s)):this.extend(Wn.convert(s)):this;if(M=s._sw,k=s._ne,!M||!k)return this}return h||v?(h.lng=Math.min(M.lng,h.lng),h.lat=Math.min(M.lat,h.lat),v.lng=Math.max(k.lng,v.lng),v.lat=Math.max(k.lat,v.lat)):(this._sw=new Wn(M.lng,M.lat),this._ne=new Wn(k.lng,k.lat)),this}getCenter(){return new Wn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Wn(this.getWest(),this.getNorth())}getSouthEast(){return new Wn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:h,lat:v}=Wn.convert(s);let M=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(M=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&M}static convert(s){return s instanceof Yh?s:s&&new Yh(s)}}const Mm=2*Math.PI*hh;function Cm(c){return Mm*Math.cos(c*Math.PI/180)}function Im(c){return(180+c)/360}function Am(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Pm(c,s){return c/Cm(s)}function yf(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class B1{constructor(s,h,v=0){this.x=+s,this.y=+h,this.z=+v}static fromLngLat(s,h=0){const v=Wn.convert(s);return new B1(Im(v.lng),Am(v.lat),Pm(h,v.lat))}toLngLat(){return new Wn(360*this.x-180,yf(this.y))}toAltitude(){return this.z*Cm(yf(this.y))}meterInMercatorCoordinateUnits(){return 1/Mm*(s=yf(this.y),1/Math.cos(s*Math.PI/180));var s}}function km(c,s,h){var v=2*Math.PI*6378137/256/Math.pow(2,h);return[c*v-2*Math.PI*6378137/2,s*v-2*Math.PI*6378137/2]}class dh{constructor(s,h,v){if(s<0||s>25||v<0||v>=Math.pow(2,s)||h<0||h>=Math.pow(2,s))throw new Error(`x=${h}, y=${v}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=h,this.y=v,this.key=ph(0,s,s,h,v)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,h,v){const M=(L=this.y,V=this.z,Z=km(256*(k=this.x),256*(L=Math.pow(2,V)-L-1),V),J=km(256*(k+1),256*(L+1),V),Z[0]+","+Z[1]+","+J[0]+","+J[1]);var k,L,V,Z,J;const se=function(ue,xe,Te){let Se,Qe="";for(let Xe=ue;Xe>0;Xe--)Se=1<<Xe-1,Qe+=(xe&Se?1:0)+(Te&Se?2:0);return Qe}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(v==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,se).replace(/{bbox-epsg-3857}/g,M)}isChildOf(s){const h=this.z-s.z;return h>0&&s.x===this.x>>h&&s.y===this.y>>h}getTilePoint(s){const h=Math.pow(2,this.z);return new Mt((s.x*h-this.x)*Zt,(s.y*h-this.y)*Zt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zm{constructor(s,h){this.wrap=s,this.canonical=h,this.key=ph(s,h.z,h.z,h.x,h.y)}}class yn{constructor(s,h,v,M,k){if(s<v)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${v}`);this.overscaledZ=s,this.wrap=h,this.canonical=new dh(v,+M,+k),this.key=ph(h,s,v,M,k)}clone(){return new yn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-s;return s>this.canonical.z?new yn(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new yn(s,this.wrap,s,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(s,h){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const v=this.canonical.z-s;return s>this.canonical.z?ph(this.wrap*+h,s,this.canonical.z,this.canonical.x,this.canonical.y):ph(this.wrap*+h,s,s,this.canonical.x>>v,this.canonical.y>>v)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const h=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>h&&s.canonical.y===this.canonical.y>>h}children(s){if(this.overscaledZ>=s)return[new yn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,v=2*this.canonical.x,M=2*this.canonical.y;return[new yn(h,this.wrap,h,v,M),new yn(h,this.wrap,h,v+1,M),new yn(h,this.wrap,h,v,M+1),new yn(h,this.wrap,h,v+1,M+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new yn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new yn(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new B1(s.x-this.wrap,s.y))}}function ph(c,s,h,v,M){(c*=2)<0&&(c=-1*c-1);const k=1<<h;return(k*k*c+k*M+v).toString(36)+h.toString(36)+s.toString(36)}Gi("CanonicalTileID",dh),Gi("OverscaledTileID",yn,{omit:["posMatrix"]});class xf{constructor(s,h,v){if(this.uid=s,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(v&&v!=="mapbox"&&v!=="terrarium")return void St(`"${v}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=h.height;const M=this.dim=h.height-2;this.data=new Uint32Array(h.data.buffer),this.encoding=v||"mapbox";for(let k=0;k<M;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(M,k)]=this.data[this._idx(M-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,M)]=this.data[this._idx(k,M-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(M,-1)]=this.data[this._idx(M-1,0)],this.data[this._idx(-1,M)]=this.data[this._idx(0,M-1)],this.data[this._idx(M,M)]=this.data[this._idx(M-1,M-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<M;k++)for(let L=0;L<M;L++){const V=this.get(k,L);V>this.max&&(this.max=V),V<this.min&&(this.min=V)}}get(s,h){const v=new Uint8Array(this.data.buffer),M=4*this._idx(s,h);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(v[M],v[M+1],v[M+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(s,h){if(s<-1||s>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(s+1)}_unpackMapbox(s,h,v){return(256*s*256+256*h+v)/10-1e4}_unpackTerrarium(s,h,v){return 256*s+h+v/256-32768}getPixels(){return new Ja({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,h,v){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let M=h*this.dim,k=h*this.dim+this.dim,L=v*this.dim,V=v*this.dim+this.dim;switch(h){case-1:M=k-1;break;case 1:k=M+1}switch(v){case-1:L=V-1;break;case 1:V=L+1}const Z=-h*this.dim,J=-v*this.dim;for(let se=L;se<V;se++)for(let ue=M;ue<k;ue++)this.data[this._idx(ue,se)]=s.data[this._idx(ue+Z,se+J)]}}Gi("DEMData",xf);class Od{constructor(s){this._stringToNumber={},this._numberToString=[];for(let h=0;h<s.length;h++){const v=s[h];this._stringToNumber[v]=h,this._numberToString[h]=v}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class Ud{constructor(s,h,v,M,k){this.type="Feature",this._vectorTileFeature=s,s._z=h,s._x=v,s._y=M,this.properties=s.properties,this.id=k}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(s[h]=this[h]);return s}}class F1{constructor(s,h){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new kc(Zt,16,0),this.grid3D=new kc(Zt,16,0),this.featureIndexArray=new Sr,this.promoteId=h}insert(s,h,v,M,k,L){const V=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(v,M,k);const Z=L?this.grid3D:this.grid;for(let J=0;J<h.length;J++){const se=h[J],ue=[1/0,1/0,-1/0,-1/0];for(let xe=0;xe<se.length;xe++){const Te=se[xe];ue[0]=Math.min(ue[0],Te.x),ue[1]=Math.min(ue[1],Te.y),ue[2]=Math.max(ue[2],Te.x),ue[3]=Math.max(ue[3],Te.y)}ue[0]<Zt&&ue[1]<Zt&&ue[2]>=0&&ue[3]>=0&&Z.insert(V,ue[0],ue[1],ue[2],ue[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new sh.VectorTile(new bu(this.rawTileData)).layers,this.sourceLayerCoder=new Od(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,h,v,M){this.loadVTLayers();const k=s.params||{},L=Zt/s.tileSize/s.scale,V=fl(k.filter),Z=s.queryGeometry,J=s.queryPadding*L,se=bf(Z),ue=this.grid.query(se.minX-J,se.minY-J,se.maxX+J,se.maxY+J),xe=bf(s.cameraQueryGeometry),Te=this.grid3D.query(xe.minX-J,xe.minY-J,xe.maxX+J,xe.maxY+J,(Xe,Et,Gt,wt)=>function(Ut,ai,li,Hi,tr){for(const Li of Ut)if(ai<=Li.x&&li<=Li.y&&Hi>=Li.x&&tr>=Li.y)return!0;const Vi=[new Mt(ai,li),new Mt(ai,tr),new Mt(Hi,tr),new Mt(Hi,li)];if(Ut.length>2){for(const Li of Vi)if(un(Ut,Li))return!0}for(let Li=0;Li<Ut.length-1;Li++)if(kn(Ut[Li],Ut[Li+1],Vi))return!0;return!1}(s.cameraQueryGeometry,Xe-J,Et-J,Gt+J,wt+J));for(const Xe of Te)ue.push(Xe);ue.sort(Nd);const Se={};let Qe;for(let Xe=0;Xe<ue.length;Xe++){const Et=ue[Xe];if(Et===Qe)continue;Qe=Et;const Gt=this.featureIndexArray.get(Et);let wt=null;this.loadMatchingFeature(Se,Gt.bucketIndex,Gt.sourceLayerIndex,Gt.featureIndex,V,k.layers,k.availableImages,h,v,M,(Ut,ai,li)=>(wt||(wt=Ct(Ut)),ai.queryIntersectsFeature(Z,Ut,li,wt,this.z,s.transform,L,s.pixelPosMatrix)))}return Se}loadMatchingFeature(s,h,v,M,k,L,V,Z,J,se,ue){const xe=this.bucketLayerIDs[h];if(L&&!function(Xe,Et){for(let Gt=0;Gt<Xe.length;Gt++)if(Et.indexOf(Xe[Gt])>=0)return!0;return!1}(L,xe))return;const Te=this.sourceLayerCoder.decode(v),Se=this.vtLayers[Te].feature(M);if(k.needGeometry){const Xe=ei(Se,!0);if(!k.filter(new Cn(this.tileID.overscaledZ),Xe,this.tileID.canonical))return}else if(!k.filter(new Cn(this.tileID.overscaledZ),Se))return;const Qe=this.getId(Se,Te);for(let Xe=0;Xe<xe.length;Xe++){const Et=xe[Xe];if(L&&L.indexOf(Et)<0)continue;const Gt=Z[Et];if(!Gt)continue;let wt={};Qe&&se&&(wt=se.getState(Gt.sourceLayer||"_geojsonTileLayer",Qe));const Ut=lt({},J[Et]);Ut.paint=vf(Ut.paint,Gt.paint,Se,wt,V),Ut.layout=vf(Ut.layout,Gt.layout,Se,wt,V);const ai=!ue||ue(Se,Gt,wt);if(!ai)continue;const li=new Ud(Se,this.z,this.x,this.y,Qe);li.layer=Ut;let Hi=s[Et];Hi===void 0&&(Hi=s[Et]=[]),Hi.push({featureIndex:M,feature:li,intersectionZ:ai})}}lookupSymbolFeatures(s,h,v,M,k,L,V,Z){const J={};this.loadVTLayers();const se=fl(k);for(const ue of s)this.loadMatchingFeature(J,v,M,ue,se,L,V,Z,h);return J}hasLayer(s){for(const h of this.bucketLayerIDs)for(const v of h)if(s===v)return!0;return!1}getId(s,h){let v=s.id;return this.promoteId&&(v=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof v=="boolean"&&(v=Number(v))),v}}function vf(c,s,h,v,M){return Ne(c,(k,L)=>{const V=s instanceof ro?s.get(L):null;return V&&V.evaluate?V.evaluate(h,v,M):V})}function bf(c){let s=1/0,h=1/0,v=-1/0,M=-1/0;for(const k of c)s=Math.min(s,k.x),h=Math.min(h,k.y),v=Math.max(v,k.x),M=Math.max(M,k.y);return{minX:s,minY:h,maxX:v,maxY:M}}function Nd(c,s){return s-c}var Vd;Gi("FeatureIndex",F1,{omit:["rawTileData","sourceLayerCoder"]}),t.PerformanceMarkers=void 0,(Vd=t.PerformanceMarkers||(t.PerformanceMarkers={})).create="create",Vd.load="load",Vd.fullLoad="fullLoad";let O1=null,Jh=[];const wf=1e3/30,Dm={mark(c){performance.mark(c)},frame(c){const s=c;O1!=null&&Jh.push(s-O1),O1=s},clearMetrics(){O1=null,Jh=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const c in t.PerformanceMarkers)performance.clearMarks(t.PerformanceMarkers[c])},getPerformanceMetrics(){performance.measure("loadTime",t.PerformanceMarkers.create,t.PerformanceMarkers.load),performance.measure("fullLoadTime",t.PerformanceMarkers.create,t.PerformanceMarkers.fullLoad);const c=performance.getEntriesByName("loadTime")[0].duration,s=performance.getEntriesByName("fullLoadTime")[0].duration,h=Jh.length,v=1/(Jh.reduce((k,L)=>k+L,0)/h/1e3),M=Jh.filter(k=>k>wf).reduce((k,L)=>k+(L-wf)/wf,0);return{loadTime:c,fullLoadTime:s,fps:v,percentDroppedFrames:M/(h+M)*100}}};t.AJAXError=hn,t.ARRAY_TYPE=jr,t.Actor=class{constructor(c,s,h){this.target=c,this.parent=s,this.mapId=h,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Kt(["receive","process"],this),this.invoker=new Sm(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ri()?c:window}send(c,s,h,v,M=!1){const k=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(this.callbacks[k]=h);const L=fr(this.globalScope)?void 0:[];return this.target.postMessage({id:k,type:c,hasCallback:!!h,targetMapId:v,mustQueue:M,sourceMapId:this.mapId,data:yl(s,L)},L),{cancel:()=>{h&&delete this.callbacks[k],this.target.postMessage({id:k,type:"<cancel>",targetMapId:v,sourceMapId:this.mapId})}}}receive(c){const s=c.data,h=s.id;if(h&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){delete this.tasks[h];const v=this.cancelCallbacks[h];delete this.cancelCallbacks[h],v&&v()}else ri()||s.mustQueue?(this.tasks[h]=s,this.taskQueue.push(h),this.invoker.trigger()):this.processTask(h,s)}process(){if(!this.taskQueue.length)return;const c=this.taskQueue.shift(),s=this.tasks[c];delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),s&&this.processTask(c,s)}processTask(c,s){if(s.type==="<response>"){const h=this.callbacks[c];delete this.callbacks[c],h&&(s.error?h(Ko(s.error)):h(null,Ko(s.data)))}else{let h=!1;const v=fr(this.globalScope)?void 0:[],M=s.hasCallback?(V,Z)=>{h=!0,delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:V?yl(V):null,data:yl(Z,v)},v)}:V=>{h=!0};let k=null;const L=Ko(s.data);if(this.parent[s.type])k=this.parent[s.type](s.sourceMapId,L,M);else if(this.parent.getWorkerSource){const V=s.type.split(".");k=this.parent.getWorkerSource(s.sourceMapId,V[0],L.source)[V[1]](L,M)}else M(new Error(`Could not find function ${s.type}`));!h&&k&&k.cancel&&(this.cancelCallbacks[c]=k.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.AlphaImage=v1,t.CanonicalTileID=dh,t.CollisionBoxArray=ii,t.CollisionCircleLayoutArray=class extends le{},t.Color=ge,t.DEMData=xf,t.DataConstantProperty=Ji,t.DictionaryCoder=Od,t.EXTENT=Zt,t.ErrorEvent=Zs,t.EvaluationParameters=Cn,t.Event=Eo,t.Evented=qn,t.FeatureIndex=F1,t.FillBucket=jh,t.FillExtrusionBucket=oo,t.GeoJSONFeature=Ud,t.ImageAtlas=pm,t.ImagePosition=Cp,t.LineBucket=Q0,t.LineStripIndexArray=class extends Ke{},t.LngLat=Wn,t.LngLatBounds=Yh,t.MercatorCoordinate=B1,t.ONE_EM=cs,t.OverscaledTileID=yn,t.PerformanceUtils=Dm,t.PosArray=ir,t.Properties=ho,t.QuadTriangleArray=class extends be{},t.RGBAImage=Ja,t.RasterBoundsArray=class extends S{},t.RequestPerformance=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},t.ResourceType=wn,t.SegmentVector=d,t.SymbolBucket=uh,t.Transitionable=Fi,t.TriangleIndexArray=Qo,t.Uniform1f=Ce,t.Uniform1i=class extends Ie{constructor(c,s){super(c,s),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},t.Uniform2f=class extends Ie{constructor(c,s){super(c,s),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},t.Uniform3f=class extends Ie{constructor(c,s){super(c,s),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},t.Uniform4f=ze,t.UniformColor=ae,t.UniformMatrix4f=class extends Ie{constructor(c,s){super(c,s),this.current=Me}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let s=1;s<16;s++)if(c[s]!==this.current[s]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},t.UnwrappedTileID=zm,t.ValidationError=Mi,t.ZoomHistory=zc,t.add=function(c,s,h){return c[0]=s[0]+h[0],c[1]=s[1]+h[1],c[2]=s[2]+h[2],c},t.addDynamicAttributes=mf,t.asyncAll=function(c,s,h){if(!c.length)return h(null,[]);let v=c.length;const M=new Array(c.length);let k=null;c.forEach((L,V)=>{s(L,(Z,J)=>{Z&&(k=Z),M[V]=J,--v==0&&h(k,M)})})},t.bezier=ye,t.bindAll=Kt,t.cacheEntryPossiblyAdded=function(c){rn++,rn>mr&&(c.getActor().send("enforceCacheSizeLimit",lr),rn=0)},t.clamp=ne,t.clearTileCache=function(c){const s=caches.delete(hi);c&&s.catch(c).then(()=>c())},t.clipLine=Lp,t.clone=function(c){var s=new jr(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},t.clone$1=je,t.clone$2=function(c){var s=new jr(3);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s},t.collisionCircleLayout=sf,t.config=pt,t.copy=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},t.create=function(){var c=new jr(16);return jr!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},t.create$1=an,t.createExpression=Yl,t.createFilter=fl,t.createLayout=no,t.createStyleLayer=function(c){return c.type==="custom"?new gf(c):new Vp[c.type](c)},t.cross=function(c,s,h){var v=s[0],M=s[1],k=s[2],L=h[0],V=h[1],Z=h[2];return c[0]=M*Z-k*V,c[1]=k*L-v*Z,c[2]=v*V-M*L,c},t.dot=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]},t.dot$1=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]*s[3]},t.ease=he,t.emitValidationErrors=Qu,t.enforceCacheSizeLimit=function(c){Vr(),Si&&Si.then(s=>{s.keys().then(h=>{for(let v=0;v<h.length-c;v++)s.delete(h[v])})})},t.equals=function(c,s){var h=c[0],v=c[1],M=c[2],k=c[3],L=c[4],V=c[5],Z=c[6],J=c[7],se=c[8],ue=c[9],xe=c[10],Te=c[11],Se=c[12],Qe=c[13],Xe=c[14],Et=c[15],Gt=s[0],wt=s[1],Ut=s[2],ai=s[3],li=s[4],Hi=s[5],tr=s[6],Vi=s[7],Li=s[8],zi=s[9],$i=s[10],Ni=s[11],bi=s[12],ar=s[13],nr=s[14],zr=s[15];return Math.abs(h-Gt)<=Wr*Math.max(1,Math.abs(h),Math.abs(Gt))&&Math.abs(v-wt)<=Wr*Math.max(1,Math.abs(v),Math.abs(wt))&&Math.abs(M-Ut)<=Wr*Math.max(1,Math.abs(M),Math.abs(Ut))&&Math.abs(k-ai)<=Wr*Math.max(1,Math.abs(k),Math.abs(ai))&&Math.abs(L-li)<=Wr*Math.max(1,Math.abs(L),Math.abs(li))&&Math.abs(V-Hi)<=Wr*Math.max(1,Math.abs(V),Math.abs(Hi))&&Math.abs(Z-tr)<=Wr*Math.max(1,Math.abs(Z),Math.abs(tr))&&Math.abs(J-Vi)<=Wr*Math.max(1,Math.abs(J),Math.abs(Vi))&&Math.abs(se-Li)<=Wr*Math.max(1,Math.abs(se),Math.abs(Li))&&Math.abs(ue-zi)<=Wr*Math.max(1,Math.abs(ue),Math.abs(zi))&&Math.abs(xe-$i)<=Wr*Math.max(1,Math.abs(xe),Math.abs($i))&&Math.abs(Te-Ni)<=Wr*Math.max(1,Math.abs(Te),Math.abs(Ni))&&Math.abs(Se-bi)<=Wr*Math.max(1,Math.abs(Se),Math.abs(bi))&&Math.abs(Qe-ar)<=Wr*Math.max(1,Math.abs(Qe),Math.abs(ar))&&Math.abs(Xe-nr)<=Wr*Math.max(1,Math.abs(Xe),Math.abs(nr))&&Math.abs(Et-zr)<=Wr*Math.max(1,Math.abs(Et),Math.abs(zr))},t.evaluateSizeForFeature=function(c,{uSize:s,uSizeT:h},{lowerSize:v,upperSize:M}){return c.kind==="source"?v/Vc:c.kind==="composite"?Bn(v/Vc,M/Vc,h):s},t.evaluateSizeForZoom=function(c,s){let h=0,v=0;if(c.kind==="constant")v=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:M,minZoom:k,maxZoom:L}=c,V=M?ne(as.interpolationFactor(M,s,k,L),0,1):0;c.kind==="camera"?v=Bn(c.minSize,c.maxSize,V):h=V}return{uSizeT:h,uSize:v}},t.evaluateVariableOffset=Kh,t.evented=wl,t.exported=$t,t.exported$1=nn,t.extend=lt,t.filterObject=Le,t.fromRotation=function(c,s){var h=Math.sin(s),v=Math.cos(s);return c[0]=v,c[1]=h,c[2]=0,c[3]=-h,c[4]=v,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},t.fromScaling=function(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},t.getAnchorAlignment=es,t.getAnchorJustification=L1,t.getArrayBuffer=ra,t.getImage=gs,t.getJSON=function(c,s){return Vn(lt(c,{type:"json"}),s)},t.getOverlapMode=_f,t.getRTLTextPluginStatus=Ta,t.getReferrer=$s,t.getVideo=function(c,s){const h=window.document.createElement("video");h.muted=!0,h.onloadstart=function(){s(null,h)};for(let v=0;v<c.length;v++){const M=window.document.createElement("source");ns(c[v])||(h.crossOrigin="Anonymous"),M.src=c[v],h.appendChild(M)}return{cancel:()=>{}}},t.identity=lo,t.invert=function(c,s){var h=s[0],v=s[1],M=s[2],k=s[3],L=s[4],V=s[5],Z=s[6],J=s[7],se=s[8],ue=s[9],xe=s[10],Te=s[11],Se=s[12],Qe=s[13],Xe=s[14],Et=s[15],Gt=h*V-v*L,wt=h*Z-M*L,Ut=h*J-k*L,ai=v*Z-M*V,li=v*J-k*V,Hi=M*J-k*Z,tr=se*Qe-ue*Se,Vi=se*Xe-xe*Se,Li=se*Et-Te*Se,zi=ue*Xe-xe*Qe,$i=ue*Et-Te*Qe,Ni=xe*Et-Te*Xe,bi=Gt*Ni-wt*$i+Ut*zi+ai*Li-li*Vi+Hi*tr;return bi?(c[0]=(V*Ni-Z*$i+J*zi)*(bi=1/bi),c[1]=(M*$i-v*Ni-k*zi)*bi,c[2]=(Qe*Hi-Xe*li+Et*ai)*bi,c[3]=(xe*li-ue*Hi-Te*ai)*bi,c[4]=(Z*Li-L*Ni-J*Vi)*bi,c[5]=(h*Ni-M*Li+k*Vi)*bi,c[6]=(Xe*Ut-Se*Hi-Et*wt)*bi,c[7]=(se*Hi-xe*Ut+Te*wt)*bi,c[8]=(L*$i-V*Li+J*tr)*bi,c[9]=(v*Li-h*$i-k*tr)*bi,c[10]=(Se*li-Qe*Ut+Et*Gt)*bi,c[11]=(ue*Ut-se*li-Te*Gt)*bi,c[12]=(V*Vi-L*zi-Z*tr)*bi,c[13]=(h*zi-v*Vi+M*tr)*bi,c[14]=(Qe*wt-Se*ai-Xe*Gt)*bi,c[15]=(se*ai-ue*wt+xe*Gt)*bi,c):null},t.isImageBitmap=Qt,t.isSafari=fr,t.isWorker=ri,t.keysDifference=function(c,s){const h=[];for(const v in c)v in s||h.push(v);return h},t.lazyLoadRTLTextPlugin=function(){Jo.isLoading()||Jo.isLoaded()||Ta()!=="deferred"||ih()},t.makeRequest=Vn,t.mapObject=Ne,t.mercatorXfromLng=Im,t.mercatorYfromLat=Am,t.mercatorZfromAltitude=Pm,t.mul=Ys,t.mul$1=function(c,s,h){return c[0]=s[0]*h[0],c[1]=s[1]*h[1],c[2]=s[2]*h[2],c[3]=s[3]*h[3],c},t.multiply=Is,t.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},t.normalize=function(c,s){var h=s[0],v=s[1],M=s[2],k=h*h+v*v+M*M;return k>0&&(k=1/Math.sqrt(k)),c[0]=s[0]*k,c[1]=s[1]*k,c[2]=s[2]*k,c},t.number=Bn,t.ortho=function(c,s,h,v,M,k,L){var V=1/(s-h),Z=1/(v-M),J=1/(k-L);return c[0]=-2*V,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*Z,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*J,c[11]=0,c[12]=(s+h)*V,c[13]=(M+v)*Z,c[14]=(L+k)*J,c[15]=1,c},t.parseCacheControl=zt,t.parseGlyphPbf=function(c){return new bu(c).readFields(hm,[])},t.pbf=bu,t.performSymbolLayout=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=Zt/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const s=c.bucket.layers[0].layout,h=c.bucket.layers[0]._unevaluatedLayout._values,v={layoutIconSize:h["icon-size"].possiblyEvaluate(new Cn(c.bucket.zoom+1),c.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new Cn(c.bucket.zoom+1),c.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new Cn(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:J}=c.bucket.textSizeData;v.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Cn(Z),c.canonical),h["text-size"].possiblyEvaluate(new Cn(J),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:J}=c.bucket.iconSizeData;v.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Cn(Z),c.canonical),h["icon-size"].possiblyEvaluate(new Cn(J),c.canonical)]}const M=s.get("text-line-height")*cs,k=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",L=s.get("text-keep-upright"),V=s.get("text-size");for(const Z of c.bucket.features){const J=s.get("text-font").evaluate(Z,{},c.canonical).join(","),se=V.evaluate(Z,{},c.canonical),ue=v.layoutTextSize.evaluate(Z,{},c.canonical),xe=v.layoutIconSize.evaluate(Z,{},c.canonical),Te={horizontal:{},vertical:void 0},Se=Z.text;let Qe,Xe=[0,0];if(Se){const wt=Se.toString(),Ut=s.get("text-letter-spacing").evaluate(Z,{},c.canonical)*cs,ai=_1(wt)?Ut:0,li=s.get("text-anchor").evaluate(Z,{},c.canonical),Hi=s.get("text-variable-anchor");if(!Hi){const $i=s.get("text-radial-offset").evaluate(Z,{},c.canonical);Xe=$i?Kh(li,[$i*cs,ff]):s.get("text-offset").evaluate(Z,{},c.canonical).map(Ni=>Ni*cs)}let tr=k?"center":s.get("text-justify").evaluate(Z,{},c.canonical);const Vi=s.get("symbol-placement"),Li=Vi==="point"?s.get("text-max-width").evaluate(Z,{},c.canonical)*cs:0,zi=()=>{c.bucket.allowVerticalPlacement&&xl(wt)&&(Te.vertical=ac(Se,c.glyphMap,c.glyphPositions,c.imagePositions,J,Li,M,li,"left",ai,Xe,t.WritingMode.vertical,!0,Vi,ue,se))};if(!k&&Hi){const $i=tr==="auto"?Hi.map(bi=>L1(bi)):[tr];let Ni=!1;for(let bi=0;bi<$i.length;bi++){const ar=$i[bi];if(!Te.horizontal[ar])if(Ni)Te.horizontal[ar]=Te.horizontal[0];else{const nr=ac(Se,c.glyphMap,c.glyphPositions,c.imagePositions,J,Li,M,"center",ar,ai,Xe,t.WritingMode.horizontal,!1,Vi,ue,se);nr&&(Te.horizontal[ar]=nr,Ni=nr.positionedLines.length===1)}}zi()}else{tr==="auto"&&(tr=L1(li));const $i=ac(Se,c.glyphMap,c.glyphPositions,c.imagePositions,J,Li,M,li,tr,ai,Xe,t.WritingMode.horizontal,!1,Vi,ue,se);$i&&(Te.horizontal[tr]=$i),zi(),xl(wt)&&k&&L&&(Te.vertical=ac(Se,c.glyphMap,c.glyphPositions,c.imagePositions,J,Li,M,li,tr,ai,Xe,t.WritingMode.vertical,!1,Vi,ue,se))}}let Et=!1;if(Z.icon&&Z.icon.name){const wt=c.imageMap[Z.icon.name];wt&&(Qe=z1(c.imagePositions[Z.icon.name],s.get("icon-offset").evaluate(Z,{},c.canonical),s.get("icon-anchor").evaluate(Z,{},c.canonical)),Et=!!wt.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=Et:c.bucket.sdfIcons!==Et&&St("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(wt.pixelRatio!==c.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const Gt=vm(Te.horizontal)||Te.vertical;c.bucket.iconsInText=!!Gt&&Gt.iconsInText,(Gt||Qe)&&ym(c.bucket,Z,Te,Qe,c.imageMap,v,ue,xe,Xe,Et,c.canonical)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},t.perspective=function(c,s,h,v,M){var k,L=1/Math.tan(s/2);return c[0]=L/h,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=L,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,M!=null&&M!==1/0?(c[10]=(M+v)*(k=1/(v-M)),c[14]=2*M*v*k):(c[10]=-1,c[14]=-2*v),c},t.pick=function(c,s){const h={};for(let v=0;v<s.length;v++){const M=s[v];M in c&&(h[M]=c[M])}return h},t.plugin=Jo,t.pointGeometry=Mt,t.polygonIntersectsPolygon=xi,t.potpack=Mp,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=Gi,t.registerForPluginStateChange=function(c){return c({pluginStatus:Do,pluginURL:Yo}),wl.on("pluginStateChange",c),c},t.renderColorRamp=gp,t.rotateX=function(c,s,h){var v=Math.sin(h),M=Math.cos(h),k=s[4],L=s[5],V=s[6],Z=s[7],J=s[8],se=s[9],ue=s[10],xe=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=k*M+J*v,c[5]=L*M+se*v,c[6]=V*M+ue*v,c[7]=Z*M+xe*v,c[8]=J*M-k*v,c[9]=se*M-L*v,c[10]=ue*M-V*v,c[11]=xe*M-Z*v,c},t.rotateZ=function(c,s,h){var v=Math.sin(h),M=Math.cos(h),k=s[0],L=s[1],V=s[2],Z=s[3],J=s[4],se=s[5],ue=s[6],xe=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=k*M+J*v,c[1]=L*M+se*v,c[2]=V*M+ue*v,c[3]=Z*M+xe*v,c[4]=J*M-k*v,c[5]=se*M-L*v,c[6]=ue*M-V*v,c[7]=xe*M-Z*v,c},t.scale=function(c,s,h){var v=h[0],M=h[1],k=h[2];return c[0]=s[0]*v,c[1]=s[1]*v,c[2]=s[2]*v,c[3]=s[3]*v,c[4]=s[4]*M,c[5]=s[5]*M,c[6]=s[6]*M,c[7]=s[7]*M,c[8]=s[8]*k,c[9]=s[9]*k,c[10]=s[10]*k,c[11]=s[11]*k,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},t.scale$1=function(c,s,h){return c[0]=s[0]*h,c[1]=s[1]*h,c[2]=s[2]*h,c},t.setCacheLimits=function(c,s){lr=c,mr=s},t.setRTLTextPlugin=function(c,s,h=!1){if(Do===eh||Do===Lc||Do===bl)throw new Error("setRTLTextPlugin cannot be called multiple times.");Yo=$t.resolveURL(c),Do=eh,th=s,Xa(),h||ih()},t.spec=qt,t.sphericalToCartesian=function([c,s,h]){return s+=90,s*=Math.PI/180,h*=Math.PI/180,{x:c*Math.cos(s)*Math.sin(h),y:c*Math.sin(s)*Math.sin(h),z:c*Math.cos(h)}},t.sqrLen=function(c){var s=c[0],h=c[1];return s*s+h*h},t.sub=function(c,s,h){return c[0]=s[0]-h[0],c[1]=s[1]-h[1],c[2]=s[2]-h[2],c},t.toEvaluationFeature=ei,t.transformMat3=function(c,s,h){var v=s[0],M=s[1],k=s[2];return c[0]=v*h[0]+M*h[3]+k*h[6],c[1]=v*h[1]+M*h[4]+k*h[7],c[2]=v*h[2]+M*h[5]+k*h[8],c},t.transformMat4=Fc,t.transformMat4$1=function(c,s,h){var v=s[0],M=s[1];return c[0]=h[0]*v+h[4]*M+h[12],c[1]=h[1]*v+h[5]*M+h[13],c},t.translate=function(c,s,h){var v,M,k,L,V,Z,J,se,ue,xe,Te,Se,Qe=h[0],Xe=h[1],Et=h[2];return s===c?(c[12]=s[0]*Qe+s[4]*Xe+s[8]*Et+s[12],c[13]=s[1]*Qe+s[5]*Xe+s[9]*Et+s[13],c[14]=s[2]*Qe+s[6]*Xe+s[10]*Et+s[14],c[15]=s[3]*Qe+s[7]*Xe+s[11]*Et+s[15]):(M=s[1],k=s[2],L=s[3],V=s[4],Z=s[5],J=s[6],se=s[7],ue=s[8],xe=s[9],Te=s[10],Se=s[11],c[0]=v=s[0],c[1]=M,c[2]=k,c[3]=L,c[4]=V,c[5]=Z,c[6]=J,c[7]=se,c[8]=ue,c[9]=xe,c[10]=Te,c[11]=Se,c[12]=v*Qe+V*Xe+ue*Et+s[12],c[13]=M*Qe+Z*Xe+xe*Et+s[13],c[14]=k*Qe+J*Xe+Te*Et+s[14],c[15]=L*Qe+se*Xe+Se*Et+s[15]),c},t.triggerPluginCompletionEvent=Fh,t.unicodeBlockLookup=Pi,t.uniqueId=function(){return at++},t.validateCustomStyleLayer=function(c){const s=[],h=c.id;return h===void 0&&s.push({message:`layers.${h}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${h}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),s},t.validateLight=Rh,t.validateStyle=du,t.vectorTile=sh,t.warnOnce=St,t.wrap=Ye}),P(["./shared"],function(t){function j(pe){const Y=typeof pe;if(Y==="number"||Y==="boolean"||Y==="string"||pe==null)return JSON.stringify(pe);if(Array.isArray(pe)){let ge="[";for(const ke of pe)ge+=`${j(ke)},`;return`${ge}]`}const re=Object.keys(pe).sort();let fe="{";for(let ge=0;ge<re.length;ge++)fe+=`${JSON.stringify(re[ge])}:${j(pe[re[ge]])},`;return`${fe}}`}function ie(pe){let Y="";for(const re of t.refProperties)Y+=`/${j(pe[re])}`;return Y}class ye{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,re){for(const ge of Y){this._layerConfigs[ge.id]=ge;const ke=this._layers[ge.id]=t.createStyleLayer(ge);ke._featureFilter=t.createFilter(ke.filter),this.keyCache[ge.id]&&delete this.keyCache[ge.id]}for(const ge of re)delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge];this.familiesBySource={};const fe=function(ge,ke){const Ze={};for(let Ve=0;Ve<ge.length;Ve++){const ut=ke&&ke[ge[Ve].id]||ie(ge[Ve]);ke&&(ke[ge[Ve].id]=ut);let Dt=Ze[ut];Dt||(Dt=Ze[ut]=[]),Dt.push(ge[Ve])}const $e=[];for(const Ve in Ze)$e.push(Ze[Ve]);return $e}(Object.values(this._layerConfigs),this.keyCache);for(const ge of fe){const ke=ge.map(Ht=>this._layers[Ht.id]),Ze=ke[0];if(Ze.visibility==="none")continue;const $e=Ze.source||"";let Ve=this.familiesBySource[$e];Ve||(Ve=this.familiesBySource[$e]={});const ut=Ze.sourceLayer||"_geojsonTileLayer";let Dt=Ve[ut];Dt||(Dt=Ve[ut]=[]),Dt.push(ke)}}}class he{constructor(Y){const re={},fe=[];for(const $e in Y){const Ve=Y[$e],ut=re[$e]={};for(const Dt in Ve){const Ht=Ve[+Dt];if(!Ht||Ht.bitmap.width===0||Ht.bitmap.height===0)continue;const ft={x:0,y:0,w:Ht.bitmap.width+2,h:Ht.bitmap.height+2};fe.push(ft),ut[Dt]={rect:ft,metrics:Ht.metrics}}}const{w:ge,h:ke}=t.potpack(fe),Ze=new t.AlphaImage({width:ge||1,height:ke||1});for(const $e in Y){const Ve=Y[$e];for(const ut in Ve){const Dt=Ve[+ut];if(!Dt||Dt.bitmap.width===0||Dt.bitmap.height===0)continue;const Ht=re[$e][ut].rect;t.AlphaImage.copy(Dt.bitmap,Ze,{x:0,y:0},{x:Ht.x+1,y:Ht.y+1},Dt.bitmap)}}this.image=Ze,this.positions=re}}t.register("GlyphAtlas",he);class ne{constructor(Y){this.tileID=new t.OverscaledTileID(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.uid=Y.uid,this.zoom=Y.zoom,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.collectResourceTiming,this.returnDependencies=!!Y.returnDependencies,this.promoteId=Y.promoteId}parse(Y,re,fe,ge,ke){this.status="parsing",this.data=Y,this.collisionBoxArray=new t.CollisionBoxArray;const Ze=new t.DictionaryCoder(Object.keys(Y.layers).sort()),$e=new t.FeatureIndex(this.tileID,this.promoteId);$e.bucketLayerIDs=[];const Ve={},ut={featureIndex:$e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:fe},Dt=re.familiesBySource[this.source];for(const hr in Dt){const wr=Y.layers[hr];if(!wr)continue;wr.version===1&&t.warnOnce(`Vector tile source "${this.source}" layer "${hr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Mr=Ze.encode(hr),Qi=[];for(let Pr=0;Pr<wr.length;Pr++){const It=wr.feature(Pr),Tn=$e.getId(It,hr);Qi.push({feature:It,id:Tn,index:Pr,sourceLayerIndex:Mr})}for(const Pr of Dt[hr]){const It=Pr[0];It.source!==this.source&&t.warnOnce(`layer.source = ${It.source} does not equal this.source = ${this.source}`),It.minzoom&&this.zoom<Math.floor(It.minzoom)||It.maxzoom&&this.zoom>=It.maxzoom||It.visibility!=="none"&&(Ye(Pr,this.zoom,fe),(Ve[It.id]=It.createBucket({index:$e.bucketLayerIDs.length,layers:Pr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Mr,sourceID:this.source})).populate(Qi,ut,this.tileID.canonical),$e.bucketLayerIDs.push(Pr.map(Tn=>Tn.id)))}}let Ht,ft,ji,Zi;const Ai=t.mapObject(ut.glyphDependencies,hr=>Object.keys(hr).map(Number));Object.keys(Ai).length?ge.send("getGlyphs",{uid:this.uid,stacks:Ai},(hr,wr)=>{Ht||(Ht=hr,ft=wr,br.call(this))}):ft={};const Yi=Object.keys(ut.iconDependencies);Yi.length?ge.send("getImages",{icons:Yi,source:this.source,tileID:this.tileID,type:"icons"},(hr,wr)=>{Ht||(Ht=hr,ji=wr,br.call(this))}):ji={};const rr=Object.keys(ut.patternDependencies);function br(){if(Ht)return ke(Ht);if(ft&&ji&&Zi){const hr=new he(ft),wr=new t.ImageAtlas(ji,Zi);for(const Mr in Ve){const Qi=Ve[Mr];Qi instanceof t.SymbolBucket?(Ye(Qi.layers,this.zoom,fe),t.performSymbolLayout({bucket:Qi,glyphMap:ft,glyphPositions:hr.positions,imageMap:ji,imagePositions:wr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Qi.hasPattern&&(Qi instanceof t.LineBucket||Qi instanceof t.FillBucket||Qi instanceof t.FillExtrusionBucket)&&(Ye(Qi.layers,this.zoom,fe),Qi.addFeatures(ut,this.tileID.canonical,wr.patternPositions))}this.status="done",ke(null,{buckets:Object.values(Ve).filter(Mr=>!Mr.isEmpty()),featureIndex:$e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:hr.image,imageAtlas:wr,glyphMap:this.returnDependencies?ft:null,iconMap:this.returnDependencies?ji:null,glyphPositions:this.returnDependencies?hr.positions:null})}}rr.length?ge.send("getImages",{icons:rr,source:this.source,tileID:this.tileID,type:"patterns"},(hr,wr)=>{Ht||(Ht=hr,Zi=wr,br.call(this))}):Zi={},br.call(this)}}function Ye(pe,Y,re){const fe=new t.EvaluationParameters(Y);for(const ge of pe)ge.recalculate(fe,re)}function lt(pe,Y){const re=t.getArrayBuffer(pe.request,(fe,ge,ke,Ze)=>{fe?Y(fe):ge&&Y(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(ge)),rawData:ge,cacheControl:ke,expires:Ze})});return()=>{re.cancel(),Y()}}class at{constructor(Y,re,fe,ge){this.actor=Y,this.layerIndex=re,this.availableImages=fe,this.loadVectorData=ge||lt,this.loading={},this.loaded={}}loadTile(Y,re){const fe=Y.uid;this.loading||(this.loading={});const ge=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new t.RequestPerformance(Y.request),ke=this.loading[fe]=new ne(Y);ke.abort=this.loadVectorData(Y,(Ze,$e)=>{if(delete this.loading[fe],Ze||!$e)return ke.status="done",this.loaded[fe]=ke,re(Ze);const Ve=$e.rawData,ut={};$e.expires&&(ut.expires=$e.expires),$e.cacheControl&&(ut.cacheControl=$e.cacheControl);const Dt={};if(ge){const Ht=ge.finish();Ht&&(Dt.resourceTiming=JSON.parse(JSON.stringify(Ht)))}ke.vectorTile=$e.vectorTile,ke.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ht,ft)=>{if(Ht||!ft)return re(Ht);re(null,t.extend({rawTileData:Ve.slice(0)},ft,ut,Dt))}),this.loaded=this.loaded||{},this.loaded[fe]=ke})}reloadTile(Y,re){const fe=this.loaded,ge=Y.uid,ke=this;if(fe&&fe[ge]){const Ze=fe[ge];Ze.showCollisionBoxes=Y.showCollisionBoxes;const $e=(Ve,ut)=>{const Dt=Ze.reloadCallback;Dt&&(delete Ze.reloadCallback,Ze.parse(Ze.vectorTile,ke.layerIndex,this.availableImages,ke.actor,Dt)),re(Ve,ut)};Ze.status==="parsing"?Ze.reloadCallback=$e:Ze.status==="done"&&(Ze.vectorTile?Ze.parse(Ze.vectorTile,this.layerIndex,this.availableImages,this.actor,$e):$e())}}abortTile(Y,re){const fe=this.loading,ge=Y.uid;fe&&fe[ge]&&fe[ge].abort&&(fe[ge].abort(),delete fe[ge]),re()}removeTile(Y,re){const fe=this.loaded,ge=Y.uid;fe&&fe[ge]&&delete fe[ge],re()}}class Kt{constructor(){this.loaded={}}loadTile(Y,re){const{uid:fe,encoding:ge,rawImageData:ke}=Y,Ze=t.isImageBitmap(ke)?this.getImageData(ke):ke,$e=new t.DEMData(fe,Ze,ge);this.loaded=this.loaded||{},this.loaded[fe]=$e,re(null,$e)}getImageData(Y){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const re=this.offscreenCanvasContext.getImageData(-1,-1,Y.width+2,Y.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:re.width,height:re.height},re.data)}removeTile(Y){const re=this.loaded,fe=Y.uid;re&&re[fe]&&delete re[fe]}}var Ne=function pe(Y,re){var fe,ge=Y&&Y.type;if(ge==="FeatureCollection")for(fe=0;fe<Y.features.length;fe++)pe(Y.features[fe],re);else if(ge==="GeometryCollection")for(fe=0;fe<Y.geometries.length;fe++)pe(Y.geometries[fe],re);else if(ge==="Feature")pe(Y.geometry,re);else if(ge==="Polygon")Le(Y.coordinates,re);else if(ge==="MultiPolygon")for(fe=0;fe<Y.coordinates.length;fe++)Le(Y.coordinates[fe],re);return Y};function Le(pe,Y){if(pe.length!==0){je(pe[0],Y);for(var re=1;re<pe.length;re++)je(pe[re],!Y)}}function je(pe,Y){for(var re=0,fe=0,ge=0,ke=pe.length,Ze=ke-1;ge<ke;Ze=ge++){var $e=(pe[ge][0]-pe[Ze][0])*(pe[Ze][1]+pe[ge][1]),Ve=re+$e;fe+=Math.abs(re)>=Math.abs($e)?re-Ve+$e:$e-Ve+re,re=Ve}re+fe>=0!=!!Y&&pe.reverse()}const _t=t.vectorTile.VectorTileFeature.prototype.toGeoJSON;class St{constructor(Y){this._feature=Y,this.extent=t.EXTENT,this.type=Y.type,this.properties=Y.tags,"id"in Y&&!isNaN(Y.id)&&(this.id=parseInt(Y.id,10))}loadGeometry(){if(this._feature.type===1){const Y=[];for(const re of this._feature.geometry)Y.push([new t.pointGeometry(re[0],re[1])]);return Y}{const Y=[];for(const re of this._feature.geometry){const fe=[];for(const ge of re)fe.push(new t.pointGeometry(ge[0],ge[1]));Y.push(fe)}return Y}}toGeoJSON(Y,re,fe){return _t.call(this,Y,re,fe)}}class ci{constructor(Y){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=Y.length,this._features=Y}feature(Y){return new St(this._features[Y])}}var dt={exports:{}},ri=t.pointGeometry,zt=t.vectorTile.VectorTileFeature,Ci=yr;function yr(pe,Y){this.options=Y||{},this.features=pe,this.length=pe.length}function ki(pe,Y){this.id=typeof pe.id=="number"?pe.id:void 0,this.type=pe.type,this.rawGeometry=pe.type===1?[pe.geometry]:pe.geometry,this.properties=pe.tags,this.extent=Y||4096}yr.prototype.feature=function(pe){return new ki(this.features[pe],this.options.extent)},ki.prototype.loadGeometry=function(){var pe=this.rawGeometry;this.geometry=[];for(var Y=0;Y<pe.length;Y++){for(var re=pe[Y],fe=[],ge=0;ge<re.length;ge++)fe.push(new ri(re[ge][0],re[ge][1]));this.geometry.push(fe)}return this.geometry},ki.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var pe=this.geometry,Y=1/0,re=-1/0,fe=1/0,ge=-1/0,ke=0;ke<pe.length;ke++)for(var Ze=pe[ke],$e=0;$e<Ze.length;$e++){var Ve=Ze[$e];Y=Math.min(Y,Ve.x),re=Math.max(re,Ve.x),fe=Math.min(fe,Ve.y),ge=Math.max(ge,Ve.y)}return[Y,fe,re,ge]},ki.prototype.toGeoJSON=zt.prototype.toGeoJSON;var fr=t.pbf,Qt=Ci;function $t(pe){var Y=new fr;return function(re,fe){for(var ge in re.layers)fe.writeMessage(3,Mt,re.layers[ge])}(pe,Y),Y.finish()}function Mt(pe,Y){var re;Y.writeVarintField(15,pe.version||1),Y.writeStringField(1,pe.name||""),Y.writeVarintField(5,pe.extent||4096);var fe={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<pe.length;re++)fe.feature=pe.feature(re),Y.writeMessage(2,ui,fe);var ge=fe.keys;for(re=0;re<ge.length;re++)Y.writeStringField(3,ge[re]);var ke=fe.values;for(re=0;re<ke.length;re++)Y.writeMessage(4,lr,ke[re])}function ui(pe,Y){var re=pe.feature;re.id!==void 0&&Y.writeVarintField(1,re.id),Y.writeMessage(2,pt,pe),Y.writeVarintField(3,re.type),Y.writeMessage(4,Wi,re)}function pt(pe,Y){var re=pe.feature,fe=pe.keys,ge=pe.values,ke=pe.keycache,Ze=pe.valuecache;for(var $e in re.properties){var Ve=re.properties[$e],ut=ke[$e];if(Ve!==null){ut===void 0&&(fe.push($e),ke[$e]=ut=fe.length-1),Y.writeVarint(ut);var Dt=typeof Ve;Dt!=="string"&&Dt!=="boolean"&&Dt!=="number"&&(Ve=JSON.stringify(Ve));var Ht=Dt+":"+Ve,ft=Ze[Ht];ft===void 0&&(ge.push(Ve),Ze[Ht]=ft=ge.length-1),Y.writeVarint(ft)}}}function hi(pe,Y){return(Y<<3)+(7&pe)}function Si(pe){return pe<<1^pe>>31}function Wi(pe,Y){for(var re=pe.loadGeometry(),fe=pe.type,ge=0,ke=0,Ze=re.length,$e=0;$e<Ze;$e++){var Ve=re[$e],ut=1;fe===1&&(ut=Ve.length),Y.writeVarint(hi(1,ut));for(var Dt=fe===3?Ve.length-1:Ve.length,Ht=0;Ht<Dt;Ht++){Ht===1&&fe!==1&&Y.writeVarint(hi(2,Dt-1));var ft=Ve[Ht].x-ge,ji=Ve[Ht].y-ke;Y.writeVarint(Si(ft)),Y.writeVarint(Si(ji)),ge+=ft,ke+=ji}fe===3&&Y.writeVarint(hi(7,1))}}function lr(pe,Y){var re=typeof pe;re==="string"?Y.writeStringField(1,pe):re==="boolean"?Y.writeBooleanField(7,pe):re==="number"&&(pe%1!=0?Y.writeDoubleField(3,pe):pe<0?Y.writeSVarintField(6,pe):Y.writeVarintField(5,pe))}function mr(pe,Y,re,fe,ge,ke){if(ge-fe<=re)return;const Ze=fe+ge>>1;Vr(pe,Y,Ze,fe,ge,ke%2),mr(pe,Y,re,fe,Ze-1,ke+1),mr(pe,Y,re,Ze+1,ge,ke+1)}function Vr(pe,Y,re,fe,ge,ke){for(;ge>fe;){if(ge-fe>600){const ut=ge-fe+1,Dt=re-fe+1,Ht=Math.log(ut),ft=.5*Math.exp(2*Ht/3),ji=.5*Math.sqrt(Ht*ft*(ut-ft)/ut)*(Dt-ut/2<0?-1:1);Vr(pe,Y,re,Math.max(fe,Math.floor(re-Dt*ft/ut+ji)),Math.min(ge,Math.floor(re+(ut-Dt)*ft/ut+ji)),ke)}const Ze=Y[2*re+ke];let $e=fe,Ve=ge;for(rn(pe,Y,fe,re),Y[2*ge+ke]>Ze&&rn(pe,Y,fe,ge);$e<Ve;){for(rn(pe,Y,$e,Ve),$e++,Ve--;Y[2*$e+ke]<Ze;)$e++;for(;Y[2*Ve+ke]>Ze;)Ve--}Y[2*fe+ke]===Ze?rn(pe,Y,fe,Ve):(Ve++,rn(pe,Y,Ve,ge)),Ve<=re&&(fe=Ve+1),re<=Ve&&(ge=Ve-1)}}function rn(pe,Y,re,fe){nn(pe,re,fe),nn(Y,2*re,2*fe),nn(Y,2*re+1,2*fe+1)}function nn(pe,Y,re){const fe=pe[Y];pe[Y]=pe[re],pe[re]=fe}function on(pe,Y,re,fe){const ge=pe-re,ke=Y-fe;return ge*ge+ke*ke}dt.exports=$t,dt.exports.fromVectorTileJs=$t,dt.exports.fromGeojsonVt=function(pe,Y){Y=Y||{};var re={};for(var fe in pe)re[fe]=new Qt(pe[fe].features,Y),re[fe].name=fe,re[fe].version=Y.version,re[fe].extent=Y.extent;return $t({layers:re})},dt.exports.GeoJSONWrapper=Qt;const mo=pe=>pe[0],eo=pe=>pe[1];class Rs{constructor(Y,re=mo,fe=eo,ge=64,ke=Float64Array){this.nodeSize=ge,this.points=Y;const Ze=Y.length<65536?Uint16Array:Uint32Array,$e=this.ids=new Ze(Y.length),Ve=this.coords=new ke(2*Y.length);for(let ut=0;ut<Y.length;ut++)$e[ut]=ut,Ve[2*ut]=re(Y[ut]),Ve[2*ut+1]=fe(Y[ut]);mr($e,Ve,ge,0,$e.length-1,0)}range(Y,re,fe,ge){return function(ke,Ze,$e,Ve,ut,Dt,Ht){const ft=[0,ke.length-1,0],ji=[];let Zi,Ai;for(;ft.length;){const Yi=ft.pop(),rr=ft.pop(),br=ft.pop();if(rr-br<=Ht){for(let Mr=br;Mr<=rr;Mr++)Zi=Ze[2*Mr],Ai=Ze[2*Mr+1],Zi>=$e&&Zi<=ut&&Ai>=Ve&&Ai<=Dt&&ji.push(ke[Mr]);continue}const hr=Math.floor((br+rr)/2);Zi=Ze[2*hr],Ai=Ze[2*hr+1],Zi>=$e&&Zi<=ut&&Ai>=Ve&&Ai<=Dt&&ji.push(ke[hr]);const wr=(Yi+1)%2;(Yi===0?$e<=Zi:Ve<=Ai)&&(ft.push(br),ft.push(hr-1),ft.push(wr)),(Yi===0?ut>=Zi:Dt>=Ai)&&(ft.push(hr+1),ft.push(rr),ft.push(wr))}return ji}(this.ids,this.coords,Y,re,fe,ge,this.nodeSize)}within(Y,re,fe){return function(ge,ke,Ze,$e,Ve,ut){const Dt=[0,ge.length-1,0],Ht=[],ft=Ve*Ve;for(;Dt.length;){const ji=Dt.pop(),Zi=Dt.pop(),Ai=Dt.pop();if(Zi-Ai<=ut){for(let wr=Ai;wr<=Zi;wr++)on(ke[2*wr],ke[2*wr+1],Ze,$e)<=ft&&Ht.push(ge[wr]);continue}const Yi=Math.floor((Ai+Zi)/2),rr=ke[2*Yi],br=ke[2*Yi+1];on(rr,br,Ze,$e)<=ft&&Ht.push(ge[Yi]);const hr=(ji+1)%2;(ji===0?Ze-Ve<=rr:$e-Ve<=br)&&(Dt.push(Ai),Dt.push(Yi-1),Dt.push(hr)),(ji===0?Ze+Ve>=rr:$e+Ve>=br)&&(Dt.push(Yi+1),Dt.push(Zi),Dt.push(hr))}return Ht}(this.ids,this.coords,Y,re,fe,this.nodeSize)}}const Ir={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:pe=>pe},wn=Math.fround||(hn=new Float32Array(1),pe=>(hn[0]=+pe,hn[0]));var hn;class $s{constructor(Y){this.options=gs(Object.create(Ir),Y),this.trees=new Array(this.options.maxZoom+1)}load(Y){const{log:re,minZoom:fe,maxZoom:ge,nodeSize:ke}=this.options;re&&console.time("total time");const Ze=`prepare ${Y.length} points`;re&&console.time(Ze),this.points=Y;let $e=[];for(let Ve=0;Ve<Y.length;Ve++)Y[Ve].geometry&&$e.push(Vn(Y[Ve],Ve));this.trees[ge+1]=new Rs($e,ys,to,ke,Float32Array),re&&console.timeEnd(Ze);for(let Ve=ge;Ve>=fe;Ve--){const ut=+Date.now();$e=this._cluster($e,Ve),this.trees[Ve]=new Rs($e,ys,to,ke,Float32Array),re&&console.log("z%d: %d clusters in %dms",Ve,$e.length,+Date.now()-ut)}return re&&console.timeEnd("total time"),this}getClusters(Y,re){let fe=((Y[0]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,Y[1]));let ke=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const Ze=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)fe=-180,ke=180;else if(fe>ke){const Dt=this.getClusters([fe,ge,180,Ze],re),Ht=this.getClusters([-180,ge,ke,Ze],re);return Dt.concat(Ht)}const $e=this.trees[this._limitZoom(re)],Ve=$e.range(xr(fe),Wo(Ze),xr(ke),Wo(ge)),ut=[];for(const Dt of Ve){const Ht=$e.points[Dt];ut.push(Ht.numPoints?ra(Ht):this.points[Ht.index])}return ut}getChildren(Y){const re=this._getOriginId(Y),fe=this._getOriginZoom(Y),ge="No cluster with the specified id.",ke=this.trees[fe];if(!ke)throw new Error(ge);const Ze=ke.points[re];if(!Ze)throw new Error(ge);const $e=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),Ve=ke.within(Ze.x,Ze.y,$e),ut=[];for(const Dt of Ve){const Ht=ke.points[Dt];Ht.parentId===Y&&ut.push(Ht.numPoints?ra(Ht):this.points[Ht.index])}if(ut.length===0)throw new Error(ge);return ut}getLeaves(Y,re,fe){const ge=[];return this._appendLeaves(ge,Y,re=re||10,fe=fe||0,0),ge}getTile(Y,re,fe){const ge=this.trees[this._limitZoom(Y)],ke=Math.pow(2,Y),{extent:Ze,radius:$e}=this.options,Ve=$e/Ze,ut=(fe-Ve)/ke,Dt=(fe+1+Ve)/ke,Ht={features:[]};return this._addTileFeatures(ge.range((re-Ve)/ke,ut,(re+1+Ve)/ke,Dt),ge.points,re,fe,ke,Ht),re===0&&this._addTileFeatures(ge.range(1-Ve/ke,ut,1,Dt),ge.points,ke,fe,ke,Ht),re===ke-1&&this._addTileFeatures(ge.range(0,ut,Ve/ke,Dt),ge.points,-1,fe,ke,Ht),Ht.features.length?Ht:null}getClusterExpansionZoom(Y){let re=this._getOriginZoom(Y)-1;for(;re<=this.options.maxZoom;){const fe=this.getChildren(Y);if(re++,fe.length!==1)break;Y=fe[0].properties.cluster_id}return re}_appendLeaves(Y,re,fe,ge,ke){const Ze=this.getChildren(re);for(const $e of Ze){const Ve=$e.properties;if(Ve&&Ve.cluster?ke+Ve.point_count<=ge?ke+=Ve.point_count:ke=this._appendLeaves(Y,Ve.cluster_id,fe,ge,ke):ke<ge?ke++:Y.push($e),Y.length===fe)break}return ke}_addTileFeatures(Y,re,fe,ge,ke,Ze){for(const $e of Y){const Ve=re[$e],ut=Ve.numPoints;let Dt,Ht,ft;if(ut)Dt=ns(Ve),Ht=Ve.x,ft=Ve.y;else{const Ai=this.points[Ve.index];Dt=Ai.properties,Ht=xr(Ai.geometry.coordinates[0]),ft=Wo(Ai.geometry.coordinates[1])}const ji={type:1,geometry:[[Math.round(this.options.extent*(Ht*ke-fe)),Math.round(this.options.extent*(ft*ke-ge))]],tags:Dt};let Zi;ut?Zi=Ve.id:this.options.generateId?Zi=Ve.index:this.points[Ve.index].id&&(Zi=this.points[Ve.index].id),Zi!==void 0&&(ji.id=Zi),Ze.features.push(ji)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,re){const fe=[],{radius:ge,extent:ke,reduce:Ze,minPoints:$e}=this.options,Ve=ge/(ke*Math.pow(2,re));for(let ut=0;ut<Y.length;ut++){const Dt=Y[ut];if(Dt.zoom<=re)continue;Dt.zoom=re;const Ht=this.trees[re+1],ft=Ht.within(Dt.x,Dt.y,Ve),ji=Dt.numPoints||1;let Zi=ji;for(const Ai of ft){const Yi=Ht.points[Ai];Yi.zoom>re&&(Zi+=Yi.numPoints||1)}if(Zi>ji&&Zi>=$e){let Ai=Dt.x*ji,Yi=Dt.y*ji,rr=Ze&&ji>1?this._map(Dt,!0):null;const br=(ut<<5)+(re+1)+this.points.length;for(const hr of ft){const wr=Ht.points[hr];if(wr.zoom<=re)continue;wr.zoom=re;const Mr=wr.numPoints||1;Ai+=wr.x*Mr,Yi+=wr.y*Mr,wr.parentId=br,Ze&&(rr||(rr=this._map(Dt,!0)),Ze(rr,this._map(wr)))}Dt.parentId=br,fe.push(sn(Ai/Zi,Yi/Zi,br,Zi,rr))}else if(fe.push(Dt),Zi>1)for(const Ai of ft){const Yi=Ht.points[Ai];Yi.zoom<=re||(Yi.zoom=re,fe.push(Yi))}}return fe}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,re){if(Y.numPoints)return re?gs({},Y.properties):Y.properties;const fe=this.points[Y.index].properties,ge=this.options.map(fe);return re&&ge===fe?gs({},ge):ge}}function sn(pe,Y,re,fe,ge){return{x:wn(pe),y:wn(Y),zoom:1/0,id:re,parentId:-1,numPoints:fe,properties:ge}}function Vn(pe,Y){const[re,fe]=pe.geometry.coordinates;return{x:wn(xr(re)),y:wn(Wo(fe)),zoom:1/0,index:Y,parentId:-1}}function ra(pe){return{type:"Feature",id:pe.id,properties:ns(pe),geometry:{type:"Point",coordinates:[(Y=pe.x,360*(Y-.5)),os(pe.y)]}};var Y}function ns(pe){const Y=pe.numPoints,re=Y>=1e4?`${Math.round(Y/1e3)}k`:Y>=1e3?Math.round(Y/100)/10+"k":Y;return gs(gs({},pe.properties),{cluster:!0,cluster_id:pe.id,point_count:Y,point_count_abbreviated:re})}function xr(pe){return pe/360+.5}function Wo(pe){const Y=Math.sin(pe*Math.PI/180),re=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return re<0?0:re>1?1:re}function os(pe){const Y=(180-360*pe)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function gs(pe,Y){for(const re in Y)pe[re]=Y[re];return pe}function ys(pe){return pe.x}function to(pe){return pe.y}function Eo(pe,Y,re,fe){for(var ge,ke=fe,Ze=re-Y>>1,$e=re-Y,Ve=pe[Y],ut=pe[Y+1],Dt=pe[re],Ht=pe[re+1],ft=Y+3;ft<re;ft+=3){var ji=Zs(pe[ft],pe[ft+1],Ve,ut,Dt,Ht);if(ji>ke)ge=ft,ke=ji;else if(ji===ke){var Zi=Math.abs(ft-Ze);Zi<$e&&(ge=ft,$e=Zi)}}ke>fe&&(ge-Y>3&&Eo(pe,Y,ge,fe),pe[ge+2]=ke,re-ge>3&&Eo(pe,ge,re,fe))}function Zs(pe,Y,re,fe,ge,ke){var Ze=ge-re,$e=ke-fe;if(Ze!==0||$e!==0){var Ve=((pe-re)*Ze+(Y-fe)*$e)/(Ze*Ze+$e*$e);Ve>1?(re=ge,fe=ke):Ve>0&&(re+=Ze*Ve,fe+=$e*Ve)}return(Ze=pe-re)*Ze+($e=Y-fe)*$e}function qn(pe,Y,re,fe){var ge={id:pe===void 0?null:pe,type:Y,geometry:re,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ke){var Ze=ke.geometry,$e=ke.type;if($e==="Point"||$e==="MultiPoint"||$e==="LineString")qt(ke,Ze);else if($e==="Polygon"||$e==="MultiLineString")for(var Ve=0;Ve<Ze.length;Ve++)qt(ke,Ze[Ve]);else if($e==="MultiPolygon")for(Ve=0;Ve<Ze.length;Ve++)for(var ut=0;ut<Ze[Ve].length;ut++)qt(ke,Ze[Ve][ut])}(ge),ge}function qt(pe,Y){for(var re=0;re<Y.length;re+=3)pe.minX=Math.min(pe.minX,Y[re]),pe.minY=Math.min(pe.minY,Y[re+1]),pe.maxX=Math.max(pe.maxX,Y[re]),pe.maxY=Math.max(pe.maxY,Y[re+1])}function Mi(pe,Y,re,fe){if(Y.geometry){var ge=Y.geometry.coordinates,ke=Y.geometry.type,Ze=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2),$e=[],Ve=Y.id;if(re.promoteId?Ve=Y.properties[re.promoteId]:re.generateId&&(Ve=fe||0),ke==="Point")Xo(ge,$e);else if(ke==="MultiPoint")for(var ut=0;ut<ge.length;ut++)Xo(ge[ut],$e);else if(ke==="LineString")so(ge,$e,Ze,!1);else if(ke==="MultiLineString"){if(re.lineMetrics){for(ut=0;ut<ge.length;ut++)so(ge[ut],$e=[],Ze,!1),pe.push(qn(Ve,"LineString",$e,Y.properties));return}Gr(ge,$e,Ze,!1)}else if(ke==="Polygon")Gr(ge,$e,Ze,!0);else{if(ke!=="MultiPolygon"){if(ke==="GeometryCollection"){for(ut=0;ut<Y.geometry.geometries.length;ut++)Mi(pe,{id:Ve,geometry:Y.geometry.geometries[ut],properties:Y.properties},re,fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ut=0;ut<ge.length;ut++){var Dt=[];Gr(ge[ut],Dt,Ze,!0),$e.push(Dt)}}pe.push(qn(Ve,ke,$e,Y.properties))}}function Xo(pe,Y){Y.push(zn(pe[0])),Y.push(Hn(pe[1])),Y.push(0)}function so(pe,Y,re,fe){for(var ge,ke,Ze=0,$e=0;$e<pe.length;$e++){var Ve=zn(pe[$e][0]),ut=Hn(pe[$e][1]);Y.push(Ve),Y.push(ut),Y.push(0),$e>0&&(Ze+=fe?(ge*ut-Ve*ke)/2:Math.sqrt(Math.pow(Ve-ge,2)+Math.pow(ut-ke,2))),ge=Ve,ke=ut}var Dt=Y.length-3;Y[2]=1,Eo(Y,0,Dt,re),Y[Dt+2]=1,Y.size=Math.abs(Ze),Y.start=0,Y.end=Y.size}function Gr(pe,Y,re,fe){for(var ge=0;ge<pe.length;ge++){var ke=[];so(pe[ge],ke,re,fe),Y.push(ke)}}function zn(pe){return pe/360+.5}function Hn(pe){var Y=Math.sin(pe*Math.PI/180),re=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return re<0?0:re>1?1:re}function io(pe,Y,re,fe,ge,ke,Ze,$e){if(fe/=Y,ke>=(re/=Y)&&Ze<fe)return pe;if(Ze<re||ke>=fe)return null;for(var Ve=[],ut=0;ut<pe.length;ut++){var Dt=pe[ut],Ht=Dt.geometry,ft=Dt.type,ji=ge===0?Dt.minX:Dt.minY,Zi=ge===0?Dt.maxX:Dt.maxY;if(ji>=re&&Zi<fe)Ve.push(Dt);else if(!(Zi<re||ji>=fe)){var Ai=[];if(ft==="Point"||ft==="MultiPoint")Ao(Ht,Ai,re,fe,ge);else if(ft==="LineString")Ii(Ht,Ai,re,fe,ge,!1,$e.lineMetrics);else if(ft==="MultiLineString")De(Ht,Ai,re,fe,ge,!1);else if(ft==="Polygon")De(Ht,Ai,re,fe,ge,!0);else if(ft==="MultiPolygon")for(var Yi=0;Yi<Ht.length;Yi++){var rr=[];De(Ht[Yi],rr,re,fe,ge,!0),rr.length&&Ai.push(rr)}if(Ai.length){if($e.lineMetrics&&ft==="LineString"){for(Yi=0;Yi<Ai.length;Yi++)Ve.push(qn(Dt.id,ft,Ai[Yi],Dt.tags));continue}ft!=="LineString"&&ft!=="MultiLineString"||(Ai.length===1?(ft="LineString",Ai=Ai[0]):ft="MultiLineString"),ft!=="Point"&&ft!=="MultiPoint"||(ft=Ai.length===3?"Point":"MultiPoint"),Ve.push(qn(Dt.id,ft,Ai,Dt.tags))}}}return Ve.length?Ve:null}function Ao(pe,Y,re,fe,ge){for(var ke=0;ke<pe.length;ke+=3){var Ze=pe[ke+ge];Ze>=re&&Ze<=fe&&(Y.push(pe[ke]),Y.push(pe[ke+1]),Y.push(pe[ke+2]))}}function Ii(pe,Y,re,fe,ge,ke,Ze){for(var $e,Ve,ut=Tr(pe),Dt=ge===0?_e:Ae,Ht=pe.start,ft=0;ft<pe.length-3;ft+=3){var ji=pe[ft],Zi=pe[ft+1],Ai=pe[ft+2],Yi=pe[ft+3],rr=pe[ft+4],br=ge===0?ji:Zi,hr=ge===0?Yi:rr,wr=!1;Ze&&($e=Math.sqrt(Math.pow(ji-Yi,2)+Math.pow(Zi-rr,2))),br<re?hr>re&&(Ve=Dt(ut,ji,Zi,Yi,rr,re),Ze&&(ut.start=Ht+$e*Ve)):br>fe?hr<fe&&(Ve=Dt(ut,ji,Zi,Yi,rr,fe),Ze&&(ut.start=Ht+$e*Ve)):de(ut,ji,Zi,Ai),hr<re&&br>=re&&(Ve=Dt(ut,ji,Zi,Yi,rr,re),wr=!0),hr>fe&&br<=fe&&(Ve=Dt(ut,ji,Zi,Yi,rr,fe),wr=!0),!ke&&wr&&(Ze&&(ut.end=Ht+$e*Ve),Y.push(ut),ut=Tr(pe)),Ze&&(Ht+=$e)}var Mr=pe.length-3;ji=pe[Mr],Zi=pe[Mr+1],Ai=pe[Mr+2],(br=ge===0?ji:Zi)>=re&&br<=fe&&de(ut,ji,Zi,Ai),Mr=ut.length-3,ke&&Mr>=3&&(ut[Mr]!==ut[0]||ut[Mr+1]!==ut[1])&&de(ut,ut[0],ut[1],ut[2]),ut.length&&Y.push(ut)}function Tr(pe){var Y=[];return Y.size=pe.size,Y.start=pe.start,Y.end=pe.end,Y}function De(pe,Y,re,fe,ge,ke){for(var Ze=0;Ze<pe.length;Ze++)Ii(pe[Ze],Y,re,fe,ge,ke,!1)}function de(pe,Y,re,fe){pe.push(Y),pe.push(re),pe.push(fe)}function _e(pe,Y,re,fe,ge,ke){var Ze=(ke-Y)/(fe-Y);return pe.push(ke),pe.push(re+(ge-re)*Ze),pe.push(1),Ze}function Ae(pe,Y,re,fe,ge,ke){var Ze=(ke-re)/(ge-re);return pe.push(Y+(fe-Y)*Ze),pe.push(ke),pe.push(1),Ze}function Je(pe,Y){for(var re=[],fe=0;fe<pe.length;fe++){var ge,ke=pe[fe],Ze=ke.type;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")ge=ot(ke.geometry,Y);else if(Ze==="MultiLineString"||Ze==="Polygon"){ge=[];for(var $e=0;$e<ke.geometry.length;$e++)ge.push(ot(ke.geometry[$e],Y))}else if(Ze==="MultiPolygon")for(ge=[],$e=0;$e<ke.geometry.length;$e++){for(var Ve=[],ut=0;ut<ke.geometry[$e].length;ut++)Ve.push(ot(ke.geometry[$e][ut],Y));ge.push(Ve)}re.push(qn(ke.id,Ze,ge,ke.tags))}return re}function ot(pe,Y){var re=[];re.size=pe.size,pe.start!==void 0&&(re.start=pe.start,re.end=pe.end);for(var fe=0;fe<pe.length;fe+=3)re.push(pe[fe]+Y,pe[fe+1],pe[fe+2]);return re}function Tt(pe,Y){if(pe.transformed)return pe;var re,fe,ge,ke=1<<pe.z,Ze=pe.x,$e=pe.y;for(re=0;re<pe.features.length;re++){var Ve=pe.features[re],ut=Ve.geometry,Dt=Ve.type;if(Ve.geometry=[],Dt===1)for(fe=0;fe<ut.length;fe+=2)Ve.geometry.push(mt(ut[fe],ut[fe+1],Y,ke,Ze,$e));else for(fe=0;fe<ut.length;fe++){var Ht=[];for(ge=0;ge<ut[fe].length;ge+=2)Ht.push(mt(ut[fe][ge],ut[fe][ge+1],Y,ke,Ze,$e));Ve.geometry.push(Ht)}}return pe.transformed=!0,pe}function mt(pe,Y,re,fe,ge,ke){return[Math.round(re*(pe*fe-ge)),Math.round(re*(Y*fe-ke))]}function st(pe,Y,re,fe,ge){for(var ke=Y===ge.maxZoom?0:ge.tolerance/((1<<Y)*ge.extent),Ze={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:re,y:fe,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},$e=0;$e<pe.length;$e++){Ze.numFeatures++,xt(Ze,pe[$e],ke,ge);var Ve=pe[$e].minX,ut=pe[$e].minY,Dt=pe[$e].maxX,Ht=pe[$e].maxY;Ve<Ze.minX&&(Ze.minX=Ve),ut<Ze.minY&&(Ze.minY=ut),Dt>Ze.maxX&&(Ze.maxX=Dt),Ht>Ze.maxY&&(Ze.maxY=Ht)}return Ze}function xt(pe,Y,re,fe){var ge=Y.geometry,ke=Y.type,Ze=[];if(ke==="Point"||ke==="MultiPoint")for(var $e=0;$e<ge.length;$e+=3)Ze.push(ge[$e]),Ze.push(ge[$e+1]),pe.numPoints++,pe.numSimplified++;else if(ke==="LineString")gi(Ze,ge,pe,re,!1,!1);else if(ke==="MultiLineString"||ke==="Polygon")for($e=0;$e<ge.length;$e++)gi(Ze,ge[$e],pe,re,ke==="Polygon",$e===0);else if(ke==="MultiPolygon")for(var Ve=0;Ve<ge.length;Ve++){var ut=ge[Ve];for($e=0;$e<ut.length;$e++)gi(Ze,ut[$e],pe,re,!0,$e===0)}if(Ze.length){var Dt=Y.tags||null;if(ke==="LineString"&&fe.lineMetrics){for(var Ht in Dt={},Y.tags)Dt[Ht]=Y.tags[Ht];Dt.mapbox_clip_start=ge.start/ge.size,Dt.mapbox_clip_end=ge.end/ge.size}var ft={geometry:Ze,type:ke==="Polygon"||ke==="MultiPolygon"?3:ke==="LineString"||ke==="MultiLineString"?2:1,tags:Dt};Y.id!==null&&(ft.id=Y.id),pe.features.push(ft)}}function gi(pe,Y,re,fe,ge,ke){var Ze=fe*fe;if(fe>0&&Y.size<(ge?Ze:fe))re.numPoints+=Y.length/3;else{for(var $e=[],Ve=0;Ve<Y.length;Ve+=3)(fe===0||Y[Ve+2]>Ze)&&(re.numSimplified++,$e.push(Y[Ve]),$e.push(Y[Ve+1])),re.numPoints++;ge&&function(ut,Dt){for(var Ht=0,ft=0,ji=ut.length,Zi=ji-2;ft<ji;Zi=ft,ft+=2)Ht+=(ut[ft]-ut[Zi])*(ut[ft+1]+ut[Zi+1]);if(Ht>0===Dt)for(ft=0,ji=ut.length;ft<ji/2;ft+=2){var Ai=ut[ft],Yi=ut[ft+1];ut[ft]=ut[ji-2-ft],ut[ft+1]=ut[ji-1-ft],ut[ji-2-ft]=Ai,ut[ji-1-ft]=Yi}}($e,ke),pe.push($e)}}function wi(pe,Y){var re=(Y=this.options=function(ge,ke){for(var Ze in ke)ge[Ze]=ke[Ze];return ge}(Object.create(this.options),Y)).debug;if(re&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var fe=function(ge,ke){var Ze=[];if(ge.type==="FeatureCollection")for(var $e=0;$e<ge.features.length;$e++)Mi(Ze,ge.features[$e],ke,$e);else Mi(Ze,ge.type==="Feature"?ge:{geometry:ge},ke);return Ze}(pe,Y);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(ge,ke){var Ze=ke.buffer/ke.extent,$e=ge,Ve=io(ge,1,-1-Ze,Ze,0,-1,2,ke),ut=io(ge,1,1-Ze,2+Ze,0,-1,2,ke);return(Ve||ut)&&($e=io(ge,1,-Ze,1+Ze,0,-1,2,ke)||[],Ve&&($e=Je(Ve,1).concat($e)),ut&&($e=$e.concat(Je(ut,-1)))),$e}(fe,Y),fe.length&&this.splitTile(fe,0,0,0),re&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Pe(pe,Y,re){return 32*((1<<pe)*re+Y)+pe}function ct(pe,Y){const re=pe.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);const fe=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!fe)return Y(null,null);const ge=new ci(fe.features);let ke=dt.exports(ge);ke.byteOffset===0&&ke.byteLength===ke.buffer.byteLength||(ke=new Uint8Array(ke)),Y(null,{vectorTile:ge,rawData:ke.buffer})}wi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},wi.prototype.splitTile=function(pe,Y,re,fe,ge,ke,Ze){for(var $e=[pe,Y,re,fe],Ve=this.options,ut=Ve.debug;$e.length;){fe=$e.pop(),re=$e.pop(),Y=$e.pop(),pe=$e.pop();var Dt=1<<Y,Ht=Pe(Y,re,fe),ft=this.tiles[Ht];if(!ft&&(ut>1&&console.time("creation"),ft=this.tiles[Ht]=st(pe,Y,re,fe,Ve),this.tileCoords.push({z:Y,x:re,y:fe}),ut)){ut>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,re,fe,ft.numFeatures,ft.numPoints,ft.numSimplified),console.timeEnd("creation"));var ji="z"+Y;this.stats[ji]=(this.stats[ji]||0)+1,this.total++}if(ft.source=pe,ge){if(Y===Ve.maxZoom||Y===ge)continue;var Zi=1<<ge-Y;if(re!==Math.floor(ke/Zi)||fe!==Math.floor(Ze/Zi))continue}else if(Y===Ve.indexMaxZoom||ft.numPoints<=Ve.indexMaxPoints)continue;if(ft.source=null,pe.length!==0){ut>1&&console.time("clipping");var Ai,Yi,rr,br,hr,wr,Mr=.5*Ve.buffer/Ve.extent,Qi=.5-Mr,Pr=.5+Mr,It=1+Mr;Ai=Yi=rr=br=null,hr=io(pe,Dt,re-Mr,re+Pr,0,ft.minX,ft.maxX,Ve),wr=io(pe,Dt,re+Qi,re+It,0,ft.minX,ft.maxX,Ve),pe=null,hr&&(Ai=io(hr,Dt,fe-Mr,fe+Pr,1,ft.minY,ft.maxY,Ve),Yi=io(hr,Dt,fe+Qi,fe+It,1,ft.minY,ft.maxY,Ve),hr=null),wr&&(rr=io(wr,Dt,fe-Mr,fe+Pr,1,ft.minY,ft.maxY,Ve),br=io(wr,Dt,fe+Qi,fe+It,1,ft.minY,ft.maxY,Ve),wr=null),ut>1&&console.timeEnd("clipping"),$e.push(Ai||[],Y+1,2*re,2*fe),$e.push(Yi||[],Y+1,2*re,2*fe+1),$e.push(rr||[],Y+1,2*re+1,2*fe),$e.push(br||[],Y+1,2*re+1,2*fe+1)}}},wi.prototype.getTile=function(pe,Y,re){var fe=this.options,ge=fe.extent,ke=fe.debug;if(pe<0||pe>24)return null;var Ze=1<<pe,$e=Pe(pe,Y=(Y%Ze+Ze)%Ze,re);if(this.tiles[$e])return Tt(this.tiles[$e],ge);ke>1&&console.log("drilling down to z%d-%d-%d",pe,Y,re);for(var Ve,ut=pe,Dt=Y,Ht=re;!Ve&&ut>0;)ut--,Dt=Math.floor(Dt/2),Ht=Math.floor(Ht/2),Ve=this.tiles[Pe(ut,Dt,Ht)];return Ve&&Ve.source?(ke>1&&console.log("found parent tile z%d-%d-%d",ut,Dt,Ht),ke>1&&console.time("drilling down"),this.splitTile(Ve.source,ut,Dt,Ht,pe,Y,re),ke>1&&console.timeEnd("drilling down"),this.tiles[$e]?Tt(this.tiles[$e],ge):null):null};class bt extends at{constructor(Y,re,fe,ge){super(Y,re,fe,ct),ge&&(this.loadGeoJSON=ge)}loadData(Y,re){var fe;(fe=this._pendingRequest)===null||fe===void 0||fe.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ge=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new t.RequestPerformance(Y.request);this._pendingCallback=re,this._pendingRequest=this.loadGeoJSON(Y,(ke,Ze)=>{if(delete this._pendingCallback,delete this._pendingRequest,ke||!Ze)return re(ke);if(typeof Ze!="object")return re(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{Ne(Ze,!0);try{if(Y.filter){const Ve=t.createExpression(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ve.result==="error")throw new Error(Ve.value.map(Dt=>`${Dt.key}: ${Dt.message}`).join(", "));Ze={type:"FeatureCollection",features:Ze.features.filter(Dt=>Ve.value.evaluate({zoom:0},Dt))}}this._geoJSONIndex=Y.cluster?new $s(function({superclusterOptions:Ve,clusterProperties:ut}){if(!ut||!Ve)return Ve;const Dt={},Ht={},ft={accumulated:null,zoom:0},ji={properties:null},Zi=Object.keys(ut);for(const Ai of Zi){const[Yi,rr]=ut[Ai],br=t.createExpression(rr),hr=t.createExpression(typeof Yi=="string"?[Yi,["accumulated"],["get",Ai]]:Yi);Dt[Ai]=br.value,Ht[Ai]=hr.value}return Ve.map=Ai=>{ji.properties=Ai;const Yi={};for(const rr of Zi)Yi[rr]=Dt[rr].evaluate(ft,ji);return Yi},Ve.reduce=(Ai,Yi)=>{ji.properties=Yi;for(const rr of Zi)ft.accumulated=Ai[rr],Ai[rr]=Ht[rr].evaluate(ft,ji)},Ve}(Y)).load(Ze.features):function(Ve,ut){return new wi(Ve,ut)}(Ze,Y.geojsonVtOptions)}catch(Ve){return re(Ve)}this.loaded={};const $e={};if(ge){const Ve=ge.finish();Ve&&($e.resourceTiming={},$e.resourceTiming[Y.source]=JSON.parse(JSON.stringify(Ve)))}re(null,$e)}})}reloadTile(Y,re){const fe=this.loaded;return fe&&fe[Y.uid]?super.reloadTile(Y,re):this.loadTile(Y,re)}loadGeoJSON(Y,re){if(Y.request)return t.getJSON(Y.request,re);if(typeof Y.data=="string")try{re(null,JSON.parse(Y.data))}catch{re(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}else re(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(Y,re){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),re()}getClusterExpansionZoom(Y,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(fe){re(fe)}}getClusterChildren(Y,re){try{re(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(fe){re(fe)}}getClusterLeaves(Y,re){try{re(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(fe){re(fe)}}}class jt{constructor(Y){this.self=Y,this.actor=new t.Actor(Y,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:at,geojson:bt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,fe)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=fe},this.self.registerRTLTextPlugin=re=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=re.applyArabicShaping,t.plugin.processBidirectionalText=re.processBidirectionalText,t.plugin.processStyledBidirectionalText=re.processStyledBidirectionalText}}setReferrer(Y,re){this.referrer=re}setImages(Y,re,fe){this.availableImages[Y]=re;for(const ge in this.workerSources[Y]){const ke=this.workerSources[Y][ge];for(const Ze in ke)ke[Ze].availableImages=re}fe()}setLayers(Y,re,fe){this.getLayerIndex(Y).replace(re),fe()}updateLayers(Y,re,fe){this.getLayerIndex(Y).update(re.layers,re.removedIds),fe()}loadTile(Y,re,fe){this.getWorkerSource(Y,re.type,re.source).loadTile(re,fe)}loadDEMTile(Y,re,fe){this.getDEMWorkerSource(Y,re.source).loadTile(re,fe)}reloadTile(Y,re,fe){this.getWorkerSource(Y,re.type,re.source).reloadTile(re,fe)}abortTile(Y,re,fe){this.getWorkerSource(Y,re.type,re.source).abortTile(re,fe)}removeTile(Y,re,fe){this.getWorkerSource(Y,re.type,re.source).removeTile(re,fe)}removeDEMTile(Y,re){this.getDEMWorkerSource(Y,re.source).removeTile(re)}removeSource(Y,re,fe){if(!this.workerSources[Y]||!this.workerSources[Y][re.type]||!this.workerSources[Y][re.type][re.source])return;const ge=this.workerSources[Y][re.type][re.source];delete this.workerSources[Y][re.type][re.source],ge.removeSource!==void 0?ge.removeSource(re,fe):fe()}loadWorkerSource(Y,re,fe){try{this.self.importScripts(re.url),fe()}catch(ge){fe(ge.toString())}}syncRTLPluginState(Y,re,fe){try{t.plugin.setState(re);const ge=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&ge!=null){this.self.importScripts(ge);const ke=t.plugin.isParsed();fe(ke?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ge}`),ke)}}catch(ge){fe(ge.toString())}}getAvailableImages(Y){let re=this.availableImages[Y];return re||(re=[]),re}getLayerIndex(Y){let re=this.layerIndexes[Y];return re||(re=this.layerIndexes[Y]=new ye),re}getWorkerSource(Y,re,fe){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][re]||(this.workerSources[Y][re]={}),!this.workerSources[Y][re][fe]){const ge={send:(ke,Ze,$e)=>{this.actor.send(ke,Ze,$e,Y)}};this.workerSources[Y][re][fe]=new this.workerSourceTypes[re](ge,this.getLayerIndex(Y),this.getAvailableImages(Y))}return this.workerSources[Y][re][fe]}getDEMWorkerSource(Y,re){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][re]||(this.demWorkerSources[Y][re]=new Kt),this.demWorkerSources[Y][re]}enforceCacheSizeLimit(Y,re){t.enforceCacheSizeLimit(re)}}return t.isWorker()&&(self.worker=new jt(self)),jt}),P(["./shared"],function(t){var j=ie;function ie(S){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,C,D=new Blob([""],{type:"text/javascript"}),U=URL.createObjectURL(D);try{C=new Worker(U),w=!0}catch{w=!1}return C&&C.terminate(),URL.revokeObjectURL(U),w}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var w=document.createElement("canvas");w.width=w.height=1;var C=w.getContext("2d");if(!C)return!1;var D=C.getImageData(0,0,1,1);return D&&D.width===w.width}()?(ye[m=l&&l.failIfMajorPerformanceCaveat]===void 0&&(ye[m]=function(w){var C,D=function(U){var q=document.createElement("canvas"),K=Object.create(ie.webGLContextAttributes);return K.failIfMajorPerformanceCaveat=U,q.getContext("webgl",K)||q.getContext("experimental-webgl",K)}(w);if(!D)return!1;try{C=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!C||D.isContextLost())&&(D.shaderSource(C,"void main() {}"),D.compileShader(C),D.getShaderParameter(C,D.COMPILE_STATUS)===!0)}(m)),ye[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(S)}var ye={};function he(S,l){if(Array.isArray(S)){if(!Array.isArray(l)||S.length!==l.length)return!1;for(let m=0;m<S.length;m++)if(!he(S[m],l[m]))return!1;return!0}if(typeof S=="object"&&S!==null&&l!==null){if(typeof l!="object"||Object.keys(S).length!==Object.keys(l).length)return!1;for(const m in S)if(!he(S[m],l[m]))return!1;return!0}return S===l}ie.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class ne{static testProp(l){if(!ne.docStyle)return l[0];for(let m=0;m<l.length;m++)if(l[m]in ne.docStyle)return l[m];return l[0]}static create(l,m,w){const C=window.document.createElement(l);return m!==void 0&&(C.className=m),w&&w.appendChild(C),C}static createNS(l,m){return window.document.createElementNS(l,m)}static disableDrag(){ne.docStyle&&ne.selectProp&&(ne.userSelect=ne.docStyle[ne.selectProp],ne.docStyle[ne.selectProp]="none")}static enableDrag(){ne.docStyle&&ne.selectProp&&(ne.docStyle[ne.selectProp]=ne.userSelect)}static setTransform(l,m){l.style[ne.transformProp]=m}static addEventListener(l,m,w,C={}){l.addEventListener(m,w,"passive"in C?C:C.capture)}static removeEventListener(l,m,w,C={}){l.removeEventListener(m,w,"passive"in C?C:C.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",ne.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ne.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ne.suppressClickInternal,!0)},0)}static mousePos(l,m){const w=l.getBoundingClientRect();return new t.pointGeometry(m.clientX-w.left-l.clientLeft,m.clientY-w.top-l.clientTop)}static touchPos(l,m){const w=l.getBoundingClientRect(),C=[];for(let D=0;D<m.length;D++)C.push(new t.pointGeometry(m[D].clientX-w.left-l.clientLeft,m[D].clientY-w.top-l.clientTop));return C}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}ne.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ne.selectProp=ne.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ne.transformProp=ne.testProp(["transform","WebkitTransform"]);class Ye{constructor(l){this._transformRequestFn=l}transformRequest(l,m){return this._transformRequestFn&&this._transformRequestFn(l,m)||{url:l}}normalizeSpriteURL(l,m,w){const C=function(D){const U=D.match(lt);if(!U)throw new Error(`Unable to parse URL "${D}"`);return{protocol:U[1],authority:U[2],path:U[3]||"/",params:U[4]?U[4].split("&"):[]}}(l);return C.path+=`${m}${w}`,function(D){const U=D.params.length?`?${D.params.join("&")}`:"";return`${D.protocol}://${D.authority}${D.path}${U}`}(C)}setTransformRequest(l){this._transformRequestFn=l}}const lt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class at{constructor(l,m,w,C){this.context=l,this.format=w,this.texture=l.gl.createTexture(),this.update(m,C)}update(l,m,w){const{width:C,height:D}=l,U=!(this.size&&this.size[0]===C&&this.size[1]===D||w),{context:q}=this,{gl:K}=q;if(this.useMipmap=!!(m&&m.useMipmap),K.bindTexture(K.TEXTURE_2D,this.texture),q.pixelStoreUnpackFlipY.set(!1),q.pixelStoreUnpack.set(1),q.pixelStoreUnpackPremultiplyAlpha.set(this.format===K.RGBA&&(!m||m.premultiply!==!1)),U)this.size=[C,D],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||t.isImageBitmap(l)?K.texImage2D(K.TEXTURE_2D,0,this.format,this.format,K.UNSIGNED_BYTE,l):K.texImage2D(K.TEXTURE_2D,0,this.format,C,D,0,this.format,K.UNSIGNED_BYTE,l.data);else{const{x:ee,y:le}=w||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||t.isImageBitmap(l)?K.texSubImage2D(K.TEXTURE_2D,0,ee,le,K.RGBA,K.UNSIGNED_BYTE,l):K.texSubImage2D(K.TEXTURE_2D,0,ee,le,C,D,K.RGBA,K.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&K.generateMipmap(K.TEXTURE_2D)}bind(l,m,w){const{context:C}=this,{gl:D}=C;D.bindTexture(D.TEXTURE_2D,this.texture),w!==D.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(w=D.LINEAR),l!==this.filter&&(D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,l),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,w||l),this.filter=l),m!==this.wrap&&(D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,m),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,m),this.wrap=m)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function Kt(S){const{userImage:l}=S;return!!(l&&l.render&&l.render())&&(S.data.replace(new Uint8Array(l.data.buffer)),!0)}class Ne extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:m,callback:w}of this.requestors)this._notify(m,w);this.requestors=[]}}getImage(l){return this.images[l]}addImage(l,m){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,m)&&(this.images[l]=m)}_validate(l,m){let w=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),w=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),w=!1),this._validateContent(m.content,m)||(this.fire(new t.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),w=!1),w}_validateStretch(l,m){if(!l)return!0;let w=0;for(const C of l){if(C[0]<w||C[1]<C[0]||m<C[1])return!1;w=C[1]}return!0}_validateContent(l,m){return!(l&&(l.length!==4||l[0]<0||m.data.width<l[0]||l[1]<0||m.data.height<l[1]||l[2]<0||m.data.width<l[2]||l[3]<0||m.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,m){const w=this.images[l];if(w.data.width!==m.data.width||w.data.height!==m.data.height)throw new Error(`size mismatch between old image (${w.data.width}x${w.data.height}) and new image (${m.data.width}x${m.data.height}).`);m.version=w.version+1,this.images[l]=m,this.updatedImages[l]=!0}removeImage(l){const m=this.images[l];delete this.images[l],delete this.patterns[l],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,m){let w=!0;if(!this.isLoaded())for(const C of l)this.images[C]||(w=!1);this.isLoaded()||w?this._notify(l,m):this.requestors.push({ids:l,callback:m})}_notify(l,m){const w={};for(const C of l){this.images[C]||this.fire(new t.Event("styleimagemissing",{id:C}));const D=this.images[C];D?w[C]={data:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:!!(D.userImage&&D.userImage.render)}:t.warnOnce(`Image "${C}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,w)}getPixelSize(){const{width:l,height:m}=this.atlasImage;return{width:l,height:m}}getPattern(l){const m=this.patterns[l],w=this.getImage(l);if(!w)return null;if(m&&m.position.version===w.version)return m.position;if(m)m.position.version=w.version;else{const C={w:w.data.width+2,h:w.data.height+2,x:0,y:0},D=new t.ImagePosition(C,w);this.patterns[l]={bin:C,position:D}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const m=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new at(l,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const D in this.patterns)l.push(this.patterns[D].bin);const{w:m,h:w}=t.potpack(l),C=this.atlasImage;C.resize({width:m||1,height:w||1});for(const D in this.patterns){const{bin:U}=this.patterns[D],q=U.x+1,K=U.y+1,ee=this.images[D].data,le=ee.width,me=ee.height;t.RGBAImage.copy(ee,C,{x:0,y:0},{x:q,y:K},{width:le,height:me}),t.RGBAImage.copy(ee,C,{x:0,y:me-1},{x:q,y:K-1},{width:le,height:1}),t.RGBAImage.copy(ee,C,{x:0,y:0},{x:q,y:K+me},{width:le,height:1}),t.RGBAImage.copy(ee,C,{x:le-1,y:0},{x:q-1,y:K},{width:1,height:me}),t.RGBAImage.copy(ee,C,{x:0,y:0},{x:q+le,y:K},{width:1,height:me})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const m of l){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const w=this.images[m];w||t.warnOnce(`Image with ID: "${m}" was not found`),Kt(w)&&this.updateImage(m,w)}}}const Le=1e20;function je(S,l,m,w,C,D,U,q,K){for(let ee=l;ee<l+w;ee++)_t(S,m*D+ee,D,C,U,q,K);for(let ee=m;ee<m+C;ee++)_t(S,ee*D+l,1,w,U,q,K)}function _t(S,l,m,w,C,D,U){D[0]=0,U[0]=-Le,U[1]=Le,C[0]=S[l];for(let q=1,K=0,ee=0;q<w;q++){C[q]=S[l+q*m];const le=q*q;do{const me=D[K];ee=(C[q]-C[me]+le-me*me)/(q-me)/2}while(ee<=U[K]&&--K>-1);K++,D[K]=q,U[K]=ee,U[K+1]=Le}for(let q=0,K=0;q<w;q++){for(;U[K+1]<q;)K++;const ee=D[K],le=q-ee;S[l+q*m]=C[ee]+le*le}}class St{constructor(l,m){this.requestManager=l,this.localIdeographFontFamily=m,this.entries={}}setURL(l){this.url=l}getGlyphs(l,m){const w=[];for(const C in l)for(const D of l[C])w.push({stack:C,id:D});t.asyncAll(w,({stack:C,id:D},U)=>{let q=this.entries[C];q||(q=this.entries[C]={glyphs:{},requests:{},ranges:{}});let K=q.glyphs[D];if(K!==void 0)return void U(null,{stack:C,id:D,glyph:K});if(K=this._tinySDF(q,C,D),K)return q.glyphs[D]=K,void U(null,{stack:C,id:D,glyph:K});const ee=Math.floor(D/256);if(256*ee>65535)return void U(new Error("glyphs > 65535 not supported"));if(q.ranges[ee])return void U(null,{stack:C,id:D,glyph:K});let le=q.requests[ee];le||(le=q.requests[ee]=[],St.loadGlyphRange(C,ee,this.url,this.requestManager,(me,be)=>{if(be){for(const qe in be)this._doesCharSupportLocalGlyph(+qe)||(q.glyphs[+qe]=be[+qe]);q.ranges[ee]=!0}for(const qe of le)qe(me,be);delete q.requests[ee]})),le.push((me,be)=>{me?U(me):be&&U(null,{stack:C,id:D,glyph:be[D]||null})})},(C,D)=>{if(C)m(C);else if(D){const U={};for(const{stack:q,id:K,glyph:ee}of D)(U[q]||(U[q]={}))[K]=ee&&{id:ee.id,bitmap:ee.bitmap.clone(),metrics:ee.metrics};m(null,U)}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(t.unicodeBlockLookup["CJK Unified Ideographs"](l)||t.unicodeBlockLookup["Hangul Syllables"](l)||t.unicodeBlockLookup.Hiragana(l)||t.unicodeBlockLookup.Katakana(l))}_tinySDF(l,m,w){const C=this.localIdeographFontFamily;if(!C||!this._doesCharSupportLocalGlyph(w))return;let D=l.tinySDF;if(!D){let q="400";/bold/i.test(m)?q="900":/medium/i.test(m)?q="500":/light/i.test(m)&&(q="200"),D=l.tinySDF=new St.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:C,fontWeight:q})}const U=D.draw(String.fromCharCode(w));return{id:w,bitmap:new t.AlphaImage({width:U.width||30,height:U.height||30},U.data),metrics:{width:U.glyphWidth||24,height:U.glyphHeight||24,left:U.glyphLeft||0,top:U.glyphTop-27||-8,advance:U.glyphAdvance||24}}}}St.loadGlyphRange=function(S,l,m,w,C){const D=256*l,U=D+255,q=w.transformRequest(m.replace("{fontstack}",S).replace("{range}",`${D}-${U}`),t.ResourceType.Glyphs);t.getArrayBuffer(q,(K,ee)=>{if(K)C(K);else if(ee){const le={};for(const me of t.parseGlyphPbf(ee))le[me.id]=me;C(null,le)}})},St.TinySDF=class{constructor({fontSize:S=24,buffer:l=3,radius:m=8,cutoff:w=.25,fontFamily:C="sans-serif",fontWeight:D="normal",fontStyle:U="normal"}={}){this.buffer=l,this.cutoff=w,this.radius=m;const q=this.size=S+4*l,K=this._createCanvas(q),ee=this.ctx=K.getContext("2d",{willReadFrequently:!0});ee.font=`${U} ${D} ${S}px ${C}`,ee.textBaseline="alphabetic",ee.textAlign="left",ee.fillStyle="black",this.gridOuter=new Float64Array(q*q),this.gridInner=new Float64Array(q*q),this.f=new Float64Array(q),this.z=new Float64Array(q+1),this.v=new Uint16Array(q)}_createCanvas(S){const l=document.createElement("canvas");return l.width=l.height=S,l}draw(S){const{width:l,actualBoundingBoxAscent:m,actualBoundingBoxDescent:w,actualBoundingBoxLeft:C,actualBoundingBoxRight:D}=this.ctx.measureText(S),U=Math.ceil(m),q=Math.min(this.size-this.buffer,Math.ceil(D-C)),K=Math.min(this.size-this.buffer,U+Math.ceil(w)),ee=q+2*this.buffer,le=K+2*this.buffer,me=Math.max(ee*le,0),be=new Uint8ClampedArray(me),qe={data:be,width:ee,height:le,glyphWidth:q,glyphHeight:K,glyphTop:U,glyphLeft:0,glyphAdvance:l};if(q===0||K===0)return qe;const{ctx:Oe,buffer:Fe,gridInner:ht,gridOuter:vt}=this;Oe.clearRect(Fe,Fe,q,K),Oe.fillText(S,Fe,Fe+U);const Pt=Oe.getImageData(Fe,Fe,q,K);vt.fill(Le,0,me),ht.fill(0,0,me);for(let Ke=0;Ke<K;Ke++)for(let Rt=0;Rt<q;Rt++){const Bt=Pt.data[4*(Ke*q+Rt)+3]/255;if(Bt===0)continue;const ii=(Ke+Fe)*ee+Rt+Fe;if(Bt===1)vt[ii]=0,ht[ii]=Le;else{const Yt=.5-Bt;vt[ii]=Yt>0?Yt*Yt:0,ht[ii]=Yt<0?Yt*Yt:0}}je(vt,0,0,ee,le,ee,this.f,this.v,this.z),je(ht,Fe,Fe,q,K,ee,this.f,this.v,this.z);for(let Ke=0;Ke<me;Ke++){const Rt=Math.sqrt(vt[Ke])-Math.sqrt(ht[Ke]);be[Ke]=Math.round(255-255*(Rt/this.radius+this.cutoff))}return qe}};const ci=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(S,l){return t.sphericalToCartesian(S.expression.evaluate(l))}interpolate(S,l,m){return{x:t.number(S.x,l.x,m),y:t.number(S.y,l.y,m),z:t.number(S.z,l.z,m)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)}),dt="-transition";class ri extends t.Evented{constructor(l){super(),this._transitionable=new t.Transitionable(ci),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,m={}){if(!this._validate(t.validateLight,l,m))for(const w in l){const C=l[w];w.endsWith(dt)?this._transitionable.setTransition(w.slice(0,-dt.length),C):this._transitionable.setValue(w,C)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,m,w){return(!w||w.validate!==!1)&&t.emitValidationErrors(this,l.call(t.validateStyle,t.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class zt{constructor(l,m){this.width=l,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,m){const w=l.join(",")+String(m);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(l,m)),this.dashEntry[w]}getDashRanges(l,m,w){const C=[];let D=l.length%2==1?-l[l.length-1]*w:0,U=l[0]*w,q=!0;C.push({left:D,right:U,isDash:q,zeroLength:l[0]===0});let K=l[0];for(let ee=1;ee<l.length;ee++){q=!q;const le=l[ee];D=K*w,K+=le,U=K*w,C.push({left:D,right:U,isDash:q,zeroLength:le===0})}return C}addRoundDash(l,m,w){const C=m/2;for(let D=-w;D<=w;D++){const U=this.width*(this.nextRow+w+D);let q=0,K=l[q];for(let ee=0;ee<this.width;ee++){ee/K.right>1&&(K=l[++q]);const le=Math.abs(ee-K.left),me=Math.abs(ee-K.right),be=Math.min(le,me);let qe;const Oe=D/w*(C+1);if(K.isDash){const Fe=C-Math.abs(Oe);qe=Math.sqrt(be*be+Fe*Fe)}else qe=C-Math.sqrt(be*be+Oe*Oe);this.data[U+ee]=Math.max(0,Math.min(255,qe+128))}}}addRegularDash(l){for(let q=l.length-1;q>=0;--q){const K=l[q],ee=l[q+1];K.zeroLength?l.splice(q,1):ee&&ee.isDash===K.isDash&&(ee.left=K.left,l.splice(q,1))}const m=l[0],w=l[l.length-1];m.isDash===w.isDash&&(m.left=w.left-this.width,w.right=m.right+this.width);const C=this.width*this.nextRow;let D=0,U=l[D];for(let q=0;q<this.width;q++){q/U.right>1&&(U=l[++D]);const K=Math.abs(q-U.left),ee=Math.abs(q-U.right),le=Math.min(K,ee);this.data[C+q]=Math.max(0,Math.min(255,(U.isDash?le:-le)+128))}}addDash(l,m){const w=m?7:0,C=2*w+1;if(this.nextRow+C>this.height)return t.warnOnce("LineAtlas out of space"),null;let D=0;for(let q=0;q<l.length;q++)D+=l[q];if(D!==0){const q=this.width/D,K=this.getDashRanges(l,this.width,q);m?this.addRoundDash(K,q,w):this.addRegularDash(K)}const U={y:(this.nextRow+w+.5)/this.height,height:2*w/this.height,width:D};return this.nextRow+=C,this.dirty=!0,U}bind(l){const m=l.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))}}class Ci{constructor(l,m){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const w=this.workerPool.acquire(this.id);for(let C=0;C<w.length;C++){const D=new Ci.Actor(w[C],m,this.id);D.name=`Worker ${C}`,this.actors.push(D)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,m,w){t.asyncAll(this.actors,(C,D)=>{C.send(l,m,D)},w=w||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function yr(S,l,m){const w=function(C,D){if(C)return m(C);if(D){const U=t.pick(t.extend(D,S),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(U.vectorLayers=D.vector_layers,U.vectorLayerIds=U.vectorLayers.map(q=>q.id)),m(null,U)}};return S.url?t.getJSON(l.transformRequest(S.url,t.ResourceType.Source),w):t.exported.frame(()=>w(null,S))}Ci.Actor=t.Actor;class ki{constructor(l,m,w){this.bounds=t.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=m||0,this.maxzoom=w||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const m=Math.pow(2,l.z),w=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*m),C=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*m),D=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*m),U=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*m);return l.x>=w&&l.x<D&&l.y>=C&&l.y<U}}class fr extends t.Evented{constructor(l,m,w,C){if(super(),this.id=l,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(m,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=yr(this._options,this.map._requestManager,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l?this.fire(new t.ErrorEvent(l)):m&&(t.extend(this,m),m.bounds&&(this.tileBounds=new ki(m.bounds,this.minzoom,this.maxzoom)),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}loadTile(l,m){const w=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),C={request:this.map._requestManager.transformRequest(w,t.ResourceType.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function D(U,q){return delete l.request,l.aborted?m(null):U&&U.status!==404?m(U):(q&&q.resourceTiming&&(l.resourceTiming=q.resourceTiming),this.map._refreshExpiredTiles&&q&&l.setExpiryData(q),l.loadVectorData(q,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}C.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired"?l.state==="loading"?l.reloadCallback=m:l.request=l.actor.send("reloadTile",C,D.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",C,D.bind(this)))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Qt extends t.Evented{constructor(l,m,w,C){super(),this.id=l,this.dispatcher=w,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},m),t.extend(this,t.pick(m,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=yr(this._options,this.map._requestManager,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new t.ErrorEvent(l)):m&&(t.extend(this,m),m.bounds&&(this.tileBounds=new ki(m.bounds,this.minzoom,this.maxzoom)),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,m){const w=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.request=t.getImage(this.map._requestManager.transformRequest(w,t.ResourceType.Tile),(C,D,U)=>{if(delete l.request,l.aborted)l.state="unloaded",m(null);else if(C)l.state="errored",m(C);else if(D){this.map._refreshExpiredTiles&&l.setExpiryData(U);const q=this.map.painter.context,K=q.gl;l.texture=this.map.painter.getTileTexture(D.width),l.texture?l.texture.update(D,{useMipmap:!0}):(l.texture=new at(q,D,K.RGBA,{useMipmap:!0}),l.texture.bind(K.LINEAR,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST),q.extTextureFilterAnisotropic&&K.texParameterf(K.TEXTURE_2D,q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,q.extTextureFilterAnisotropicMax)),l.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),m(null)}})}abortTile(l,m){l.request&&(l.request.cancel(),delete l.request),m()}unloadTile(l,m){l.texture&&this.map.painter.saveTileTexture(l.texture),m()}hasTransition(){return!1}}let $t;class Mt extends Qt{constructor(l,m,w,C){super(l,m,w,C),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(l,m){const w=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function C(D,U){D&&(l.state="errored",m(D)),U&&(l.dem=U,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded",m(null))}l.request=t.getImage(this.map._requestManager.transformRequest(w,t.ResourceType.Tile),(function(D,U){if(delete l.request,l.aborted)l.state="unloaded",m(null);else if(D)l.state="errored",m(D);else if(U){this.map._refreshExpiredTiles&&l.setExpiryData(U),delete U.cacheControl,delete U.expires;const q=t.isImageBitmap(U)&&($t==null&&($t=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),$t)?U:t.exported.getImageData(U,1),K={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:q,encoding:this.encoding};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",K,C.bind(this)))}}).bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)}_getNeighboringTiles(l){const m=l.canonical,w=Math.pow(2,m.z),C=(m.x-1+w)%w,D=m.x===0?l.wrap-1:l.wrap,U=(m.x+1+w)%w,q=m.x+1===w?l.wrap+1:l.wrap,K={};return K[new t.OverscaledTileID(l.overscaledZ,D,m.z,C,m.y).key]={backfilled:!1},K[new t.OverscaledTileID(l.overscaledZ,q,m.z,U,m.y).key]={backfilled:!1},m.y>0&&(K[new t.OverscaledTileID(l.overscaledZ,D,m.z,C,m.y-1).key]={backfilled:!1},K[new t.OverscaledTileID(l.overscaledZ,l.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},K[new t.OverscaledTileID(l.overscaledZ,q,m.z,U,m.y-1).key]={backfilled:!1}),m.y+1<w&&(K[new t.OverscaledTileID(l.overscaledZ,D,m.z,C,m.y+1).key]={backfilled:!1},K[new t.OverscaledTileID(l.overscaledZ,l.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},K[new t.OverscaledTileID(l.overscaledZ,q,m.z,U,m.y+1).key]={backfilled:!1}),K}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})}}class ui extends t.Evented{constructor(l,m,w,C){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=w.getActor(),this.setEventedParent(C),this._data=m.data,this._options=t.extend({},m),this._collectResourceTiming=m.collectResourceTiming,m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;const D=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(m.buffer!==void 0?m.buffer:128)*D,tolerance:(m.tolerance!==void 0?m.tolerance:.375)*D,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:m.clusterMaxZoom!==void 0?m.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:t.EXTENT,radius:(m.clusterRadius||50)*D,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData("content"),this}getClusterExpansionZoom(l,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},m),this}getClusterChildren(l,m){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},m),this}getClusterLeaves(l,m,w,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:m,offset:w},C),this}_updateWorkerData(l){const m=t.extend({},this.workerOptions),w=this._data;typeof w=="string"?(m.request=this.map._requestManager.transformRequest(t.exported.resolveURL(w),t.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(w),this._pendingLoads++,this.fire(new t.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,m,(C,D)=>{if(this._pendingLoads--,this._removed||D&&D.abandoned)return void this.fire(new t.Event("dataabort",{dataType:"source",sourceDataType:l}));let U=null;if(D&&D.resourceTiming&&D.resourceTiming[this.id]&&(U=D.resourceTiming[this.id].slice(0)),C)return void this.fire(new t.ErrorEvent(C));const q={dataType:"source",sourceDataType:l};this._collectResourceTiming&&U&&U.length>0&&t.extend(q,{resourceTiming:U}),this.fire(new t.Event("data",q))})}loaded(){return this._pendingLoads===0}loadTile(l,m){const w=l.actor?"reloadTile":"loadTile";l.actor=this.actor;const C={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.request=this.actor.send(w,C,(D,U)=>(delete l.request,l.unloadVectorData(),l.aborted?m(null):D?m(D):(l.loadVectorData(U,this.map.painter,w==="reloadTile"),m(null))))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var pt=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class hi extends t.Evented{constructor(l,m,w,C){super(),this.id=l,this.dispatcher=w,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=m}load(l,m){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(w,C)=>{this._loaded=!0,w?this.fire(new t.ErrorEvent(w)):C&&(this.image=C,l&&(this.coordinates=l),m&&m(),this._finishLoading())})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}setCoordinates(l){this.coordinates=l;const m=l.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(C){let D=1/0,U=1/0,q=-1/0,K=-1/0;for(const be of C)D=Math.min(D,be.x),U=Math.min(U,be.y),q=Math.max(q,be.x),K=Math.max(K,be.y);const ee=Math.max(q-D,K-U),le=Math.max(0,Math.floor(-Math.log(ee)/Math.LN2)),me=Math.pow(2,le);return new t.CanonicalTileID(le,Math.floor((D+q)/2*me),Math.floor((U+K)/2*me))}(m),this.minzoom=this.maxzoom=this.tileID.z;const w=m.map(C=>this.tileID.getTilePoint(C)._round());return this._boundsArray=new t.RasterBoundsArray,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,m=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new at(l,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));for(const w in this.tiles){const C=this.tiles[w];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture)}}loadTile(l,m){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},m(null)):(l.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Si extends hi{constructor(l,m,w,C){super(l,m,w,C),this.roundZoom=!0,this.type="video",this.options=m}load(){this._loaded=!1;const l=this.options;this.urls=[];for(const m of l.urls)this.urls.push(this.map._requestManager.transformRequest(m,t.ResourceType.Source).url);t.getVideo(this.urls,(m,w)=>{this._loaded=!0,m?this.fire(new t.ErrorEvent(m)):w&&(this.video=w,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const m=this.video.seekable;l<m.start(0)||l>m.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${m.start(0)} and ${m.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,m=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new at(l,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));for(const w in this.tiles){const C=this.tiles[w];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Wi extends hi{constructor(l,m,w,C){super(l,m,w,C),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(D=>!Array.isArray(D)||D.length!==2||D.some(U=>typeof U!="number"))||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${l}`,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${l}`,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const m=this.map.painter.context,w=m.gl;this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new at(m,this.canvas,w.RGBA,{premultiply:!0});for(const C in this.tiles){const D=this.tiles[C];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const lr={vector:fr,raster:Qt,"raster-dem":Mt,geojson:ui,video:Si,image:hi,canvas:Wi};function mr(S,l){const m=t.create();return t.translate(m,m,[1,1,0]),t.scale(m,m,[.5*S.width,.5*S.height,1]),t.multiply(m,m,S.calculatePosMatrix(l.toUnwrapped()))}function Vr(S,l,m,w,C,D){const U=function(me,be,qe){if(me)for(const Oe of me){const Fe=be[Oe];if(Fe&&Fe.source===qe&&Fe.type==="fill-extrusion")return!0}else for(const Oe in be){const Fe=be[Oe];if(Fe.source===qe&&Fe.type==="fill-extrusion")return!0}return!1}(C&&C.layers,l,S.id),q=D.maxPitchScaleFactor(),K=S.tilesIn(w,q,U);K.sort(rn);const ee=[];for(const me of K)ee.push({wrappedTileID:me.tileID.wrapped().key,queryResults:me.tile.queryRenderedFeatures(l,m,S._state,me.queryGeometry,me.cameraQueryGeometry,me.scale,C,D,q,mr(S.transform,me.tileID))});const le=function(me){const be={},qe={};for(const Oe of me){const Fe=Oe.queryResults,ht=Oe.wrappedTileID,vt=qe[ht]=qe[ht]||{};for(const Pt in Fe){const Ke=Fe[Pt],Rt=vt[Pt]=vt[Pt]||{},Bt=be[Pt]=be[Pt]||[];for(const ii of Ke)Rt[ii.featureIndex]||(Rt[ii.featureIndex]=!0,Bt.push(ii))}}return be}(ee);for(const me in le)le[me].forEach(be=>{const qe=be.feature,Oe=S.getFeatureState(qe.layer["source-layer"],qe.id);qe.source=qe.layer.source,qe.layer["source-layer"]&&(qe.sourceLayer=qe.layer["source-layer"]),qe.state=Oe});return le}function rn(S,l){const m=S.tileID,w=l.tileID;return m.overscaledZ-w.overscaledZ||m.canonical.y-w.canonical.y||m.wrap-w.wrap||m.canonical.x-w.canonical.x}class nn{constructor(l,m){this.tileID=l,this.uid=t.uniqueId(),this.uses=0,this.tileSize=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const m=l+this.timeAdded;m<t.exported.now()||this.fadeEndTime&&m<this.fadeEndTime||(this.fadeEndTime=m)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.textures.forEach(m=>l.saveTileTexture(m)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(l,m,w){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(C,D){const U={};if(!D)return U;for(const q of C){const K=q.layerIds.map(ee=>D.getLayer(ee)).filter(Boolean);if(K.length!==0){q.layers=K,q.stateDependentLayerIds&&(q.stateDependentLayers=q.stateDependentLayerIds.map(ee=>K.filter(le=>le.id===ee)[0]));for(const ee of K)U[ee.id]=q}}return U}(l.buckets,m.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const D=this.buckets[C];if(D instanceof t.SymbolBucket){if(this.hasSymbolBuckets=!0,!w)break;D.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const D=this.buckets[C];if(D instanceof t.SymbolBucket&&D.hasRTLText){this.hasRTLText=!0,t.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const C in this.buckets){const D=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,m.style.getLayer(C).queryRadius(D))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new t.CollisionBoxArray}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const w in this.buckets){const C=this.buckets[w];C.uploadPending()&&C.upload(l)}const m=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new at(l,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new at(l,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,m,w,C,D,U,q,K,ee,le){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:D,scale:U,tileSize:this.tileSize,pixelPosMatrix:le,transform:K,params:q,queryPadding:this.queryPadding*ee},l,m,w):{}}querySourceFeatures(l,m){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const C=w.loadVTLayers(),D=m?m.sourceLayer:"",U=C._geojsonTileLayer||C[D];if(!U)return;const q=t.createFilter(m&&m.filter),{z:K,x:ee,y:le}=this.tileID.canonical,me={z:K,x:ee,y:le};for(let be=0;be<U.length;be++){const qe=U.feature(be);if(q.needGeometry){const ht=t.toEvaluationFeature(qe,!0);if(!q.filter(new t.EvaluationParameters(this.tileID.overscaledZ),ht,this.tileID.canonical))continue}else if(!q.filter(new t.EvaluationParameters(this.tileID.overscaledZ),qe))continue;const Oe=w.getId(qe,D),Fe=new t.GeoJSONFeature(qe,K,ee,le,Oe);Fe.tile=me,l.push(Fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const m=this.expirationTime;if(l.cacheControl){const w=t.parseCacheControl(l.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const w=Date.now();let C=!1;if(this.expirationTime>w)C=!1;else if(m)if(this.expirationTime<m)C=!0;else{const D=this.expirationTime-m;D?this.expirationTime=w+Math.max(D,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,m){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const w=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!m.style.hasLayer(C))continue;const D=this.buckets[C],U=D.layers[0].sourceLayer||"_geojsonTileLayer",q=w[U],K=l[U];if(!q||!K||Object.keys(K).length===0)continue;D.update(K,q,this.imageAtlas&&this.imageAtlas.patternPositions||{});const ee=m&&m.style&&m.style.getLayer(C);ee&&(this.queryPadding=Math.max(this.queryPadding,ee.queryRadius(D)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<t.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=t.exported.now()+l}setDependencies(l,m){const w={};for(const C of m)w[C]=!0;this.dependencies[l]=w}hasDependency(l,m){for(const w of l){const C=this.dependencies[w];if(C){for(const D of m)if(C[D])return!0}}return!1}}class on{constructor(l,m){this.max=l,this.onRemove=m,this.reset()}reset(){for(const l in this.data)for(const m of this.data[l])m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value);return this.data={},this.order=[],this}add(l,m,w){const C=l.wrapped().key;this.data[C]===void 0&&(this.data[C]=[]);const D={value:m,timeout:void 0};if(w!==void 0&&(D.timeout=setTimeout(()=>{this.remove(l,D)},w)),this.data[C].push(D),this.order.push(C),this.order.length>this.max){const U=this._getAndRemoveByKey(this.order[0]);U&&this.onRemove(U)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const m=this.data[l].shift();return m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),m.value}getByKey(l){const m=this.data[l];return m?m[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,m){if(!this.has(l))return this;const w=l.wrapped().key,C=m===void 0?0:this.data[w].indexOf(m),D=this.data[w][C];return this.data[w].splice(C,1),D.timeout&&clearTimeout(D.timeout),this.data[w].length===0&&delete this.data[w],this.onRemove(D.value),this.order.splice(this.order.indexOf(w),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}filter(l){const m=[];for(const w in this.data)for(const C of this.data[w])l(C.value)||m.push(C);for(const w of m)this.remove(w.value.tileID,w)}}class mo{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,m,w){const C=String(m);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][C]=this.stateChanges[l][C]||{},t.extend(this.stateChanges[l][C],w),this.deletedStates[l]===null){this.deletedStates[l]={};for(const D in this.state[l])D!==C&&(this.deletedStates[l][D]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][C]===null){this.deletedStates[l][C]={};for(const D in this.state[l][C])w[D]||(this.deletedStates[l][C][D]=null)}else for(const D in w)this.deletedStates[l]&&this.deletedStates[l][C]&&this.deletedStates[l][C][D]===null&&delete this.deletedStates[l][C][D]}removeFeatureState(l,m,w){if(this.deletedStates[l]===null)return;const C=String(m);if(this.deletedStates[l]=this.deletedStates[l]||{},w&&m!==void 0)this.deletedStates[l][C]!==null&&(this.deletedStates[l][C]=this.deletedStates[l][C]||{},this.deletedStates[l][C][w]=null);else if(m!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][C])for(w in this.deletedStates[l][C]={},this.stateChanges[l][C])this.deletedStates[l][C][w]=null;else this.deletedStates[l][C]=null;else this.deletedStates[l]=null}getState(l,m){const w=String(m),C=t.extend({},(this.state[l]||{})[w],(this.stateChanges[l]||{})[w]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const D=this.deletedStates[l][m];if(D===null)return{};for(const U in D)delete C[U]}return C}initializeTileState(l,m){l.setFeatureState(this.state,m)}coalesceChanges(l,m){const w={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const D={};for(const U in this.stateChanges[C])this.state[C][U]||(this.state[C][U]={}),t.extend(this.state[C][U],this.stateChanges[C][U]),D[U]=this.state[C][U];w[C]=D}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const D={};if(this.deletedStates[C]===null)for(const U in this.state[C])D[U]={},this.state[C][U]={};else for(const U in this.deletedStates[C]){if(this.deletedStates[C][U]===null)this.state[C][U]={};else for(const q of Object.keys(this.deletedStates[C][U]))delete this.state[C][U][q];D[U]=this.state[C][U]}w[C]=w[C]||{},t.extend(w[C],D)}if(this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0)for(const C in l)l[C].setFeatureState(w,m)}}class eo extends t.Evented{constructor(l,m,w){super(),this.id=l,this.dispatcher=w,this.on("data",C=>{C.dataType==="source"&&C.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&C.dataType==="source"&&C.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(C,D,U,q){const K=new lr[D.type](C,D,U,q);if(K.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${K.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],K),K}(l,m,w,this),this._tiles={},this._cache=new on(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new mo}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const l in this._tiles){const m=this._tiles[l];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,m){return this._source.loadTile(l,m)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l,()=>{})}_abortTile(l){this._source.abortTile&&this._source.abortTile(l,()=>{}),this._source.fire(new t.Event("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const m in this._tiles){const w=this._tiles[m];w.upload(l),w.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Rs).map(l=>l.key)}getRenderableIds(l){const m=[];for(const w in this._tiles)this._isIdRenderable(w,l)&&m.push(this._tiles[w]);return l?m.sort((w,C)=>{const D=w.tileID,U=C.tileID,q=new t.pointGeometry(D.canonical.x,D.canonical.y)._rotate(this.transform.angle),K=new t.pointGeometry(U.canonical.x,U.canonical.y)._rotate(this.transform.angle);return D.overscaledZ-U.overscaledZ||K.y-q.y||K.x-q.x}).map(w=>w.tileID.key):m.map(w=>w.tileID).sort(Rs).map(w=>w.key)}hasRenderableParent(l){const m=this.findLoadedParent(l,0);return!!m&&this._isIdRenderable(m.tileID.key)}_isIdRenderable(l,m){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(m||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,m){const w=this._tiles[l];w&&(w.state!=="loading"&&(w.state=m),this._loadTile(w,this._tileLoaded.bind(this,w,l,m)))}_tileLoaded(l,m,w,C){if(C)return l.state="errored",void(C.status!==404?this._source.fire(new t.ErrorEvent(C,{tile:l})):this.update(this.transform,this.terrain));l.timeAdded=t.exported.now(),w==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(m,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new t.Event("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const m=this.getRenderableIds();for(let C=0;C<m.length;C++){const D=m[C];if(l.neighboringTiles&&l.neighboringTiles[D]){const U=this.getTileByID(D);w(l,U),w(U,l)}}function w(C,D){C.needsHillshadePrepare=!0,C.needsTerrainPrepare=!0;let U=D.tileID.canonical.x-C.tileID.canonical.x;const q=D.tileID.canonical.y-C.tileID.canonical.y,K=Math.pow(2,C.tileID.canonical.z),ee=D.tileID.key;U===0&&q===0||Math.abs(q)>1||(Math.abs(U)>1&&(Math.abs(U+K)===1?U+=K:Math.abs(U-K)===1&&(U-=K)),D.dem&&C.dem&&(C.dem.backfillBorder(D.dem,U,q),C.neighboringTiles&&C.neighboringTiles[ee]&&(C.neighboringTiles[ee].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,m,w,C){for(const D in this._tiles){let U=this._tiles[D];if(C[D]||!U.hasData()||U.tileID.overscaledZ<=m||U.tileID.overscaledZ>w)continue;let q=U.tileID;for(;U&&U.tileID.overscaledZ>m+1;){const ee=U.tileID.scaledTo(U.tileID.overscaledZ-1);U=this._tiles[ee.key],U&&U.hasData()&&(q=ee)}let K=q;for(;K.overscaledZ>m;)if(K=K.scaledTo(K.overscaledZ-1),l[K.key]){C[q.key]=q;break}}}findLoadedParent(l,m){if(l.key in this._loadedParentTiles){const w=this._loadedParentTiles[l.key];return w&&w.tileID.overscaledZ>=m?w:null}for(let w=l.overscaledZ-1;w>=m;w--){const C=l.scaledTo(w),D=this._getLoadedTile(C);if(D)return D}}_getLoadedTile(l){const m=this._tiles[l.key];return m&&m.hasData()?m:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const m=Math.ceil(l.width/this._source.tileSize)+1,w=Math.ceil(l.height/this._source.tileSize)+1,C=Math.floor(m*w*5),D=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(D)}handleWrapJump(l){const m=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,m){const w={};for(const C in this._tiles){const D=this._tiles[C];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+m),w[D.tileID.key]=D}this._tiles=w;for(const C in this._timers)clearTimeout(this._timers[C]),delete this._timers[C];for(const C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}}update(l,m){if(this.transform=l,this.terrain=m,!this._sourceLoaded||this._paused)return;let w;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?w=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(ee=>new t.OverscaledTileID(ee.canonical.z,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y)):(w=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:m}),this._source.hasTile&&(w=w.filter(ee=>this._source.hasTile(ee)))):w=[];const C=l.coveringZoomLevel(this._source),D=Math.max(C-eo.maxOverzooming,this._source.minzoom),U=Math.max(C+eo.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const ee={};for(const le of w)if(le.canonical.z>this._source.minzoom){const me=le.scaledTo(le.canonical.z-1);ee[me.key]=me;const be=le.scaledTo(Math.max(this._source.minzoom,Math.min(le.canonical.z,5)));ee[be.key]=be}w=w.concat(Object.values(ee))}const q=this._updateRetainedTiles(w,C);if(Ir(this._source.type)){const ee={},le={},me=Object.keys(q);for(const be of me){const qe=q[be],Oe=this._tiles[be];if(!Oe||Oe.fadeEndTime&&Oe.fadeEndTime<=t.exported.now())continue;const Fe=this.findLoadedParent(qe,D);Fe&&(this._addTile(Fe.tileID),ee[Fe.tileID.key]=Fe.tileID),le[be]=qe}this._retainLoadedChildren(le,C,U,q);for(const be in ee)q[be]||(this._coveredTiles[be]=!0,q[be]=ee[be]);if(m){const be={},qe={};for(const Oe of w)this._tiles[Oe.key].hasData()?be[Oe.key]=Oe:qe[Oe.key]=Oe;for(const Oe in qe){const Fe=qe[Oe].children(this._source.maxzoom);this._tiles[Fe[0].key]&&this._tiles[Fe[1].key]&&this._tiles[Fe[2].key]&&this._tiles[Fe[3].key]&&(be[Fe[0].key]=q[Fe[0].key]=Fe[0],be[Fe[1].key]=q[Fe[1].key]=Fe[1],be[Fe[2].key]=q[Fe[2].key]=Fe[2],be[Fe[3].key]=q[Fe[3].key]=Fe[3],delete qe[Oe])}for(const Oe in qe){const Fe=this.findLoadedParent(qe[Oe],this._source.minzoom);if(Fe){be[Fe.tileID.key]=q[Fe.tileID.key]=Fe.tileID;for(const ht in be)be[ht].isChildOf(Fe.tileID)&&delete be[ht]}}for(const Oe in this._tiles)be[Oe]||(this._coveredTiles[Oe]=!0)}}for(const ee in q)this._tiles[ee].clearFadeHold();const K=t.keysDifference(this._tiles,q);for(const ee of K){const le=this._tiles[ee];le.hasSymbolBuckets&&!le.holdingForFade()?le.setHoldDuration(this.map._fadeDuration):le.hasSymbolBuckets&&!le.symbolFadeFinished()||this._removeTile(ee)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,m){const w={},C={},D=Math.max(m-eo.maxOverzooming,this._source.minzoom),U=Math.max(m+eo.maxUnderzooming,this._source.minzoom),q={};for(const K of l){const ee=this._addTile(K);w[K.key]=K,ee.hasData()||m<this._source.maxzoom&&(q[K.key]=K)}this._retainLoadedChildren(q,m,U,w);for(const K of l){let ee=this._tiles[K.key];if(ee.hasData())continue;if(m+1>this._source.maxzoom){const me=K.children(this._source.maxzoom)[0],be=this.getTile(me);if(be&&be.hasData()){w[me.key]=me;continue}}else{const me=K.children(this._source.maxzoom);if(w[me[0].key]&&w[me[1].key]&&w[me[2].key]&&w[me[3].key])continue}let le=ee.wasRequested();for(let me=K.overscaledZ-1;me>=D;--me){const be=K.scaledTo(me);if(C[be.key]||(C[be.key]=!0,ee=this.getTile(be),!ee&&le&&(ee=this._addTile(be)),ee&&(w[be.key]=be,le=ee.wasRequested(),ee.hasData())))break}}return w}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const m=[];let w,C=this._tiles[l].tileID;for(;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){w=this._loadedParentTiles[C.key];break}m.push(C.key);const D=C.scaledTo(C.overscaledZ-1);if(w=this._getLoadedTile(D),w)break;C=D}for(const D of m)this._loadedParentTiles[D]=w}}_addTile(l){let m=this._tiles[l.key];if(m)return m;m=this._cache.getAndRemove(l),m&&(this._setTileReloadTimer(l.key,m),m.tileID=l,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,m)));const w=m;return m||(m=new nn(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,l.key,m.state))),m.uses++,this._tiles[l.key]=m,w||this._source.fire(new t.Event("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m}_setTileReloadTimer(l,m){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const w=m.getExpiryTimeout();w&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},w))}_removeTile(l){const m=this._tiles[l];m&&(m.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,m,w){const C=[],D=this.transform;if(!D)return C;const U=w?D.getCameraQueryGeometry(l):l,q=l.map(Oe=>D.pointCoordinate(Oe,this.terrain)),K=U.map(Oe=>D.pointCoordinate(Oe,this.terrain)),ee=this.getIds();let le=1/0,me=1/0,be=-1/0,qe=-1/0;for(const Oe of K)le=Math.min(le,Oe.x),me=Math.min(me,Oe.y),be=Math.max(be,Oe.x),qe=Math.max(qe,Oe.y);for(let Oe=0;Oe<ee.length;Oe++){const Fe=this._tiles[ee[Oe]];if(Fe.holdingForFade())continue;const ht=Fe.tileID,vt=Math.pow(2,D.zoom-Fe.tileID.overscaledZ),Pt=m*Fe.queryPadding*t.EXTENT/Fe.tileSize/vt,Ke=[ht.getTilePoint(new t.MercatorCoordinate(le,me)),ht.getTilePoint(new t.MercatorCoordinate(be,qe))];if(Ke[0].x-Pt<t.EXTENT&&Ke[0].y-Pt<t.EXTENT&&Ke[1].x+Pt>=0&&Ke[1].y+Pt>=0){const Rt=q.map(ii=>ht.getTilePoint(ii)),Bt=K.map(ii=>ht.getTilePoint(ii));C.push({tile:Fe,tileID:ht,queryGeometry:Rt,cameraQueryGeometry:Bt,scale:vt})}}return C}getVisibleCoordinates(l){const m=this.getRenderableIds(l).map(w=>this._tiles[w].tileID);for(const w of m)w.posMatrix=this.transform.calculatePosMatrix(w.toUnwrapped());return m}hasTransition(){if(this._source.hasTransition())return!0;if(Ir(this._source.type))for(const l in this._tiles){const m=this._tiles[l];if(m.fadeEndTime!==void 0&&m.fadeEndTime>=t.exported.now())return!0}return!1}setFeatureState(l,m,w){this._state.updateState(l=l||"_geojsonTileLayer",m,w)}removeFeatureState(l,m,w){this._state.removeFeatureState(l=l||"_geojsonTileLayer",m,w)}getFeatureState(l,m){return this._state.getState(l=l||"_geojsonTileLayer",m)}setDependencies(l,m,w){const C=this._tiles[l];C&&C.setDependencies(m,w)}reloadTilesForDependencies(l,m){for(const w in this._tiles)this._tiles[w].hasDependency(l,m)&&this._reloadTile(w,"reloading");this._cache.filter(w=>!w.hasDependency(l,m))}}function Rs(S,l){const m=Math.abs(2*S.wrap)-+(S.wrap<0),w=Math.abs(2*l.wrap)-+(l.wrap<0);return S.overscaledZ-l.overscaledZ||w-m||l.canonical.y-S.canonical.y||l.canonical.x-S.canonical.x}function Ir(S){return S==="raster"||S==="image"||S==="video"}eo.maxOverzooming=10,eo.maxUnderzooming=3;const wn="mapboxgl_preloaded_worker_pool";class hn{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<hn.workerCount;)this.workers.push(new Worker(Ya.workerUrl));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[wn]}numActive(){return Object.keys(this.active).length}}const $s=Math.floor(t.exported.hardwareConcurrency/2);let sn;function Vn(){return sn||(sn=new hn),sn}function ra(S,l){const m={};for(const w in S)w!=="ref"&&(m[w]=S[w]);return t.refProperties.forEach(w=>{w in l&&(m[w]=l[w])}),m}function ns(S){S=S.slice();const l=Object.create(null);for(let m=0;m<S.length;m++)l[S[m].id]=S[m];for(let m=0;m<S.length;m++)"ref"in S[m]&&(S[m]=ra(S[m],l[S[m].ref]));return S}hn.workerCount=Math.max(Math.min($s,6),1);const xr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Wo(S,l,m){m.push({command:xr.addSource,args:[S,l[S]]})}function os(S,l,m){l.push({command:xr.removeSource,args:[S]}),m[S]=!0}function gs(S,l,m,w){os(S,m,w),Wo(S,l,m)}function ys(S,l,m){let w;for(w in S[m])if(Object.prototype.hasOwnProperty.call(S[m],w)&&w!=="data"&&!he(S[m][w],l[m][w]))return!1;for(w in l[m])if(Object.prototype.hasOwnProperty.call(l[m],w)&&w!=="data"&&!he(S[m][w],l[m][w]))return!1;return!0}function to(S,l,m,w,C,D){let U;for(U in l=l||{},S=S||{})Object.prototype.hasOwnProperty.call(S,U)&&(he(S[U],l[U])||m.push({command:D,args:[w,U,l[U],C]}));for(U in l)Object.prototype.hasOwnProperty.call(l,U)&&!Object.prototype.hasOwnProperty.call(S,U)&&(he(S[U],l[U])||m.push({command:D,args:[w,U,l[U],C]}))}function Eo(S){return S.id}function Zs(S,l){return S[l.id]=l,S}class qn{constructor(l,m){this.reset(l,m)}reset(l,m){this.points=l||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=t.clamp(l,0,1);let m=1,w=this._distances[m];const C=l*this.paddedLength+this.padding;for(;w<C&&m<this._distances.length;)w=this._distances[++m];const D=m-1,U=this._distances[D],q=w-U,K=q>0?(C-U)/q:0;return this.points[D].mult(1-K).add(this.points[m].mult(K))}}function qt(S,l){let m=!0;return S==="always"||S!=="never"&&l!=="never"||(m=!1),m}class Mi{constructor(l,m,w){const C=this.boxCells=[],D=this.circleCells=[];this.xCellCount=Math.ceil(l/w),this.yCellCount=Math.ceil(m/w);for(let U=0;U<this.xCellCount*this.yCellCount;U++)C.push([]),D.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=m,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,m,w,C,D){this._forEachCell(m,w,C,D,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(m),this.bboxes.push(w),this.bboxes.push(C),this.bboxes.push(D)}insertCircle(l,m,w,C){this._forEachCell(m-C,w-C,m+C,w+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(m),this.circles.push(w),this.circles.push(C)}_insertBoxCell(l,m,w,C,D,U){this.boxCells[D].push(U)}_insertCircleCell(l,m,w,C,D,U){this.circleCells[D].push(U)}_query(l,m,w,C,D,U,q){if(w<0||l>this.width||C<0||m>this.height)return[];const K=[];if(l<=0&&m<=0&&this.width<=w&&this.height<=C){if(D)return[{key:null,x1:l,y1:m,x2:w,y2:C}];for(let ee=0;ee<this.boxKeys.length;ee++)K.push({key:this.boxKeys[ee],x1:this.bboxes[4*ee],y1:this.bboxes[4*ee+1],x2:this.bboxes[4*ee+2],y2:this.bboxes[4*ee+3]});for(let ee=0;ee<this.circleKeys.length;ee++){const le=this.circles[3*ee],me=this.circles[3*ee+1],be=this.circles[3*ee+2];K.push({key:this.circleKeys[ee],x1:le-be,y1:me-be,x2:le+be,y2:me+be})}}else this._forEachCell(l,m,w,C,this._queryCell,K,{hitTest:D,overlapMode:U,seenUids:{box:{},circle:{}}},q);return K}query(l,m,w,C){return this._query(l,m,w,C,!1,null)}hitTest(l,m,w,C,D,U){return this._query(l,m,w,C,!0,D,U).length>0}hitTestCircle(l,m,w,C,D){const U=l-w,q=l+w,K=m-w,ee=m+w;if(q<0||U>this.width||ee<0||K>this.height)return!1;const le=[];return this._forEachCell(U,K,q,ee,this._queryCellCircle,le,{hitTest:!0,overlapMode:C,circle:{x:l,y:m,radius:w},seenUids:{box:{},circle:{}}},D),le.length>0}_queryCell(l,m,w,C,D,U,q,K){const{seenUids:ee,hitTest:le,overlapMode:me}=q,be=this.boxCells[D];if(be!==null){const Oe=this.bboxes;for(const Fe of be)if(!ee.box[Fe]){ee.box[Fe]=!0;const ht=4*Fe,vt=this.boxKeys[Fe];if(l<=Oe[ht+2]&&m<=Oe[ht+3]&&w>=Oe[ht+0]&&C>=Oe[ht+1]&&(!K||K(vt))&&(!le||!qt(me,vt.overlapMode))&&(U.push({key:vt,x1:Oe[ht],y1:Oe[ht+1],x2:Oe[ht+2],y2:Oe[ht+3]}),le))return!0}}const qe=this.circleCells[D];if(qe!==null){const Oe=this.circles;for(const Fe of qe)if(!ee.circle[Fe]){ee.circle[Fe]=!0;const ht=3*Fe,vt=this.circleKeys[Fe];if(this._circleAndRectCollide(Oe[ht],Oe[ht+1],Oe[ht+2],l,m,w,C)&&(!K||K(vt))&&(!le||!qt(me,vt.overlapMode))){const Pt=Oe[ht],Ke=Oe[ht+1],Rt=Oe[ht+2];if(U.push({key:vt,x1:Pt-Rt,y1:Ke-Rt,x2:Pt+Rt,y2:Ke+Rt}),le)return!0}}}return!1}_queryCellCircle(l,m,w,C,D,U,q,K){const{circle:ee,seenUids:le,overlapMode:me}=q,be=this.boxCells[D];if(be!==null){const Oe=this.bboxes;for(const Fe of be)if(!le.box[Fe]){le.box[Fe]=!0;const ht=4*Fe,vt=this.boxKeys[Fe];if(this._circleAndRectCollide(ee.x,ee.y,ee.radius,Oe[ht+0],Oe[ht+1],Oe[ht+2],Oe[ht+3])&&(!K||K(vt))&&!qt(me,vt.overlapMode))return U.push(!0),!0}}const qe=this.circleCells[D];if(qe!==null){const Oe=this.circles;for(const Fe of qe)if(!le.circle[Fe]){le.circle[Fe]=!0;const ht=3*Fe,vt=this.circleKeys[Fe];if(this._circlesCollide(Oe[ht],Oe[ht+1],Oe[ht+2],ee.x,ee.y,ee.radius)&&(!K||K(vt))&&!qt(me,vt.overlapMode))return U.push(!0),!0}}}_forEachCell(l,m,w,C,D,U,q,K){const ee=this._convertToXCellCoord(l),le=this._convertToYCellCoord(m),me=this._convertToXCellCoord(w),be=this._convertToYCellCoord(C);for(let qe=ee;qe<=me;qe++)for(let Oe=le;Oe<=be;Oe++)if(D.call(this,l,m,w,C,this.xCellCount*Oe+qe,U,q,K))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,m,w,C,D,U){const q=C-l,K=D-m,ee=w+U;return ee*ee>q*q+K*K}_circleAndRectCollide(l,m,w,C,D,U,q){const K=(U-C)/2,ee=Math.abs(l-(C+K));if(ee>K+w)return!1;const le=(q-D)/2,me=Math.abs(m-(D+le));if(me>le+w)return!1;if(ee<=K||me<=le)return!0;const be=ee-K,qe=me-le;return be*be+qe*qe<=w*w}}function Xo(S,l,m,w,C){const D=t.create();return l?(t.scale(D,D,[1/C,1/C,1]),m||t.rotateZ(D,D,w.angle)):t.multiply(D,w.labelPlaneMatrix,S),D}function so(S,l,m,w,C){if(l){const D=t.clone(S);return t.scale(D,D,[C,C,1]),m||t.rotateZ(D,D,-w.angle),D}return w.glCoordMatrix}function Gr(S,l,m){let w;m?(w=[S.x,S.y,m(S.x,S.y),1],t.transformMat4(w,w,l)):(w=[S.x,S.y,0,1],Je(w,w,l));const C=w[3];return{point:new t.pointGeometry(w[0]/C,w[1]/C),signedDistanceFromCamera:C}}function zn(S,l){return .5+S/l*.5}function Hn(S,l){const m=S[0]/S[3],w=S[1]/S[3];return m>=-l[0]&&m<=l[0]&&w>=-l[1]&&w<=l[1]}function io(S,l,m,w,C,D,U,q,K,ee){const le=w?S.textSizeData:S.iconSizeData,me=t.evaluateSizeForZoom(le,m.transform.zoom),be=[256/m.width*2+1,256/m.height*2+1],qe=w?S.text.dynamicLayoutVertexArray:S.icon.dynamicLayoutVertexArray;qe.clear();const Oe=S.lineVertexArray,Fe=w?S.text.placedSymbolArray:S.icon.placedSymbolArray,ht=m.transform.width/m.transform.height;let vt=!1;for(let Pt=0;Pt<Fe.length;Pt++){const Ke=Fe.get(Pt);if(Ke.hidden||Ke.writingMode===t.WritingMode.vertical&&!vt){Ae(Ke.numGlyphs,qe);continue}let Rt;if(vt=!1,ee?(Rt=[Ke.anchorX,Ke.anchorY,ee(Ke.anchorX,Ke.anchorY),1],t.transformMat4(Rt,Rt,l)):(Rt=[Ke.anchorX,Ke.anchorY,0,1],Je(Rt,Rt,l)),!Hn(Rt,be)){Ae(Ke.numGlyphs,qe);continue}const Bt=zn(m.transform.cameraToCenterDistance,Rt[3]),ii=t.evaluateSizeForFeature(le,me,Ke),Yt=U?ii/Bt:ii*Bt,di=new t.pointGeometry(Ke.anchorX,Ke.anchorY),Wt=Gr(di,C,ee).point,Ui={},Ft=Tr(Ke,Yt,!1,q,l,C,D,S.glyphOffsetArray,Oe,qe,Wt,di,Ui,ht,K,ee);vt=Ft.useVertical,(Ft.notEnoughRoom||vt||Ft.needsFlipping&&Tr(Ke,Yt,!0,q,l,C,D,S.glyphOffsetArray,Oe,qe,Wt,di,Ui,ht,K,ee).notEnoughRoom)&&Ae(Ke.numGlyphs,qe)}w?S.text.dynamicLayoutVertexBuffer.updateData(qe):S.icon.dynamicLayoutVertexBuffer.updateData(qe)}function Ao(S,l,m,w,C,D,U,q,K,ee,le,me,be){const qe=q.glyphStartIndex+q.numGlyphs,Oe=q.lineStartIndex,Fe=q.lineStartIndex+q.lineLength,ht=l.getoffsetX(q.glyphStartIndex),vt=l.getoffsetX(qe-1),Pt=de(S*ht,m,w,C,D,U,q.segment,Oe,Fe,K,ee,le,me,be);if(!Pt)return null;const Ke=de(S*vt,m,w,C,D,U,q.segment,Oe,Fe,K,ee,le,me,be);return Ke?{first:Pt,last:Ke}:null}function Ii(S,l,m,w){return S===t.WritingMode.horizontal&&Math.abs(m.y-l.y)>Math.abs(m.x-l.x)*w?{useVertical:!0}:(S===t.WritingMode.vertical?l.y<m.y:l.x>m.x)?{needsFlipping:!0}:null}function Tr(S,l,m,w,C,D,U,q,K,ee,le,me,be,qe,Oe,Fe){const ht=l/24,vt=S.lineOffsetX*ht,Pt=S.lineOffsetY*ht;let Ke;if(S.numGlyphs>1){const Rt=S.glyphStartIndex+S.numGlyphs,Bt=S.lineStartIndex,ii=S.lineStartIndex+S.lineLength,Yt=Ao(ht,q,vt,Pt,m,le,me,S,K,D,be,Oe,Fe);if(!Yt)return{notEnoughRoom:!0};const di=Gr(Yt.first.point,U,Fe).point,Wt=Gr(Yt.last.point,U,Fe).point;if(w&&!m){const Ui=Ii(S.writingMode,di,Wt,qe);if(Ui)return Ui}Ke=[Yt.first];for(let Ui=S.glyphStartIndex+1;Ui<Rt-1;Ui++)Ke.push(de(ht*q.getoffsetX(Ui),vt,Pt,m,le,me,S.segment,Bt,ii,K,D,be,Oe,Fe));Ke.push(Yt.last)}else{if(w&&!m){const Bt=Gr(me,C,Fe).point,ii=S.lineStartIndex+S.segment+1,Yt=new t.pointGeometry(K.getx(ii),K.gety(ii)),di=Gr(Yt,C,Fe),Wt=di.signedDistanceFromCamera>0?di.point:De(me,Yt,Bt,1,C,Fe),Ui=Ii(S.writingMode,Bt,Wt,qe);if(Ui)return Ui}const Rt=de(ht*q.getoffsetX(S.glyphStartIndex),vt,Pt,m,le,me,S.segment,S.lineStartIndex,S.lineStartIndex+S.lineLength,K,D,be,Oe,Fe);if(!Rt)return{notEnoughRoom:!0};Ke=[Rt]}for(const Rt of Ke)t.addDynamicAttributes(ee,Rt.point,Rt.angle);return{}}function De(S,l,m,w,C,D){const U=Gr(S.add(S.sub(l)._unit()),C,D).point,q=m.sub(U);return m.add(q._mult(w/q.mag()))}function de(S,l,m,w,C,D,U,q,K,ee,le,me,be,qe){const Oe=w?S-l:S+l;let Fe=Oe>0?1:-1,ht=0;w&&(Fe*=-1,ht=Math.PI),Fe<0&&(ht+=Math.PI);let vt=Fe>0?q+U:q+U+1,Pt=C,Ke=C,Rt=0,Bt=0;const ii=Math.abs(Oe),Yt=[];for(;Rt+Bt<=ii;){if(vt+=Fe,vt<q||vt>=K)return null;if(Ke=Pt,Yt.push(Pt),Pt=me[vt],Pt===void 0){const qi=new t.pointGeometry(ee.getx(vt),ee.gety(vt)),Er=Gr(qi,le,qe);if(Er.signedDistanceFromCamera>0)Pt=me[vt]=Er.point;else{const Sr=vt-Fe;Pt=De(Rt===0?D:new t.pointGeometry(ee.getx(Sr),ee.gety(Sr)),qi,Ke,ii-Rt+1,le,qe)}}Rt+=Bt,Bt=Ke.dist(Pt)}const di=(ii-Rt)/Bt,Wt=Pt.sub(Ke),Ui=Wt.mult(di)._add(Ke);Ui._add(Wt._unit()._perp()._mult(m*Fe));const Ft=ht+Math.atan2(Pt.y-Ke.y,Pt.x-Ke.x);return Yt.push(Ui),{point:Ui,angle:be?Ft:0,path:Yt}}const _e=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ae(S,l){for(let m=0;m<S;m++){const w=l.length;l.resize(w+4),l.float32.set(_e,3*w)}}function Je(S,l,m){const w=l[0],C=l[1];return S[0]=m[0]*w+m[4]*C+m[12],S[1]=m[1]*w+m[5]*C+m[13],S[3]=m[3]*w+m[7]*C+m[15],S}const ot=100;class Tt{constructor(l,m=new Mi(l.width+200,l.height+200,25),w=new Mi(l.width+200,l.height+200,25)){this.transform=l,this.grid=m,this.ignoredGrid=w,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+ot,this.screenBottomBoundary=l.height+ot,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,m,w,C,D,U){const q=this.projectAndGetPerspectiveRatio(C,l.anchorPointX,l.anchorPointY,U),K=w*q.perspectiveRatio,ee=l.x1*K+q.point.x,le=l.y1*K+q.point.y,me=l.x2*K+q.point.x,be=l.y2*K+q.point.y;return!this.isInsideGrid(ee,le,me,be)||m!=="always"&&this.grid.hitTest(ee,le,me,be,m,D)||q.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[ee,le,me,be],offscreen:this.isOffscreen(ee,le,me,be)}}placeCollisionCircles(l,m,w,C,D,U,q,K,ee,le,me,be,qe,Oe){const Fe=[],ht=new t.pointGeometry(m.anchorX,m.anchorY),vt=Gr(ht,U,Oe),Pt=zn(this.transform.cameraToCenterDistance,vt.signedDistanceFromCamera),Ke=(le?D/Pt:D*Pt)/t.ONE_EM,Rt=Gr(ht,q,Oe).point,Bt=Ao(Ke,C,m.lineOffsetX*Ke,m.lineOffsetY*Ke,!1,Rt,ht,m,w,q,{},!1,Oe);let ii=!1,Yt=!1,di=!0;if(Bt){const Wt=.5*be*Pt+qe,Ui=new t.pointGeometry(-100,-100),Ft=new t.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),qi=new qn,Er=Bt.first,Sr=Bt.last;let ir=[];for(let Yr=Er.path.length-1;Yr>=1;Yr--)ir.push(Er.path[Yr]);for(let Yr=1;Yr<Sr.path.length;Yr++)ir.push(Sr.path[Yr]);const pi=2.5*Wt;if(K){const Yr=ir.map(Jr=>Gr(Jr,K,Oe));ir=Yr.some(Jr=>Jr.signedDistanceFromCamera<=0)?[]:Yr.map(Jr=>Jr.point)}let cn=[];if(ir.length>0){const Yr=ir[0].clone(),Jr=ir[0].clone();for(let dn=1;dn<ir.length;dn++)Yr.x=Math.min(Yr.x,ir[dn].x),Yr.y=Math.min(Yr.y,ir[dn].y),Jr.x=Math.max(Jr.x,ir[dn].x),Jr.y=Math.max(Jr.y,ir[dn].y);cn=Yr.x>=Ui.x&&Jr.x<=Ft.x&&Yr.y>=Ui.y&&Jr.y<=Ft.y?[ir]:Jr.x<Ui.x||Yr.x>Ft.x||Jr.y<Ui.y||Yr.y>Ft.y?[]:t.clipLine([ir],Ui.x,Ui.y,Ft.x,Ft.y)}for(const Yr of cn){qi.reset(Yr,.25*Wt);let Jr=0;Jr=qi.length<=.5*Wt?1:Math.ceil(qi.paddedLength/pi)+1;for(let dn=0;dn<Jr;dn++){const _o=dn/Math.max(Jr-1,1),ha=qi.lerp(_o),da=ha.x+ot,Ea=ha.y+ot;Fe.push(da,Ea,Wt,0);const Sa=da-Wt,Ms=Ea-Wt,Qo=da+Wt,Cs=Ea+Wt;if(di=di&&this.isOffscreen(Sa,Ms,Qo,Cs),Yt=Yt||this.isInsideGrid(Sa,Ms,Qo,Cs),l!=="always"&&this.grid.hitTestCircle(da,Ea,Wt,l,me)&&(ii=!0,!ee))return{circles:[],offscreen:!1,collisionDetected:ii}}}}return{circles:!ee&&ii||!Yt||Pt<this.perspectiveRatioCutoff?[]:Fe,offscreen:di,collisionDetected:ii}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let w=1/0,C=1/0,D=-1/0,U=-1/0;for(const le of l){const me=new t.pointGeometry(le.x+ot,le.y+ot);w=Math.min(w,me.x),C=Math.min(C,me.y),D=Math.max(D,me.x),U=Math.max(U,me.y),m.push(me)}const q=this.grid.query(w,C,D,U).concat(this.ignoredGrid.query(w,C,D,U)),K={},ee={};for(const le of q){const me=le.key;if(K[me.bucketInstanceId]===void 0&&(K[me.bucketInstanceId]={}),K[me.bucketInstanceId][me.featureIndex])continue;const be=[new t.pointGeometry(le.x1,le.y1),new t.pointGeometry(le.x2,le.y1),new t.pointGeometry(le.x2,le.y2),new t.pointGeometry(le.x1,le.y2)];t.polygonIntersectsPolygon(m,be)&&(K[me.bucketInstanceId][me.featureIndex]=!0,ee[me.bucketInstanceId]===void 0&&(ee[me.bucketInstanceId]=[]),ee[me.bucketInstanceId].push(me.featureIndex))}return ee}insertCollisionBox(l,m,w,C,D,U){(w?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:D,collisionGroupID:U,overlapMode:m},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,m,w,C,D,U){const q=w?this.ignoredGrid:this.grid,K={bucketInstanceId:C,featureIndex:D,collisionGroupID:U,overlapMode:m};for(let ee=0;ee<l.length;ee+=4)q.insertCircle(K,l[ee],l[ee+1],l[ee+2])}projectAndGetPerspectiveRatio(l,m,w,C){let D;return C?(D=[m,w,C(m,w),1],t.transformMat4(D,D,l)):(D=[m,w,0,1],Je(D,D,l)),{point:new t.pointGeometry((D[0]/D[3]+1)/2*this.transform.width+ot,(-D[1]/D[3]+1)/2*this.transform.height+ot),perspectiveRatio:.5+this.transform.cameraToCenterDistance/D[3]*.5}}isOffscreen(l,m,w,C){return w<ot||l>=this.screenRightBoundary||C<ot||m>this.screenBottomBoundary}isInsideGrid(l,m,w,C){return w>=0&&l<this.gridRightBoundary&&C>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const l=t.identity([]);return t.translate(l,l,[-100,-100,0]),l}}function mt(S,l,m){return l*(t.EXTENT/(S.tileSize*Math.pow(2,m-S.tileID.overscaledZ)))}class st{constructor(l,m,w,C){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?m:-m))):C&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class xt{constructor(l,m,w,C,D){this.text=new st(l?l.text:null,m,w,D),this.icon=new st(l?l.icon:null,m,C,D)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gi{constructor(l,m,w){this.text=l,this.icon=m,this.skipFade=w}}class wi{constructor(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]}}class Pe{constructor(l,m,w,C,D){this.bucketInstanceId=l,this.featureIndex=m,this.sourceLayerIndex=w,this.bucketIndex=C,this.tileID=D}}class ct{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const m=++this.maxGroupID;this.collisionGroups[l]={ID:m,predicate:w=>w.collisionGroupID===m}}return this.collisionGroups[l]}}function bt(S,l,m,w,C){const{horizontalAlign:D,verticalAlign:U}=t.getAnchorAlignment(S),q=-(D-.5)*l,K=-(U-.5)*m,ee=t.evaluateVariableOffset(S,w);return new t.pointGeometry(q+ee[0]*C,K+ee[1]*C)}function jt(S,l,m,w,C,D){const{x1:U,x2:q,y1:K,y2:ee,anchorPointX:le,anchorPointY:me}=S,be=new t.pointGeometry(l,m);return w&&be._rotate(C?D:-D),{x1:U+be.x,y1:K+be.y,x2:q+be.x,y2:ee+be.y,anchorPointX:le,anchorPointY:me}}class pe{constructor(l,m,w,C,D){this.transform=l.clone(),this.terrain=m,this.collisionIndex=new Tt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=w,this.retainedQueryData={},this.collisionGroups=new ct(C),this.collisionCircleArrays={},this.prevPlacement=D,D&&(D.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,m,w,C){const D=w.getBucket(m),U=w.latestFeatureIndex;if(!D||!U||m.id!==D.layerIds[0])return;const q=w.collisionBoxArray,K=D.layers[0].layout,ee=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),le=w.tileSize/t.EXTENT,me=this.transform.calculatePosMatrix(w.tileID.toUnwrapped()),be=K.get("text-pitch-alignment")==="map",qe=K.get("text-rotation-alignment")==="map",Oe=mt(w,1,this.transform.zoom),Fe=Xo(me,be,qe,this.transform,Oe);let ht=null;if(be){const Pt=so(me,be,qe,this.transform,Oe);ht=t.multiply([],this.transform.labelPlaneMatrix,Pt)}this.retainedQueryData[D.bucketInstanceId]=new Pe(D.bucketInstanceId,U,D.sourceLayerIndex,D.index,w.tileID);const vt={bucket:D,layout:K,posMatrix:me,textLabelPlaneMatrix:Fe,labelToScreenMatrix:ht,scale:ee,textPixelRatio:le,holdingForFade:w.holdingForFade(),collisionBoxArray:q,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(D.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(D.sourceID)};if(C)for(const Pt of D.sortKeyRanges){const{sortKey:Ke,symbolInstanceStart:Rt,symbolInstanceEnd:Bt}=Pt;l.push({sortKey:Ke,symbolInstanceStart:Rt,symbolInstanceEnd:Bt,parameters:vt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:D.symbolInstances.length,parameters:vt})}attemptAnchorPlacement(l,m,w,C,D,U,q,K,ee,le,me,be,qe,Oe,Fe,ht){const vt=[be.textOffset0,be.textOffset1],Pt=bt(l,w,C,vt,D),Ke=this.collisionIndex.placeCollisionBox(jt(m,Pt.x,Pt.y,U,q,this.transform.angle),me,K,ee,le.predicate,ht);if((!Fe||this.collisionIndex.placeCollisionBox(jt(Fe,Pt.x,Pt.y,U,q,this.transform.angle),me,K,ee,le.predicate,ht).box.length!==0)&&Ke.box.length>0){let Rt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[be.crossTileID]&&this.prevPlacement.placements[be.crossTileID]&&this.prevPlacement.placements[be.crossTileID].text&&(Rt=this.prevPlacement.variableOffsets[be.crossTileID].anchor),be.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[be.crossTileID]={textOffset:vt,width:w,height:C,anchor:l,textBoxScale:D,prevAnchor:Rt},this.markUsedJustification(qe,l,be,Oe),qe.allowVerticalPlacement&&(this.markUsedOrientation(qe,Oe,be),this.placedOrientations[be.crossTileID]=Oe),{shift:Pt,placedGlyphBoxes:Ke}}}placeLayerBucketPart(l,m,w){const{bucket:C,layout:D,posMatrix:U,textLabelPlaneMatrix:q,labelToScreenMatrix:K,textPixelRatio:ee,holdingForFade:le,collisionBoxArray:me,partiallyEvaluatedTextSize:be,collisionGroup:qe}=l.parameters,Oe=D.get("text-optional"),Fe=D.get("icon-optional"),ht=t.getOverlapMode(D,"text-overlap","text-allow-overlap"),vt=ht==="always",Pt=t.getOverlapMode(D,"icon-overlap","icon-allow-overlap"),Ke=Pt==="always",Rt=D.get("text-rotation-alignment")==="map",Bt=D.get("text-pitch-alignment")==="map",ii=D.get("icon-text-fit")!=="none",Yt=D.get("symbol-z-order")==="viewport-y",di=vt&&(Ke||!C.hasIconData()||Fe),Wt=Ke&&(vt||!C.hasTextData()||Oe);!C.collisionArrays&&me&&C.deserializeCollisionBoxes(me);const Ui=(Ft,qi)=>{if(m[Ft.crossTileID])return;if(le)return void(this.placements[Ft.crossTileID]=new gi(!1,!1,!1));let Er=!1,Sr=!1,ir=!0,pi=null,cn={box:null,offscreen:null},Yr={box:null,offscreen:null},Jr=null,dn=null,_o=null,ha=0,da=0,Ea=0;qi.textFeatureIndex?ha=qi.textFeatureIndex:Ft.useRuntimeCollisionCircles&&(ha=Ft.featureIndex),qi.verticalTextFeatureIndex&&(da=qi.verticalTextFeatureIndex);const Sa=this.retainedQueryData[C.bucketInstanceId].tileID,Ms=this.terrain?(o,d)=>this.terrain.getElevation(Sa,o,d):null;for(const o of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const d=qi[o];d&&(d.elevation=Ms?Ms(d.anchorPointX,d.anchorPointY):0)}const Qo=qi.textBox;if(Qo){const o=x=>{let E=t.WritingMode.horizontal;if(C.allowVerticalPlacement&&!x&&this.prevPlacement){const A=this.prevPlacement.placedOrientations[Ft.crossTileID];A&&(this.placedOrientations[Ft.crossTileID]=A,E=A,this.markUsedOrientation(C,E,Ft))}return E},d=(x,E)=>{if(C.allowVerticalPlacement&&Ft.numVerticalGlyphVertices>0&&qi.verticalTextBox){for(const A of C.writingModes)if(A===t.WritingMode.vertical?(cn=E(),Yr=cn):cn=x(),cn&&cn.box&&cn.box.length)break}else cn=x()};if(D.get("text-variable-anchor")){let x=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ft.crossTileID]){const B=this.prevPlacement.variableOffsets[Ft.crossTileID];x.indexOf(B.anchor)>0&&(x=x.filter(O=>O!==B.anchor),x.unshift(B.anchor))}const E=(B,O,G)=>{const H=B.x2-B.x1,X=B.y2-B.y1,oe=Ft.textBoxScale,ve=ii&&Pt==="never"?O:null;let Ee={box:[],offscreen:!1};const Ie=ht!=="never"?2*x.length:x.length;for(let Ce=0;Ce<Ie;++Ce){const ze=this.attemptAnchorPlacement(x[Ce%x.length],B,H,X,oe,Rt,Bt,ee,U,qe,Ce>=x.length?ht:"never",Ft,C,G,ve,Ms);if(ze&&(Ee=ze.placedGlyphBoxes,Ee&&Ee.box&&Ee.box.length)){Er=!0,pi=ze.shift;break}}return Ee};d(()=>E(Qo,qi.iconBox,t.WritingMode.horizontal),()=>{const B=qi.verticalTextBox;return C.allowVerticalPlacement&&!(cn&&cn.box&&cn.box.length)&&Ft.numVerticalGlyphVertices>0&&B?E(B,qi.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}}),cn&&(Er=cn.box,ir=cn.offscreen);const A=o(cn&&cn.box);if(!Er&&this.prevPlacement){const B=this.prevPlacement.variableOffsets[Ft.crossTileID];B&&(this.variableOffsets[Ft.crossTileID]=B,this.markUsedJustification(C,B.anchor,Ft,A))}}else{const x=(E,A)=>{const B=this.collisionIndex.placeCollisionBox(E,ht,ee,U,qe.predicate,Ms);return B&&B.box&&B.box.length&&(this.markUsedOrientation(C,A,Ft),this.placedOrientations[Ft.crossTileID]=A),B};d(()=>x(Qo,t.WritingMode.horizontal),()=>{const E=qi.verticalTextBox;return C.allowVerticalPlacement&&Ft.numVerticalGlyphVertices>0&&E?x(E,t.WritingMode.vertical):{box:null,offscreen:null}}),o(cn&&cn.box&&cn.box.length)}}if(Jr=cn,Er=Jr&&Jr.box&&Jr.box.length>0,ir=Jr&&Jr.offscreen,Ft.useRuntimeCollisionCircles){const o=C.text.placedSymbolArray.get(Ft.centerJustifiedTextSymbolIndex),d=t.evaluateSizeForFeature(C.textSizeData,be,o),x=D.get("text-padding");dn=this.collisionIndex.placeCollisionCircles(ht,o,C.lineVertexArray,C.glyphOffsetArray,d,U,q,K,w,Bt,qe.predicate,Ft.collisionCircleDiameter,x,Ms),dn.circles.length&&dn.collisionDetected&&!w&&t.warnOnce("Collisions detected, but collision boxes are not shown"),Er=vt||dn.circles.length>0&&!dn.collisionDetected,ir=ir&&dn.offscreen}if(qi.iconFeatureIndex&&(Ea=qi.iconFeatureIndex),qi.iconBox){const o=d=>{const x=ii&&pi?jt(d,pi.x,pi.y,Rt,Bt,this.transform.angle):d;return this.collisionIndex.placeCollisionBox(x,Pt,ee,U,qe.predicate,Ms)};Yr&&Yr.box&&Yr.box.length&&qi.verticalIconBox?(_o=o(qi.verticalIconBox),Sr=_o.box.length>0):(_o=o(qi.iconBox),Sr=_o.box.length>0),ir=ir&&_o.offscreen}const Cs=Oe||Ft.numHorizontalGlyphVertices===0&&Ft.numVerticalGlyphVertices===0,_=Fe||Ft.numIconVertices===0;if(Cs||_?_?Cs||(Sr=Sr&&Er):Er=Sr&&Er:Sr=Er=Sr&&Er,Er&&Jr&&Jr.box&&this.collisionIndex.insertCollisionBox(Jr.box,ht,D.get("text-ignore-placement"),C.bucketInstanceId,Yr&&Yr.box&&da?da:ha,qe.ID),Sr&&_o&&this.collisionIndex.insertCollisionBox(_o.box,Pt,D.get("icon-ignore-placement"),C.bucketInstanceId,Ea,qe.ID),dn&&(Er&&this.collisionIndex.insertCollisionCircles(dn.circles,ht,D.get("text-ignore-placement"),C.bucketInstanceId,ha,qe.ID),w)){const o=C.bucketInstanceId;let d=this.collisionCircleArrays[o];d===void 0&&(d=this.collisionCircleArrays[o]=new wi);for(let x=0;x<dn.circles.length;x+=4)d.circles.push(dn.circles[x+0]),d.circles.push(dn.circles[x+1]),d.circles.push(dn.circles[x+2]),d.circles.push(dn.collisionDetected?1:0)}if(Ft.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(C.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ft.crossTileID]=new gi(Er||di,Sr||Wt,ir||C.justReloaded),m[Ft.crossTileID]=!0};if(Yt){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ft=C.getSortedSymbolIndexes(this.transform.angle);for(let qi=Ft.length-1;qi>=0;--qi){const Er=Ft[qi];Ui(C.symbolInstances.get(Er),C.collisionArrays[Er])}}else for(let Ft=l.symbolInstanceStart;Ft<l.symbolInstanceEnd;Ft++)Ui(C.symbolInstances.get(Ft),C.collisionArrays[Ft]);if(w&&C.bucketInstanceId in this.collisionCircleArrays){const Ft=this.collisionCircleArrays[C.bucketInstanceId];t.invert(Ft.invProjMatrix,U),Ft.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(l,m,w,C){let D;D=C===t.WritingMode.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(m)];const U=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(const q of U)q>=0&&(l.text.placedSymbolArray.get(q).crossTileID=D>=0&&q!==D?0:w.crossTileID)}markUsedOrientation(l,m,w){const C=m===t.WritingMode.horizontal||m===t.WritingMode.horizontalOnly?m:0,D=m===t.WritingMode.vertical?m:0,U=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(const q of U)l.text.placedSymbolArray.get(q).placedOrientation=C;w.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=D)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let w=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const C=m?m.symbolFadeChange(l):1,D=m?m.opacities:{},U=m?m.variableOffsets:{},q=m?m.placedOrientations:{};for(const K in this.placements){const ee=this.placements[K],le=D[K];le?(this.opacities[K]=new xt(le,C,ee.text,ee.icon),w=w||ee.text!==le.text.placed||ee.icon!==le.icon.placed):(this.opacities[K]=new xt(null,C,ee.text,ee.icon,ee.skipFade),w=w||ee.text||ee.icon)}for(const K in D){const ee=D[K];if(!this.opacities[K]){const le=new xt(ee,C,!1,!1);le.isHidden()||(this.opacities[K]=le,w=w||ee.text.placed||ee.icon.placed)}}for(const K in U)this.variableOffsets[K]||!this.opacities[K]||this.opacities[K].isHidden()||(this.variableOffsets[K]=U[K]);for(const K in q)this.placedOrientations[K]||!this.opacities[K]||this.opacities[K].isHidden()||(this.placedOrientations[K]=q[K]);if(m&&m.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");w?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:l)}updateLayerOpacities(l,m){const w={};for(const C of m){const D=C.getBucket(l);D&&C.latestFeatureIndex&&l.id===D.layerIds[0]&&this.updateBucketOpacities(D,w,C.collisionBoxArray)}}updateBucketOpacities(l,m,w){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const C=l.layers[0].layout,D=new xt(null,0,!1,!1,!0),U=C.get("text-allow-overlap"),q=C.get("icon-allow-overlap"),K=C.get("text-variable-anchor"),ee=C.get("text-rotation-alignment")==="map",le=C.get("text-pitch-alignment")==="map",me=C.get("icon-text-fit")!=="none",be=new xt(null,0,U&&(q||!l.hasIconData()||C.get("icon-optional")),q&&(U||!l.hasTextData()||C.get("text-optional")),!0);!l.collisionArrays&&w&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(w);const qe=(Oe,Fe,ht)=>{for(let vt=0;vt<Fe/4;vt++)Oe.opacityVertexArray.emplaceBack(ht)};for(let Oe=0;Oe<l.symbolInstances.length;Oe++){const Fe=l.symbolInstances.get(Oe),{numHorizontalGlyphVertices:ht,numVerticalGlyphVertices:vt,crossTileID:Pt}=Fe;let Ke=this.opacities[Pt];m[Pt]?Ke=D:Ke||(Ke=be,this.opacities[Pt]=Ke),m[Pt]=!0;const Rt=Fe.numIconVertices>0,Bt=this.placedOrientations[Fe.crossTileID],ii=Bt===t.WritingMode.vertical,Yt=Bt===t.WritingMode.horizontal||Bt===t.WritingMode.horizontalOnly;if(ht>0||vt>0){const di=ut(Ke.text);qe(l.text,ht,ii?Dt:di),qe(l.text,vt,Yt?Dt:di);const Wt=Ke.text.isHidden();[Fe.rightJustifiedTextSymbolIndex,Fe.centerJustifiedTextSymbolIndex,Fe.leftJustifiedTextSymbolIndex].forEach(qi=>{qi>=0&&(l.text.placedSymbolArray.get(qi).hidden=Wt||ii?1:0)}),Fe.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(Fe.verticalPlacedTextSymbolIndex).hidden=Wt||Yt?1:0);const Ui=this.variableOffsets[Fe.crossTileID];Ui&&this.markUsedJustification(l,Ui.anchor,Fe,Bt);const Ft=this.placedOrientations[Fe.crossTileID];Ft&&(this.markUsedJustification(l,"left",Fe,Ft),this.markUsedOrientation(l,Ft,Fe))}if(Rt){const di=ut(Ke.icon),Wt=!(me&&Fe.verticalPlacedIconSymbolIndex&&ii);Fe.placedIconSymbolIndex>=0&&(qe(l.icon,Fe.numIconVertices,Wt?di:Dt),l.icon.placedSymbolArray.get(Fe.placedIconSymbolIndex).hidden=Ke.icon.isHidden()),Fe.verticalPlacedIconSymbolIndex>=0&&(qe(l.icon,Fe.numVerticalIconVertices,Wt?Dt:di),l.icon.placedSymbolArray.get(Fe.verticalPlacedIconSymbolIndex).hidden=Ke.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const di=l.collisionArrays[Oe];if(di){let Wt=new t.pointGeometry(0,0);if(di.textBox||di.verticalTextBox){let Ft=!0;if(K){const qi=this.variableOffsets[Pt];qi?(Wt=bt(qi.anchor,qi.width,qi.height,qi.textOffset,qi.textBoxScale),ee&&Wt._rotate(le?this.transform.angle:-this.transform.angle)):Ft=!1}di.textBox&&Y(l.textCollisionBox.collisionVertexArray,Ke.text.placed,!Ft||ii,Wt.x,Wt.y),di.verticalTextBox&&Y(l.textCollisionBox.collisionVertexArray,Ke.text.placed,!Ft||Yt,Wt.x,Wt.y)}const Ui=!!(!Yt&&di.verticalIconBox);di.iconBox&&Y(l.iconCollisionBox.collisionVertexArray,Ke.icon.placed,Ui,me?Wt.x:0,me?Wt.y:0),di.verticalIconBox&&Y(l.iconCollisionBox.collisionVertexArray,Ke.icon.placed,!Ui,me?Wt.x:0,me?Wt.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const Oe=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=Oe.invProjMatrix,l.placementViewportMatrix=Oe.viewportMatrix,l.collisionCircleArray=Oe.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,m){const w=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*w>l}setStale(){this.stale=!0}}function Y(S,l,m,w,C){S.emplaceBack(l?1:0,m?1:0,w||0,C||0),S.emplaceBack(l?1:0,m?1:0,w||0,C||0),S.emplaceBack(l?1:0,m?1:0,w||0,C||0),S.emplaceBack(l?1:0,m?1:0,w||0,C||0)}const re=Math.pow(2,25),fe=Math.pow(2,24),ge=Math.pow(2,17),ke=Math.pow(2,16),Ze=Math.pow(2,9),$e=Math.pow(2,8),Ve=Math.pow(2,1);function ut(S){if(S.opacity===0&&!S.placed)return 0;if(S.opacity===1&&S.placed)return 4294967295;const l=S.placed?1:0,m=Math.floor(127*S.opacity);return m*re+l*fe+m*ge+l*ke+m*Ze+l*$e+m*Ve+l}const Dt=0;class Ht{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,m,w,C,D){const U=this._bucketParts;for(;this._currentTileIndex<l.length;)if(m.getBucketParts(U,C,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,D())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,U.sort((q,K)=>q.sortKey-K.sortKey));this._currentPartIndex<U.length;)if(m.placeLayerBucketPart(U[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,D())return!0;return!1}}class ft{constructor(l,m,w,C,D,U,q,K){this.placement=new pe(l,m,U,q,K),this._currentPlacementIndex=w.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=D,this._done=!1}isDone(){return this._done}continuePlacement(l,m,w){const C=t.exported.now(),D=()=>{const U=t.exported.now()-C;return!this._forceFullPlacement&&U>2};for(;this._currentPlacementIndex>=0;){const U=m[l[this._currentPlacementIndex]],q=this.placement.collisionIndex.transform.zoom;if(U.type==="symbol"&&(!U.minzoom||U.minzoom<=q)&&(!U.maxzoom||U.maxzoom>q)){if(this._inProgressLayer||(this._inProgressLayer=new Ht(U)),this._inProgressLayer.continuePlacement(w[U.source],this.placement,this._showCollisionBoxes,U,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const ji=512/t.EXTENT/2;class Zi{constructor(l,m,w){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=w;for(let C=0;C<m.length;C++){const D=m.get(C),U=D.key;this.indexedSymbolInstances[U]||(this.indexedSymbolInstances[U]=[]),this.indexedSymbolInstances[U].push({crossTileID:D.crossTileID,coord:this.getScaledCoordinates(D,l)})}}getScaledCoordinates(l,m){const w=ji/Math.pow(2,m.canonical.z-this.tileID.canonical.z);return{x:Math.floor((m.canonical.x*t.EXTENT+l.anchorX)*w),y:Math.floor((m.canonical.y*t.EXTENT+l.anchorY)*w)}}findMatches(l,m,w){const C=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let D=0;D<l.length;D++){const U=l.get(D);if(U.crossTileID)continue;const q=this.indexedSymbolInstances[U.key];if(!q)continue;const K=this.getScaledCoordinates(U,m);for(const ee of q)if(Math.abs(ee.coord.x-K.x)<=C&&Math.abs(ee.coord.y-K.y)<=C&&!w[ee.crossTileID]){w[ee.crossTileID]=!0,U.crossTileID=ee.crossTileID;break}}}}class Ai{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Yi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const m=Math.round((l-this.lng)/360);if(m!==0)for(const w in this.indexes){const C=this.indexes[w],D={};for(const U in C){const q=C[U];q.tileID=q.tileID.unwrapTo(q.tileID.wrap+m),D[q.tileID.key]=q}this.indexes[w]=D}this.lng=l}addBucket(l,m,w){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let D=0;D<m.symbolInstances.length;D++)m.symbolInstances.get(D).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const C=this.usedCrossTileIDs[l.overscaledZ];for(const D in this.indexes){const U=this.indexes[D];if(Number(D)>l.overscaledZ)for(const q in U){const K=U[q];K.tileID.isChildOf(l)&&K.findMatches(m.symbolInstances,l,C)}else{const q=U[l.scaledTo(Number(D)).key];q&&q.findMatches(m.symbolInstances,l,C)}}for(let D=0;D<m.symbolInstances.length;D++){const U=m.symbolInstances.get(D);U.crossTileID||(U.crossTileID=w.generate(),C[U.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Zi(l,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(l,m){for(const w in m.indexedSymbolInstances)for(const C of m.indexedSymbolInstances[w])delete this.usedCrossTileIDs[l][C.crossTileID]}removeStaleBuckets(l){let m=!1;for(const w in this.indexes){const C=this.indexes[w];for(const D in C)l[C[D].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,C[D]),delete C[D],m=!0)}return m}}class rr{constructor(){this.layerIndexes={},this.crossTileIDs=new Ai,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,m,w){let C=this.layerIndexes[l.id];C===void 0&&(C=this.layerIndexes[l.id]=new Yi);let D=!1;const U={};C.handleWrapJump(w);for(const q of m){const K=q.getBucket(l);K&&l.id===K.layerIds[0]&&(K.bucketInstanceId||(K.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(q.tileID,K,this.crossTileIDs)&&(D=!0),U[K.bucketInstanceId]=!0)}return C.removeStaleBuckets(U)&&(D=!0),D}pruneUnusedLayers(l){const m={};l.forEach(w=>{m[w]=!0});for(const w in this.layerIndexes)m[w]||delete this.layerIndexes[w]}}var br=t.createLayout([{name:"a_pos",type:"Int16",components:2}]);class hr extends t.Evented{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=l._cache.max,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const l in this._tiles){const m=this._tiles[l];m.textures.forEach(w=>w.destroy()),m.textures=[]}}update(l,m){this.sourceCache.update(l,m),this._renderableTilesKeys=[];for(const w of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:m}))this._renderableTilesKeys.push(w.key),this._tiles[w.key]||(w.posMatrix=new Float64Array(16),t.ortho(w.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),this._tiles[w.key]=new nn(w,this.tileSize))}removeOutdated(l){const m={};this.renderHistory=this.renderHistory.filter((w,C)=>this.renderHistory.indexOf(w)===C).slice(0,this.renderHistorySize);for(const w of this._renderableTilesKeys)m[w]=!0;for(const w of this.renderHistory)m[w]=!0;for(const w in this._tiles)m[w]||(this._tiles[w].clearTextures(l),delete this._tiles[w])}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const m={};for(const w of this._renderableTilesKeys){const C=this._tiles[w].tileID;if(C.canonical.equals(l.canonical)){const D=l.clone();D.posMatrix=new Float64Array(16),t.ortho(D.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),m[w]=D}else if(C.canonical.isChildOf(l.canonical)){const D=l.clone();D.posMatrix=new Float64Array(16);const U=C.canonical.z-l.canonical.z,q=C.canonical.x-(C.canonical.x>>U<<U),K=C.canonical.y-(C.canonical.y>>U<<U),ee=t.EXTENT>>U;t.ortho(D.posMatrix,0,ee,0,ee,0,1),t.translate(D.posMatrix,D.posMatrix,[-q*ee,-K*ee,0]),m[w]=D}else if(l.canonical.isChildOf(C.canonical)){const D=l.clone();D.posMatrix=new Float64Array(16);const U=l.canonical.z-C.canonical.z,q=l.canonical.x-(l.canonical.x>>U<<U),K=l.canonical.y-(l.canonical.y>>U<<U),ee=t.EXTENT>>U;t.ortho(D.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),t.translate(D.posMatrix,D.posMatrix,[q*ee,K*ee,0]),t.scale(D.posMatrix,D.posMatrix,[1/2**U,1/2**U,0]),m[w]=D}}return m}getSourceTile(l,m){const w=this.sourceCache._source;let C=l.overscaledZ-this.deltaZoom;if(C>w.maxzoom&&(C=w.maxzoom),C<w.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(C).key);let D=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!D||!D.dem)&&m)for(;C>=w.minzoom&&(!D||!D.dem);)D=this.sourceCache.getTileByID(l.scaledTo(C--).key);return D}tilesAfterTime(l=Date.now()){return Object.values(this._tiles).filter(m=>m.timeLoaded>=l)}}class wr{constructor(l,m,w){this.style=l,this.sourceCache=new hr(m),this.options=w,this.exaggeration=typeof w.exaggeration=="number"?w.exaggeration:1,this.elevationOffset=typeof w.elevationOffset=="number"?w.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(l,m,w,C=t.EXTENT){if(!(m>=0&&m<C&&w>=0&&w<C))return this.elevationOffset;let D=0;const U=this.getTerrainData(l);if(U.tile&&U.tile.dem){const q=t.transformMat4$1([],[m/C*t.EXTENT,w/C*t.EXTENT],U.u_terrain_matrix),K=[q[0]*U.tile.dem.dim,q[1]*U.tile.dem.dim],ee=[Math.floor(K[0]),Math.floor(K[1])],le=U.tile.dem.get(ee[0],ee[1]),me=U.tile.dem.get(ee[0],ee[1]+1),be=U.tile.dem.get(ee[0]+1,ee[1]),qe=U.tile.dem.get(ee[0]+1,ee[1]+1);D=t.number(t.number(le,me,K[0]-ee[0]),t.number(be,qe,K[0]-ee[0]),K[1]-ee[1])}return D}rememberForRerender(l,m){for(const w in this.sourceCache._tiles){const C=this.sourceCache._tiles[w];(C.tileID.equals(m)||C.tileID.isChildOf(m))&&(l===this.sourceCache.sourceCache.id&&(C.timeLoaded=Date.now()),this._rerender[l]=this._rerender[l]||{},this._rerender[l][C.tileID.key]=!0)}}needsRerender(l,m){return this._rerender[l]&&this._rerender[l][m.key]}clearRerenderCache(){this._rerender={}}getElevation(l,m,w,C=t.EXTENT){return(this.getDEMElevation(l,m,w,C)+this.elevationOffset)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const C=this.style.map.painter.context,D=new t.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new at(C,D,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new at(C,new t.RGBAImage({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.identity([])}const m=this.sourceCache.getSourceTile(l,!0);if(m&&m.dem&&(!m.demTexture||m.needsTerrainPrepare)){const C=this.style.map.painter.context;m.demTexture=this.style.map.painter.getTileTexture(m.dem.stride),m.demTexture?m.demTexture.update(m.dem.getPixels(),{premultiply:!1}):m.demTexture=new at(C,m.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),m.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),m.needsTerrainPrepare=!1}const w=m&&m+m.tileID.key+l.key;if(w&&!this._demMatrixCache[w]){const C=this.sourceCache.sourceCache._source.maxzoom;let D=l.canonical.z-m.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=C?D=l.canonical.z-C:t.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const U=l.canonical.x-(l.canonical.x>>D<<D),q=l.canonical.y-(l.canonical.y>>D<<D),K=t.fromScaling(new Float64Array(16),[1/(t.EXTENT<<D),1/(t.EXTENT<<D),0]);t.translate(K,K,[U*t.EXTENT,q*t.EXTENT,0]),this._demMatrixCache[l.key]={matrix:K,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:m&&m.dem&&m.dem.dim||1,u_terrain_matrix:w?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:m&&m.dem&&m.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(m&&m.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:m}}getRTTFramebuffer(){const l=this.style.map.painter;if(!this._rttFramebuffer){const m=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=l.context.createFramebuffer(m,m,!0),this._rttFramebuffer.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,m,m))}return this._rttFramebuffer}getFramebuffer(l){const m=this.style.map.painter,w=m.width/devicePixelRatio,C=m.height/devicePixelRatio;return!this._fbo||this._fbo.width===w&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new at(m.context,{width:w,height:C,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new at(m.context,{width:w,height:C,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=m.context.createFramebuffer(w,C,!0),this._fbo.depthAttachment.set(m.context.createRenderbuffer(m.context.gl.DEPTH_COMPONENT16,w,C))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const m=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let D=0,U=0;D<this._coordsTextureSize;D++)for(let q=0;q<this._coordsTextureSize;q++,U+=4)m[U+0]=255&q,m[U+1]=255&D,m[U+2]=q>>8<<4|D>>8,m[U+3]=0;const w=new t.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(m.buffer)),C=new at(l,w,l.gl.RGBA,{premultiply:!1});return C.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(l){const m=new Uint8Array(4),w=this.style.map.painter,C=w.context,D=C.gl;C.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),D.readPixels(l.x,w.height/devicePixelRatio-l.y-1,1,1,D.RGBA,D.UNSIGNED_BYTE,m),C.bindFramebuffer.set(null);const U=m[0]+(m[2]>>4<<8),q=m[1]+((15&m[2])<<8),K=this.coordsIndex[255-m[3]],ee=K&&this.sourceCache.getTileByID(K);if(!ee)return null;const le=this._coordsTextureSize,me=(1<<ee.tileID.canonical.z)*le;return new t.MercatorCoordinate((ee.tileID.canonical.x*le+U)/me,(ee.tileID.canonical.y*le+q)/me,this.getElevation(ee.tileID,U,q,le))}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.style.map.painter.context,m=new t.PosArray,w=new t.TriangleIndexArray,C=this.meshSize,D=t.EXTENT/C,U=C*C;for(let q=0;q<=C;q++)for(let K=0;K<=C;K++)m.emplaceBack(K*D,q*D);for(let q=0;q<U;q+=C+1)for(let K=0;K<C;K++)w.emplaceBack(K+q,C+K+q+1,C+K+q+2),w.emplaceBack(K+q,C+K+q+2,K+q+1);return this._mesh={indexBuffer:l.createIndexBuffer(w),vertexBuffer:l.createVertexBuffer(m,br.members),segments:t.SegmentVector.simpleSegment(0,0,m.length,w.length)},this._mesh}getMinMaxElevation(l){const m=this.getTerrainData(l).tile,w={minElevation:null,maxElevation:null};return m&&m.dem&&(w.minElevation=(m.dem.min+this.elevationOffset)*this.exaggeration,w.maxElevation=(m.dem.max+this.elevationOffset)*this.exaggeration),w}}const Mr=(S,l)=>t.emitValidationErrors(S,l&&l.filter(m=>m.identifier!=="source.canvas")),Qi=t.pick(xr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Pr=t.pick(xr,["setCenter","setZoom","setBearing","setPitch"]),It=function(){const S={},l=t.spec.$version;for(const m in t.spec.$root){const w=t.spec.$root[m];if(w.required){let C=null;C=m==="version"?l:w.type==="array"?[]:{},C!=null&&(S[m]=C)}}return S}();class Tn extends t.Evented{constructor(l,m={}){super(),this.map=l,this.dispatcher=new Ci(Vn(),this),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new St(l._requestManager,m.localIdeographFontFamily),this.lineAtlas=new zt(256,512),this.crossTileSymbolIndex=new rr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const w=this;this._rtlTextPluginCallback=Tn.registerForPluginStateChange(C=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},(D,U)=>{if(t.triggerPluginCompletionEvent(D),U&&U.every(q=>q))for(const q in w.sourceCaches)w.sourceCaches[q].reload()})}),this.on("data",C=>{if(C.dataType!=="source"||C.sourceDataType!=="metadata")return;const D=this.sourceCaches[C.sourceId];if(!D)return;const U=D.getSource();if(U&&U.vectorLayerIds)for(const q in this._layers){const K=this._layers[q];K.source===U.id&&this._validateLayer(K)}})}loadURL(l,m={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const w=typeof m.validate!="boolean"||m.validate,C=this.map._requestManager.transformRequest(l,t.ResourceType.Style);this._request=t.getJSON(C,(D,U)=>{this._request=null,D?this.fire(new t.ErrorEvent(D)):U&&this._load(U,w)})}loadJSON(l,m={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame(()=>{this._request=null,this._load(l,m.validate!==!1)})}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(It,!1)}_load(l,m){if(m&&Mr(this,t.validateStyle(l)))return;this._loaded=!0,this.stylesheet=l;for(const C in l.sources)this.addSource(C,l.sources[C],{validate:!1});l.sprite?this._loadSprite(l.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(l.glyphs);const w=ns(this.stylesheet.layers);this._order=w.map(C=>C.id),this._layers={},this._serializedLayers={};for(let C of w)C=t.createStyleLayer(C),C.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ri(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}_loadSprite(l){this._spriteRequest=function(m,w,C,D){let U,q,K;const ee=C>1?"@2x":"";let le=t.getJSON(w.transformRequest(w.normalizeSpriteURL(m,ee,".json"),t.ResourceType.SpriteJSON),(qe,Oe)=>{le=null,K||(K=qe,U=Oe,be())}),me=t.getImage(w.transformRequest(w.normalizeSpriteURL(m,ee,".png"),t.ResourceType.SpriteImage),(qe,Oe)=>{me=null,K||(K=qe,q=Oe,be())});function be(){if(K)D(K);else if(U&&q){const qe=t.exported.getImageData(q),Oe={};for(const Fe in U){const{width:ht,height:vt,x:Pt,y:Ke,sdf:Rt,pixelRatio:Bt,stretchX:ii,stretchY:Yt,content:di}=U[Fe],Wt=new t.RGBAImage({width:ht,height:vt});t.RGBAImage.copy(qe,Wt,{x:Pt,y:Ke},{x:0,y:0},{width:ht,height:vt}),Oe[Fe]={data:Wt,pixelRatio:Bt,sdf:Rt,stretchX:ii,stretchY:Yt,content:di}}D(null,Oe)}}return{cancel(){le&&(le.cancel(),le=null),me&&(me.cancel(),me=null)}}}(l,this.map._requestManager,this.map.getPixelRatio(),(m,w)=>{if(this._spriteRequest=null,m)this.fire(new t.ErrorEvent(m));else if(w)for(const C in w)this.imageManager.addImage(C,w[C]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))})}_validateLayer(l){const m=this.sourceCaches[l.source];if(!m)return;const w=l.sourceLayer;if(!w)return;const C=m.getSource();(C.type==="geojson"||C.vectorLayerIds&&C.vectorLayerIds.indexOf(w)===-1)&&this.fire(new t.ErrorEvent(new Error(`Source layer "${w}" does not exist on source "${C.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const m=[];for(const w of l){const C=this._layers[w];C.type!=="custom"&&m.push(C.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const m=this._changed;if(this._changed){const C=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);(C.length||D.length)&&this._updateWorkerLayers(C,D);for(const U in this._updatedSources){const q=this._updatedSources[U];if(q==="reload")this._reloadSource(U);else{if(q!=="clear")throw new Error(`Invalid action ${q}`);this._clearSource(U)}}this._updateTilesForChangedImages();for(const U in this._updatedPaintProps)this._layers[U].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}const w={};for(const C in this.sourceCaches){const D=this.sourceCaches[C];w[C]=D.used,D.used=!1}for(const C of this._order){const D=this._layers[C];D.recalculate(l,this._availableImages),!D.isHidden(l.zoom)&&D.source&&(this.sourceCaches[D.source].used=!0)}for(const C in w){const D=this.sourceCaches[C];w[C]!==D.used&&D.fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(l),this.z=l.zoom,m&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(l){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),l){const m=this.sourceCaches[l.source];if(!m)throw new Error(`cannot load terrain, because there exists no source with ID: ${l.source}`);this.terrain=new wr(this,m,l),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=w=>{w.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=w=>{w.tile&&(w.sourceId===l.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(w.sourceId,w.tile.tileID)):w.source.type==="geojson"&&this.terrain.rememberForRerender(w.sourceId,w.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new t.Event("terrain",{terrain:l}))}setState(l){if(this._checkLoaded(),Mr(this,t.validateStyle(l)))return!1;(l=t.clone$1(l)).layers=ns(l.layers);const m=function(C,D){if(!C)return[{command:xr.setStyle,args:[D]}];let U=[];try{if(!he(C.version,D.version))return[{command:xr.setStyle,args:[D]}];he(C.center,D.center)||U.push({command:xr.setCenter,args:[D.center]}),he(C.zoom,D.zoom)||U.push({command:xr.setZoom,args:[D.zoom]}),he(C.bearing,D.bearing)||U.push({command:xr.setBearing,args:[D.bearing]}),he(C.pitch,D.pitch)||U.push({command:xr.setPitch,args:[D.pitch]}),he(C.sprite,D.sprite)||U.push({command:xr.setSprite,args:[D.sprite]}),he(C.glyphs,D.glyphs)||U.push({command:xr.setGlyphs,args:[D.glyphs]}),he(C.transition,D.transition)||U.push({command:xr.setTransition,args:[D.transition]}),he(C.light,D.light)||U.push({command:xr.setLight,args:[D.light]});const q={},K=[];(function(le,me,be,qe){let Oe;for(Oe in me=me||{},le=le||{})Object.prototype.hasOwnProperty.call(le,Oe)&&(Object.prototype.hasOwnProperty.call(me,Oe)||os(Oe,be,qe));for(Oe in me)Object.prototype.hasOwnProperty.call(me,Oe)&&(Object.prototype.hasOwnProperty.call(le,Oe)?he(le[Oe],me[Oe])||(le[Oe].type==="geojson"&&me[Oe].type==="geojson"&&ys(le,me,Oe)?be.push({command:xr.setGeoJSONSourceData,args:[Oe,me[Oe].data]}):gs(Oe,me,be,qe)):Wo(Oe,me,be))})(C.sources,D.sources,K,q);const ee=[];C.layers&&C.layers.forEach(le=>{q[le.source]?U.push({command:xr.removeLayer,args:[le.id]}):ee.push(le)}),U=U.concat(K),function(le,me,be){me=me||[];const qe=(le=le||[]).map(Eo),Oe=me.map(Eo),Fe=le.reduce(Zs,{}),ht=me.reduce(Zs,{}),vt=qe.slice(),Pt=Object.create(null);let Ke,Rt,Bt,ii,Yt,di,Wt;for(Ke=0,Rt=0;Ke<qe.length;Ke++)Bt=qe[Ke],Object.prototype.hasOwnProperty.call(ht,Bt)?Rt++:(be.push({command:xr.removeLayer,args:[Bt]}),vt.splice(vt.indexOf(Bt,Rt),1));for(Ke=0,Rt=0;Ke<Oe.length;Ke++)Bt=Oe[Oe.length-1-Ke],vt[vt.length-1-Ke]!==Bt&&(Object.prototype.hasOwnProperty.call(Fe,Bt)?(be.push({command:xr.removeLayer,args:[Bt]}),vt.splice(vt.lastIndexOf(Bt,vt.length-Rt),1)):Rt++,di=vt[vt.length-Ke],be.push({command:xr.addLayer,args:[ht[Bt],di]}),vt.splice(vt.length-Ke,0,Bt),Pt[Bt]=!0);for(Ke=0;Ke<Oe.length;Ke++)if(Bt=Oe[Ke],ii=Fe[Bt],Yt=ht[Bt],!Pt[Bt]&&!he(ii,Yt))if(he(ii.source,Yt.source)&&he(ii["source-layer"],Yt["source-layer"])&&he(ii.type,Yt.type)){for(Wt in to(ii.layout,Yt.layout,be,Bt,null,xr.setLayoutProperty),to(ii.paint,Yt.paint,be,Bt,null,xr.setPaintProperty),he(ii.filter,Yt.filter)||be.push({command:xr.setFilter,args:[Bt,Yt.filter]}),he(ii.minzoom,Yt.minzoom)&&he(ii.maxzoom,Yt.maxzoom)||be.push({command:xr.setLayerZoomRange,args:[Bt,Yt.minzoom,Yt.maxzoom]}),ii)Object.prototype.hasOwnProperty.call(ii,Wt)&&Wt!=="layout"&&Wt!=="paint"&&Wt!=="filter"&&Wt!=="metadata"&&Wt!=="minzoom"&&Wt!=="maxzoom"&&(Wt.indexOf("paint.")===0?to(ii[Wt],Yt[Wt],be,Bt,Wt.slice(6),xr.setPaintProperty):he(ii[Wt],Yt[Wt])||be.push({command:xr.setLayerProperty,args:[Bt,Wt,Yt[Wt]]}));for(Wt in Yt)Object.prototype.hasOwnProperty.call(Yt,Wt)&&!Object.prototype.hasOwnProperty.call(ii,Wt)&&Wt!=="layout"&&Wt!=="paint"&&Wt!=="filter"&&Wt!=="metadata"&&Wt!=="minzoom"&&Wt!=="maxzoom"&&(Wt.indexOf("paint.")===0?to(ii[Wt],Yt[Wt],be,Bt,Wt.slice(6),xr.setPaintProperty):he(ii[Wt],Yt[Wt])||be.push({command:xr.setLayerProperty,args:[Bt,Wt,Yt[Wt]]}))}else be.push({command:xr.removeLayer,args:[Bt]}),di=vt[vt.lastIndexOf(Bt)+1],be.push({command:xr.addLayer,args:[Yt,di]})}(ee,D.layers,U)}catch(q){console.warn("Unable to compute style diff:",q),U=[{command:xr.setStyle,args:[D]}]}return U}(this.serialize(),l).filter(C=>!(C.command in Pr));if(m.length===0)return!1;const w=m.filter(C=>!(C.command in Qi));if(w.length>0)throw new Error(`Unimplemented: ${w.map(C=>C.command).join(", ")}.`);return m.forEach(C=>{C.command!=="setTransition"&&this[C.command].apply(this,C.args)}),this.stylesheet=l,!0}addImage(l,m){if(this.getImage(l))return this.fire(new t.ErrorEvent(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,m),this._afterImageUpdated(l)}updateImage(l,m){this.imageManager.updateImage(l,m)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new t.ErrorEvent(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,m,w={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(t.validateStyle.source,`sources.${l}`,m,null,w))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const C=this.sourceCaches[l]=new eo(l,m,this.dispatcher);C.style=this,C.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:C.serialize(),sourceId:l})),C.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===l)return this.fire(new t.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${w}" is using it.`)));const m=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],m.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),m.setEventedParent(null),m.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,m){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const w=this.sourceCaches[l].getSource();if(w.type!=="geojson")throw new Error(`geojsonSource.type is ${w.type}, which is !== 'geojson`);w.setData(m),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,m,w={}){this._checkLoaded();const C=l.id;if(this.getLayer(C))return void this.fire(new t.ErrorEvent(new Error(`Layer "${C}" already exists on this map.`)));let D;if(l.type==="custom"){if(Mr(this,t.validateCustomStyleLayer(l)))return;D=t.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(C,l.source),l=t.clone$1(l),l=t.extend(l,{source:C})),this._validate(t.validateStyle.layer,`layers.${C}`,l,{arrayIndex:-1},w))return;D=t.createStyleLayer(l),this._validateLayer(D),D.setEventedParent(this,{layer:{id:C}}),this._serializedLayers[D.id]=D.serialize()}const U=m?this._order.indexOf(m):this._order.length;if(m&&U===-1)this.fire(new t.ErrorEvent(new Error(`Cannot add layer "${C}" before non-existing layer "${m}".`)));else{if(this._order.splice(U,0,C),this._layerOrderChanged=!0,this._layers[C]=D,this._removedLayers[C]&&D.source&&D.type!=="custom"){const q=this._removedLayers[C];delete this._removedLayers[C],q.type!==D.type?this._updatedSources[D.source]="clear":(this._updatedSources[D.source]="reload",this.sourceCaches[D.source].pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map)}}moveLayer(l,m){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new t.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===m)return;const w=this._order.indexOf(l);this._order.splice(w,1);const C=m?this._order.indexOf(m):this._order.length;m&&C===-1?this.fire(new t.ErrorEvent(new Error(`Cannot move layer "${l}" before non-existing layer "${m}".`))):(this._order.splice(C,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const m=this._layers[l];if(!m)return void this.fire(new t.ErrorEvent(new Error(`Cannot remove non-existing layer "${l}".`)));m.setEventedParent(null);const w=this._order.indexOf(l);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=m,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],m.onRemove&&m.onRemove(this.map)}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,m,w){this._checkLoaded();const C=this.getLayer(l);C?C.minzoom===m&&C.maxzoom===w||(m!=null&&(C.minzoom=m),w!=null&&(C.maxzoom=w),this._updateLayer(C)):this.fire(new t.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,m,w={}){this._checkLoaded();const C=this.getLayer(l);if(C){if(!he(C.filter,m))return m==null?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(t.validateStyle.filter,`layers.${C.id}.filter`,m,null,w)||(C.filter=t.clone$1(m),this._updateLayer(C)))}else this.fire(new t.ErrorEvent(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return t.clone$1(this.getLayer(l).filter)}setLayoutProperty(l,m,w,C={}){this._checkLoaded();const D=this.getLayer(l);D?he(D.getLayoutProperty(m),w)||(D.setLayoutProperty(m,w,C),this._updateLayer(D)):this.fire(new t.ErrorEvent(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,m){const w=this.getLayer(l);if(w)return w.getLayoutProperty(m);this.fire(new t.ErrorEvent(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,m,w,C={}){this._checkLoaded();const D=this.getLayer(l);D?he(D.getPaintProperty(m),w)||(D.setPaintProperty(m,w,C)&&this._updateLayer(D),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new t.ErrorEvent(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,m){return this.getLayer(l).getPaintProperty(m)}setFeatureState(l,m){this._checkLoaded();const w=l.source,C=l.sourceLayer,D=this.sourceCaches[w];if(D===void 0)return void this.fire(new t.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const U=D.getSource().type;U==="geojson"&&C?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):U!=="vector"||C?(l.id===void 0&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),D.setFeatureState(C,l.id,m)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,m){this._checkLoaded();const w=l.source,C=this.sourceCaches[w];if(C===void 0)return void this.fire(new t.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const D=C.getSource().type,U=D==="vector"?l.sourceLayer:void 0;D!=="vector"||U?m&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(U,l.id,m):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const m=l.source,w=l.sourceLayer,C=this.sourceCaches[m];if(C!==void 0)return C.getSource().type!=="vector"||w?(l.id===void 0&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),C.getFeatureState(w,l.id)):void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,l=>l.serialize()),layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(l){const m=U=>this._layers[U].type==="fill-extrusion",w={},C=[];for(let U=this._order.length-1;U>=0;U--){const q=this._order[U];if(m(q)){w[q]=U;for(const K of l){const ee=K[q];if(ee)for(const le of ee)C.push(le)}}}C.sort((U,q)=>q.intersectionZ-U.intersectionZ);const D=[];for(let U=this._order.length-1;U>=0;U--){const q=this._order[U];if(m(q))for(let K=C.length-1;K>=0;K--){const ee=C[K].feature;if(w[ee.layer.id]<U)break;D.push(ee),C.pop()}else for(const K of l){const ee=K[q];if(ee)for(const le of ee)D.push(le.feature)}}return D}queryRenderedFeatures(l,m,w){m&&m.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",m.filter,null,m);const C={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of m.layers){const q=this._layers[U];if(!q)return this.fire(new t.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];C[q.source]=!0}}const D=[];m.availableImages=this._availableImages;for(const U in this.sourceCaches)m.layers&&!C[U]||D.push(Vr(this.sourceCaches[U],this._layers,this._serializedLayers,l,m,w));return this.placement&&D.push(function(U,q,K,ee,le,me,be){const qe={},Oe=me.queryRenderedSymbols(ee),Fe=[];for(const ht of Object.keys(Oe).map(Number))Fe.push(be[ht]);Fe.sort(rn);for(const ht of Fe){const vt=ht.featureIndex.lookupSymbolFeatures(Oe[ht.bucketInstanceId],q,ht.bucketIndex,ht.sourceLayerIndex,le.filter,le.layers,le.availableImages,U);for(const Pt in vt){const Ke=qe[Pt]=qe[Pt]||[],Rt=vt[Pt];Rt.sort((Bt,ii)=>{const Yt=ht.featureSortOrder;if(Yt){const di=Yt.indexOf(Bt.featureIndex);return Yt.indexOf(ii.featureIndex)-di}return ii.featureIndex-Bt.featureIndex});for(const Bt of Rt)Ke.push(Bt)}}for(const ht in qe)qe[ht].forEach(vt=>{const Pt=vt.feature,Ke=K[U[ht].source].getFeatureState(Pt.layer["source-layer"],Pt.id);Pt.source=Pt.layer.source,Pt.layer["source-layer"]&&(Pt.sourceLayer=Pt.layer["source-layer"]),Pt.state=Ke});return qe}(this._layers,this._serializedLayers,this.sourceCaches,l,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)}querySourceFeatures(l,m){m&&m.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",m.filter,null,m);const w=this.sourceCaches[l];return w?function(C,D){const U=C.getRenderableIds().map(ee=>C.getTileByID(ee)),q=[],K={};for(let ee=0;ee<U.length;ee++){const le=U[ee],me=le.tileID.canonical.key;K[me]||(K[me]=!0,le.querySourceFeatures(q,D))}return q}(w,m):[]}addSourceType(l,m,w){return Tn.getSourceType(l)?w(new Error(`A source type called "${l}" already exists.`)):(Tn.setSourceType(l,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:m.workerSourceURL},w):w(null,null))}getLight(){return this.light.getLight()}setLight(l,m={}){this._checkLoaded();const w=this.light.getLight();let C=!1;for(const U in l)if(!he(l[U],w[U])){C=!0;break}if(!C)return;const D={now:t.exported.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,m),this.light.updateTransitions(D)}_validate(l,m,w,C,D={}){return(!D||D.validate!==!1)&&Mr(this,l.call(t.validateStyle,t.extend({key:m,style:this.serialize(),value:w,styleSpec:t.spec},C)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const m=this.sourceCaches[l];m.setEventedParent(null),m.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const m in this.sourceCaches)this.sourceCaches[m].update(l,this.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,m,w,C,D=!1){let U=!1,q=!1;const K={};for(const ee of this._order){const le=this._layers[ee];if(le.type!=="symbol")continue;if(!K[le.source]){const be=this.sourceCaches[le.source];K[le.source]=be.getRenderableIds(!0).map(qe=>be.getTileByID(qe)).sort((qe,Oe)=>Oe.tileID.overscaledZ-qe.tileID.overscaledZ||(qe.tileID.isLessThan(Oe.tileID)?-1:1))}const me=this.crossTileSymbolIndex.addLayer(le,K[le.source],l.center.lng);U=U||me}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((D=D||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),l.zoom))&&(this.pauseablePlacement=new ft(l,this.terrain,this._order,D,m,w,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,K),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),q=!0),U&&this.pauseablePlacement.placement.setStale()),q||U)for(const ee of this._order){const le=this._layers[ee];le.type==="symbol"&&this.placement.updateLayerOpacities(le,K[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,m,w){this.imageManager.getImages(m.icons,w),this._updateTilesForChangedImages();const C=this.sourceCaches[m.source];C&&C.setDependencies(m.tileID.key,m.type,m.icons)}getGlyphs(l,m,w){this.glyphManager.getGlyphs(m.stacks,w)}getResource(l,m,w){return t.makeRequest(m,w)}}Tn.getSourceType=function(S){return lr[S]},Tn.setSourceType=function(S,l){lr[S]=l},Tn.registerForPluginStateChange=t.registerForPluginStateChange;var Cr="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const En={prelude:ln(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:ln(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ln(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ln(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ln("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ln(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:ln(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ln("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ln("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ln("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ln(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:ln(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:ln(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:ln(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ln(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ln(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ln(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ln(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ln(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ln(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ln(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ln(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ln(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ln(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ln(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ln(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ln("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Cr),terrainDepth:ln("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Cr),terrainCoords:ln("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Cr)};function ln(S,l){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=l.match(/attribute ([\w]+) ([\w]+)/g),C=S.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),U=D?D.concat(C):C,q={};return{fragmentSource:S=S.replace(m,(K,ee,le,me,be)=>(q[be]=!0,ee==="define"?`
#ifndef HAS_UNIFORM_u_${be}
varying ${le} ${me} ${be};
#else
uniform ${le} ${me} u_${be};
#endif
`:`
#ifdef HAS_UNIFORM_u_${be}
    ${le} ${me} ${be} = u_${be};
#endif
`)),vertexSource:l=l.replace(m,(K,ee,le,me,be)=>{const qe=me==="float"?"vec2":"vec4",Oe=be.match(/color/)?"color":qe;return q[be]?ee==="define"?`
#ifndef HAS_UNIFORM_u_${be}
uniform lowp float u_${be}_t;
attribute ${le} ${qe} a_${be};
varying ${le} ${me} ${be};
#else
uniform ${le} ${me} u_${be};
#endif
`:Oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${be}
    ${be} = a_${be};
#else
    ${le} ${me} ${be} = u_${be};
#endif
`:`
#ifndef HAS_UNIFORM_u_${be}
    ${be} = unpack_mix_${Oe}(a_${be}, u_${be}_t);
#else
    ${le} ${me} ${be} = u_${be};
#endif
`:ee==="define"?`
#ifndef HAS_UNIFORM_u_${be}
uniform lowp float u_${be}_t;
attribute ${le} ${qe} a_${be};
#else
uniform ${le} ${me} u_${be};
#endif
`:Oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${be}
    ${le} ${me} ${be} = a_${be};
#else
    ${le} ${me} ${be} = u_${be};
#endif
`:`
#ifndef HAS_UNIFORM_u_${be}
    ${le} ${me} ${be} = unpack_mix_${Oe}(a_${be}, u_${be}_t);
#else
    ${le} ${me} ${be} = u_${be};
#endif
`}),staticAttributes:w,staticUniforms:U}}class xs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,m,w,C,D,U,q,K,ee){this.context=l;let le=this.boundPaintVertexBuffers.length!==C.length;for(let me=0;!le&&me<C.length;me++)this.boundPaintVertexBuffers[me]!==C[me]&&(le=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===m&&this.boundLayoutVertexBuffer===w&&!le&&this.boundIndexBuffer===D&&this.boundVertexOffset===U&&this.boundDynamicVertexBuffer===q&&this.boundDynamicVertexBuffer2===K&&this.boundDynamicVertexBuffer3===ee?(l.bindVertexArrayOES.set(this.vao),q&&q.bind(),D&&D.dynamicDraw&&D.bind(),K&&K.bind(),ee&&ee.bind()):this.freshBind(m,w,C,D,U,q,K,ee)}freshBind(l,m,w,C,D,U,q,K){let ee;const le=l.numAttributes,me=this.context,be=me.gl;if(me.extVertexArrayObject)this.vao&&this.destroy(),this.vao=me.extVertexArrayObject.createVertexArrayOES(),me.bindVertexArrayOES.set(this.vao),ee=0,this.boundProgram=l,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=C,this.boundVertexOffset=D,this.boundDynamicVertexBuffer=U,this.boundDynamicVertexBuffer2=q,this.boundDynamicVertexBuffer3=K;else{ee=me.currentNumAttributes||0;for(let qe=le;qe<ee;qe++)be.disableVertexAttribArray(qe)}m.enableAttributes(be,l);for(const qe of w)qe.enableAttributes(be,l);U&&U.enableAttributes(be,l),q&&q.enableAttributes(be,l),K&&K.enableAttributes(be,l),m.bind(),m.setVertexAttribPointers(be,l,D);for(const qe of w)qe.bind(),qe.setVertexAttribPointers(be,l,D);U&&(U.bind(),U.setVertexAttribPointers(be,l,D)),C&&C.bind(),q&&(q.bind(),q.setVertexAttribPointers(be,l,D)),K&&(K.bind(),K.setVertexAttribPointers(be,l,D)),me.currentNumAttributes=le}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function eu(S){const l=[];for(let m=0;m<S.length;m++){if(S[m]===null)continue;const w=S[m].split(" ");l.push(w.pop())}return l}class Eh{constructor(l,m,w,C,D,U,q){const K=l.gl;this.program=K.createProgram();const ee=eu(w.staticAttributes),le=C?C.getBinderAttributes():[],me=ee.concat(le),be=En.prelude.staticUniforms?eu(En.prelude.staticUniforms):[],qe=w.staticUniforms?eu(w.staticUniforms):[],Oe=C?C.getBinderUniforms():[],Fe=be.concat(qe).concat(Oe),ht=[];for(const Yt of Fe)ht.indexOf(Yt)<0&&ht.push(Yt);const vt=C?C.defines():[];U&&vt.push("#define OVERDRAW_INSPECTOR;"),q&&vt.push("#define TERRAIN3D;");const Pt=vt.concat(En.prelude.fragmentSource,w.fragmentSource).join(`
`),Ke=vt.concat(En.prelude.vertexSource,w.vertexSource).join(`
`),Rt=K.createShader(K.FRAGMENT_SHADER);if(K.isContextLost())return void(this.failedToCreate=!0);K.shaderSource(Rt,Pt),K.compileShader(Rt),K.attachShader(this.program,Rt);const Bt=K.createShader(K.VERTEX_SHADER);if(K.isContextLost())return void(this.failedToCreate=!0);K.shaderSource(Bt,Ke),K.compileShader(Bt),K.attachShader(this.program,Bt),this.attributes={};const ii={};this.numAttributes=me.length;for(let Yt=0;Yt<this.numAttributes;Yt++)me[Yt]&&(K.bindAttribLocation(this.program,Yt,me[Yt]),this.attributes[me[Yt]]=Yt);K.linkProgram(this.program),K.deleteShader(Bt),K.deleteShader(Rt);for(let Yt=0;Yt<ht.length;Yt++){const di=ht[Yt];if(di&&!ii[di]){const Wt=K.getUniformLocation(this.program,di);Wt&&(ii[di]=Wt)}}this.fixedUniforms=D(l,ii),this.terrainUniforms=((Yt,di)=>({u_depth:new t.Uniform1i(Yt,di.u_depth),u_terrain:new t.Uniform1i(Yt,di.u_terrain),u_terrain_dim:new t.Uniform1f(Yt,di.u_terrain_dim),u_terrain_matrix:new t.UniformMatrix4f(Yt,di.u_terrain_matrix),u_terrain_unpack:new t.Uniform4f(Yt,di.u_terrain_unpack),u_terrain_offset:new t.Uniform1f(Yt,di.u_terrain_offset),u_terrain_exaggeration:new t.Uniform1f(Yt,di.u_terrain_exaggeration)}))(l,ii),this.binderUniforms=C?C.getUniforms(l,ii):[]}draw(l,m,w,C,D,U,q,K,ee,le,me,be,qe,Oe,Fe,ht,vt,Pt){const Ke=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(w),l.setStencilMode(C),l.setColorMode(D),l.setCullFace(U),K){l.activeTexture.set(Ke.TEXTURE2),Ke.bindTexture(Ke.TEXTURE_2D,K.depthTexture),l.activeTexture.set(Ke.TEXTURE3),Ke.bindTexture(Ke.TEXTURE_2D,K.texture);for(const Bt in this.terrainUniforms)this.terrainUniforms[Bt].set(K[Bt])}for(const Bt in this.fixedUniforms)this.fixedUniforms[Bt].set(q[Bt]);Fe&&Fe.setUniforms(l,this.binderUniforms,qe,{zoom:Oe});let Rt=0;switch(m){case Ke.LINES:Rt=2;break;case Ke.TRIANGLES:Rt=3;break;case Ke.LINE_STRIP:Rt=1}for(const Bt of be.get()){const ii=Bt.vaos||(Bt.vaos={});(ii[ee]||(ii[ee]=new xs)).bind(l,this,le,Fe?Fe.getPaintVertexBuffers():[],me,Bt.vertexOffset,ht,vt,Pt),Ke.drawElements(m,Bt.primitiveLength*Rt,Ke.UNSIGNED_SHORT,Bt.primitiveOffset*Rt*2)}}}function $l(S,l,m){const w=1/mt(m,1,l.transform.tileZoom),C=Math.pow(2,m.tileID.overscaledZ),D=m.tileSize*Math.pow(2,l.transform.tileZoom)/C,U=D*(m.tileID.canonical.x+m.tileID.wrap*C),q=D*m.tileID.canonical.y;return{u_image:0,u_texsize:m.imageAtlasTexture.size,u_scale:[w,S.fromScale,S.toScale],u_fade:S.t,u_pixel_coord_upper:[U>>16,q>>16],u_pixel_coord_lower:[65535&U,65535&q]}}const Di=(S,l,m,w)=>{const C=l.style.light,D=C.properties.get("position"),U=[D.x,D.y,D.z],q=t.create$1();C.properties.get("anchor")==="viewport"&&t.fromRotation(q,-l.transform.angle),t.transformMat3(U,U,q);const K=C.properties.get("color");return{u_matrix:S,u_lightpos:U,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[K.r,K.g,K.b],u_vertical_gradient:+m,u_opacity:w}},$r=(S,l,m,w,C,D,U)=>t.extend(Di(S,l,m,w),$l(D,l,U),{u_height_factor:-Math.pow(2,C.overscaledZ)/U.tileSize/8}),Ar=S=>({u_matrix:S}),ss=(S,l,m,w)=>t.extend(Ar(S),$l(m,l,w)),qs=(S,l)=>({u_matrix:S,u_world:l}),Br=(S,l,m,w,C)=>t.extend(ss(S,l,m,w),{u_world:C}),vs=(S,l,m,w)=>{const C=S.transform;let D,U;if(w.paint.get("circle-pitch-alignment")==="map"){const q=mt(m,1,C.zoom);D=!0,U=[q,q]}else D=!1,U=C.pixelsToGLUnits;return{u_camera_to_center_distance:C.cameraToCenterDistance,u_scale_with_map:+(w.paint.get("circle-pitch-scale")==="map"),u_matrix:S.translatePosMatrix(l.posMatrix,m,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_pitch_with_map:+D,u_device_pixel_ratio:S.pixelRatio,u_extrude_scale:U}},na=(S,l,m)=>{const w=mt(m,1,l.zoom),C=Math.pow(2,l.zoom-m.tileID.overscaledZ),D=m.tileID.overscaleFactor();return{u_matrix:S,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:w,u_extrude_scale:[l.pixelsToGLUnits[0]/(w*C),l.pixelsToGLUnits[1]/(w*C)],u_overscale_factor:D}},oa=(S,l,m=1)=>({u_matrix:S,u_color:l,u_overlay:0,u_overlay_scale:m}),Po=S=>({u_matrix:S}),Sn=(S,l,m,w)=>({u_matrix:S,u_extrude_scale:mt(l,1,m),u_intensity:w});function tu(S,l){const m=Math.pow(2,l.canonical.z),w=l.canonical.y;return[new t.MercatorCoordinate(0,w/m).toLngLat().lat,new t.MercatorCoordinate(0,(w+1)/m).toLngLat().lat]}const bs=(S,l,m,w)=>{const C=S.transform;return{u_matrix:Na(S,l,m,w),u_ratio:1/mt(l,1,C.zoom),u_device_pixel_ratio:S.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},Zl=(S,l,m,w,C)=>t.extend(bs(S,l,m,C),{u_image:0,u_image_height:w}),cl=(S,l,m,w,C)=>{const D=S.transform,U=Bn(l,D);return{u_matrix:Na(S,l,m,C),u_texsize:l.imageAtlasTexture.size,u_ratio:1/mt(l,1,D.zoom),u_device_pixel_ratio:S.pixelRatio,u_image:0,u_scale:[U,w.fromScale,w.toScale],u_fade:w.t,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]]}},ql=(S,l,m,w,C,D)=>{const U=S.lineAtlas,q=Bn(l,S.transform),K=m.layout.get("line-cap")==="round",ee=U.getDash(w.from,K),le=U.getDash(w.to,K),me=ee.width*C.fromScale,be=le.width*C.toScale;return t.extend(bs(S,l,m,D),{u_patternscale_a:[q/me,-ee.height/2],u_patternscale_b:[q/be,-le.height/2],u_sdfgamma:U.width/(256*Math.min(me,be)*S.pixelRatio)/2,u_image:0,u_tex_y_a:ee.y,u_tex_y_b:le.y,u_mix:C.t})};function Bn(S,l){return 1/mt(S,1,l.tileZoom)}function Na(S,l,m,w){return S.translatePosMatrix(w?w.posMatrix:l.tileID.posMatrix,l,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}const Tc=(S,l,m,w,C)=>{return{u_matrix:S,u_tl_parent:l,u_scale_parent:m,u_buffer_scale:1,u_fade_t:w.mix,u_opacity:w.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(U=C.paint.get("raster-saturation"),U>0?1-1/(1.001-U):-U),u_contrast_factor:(D=C.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:iu(C.paint.get("raster-hue-rotate"))};var D,U};function iu(S){S*=Math.PI/180;const l=Math.sin(S),m=Math.cos(S);return[(2*m+1)/3,(-Math.sqrt(3)*l-m+1)/3,(Math.sqrt(3)*l-m+1)/3]}const ul=(S,l,m,w,C,D,U,q,K,ee)=>{const le=C.transform;return{u_is_size_zoom_constant:+(S==="constant"||S==="source"),u_is_size_feature_constant:+(S==="constant"||S==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:le.cameraToCenterDistance,u_pitch:le.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:le.width/le.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:U,u_coord_matrix:q,u_is_text:+K,u_pitch_with_map:+w,u_texsize:ee,u_texture:0}},ko=(S,l,m,w,C,D,U,q,K,ee,le)=>{const me=C.transform;return t.extend(ul(S,l,m,w,C,D,U,q,K,ee),{u_gamma_scale:w?Math.cos(me._pitch)*me.cameraToCenterDistance:1,u_device_pixel_ratio:C.pixelRatio,u_is_halo:+le})},Kn=(S,l,m,w,C,D,U,q,K,ee)=>t.extend(ko(S,l,m,w,C,D,U,q,!0,K,!0),{u_texsize_icon:ee,u_texture_icon:1}),Sh=(S,l,m)=>({u_matrix:S,u_opacity:l,u_color:m}),Mh=(S,l,m,w,C,D)=>t.extend(function(U,q,K,ee){const le=K.imageManager.getPattern(U.from.toString()),me=K.imageManager.getPattern(U.to.toString()),{width:be,height:qe}=K.imageManager.getPixelSize(),Oe=Math.pow(2,ee.tileID.overscaledZ),Fe=ee.tileSize*Math.pow(2,K.transform.tileZoom)/Oe,ht=Fe*(ee.tileID.canonical.x+ee.tileID.wrap*Oe),vt=Fe*ee.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:le.tl,u_pattern_br_a:le.br,u_pattern_tl_b:me.tl,u_pattern_br_b:me.br,u_texsize:[be,qe],u_mix:q.t,u_pattern_size_a:le.displaySize,u_pattern_size_b:me.displaySize,u_scale_a:q.fromScale,u_scale_b:q.toScale,u_tile_units_to_pixels:1/mt(ee,1,K.transform.tileZoom),u_pixel_coord_upper:[ht>>16,vt>>16],u_pixel_coord_lower:[65535&ht,65535&vt]}}(w,D,m,C),{u_matrix:S,u_opacity:l}),Ho={fillExtrusion:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_lightpos:new t.Uniform3f(S,l.u_lightpos),u_lightintensity:new t.Uniform1f(S,l.u_lightintensity),u_lightcolor:new t.Uniform3f(S,l.u_lightcolor),u_vertical_gradient:new t.Uniform1f(S,l.u_vertical_gradient),u_opacity:new t.Uniform1f(S,l.u_opacity)}),fillExtrusionPattern:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_lightpos:new t.Uniform3f(S,l.u_lightpos),u_lightintensity:new t.Uniform1f(S,l.u_lightintensity),u_lightcolor:new t.Uniform3f(S,l.u_lightcolor),u_vertical_gradient:new t.Uniform1f(S,l.u_vertical_gradient),u_height_factor:new t.Uniform1f(S,l.u_height_factor),u_image:new t.Uniform1i(S,l.u_image),u_texsize:new t.Uniform2f(S,l.u_texsize),u_pixel_coord_upper:new t.Uniform2f(S,l.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(S,l.u_pixel_coord_lower),u_scale:new t.Uniform3f(S,l.u_scale),u_fade:new t.Uniform1f(S,l.u_fade),u_opacity:new t.Uniform1f(S,l.u_opacity)}),fill:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix)}),fillPattern:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_image:new t.Uniform1i(S,l.u_image),u_texsize:new t.Uniform2f(S,l.u_texsize),u_pixel_coord_upper:new t.Uniform2f(S,l.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(S,l.u_pixel_coord_lower),u_scale:new t.Uniform3f(S,l.u_scale),u_fade:new t.Uniform1f(S,l.u_fade)}),fillOutline:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_world:new t.Uniform2f(S,l.u_world)}),fillOutlinePattern:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_world:new t.Uniform2f(S,l.u_world),u_image:new t.Uniform1i(S,l.u_image),u_texsize:new t.Uniform2f(S,l.u_texsize),u_pixel_coord_upper:new t.Uniform2f(S,l.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(S,l.u_pixel_coord_lower),u_scale:new t.Uniform3f(S,l.u_scale),u_fade:new t.Uniform1f(S,l.u_fade)}),circle:(S,l)=>({u_camera_to_center_distance:new t.Uniform1f(S,l.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(S,l.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(S,l.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(S,l.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(S,l.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(S,l.u_matrix)}),collisionBox:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_camera_to_center_distance:new t.Uniform1f(S,l.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(S,l.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(S,l.u_extrude_scale),u_overscale_factor:new t.Uniform1f(S,l.u_overscale_factor)}),collisionCircle:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_inv_matrix:new t.UniformMatrix4f(S,l.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(S,l.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(S,l.u_viewport_size)}),debug:(S,l)=>({u_color:new t.UniformColor(S,l.u_color),u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_overlay:new t.Uniform1i(S,l.u_overlay),u_overlay_scale:new t.Uniform1f(S,l.u_overlay_scale)}),clippingMask:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix)}),heatmap:(S,l)=>({u_extrude_scale:new t.Uniform1f(S,l.u_extrude_scale),u_intensity:new t.Uniform1f(S,l.u_intensity),u_matrix:new t.UniformMatrix4f(S,l.u_matrix)}),heatmapTexture:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_world:new t.Uniform2f(S,l.u_world),u_image:new t.Uniform1i(S,l.u_image),u_color_ramp:new t.Uniform1i(S,l.u_color_ramp),u_opacity:new t.Uniform1f(S,l.u_opacity)}),hillshade:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_image:new t.Uniform1i(S,l.u_image),u_latrange:new t.Uniform2f(S,l.u_latrange),u_light:new t.Uniform2f(S,l.u_light),u_shadow:new t.UniformColor(S,l.u_shadow),u_highlight:new t.UniformColor(S,l.u_highlight),u_accent:new t.UniformColor(S,l.u_accent)}),hillshadePrepare:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_image:new t.Uniform1i(S,l.u_image),u_dimension:new t.Uniform2f(S,l.u_dimension),u_zoom:new t.Uniform1f(S,l.u_zoom),u_unpack:new t.Uniform4f(S,l.u_unpack)}),line:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_ratio:new t.Uniform1f(S,l.u_ratio),u_device_pixel_ratio:new t.Uniform1f(S,l.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(S,l.u_units_to_pixels)}),lineGradient:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_ratio:new t.Uniform1f(S,l.u_ratio),u_device_pixel_ratio:new t.Uniform1f(S,l.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(S,l.u_units_to_pixels),u_image:new t.Uniform1i(S,l.u_image),u_image_height:new t.Uniform1f(S,l.u_image_height)}),linePattern:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_texsize:new t.Uniform2f(S,l.u_texsize),u_ratio:new t.Uniform1f(S,l.u_ratio),u_device_pixel_ratio:new t.Uniform1f(S,l.u_device_pixel_ratio),u_image:new t.Uniform1i(S,l.u_image),u_units_to_pixels:new t.Uniform2f(S,l.u_units_to_pixels),u_scale:new t.Uniform3f(S,l.u_scale),u_fade:new t.Uniform1f(S,l.u_fade)}),lineSDF:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_ratio:new t.Uniform1f(S,l.u_ratio),u_device_pixel_ratio:new t.Uniform1f(S,l.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(S,l.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(S,l.u_patternscale_a),u_patternscale_b:new t.Uniform2f(S,l.u_patternscale_b),u_sdfgamma:new t.Uniform1f(S,l.u_sdfgamma),u_image:new t.Uniform1i(S,l.u_image),u_tex_y_a:new t.Uniform1f(S,l.u_tex_y_a),u_tex_y_b:new t.Uniform1f(S,l.u_tex_y_b),u_mix:new t.Uniform1f(S,l.u_mix)}),raster:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_tl_parent:new t.Uniform2f(S,l.u_tl_parent),u_scale_parent:new t.Uniform1f(S,l.u_scale_parent),u_buffer_scale:new t.Uniform1f(S,l.u_buffer_scale),u_fade_t:new t.Uniform1f(S,l.u_fade_t),u_opacity:new t.Uniform1f(S,l.u_opacity),u_image0:new t.Uniform1i(S,l.u_image0),u_image1:new t.Uniform1i(S,l.u_image1),u_brightness_low:new t.Uniform1f(S,l.u_brightness_low),u_brightness_high:new t.Uniform1f(S,l.u_brightness_high),u_saturation_factor:new t.Uniform1f(S,l.u_saturation_factor),u_contrast_factor:new t.Uniform1f(S,l.u_contrast_factor),u_spin_weights:new t.Uniform3f(S,l.u_spin_weights)}),symbolIcon:(S,l)=>({u_is_size_zoom_constant:new t.Uniform1i(S,l.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(S,l.u_is_size_feature_constant),u_size_t:new t.Uniform1f(S,l.u_size_t),u_size:new t.Uniform1f(S,l.u_size),u_camera_to_center_distance:new t.Uniform1f(S,l.u_camera_to_center_distance),u_pitch:new t.Uniform1f(S,l.u_pitch),u_rotate_symbol:new t.Uniform1i(S,l.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(S,l.u_aspect_ratio),u_fade_change:new t.Uniform1f(S,l.u_fade_change),u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(S,l.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(S,l.u_coord_matrix),u_is_text:new t.Uniform1i(S,l.u_is_text),u_pitch_with_map:new t.Uniform1i(S,l.u_pitch_with_map),u_texsize:new t.Uniform2f(S,l.u_texsize),u_texture:new t.Uniform1i(S,l.u_texture)}),symbolSDF:(S,l)=>({u_is_size_zoom_constant:new t.Uniform1i(S,l.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(S,l.u_is_size_feature_constant),u_size_t:new t.Uniform1f(S,l.u_size_t),u_size:new t.Uniform1f(S,l.u_size),u_camera_to_center_distance:new t.Uniform1f(S,l.u_camera_to_center_distance),u_pitch:new t.Uniform1f(S,l.u_pitch),u_rotate_symbol:new t.Uniform1i(S,l.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(S,l.u_aspect_ratio),u_fade_change:new t.Uniform1f(S,l.u_fade_change),u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(S,l.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(S,l.u_coord_matrix),u_is_text:new t.Uniform1i(S,l.u_is_text),u_pitch_with_map:new t.Uniform1i(S,l.u_pitch_with_map),u_texsize:new t.Uniform2f(S,l.u_texsize),u_texture:new t.Uniform1i(S,l.u_texture),u_gamma_scale:new t.Uniform1f(S,l.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(S,l.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(S,l.u_is_halo)}),symbolTextAndIcon:(S,l)=>({u_is_size_zoom_constant:new t.Uniform1i(S,l.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(S,l.u_is_size_feature_constant),u_size_t:new t.Uniform1f(S,l.u_size_t),u_size:new t.Uniform1f(S,l.u_size),u_camera_to_center_distance:new t.Uniform1f(S,l.u_camera_to_center_distance),u_pitch:new t.Uniform1f(S,l.u_pitch),u_rotate_symbol:new t.Uniform1i(S,l.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(S,l.u_aspect_ratio),u_fade_change:new t.Uniform1f(S,l.u_fade_change),u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(S,l.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(S,l.u_coord_matrix),u_is_text:new t.Uniform1i(S,l.u_is_text),u_pitch_with_map:new t.Uniform1i(S,l.u_pitch_with_map),u_texsize:new t.Uniform2f(S,l.u_texsize),u_texsize_icon:new t.Uniform2f(S,l.u_texsize_icon),u_texture:new t.Uniform1i(S,l.u_texture),u_texture_icon:new t.Uniform1i(S,l.u_texture_icon),u_gamma_scale:new t.Uniform1f(S,l.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(S,l.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(S,l.u_is_halo)}),background:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_opacity:new t.Uniform1f(S,l.u_opacity),u_color:new t.UniformColor(S,l.u_color)}),backgroundPattern:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_opacity:new t.Uniform1f(S,l.u_opacity),u_image:new t.Uniform1i(S,l.u_image),u_pattern_tl_a:new t.Uniform2f(S,l.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(S,l.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(S,l.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(S,l.u_pattern_br_b),u_texsize:new t.Uniform2f(S,l.u_texsize),u_mix:new t.Uniform1f(S,l.u_mix),u_pattern_size_a:new t.Uniform2f(S,l.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(S,l.u_pattern_size_b),u_scale_a:new t.Uniform1f(S,l.u_scale_a),u_scale_b:new t.Uniform1f(S,l.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(S,l.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(S,l.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(S,l.u_tile_units_to_pixels)}),terrain:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_texture:new t.Uniform1i(S,l.u_texture)}),terrainDepth:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix)}),terrainCoords:(S,l)=>({u_matrix:new t.UniformMatrix4f(S,l.u_matrix),u_texture:new t.Uniform1i(S,l.u_texture),u_terrain_coords_id:new t.Uniform1f(S,l.u_terrain_coords_id)})};class ws{constructor(l,m,w){this.context=l;const C=l.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const m=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ou={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wl{constructor(l,m,w,C){this.length=m.length,this.attributes=w,this.itemSize=m.bytesPerElement,this.dynamicDraw=C,this.context=l;const D=l.gl;this.buffer=D.createBuffer(),l.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,m){for(let w=0;w<this.attributes.length;w++){const C=m.attributes[this.attributes[w].name];C!==void 0&&l.enableVertexAttribArray(C)}}setVertexAttribPointers(l,m,w){for(let C=0;C<this.attributes.length;C++){const D=this.attributes[C],U=m.attributes[D.name];U!==void 0&&l.vertexAttribPointer(U,D.components,l[Ou[D.type]],!1,this.itemSize,D.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _r{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ec extends _r{getDefault(){return t.Color.transparent}set(l){const m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Ch extends _r{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class sa extends _r{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class ao extends _r{getDefault(){return[!0,!0,!0,!0]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Uu extends _r{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class as extends _r{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class aa extends _r{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const m=this.current;(l.func!==m.func||l.ref!==m.ref||l.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class la extends _r{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Xl extends _r{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=l,this.dirty=!1}}class Ih extends _r{getDefault(){return[0,1]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class ru extends _r{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=l,this.dirty=!1}}class Va extends _r{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Ws extends _r{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.BLEND):m.disable(m.BLEND),this.current=l,this.dirty=!1}}class nu extends _r{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class ya extends _r{getDefault(){return t.Color.transparent}set(l){const m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class xa extends _r{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class Sc extends _r{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=l,this.dirty=!1}}class Ts extends _r{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Nu extends _r{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class Mc extends _r{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class ou extends _r{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class p1 extends _r{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Vu extends _r{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Ah extends _r{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class su extends _r{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class ja extends _r{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Qr extends _r{getDefault(){return null}set(l){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ph extends _r{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class hl extends _r{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class kh extends _r{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class ju extends _r{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class au extends _r{constructor(l,m){super(l),this.context=l,this.parent=m}getDefault(){return null}}class Ga extends au{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Hl extends au{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class $a{constructor(l,m,w,C){this.context=l,this.width=m,this.height=w;const D=l.gl,U=this.framebuffer=D.createFramebuffer();if(this.colorAttachment=new Ga(l,U),C&&(this.depthAttachment=new Hl(l,U)),D.checkFramebufferStatus(D.FRAMEBUFFER)!==D.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,m=this.colorAttachment.get();if(m&&l.deleteTexture(m),this.depthAttachment){const w=this.depthAttachment.get();w&&l.deleteRenderbuffer(w)}l.deleteFramebuffer(this.framebuffer)}}class _n{constructor(l,m,w){this.blendFunction=l,this.blendColor=m,this.mask=w}}_n.Replace=[1,0],_n.disabled=new _n(_n.Replace,t.Color.transparent,[!1,!1,!1,!1]),_n.unblended=new _n(_n.Replace,t.Color.transparent,[!0,!0,!0,!0]),_n.alphaBlended=new _n([1,771],t.Color.transparent,[!0,!0,!0,!0]);class va{constructor(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ec(this),this.clearDepth=new Ch(this),this.clearStencil=new sa(this),this.colorMask=new ao(this),this.depthMask=new Uu(this),this.stencilMask=new as(this),this.stencilFunc=new aa(this),this.stencilOp=new la(this),this.stencilTest=new Xl(this),this.depthRange=new Ih(this),this.depthTest=new ru(this),this.depthFunc=new Va(this),this.blend=new Ws(this),this.blendFunc=new nu(this),this.blendColor=new ya(this),this.blendEquation=new xa(this),this.cullFace=new Sc(this),this.cullFaceSide=new Ts(this),this.frontFace=new Nu(this),this.program=new Mc(this),this.activeTexture=new ou(this),this.viewport=new p1(this),this.bindFramebuffer=new Vu(this),this.bindRenderbuffer=new Ah(this),this.bindTexture=new su(this),this.bindVertexBuffer=new ja(this),this.bindElementBuffer=new Qr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ph(this),this.pixelStoreUnpack=new hl(this),this.pixelStoreUnpackPremultiplyAlpha=new kh(this),this.pixelStoreUnpackFlipY=new ju(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,m){return new ws(this,l,m)}createVertexBuffer(l,m,w){return new Wl(this,l,m,w)}createRenderbuffer(l,m,w){const C=this.gl,D=C.createRenderbuffer();return this.bindRenderbuffer.set(D),C.renderbufferStorage(C.RENDERBUFFER,l,m,w),this.bindRenderbuffer.set(null),D}createFramebuffer(l,m,w){return new $a(this,l,m,w)}clear({color:l,depth:m}){const w=this.gl;let C=0;l&&(C|=w.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(C|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),w.clear(C)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){he(l.blendFunction,_n.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class kr{constructor(l,m,w){this.func=l,this.mask=m,this.range=w}}kr.ReadOnly=!1,kr.ReadWrite=!0,kr.disabled=new kr(519,kr.ReadOnly,[0,1]);const en=7680;class Pn{constructor(l,m,w,C,D,U){this.test=l,this.ref=m,this.mask=w,this.fail=C,this.depthFail=D,this.pass=U}}Pn.disabled=new Pn({func:519,mask:0},0,0,en,en,en);class Mn{constructor(l,m,w){this.enable=l,this.mode=m,this.frontFace=w}}let Kl;function dl(S,l,m,w,C,D,U){const q=S.context,K=q.gl,ee=S.useProgram("collisionBox"),le=[];let me=0,be=0;for(let Ke=0;Ke<w.length;Ke++){const Rt=w[Ke],Bt=l.getTile(Rt),ii=Bt.getBucket(m);if(!ii)continue;let Yt=Rt.posMatrix;C[0]===0&&C[1]===0||(Yt=S.translatePosMatrix(Rt.posMatrix,Bt,C,D));const di=U?ii.textCollisionBox:ii.iconCollisionBox,Wt=ii.collisionCircleArray;if(Wt.length>0){const Ui=t.create(),Ft=Yt;t.mul(Ui,ii.placementInvProjMatrix,S.transform.glCoordMatrix),t.mul(Ui,Ui,ii.placementViewportMatrix),le.push({circleArray:Wt,circleOffset:be,transform:Ft,invTransform:Ui,coord:Rt}),me+=Wt.length/4,be=me}di&&ee.draw(q,K.LINES,kr.disabled,Pn.disabled,S.colorModeForRenderPass(),Mn.disabled,na(Yt,S.transform,Bt),S.style.terrain&&S.style.terrain.getTerrainData(Rt),m.id,di.layoutVertexBuffer,di.indexBuffer,di.segments,null,S.transform.zoom,null,null,di.collisionVertexBuffer)}if(!U||!le.length)return;const qe=S.useProgram("collisionCircle"),Oe=new t.CollisionCircleLayoutArray;Oe.resize(4*me),Oe._trim();let Fe=0;for(const Ke of le)for(let Rt=0;Rt<Ke.circleArray.length/4;Rt++){const Bt=4*Rt,ii=Ke.circleArray[Bt+0],Yt=Ke.circleArray[Bt+1],di=Ke.circleArray[Bt+2],Wt=Ke.circleArray[Bt+3];Oe.emplace(Fe++,ii,Yt,di,Wt,0),Oe.emplace(Fe++,ii,Yt,di,Wt,1),Oe.emplace(Fe++,ii,Yt,di,Wt,2),Oe.emplace(Fe++,ii,Yt,di,Wt,3)}(!Kl||Kl.length<2*me)&&(Kl=function(Ke){const Rt=2*Ke,Bt=new t.QuadTriangleArray;Bt.resize(Rt),Bt._trim();for(let ii=0;ii<Rt;ii++){const Yt=6*ii;Bt.uint16[Yt+0]=4*ii+0,Bt.uint16[Yt+1]=4*ii+1,Bt.uint16[Yt+2]=4*ii+2,Bt.uint16[Yt+3]=4*ii+2,Bt.uint16[Yt+4]=4*ii+3,Bt.uint16[Yt+5]=4*ii+0}return Bt}(me));const ht=q.createIndexBuffer(Kl,!0),vt=q.createVertexBuffer(Oe,t.collisionCircleLayout.members,!0);for(const Ke of le){const Rt={u_matrix:Ke.transform,u_inv_matrix:Ke.invTransform,u_camera_to_center_distance:(Pt=S.transform).cameraToCenterDistance,u_viewport_size:[Pt.width,Pt.height]};qe.draw(q,K.TRIANGLES,kr.disabled,Pn.disabled,S.colorModeForRenderPass(),Mn.disabled,Rt,S.style.terrain&&S.style.terrain.getTerrainData(Ke.coord),m.id,vt,ht,t.SegmentVector.simpleSegment(0,2*Ke.circleOffset,Ke.circleArray.length,Ke.circleArray.length/2),null,S.transform.zoom,null,null,null)}var Pt;vt.destroy(),ht.destroy()}Mn.disabled=new Mn(!1,1029,2305),Mn.backCCW=new Mn(!0,1029,2305);const Gu=t.identity(new Float32Array(16));function $u(S,l,m,w,C,D){const{horizontalAlign:U,verticalAlign:q}=t.getAnchorAlignment(S),K=-(U-.5)*l,ee=-(q-.5)*m,le=t.evaluateVariableOffset(S,w);return new t.pointGeometry((K/C+le[0])*D,(ee/C+le[1])*D)}function Zu(S,l,m,w,C,D,U,q,K,ee,le){const me=S.text.placedSymbolArray,be=S.text.dynamicLayoutVertexArray,qe=S.icon.dynamicLayoutVertexArray,Oe={};be.clear();for(let Fe=0;Fe<me.length;Fe++){const ht=me.get(Fe),vt=S.allowVerticalPlacement&&!ht.placedOrientation,Pt=ht.hidden||!ht.crossTileID||vt?null:w[ht.crossTileID];if(Pt){const Ke=new t.pointGeometry(ht.anchorX,ht.anchorY),Rt=Gr(Ke,m?U:D,le),Bt=zn(C.cameraToCenterDistance,Rt.signedDistanceFromCamera);let ii=t.evaluateSizeForFeature(S.textSizeData,K,ht)*Bt/t.ONE_EM;m&&(ii*=S.tilePixelRatio/q);const{width:Yt,height:di,anchor:Wt,textOffset:Ui,textBoxScale:Ft}=Pt,qi=$u(Wt,Yt,di,Ui,Ft,ii),Er=m?Gr(Ke.add(qi),D,le).point:Rt.point.add(l?qi.rotate(-C.angle):qi),Sr=S.allowVerticalPlacement&&ht.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let ir=0;ir<ht.numGlyphs;ir++)t.addDynamicAttributes(be,Er,Sr);ee&&ht.associatedIconIndex>=0&&(Oe[ht.associatedIconIndex]={shiftedAnchor:Er,angle:Sr})}else Ae(ht.numGlyphs,be)}if(ee){qe.clear();const Fe=S.icon.placedSymbolArray;for(let ht=0;ht<Fe.length;ht++){const vt=Fe.get(ht);if(vt.hidden)Ae(vt.numGlyphs,qe);else{const Pt=Oe[ht];if(Pt)for(let Ke=0;Ke<vt.numGlyphs;Ke++)t.addDynamicAttributes(qe,Pt.shiftedAnchor,Pt.angle);else Ae(vt.numGlyphs,qe)}}S.icon.dynamicLayoutVertexBuffer.updateData(qe)}S.text.dynamicLayoutVertexBuffer.updateData(be)}function Kr(S,l,m){return m.iconsInText&&l?"symbolTextAndIcon":S?"symbolSDF":"symbolIcon"}function pl(S,l,m,w,C,D,U,q,K,ee,le,me){const be=S.context,qe=be.gl,Oe=S.transform,Fe=q==="map",ht=K==="map",vt=q!=="viewport"&&m.layout.get("symbol-placement")!=="point",Pt=Fe&&!ht&&!vt,Ke=!m.layout.get("symbol-sort-key").isConstant();let Rt=!1;const Bt=S.depthModeForSublayer(0,kr.ReadOnly),ii=m.layout.get("text-variable-anchor"),Yt=[];for(const di of w){const Wt=l.getTile(di),Ui=Wt.getBucket(m);if(!Ui)continue;const Ft=C?Ui.text:Ui.icon;if(!Ft||!Ft.segments.get().length)continue;const qi=Ft.programConfigurations.get(m.id),Er=C||Ui.sdfIcons,Sr=C?Ui.textSizeData:Ui.iconSizeData,ir=ht||Oe.pitch!==0,pi=S.useProgram(Kr(Er,C,Ui),qi),cn=t.evaluateSizeForZoom(Sr,Oe.zoom),Yr=S.style.terrain&&S.style.terrain.getTerrainData(di);let Jr,dn,_o,ha,da=[0,0],Ea=null;if(C){if(dn=Wt.glyphAtlasTexture,_o=qe.LINEAR,Jr=Wt.glyphAtlasTexture.size,Ui.iconsInText){da=Wt.imageAtlasTexture.size,Ea=Wt.imageAtlasTexture;const O=Sr.kind==="composite"||Sr.kind==="camera";ha=ir||S.options.rotating||S.options.zooming||O?qe.LINEAR:qe.NEAREST}}else{const O=m.layout.get("icon-size").constantOr(0)!==1||Ui.iconsNeedLinear;dn=Wt.imageAtlasTexture,_o=Er||S.options.rotating||S.options.zooming||O||ir?qe.LINEAR:qe.NEAREST,Jr=Wt.imageAtlasTexture.size}const Sa=mt(Wt,1,S.transform.zoom),Ms=Xo(di.posMatrix,ht,Fe,S.transform,Sa),Qo=so(di.posMatrix,ht,Fe,S.transform,Sa),Cs=ii&&Ui.hasTextData(),_=m.layout.get("icon-text-fit")!=="none"&&Cs&&Ui.hasIconData();if(vt){const O=S.style.terrain?(H,X)=>S.style.terrain.getElevation(di,H,X):null,G=m.layout.get("text-rotation-alignment")==="map";io(Ui,di.posMatrix,S,C,Ms,Qo,ht,ee,G,O)}const o=S.translatePosMatrix(di.posMatrix,Wt,D,U),d=vt||C&&ii||_?Gu:Ms,x=S.translatePosMatrix(Qo,Wt,D,U,!0),E=Er&&m.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let A;A=Er?Ui.iconsInText?Kn(Sr.kind,cn,Pt,ht,S,o,d,x,Jr,da):ko(Sr.kind,cn,Pt,ht,S,o,d,x,C,Jr,!0):ul(Sr.kind,cn,Pt,ht,S,o,d,x,C,Jr);const B={program:pi,buffers:Ft,uniformValues:A,atlasTexture:dn,atlasTextureIcon:Ea,atlasInterpolation:_o,atlasInterpolationIcon:ha,isSDF:Er,hasHalo:E};if(Ke&&Ui.canOverlap){Rt=!0;const O=Ft.segments.get();for(const G of O)Yt.push({segments:new t.SegmentVector([G]),sortKey:G.sortKey,state:B,terrainData:Yr})}else Yt.push({segments:Ft.segments,sortKey:0,state:B,terrainData:Yr})}Rt&&Yt.sort((di,Wt)=>di.sortKey-Wt.sortKey);for(const di of Yt){const Wt=di.state;if(be.activeTexture.set(qe.TEXTURE0),Wt.atlasTexture.bind(Wt.atlasInterpolation,qe.CLAMP_TO_EDGE),Wt.atlasTextureIcon&&(be.activeTexture.set(qe.TEXTURE1),Wt.atlasTextureIcon&&Wt.atlasTextureIcon.bind(Wt.atlasInterpolationIcon,qe.CLAMP_TO_EDGE)),Wt.isSDF){const Ui=Wt.uniformValues;Wt.hasHalo&&(Ui.u_is_halo=1,Cc(Wt.buffers,di.segments,m,S,Wt.program,Bt,le,me,Ui,di.terrainData)),Ui.u_is_halo=0}Cc(Wt.buffers,di.segments,m,S,Wt.program,Bt,le,me,Wt.uniformValues,di.terrainData)}}function Cc(S,l,m,w,C,D,U,q,K,ee){const le=w.context;C.draw(le,le.gl.TRIANGLES,D,U,q,Mn.disabled,K,ee,m.id,S.layoutVertexBuffer,S.indexBuffer,l,m.paint,w.transform.zoom,S.programConfigurations.get(m.id),S.dynamicLayoutVertexBuffer,S.opacityVertexBuffer)}function Yl(S,l,m,w,C,D,U){const q=S.context.gl,K=m.paint.get("fill-pattern"),ee=K&&K.constantOr(1),le=m.getCrossfadeParameters();let me,be,qe,Oe,Fe;U?(be=ee&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",me=q.LINES):(be=ee?"fillPattern":"fill",me=q.TRIANGLES);for(const ht of w){const vt=l.getTile(ht);if(ee&&!vt.patternsLoaded())continue;const Pt=vt.getBucket(m);if(!Pt)continue;const Ke=Pt.programConfigurations.get(m.id),Rt=S.useProgram(be,Ke),Bt=S.style.terrain&&S.style.terrain.getTerrainData(ht);ee&&(S.context.activeTexture.set(q.TEXTURE0),vt.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),Ke.updatePaintBuffers(le));const ii=K.constantOr(null);if(ii&&vt.imageAtlas){const Wt=vt.imageAtlas,Ui=Wt.patternPositions[ii.to.toString()],Ft=Wt.patternPositions[ii.from.toString()];Ui&&Ft&&Ke.setConstantPatternPositions(Ui,Ft)}const Yt=Bt?ht:null,di=S.translatePosMatrix(Yt?Yt.posMatrix:ht.posMatrix,vt,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(U){Oe=Pt.indexBuffer2,Fe=Pt.segments2;const Wt=[q.drawingBufferWidth,q.drawingBufferHeight];qe=be==="fillOutlinePattern"&&ee?Br(di,S,le,vt,Wt):qs(di,Wt)}else Oe=Pt.indexBuffer,Fe=Pt.segments,qe=ee?ss(di,S,le,vt):Ar(di);Rt.draw(S.context,me,C,S.stencilModeForClipping(ht),D,Mn.disabled,qe,Bt,m.id,Pt.layoutVertexBuffer,Oe,Fe,m.paint,S.transform.zoom,Ke)}}function Ic(S,l,m,w,C,D,U){const q=S.context,K=q.gl,ee=m.paint.get("fill-extrusion-pattern"),le=ee.constantOr(1),me=m.getCrossfadeParameters(),be=m.paint.get("fill-extrusion-opacity");for(const qe of w){const Oe=l.getTile(qe),Fe=Oe.getBucket(m);if(!Fe)continue;const ht=S.style.terrain&&S.style.terrain.getTerrainData(qe),vt=Fe.programConfigurations.get(m.id),Pt=S.useProgram(le?"fillExtrusionPattern":"fillExtrusion",vt);le&&(S.context.activeTexture.set(K.TEXTURE0),Oe.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),vt.updatePaintBuffers(me));const Ke=ee.constantOr(null);if(Ke&&Oe.imageAtlas){const Yt=Oe.imageAtlas,di=Yt.patternPositions[Ke.to.toString()],Wt=Yt.patternPositions[Ke.from.toString()];di&&Wt&&vt.setConstantPatternPositions(di,Wt)}const Rt=S.translatePosMatrix(qe.posMatrix,Oe,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Bt=m.paint.get("fill-extrusion-vertical-gradient"),ii=le?$r(Rt,S,Bt,be,qe,me,Oe):Di(Rt,S,Bt,be);Pt.draw(q,q.gl.TRIANGLES,C,D,U,Mn.backCCW,ii,ht,m.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,m.paint,S.transform.zoom,vt,S.style.terrain&&Fe.centroidVertexBuffer)}}function Za(S,l,m,w,C,D,U){const q=S.context,K=q.gl,ee=m.fbo;if(!ee)return;const le=S.useProgram("hillshade"),me=S.style.terrain&&S.style.terrain.getTerrainData(l);q.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,ee.colorAttachment.get()),le.draw(q,K.TRIANGLES,C,D,U,Mn.disabled,((be,qe,Oe,Fe)=>{const ht=Oe.paint.get("hillshade-shadow-color"),vt=Oe.paint.get("hillshade-highlight-color"),Pt=Oe.paint.get("hillshade-accent-color");let Ke=Oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);Oe.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ke-=be.transform.angle);const Rt=!be.options.moving;return{u_matrix:Fe?Fe.posMatrix:be.transform.calculatePosMatrix(qe.tileID.toUnwrapped(),Rt),u_image:0,u_latrange:tu(0,qe.tileID),u_light:[Oe.paint.get("hillshade-exaggeration"),Ke],u_shadow:ht,u_highlight:vt,u_accent:Pt}})(S,m,w,me?l:null),me,w.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments)}function qu(S,l,m,w,C,D){const U=S.context,q=U.gl,K=l.dem;if(K&&K.data){const ee=K.dim,le=K.stride,me=K.getPixels();if(U.activeTexture.set(q.TEXTURE1),U.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||S.getTileTexture(le),l.demTexture){const qe=l.demTexture;qe.update(me,{premultiply:!1}),qe.bind(q.NEAREST,q.CLAMP_TO_EDGE)}else l.demTexture=new at(U,me,q.RGBA,{premultiply:!1}),l.demTexture.bind(q.NEAREST,q.CLAMP_TO_EDGE);U.activeTexture.set(q.TEXTURE0);let be=l.fbo;if(!be){const qe=new at(U,{width:ee,height:ee,data:null},q.RGBA);qe.bind(q.LINEAR,q.CLAMP_TO_EDGE),be=l.fbo=U.createFramebuffer(ee,ee,!0),be.colorAttachment.set(qe.texture)}U.bindFramebuffer.set(be.framebuffer),U.viewport.set([0,0,ee,ee]),S.useProgram("hillshadePrepare").draw(U,q.TRIANGLES,w,C,D,Mn.disabled,((qe,Oe)=>{const Fe=Oe.stride,ht=t.create();return t.ortho(ht,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(ht,ht,[0,-t.EXTENT,0]),{u_matrix:ht,u_image:1,u_dimension:[Fe,Fe],u_zoom:qe.overscaledZ,u_unpack:Oe.getUnpackVector()}})(l.tileID,K),null,m.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function Wu(S,l,m,w,C,D){const U=w.paint.get("raster-fade-duration");if(!D&&U>0){const q=t.exported.now(),K=(q-S.timeAdded)/U,ee=l?(q-l.timeAdded)/U:-1,le=m.getSource(),me=C.coveringZoomLevel({tileSize:le.tileSize,roundZoom:le.roundZoom}),be=!l||Math.abs(l.tileID.overscaledZ-me)>Math.abs(S.tileID.overscaledZ-me),qe=be&&S.refreshedUponExpiration?1:t.clamp(be?K:1-ee,0,1);return S.refreshedUponExpiration&&K>=1&&(S.refreshedUponExpiration=!1),l?{opacity:1,mix:1-qe}:{opacity:qe,mix:0}}return{opacity:1,mix:0}}const Xu=new t.Color(1,0,0,1),ca=new t.Color(0,1,0,1),Hu=new t.Color(0,0,1,1),lu=new t.Color(1,0,1,1),Ku=new t.Color(0,1,1,1);function ba(S,l,m,w){Jl(S,0,l+m/2,S.transform.width,m,w)}function Ac(S,l,m,w){Jl(S,l-m/2,0,m,S.transform.height,w)}function Jl(S,l,m,w,C,D){const U=S.context,q=U.gl;q.enable(q.SCISSOR_TEST),q.scissor(l*S.pixelRatio,m*S.pixelRatio,w*S.pixelRatio,C*S.pixelRatio),U.clear({color:D}),q.disable(q.SCISSOR_TEST)}function wd(S,l,m){const w=S.context,C=w.gl,D=m.posMatrix,U=S.useProgram("debug"),q=kr.disabled,K=Pn.disabled,ee=S.colorModeForRenderPass(),le="$debug",me=S.style.terrain&&S.style.terrain.getTerrainData(m);w.activeTexture.set(C.TEXTURE0),S.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE);const be=l.getTileByID(m.key).latestRawTileData,qe=Math.floor((be&&be.byteLength||0)/1024),Oe=l.getTile(m).tileSize,Fe=512/Math.min(Oe,512)*(m.overscaledZ/S.transform.zoom)*.5;let ht=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(ht+=` => ${m.overscaledZ}`),function(vt,Pt){vt.initDebugOverlayCanvas();const Ke=vt.debugOverlayCanvas,Rt=vt.context.gl,Bt=vt.debugOverlayCanvas.getContext("2d");Bt.clearRect(0,0,Ke.width,Ke.height),Bt.shadowColor="white",Bt.shadowBlur=2,Bt.lineWidth=1.5,Bt.strokeStyle="white",Bt.textBaseline="top",Bt.font="bold 36px Open Sans, sans-serif",Bt.fillText(Pt,5,5),Bt.strokeText(Pt,5,5),vt.debugOverlayTexture.update(Ke),vt.debugOverlayTexture.bind(Rt.LINEAR,Rt.CLAMP_TO_EDGE)}(S,`${ht} ${qe}kB`),U.draw(w,C.TRIANGLES,q,K,_n.alphaBlended,Mn.disabled,oa(D,t.Color.transparent,Fe),null,le,S.debugBuffer,S.quadTriangleIndexBuffer,S.debugSegments),U.draw(w,C.LINE_STRIP,q,K,ee,Mn.disabled,oa(D,t.Color.red),me,le,S.debugBuffer,S.tileBorderIndexBuffer,S.debugSegments)}function fl(S,l,m){const w=S.context,C=w.gl,D=S.colorModeForRenderPass(),U=new kr(C.LEQUAL,kr.ReadWrite,S.depthRangeFor3D),q=S.useProgram("terrain"),K=l.getTerrainMesh(),ee=l.getTerrainData(m.tileID);w.bindFramebuffer.set(null),w.viewport.set([0,0,S.width,S.height]),w.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,l.getRTTFramebuffer().colorAttachment.get());const le=S.transform.calculatePosMatrix(m.tileID.toUnwrapped());q.draw(w,C.TRIANGLES,U,Pn.disabled,D,Mn.backCCW,{u_matrix:le,u_texture:0},ee,"terrain",K.vertexBuffer,K.indexBuffer,K.segments)}function Ql(S,l,m,w){const C=S.context,D=m.tileSize*l.qualityFactor;m.textures[w]||(m.textures[w]=S.getTileTexture(D)||new at(C,{width:D,height:D,data:null},C.gl.RGBA),m.textures[w].bind(C.gl.LINEAR,C.gl.CLAMP_TO_EDGE),w===0&&l.sourceCache.renderHistory.unshift(m.tileID.key));const U=l.getRTTFramebuffer();U.colorAttachment.set(m.textures[w].texture),C.bindFramebuffer.set(U.framebuffer),C.viewport.set([0,0,D,D])}class Yu{constructor(l){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=l,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=l.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const l=this.painter.style,m=l.terrain;for(const w in l.sourceCaches){this._coordsDescendingInv[w]={};const C=l.sourceCaches[w].getVisibleCoordinates();for(const D of C){const U=m.sourceCache.getTerrainCoords(D);for(const q in U)this._coordsDescendingInv[w][q]||(this._coordsDescendingInv[w][q]=[]),this._coordsDescendingInv[w][q].push(U[q])}}for(const w of l._order){const C=l._layers[w],D=C.source;if(this._renderToTexture[C.type]&&!this._coordsDescendingInvStr[D]){this._coordsDescendingInvStr[D]={};for(const U in this._coordsDescendingInv[D])this._coordsDescendingInvStr[D][U]=this._coordsDescendingInv[D][U].map(q=>q.key).sort().join()}}return this._renderableTiles.forEach(w=>{for(const C in this._coordsDescendingInvStr){const D=this._coordsDescendingInvStr[C][w.tileID.key];D&&D!==w.textureCoords[C]&&w.clearTextures(this.painter),m.needsRerender(C,w.tileID)&&w.clearTextures(this.painter)}this._rerender[w.tileID.key]=!w.textures.length}),m.clearRerenderCache(),m.sourceCache.removeOutdated(this.painter),this}renderLayer(l){const m=l.type,w=this.painter,C=w.style._order,D=w.currentLayer,U=D+1===C.length;if(this._renderToTexture[m]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=m,this._stacks[this._stacks.length-1].push(C[D]),!U))return!0;if(this._renderToTexture[this._prevType]||m==="hillshade"||this._renderToTexture[m]&&U){this._prevType=m;const q=this._stacks.length-1,K=this._stacks[q]||[];for(const ee of this._renderableTiles){if(Ql(w,w.style.terrain,ee,q),this._rerender[ee.tileID.key]){w.context.clear({color:t.Color.transparent});for(let le=0;le<K.length;le++){const me=w.style._layers[K[le]],be=me.source?this._coordsDescendingInv[me.source][ee.tileID.key]:[ee.tileID];w._renderTileClippingMasks(me,be),w.renderLayer(w,w.style.sourceCaches[me.source],me,be),me.source&&(ee.textureCoords[me.source]=this._coordsDescendingInvStr[me.source][ee.tileID.key])}}fl(w,w.style.terrain,ee)}if(m==="hillshade"){this._stacks.push([C[D]]);for(const ee of this._renderableTiles){const le=this._coordsDescendingInv[l.source][ee.tileID.key];Ql(w,w.style.terrain,ee,this._stacks.length-1),w.context.clear({color:t.Color.transparent}),w._renderTileClippingMasks(l,le),w.renderLayer(w,w.style.sourceCaches[l.source],l,le),fl(w,w.style.terrain,ee)}return!0}return this._renderToTexture[m]}return!1}}const qa={symbol:function(S,l,m,w,C){if(S.renderPass!=="translucent")return;const D=Pn.disabled,U=S.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(q,K,ee,le,me,be,qe){const Oe=K.transform,Fe=me==="map",ht=be==="map";for(const vt of q){const Pt=le.getTile(vt),Ke=Pt.getBucket(ee);if(!Ke||!Ke.text||!Ke.text.segments.get().length)continue;const Rt=t.evaluateSizeForZoom(Ke.textSizeData,Oe.zoom),Bt=mt(Pt,1,K.transform.zoom),ii=Xo(vt.posMatrix,ht,Fe,K.transform,Bt),Yt=ee.layout.get("icon-text-fit")!=="none"&&Ke.hasIconData();if(Rt){const di=Math.pow(2,Oe.zoom-Pt.tileID.overscaledZ);Zu(Ke,Fe,ht,qe,Oe,ii,vt.posMatrix,di,Rt,Yt,K.style.terrain?(Wt,Ui)=>K.style.terrain.getElevation(vt,Wt,Ui):null)}}}(w,S,m,l,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),C),m.paint.get("icon-opacity").constantOr(1)!==0&&pl(S,l,m,w,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),D,U),m.paint.get("text-opacity").constantOr(1)!==0&&pl(S,l,m,w,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),D,U),l.map.showCollisionBoxes&&(dl(S,l,m,w,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),dl(S,l,m,w,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(S,l,m,w){if(S.renderPass!=="translucent")return;const C=m.paint.get("circle-opacity"),D=m.paint.get("circle-stroke-width"),U=m.paint.get("circle-stroke-opacity"),q=!m.layout.get("circle-sort-key").isConstant();if(C.constantOr(1)===0&&(D.constantOr(1)===0||U.constantOr(1)===0))return;const K=S.context,ee=K.gl,le=S.depthModeForSublayer(0,kr.ReadOnly),me=Pn.disabled,be=S.colorModeForRenderPass(),qe=[];for(let Oe=0;Oe<w.length;Oe++){const Fe=w[Oe],ht=l.getTile(Fe),vt=ht.getBucket(m);if(!vt)continue;const Pt=vt.programConfigurations.get(m.id),Ke=S.useProgram("circle",Pt),Rt=vt.layoutVertexBuffer,Bt=vt.indexBuffer,ii=S.style.terrain&&S.style.terrain.getTerrainData(Fe),Yt={programConfiguration:Pt,program:Ke,layoutVertexBuffer:Rt,indexBuffer:Bt,uniformValues:vs(S,Fe,ht,m),terrainData:ii};if(q){const di=vt.segments.get();for(const Wt of di)qe.push({segments:new t.SegmentVector([Wt]),sortKey:Wt.sortKey,state:Yt})}else qe.push({segments:vt.segments,sortKey:0,state:Yt})}q&&qe.sort((Oe,Fe)=>Oe.sortKey-Fe.sortKey);for(const Oe of qe){const{programConfiguration:Fe,program:ht,layoutVertexBuffer:vt,indexBuffer:Pt,uniformValues:Ke,terrainData:Rt}=Oe.state;ht.draw(K,ee.TRIANGLES,le,me,be,Mn.disabled,Ke,Rt,m.id,vt,Pt,Oe.segments,m.paint,S.transform.zoom,Fe)}},heatmap:function(S,l,m,w){if(m.paint.get("heatmap-opacity")!==0)if(S.renderPass==="offscreen"){const C=S.context,D=C.gl,U=Pn.disabled,q=new _n([D.ONE,D.ONE],t.Color.transparent,[!0,!0,!0,!0]);(function(K,ee,le){const me=K.gl;K.activeTexture.set(me.TEXTURE1),K.viewport.set([0,0,ee.width/4,ee.height/4]);let be=le.heatmapFbo;if(be)me.bindTexture(me.TEXTURE_2D,be.colorAttachment.get()),K.bindFramebuffer.set(be.framebuffer);else{const qe=me.createTexture();me.bindTexture(me.TEXTURE_2D,qe),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),be=le.heatmapFbo=K.createFramebuffer(ee.width/4,ee.height/4,!1),function(Oe,Fe,ht,vt){const Pt=Oe.gl;Pt.texImage2D(Pt.TEXTURE_2D,0,Pt.RGBA,Fe.width/4,Fe.height/4,0,Pt.RGBA,Oe.extRenderToTextureHalfFloat?Oe.extTextureHalfFloat.HALF_FLOAT_OES:Pt.UNSIGNED_BYTE,null),vt.colorAttachment.set(ht)}(K,ee,qe,be)}})(C,S,m),C.clear({color:t.Color.transparent});for(let K=0;K<w.length;K++){const ee=w[K];if(l.hasRenderableParent(ee))continue;const le=l.getTile(ee),me=le.getBucket(m);if(!me)continue;const be=me.programConfigurations.get(m.id),qe=S.useProgram("heatmap",be),{zoom:Oe}=S.transform;qe.draw(C,D.TRIANGLES,kr.disabled,U,q,Mn.disabled,Sn(ee.posMatrix,le,Oe,m.paint.get("heatmap-intensity")),null,m.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,m.paint,S.transform.zoom,be)}C.viewport.set([0,0,S.width,S.height])}else S.renderPass==="translucent"&&(S.context.setColorMode(S.colorModeForRenderPass()),function(C,D){const U=C.context,q=U.gl,K=D.heatmapFbo;if(!K)return;U.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,K.colorAttachment.get()),U.activeTexture.set(q.TEXTURE1);let ee=D.colorRampTexture;ee||(ee=D.colorRampTexture=new at(U,D.colorRamp,q.RGBA)),ee.bind(q.LINEAR,q.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(U,q.TRIANGLES,kr.disabled,Pn.disabled,C.colorModeForRenderPass(),Mn.disabled,((le,me,be,qe)=>{const Oe=t.create();t.ortho(Oe,0,le.width,le.height,0,0,1);const Fe=le.context.gl;return{u_matrix:Oe,u_world:[Fe.drawingBufferWidth,Fe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:me.paint.get("heatmap-opacity")}})(C,D),null,D.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,D.paint,C.transform.zoom)}(S,m))},line:function(S,l,m,w){if(S.renderPass!=="translucent")return;const C=m.paint.get("line-opacity"),D=m.paint.get("line-width");if(C.constantOr(1)===0||D.constantOr(1)===0)return;const U=S.depthModeForSublayer(0,kr.ReadOnly),q=S.colorModeForRenderPass(),K=m.paint.get("line-dasharray"),ee=m.paint.get("line-pattern"),le=ee.constantOr(1),me=m.paint.get("line-gradient"),be=m.getCrossfadeParameters(),qe=le?"linePattern":K?"lineSDF":me?"lineGradient":"line",Oe=S.context,Fe=Oe.gl;let ht=!0;for(const vt of w){const Pt=l.getTile(vt);if(le&&!Pt.patternsLoaded())continue;const Ke=Pt.getBucket(m);if(!Ke)continue;const Rt=Ke.programConfigurations.get(m.id),Bt=S.context.program.get(),ii=S.useProgram(qe,Rt),Yt=ht||ii.program!==Bt,di=S.style.terrain&&S.style.terrain.getTerrainData(vt),Wt=ee.constantOr(null);if(Wt&&Pt.imageAtlas){const qi=Pt.imageAtlas,Er=qi.patternPositions[Wt.to.toString()],Sr=qi.patternPositions[Wt.from.toString()];Er&&Sr&&Rt.setConstantPatternPositions(Er,Sr)}const Ui=di?vt:null,Ft=le?cl(S,Pt,m,be,Ui):K?ql(S,Pt,m,K,be,Ui):me?Zl(S,Pt,m,Ke.lineClipsArray.length,Ui):bs(S,Pt,m,Ui);if(le)Oe.activeTexture.set(Fe.TEXTURE0),Pt.imageAtlasTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE),Rt.updatePaintBuffers(be);else if(K&&(Yt||S.lineAtlas.dirty))Oe.activeTexture.set(Fe.TEXTURE0),S.lineAtlas.bind(Oe);else if(me){const qi=Ke.gradients[m.id];let Er=qi.texture;if(m.gradientVersion!==qi.version){let Sr=256;if(m.stepInterpolant){const ir=l.getSource().maxzoom,pi=vt.canonical.z===ir?Math.ceil(1<<S.transform.maxZoom-vt.canonical.z):1;Sr=t.clamp(t.nextPowerOfTwo(Ke.maxLineLength/t.EXTENT*1024*pi),256,Oe.maxTextureSize)}qi.gradient=t.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:Sr,image:qi.gradient||void 0,clips:Ke.lineClipsArray}),qi.texture?qi.texture.update(qi.gradient):qi.texture=new at(Oe,qi.gradient,Fe.RGBA),qi.version=m.gradientVersion,Er=qi.texture}Oe.activeTexture.set(Fe.TEXTURE0),Er.bind(m.stepInterpolant?Fe.NEAREST:Fe.LINEAR,Fe.CLAMP_TO_EDGE)}ii.draw(Oe,Fe.TRIANGLES,U,S.stencilModeForClipping(vt),q,Mn.disabled,Ft,di,m.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,m.paint,S.transform.zoom,Rt,Ke.layoutVertexBuffer2),ht=!1}},fill:function(S,l,m,w){const C=m.paint.get("fill-color"),D=m.paint.get("fill-opacity");if(D.constantOr(1)===0)return;const U=S.colorModeForRenderPass(),q=m.paint.get("fill-pattern"),K=S.opaquePassEnabledForLayer()&&!q.constantOr(1)&&C.constantOr(t.Color.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===K){const ee=S.depthModeForSublayer(1,S.renderPass==="opaque"?kr.ReadWrite:kr.ReadOnly);Yl(S,l,m,w,ee,U,!1)}if(S.renderPass==="translucent"&&m.paint.get("fill-antialias")){const ee=S.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,kr.ReadOnly);Yl(S,l,m,w,ee,U,!0)}},"fill-extrusion":function(S,l,m,w){const C=m.paint.get("fill-extrusion-opacity");if(C!==0&&S.renderPass==="translucent"){const D=new kr(S.context.gl.LEQUAL,kr.ReadWrite,S.depthRangeFor3D);if(C!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))Ic(S,l,m,w,D,Pn.disabled,_n.disabled),Ic(S,l,m,w,D,S.stencilModeFor3D(),S.colorModeForRenderPass());else{const U=S.colorModeForRenderPass();Ic(S,l,m,w,D,Pn.disabled,U)}}},hillshade:function(S,l,m,w){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const C=S.context,D=S.depthModeForSublayer(0,kr.ReadOnly),U=S.colorModeForRenderPass(),[q,K]=S.renderPass==="translucent"?S.stencilConfigForOverlap(w):[{},w];for(const ee of K){const le=l.getTile(ee);le.needsHillshadePrepare!==void 0&&le.needsHillshadePrepare&&S.renderPass==="offscreen"?qu(S,le,m,D,Pn.disabled,U):S.renderPass==="translucent"&&Za(S,ee,le,m,D,q[ee.overscaledZ],U)}C.viewport.set([0,0,S.width,S.height])},raster:function(S,l,m,w){if(S.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!w.length)return;const C=S.context,D=C.gl,U=l.getSource(),q=S.useProgram("raster"),K=S.colorModeForRenderPass(),[ee,le]=U instanceof hi?[{},w]:S.stencilConfigForOverlap(w),me=le[le.length-1].overscaledZ,be=!S.options.moving;for(const qe of le){const Oe=S.depthModeForSublayer(qe.overscaledZ-me,m.paint.get("raster-opacity")===1?kr.ReadWrite:kr.ReadOnly,D.LESS),Fe=l.getTile(qe);Fe.registerFadeDuration(m.paint.get("raster-fade-duration"));const ht=l.findLoadedParent(qe,0),vt=Wu(Fe,ht,l,m,S.transform,S.style.terrain);let Pt,Ke;const Rt=m.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;C.activeTexture.set(D.TEXTURE0),Fe.texture.bind(Rt,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(D.TEXTURE1),ht?(ht.texture.bind(Rt,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),Pt=Math.pow(2,ht.tileID.overscaledZ-Fe.tileID.overscaledZ),Ke=[Fe.tileID.canonical.x*Pt%1,Fe.tileID.canonical.y*Pt%1]):Fe.texture.bind(Rt,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);const Bt=S.style.terrain&&S.style.terrain.getTerrainData(qe),ii=Bt?qe:null,Yt=ii?ii.posMatrix:S.transform.calculatePosMatrix(qe.toUnwrapped(),be),di=Tc(Yt,Ke||[0,0],Pt||1,vt,m);U instanceof hi?q.draw(C,D.TRIANGLES,Oe,Pn.disabled,K,Mn.disabled,di,Bt,m.id,U.boundsBuffer,S.quadTriangleIndexBuffer,U.boundsSegments):q.draw(C,D.TRIANGLES,Oe,ee[qe.overscaledZ],K,Mn.disabled,di,Bt,m.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments)}},background:function(S,l,m,w){const C=m.paint.get("background-color"),D=m.paint.get("background-opacity");if(D===0)return;const U=S.context,q=U.gl,K=S.transform,ee=K.tileSize,le=m.paint.get("background-pattern");if(S.isPatternMissing(le))return;const me=!le&&C.a===1&&D===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==me)return;const be=Pn.disabled,qe=S.depthModeForSublayer(0,me==="opaque"?kr.ReadWrite:kr.ReadOnly),Oe=S.colorModeForRenderPass(),Fe=S.useProgram(le?"backgroundPattern":"background"),ht=w||K.coveringTiles({tileSize:ee,terrain:S.style.terrain});le&&(U.activeTexture.set(q.TEXTURE0),S.imageManager.bind(S.context));const vt=m.getCrossfadeParameters();for(const Pt of ht){const Ke=w?Pt.posMatrix:S.transform.calculatePosMatrix(Pt.toUnwrapped()),Rt=le?Mh(Ke,D,S,le,{tileID:Pt,tileSize:ee},vt):Sh(Ke,D,C),Bt=S.style.terrain&&S.style.terrain.getTerrainData(Pt);Fe.draw(U,q.TRIANGLES,qe,be,Oe,Mn.disabled,Rt,Bt,m.id,S.tileExtentBuffer,S.quadTriangleIndexBuffer,S.tileExtentSegments)}},debug:function(S,l,m){for(let w=0;w<m.length;w++)wd(S,l,m[w])},custom:function(S,l,m){const w=S.context,C=m.implementation;if(S.renderPass==="offscreen"){const D=C.prerender;D&&(S.setCustomLayerDefaults(),w.setColorMode(S.colorModeForRenderPass()),D.call(C,w.gl,S.transform.customLayerMatrix()),w.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),w.setColorMode(S.colorModeForRenderPass()),w.setStencilMode(Pn.disabled);const D=C.renderingMode==="3d"?new kr(S.context.gl.LEQUAL,kr.ReadWrite,S.depthRangeFor3D):S.depthModeForSublayer(0,kr.ReadOnly);w.setDepthMode(D),C.render(w.gl,S.transform.customLayerMatrix()),w.setDirty(),S.setBaseState(),w.bindFramebuffer.set(null)}}};class cu{constructor(l,m){this.context=new va(l),this.transform=m,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.create(),renderTime:0},this.setup(),this.numSublayers=eo.maxUnderzooming+eo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new rr,this.gpuTimers={}}resize(l,m,w){if(this.width=l*w,this.height=m*w,this.pixelRatio=w,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){const l=this.context,m=new t.PosArray;m.emplaceBack(0,0),m.emplaceBack(t.EXTENT,0),m.emplaceBack(0,t.EXTENT),m.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(m,br.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const w=new t.PosArray;w.emplaceBack(0,0),w.emplaceBack(t.EXTENT,0),w.emplaceBack(0,t.EXTENT),w.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=l.createVertexBuffer(w,br.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const C=new t.RasterBoundsArray;C.emplaceBack(0,0,0,0),C.emplaceBack(t.EXTENT,0,t.EXTENT,0),C.emplaceBack(0,t.EXTENT,0,t.EXTENT),C.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(C,pt.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const D=new t.PosArray;D.emplaceBack(0,0),D.emplaceBack(1,0),D.emplaceBack(0,1),D.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(D,br.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const U=new t.LineStripIndexArray;U.emplaceBack(0),U.emplaceBack(1),U.emplaceBack(3),U.emplaceBack(2),U.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(U);const q=new t.TriangleIndexArray;q.emplaceBack(0,1,2),q.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(q),this.emptyTexture=new at(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);const K=this.context.gl;this.stencilClearMode=new Pn({func:K.ALWAYS,mask:0},0,255,K.ZERO,K.ZERO,K.ZERO)}clearStencil(){const l=this.context,m=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const w=t.create();t.ortho(w,0,this.width,this.height,0,0,1),t.scale(w,w,[m.drawingBufferWidth,m.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,m.TRIANGLES,kr.disabled,this.stencilClearMode,_n.disabled,Mn.disabled,Po(w),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,m){if(this.currentStencilSource===l.source||!l.isTileClipped()||!m||!m.length)return;this.currentStencilSource=l.source;const w=this.context,C=w.gl;this.nextStencilID+m.length>256&&this.clearStencil(),w.setColorMode(_n.disabled),w.setDepthMode(kr.disabled);const D=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const U of m){const q=this._tileClippingMaskIDs[U.key]=this.nextStencilID++,K=this.style.terrain&&this.style.terrain.getTerrainData(U);D.draw(w,C.TRIANGLES,kr.disabled,new Pn({func:C.ALWAYS,mask:0},q,255,C.KEEP,C.KEEP,C.REPLACE),_n.disabled,Mn.disabled,Po(U.posMatrix),K,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,m=this.context.gl;return new Pn({func:m.NOTEQUAL,mask:255},l,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(l){const m=this.context.gl;return new Pn({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(l){const m=this.context.gl,w=l.sort((U,q)=>q.overscaledZ-U.overscaledZ),C=w[w.length-1].overscaledZ,D=w[0].overscaledZ-C+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();const U={};for(let q=0;q<D;q++)U[q+C]=new Pn({func:m.GEQUAL,mask:255},q+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=D,[U,w]}return[{[C]:Pn.disabled},w]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new _n([l.CONSTANT_COLOR,l.ONE],new t.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?_n.unblended:_n.alphaBlended}depthModeForSublayer(l,m,w){if(!this.opaquePassEnabledForLayer())return kr.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new kr(w||this.context.gl.LEQUAL,m,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,m){this.style=l,this.options=m,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const w=this.style._order,C=this.style.sourceCaches,D=this.style.terrain&&new Yu(this);for(const ee in C){const le=C[ee];le.used&&le.prepare(this.context)}const U={},q={},K={};for(const ee in C){const le=C[ee];U[ee]=le.getVisibleCoordinates(),q[ee]=U[ee].slice().reverse(),K[ee]=le.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ee=0;ee<w.length;ee++)if(this.style._layers[w[ee]].is3D()){this.opaquePassCutoff=ee;break}if(D){this.opaquePassCutoff=0;const ee=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!t.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||ee.length)&&(t.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(le,me){const be=le.context,qe=be.gl,Oe=_n.unblended,Fe=new kr(qe.LEQUAL,kr.ReadWrite,[0,1]),ht=me.getTerrainMesh(),vt=me.sourceCache.getRenderableTiles(),Pt=le.useProgram("terrainDepth");be.bindFramebuffer.set(me.getFramebuffer("depth").framebuffer),be.viewport.set([0,0,le.width/devicePixelRatio,le.height/devicePixelRatio]),be.clear({color:t.Color.transparent,depth:1});for(const Ke of vt){const Rt=me.getTerrainData(Ke.tileID),Bt=le.transform.calculatePosMatrix(Ke.tileID.toUnwrapped());Pt.draw(be,qe.TRIANGLES,Fe,Pn.disabled,Oe,Mn.backCCW,{u_matrix:Bt},Rt,"terrain",ht.vertexBuffer,ht.indexBuffer,ht.segments)}be.bindFramebuffer.set(null),be.viewport.set([0,0,le.width,le.height])}(this,this.style.terrain),function(le,me){const be=le.context,qe=be.gl,Oe=_n.unblended,Fe=new kr(qe.LEQUAL,kr.ReadWrite,[0,1]),ht=me.getTerrainMesh(),vt=me.getCoordsTexture(),Pt=me.sourceCache.getRenderableTiles(),Ke=le.useProgram("terrainCoords");be.bindFramebuffer.set(me.getFramebuffer("coords").framebuffer),be.viewport.set([0,0,le.width/devicePixelRatio,le.height/devicePixelRatio]),be.clear({color:t.Color.transparent,depth:1}),me.coordsIndex=[];for(const Rt of Pt){const Bt=me.getTerrainData(Rt.tileID);be.activeTexture.set(qe.TEXTURE0),qe.bindTexture(qe.TEXTURE_2D,vt.texture);const ii=le.transform.calculatePosMatrix(Rt.tileID.toUnwrapped());Ke.draw(be,qe.TRIANGLES,Fe,Pn.disabled,Oe,Mn.backCCW,{u_matrix:ii,u_terrain_coords_id:(255-me.coordsIndex.length)/255,u_texture:0},Bt,"terrain",ht.vertexBuffer,ht.indexBuffer,ht.segments),me.coordsIndex.push(Rt.tileID.key)}be.bindFramebuffer.set(null),be.viewport.set([0,0,le.width,le.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const ee of w){const le=this.style._layers[ee];if(!le.hasOffscreenPass()||le.isHidden(this.transform.zoom))continue;const me=q[le.source];(le.type==="custom"||me.length)&&this.renderLayer(this,C[le.source],le,me)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!D)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const ee=this.style._layers[w[this.currentLayer]],le=C[ee.source],me=U[ee.source];this._renderTileClippingMasks(ee,me),this.renderLayer(this,le,ee,me)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const ee=this.style._layers[w[this.currentLayer]],le=C[ee.source];if(D&&D.renderLayer(ee))continue;const me=(ee.type==="symbol"?K:q)[ee.source];this._renderTileClippingMasks(ee,U[ee.source]),this.renderLayer(this,le,ee,me)}if(this.options.showTileBoundaries){let ee,le;Object.values(this.style._layers).forEach(me=>{me.source&&!me.isHidden(this.transform.zoom)&&(me.source!==(le&&le.id)&&(le=this.style.sourceCaches[me.source]),(!ee||ee.getSource().maxzoom<le.getSource().maxzoom)&&(ee=le))}),ee&&qa.debug(this,ee,ee.getVisibleCoordinates())}this.options.showPadding&&function(ee){const le=ee.transform.padding;ba(ee,ee.transform.height-(le.top||0),3,Xu),ba(ee,le.bottom||0,3,ca),Ac(ee,le.left||0,3,Hu),Ac(ee,ee.transform.width-(le.right||0),3,lu);const me=ee.transform.centerPoint;(function(be,qe,Oe,Fe){Jl(be,qe-1,Oe-10,2,20,Fe),Jl(be,qe-10,Oe-1,20,2,Fe)})(ee,me.x,ee.transform.height-me.y,Ku)}(this),this.context.setDefault()}renderLayer(l,m,w,C){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="custom"||(C||[]).length)&&(this.id=w.id,this.gpuTimingStart(w),qa[w.type](l,m,w,C,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let w=this.gpuTimers[l.id];w||(w=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),w.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,w.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}queryGpuTimers(l){const m={};for(const w in l){const C=l[w],D=this.context.extTimerQuery,U=D.getQueryObjectEXT(C.query,D.QUERY_RESULT_EXT)/1e6;D.deleteQueryEXT(C.query),m[w]=U}return m}translatePosMatrix(l,m,w,C,D){if(!w[0]&&!w[1])return l;const U=D?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(U){const ee=Math.sin(U),le=Math.cos(U);w=[w[0]*le-w[1]*ee,w[0]*ee+w[1]*le]}const q=[D?w[0]:mt(m,w[0],this.transform.zoom),D?w[1]:mt(m,w[1],this.transform.zoom),0],K=new Float32Array(16);return t.translate(K,l,q),K}saveTileTexture(l){const m=this._tileTextures[l.size[0]];m?m.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const m=this._tileTextures[l];return m&&m.length>0?m.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const m=this.imageManager.getPattern(l.from.toString()),w=this.imageManager.getPattern(l.to.toString());return!m||!w}useProgram(l,m){this.cache=this.cache||{};const w=l+(m?m.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[w]||(this.cache[w]=new Eh(this.context,l,En[l],m,Ho[l],this._showOverdrawInspector,this.style.terrain)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new at(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Bs{constructor(l,m){this.points=l,this.planes=m}static fromInvProjectionMatrix(l,m,w){const C=Math.pow(2,w),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(q=>{const K=1/(q=t.transformMat4([],q,l))[3]/m*C;return t.mul$1(q,q,[K,K,1/q[3],K])}),U=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(q=>{const K=t.sub([],D[q[0]],D[q[1]]),ee=t.sub([],D[q[2]],D[q[1]]),le=t.normalize([],t.cross([],K,ee)),me=-t.dot(le,D[q[1]]);return le.concat(me)});return new Bs(D,U)}}class ml{constructor(l,m){this.min=l,this.max=m,this.center=t.scale$1([],t.add([],this.min,this.max),.5)}quadrant(l){const m=[l%2==0,l<2],w=t.clone$2(this.min),C=t.clone$2(this.max);for(let D=0;D<m.length;D++)w[D]=m[D]?this.min[D]:this.center[D],C[D]=m[D]?this.center[D]:this.max[D];return C[2]=this.max[2],new ml(w,C)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const m=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let w=!0;for(let C=0;C<l.planes.length;C++){const D=l.planes[C];let U=0;for(let q=0;q<m.length;q++)t.dot$1(D,m[q])>=0&&U++;if(U===0)return 0;U!==m.length&&(w=!1)}if(w)return 2;for(let C=0;C<3;C++){let D=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(let q=0;q<l.points.length;q++){const K=l.points[q][C]-this.min[C];D=Math.min(D,K),U=Math.max(U,K)}if(U<0||D>this.max[C]-this.min[C])return 0}return 1}}class _l{constructor(l=0,m=0,w=0,C=0){if(isNaN(l)||l<0||isNaN(m)||m<0||isNaN(w)||w<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=m,this.left=w,this.right=C}interpolate(l,m,w){return m.top!=null&&l.top!=null&&(this.top=t.number(l.top,m.top,w)),m.bottom!=null&&l.bottom!=null&&(this.bottom=t.number(l.bottom,m.bottom,w)),m.left!=null&&l.left!=null&&(this.left=t.number(l.left,m.left,w)),m.right!=null&&l.right!=null&&(this.right=t.number(l.right,m.right,w)),this}getCenter(l,m){const w=t.clamp((this.left+l-this.right)/2,0,l),C=t.clamp((this.top+m-this.bottom)/2,0,m);return new t.pointGeometry(w,C)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new _l(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class gl{constructor(l,m,w,C,D){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=D===void 0||!!D,this._minZoom=l||0,this._maxZoom=m||22,this._minPitch=w??0,this._maxPitch=C??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new _l,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const l=new gl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l._elevation=this._elevation,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const m=-t.wrap(l,-180,180)*Math.PI/180;var w;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(w=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w),function(C,D,U){var q=D[0],K=D[1],ee=D[2],le=D[3],me=Math.sin(U),be=Math.cos(U);C[0]=q*be+ee*me,C[1]=K*be+le*me,C[2]=q*-me+ee*be,C[3]=K*-me+le*be}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const m=t.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const m=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this.scale=this.zoomScale(m),this.tileZoom=Math.floor(m),this.zoomFraction=m-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,m,w){this._unmodified=!1,this._edgeInsets.interpolate(l,m,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const m=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(l){const m=[new t.UnwrappedTileID(0,l)];if(this._renderWorldCopies){const w=this.pointCoordinate(new t.pointGeometry(0,0)),C=this.pointCoordinate(new t.pointGeometry(this.width,0)),D=this.pointCoordinate(new t.pointGeometry(this.width,this.height)),U=this.pointCoordinate(new t.pointGeometry(0,this.height)),q=Math.floor(Math.min(w.x,C.x,D.x,U.x)),K=Math.floor(Math.max(w.x,C.x,D.x,U.x)),ee=1;for(let le=q-ee;le<=K+ee;le++)le!==0&&m.push(new t.UnwrappedTileID(le,l))}return m}coveringTiles(l){var m,w;let C=this.coveringZoomLevel(l);const D=C;if(l.minzoom!==void 0&&C<l.minzoom)return[];l.maxzoom!==void 0&&C>l.maxzoom&&(C=l.maxzoom);const U=this.pointCoordinate(this.getCameraPoint()),q=t.MercatorCoordinate.fromLngLat(this.center),K=Math.pow(2,C),ee=[K*U.x,K*U.y,0],le=[K*q.x,K*q.y,0],me=Bs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,C);let be=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(be=C);const qe=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,Oe=Ke=>({aabb:new ml([Ke*K,0,0],[(Ke+1)*K,K,0]),zoom:0,x:0,y:0,wrap:Ke,fullyVisible:!1}),Fe=[],ht=[],vt=C,Pt=l.reparseOverscaled?D:C;if(this._renderWorldCopies)for(let Ke=1;Ke<=3;Ke++)Fe.push(Oe(-Ke)),Fe.push(Oe(Ke));for(Fe.push(Oe(0));Fe.length>0;){const Ke=Fe.pop(),Rt=Ke.x,Bt=Ke.y;let ii=Ke.fullyVisible;if(!ii){const qi=Ke.aabb.intersects(me);if(qi===0)continue;ii=qi===2}const Yt=l.terrain?ee:le,di=Ke.aabb.distanceX(Yt),Wt=Ke.aabb.distanceY(Yt),Ui=Math.max(Math.abs(di),Math.abs(Wt)),Ft=qe+(1<<vt-Ke.zoom)-2;if(Ke.zoom===vt||Ui>Ft&&Ke.zoom>=be){const qi=vt-Ke.zoom,Er=ee[0]-.5-(Rt<<qi),Sr=ee[1]-.5-(Bt<<qi);ht.push({tileID:new t.OverscaledTileID(Ke.zoom===vt?Pt:Ke.zoom,Ke.wrap,Ke.zoom,Rt,Bt),distanceSq:t.sqrLen([le[0]-.5-Rt,le[1]-.5-Bt]),tileDistanceToCamera:Math.sqrt(Er*Er+Sr*Sr)})}else for(let qi=0;qi<4;qi++){const Er=(Rt<<1)+qi%2,Sr=(Bt<<1)+(qi>>1),ir=Ke.zoom+1;let pi=Ke.aabb.quadrant(qi);if(l.terrain){const cn=new t.OverscaledTileID(ir,Ke.wrap,ir,Er,Sr),Yr=l.terrain.getMinMaxElevation(cn),Jr=(m=Yr.minElevation)!==null&&m!==void 0?m:this.elevation,dn=(w=Yr.maxElevation)!==null&&w!==void 0?w:this.elevation;pi=new ml([pi.min[0],pi.min[1],Jr],[pi.max[0],pi.max[1],dn])}Fe.push({aabb:pi,zoom:ir,x:Er,y:Sr,wrap:Ke.wrap,fullyVisible:ii})}}return ht.sort((Ke,Rt)=>Ke.distanceSq-Rt.distanceSq).map(Ke=>Ke.tileID)}resize(l,m){this.width=l,this.height=m,this.pixelsToGLUnits=[2/l,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const m=t.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.pointGeometry(t.mercatorXfromLng(l.lng)*this.worldSize,t.mercatorYfromLat(m)*this.worldSize)}unproject(l){return new t.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(l){this.freezeElevation||(this.elevation=l?this.getElevation(this._center,l):0)}getElevation(l,m){const w=t.MercatorCoordinate.fromLngLat(l),C=(1<<this.tileZoom)*t.EXTENT,D=w.x*C,U=w.y*C,q=Math.floor(D/t.EXTENT),K=Math.floor(U/t.EXTENT),ee=new t.OverscaledTileID(this.tileZoom,0,this.tileZoom,q,K);return m.getElevation(ee,D%t.EXTENT,U%t.EXTENT,t.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const m=this.pointLocation(this.centerPoint,l),w=this.getElevation(m,l);if(!(this.elevation-w))return;const C=this.getCameraPosition(),D=t.MercatorCoordinate.fromLngLat(C.lngLat,C.altitude),U=t.MercatorCoordinate.fromLngLat(m,w),q=D.x-U.x,K=D.y-U.y,ee=D.z-U.z,le=Math.sqrt(q*q+K*K+ee*ee),me=this.scaleZoom(this.cameraToCenterDistance/le/this.tileSize);this._elevation=w,this._center=m,this.zoom=me}setLocationAtPoint(l,m){const w=this.pointCoordinate(m),C=this.pointCoordinate(this.centerPoint),D=this.locationCoordinate(l),U=new t.MercatorCoordinate(D.x-(w.x-C.x),D.y-(w.y-C.y));this.center=this.coordinateLocation(U),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,m){return m?this.coordinatePoint(this.locationCoordinate(l),this.getElevation(l,m),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,m){return this.coordinateLocation(this.pointCoordinate(l,m))}locationCoordinate(l){return t.MercatorCoordinate.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,m){if(m){const be=m.pointCoordinate(l);if(be!=null)return be}const w=[l.x,l.y,0,1],C=[l.x,l.y,1,1];t.transformMat4(w,w,this.pixelMatrixInverse),t.transformMat4(C,C,this.pixelMatrixInverse);const D=w[3],U=C[3],q=w[1]/D,K=C[1]/U,ee=w[2]/D,le=C[2]/U,me=ee===le?0:(0-ee)/(le-ee);return new t.MercatorCoordinate(t.number(w[0]/D,C[0]/U,me)/this.worldSize,t.number(q,K,me)/this.worldSize)}coordinatePoint(l,m=0,w=this.pixelMatrix){const C=[l.x*this.worldSize,l.y*this.worldSize,m,1];return t.transformMat4(C,C,w),new t.pointGeometry(C[0]/C[3],C[1]/C[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new t.LngLatBounds().extend(this.pointLocation(new t.pointGeometry(0,l))).extend(this.pointLocation(new t.pointGeometry(this.width,l))).extend(this.pointLocation(new t.pointGeometry(this.width,this.height))).extend(this.pointLocation(new t.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(l,m=!1){const w=l.key,C=m?this._alignedPosMatrixCache:this._posMatrixCache;if(C[w])return C[w];const D=l.canonical,U=this.worldSize/this.zoomScale(D.z),q=D.x+Math.pow(2,D.z)*l.wrap,K=t.identity(new Float64Array(16));return t.translate(K,K,[q*U,D.y*U,0]),t.scale(K,K,[U/t.EXTENT,U/t.EXTENT,1]),t.multiply(K,m?this.alignedProjMatrix:this.projMatrix,K),C[w]=new Float32Array(K),C[w]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let l,m,w,C,D=-90,U=90,q=-180,K=180;const ee=this.size,le=this._unmodified;if(this.latRange){const qe=this.latRange;D=t.mercatorYfromLat(qe[1])*this.worldSize,U=t.mercatorYfromLat(qe[0])*this.worldSize,l=U-D<ee.y?ee.y/(U-D):0}if(this.lngRange){const qe=this.lngRange;q=t.wrap(t.mercatorXfromLng(qe[0])*this.worldSize,0,this.worldSize),K=t.wrap(t.mercatorXfromLng(qe[1])*this.worldSize,0,this.worldSize),K<q&&(K+=this.worldSize),m=K-q<ee.x?ee.x/(K-q):0}const me=this.point,be=Math.max(m||0,l||0);if(be)return this.center=this.unproject(new t.pointGeometry(m?(K+q)/2:me.x,l?(U+D)/2:me.y)),this.zoom+=this.scaleZoom(be),this._unmodified=le,void(this._constraining=!1);if(this.latRange){const qe=me.y,Oe=ee.y/2;qe-Oe<D&&(C=D+Oe),qe+Oe>U&&(C=U-Oe)}if(this.lngRange){const qe=(q+K)/2,Oe=t.wrap(me.x,qe-this.worldSize/2,qe+this.worldSize/2),Fe=ee.x/2;Oe-Fe<q&&(w=q+Fe),Oe+Fe>K&&(w=K-Fe)}w===void 0&&C===void 0||(this.center=this.unproject(new t.pointGeometry(w!==void 0?w:me.x,C!==void 0?C:me.y)).wrap()),this._unmodified=le,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,m=this.point.x,w=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let C=t.identity(new Float64Array(16));t.scale(C,C,[this.width/2,-this.height/2,1]),t.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=t.identity(new Float64Array(16)),t.scale(C,C,[1,-1,1]),t.translate(C,C,[-1,-1,0]),t.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const D=Math.PI/2+this._pitch,U=this._fov*(.5+l.y/this.height),q=Math.sin(U)*this.cameraToSeaLevelDistance/Math.sin(t.clamp(Math.PI-D-U,.01,Math.PI-.01)),K=this.getHorizon(),ee=2*Math.atan(K/this.cameraToCenterDistance)*(.5+l.y/(2*K)),le=Math.sin(ee)*this.cameraToSeaLevelDistance/Math.sin(t.clamp(Math.PI-D-ee,.01,Math.PI-.01)),me=Math.cos(Math.PI/2-this._pitch)*q+this.cameraToSeaLevelDistance,be=Math.cos(Math.PI/2-this._pitch)*le+this.cameraToSeaLevelDistance,qe=1.01*Math.min(me,be),Oe=this.height/50;C=new Float64Array(16),t.perspective(C,this._fov,this.width/this.height,Oe,qe),C[8]=2*-l.x/this.width,C[9]=2*l.y/this.height,t.scale(C,C,[1,-1,1]),t.translate(C,C,[0,0,-this.cameraToCenterDistance]),t.rotateX(C,C,this._pitch),t.rotateZ(C,C,this.angle),t.translate(C,C,[-m,-w,0]),this.mercatorMatrix=t.scale([],C,[this.worldSize,this.worldSize,this.worldSize]),t.scale(C,C,[1,1,this._pixelPerMeter]),this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,C),t.translate(C,C,[0,0,-this.elevation]),this.projMatrix=C,this.invProjMatrix=t.invert([],C),this.pixelMatrix3D=t.multiply(new Float64Array(16),this.labelPlaneMatrix,C);const Fe=this.width%2/2,ht=this.height%2/2,vt=Math.cos(this.angle),Pt=Math.sin(this.angle),Ke=m-Math.round(m)+vt*Fe+Pt*ht,Rt=w-Math.round(w)+vt*ht+Pt*Fe,Bt=new Float64Array(C);if(t.translate(Bt,Bt,[Ke>.5?Ke-1:Ke,Rt>.5?Rt-1:Rt,0]),this.alignedProjMatrix=Bt,C=t.invert(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");this.pixelMatrixInverse=C,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new t.pointGeometry(0,0)),m=[l.x*this.worldSize,l.y*this.worldSize,0,1];return t.transformMat4(m,m,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.pointGeometry(0,l))}getCameraQueryGeometry(l){const m=this.getCameraPoint();if(l.length===1)return[l[0],m];{let w=m.x,C=m.y,D=m.x,U=m.y;for(const q of l)w=Math.min(w,q.x),C=Math.min(C,q.y),D=Math.max(D,q.x),U=Math.max(U,q.y);return[new t.pointGeometry(w,C),new t.pointGeometry(D,C),new t.pointGeometry(D,U),new t.pointGeometry(w,U),new t.pointGeometry(w,C)]}}}class zh{constructor(l){this._hashName=l&&encodeURIComponent(l),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(m,w){let C=!1,D=null;const U=()=>{D=null,C&&(m(),D=setTimeout(U,300),C=!1)};return()=>(C=!0,D||U(),D)}(this._updateHashUnthrottled.bind(this))}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){const m=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,C=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),D=Math.pow(10,C),U=Math.round(m.lng*D)/D,q=Math.round(m.lat*D)/D,K=this._map.getBearing(),ee=this._map.getPitch();let le="";if(le+=l?`/${U}/${q}/${w}`:`${w}/${q}/${U}`,(K||ee)&&(le+="/"+Math.round(10*K)/10),ee&&(le+=`/${Math.round(ee)}`),this._hashName){const me=this._hashName;let be=!1;const qe=window.location.hash.slice(1).split("&").map(Oe=>{const Fe=Oe.split("=")[0];return Fe===me?(be=!0,`${Fe}=${le}`):Oe}).filter(Oe=>Oe);return be||qe.push(`${me}=${le}`),`#${qe.join("&")}`}return`#${le}`}_getCurrentHash(){const l=window.location.hash.replace("#","");if(this._hashName){let m;return l.split("&").map(w=>w.split("=")).forEach(w=>{w[0]===this._hashName&&(m=w)}),(m&&m[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._getCurrentHash();if(l.length>=3&&!l.some(m=>isNaN(m))){const m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:m,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,l)}catch{}}}const ec={linearity:.3,easing:t.bezier(0,0,.3,1)},f1=t.extend({deceleration:2500,maxSpeed:1400},ec),Ju=t.extend({deceleration:20,maxSpeed:1400},ec),uu=t.extend({deceleration:1e3,maxSpeed:360},ec),wa=t.extend({deceleration:1e3,maxSpeed:90},ec);class Dh{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,m=t.exported.now();for(;l.length>0&&m-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const m={zoom:0,bearing:0,pitch:0,pan:new t.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:D}of this._inertiaBuffer)m.zoom+=D.zoomDelta||0,m.bearing+=D.bearingDelta||0,m.pitch+=D.pitchDelta||0,D.panDelta&&m.pan._add(D.panDelta),D.around&&(m.around=D.around),D.pinchAround&&(m.pinchAround=D.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(m.pan.mag()){const D=hu(m.pan.mag(),w,t.extend({},f1,l||{}));C.offset=m.pan.mult(D.amount/m.pan.mag()),C.center=this._map.transform.center,tc(C,D)}if(m.zoom){const D=hu(m.zoom,w,Ju);C.zoom=this._map.transform.zoom+D.amount,tc(C,D)}if(m.bearing){const D=hu(m.bearing,w,uu);C.bearing=this._map.transform.bearing+t.clamp(D.amount,-179,179),tc(C,D)}if(m.pitch){const D=hu(m.pitch,w,wa);C.pitch=this._map.transform.pitch+D.amount,tc(C,D)}if(C.zoom||C.bearing){const D=m.pinchAround===void 0?m.around:m.pinchAround;C.around=D?this._map.unproject(D):this._map.getCenter()}return this.clear(),t.extend(C,{noMoveStart:!0})}}function tc(S,l){(!S.duration||S.duration<l.duration)&&(S.duration=l.duration,S.easing=l.easing)}function hu(S,l,m){const{maxSpeed:w,linearity:C,deceleration:D}=m,U=t.clamp(S*C/(l/1e3),-w,w),q=Math.abs(U)/(D*C);return{easing:m.easing,duration:1e3*q,amount:U*(q/2)}}class ls extends t.Event{constructor(l,m,w,C={}){const D=ne.mousePos(m.getCanvasContainer(),w),U=m.unproject(D);super(l,t.extend({point:D,lngLat:U,originalEvent:w},C)),this._defaultPrevented=!1,this.target=m}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Pc extends t.Event{constructor(l,m,w){const C=l==="touchend"?w.changedTouches:w.touches,D=ne.touchPos(m.getCanvasContainer(),C),U=D.map(K=>m.unproject(K)),q=D.reduce((K,ee,le,me)=>K.add(ee.div(me.length)),new t.pointGeometry(0,0));super(l,{points:D,point:q,lngLats:U,lngLat:m.unproject(q),originalEvent:w}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class zo extends t.Event{constructor(l,m,w){super(l,{originalEvent:w}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class m1{constructor(l,m){this._map=l,this._clickTolerance=m.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new zo(l.type,this._map,l))}mousedown(l,m){return this._mousedownPos=m,this._firePreventable(new ls(l.type,this._map,l))}mouseup(l){this._map.fire(new ls(l.type,this._map,l))}click(l,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new ls(l.type,this._map,l))}dblclick(l){return this._firePreventable(new ls(l.type,this._map,l))}mouseover(l){this._map.fire(new ls(l.type,this._map,l))}mouseout(l){this._map.fire(new ls(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Pc(l.type,this._map,l))}touchmove(l){this._map.fire(new Pc(l.type,this._map,l))}touchend(l){this._map.fire(new Pc(l.type,this._map,l))}touchcancel(l){this._map.fire(new Pc(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ua{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new ls(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ls("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new ls(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Lh{constructor(l,m){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,m){this.isEnabled()&&l.shiftKey&&l.button===0&&(ne.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(l,m){if(!this._active)return;const w=m;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;const C=this._startPos;this._lastPos=w,this._box||(this._box=ne.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const D=Math.min(C.x,w.x),U=Math.max(C.x,w.x),q=Math.min(C.y,w.y),K=Math.max(C.y,w.y);ne.setTransform(this._box,`translate(${D}px,${q}px)`),this._box.style.width=U-D+"px",this._box.style.height=K-q+"px"}mouseupWindow(l,m){if(!this._active||l.button!==0)return;const w=this._startPos,C=m;if(this.reset(),ne.suppressClick(),w.x!==C.x||w.y!==C.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:D=>D.fitScreenCoordinates(w,C,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(ne.remove(this._box),this._box=null),ne.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,m){return this._map.fire(new t.Event(l,{originalEvent:m}))}}function Es(S,l){if(S.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${S.length}, points ${l.length}`);const m={};for(let w=0;w<S.length;w++)m[S[w].identifier]=l[w];return m}class du{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,m,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),w.length===this.numTouches&&(this.centroid=function(C){const D=new t.pointGeometry(0,0);for(const U of C)D._add(U);return D.div(C.length)}(m),this.touches=Es(w,m)))}touchmove(l,m,w){if(this.aborted||!this.centroid)return;const C=Es(w,m);for(const D in this.touches){const U=this.touches[D],q=C[D];(!q||q.dist(U)>30)&&(this.aborted=!0)}}touchend(l,m,w){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class Rh{constructor(l){this.singleTap=new du(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,m,w){this.singleTap.touchstart(l,m,w)}touchmove(l,m,w){this.singleTap.touchmove(l,m,w)}touchend(l,m,w){const C=this.singleTap.touchend(l,m,w);if(C){const D=l.timeStamp-this.lastTime<500,U=!this.lastTap||this.lastTap.dist(C)<30;if(D&&U||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Td{constructor(){this._zoomIn=new Rh({numTouches:1,numTaps:2}),this._zoomOut=new Rh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,m,w){this._zoomIn.touchstart(l,m,w),this._zoomOut.touchstart(l,m,w)}touchmove(l,m,w){this._zoomIn.touchmove(l,m,w),this._zoomOut.touchmove(l,m,w)}touchend(l,m,w){const C=this._zoomIn.touchend(l,m,w),D=this._zoomOut.touchend(l,m,w);return C?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:U=>U.easeTo({duration:300,zoom:U.getZoom()+1,around:U.unproject(C)},{originalEvent:l})}):D?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:U=>U.easeTo({duration:300,zoom:U.getZoom()-1,around:U.unproject(D)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ed={0:1,2:2};class Qu{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(l,m){return!1}_move(l,m){return{}}mousedown(l,m){if(this._lastPoint)return;const w=ne.mouseButton(l);this._correctButton(l,w)&&(this._lastPoint=m,this._eventButton=w)}mousemoveWindow(l,m){const w=this._lastPoint;if(w){if(l.preventDefault(),function(C,D){const U=Ed[D];return C.buttons===void 0||(C.buttons&U)!==U}(l,this._eventButton))this.reset();else if(this._moved||!(m.dist(w)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(w,m)}}mouseupWindow(l){this._lastPoint&&ne.mouseButton(l)===this._eventButton&&(this._moved&&ne.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kc extends Qu{mousedown(l,m){super.mousedown(l,m),this._lastPoint&&(this._active=!0)}_correctButton(l,m){return m===0&&!l.ctrlKey}_move(l,m){return{around:m,panDelta:m.sub(l)}}}class Xs extends Qu{_correctButton(l,m){return m===0&&l.ctrlKey||m===2}_move(l,m){const w=.8*(m.x-l.x);if(w)return this._active=!0,{bearingDelta:w}}contextmenu(l){l.preventDefault()}}class Gi extends Qu{_correctButton(l,m){return m===0&&l.ctrlKey||m===2}_move(l,m){const w=-.5*(m.y-l.y);if(w)return this._active=!0,{pitchDelta:w}}contextmenu(l){l.preventDefault()}}class Bh{constructor(l,m){this._minTouches=l.cooperativeGestures?2:1,this._clickTolerance=l.clickTolerance||1,this._map=m,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(l,m,w){return this._calculateTransform(l,m,w)}touchmove(l,m,w){if(this._map._cooperativeGestures&&(this._minTouches===2&&w.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(l,!1,w.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(w.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,m,w)}touchend(l,m,w){this._calculateTransform(l,m,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,m,w){w.length>0&&(this._active=!0);const C=Es(w,m),D=new t.pointGeometry(0,0),U=new t.pointGeometry(0,0);let q=0;for(const ee in C){const le=C[ee],me=this._touches[ee];me&&(D._add(le),U._add(le.sub(me)),q++,C[ee]=le)}if(this._touches=C,q<this._minTouches||!U.mag())return;const K=U.div(q);return this._sum._add(K),this._sum.mag()<this._clickTolerance?void 0:{around:D.div(q),panDelta:K}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(l){}_move(l,m,w){return{}}touchstart(l,m,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([m[0],m[1]]))}touchmove(l,m,w){if(!this._firstTwoTouches)return;l.preventDefault();const[C,D]=this._firstTwoTouches,U=Ko(w,m,C),q=Ko(w,m,D);if(!U||!q)return;const K=this._aroundCenter?null:U.add(q).div(2);return this._move([U,q],K,l)}touchend(l,m,w){if(!this._firstTwoTouches)return;const[C,D]=this._firstTwoTouches,U=Ko(w,m,C),q=Ko(w,m,D);U&&q||(this._active&&ne.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ko(S,l,m){for(let w=0;w<S.length;w++)if(S[w].identifier===m)return l[w]}function zc(S,l){return Math.log(S/l)/Math.LN2}class Pi extends yl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,m){const w=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(zc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zc(this._distance,w),pinchAround:m}}}function xl(S,l){return 180*S.angleWith(l)/Math.PI}class _1 extends yl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,m){const w=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xl(this._vector,w),pinchAround:m}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const m=25/(Math.PI*this._minDiameter)*360,w=xl(l,this._startVector);return Math.abs(w)<m}}function Wa(S){return Math.abs(S.y)>Math.abs(S.x)}class vl extends yl{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,m,w){super.touchstart(l,m,w),this._currentTouchCount=w.length}_start(l){this._lastPoints=l,Wa(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,m,w){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const C=l[0].sub(this._lastPoints[0]),D=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,D,w.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(C.y+D.y)/2*-.5}):void 0}gestureBeginsVertically(l,m,w){if(this._valid!==void 0)return this._valid;const C=l.mag()>=2,D=m.mag()>=2;if(!C&&!D)return;if(!C||!D)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;const U=l.y>0==m.y>0;return Wa(l)&&Wa(m)&&U}}const pu={panStep:100,bearingStep:15,pitchStep:10};class fu{constructor(){const l=pu;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let m=0,w=0,C=0,D=0,U=0;switch(l.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:l.shiftKey?w=-1:(l.preventDefault(),D=-1);break;case 39:l.shiftKey?w=1:(l.preventDefault(),D=1);break;case 38:l.shiftKey?C=1:(l.preventDefault(),U=-1);break;case 40:l.shiftKey?C=-1:(l.preventDefault(),U=1);break;default:return}return this._rotationDisabled&&(w=0,C=0),{cameraAnimation:q=>{const K=q.getZoom();q.easeTo({duration:300,easeId:"keyboardHandler",easing:tn,zoom:m?Math.round(K)+m*(l.shiftKey?2:1):K,bearing:q.getBearing()+w*this._bearingStep,pitch:q.getPitch()+C*this._pitchStep,offset:[-D*this._panStep,-U*this._panStep],center:q.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tn(S){return S*(2-S)}const Dc=4.000244140625;class eh{constructor(l,m){this._map=l,this._el=l.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;l.preventDefault()}let m=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const w=t.exported.now(),C=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,m!==0&&m%Dc==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(C*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),l.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=l,this._delta-=m,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=ne.mousePos(this._el,l);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(m)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;if(this._delta!==0){const q=this._type==="wheel"&&Math.abs(this._delta)>Dc?this._wheelZoomRate:this._defaultZoomRate;let K=2/(1+Math.exp(-Math.abs(this._delta*q)));this._delta<0&&K!==0&&(K=1/K);const ee=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(ee*K))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,w=this._startZoom,C=this._easing;let D,U=!1;if(this._type==="wheel"&&w&&C){const q=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),K=C(q);D=t.number(w,m,K),q<1?this._frameId||(this._frameId=!0):U=!0}else D=m,U=!0;return this._active=!0,U&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!U,zoomDelta:D-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let m=t.ease;if(this._prevEase){const w=this._prevEase,C=(t.exported.now()-w.start)/w.duration,D=w.easing(C+.01)-w.easing(C),U=.27/Math.sqrt(D*D+1e-4)*.01,q=Math.sqrt(.0729-U*U);m=t.bezier(U,q,.25,1)}return this._prevEase={start:t.exported.now(),duration:l,easing:m},m}reset(){this._active=!1}}class Lc{constructor(l,m){this._clickZoom=l,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class bl{constructor(){this.reset()}reset(){this._active=!1}dblclick(l,m){return l.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:w.getZoom()+(l.shiftKey?-1:1),around:w.unproject(m)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class th{constructor(){this._tap=new Rh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(l,m,w){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?w.length>0&&(this._swipePoint=m[0],this._swipeTouch=w[0].identifier):this._tap.touchstart(l,m,w))}touchmove(l,m,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const C=m[0],D=C.y-this._swipePoint.y;return this._swipePoint=C,l.preventDefault(),this._active=!0,{zoomDelta:D/128}}}else this._tap.touchmove(l,m,w)}touchend(l,m,w){this._tapTime?this._swipePoint&&w.length===0&&this.reset():this._tap.touchend(l,m,w)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Do{constructor(l,m,w){this._el=l,this._mousePan=m,this._touchPan=w}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yo{constructor(l,m,w){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=m,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Fh{constructor(l,m,w,C){this._el=l,this._touchZoom=m,this._touchRotate=w,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Xa=S=>S.zoom||S.drag||S.pitch||S.rotate;class wl extends t.Event{}function Ta(S){return S.panDelta&&S.panDelta.mag()||S.zoomDelta||S.bearingDelta||S.pitchDelta}class ih{constructor(l,m){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Dh(l),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m),t.bindAll(["handleEvent","handleWindowEvent"],this);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,D,U]of this._listeners)ne.addEventListener(C,D,C===document?this.handleWindowEvent:this.handleEvent,U)}destroy(){for(const[l,m,w]of this._listeners)ne.removeEventListener(l,m,l===document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(l){const m=this._map,w=m.getCanvasContainer();this._add("mapEvent",new m1(m,l));const C=m.boxZoom=new Lh(m,l);this._add("boxZoom",C);const D=new Td,U=new bl;m.doubleClickZoom=new Lc(U,D),this._add("tapZoom",D),this._add("clickZoom",U);const q=new th;this._add("tapDragZoom",q);const K=m.touchPitch=new vl(m);this._add("touchPitch",K);const ee=new Xs(l),le=new Gi(l);m.dragRotate=new Yo(l,ee,le),this._add("mouseRotate",ee,["mousePitch"]),this._add("mousePitch",le,["mouseRotate"]);const me=new kc(l),be=new Bh(l,m);m.dragPan=new Do(w,me,be),this._add("mousePan",me),this._add("touchPan",be,["touchZoom","touchRotate"]);const qe=new _1,Oe=new Pi;m.touchZoomRotate=new Fh(w,Oe,qe,q),this._add("touchRotate",qe,["touchPan","touchZoom"]),this._add("touchZoom",Oe,["touchPan","touchRotate"]);const Fe=m.scrollZoom=new eh(m,this);this._add("scrollZoom",Fe,["mousePan"]);const ht=m.keyboard=new fu;this._add("keyboard",ht),this._add("blockableMapEvent",new ua(m));for(const vt of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[vt]&&m[vt].enable(l[vt])}_add(l,m,w){this._handlers.push({handlerName:l,handler:m,allowed:w}),this._handlersById[l]=m}stop(l){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Xa(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,m,w){for(const C in l)if(C!==w&&(!m||m.indexOf(C)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const m=[];for(const w of l)this._el.contains(w.target)&&m.push(w);return m}handleEvent(l,m){if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=l.type==="renderFrame"?void 0:l,C={needsRenderFrame:!1},D={},U={},q=l.touches,K=q?this._getMapTouches(q):void 0,ee=K?ne.touchPos(this._el,K):ne.mousePos(this._el,l);for(const{handlerName:be,handler:qe,allowed:Oe}of this._handlers){if(!qe.isEnabled())continue;let Fe;this._blockedByActive(U,Oe,be)?qe.reset():qe[m||l.type]&&(Fe=qe[m||l.type](l,ee,K),this.mergeHandlerResult(C,D,Fe,be,w),Fe&&Fe.needsRenderFrame&&this._triggerRenderFrame()),(Fe||qe.isActive())&&(U[be]=qe)}const le={};for(const be in this._previousActiveHandlers)U[be]||(le[be]=w);this._previousActiveHandlers=U,(Object.keys(le).length||Ta(C))&&(this._changes.push([C,D,le]),this._triggerRenderFrame()),(Object.keys(U).length||Ta(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:me}=C;me&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],me(this._map))}mergeHandlerResult(l,m,w,C,D){if(!w)return;t.extend(l,w);const U={handlerName:C,originalEvent:w.originalEvent||D};w.zoomDelta!==void 0&&(m.zoom=U),w.panDelta!==void 0&&(m.drag=U),w.pitchDelta!==void 0&&(m.pitch=U),w.bearingDelta!==void 0&&(m.rotate=U)}_applyChanges(){const l={},m={},w={};for(const[C,D,U]of this._changes)C.panDelta&&(l.panDelta=(l.panDelta||new t.pointGeometry(0,0))._add(C.panDelta)),C.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+C.pitchDelta),C.around!==void 0&&(l.around=C.around),C.pinchAround!==void 0&&(l.pinchAround=C.pinchAround),C.noInertia&&(l.noInertia=C.noInertia),t.extend(m,D),t.extend(w,U);this._updateMapTransform(l,m,w),this._changes=[]}_updateMapTransform(l,m,w){const C=this._map,D=C.transform,U=C.style&&C.style.terrain;if(!(Ta(l)||U&&this._drag))return this._fireEvents(m,w,!0);let{panDelta:q,zoomDelta:K,bearingDelta:ee,pitchDelta:le,around:me,pinchAround:be}=l;be!==void 0&&(me=be),C._stop(!0),me=me||C.transform.centerPoint;const qe=D.pointLocation(q?me.sub(q):me);ee&&(D.bearing+=ee),le&&(D.pitch+=le),K&&(D.zoom+=K),U?m.drag&&!this._drag?(this._drag={center:D.centerPoint,lngLat:D.pointLocation(me),point:me,handlerName:m.drag.handlerName},C.fire(new t.Event("freezeElevation",{freeze:!0}))):this._drag&&w[this._drag.handlerName]?(C.fire(new t.Event("freezeElevation",{freeze:!1})),this._drag=null):m.drag&&this._drag&&(D.center=D.pointLocation(D.centerPoint.sub(q))):D.setLocationAtPoint(qe,me),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(m,w,!0)}_fireEvents(l,m,w){const C=Xa(this._eventsInProgress),D=Xa(l),U={};for(const le in l){const{originalEvent:me}=l[le];this._eventsInProgress[le]||(U[`${le}start`]=me),this._eventsInProgress[le]=l[le]}!C&&D&&this._fireEvent("movestart",D.originalEvent);for(const le in U)this._fireEvent(le,U[le]);D&&this._fireEvent("move",D.originalEvent);for(const le in l){const{originalEvent:me}=l[le];this._fireEvent(le,me)}const q={};let K;for(const le in this._eventsInProgress){const{handlerName:me,originalEvent:be}=this._eventsInProgress[le];this._handlersById[me].isActive()||(delete this._eventsInProgress[le],K=m[me]||be,q[`${le}end`]=K)}for(const le in q)this._fireEvent(le,q[le]);const ee=Xa(this._eventsInProgress);if(w&&(C||D)&&!ee){this._updatingCamera=!0;const le=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),me=be=>be!==0&&-this._bearingSnap<be&&be<this._bearingSnap;le?(me(le.bearing||this._map.getBearing())&&(le.bearing=0),this._map.easeTo(le,{originalEvent:K})):(this._map.fire(new t.Event("moveend",{originalEvent:K})),me(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,m){this._map.fire(new t.Event(l,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new wl("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Jo={extend:(S,...l)=>t.extend(S,...l),run(S){S()},logToElement(S,l=!1,m="log"){const w=window.document.getElementById(m);w&&(l&&(w.innerHTML=""),w.innerHTML+=`<br>${S}`)}};class Cn extends t.Evented{constructor(l,m){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=m.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,m){return this.jumpTo({center:l},m)}panBy(l,m,w){return l=t.pointGeometry.convert(l).mult(-1),this.panTo(this.transform.center,t.extend({offset:l},m),w)}panTo(l,m,w){return this.easeTo(t.extend({center:l},m),w)}getZoom(){return this.transform.zoom}setZoom(l,m){return this.jumpTo({zoom:l},m),this}zoomTo(l,m,w){return this.easeTo(t.extend({zoom:l},m),w)}zoomIn(l,m){return this.zoomTo(this.getZoom()+1,l,m),this}zoomOut(l,m){return this.zoomTo(this.getZoom()-1,l,m),this}getBearing(){return this.transform.bearing}setBearing(l,m){return this.jumpTo({bearing:l},m),this}getPadding(){return this.transform.padding}setPadding(l,m){return this.jumpTo({padding:l},m),this}rotateTo(l,m,w){return this.easeTo(t.extend({bearing:l},m),w)}resetNorth(l,m){return this.rotateTo(0,t.extend({duration:1e3},l),m),this}resetNorthPitch(l,m){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},l),m),this}snapToNorth(l,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,m):this}getPitch(){return this.transform.pitch}setPitch(l,m){return this.jumpTo({pitch:l},m),this}cameraForBounds(l,m){l=t.LngLatBounds.convert(l);const w=m&&m.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),w,m)}_cameraForBoxAndBearing(l,m,w,C){const D={top:0,bottom:0,right:0,left:0};if(typeof(C=t.extend({padding:D,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding=="number"){const Bt=C.padding;C.padding={top:Bt,bottom:Bt,right:Bt,left:Bt}}C.padding=t.extend(D,C.padding);const U=this.transform,q=U.padding,K=U.project(t.LngLat.convert(l)),ee=U.project(t.LngLat.convert(m)),le=K.rotate(-w*Math.PI/180),me=ee.rotate(-w*Math.PI/180),be=new t.pointGeometry(Math.max(le.x,me.x),Math.max(le.y,me.y)),qe=new t.pointGeometry(Math.min(le.x,me.x),Math.min(le.y,me.y)),Oe=be.sub(qe),Fe=(U.width-(q.left+q.right+C.padding.left+C.padding.right))/Oe.x,ht=(U.height-(q.top+q.bottom+C.padding.top+C.padding.bottom))/Oe.y;if(ht<0||Fe<0)return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const vt=Math.min(U.scaleZoom(U.scale*Math.min(Fe,ht)),C.maxZoom),Pt=t.pointGeometry.convert(C.offset),Ke=new t.pointGeometry((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(w*Math.PI/180),Rt=Pt.add(Ke).mult(U.scale/U.zoomScale(vt));return{center:U.unproject(K.add(ee).div(2).sub(Rt)),zoom:vt,bearing:w}}fitBounds(l,m,w){return this._fitInternal(this.cameraForBounds(l,m),m,w)}fitScreenCoordinates(l,m,w,C,D){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(l)),this.transform.pointLocation(t.pointGeometry.convert(m)),w,C),C,D)}_fitInternal(l,m,w){return l?(delete(m=t.extend(l,m)).padding,m.linear?this.easeTo(m,w):this.flyTo(m,w)):this}jumpTo(l,m){this.stop();const w=this.transform;let C=!1,D=!1,U=!1;return"zoom"in l&&w.zoom!==+l.zoom&&(C=!0,w.zoom=+l.zoom),l.center!==void 0&&(w.center=t.LngLat.convert(l.center)),"bearing"in l&&w.bearing!==+l.bearing&&(D=!0,w.bearing=+l.bearing),"pitch"in l&&w.pitch!==+l.pitch&&(U=!0,w.pitch=+l.pitch),l.padding==null||w.isPaddingEqual(l.padding)||(w.padding=l.padding),this.fire(new t.Event("movestart",m)).fire(new t.Event("move",m)),C&&this.fire(new t.Event("zoomstart",m)).fire(new t.Event("zoom",m)).fire(new t.Event("zoomend",m)),D&&this.fire(new t.Event("rotatestart",m)).fire(new t.Event("rotate",m)).fire(new t.Event("rotateend",m)),U&&this.fire(new t.Event("pitchstart",m)).fire(new t.Event("pitch",m)).fire(new t.Event("pitchend",m)),this.fire(new t.Event("moveend",m))}calculateCameraOptionsFromTo(l,m,w,C=0){const D=t.MercatorCoordinate.fromLngLat(l,m),U=t.MercatorCoordinate.fromLngLat(w,C),q=U.x-D.x,K=U.y-D.y,ee=U.z-D.z,le=Math.hypot(q,K,ee);if(le===0)throw new Error("Can't calculate camera options with same From and To");const me=Math.hypot(q,K),be=this.transform.scaleZoom(this.transform.cameraToCenterDistance/le/this.transform.tileSize),qe=180*Math.atan2(q,-K)/Math.PI;let Oe=180*Math.acos(me/le)/Math.PI;return Oe=ee<0?90-Oe:90+Oe,{center:U.toLngLat(),zoom:be,pitch:Oe,bearing:qe}}easeTo(l,m){this._stop(!1,l.easeId),((l=t.extend({offset:[0,0],duration:500,easing:t.ease},l)).animate===!1||!l.essential&&t.exported.prefersReducedMotion)&&(l.duration=0);const w=this.transform,C=this.getZoom(),D=this.getBearing(),U=this.getPitch(),q=this.getPadding(),K="zoom"in l?+l.zoom:C,ee="bearing"in l?this._normalizeBearing(l.bearing,D):D,le="pitch"in l?+l.pitch:U,me="padding"in l?l.padding:w.padding,be=t.pointGeometry.convert(l.offset);let qe=w.centerPoint.add(be);const Oe=w.pointLocation(qe),Fe=t.LngLat.convert(l.center||Oe);this._normalizeCenter(Fe);const ht=w.project(Oe),vt=w.project(Fe).sub(ht),Pt=w.zoomScale(K-C);let Ke,Rt;l.around&&(Ke=t.LngLat.convert(l.around),Rt=w.locationPoint(Ke));const Bt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||K!==C,this._rotating=this._rotating||D!==ee,this._pitching=this._pitching||le!==U,this._padding=!w.isPaddingEqual(me),this._easeId=l.easeId,this._prepareEase(m,l.noMoveStart,Bt),this._ease(ii=>{if(this._zooming&&(w.zoom=t.number(C,K,ii)),this._rotating&&(w.bearing=t.number(D,ee,ii)),this._pitching&&(w.pitch=t.number(U,le,ii)),this._padding&&(w.interpolatePadding(q,me,ii),qe=w.centerPoint.add(be)),Ke)w.setLocationAtPoint(Ke,Rt);else{const Yt=w.zoomScale(w.zoom-C),di=K>C?Math.min(2,Pt):Math.max(.5,Pt),Wt=Math.pow(di,1-ii),Ui=w.unproject(ht.add(vt.mult(ii*Wt)).mult(Yt));w.setLocationAtPoint(w.renderWorldCopies?Ui.wrap():Ui,qe)}this._fireMoveEvents(m)},ii=>{this._afterEase(m,ii)},l),this}_prepareEase(l,m,w={}){this._moving=!0,this.fire(new t.Event("freezeElevation",{freeze:!0})),m||w.moving||this.fire(new t.Event("movestart",l)),this._zooming&&!w.zooming&&this.fire(new t.Event("zoomstart",l)),this._rotating&&!w.rotating&&this.fire(new t.Event("rotatestart",l)),this._pitching&&!w.pitching&&this.fire(new t.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new t.Event("move",l)),this._zooming&&this.fire(new t.Event("zoom",l)),this._rotating&&this.fire(new t.Event("rotate",l)),this._pitching&&this.fire(new t.Event("pitch",l))}_afterEase(l,m){if(this._easeId&&m&&this._easeId===m)return;delete this._easeId,this.fire(new t.Event("freezeElevation",{freeze:!1}));const w=this._zooming,C=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new t.Event("zoomend",l)),C&&this.fire(new t.Event("rotateend",l)),D&&this.fire(new t.Event("pitchend",l)),this.fire(new t.Event("moveend",l))}flyTo(l,m){if(!l.essential&&t.exported.prefersReducedMotion){const ir=t.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ir,m)}this.stop(),l=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},l);const w=this.transform,C=this.getZoom(),D=this.getBearing(),U=this.getPitch(),q=this.getPadding(),K="zoom"in l?t.clamp(+l.zoom,w.minZoom,w.maxZoom):C,ee="bearing"in l?this._normalizeBearing(l.bearing,D):D,le="pitch"in l?+l.pitch:U,me="padding"in l?l.padding:w.padding,be=w.zoomScale(K-C),qe=t.pointGeometry.convert(l.offset);let Oe=w.centerPoint.add(qe);const Fe=w.pointLocation(Oe),ht=t.LngLat.convert(l.center||Fe);this._normalizeCenter(ht);const vt=w.project(Fe),Pt=w.project(ht).sub(vt);let Ke=l.curve;const Rt=Math.max(w.width,w.height),Bt=Rt/be,ii=Pt.mag();if("minZoom"in l){const ir=t.clamp(Math.min(l.minZoom,C,K),w.minZoom,w.maxZoom),pi=Rt/w.zoomScale(ir-C);Ke=Math.sqrt(pi/ii*2)}const Yt=Ke*Ke;function di(ir){const pi=(Bt*Bt-Rt*Rt+(ir?-1:1)*Yt*Yt*ii*ii)/(2*(ir?Bt:Rt)*Yt*ii);return Math.log(Math.sqrt(pi*pi+1)-pi)}function Wt(ir){return(Math.exp(ir)-Math.exp(-ir))/2}function Ui(ir){return(Math.exp(ir)+Math.exp(-ir))/2}const Ft=di(0);let qi=function(ir){return Ui(Ft)/Ui(Ft+Ke*ir)},Er=function(ir){return Rt*((Ui(Ft)*(Wt(pi=Ft+Ke*ir)/Ui(pi))-Wt(Ft))/Yt)/ii;var pi},Sr=(di(1)-Ft)/Ke;if(Math.abs(ii)<1e-6||!isFinite(Sr)){if(Math.abs(Rt-Bt)<1e-6)return this.easeTo(l,m);const ir=Bt<Rt?-1:1;Sr=Math.abs(Math.log(Bt/Rt))/Ke,Er=function(){return 0},qi=function(pi){return Math.exp(ir*Ke*pi)}}return l.duration="duration"in l?+l.duration:1e3*Sr/("screenSpeed"in l?+l.screenSpeed/Ke:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=D!==ee,this._pitching=le!==U,this._padding=!w.isPaddingEqual(me),this._prepareEase(m,!1),this._ease(ir=>{const pi=ir*Sr,cn=1/qi(pi);w.zoom=ir===1?K:C+w.scaleZoom(cn),this._rotating&&(w.bearing=t.number(D,ee,ir)),this._pitching&&(w.pitch=t.number(U,le,ir)),this._padding&&(w.interpolatePadding(q,me,ir),Oe=w.centerPoint.add(qe));const Yr=ir===1?ht:w.unproject(vt.add(Pt.mult(Er(pi))).mult(cn));w.setLocationAtPoint(w.renderWorldCopies?Yr.wrap():Yr,Oe),this._fireMoveEvents(m)},()=>this._afterEase(m),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,m)}if(!l){const w=this.handlers;w&&w.stop(!1)}return this}_ease(l,m,w){w.animate===!1||w.duration===0?(l(1),m()):(this._easeStart=t.exported.now(),this._easeOptions=w,this._onEaseFrame=l,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,m){l=t.wrap(l,-180,180);const w=Math.abs(l-m);return Math.abs(l-360-m)<w&&(l-=360),Math.abs(l+360-m)<w&&(l+=360),l}_normalizeCenter(l){const m=this.transform;if(!m.renderWorldCopies||m.lngRange)return;const w=l.lng-m.center.lng;l.lng+=w>180?-360:w<-180?360:0}}class Tl{constructor(l={}){this.options=l,t.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options&&this.options.compact,this._container=ne.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ne.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ne.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ne.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,m){const w=this._map._getUIString(`AttributionControl.${m}`);l.title=w,l.setAttribute("aria-label",w)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(C=>typeof C!="string"?"":C)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const m=this._map.style.sourceCaches;for(const C in m){const D=m[C];if(D.used||D.usedForTerrain){const U=D.getSource();U.attribution&&l.indexOf(U.attribution)<0&&l.push(U.attribution)}}l=l.filter(C=>String(C).trim()),l.sort((C,D)=>C.length-D.length),l=l.filter((C,D)=>{for(let U=D+1;U<l.length;U++)if(l[U].indexOf(C)>=0)return!1;return!0});const w=l.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,l.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class ic{constructor(l={}){this.options=l,t.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=ne.create("div","maplibregl-ctrl mapboxgl-ctrl");const m=ne.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://maplibre.org/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ne.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const l=this._container.children;if(l.length){const m=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&m.classList.add("maplibregl-compact","mapboxgl-compact"):m.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Fi{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const m=++this._id;return this._queue.push({callback:l,id:m,cancelled:!1}),m}remove(l){const m=this._currentlyRunning,w=m?this._queue.concat(m):this._queue;for(const C of w)if(C.id===l)return void(C.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const m=this._currentlyRunning=this._queue;this._queue=[];for(const w of m)if(!w.cancelled&&(w.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Hs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Oh={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},mu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ss{constructor(l,m,w=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new Xs({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,w&&(this.mousePitch=new Gi({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ne.addEventListener(m,"mousedown",this.mousedown),ne.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),ne.addEventListener(m,"touchmove",this.touchmove),ne.addEventListener(m,"touchend",this.touchend),ne.addEventListener(m,"touchcancel",this.reset)}down(l,m){this.mouseRotate.mousedown(l,m),this.mousePitch&&this.mousePitch.mousedown(l,m),ne.disableDrag()}move(l,m){const w=this.map,C=this.mouseRotate.mousemoveWindow(l,m);if(C&&C.bearingDelta&&w.setBearing(w.getBearing()+C.bearingDelta),this.mousePitch){const D=this.mousePitch.mousemoveWindow(l,m);D&&D.pitchDelta&&w.setPitch(w.getPitch()+D.pitchDelta)}}off(){const l=this.element;ne.removeEventListener(l,"mousedown",this.mousedown),ne.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),ne.removeEventListener(l,"touchmove",this.touchmove),ne.removeEventListener(l,"touchend",this.touchend),ne.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){ne.enableDrag(),ne.removeEventListener(window,"mousemove",this.mousemove),ne.removeEventListener(window,"mouseup",this.mouseup)}mousedown(l){this.down(t.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),ne.mousePos(this.element,l)),ne.addEventListener(window,"mousemove",this.mousemove),ne.addEventListener(window,"mouseup",this.mouseup)}mousemove(l){this.move(l,ne.mousePos(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ne.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=ne.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function ro(S,l,m){if(S=new t.LngLat(S.lng,S.lat),l){const w=new t.LngLat(S.lng-360,S.lat),C=new t.LngLat(S.lng+360,S.lat),D=m.locationPoint(S).distSqr(l);m.locationPoint(w).distSqr(l)<D?S=w:m.locationPoint(C).distSqr(l)<D&&(S=C)}for(;Math.abs(S.lng-m.center.lng)>180;){const w=m.locationPoint(S);if(w.x>=0&&w.y>=0&&w.x<=m.width&&w.y<=m.height)break;S.lng>m.center.lng?S.lng-=360:S.lng+=360}return S}const Ji={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function dr(S,l,m){const w=S.classList;for(const C in Ji)w.remove(`maplibregl-${m}-anchor-${C}`,`mapboxgl-${m}-anchor-${C}`);w.add(`maplibregl-${m}-anchor-${l}`,`mapboxgl-${m}-anchor-${l}`)}class El extends t.Evented{constructor(l,m){if(super(),(l instanceof HTMLElement||m)&&(l=t.extend({element:l},m)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=t.pointGeometry.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=ne.create("div"),this._element.setAttribute("aria-label","Map marker");const w=ne.createNS("http://www.w3.org/2000/svg","svg"),C=41,D=27;w.setAttributeNS(null,"display","block"),w.setAttributeNS(null,"height",`${C}px`),w.setAttributeNS(null,"width",`${D}px`),w.setAttributeNS(null,"viewBox",`0 0 ${D} ${C}`);const U=ne.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"stroke","none"),U.setAttributeNS(null,"stroke-width","1"),U.setAttributeNS(null,"fill","none"),U.setAttributeNS(null,"fill-rule","evenodd");const q=ne.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill-rule","nonzero");const K=ne.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(3.0, 29.0)"),K.setAttributeNS(null,"fill","#000000");const ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pt of ee){const Ke=ne.createNS("http://www.w3.org/2000/svg","ellipse");Ke.setAttributeNS(null,"opacity","0.04"),Ke.setAttributeNS(null,"cx","10.5"),Ke.setAttributeNS(null,"cy","5.80029008"),Ke.setAttributeNS(null,"rx",Pt.rx),Ke.setAttributeNS(null,"ry",Pt.ry),K.appendChild(Ke)}const le=ne.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"fill",this._color);const me=ne.createNS("http://www.w3.org/2000/svg","path");me.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),le.appendChild(me);const be=ne.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"opacity","0.25"),be.setAttributeNS(null,"fill","#000000");const qe=ne.createNS("http://www.w3.org/2000/svg","path");qe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),be.appendChild(qe);const Oe=ne.createNS("http://www.w3.org/2000/svg","g");Oe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Oe.setAttributeNS(null,"fill","#FFFFFF");const Fe=ne.createNS("http://www.w3.org/2000/svg","g");Fe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ht=ne.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#000000"),ht.setAttributeNS(null,"opacity","0.25"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962");const vt=ne.createNS("http://www.w3.org/2000/svg","circle");vt.setAttributeNS(null,"fill","#FFFFFF"),vt.setAttributeNS(null,"cx","5.5"),vt.setAttributeNS(null,"cy","5.5"),vt.setAttributeNS(null,"r","5.4999962"),Fe.appendChild(ht),Fe.appendChild(vt),q.appendChild(K),q.appendChild(le),q.appendChild(be),q.appendChild(Oe),q.appendChild(Fe),w.appendChild(q),w.setAttributeNS(null,"height",C*this._scale+"px"),w.setAttributeNS(null,"width",D*this._scale+"px"),this._element.appendChild(w),this._offset=t.pointGeometry.convert(l&&l.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()}),dr(this._element,this._anchor,"marker"),this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ne.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=t.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const C=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(l){const m=l.code,w=l.charCode||l.keyCode;m!=="Space"&&m!=="Enter"&&w!==32&&w!==13||this.togglePopup()}_onMapClick(l){const m=l.originalEvent.target,w=this._element;this._popup&&(m===w||w.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this}_update(l){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=ro(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),l&&l.type!=="moveend"||(this._pos=this._pos.round()),ne.setTransform(this._element,`${Ji[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${m}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const C=this._map.unproject(this._pos),D=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=C.distanceTo(this._lngLat)>20*D?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(l){return this._offset=t.pointGeometry.convert(l),this._update(),this}_onMove(l){if(!this._isDragging){const m=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Rc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ha,ho=0,Fs=!1;const Ks={maxWidth:100,unit:"metric"};function g1(S,l,m){const w=m&&m.maxWidth||100,C=S._container.clientHeight/2,D=S.unproject([0,C]),U=S.unproject([w,C]),q=D.distanceTo(U);if(m&&m.unit==="imperial"){const K=3.2808*q;K>5280?Ka(l,w,K/5280,S._getUIString("ScaleControl.Miles")):Ka(l,w,K,S._getUIString("ScaleControl.Feet"))}else m&&m.unit==="nautical"?Ka(l,w,q/1852,S._getUIString("ScaleControl.NauticalMiles")):q>=1e3?Ka(l,w,q/1e3,S._getUIString("ScaleControl.Kilometers")):Ka(l,w,q,S._getUIString("ScaleControl.Meters"))}function Ka(S,l,m,w){const C=function(D){const U=Math.pow(10,`${Math.floor(D)}`.length-1);let q=D/U;return q=q>=10?10:q>=5?5:q>=3?3:q>=2?2:q>=1?1:function(K){const ee=Math.pow(10,Math.ceil(-Math.log(K)/Math.LN10));return Math.round(K*ee)/ee}(q),U*q}(m);S.style.width=l*(C/m)+"px",S.innerHTML=`${C}&nbsp;${w}`}const Dn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},no=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function _u(S){if(S){if(typeof S=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(S,2)));return{center:new t.pointGeometry(0,0),top:new t.pointGeometry(0,S),"top-left":new t.pointGeometry(l,l),"top-right":new t.pointGeometry(-l,l),bottom:new t.pointGeometry(0,-S),"bottom-left":new t.pointGeometry(l,-l),"bottom-right":new t.pointGeometry(-l,-l),left:new t.pointGeometry(S,0),right:new t.pointGeometry(-S,0)}}if(S instanceof t.pointGeometry||Array.isArray(S)){const l=t.pointGeometry.convert(S);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:t.pointGeometry.convert(S.center||[0,0]),top:t.pointGeometry.convert(S.top||[0,0]),"top-left":t.pointGeometry.convert(S["top-left"]||[0,0]),"top-right":t.pointGeometry.convert(S["top-right"]||[0,0]),bottom:t.pointGeometry.convert(S.bottom||[0,0]),"bottom-left":t.pointGeometry.convert(S["bottom-left"]||[0,0]),"bottom-right":t.pointGeometry.convert(S["bottom-right"]||[0,0]),left:t.pointGeometry.convert(S.left||[0,0]),right:t.pointGeometry.convert(S.right||[0,0])}}return _u(new t.pointGeometry(0,0))}const Ya={supported:j,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends Cn{constructor(S){var l;if(t.PerformanceUtils.mark(t.PerformanceMarkers.create),(S=t.extend({},Oh,S)).minZoom!=null&&S.maxZoom!=null&&S.minZoom>S.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(S.minPitch!=null&&S.maxPitch!=null&&S.minPitch>S.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(S.minPitch!=null&&S.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(S.maxPitch!=null&&S.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new gl(S.minZoom,S.maxZoom,S.minPitch,S.maxPitch,S.renderWorldCopies),{bearingSnap:S.bearingSnap}),this._interactive=S.interactive,this._cooperativeGestures=S.cooperativeGestures,this._maxTileCacheSize=S.maxTileCacheSize,this._failIfMajorPerformanceCaveat=S.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=S.preserveDrawingBuffer,this._antialias=S.antialias,this._trackResize=S.trackResize,this._bearingSnap=S.bearingSnap,this._refreshExpiredTiles=S.refreshExpiredTiles,this._fadeDuration=S.fadeDuration,this._crossSourceCollisions=S.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=S.collectResourceTiming,this._renderTaskQueue=new Fi,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},Hs,S.locale),this._clickTolerance=S.clickTolerance,this._pixelRatio=(l=S.pixelRatio)!==null&&l!==void 0?l:devicePixelRatio,this._requestManager=new Ye(S.transformRequest),typeof S.container=="string"){if(this._container=document.getElementById(S.container),!this._container)throw new Error(`Container '${S.container}' not found.`)}else{if(!(S.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=S.container}if(S.maxBounds&&this.setMaxBounds(S.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ih(this,S),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=S.hash&&new zh(typeof S.hash=="string"&&S.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch}),S.bounds&&(this.resize(),this.fitBounds(S.bounds,t.extend({},S.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=S.localIdeographFontFamily,S.style&&this.setStyle(S.style,{localIdeographFontFamily:S.localIdeographFontFamily}),S.attributionControl&&this.addControl(new Tl({customAttribution:S.customAttribution})),S.maplibreLogo&&this.addControl(new ic,S.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",m=>{this._update(m.dataType==="style"),this.fire(new t.Event(`${m.dataType}data`,m))}),this.on("dataloading",m=>{this.fire(new t.Event(`${m.dataType}dataloading`,m))}),this.on("dataabort",m=>{this.fire(new t.Event("sourcedataabort",m))})}_getMapId(){return this._mapId}addControl(S,l){if(l===void 0&&(l=S.getDefaultPosition?S.getDefaultPosition():"top-right"),!S||!S.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=S.onAdd(this);this._controls.push(S);const w=this._controlPositions[l];return l.indexOf("bottom")!==-1?w.insertBefore(m,w.firstChild):w.appendChild(m),this}removeControl(S){if(!S||!S.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(S);return l>-1&&this._controls.splice(l,1),S.onRemove(this),this}hasControl(S){return this._controls.indexOf(S)>-1}calculateCameraOptionsFromTo(S,l,m,w){return w==null&&this.style.terrain&&(w=this.transform.getElevation(m,this.style.terrain)),super.calculateCameraOptionsFromTo(S,l,m,w)}resize(S){const l=this._containerDimensions(),m=l[0],w=l[1];this._resizeCanvas(m,w,this.getPixelRatio()),this.transform.resize(m,w),this.painter.resize(m,w,this.getPixelRatio());const C=!this._moving;return C&&(this.stop(),this.fire(new t.Event("movestart",S)).fire(new t.Event("move",S))),this.fire(new t.Event("resize",S)),C&&this.fire(new t.Event("moveend",S)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(S){const[l,m]=this._containerDimensions();this._pixelRatio=S,this._resizeCanvas(l,m,S),this.painter.resize(l,m,S)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(S){return this.transform.setMaxBounds(t.LngLatBounds.convert(S)),this._update()}setMinZoom(S){if((S=S??-2)>=-2&&S<=this.transform.maxZoom)return this.transform.minZoom=S,this._update(),this.getZoom()<S&&this.setZoom(S),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(S){if((S=S??22)>=this.transform.minZoom)return this.transform.maxZoom=S,this._update(),this.getZoom()>S&&this.setZoom(S),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(S){if((S=S??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(S>=0&&S<=this.transform.maxPitch)return this.transform.minPitch=S,this._update(),this.getPitch()<S&&this.setPitch(S),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(S){if((S=S??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(S>=this.transform.minPitch)return this.transform.maxPitch=S,this._update(),this.getPitch()>S&&this.setPitch(S),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(S){return this.transform.renderWorldCopies=S,this._update()}project(S){return this.transform.locationPoint(t.LngLat.convert(S),this.style&&this.style.terrain)}unproject(S){return this.transform.pointLocation(t.pointGeometry.convert(S),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(S,l,m){if(S==="mouseenter"||S==="mouseover"){let w=!1;return{layer:l,listener:m,delegates:{mousemove:D=>{const U=this.getLayer(l)?this.queryRenderedFeatures(D.point,{layers:[l]}):[];U.length?w||(w=!0,m.call(this,new ls(S,this,D.originalEvent,{features:U}))):w=!1},mouseout:()=>{w=!1}}}}if(S==="mouseleave"||S==="mouseout"){let w=!1;return{layer:l,listener:m,delegates:{mousemove:U=>{(this.getLayer(l)?this.queryRenderedFeatures(U.point,{layers:[l]}):[]).length?w=!0:w&&(w=!1,m.call(this,new ls(S,this,U.originalEvent)))},mouseout:U=>{w&&(w=!1,m.call(this,new ls(S,this,U.originalEvent)))}}}}{const w=C=>{const D=this.getLayer(l)?this.queryRenderedFeatures(C.point,{layers:[l]}):[];D.length&&(C.features=D,m.call(this,C),delete C.features)};return{layer:l,listener:m,delegates:{[S]:w}}}}on(S,l,m){if(m===void 0)return super.on(S,l);const w=this._createDelegatedListener(S,l,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[S]=this._delegatedListeners[S]||[],this._delegatedListeners[S].push(w);for(const C in w.delegates)this.on(C,w.delegates[C]);return this}once(S,l,m){if(m===void 0)return super.once(S,l);const w=this._createDelegatedListener(S,l,m);for(const C in w.delegates)this.once(C,w.delegates[C]);return this}off(S,l,m){return m===void 0?super.off(S,l):(this._delegatedListeners&&this._delegatedListeners[S]&&(w=>{const C=this._delegatedListeners[S];for(let D=0;D<C.length;D++){const U=C[D];if(U.layer===l&&U.listener===m){for(const q in U.delegates)this.off(q,U.delegates[q]);return C.splice(D,1),this}}})(),this)}queryRenderedFeatures(S,l){if(!this.style)return[];let m;if(l!==void 0||S===void 0||S instanceof t.pointGeometry||Array.isArray(S)||(l=S,S=void 0),l=l||{},(S=S||[[0,0],[this.transform.width,this.transform.height]])instanceof t.pointGeometry||typeof S[0]=="number")m=[t.pointGeometry.convert(S)];else{const w=t.pointGeometry.convert(S[0]),C=t.pointGeometry.convert(S[1]);m=[w,new t.pointGeometry(C.x,w.y),C,new t.pointGeometry(w.x,C.y),w]}return this.style.queryRenderedFeatures(m,l,this.transform)}querySourceFeatures(S,l){return this.style.querySourceFeatures(S,l)}setStyle(S,l){return(l=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&S?(this._diffStyle(S,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(S,l))}setTransformRequest(S){return this._requestManager.setTransformRequest(S),this}_getUIString(S){const l=this._locale[S];if(l==null)throw new Error(`Missing UI string '${S}'`);return l}_updateStyle(S,l){return this.style&&(this.style.setEventedParent(null),this.style._remove()),S?(this.style=new Tn(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof S=="string"?this.style.loadURL(S):this.style.loadJSON(S),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Tn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(S,l){if(typeof S=="string"){const m=this._requestManager.transformRequest(S,t.ResourceType.Style);t.getJSON(m,(w,C)=>{w?this.fire(new t.ErrorEvent(w)):C&&this._updateDiff(C,l)})}else typeof S=="object"&&this._updateDiff(S,l)}_updateDiff(S,l){try{this.style.setState(S)&&this._update(!0)}catch(m){t.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(S,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}addSource(S,l){return this._lazyInitEmptyStyle(),this.style.addSource(S,l),this._update(!0)}isSourceLoaded(S){const l=this.style&&this.style.sourceCaches[S];if(l!==void 0)return l.loaded();this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${S}'`)))}setTerrain(S){return this.style.setTerrain(S),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const S=this.style&&this.style.sourceCaches;for(const l in S){const m=S[l]._tiles;for(const w in m){const C=m[w];if(C.state!=="loaded"&&C.state!=="errored")return!1}}return!0}addSourceType(S,l,m){return this._lazyInitEmptyStyle(),this.style.addSourceType(S,l,m)}removeSource(S){return this.style.removeSource(S),this._update(!0)}getSource(S){return this.style.getSource(S)}addImage(S,l,{pixelRatio:m=1,sdf:w=!1,stretchX:C,stretchY:D,content:U}={}){if(this._lazyInitEmptyStyle(),l instanceof HTMLImageElement||t.isImageBitmap(l)){const{width:q,height:K,data:ee}=t.exported.getImageData(l);this.style.addImage(S,{data:new t.RGBAImage({width:q,height:K},ee),pixelRatio:m,stretchX:C,stretchY:D,content:U,sdf:w,version:0})}else{if(l.width===void 0||l.height===void 0)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:q,height:K,data:ee}=l,le=l;this.style.addImage(S,{data:new t.RGBAImage({width:q,height:K},new Uint8Array(ee)),pixelRatio:m,stretchX:C,stretchY:D,content:U,sdf:w,version:0,userImage:le}),le.onAdd&&le.onAdd(this,S)}}}updateImage(S,l){const m=this.style.getImage(S);if(!m)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=l instanceof HTMLImageElement||t.isImageBitmap(l)?t.exported.getImageData(l):l,{width:C,height:D,data:U}=w;if(C===void 0||D===void 0)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==m.data.width||D!==m.data.height)return this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const q=!(l instanceof HTMLImageElement||t.isImageBitmap(l));m.data.replace(U,q),this.style.updateImage(S,m)}hasImage(S){return S?!!this.style.getImage(S):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(S){this.style.removeImage(S)}loadImage(S,l){t.getImage(this._requestManager.transformRequest(S,t.ResourceType.Image),l)}listImages(){return this.style.listImages()}addLayer(S,l){return this._lazyInitEmptyStyle(),this.style.addLayer(S,l),this._update(!0)}moveLayer(S,l){return this.style.moveLayer(S,l),this._update(!0)}removeLayer(S){return this.style.removeLayer(S),this._update(!0)}getLayer(S){return this.style.getLayer(S)}setLayerZoomRange(S,l,m){return this.style.setLayerZoomRange(S,l,m),this._update(!0)}setFilter(S,l,m={}){return this.style.setFilter(S,l,m),this._update(!0)}getFilter(S){return this.style.getFilter(S)}setPaintProperty(S,l,m,w={}){return this.style.setPaintProperty(S,l,m,w),this._update(!0)}getPaintProperty(S,l){return this.style.getPaintProperty(S,l)}setLayoutProperty(S,l,m,w={}){return this.style.setLayoutProperty(S,l,m,w),this._update(!0)}getLayoutProperty(S,l){return this.style.getLayoutProperty(S,l)}setLight(S,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(S,l),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(S,l){return this.style.setFeatureState(S,l),this._update()}removeFeatureState(S,l){return this.style.removeFeatureState(S,l),this._update()}getFeatureState(S){return this.style.getFeatureState(S)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let S=0,l=0;return this._container&&(S=this._container.clientWidth||400,l=this._container.clientHeight||300),[S,l]}_setupContainer(){const S=this._container;S.classList.add("maplibregl-map","mapboxgl-map");const l=this._canvasContainer=ne.create("div","maplibregl-canvas-container mapboxgl-canvas-container",S);this._interactive&&l.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=ne.create("canvas","maplibregl-canvas mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const m=this._containerDimensions();this._resizeCanvas(m[0],m[1],this.getPixelRatio());const w=this._controlContainer=ne.create("div","maplibregl-control-container mapboxgl-control-container",S),C=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(D=>{C[D]=ne.create("div",`maplibregl-ctrl-${D} mapboxgl-ctrl-${D}`,w)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const S=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=ne.create("div","maplibregl-cooperative-gesture-screen",S);let l="Control",m=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(m=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",l="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${m}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",w=>{w.key===l&&(this._metaPress=!0)}),document.addEventListener("keyup",w=>{w.key===l&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",w=>{this._onCooperativeGesture(w,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(S,l,m){this._canvas.width=m*S,this._canvas.height=m*l,this._canvas.style.width=`${S}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const S=t.extend({},j.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl",S)||this._canvas.getContext("experimental-webgl",S);l?(this.painter=new cu(l,this.transform),t.exported$1.testSupport(l)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(S){S.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:S}))}_contextRestored(S){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:S}))}_onMapScroll(S){if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(S,l,m){return!l&&m<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(S){return this.style?(this._styleDirty=this._styleDirty||S,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(S){return this._update(),this._renderTaskQueue.add(S)}_cancelRenderFrame(S){this._renderTaskQueue.remove(S)}_render(S){let l,m=0;const w=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(l=w.createQueryEXT(),w.beginQueryEXT(w.TIME_ELAPSED_EXT,l),m=t.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(S),this._removed)return;let C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,q=t.exported.now();this.style.zoomHistory.update(U,q);const K=new t.EvaluationParameters(U,{now:q,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ee=K.crossFadingFactor();ee===1&&ee===this._crossFadingFactor||(C=!0,this._crossFadingFactor=ee),this.style.update(K)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.PerformanceUtils.mark(t.PerformanceMarkers.load),this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const U=t.exported.now()-m;w.endQueryEXT(w.TIME_ELAPSED_EXT,l),setTimeout(()=>{const q=w.getQueryObjectEXT(l,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(l),this.fire(new t.Event("gpu-timing-frame",{cpuTime:U,gpuTime:q}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const q=this.painter.queryGpuTimers(U);this.fire(new t.Event("gpu-timing-layer",{layerTimes:q}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty;return D||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,t.PerformanceUtils.mark(t.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const S=this.painter.context.gl.getExtension("WEBGL_lose_context");S&&S.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ne.remove(this._canvasContainer),ne.remove(this._controlContainer),this._cooperativeGestures&&ne.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),t.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=t.exported.frame(S=>{t.PerformanceUtils.frame(S),this._frame=null,this._render(S)}))}_onWindowOnline(){this._update()}_onWindowResize(S){this._trackResize&&this.resize({originalEvent:S})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(S){this._showTileBoundaries!==S&&(this._showTileBoundaries=S,this._update())}get showPadding(){return!!this._showPadding}set showPadding(S){this._showPadding!==S&&(this._showPadding=S,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(S){this._showCollisionBoxes!==S&&(this._showCollisionBoxes=S,S?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(S){this._showOverdrawInspector!==S&&(this._showOverdrawInspector=S,this._update())}get repaint(){return!!this._repaint}set repaint(S){this._repaint!==S&&(this._repaint=S,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(S){this._vertices=S,this._update()}_setCacheLimits(S,l){t.setCacheLimits(S,l)}get version(){return"2.4.0"}},NavigationControl:class{constructor(S){this.options=t.extend({},mu,S),this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const S=this._map.getZoom(),l=S===this._map.getMaxZoom(),m=S===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const S=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=S}onAdd(S){return this._map=S,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ss(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ne.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(S,l){const m=ne.create("button",S,this._container);return m.type="button",m.addEventListener("click",l),m}_setButtonTitle(S,l){const m=this._map._getUIString(`NavigationControl.${l}`);S.title=m,S.setAttribute("aria-label",m)}},GeolocateControl:class extends t.Evented{constructor(S){super(),this.options=t.extend({},Rc,S),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(S){var l;return this._map=S,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Ha!==void 0?l(Ha):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(m=>{Ha=m.state!=="denied",l(Ha)}):(Ha=!!window.navigator.geolocation,l(Ha)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ne.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ho=0,Fs=!1}_isOutOfMapMaxBounds(S){const l=this._map.getMaxBounds(),m=S.coords;return l&&(m.longitude<l.getWest()||m.longitude>l.getEast()||m.latitude<l.getSouth()||m.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(S){if(this._map){if(this._isOutOfMapMaxBounds(S))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",S)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=S,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(S),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(S),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",S)),this._finish()}}_updateCamera(S){const l=new t.LngLat(S.coords.longitude,S.coords.latitude),m=S.coords.accuracy,w=this._map.getBearing(),C=t.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(m),C,{geolocateSource:!0})}_updateMarker(S){if(S){const l=new t.LngLat(S.coords.longitude,S.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=S.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const S=this._map._container.clientHeight/2,l=this._map.unproject([0,S]),m=this._map.unproject([1,S]),w=l.distanceTo(m),C=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=`${C}px`,this._circleElement.style.height=`${C}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(S){if(this._map){if(this.options.trackUserLocation)if(S.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(S.code===3&&Fs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",S)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(S){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=ne.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",S===!1){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ne.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new El(this._dotElement),this._circleElement=ne.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new El({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ho--,Fs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let S;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ho++,ho>1?(S={maximumAge:6e5,timeout:0},Fs=!0):(S=this.options.positionOptions,Fs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,S)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Tl,LogoControl:ic,ScaleControl:class{constructor(S){this.options=t.extend({},Ks,S),t.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){g1(this._map,this._container,this.options)}onAdd(S){return this._map=S,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",S.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ne.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(S){this.options.unit=S,g1(this._map,this._container,this.options)}},FullscreenControl:class{constructor(S){this._fullscreen=!1,S&&S.container&&(S.container instanceof HTMLElement?this._container=S.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(S){return this._map=S,this._container||(this._container=this._map.getContainer()),this._controlContainer=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){ne.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const S=this._fullscreenButton=ne.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",S).setAttribute("aria-hidden","true"),S.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const S=this._getTitle();this._fullscreenButton.setAttribute("aria-label",S),this._fullscreenButton.title=S}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(S){this.options=S,t.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(S){return this._map=S,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=ne.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ne.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends t.Evented{constructor(S){super(),this.options=t.extend(Object.create(Dn),S),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(S){return this._map&&this.remove(),this._map=S,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&ne.remove(this._content),this._container&&(ne.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(S){return this._lngLat=t.LngLat.convert(S),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(S){return this.setDOMContent(document.createTextNode(S))}setHTML(S){const l=document.createDocumentFragment(),m=document.createElement("body");let w;for(m.innerHTML=S;w=m.firstChild,w;)l.appendChild(w);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(S){return this.options.maxWidth=S,this._update(),this}setDOMContent(S){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ne.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(S),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(S){this._container&&this._container.classList.add(S)}removeClassName(S){this._container&&this._container.classList.remove(S)}setOffset(S){return this.options.offset=S,this._update(),this}toggleClassName(S){if(this._container)return this._container.classList.toggle(S)}_createCloseButton(){this.options.closeButton&&(this._closeButton=ne.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(S){this._update(S.point)}_onMouseMove(S){this._update(S.point)}_onDrag(S){this._update(S.point)}_update(S){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=ne.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=ne.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(D=>this._container.classList.add(D)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ro(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!S))return;const l=this._pos=this._trackPointer&&S?S:this._map.project(this._lngLat);let m=this.options.anchor;const w=_u(this.options.offset);if(!m){const D=this._container.offsetWidth,U=this._container.offsetHeight;let q;q=l.y+w.bottom.y<U?["top"]:l.y>this._map.transform.height-U?["bottom"]:[],l.x<D/2?q.push("left"):l.x>this._map.transform.width-D/2&&q.push("right"),m=q.length===0?"bottom":q.join("-")}const C=l.add(w[m]).round();ne.setTransform(this._container,`${Ji[m]} translate(${C.x}px,${C.y}px)`),dr(this._container,m,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const S=this._container.querySelector(no);S&&S.focus()}_onClose(){this.remove()}},Marker:El,Style:Tn,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.pointGeometry,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,AJAXError:t.AJAXError,config:t.config,CanvasSource:Wi,GeoJSONSource:ui,ImageSource:hi,RasterDEMTileSource:Mt,RasterTileSource:Qt,VectorTileSource:fr,VideoSource:Si,prewarm:function(){Vn().acquire(wn)},clearPrewarmedResources:function(){const S=sn;S&&(S.isPreloaded()&&S.numActive()===1?(S.release(wn),sn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return hn.workerCount},set workerCount(S){hn.workerCount=S},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(S){t.config.MAX_PARALLEL_IMAGE_REQUESTS=S},clearStorage(S){t.clearTileCache(S)},workerUrl:"",addProtocol(S,l){t.config.REGISTERED_PROTOCOLS[S]=l},removeProtocol(S){delete t.config.REGISTERED_PROTOCOLS[S]}};return Jo.extend(Ya,{isSafari:t.isSafari,getPerformanceMetrics:t.PerformanceUtils.getPerformanceMetrics}),Ya});var F=T;return F})})(yv);var QM=yv.exports;const $C=yd(QM),eC=Xt.createContext(null);function tC(i,a){const p=Array.isArray(i)?i[0]:i?i.x:0,y=Array.isArray(i)?i[1]:i?i.y:0,T=Array.isArray(a)?a[0]:a?a.x:0,P=Array.isArray(a)?a[1]:a?a.y:0;return p===T&&y===P}function gc(i,a){if(i===a)return!0;if(!i||!a)return!1;if(Array.isArray(i)){if(!Array.isArray(a)||i.length!==a.length)return!1;for(let p=0;p<i.length;p++)if(!gc(i[p],a[p]))return!1;return!0}else if(Array.isArray(a))return!1;if(typeof i=="object"&&typeof a=="object"){const p=Object.keys(i),y=Object.keys(a);if(p.length!==y.length)return!1;for(const T of p)if(!a.hasOwnProperty(T)||!gc(i[T],a[T]))return!1;return!0}return!1}function iC(i){const a=i.clone();return a.pixelsToGLUnits=i.pixelsToGLUnits,a}function x8(i,a){if(!i.getProjection)return;const p=i.getProjection(),y=a.getProjection();gc(p,y)||a.setProjection(p)}function v8(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function b8(i,a){const p=a.viewState||a;let y=!1;if("longitude"in p&&"latitude"in p){const T=i.center;i.center=new T.constructor(p.longitude,p.latitude),y=y||T!==i.center}if("zoom"in p){const T=i.zoom;i.zoom=p.zoom,y=y||T!==i.zoom}if("bearing"in p){const T=i.bearing;i.bearing=p.bearing,y=y||T!==i.bearing}if("pitch"in p){const T=i.pitch;i.pitch=p.pitch,y=y||T!==i.pitch}return p.padding&&!i.isPaddingEqual(p.padding)&&(y=!0,i.padding=p.padding),y}const rC=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function w8(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;const a={};for(const y of i.layers)a[y.id]=y;const p=i.layers.map(y=>{let T=null;"interactive"in y&&(T=Object.assign({},y),delete T.interactive);const P=a[y.ref];if(P){T=T||Object.assign({},y),delete T.ref;for(const F of rC)F in P&&(T[F]=P[F])}return T||y});return{...i,layers:p}}const T8={version:8,sources:{},layers:[]},E8={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},s6={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},S8={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},nC=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],oC=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class U0{constructor(a,p,y){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=T=>{const P=this.props[S8[T.type]];P?P(T):T.type==="error"&&console.error(T.error)},this._onPointerEvent=T=>{(T.type==="mousemove"||T.type==="mouseout")&&this._updateHover(T);const P=this.props[E8[T.type]];P&&(this.props.interactiveLayerIds&&T.type!=="mouseover"&&T.type!=="mouseout"&&(T.features=this._hoveredFeatures||this._queryRenderedFeatures(T.point)),P(T),delete T.features)},this._onCameraEvent=T=>{if(!this._internalUpdate){const P=this.props[s6[T.type]];P&&P(T)}T.type in this._deferredEvents&&(this._deferredEvents[T.type]=!1)},this._MapClass=a,this.props=p,this._initialize(y)}get map(){return this._map}get transform(){return this._renderTransform}setProps(a){const p=this.props;this.props=a;const y=this._updateSettings(a,p);y&&this._createShadowTransform(this._map);const T=this._updateSize(a),P=this._updateViewState(a,!0);this._updateStyle(a,p),this._updateStyleComponents(a,p),this._updateHandlers(a,p),(y||T||P&&!this._map.isMoving())&&this.redraw()}static reuse(a,p){const y=U0.savedMaps.pop();if(!y)return null;const T=y.map,P=T.getContainer();for(p.className=P.className;P.childNodes.length>0;)p.appendChild(P.childNodes[0]);T._container=p;const F=T._resizeObserver;F&&(F.disconnect(),F.observe(p)),y.setProps({...a,styleDiffing:!1}),T.resize();const{initialViewState:t}=a;return t&&(t.bounds?T.fitBounds(t.bounds,{...t.fitBoundsOptions,duration:0}):y._updateViewState(t,!1)),T.isStyleLoaded()?T.fire("load"):T.once("styledata",()=>T.fire("load")),T._update(),y}_initialize(a){const{props:p}=this,{mapStyle:y=T8}=p,T={...p,...p.initialViewState,accessToken:p.mapboxAccessToken||sC()||null,container:a,style:w8(y)},P=T.initialViewState||T.viewState||T;if(Object.assign(T,{center:[P.longitude||0,P.latitude||0],zoom:P.zoom||0,pitch:P.pitch||0,bearing:P.bearing||0}),p.gl){const ye=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=ye,p.gl)}const F=new this._MapClass(T);P.padding&&F.setPadding(P.padding),p.cursor&&(F.getCanvas().style.cursor=p.cursor),this._createShadowTransform(F);const t=F._render;F._render=ye=>{this._inRender=!0,t.call(F,ye),this._inRender=!1};const j=F._renderTaskQueue.run;F._renderTaskQueue.run=ye=>{j.call(F._renderTaskQueue,ye),this._onBeforeRepaint()},F.on("render",()=>this._onAfterRepaint());const ie=F.fire;F.fire=this._fireEvent.bind(this,ie),F.on("resize",()=>{this._renderTransform.resize(F.transform.width,F.transform.height)}),F.on("styledata",()=>{this._updateStyleComponents(this.props,{}),x8(F.transform,this._renderTransform)}),F.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const ye in E8)F.on(ye,this._onPointerEvent);for(const ye in s6)F.on(ye,this._onCameraEvent);for(const ye in S8)F.on(ye,this._onEvent);this._map=F}recycle(){const p=this.map.getContainer().querySelector("[mapboxgl-children]");p==null||p.remove(),U0.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const a=this._map;!this._inRender&&a.style&&(a._frame&&(a._frame.cancel(),a._frame=null),a._render())}_createShadowTransform(a){const p=iC(a.transform);a.painter.transform=p,this._renderTransform=p}_updateSize(a){const{viewState:p}=a;if(p){const y=this._map;if(p.width!==y.transform.width||p.height!==y.transform.height)return y.resize(),!0}return!1}_updateViewState(a,p){if(this._internalUpdate)return!1;const y=this._map,T=this._renderTransform,{zoom:P,pitch:F,bearing:t}=T,j=y.isMoving();j&&(T.cameraElevationReference="sea");const ie=b8(T,{...v8(y.transform),...a});if(j&&(T.cameraElevationReference="ground"),ie&&p){const ye=this._deferredEvents;ye.move=!0,ye.zoom||(ye.zoom=P!==T.zoom),ye.rotate||(ye.rotate=t!==T.bearing),ye.pitch||(ye.pitch=F!==T.pitch)}return j||b8(y.transform,a),ie}_updateSettings(a,p){const y=this._map;let T=!1;for(const P of nC)if(P in a&&!gc(a[P],p[P])){T=!0;const F=y[`set${P[0].toUpperCase()}${P.slice(1)}`];F==null||F.call(y,a[P])}return T}_updateStyle(a,p){if(a.cursor!==p.cursor&&(this._map.getCanvas().style.cursor=a.cursor||""),a.mapStyle!==p.mapStyle){const{mapStyle:y=T8,styleDiffing:T=!0}=a,P={diff:T};return"localIdeographFontFamily"in a&&(P.localIdeographFontFamily=a.localIdeographFontFamily),this._map.setStyle(w8(y),P),!0}return!1}_updateStyleComponents(a,p){const y=this._map;let T=!1;return y.isStyleLoaded()&&("light"in a&&y.setLight&&!gc(a.light,p.light)&&(T=!0,y.setLight(a.light)),"fog"in a&&y.setFog&&!gc(a.fog,p.fog)&&(T=!0,y.setFog(a.fog)),"terrain"in a&&y.setTerrain&&!gc(a.terrain,p.terrain)&&(!a.terrain||y.getSource(a.terrain.source))&&(T=!0,y.setTerrain(a.terrain))),T}_updateHandlers(a,p){var y,T;const P=this._map;let F=!1;for(const t of oC){const j=(y=a[t])!==null&&y!==void 0?y:!0,ie=(T=p[t])!==null&&T!==void 0?T:!0;gc(j,ie)||(F=!0,j?P[t].enable(j):P[t].disable())}return F}_queryRenderedFeatures(a){const p=this._map,y=p.transform,{interactiveLayerIds:T=[]}=this.props;try{return p.transform=this._renderTransform,p.queryRenderedFeatures(a,{layers:T.filter(p.getLayer.bind(p))})}catch{return[]}finally{p.transform=y}}_updateHover(a){var p;const{props:y}=this;if(y.interactiveLayerIds&&(y.onMouseMove||y.onMouseEnter||y.onMouseLeave)){const P=a.type,F=((p=this._hoveredFeatures)===null||p===void 0?void 0:p.length)>0,t=this._queryRenderedFeatures(a.point),j=t.length>0;!j&&F&&(a.type="mouseleave",this._onPointerEvent(a)),this._hoveredFeatures=t,j&&!F&&(a.type="mouseenter",this._onPointerEvent(a)),a.type=P}else this._hoveredFeatures=null}_fireEvent(a,p,y){const T=this._map,P=T.transform,F=typeof p=="string"?p:p.type;return F==="move"&&this._updateViewState(this.props,!1),F in s6&&(typeof p=="object"&&(p.viewState=v8(P)),this._map.isMoving())?(T.transform=this._renderTransform,a.call(T,p,y),T.transform=P,T):(a.call(T,p,y),T)}_onBeforeRepaint(){const a=this._map;this._internalUpdate=!0;for(const y in this._deferredEvents)this._deferredEvents[y]&&a.fire(y);this._internalUpdate=!1;const p=this._map.transform;a.transform=this._renderTransform,this._onAfterRepaint=()=>{x8(this._renderTransform,p),a.transform=p}}}U0.savedMaps=[];function sC(){let i=null;if(typeof location<"u"){const a=/access_token=([^&\/]*)/.exec(location.search);i=a&&a[1]}try{i=i||{}.MapboxAccessToken}catch{}try{i=i||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return i}const aC=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function lC(i){if(!i)return null;const a=i.map,p={getMap:()=>a,getCenter:()=>i.transform.center,getZoom:()=>i.transform.zoom,getBearing:()=>i.transform.bearing,getPitch:()=>i.transform.pitch,getPadding:()=>i.transform.padding,getBounds:()=>i.transform.getBounds(),project:y=>{const T=a.transform;a.transform=i.transform;const P=a.project(y);return a.transform=T,P},unproject:y=>{const T=a.transform;a.transform=i.transform;const P=a.unproject(y);return a.transform=T,P},queryTerrainElevation:(y,T)=>{const P=a.transform;a.transform=i.transform;const F=a.queryTerrainElevation(y,T);return a.transform=P,F},queryRenderedFeatures:(y,T)=>{const P=a.transform;a.transform=i.transform;const F=a.queryRenderedFeatures(y,T);return a.transform=P,F}};for(const y of cC(a))!(y in p)&&!aC.includes(y)&&(p[y]=a[y].bind(a));return p}function cC(i){const a=new Set;let p=i;for(;p;){for(const y of Object.getOwnPropertyNames(p))y[0]!=="_"&&typeof i[y]=="function"&&y!=="fire"&&y!=="setEventedParent"&&a.add(y);p=Object.getPrototypeOf(p)}return Array.from(a)}const uC=typeof document<"u"?Xt.useLayoutEffect:Xt.useEffect,hC=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function dC(i,a){for(const y of hC)y in a&&(i[y]=a[y]);const{RTLTextPlugin:p="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=a;p&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"&&i.setRTLTextPlugin(p,y=>{y&&console.error(y)},!1)}const $0=Xt.createContext(null);function pC(i,a,p){const y=Xt.useContext(eC),[T,P]=Xt.useState(null),F=Xt.useRef(),{current:t}=Xt.useRef({mapLib:null,map:null});Xt.useEffect(()=>{const ye=i.mapLib;let he=!0,ne;return Promise.resolve(ye||p).then(Ye=>{if(!he)return;if(!Ye)throw new Error("Invalid mapLib");const lt="Map"in Ye?Ye:Ye.default;if(!lt.Map)throw new Error("Invalid mapLib");if(dC(lt,i),!lt.supported||lt.supported(i))i.reuseMaps&&(ne=U0.reuse(i,F.current)),ne||(ne=new U0(lt.Map,i,F.current)),t.map=lC(ne),t.mapLib=lt,P(ne),y==null||y.onMapMount(t.map,i.id);else throw new Error("Map is not supported by this browser")}).catch(Ye=>{const{onError:lt}=i;lt?lt({type:"error",target:null,originalEvent:null,error:Ye}):console.error(Ye)}),()=>{he=!1,ne&&(y==null||y.onMapUnmount(i.id),i.reuseMaps?ne.recycle():ne.destroy())}},[]),uC(()=>{T&&T.setProps(i)}),Xt.useImperativeHandle(a,()=>t.map,[T]);const j=Xt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),ie={height:"100%"};return Xt.createElement("div",{id:i.id,ref:F,style:j},T&&Xt.createElement($0.Provider,{value:t},Xt.createElement("div",{"mapboxgl-children":"",style:ie},i.children)))}const fC=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function mp(i,a){if(!i||!a)return;const p=i.style;for(const y in a){const T=a[y];Number.isFinite(T)&&!fC.test(y)?p[y]=`${T}px`:p[y]=T}}function mC(i,a){const{map:p,mapLib:y}=Xt.useContext($0),T=Xt.useRef({props:i});T.current.props=i;const P=Xt.useMemo(()=>{let at=!1;Xt.Children.forEach(i.children,Le=>{Le&&(at=!0)});const Kt={...i,element:at?document.createElement("div"):null},Ne=new y.Marker(Kt);return Ne.setLngLat([i.longitude,i.latitude]),Ne.getElement().addEventListener("click",Le=>{var je,_t;(_t=(je=T.current.props).onClick)===null||_t===void 0||_t.call(je,{type:"click",target:Ne,originalEvent:Le})}),Ne.on("dragstart",Le=>{var je,_t;const St=Le;St.lngLat=P.getLngLat(),(_t=(je=T.current.props).onDragStart)===null||_t===void 0||_t.call(je,St)}),Ne.on("drag",Le=>{var je,_t;const St=Le;St.lngLat=P.getLngLat(),(_t=(je=T.current.props).onDrag)===null||_t===void 0||_t.call(je,St)}),Ne.on("dragend",Le=>{var je,_t;const St=Le;St.lngLat=P.getLngLat(),(_t=(je=T.current.props).onDragEnd)===null||_t===void 0||_t.call(je,St)}),Ne},[]);Xt.useEffect(()=>(P.addTo(p.getMap()),()=>{P.remove()}),[]);const{longitude:F,latitude:t,offset:j,style:ie,draggable:ye=!1,popup:he=null,rotation:ne=0,rotationAlignment:Ye="auto",pitchAlignment:lt="auto"}=i;return Xt.useEffect(()=>{mp(P.getElement(),ie)},[ie]),Xt.useImperativeHandle(a,()=>P,[]),(P.getLngLat().lng!==F||P.getLngLat().lat!==t)&&P.setLngLat([F,t]),j&&!tC(P.getOffset(),j)&&P.setOffset(j),P.isDraggable()!==ye&&P.setDraggable(ye),P.getRotation()!==ne&&P.setRotation(ne),P.getRotationAlignment()!==Ye&&P.setRotationAlignment(Ye),P.getPitchAlignment()!==lt&&P.setPitchAlignment(lt),P.getPopup()!==he&&P.setPopup(he),Z2.createPortal(i.children,P.getElement())}const _C=Xt.memo(Xt.forwardRef(mC));function M8(i){return new Set(i?i.trim().split(/\s+/):[])}function gC(i,a){const{map:p,mapLib:y}=Xt.useContext($0),T=Xt.useMemo(()=>document.createElement("div"),[]),P=Xt.useRef({props:i});P.current.props=i;const F=Xt.useMemo(()=>{const t={...i},j=new y.Popup(t);return j.setLngLat([i.longitude,i.latitude]),j.once("open",ie=>{var ye,he;(he=(ye=P.current.props).onOpen)===null||he===void 0||he.call(ye,ie)}),j},[]);if(Xt.useEffect(()=>{const t=j=>{var ie,ye;(ye=(ie=P.current.props).onClose)===null||ye===void 0||ye.call(ie,j)};return F.on("close",t),F.setDOMContent(T).addTo(p.getMap()),()=>{F.off("close",t),F.isOpen()&&F.remove()}},[]),Xt.useEffect(()=>{mp(F.getElement(),i.style)},[i.style]),Xt.useImperativeHandle(a,()=>F,[]),F.isOpen()&&((F.getLngLat().lng!==i.longitude||F.getLngLat().lat!==i.latitude)&&F.setLngLat([i.longitude,i.latitude]),i.offset&&!gc(F.options.offset,i.offset)&&F.setOffset(i.offset),(F.options.anchor!==i.anchor||F.options.maxWidth!==i.maxWidth)&&(F.options.anchor=i.anchor,F.setMaxWidth(i.maxWidth)),F.options.className!==i.className)){const t=M8(F.options.className),j=M8(i.className);for(const ie of t)j.has(ie)||F.removeClassName(ie);for(const ie of j)t.has(ie)||F.addClassName(ie);F.options.className=i.className}return Z2.createPortal(i.children,T)}Xt.memo(Xt.forwardRef(gC));function W2(i,a,p,y){const T=Xt.useContext($0),P=Xt.useMemo(()=>i(T),[]);return Xt.useEffect(()=>{const F=y||p||a,t=typeof a=="function"&&typeof p=="function"?a:null,j=typeof p=="function"?p:typeof a=="function"?a:null,{map:ie}=T;return ie.hasControl(P)||(ie.addControl(P,F==null?void 0:F.position),t&&t(T)),()=>{j&&j(T),ie.hasControl(P)&&ie.removeControl(P)}},[]),P}function yC(i){const a=W2(({mapLib:p})=>new p.AttributionControl(i),{position:i.position});return Xt.useEffect(()=>{mp(a._container,i.style)},[i.style]),null}Xt.memo(yC);function xC(i){const a=W2(({mapLib:p})=>new p.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return Xt.useEffect(()=>{mp(a._controlContainer,i.style)},[i.style]),null}const vC=Xt.memo(xC);function bC(i,a){const p=Xt.useRef({props:i}),y=W2(({mapLib:T})=>{const P=new T.GeolocateControl(i),F=P._setupUI;return P._setupUI=t=>{P._container.hasChildNodes()||F(t)},P.on("geolocate",t=>{var j,ie;(ie=(j=p.current.props).onGeolocate)===null||ie===void 0||ie.call(j,t)}),P.on("error",t=>{var j,ie;(ie=(j=p.current.props).onError)===null||ie===void 0||ie.call(j,t)}),P.on("outofmaxbounds",t=>{var j,ie;(ie=(j=p.current.props).onOutOfMaxBounds)===null||ie===void 0||ie.call(j,t)}),P.on("trackuserlocationstart",t=>{var j,ie;(ie=(j=p.current.props).onTrackUserLocationStart)===null||ie===void 0||ie.call(j,t)}),P.on("trackuserlocationend",t=>{var j,ie;(ie=(j=p.current.props).onTrackUserLocationEnd)===null||ie===void 0||ie.call(j,t)}),P},{position:i.position});return p.current.props=i,Xt.useImperativeHandle(a,()=>y,[]),Xt.useEffect(()=>{mp(y._container,i.style)},[i.style]),null}Xt.memo(Xt.forwardRef(bC));function wC(i){const a=W2(({mapLib:p})=>new p.NavigationControl(i),{position:i.position});return Xt.useEffect(()=>{mp(a._container,i.style)},[i.style]),null}const TC=Xt.memo(wC);function EC(i){const a=W2(({mapLib:P})=>new P.ScaleControl(i),{position:i.position}),p=Xt.useRef(i),y=p.current;p.current=i;const{style:T}=i;return i.maxWidth!==void 0&&i.maxWidth!==y.maxWidth&&(a.options.maxWidth=i.maxWidth),i.unit!==void 0&&i.unit!==y.unit&&a.setUnit(i.unit),Xt.useEffect(()=>{mp(a._container,T)},[T]),null}Xt.memo(EC);function g5(i,a){if(!i)throw new Error(a)}function SC(i,a,p,y){if(g5(p.id===y.id,"layer id changed"),g5(p.type===y.type,"layer type changed"),p.type==="custom"||y.type==="custom")return;const{layout:T={},paint:P={},filter:F,minzoom:t,maxzoom:j,beforeId:ie}=p;if(ie!==y.beforeId&&i.moveLayer(a,ie),T!==y.layout){const ye=y.layout||{};for(const he in T)gc(T[he],ye[he])||i.setLayoutProperty(a,he,T[he]);for(const he in ye)T.hasOwnProperty(he)||i.setLayoutProperty(a,he,void 0)}if(P!==y.paint){const ye=y.paint||{};for(const he in P)gc(P[he],ye[he])||i.setPaintProperty(a,he,P[he]);for(const he in ye)P.hasOwnProperty(he)||i.setPaintProperty(a,he,void 0)}gc(F,y.filter)||i.setFilter(a,F),(t!==y.minzoom||j!==y.maxzoom)&&i.setLayerZoomRange(a,t,j)}function MC(i,a,p){if(i.style&&i.style._loaded&&(!("source"in p)||i.getSource(p.source))){const y={...p,id:a};delete y.beforeId,i.addLayer(y,p.beforeId)}}let CC=0;function IC(i){const a=Xt.useContext($0).map.getMap(),p=Xt.useRef(i),[,y]=Xt.useState(0),T=Xt.useMemo(()=>i.id||`jsx-layer-${CC++}`,[]);if(Xt.useEffect(()=>{if(a){const F=()=>y(t=>t+1);return a.on("styledata",F),F(),()=>{a.off("styledata",F),a.style&&a.style._loaded&&a.getLayer(T)&&a.removeLayer(T)}}},[a]),a&&a.style&&a.getLayer(T))try{SC(a,T,i,p.current)}catch(F){console.warn(F)}else MC(a,T,i);return p.current=i,null}let AC=0;function PC(i,a,p){if(i.style&&i.style._loaded){const y={...p};return delete y.id,delete y.children,i.addSource(a,y),i.getSource(a)}return null}function kC(i,a,p){g5(a.id===p.id,"source id changed"),g5(a.type===p.type,"source type changed");let y="",T=0;for(const F in a)F!=="children"&&F!=="id"&&!gc(p[F],a[F])&&(y=F,T++);if(!T)return;const P=a.type;if(P==="geojson")i.setData(a.data);else if(P==="image")i.updateImage({url:a.url,coordinates:a.coordinates});else if("setCoordinates"in i&&T===1&&y==="coordinates")i.setCoordinates(a.coordinates);else if("setUrl"in i)switch(y){case"url":i.setUrl(a.url);break;case"tiles":i.setTiles(a.tiles);break}else console.warn(`Unable to update <Source> prop: ${y}`)}function zC(i){const a=Xt.useContext($0).map.getMap(),p=Xt.useRef(i),[,y]=Xt.useState(0),T=Xt.useMemo(()=>i.id||`jsx-source-${AC++}`,[]);Xt.useEffect(()=>{if(a){const F=()=>setTimeout(()=>y(t=>t+1),0);return a.on("styledata",F),F(),()=>{var t;if(a.off("styledata",F),a.style&&a.style._loaded&&a.getSource(T)){const j=(t=a.getStyle())===null||t===void 0?void 0:t.layers;if(j)for(const ie of j)ie.source===T&&a.removeLayer(ie.id);a.removeSource(T)}}}},[a]);let P=a&&a.style&&a.getSource(T);return P?kC(P,i,p.current):P=PC(a,T,i),p.current=i,P&&Xt.Children.map(i.children,F=>F&&Xt.cloneElement(F,{source:T}))||null}const DC=JM(()=>Promise.resolve().then(()=>BC),void 0),ZC=(()=>Xt.forwardRef(function(a,p){return pC(a,p,DC)}))(),qC=_C,WC=vC,XC=TC,HC=IC,KC=zC;var LC={},vv={},bv={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=function(){for(var T=arguments.length,P=new Array(T),F=0;F<T;F++)P[F]=arguments[F];if(typeof window<"u"){var t;typeof window.gtag>"u"&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)}),(t=window).gtag.apply(t,P)}},p=a;i.default=p})(bv);var wv={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=F;var a=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;function p(t){return t.toString().trim().replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(j,ie,ye){return ie>0&&ie+j.length!==ye.length&&j.search(a)>-1&&ye.charAt(ie-2)!==":"&&(ye.charAt(ie+j.length)!=="-"||ye.charAt(ie-1)==="-")&&ye.charAt(ie-1).search(/[^\s-]/)<0?j.toLowerCase():j.substr(1).search(/[A-Z]|\../)>-1?j:j.charAt(0).toUpperCase()+j.substr(1)})}function y(t){return typeof t=="string"&&t.indexOf("@")!==-1}var T="REDACTED (Potential Email Address)";function P(t){return y(t)?(console.warn("This arg looks like an email address, redacting."),T):t}function F(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,ye=t||"";return j&&(ye=p(t)),ie&&(ye=P(ye)),ye}})(wv);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.GA4=void 0;var a=F(bv),p=F(wv),y=["eventCategory","eventAction","eventLabel","eventValue","hitType"],T=["title","location"],P=["page","hitType"];function F(Qt){return Qt&&Qt.__esModule?Qt:{default:Qt}}function t(Qt,$t){if(Qt==null)return{};var Mt=j(Qt,$t),ui,pt;if(Object.getOwnPropertySymbols){var hi=Object.getOwnPropertySymbols(Qt);for(pt=0;pt<hi.length;pt++)ui=hi[pt],!($t.indexOf(ui)>=0)&&Object.prototype.propertyIsEnumerable.call(Qt,ui)&&(Mt[ui]=Qt[ui])}return Mt}function j(Qt,$t){if(Qt==null)return{};var Mt={},ui=Object.keys(Qt),pt,hi;for(hi=0;hi<ui.length;hi++)pt=ui[hi],!($t.indexOf(pt)>=0)&&(Mt[pt]=Qt[pt]);return Mt}function ie(Qt){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($t){return typeof $t}:function($t){return $t&&typeof Symbol=="function"&&$t.constructor===Symbol&&$t!==Symbol.prototype?"symbol":typeof $t},ie(Qt)}function ye(Qt){return Ye(Qt)||ne(Qt)||Le(Qt)||he()}function he(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ne(Qt){if(typeof Symbol<"u"&&Qt[Symbol.iterator]!=null||Qt["@@iterator"]!=null)return Array.from(Qt)}function Ye(Qt){if(Array.isArray(Qt))return je(Qt)}function lt(Qt,$t){var Mt=Object.keys(Qt);if(Object.getOwnPropertySymbols){var ui=Object.getOwnPropertySymbols(Qt);$t&&(ui=ui.filter(function(pt){return Object.getOwnPropertyDescriptor(Qt,pt).enumerable})),Mt.push.apply(Mt,ui)}return Mt}function at(Qt){for(var $t=1;$t<arguments.length;$t++){var Mt=arguments[$t]!=null?arguments[$t]:{};$t%2?lt(Object(Mt),!0).forEach(function(ui){zt(Qt,ui,Mt[ui])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Qt,Object.getOwnPropertyDescriptors(Mt)):lt(Object(Mt)).forEach(function(ui){Object.defineProperty(Qt,ui,Object.getOwnPropertyDescriptor(Mt,ui))})}return Qt}function Kt(Qt,$t){return St(Qt)||_t(Qt,$t)||Le(Qt,$t)||Ne()}function Ne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Le(Qt,$t){if(Qt){if(typeof Qt=="string")return je(Qt,$t);var Mt=Object.prototype.toString.call(Qt).slice(8,-1);if(Mt==="Object"&&Qt.constructor&&(Mt=Qt.constructor.name),Mt==="Map"||Mt==="Set")return Array.from(Qt);if(Mt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Mt))return je(Qt,$t)}}function je(Qt,$t){($t==null||$t>Qt.length)&&($t=Qt.length);for(var Mt=0,ui=new Array($t);Mt<$t;Mt++)ui[Mt]=Qt[Mt];return ui}function _t(Qt,$t){var Mt=Qt==null?null:typeof Symbol<"u"&&Qt[Symbol.iterator]||Qt["@@iterator"];if(Mt!=null){var ui,pt,hi,Si,Wi=[],lr=!0,mr=!1;try{if(hi=(Mt=Mt.call(Qt)).next,$t===0){if(Object(Mt)!==Mt)return;lr=!1}else for(;!(lr=(ui=hi.call(Mt)).done)&&(Wi.push(ui.value),Wi.length!==$t);lr=!0);}catch(Vr){mr=!0,pt=Vr}finally{try{if(!lr&&Mt.return!=null&&(Si=Mt.return(),Object(Si)!==Si))return}finally{if(mr)throw pt}}return Wi}}function St(Qt){if(Array.isArray(Qt))return Qt}function ci(Qt,$t){if(!(Qt instanceof $t))throw new TypeError("Cannot call a class as a function")}function dt(Qt,$t){for(var Mt=0;Mt<$t.length;Mt++){var ui=$t[Mt];ui.enumerable=ui.enumerable||!1,ui.configurable=!0,"value"in ui&&(ui.writable=!0),Object.defineProperty(Qt,Ci(ui.key),ui)}}function ri(Qt,$t,Mt){return $t&&dt(Qt.prototype,$t),Mt&&dt(Qt,Mt),Object.defineProperty(Qt,"prototype",{writable:!1}),Qt}function zt(Qt,$t,Mt){return $t=Ci($t),$t in Qt?Object.defineProperty(Qt,$t,{value:Mt,enumerable:!0,configurable:!0,writable:!0}):Qt[$t]=Mt,Qt}function Ci(Qt){var $t=yr(Qt,"string");return ie($t)==="symbol"?$t:String($t)}function yr(Qt,$t){if(ie(Qt)!=="object"||Qt===null)return Qt;var Mt=Qt[Symbol.toPrimitive];if(Mt!==void 0){var ui=Mt.call(Qt,$t||"default");if(ie(ui)!=="object")return ui;throw new TypeError("@@toPrimitive must return a primitive value.")}return($t==="string"?String:Number)(Qt)}var ki=function(){function Qt(){var $t=this;ci(this,Qt),zt(this,"reset",function(){$t.isInitialized=!1,$t._testMode=!1,$t._currentMeasurementId,$t._hasLoadedGA=!1,$t._isQueuing=!1,$t._queueGtag=[]}),zt(this,"_gtag",function(){for(var Mt=arguments.length,ui=new Array(Mt),pt=0;pt<Mt;pt++)ui[pt]=arguments[pt];$t._testMode||$t._isQueuing?$t._queueGtag.push(ui):a.default.apply(void 0,ui)}),zt(this,"_loadGA",function(Mt,ui){var pt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"https://www.googletagmanager.com/gtag/js";if(!(typeof window>"u"||typeof document>"u")&&!$t._hasLoadedGA){var hi=document.createElement("script");hi.async=!0,hi.src="".concat(pt,"?id=").concat(Mt),ui&&hi.setAttribute("nonce",ui),document.body.appendChild(hi),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},$t._hasLoadedGA=!0}}),zt(this,"_toGtagOptions",function(Mt){if(Mt){var ui={cookieUpdate:"cookie_update",cookieExpires:"cookie_expires",cookieDomain:"cookie_domain",cookieFlags:"cookie_flags",userId:"user_id",clientId:"client_id",anonymizeIp:"anonymize_ip",contentGroup1:"content_group1",contentGroup2:"content_group2",contentGroup3:"content_group3",contentGroup4:"content_group4",contentGroup5:"content_group5",allowAdFeatures:"allow_google_signals",allowAdPersonalizationSignals:"allow_ad_personalization_signals",nonInteraction:"non_interaction",page:"page_path",hitCallback:"event_callback"},pt=Object.entries(Mt).reduce(function(hi,Si){var Wi=Kt(Si,2),lr=Wi[0],mr=Wi[1];return ui[lr]?hi[ui[lr]]=mr:hi[lr]=mr,hi},{});return pt}}),zt(this,"initialize",function(Mt){var ui=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Mt)throw new Error("Require GA_MEASUREMENT_ID");var pt=typeof Mt=="string"?[{trackingId:Mt}]:Mt;$t._currentMeasurementId=pt[0].trackingId;var hi=ui.gaOptions,Si=ui.gtagOptions,Wi=ui.nonce,lr=ui.testMode,mr=lr===void 0?!1:lr,Vr=ui.gtagUrl;if($t._testMode=mr,mr||$t._loadGA($t._currentMeasurementId,Wi,Vr),$t.isInitialized||($t._gtag("js",new Date),pt.forEach(function(on){var mo=at(at(at({},$t._toGtagOptions(at(at({},hi),on.gaOptions))),Si),on.gtagOptions);Object.keys(mo).length?$t._gtag("config",on.trackingId,mo):$t._gtag("config",on.trackingId)})),$t.isInitialized=!0,!mr){var rn=ye($t._queueGtag);for($t._queueGtag=[],$t._isQueuing=!1;rn.length;){var nn=rn.shift();$t._gtag.apply($t,ye(nn)),nn[0]==="get"&&($t._isQueuing=!0)}}}),zt(this,"set",function(Mt){if(!Mt){console.warn("`fieldsObject` is required in .set()");return}if(ie(Mt)!=="object"){console.warn("Expected `fieldsObject` arg to be an Object");return}Object.keys(Mt).length===0&&console.warn("empty `fieldsObject` given to .set()"),$t._gaCommand("set",Mt)}),zt(this,"_gaCommandSendEvent",function(Mt,ui,pt,hi,Si){$t._gtag("event",ui,at(at({event_category:Mt,event_label:pt,value:hi},Si&&{non_interaction:Si.nonInteraction}),$t._toGtagOptions(Si)))}),zt(this,"_gaCommandSendEventParameters",function(){for(var Mt=arguments.length,ui=new Array(Mt),pt=0;pt<Mt;pt++)ui[pt]=arguments[pt];if(typeof ui[0]=="string")$t._gaCommandSendEvent.apply($t,ye(ui.slice(1)));else{var hi=ui[0],Si=hi.eventCategory,Wi=hi.eventAction,lr=hi.eventLabel,mr=hi.eventValue;hi.hitType;var Vr=t(hi,y);$t._gaCommandSendEvent(Si,Wi,lr,mr,Vr)}}),zt(this,"_gaCommandSendTiming",function(Mt,ui,pt,hi){$t._gtag("event","timing_complete",{name:ui,value:pt,event_category:Mt,event_label:hi})}),zt(this,"_gaCommandSendPageview",function(Mt,ui){if(ui&&Object.keys(ui).length){var pt=$t._toGtagOptions(ui),hi=pt.title,Si=pt.location,Wi=t(pt,T);$t._gtag("event","page_view",at(at(at(at({},Mt&&{page_path:Mt}),hi&&{page_title:hi}),Si&&{page_location:Si}),Wi))}else Mt?$t._gtag("event","page_view",{page_path:Mt}):$t._gtag("event","page_view")}),zt(this,"_gaCommandSendPageviewParameters",function(){for(var Mt=arguments.length,ui=new Array(Mt),pt=0;pt<Mt;pt++)ui[pt]=arguments[pt];if(typeof ui[0]=="string")$t._gaCommandSendPageview.apply($t,ye(ui.slice(1)));else{var hi=ui[0],Si=hi.page;hi.hitType;var Wi=t(hi,P);$t._gaCommandSendPageview(Si,Wi)}}),zt(this,"_gaCommandSend",function(){for(var Mt=arguments.length,ui=new Array(Mt),pt=0;pt<Mt;pt++)ui[pt]=arguments[pt];var hi=typeof ui[0]=="string"?ui[0]:ui[0].hitType;switch(hi){case"event":$t._gaCommandSendEventParameters.apply($t,ui);break;case"pageview":$t._gaCommandSendPageviewParameters.apply($t,ui);break;case"timing":$t._gaCommandSendTiming.apply($t,ye(ui.slice(1)));break;case"screenview":case"transaction":case"item":case"social":case"exception":console.warn("Unsupported send command: ".concat(hi));break;default:console.warn("Send command doesn't exist: ".concat(hi))}}),zt(this,"_gaCommandSet",function(){for(var Mt=arguments.length,ui=new Array(Mt),pt=0;pt<Mt;pt++)ui[pt]=arguments[pt];typeof ui[0]=="string"&&(ui[0]=zt({},ui[0],ui[1])),$t._gtag("set",$t._toGtagOptions(ui[0]))}),zt(this,"_gaCommand",function(Mt){for(var ui=arguments.length,pt=new Array(ui>1?ui-1:0),hi=1;hi<ui;hi++)pt[hi-1]=arguments[hi];switch(Mt){case"send":$t._gaCommandSend.apply($t,pt);break;case"set":$t._gaCommandSet.apply($t,pt);break;default:console.warn("Command doesn't exist: ".concat(Mt))}}),zt(this,"ga",function(){for(var Mt=arguments.length,ui=new Array(Mt),pt=0;pt<Mt;pt++)ui[pt]=arguments[pt];if(typeof ui[0]=="string")$t._gaCommand.apply($t,ui);else{var hi=ui[0];$t._gtag("get",$t._currentMeasurementId,"client_id",function(Si){$t._isQueuing=!1;var Wi=$t._queueGtag;for(hi({get:function(Vr){return Vr==="clientId"?Si:Vr==="trackingId"?$t._currentMeasurementId:Vr==="apiVersion"?"1":void 0}});Wi.length;){var lr=Wi.shift();$t._gtag.apply($t,ye(lr))}}),$t._isQueuing=!0}return $t.ga}),zt(this,"event",function(Mt,ui){if(typeof Mt=="string")$t._gtag("event",Mt,$t._toGtagOptions(ui));else{var pt=Mt.action,hi=Mt.category,Si=Mt.label,Wi=Mt.value,lr=Mt.nonInteraction,mr=Mt.transport;if(!hi||!pt){console.warn("args.category AND args.action are required in event()");return}var Vr={hitType:"event",eventCategory:(0,p.default)(hi),eventAction:(0,p.default)(pt)};Si&&(Vr.eventLabel=(0,p.default)(Si)),typeof Wi<"u"&&(typeof Wi!="number"?console.warn("Expected `args.value` arg to be a Number."):Vr.eventValue=Wi),typeof lr<"u"&&(typeof lr!="boolean"?console.warn("`args.nonInteraction` must be a boolean."):Vr.nonInteraction=lr),typeof mr<"u"&&(typeof mr!="string"?console.warn("`args.transport` must be a string."):(["beacon","xhr","image"].indexOf(mr)===-1&&console.warn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),Vr.transport=mr)),$t._gaCommand("send",Vr)}}),zt(this,"send",function(Mt){$t._gaCommand("send",Mt)}),this.reset()}return ri(Qt,[{key:"gtag",value:function(){this._gtag.apply(this,arguments)}}]),Qt}();i.GA4=ki;var fr=new ki;i.default=fr})(vv);(function(i){function a(t){"@babel/helpers - typeof";return a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},a(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.ReactGAImplementation=void 0;var p=T(vv);function y(t){if(typeof WeakMap!="function")return null;var j=new WeakMap,ie=new WeakMap;return(y=function(he){return he?ie:j})(t)}function T(t,j){if(!j&&t&&t.__esModule)return t;if(t===null||a(t)!=="object"&&typeof t!="function")return{default:t};var ie=y(j);if(ie&&ie.has(t))return ie.get(t);var ye={},he=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in t)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(t,ne)){var Ye=he?Object.getOwnPropertyDescriptor(t,ne):null;Ye&&(Ye.get||Ye.set)?Object.defineProperty(ye,ne,Ye):ye[ne]=t[ne]}return ye.default=t,ie&&ie.set(t,ye),ye}var P=p.GA4;i.ReactGAImplementation=P;var F=p.default;i.default=F})(LC);var Tv={exports:{}};(function(i,a){(function(p,y){i.exports=y()})(C8,function(){var p,y,T;function P(t,j){if(!p)p=j;else if(!y)y=j;else{var ie="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+p+")(sharedChunk); ("+y+")(sharedChunk); self.onerror = null;",ye={};p(ye),T=j(ye),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(T.workerUrl=window.URL.createObjectURL(new Blob([ie],{type:"text/javascript"})))}}P(["exports"],function(t){var j=typeof self<"u"?self:{},ie="2.15.0";let ye;const he={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(ye==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ye={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):r}catch{ye=r}}return ye},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!he.API_URL)return null;try{const r=new URL(he.API_URL);return r.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":r.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ne={supported:!1,testSupport:function(r){!at&&lt&&(Kt?Ne(r):Ye=r)}};let Ye,lt,at=!1,Kt=!1;function Ne(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,lt),r.isContextLost())return;ne.supported=!0}catch{}r.deleteTexture(e),at=!0}j.document&&(lt=j.document.createElement("img"),lt.onload=function(){Ye&&Ne(Ye),Ye=null,Kt=!0},lt.onerror=function(){at=!0,Ye=null},lt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Le="01";function je(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var _t=St;function St(r,e,n,u){this.cx=3*r,this.bx=3*(n-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(u-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=n,this.p2y=u}St.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var n=r,u=0;u<8;u++){var f=this.sampleCurveX(n)-r;if(Math.abs(f)<e)return n;var g=this.sampleCurveDerivativeX(n);if(Math.abs(g)<1e-6)break;n-=f/g}var b=0,I=1;for(n=r,u=0;u<20&&(f=this.sampleCurveX(n),!(Math.abs(f-r)<e));u++)r>f?b=n:I=n,n=.5*(I-b)+b;return n},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var ci=je(_t),dt=ri;function ri(r,e){this.x=r,this.y=e}ri.prototype={clone:function(){return new ri(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,n=r.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),n=Math.sin(r),u=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=u,this},_rotateAround:function(r,e){var n=Math.cos(r),u=Math.sin(r),f=e.y+u*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-u*(this.y-e.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ri.convert=function(r){return r instanceof ri?r:Array.isArray(r)?new ri(r[0],r[1]):r};var zt=je(dt);const Ci=Math.PI/180,yr=180/Math.PI;function ki(r){return r*Ci}function fr(r){return r*yr}const Qt=[[0,0],[1,0],[1,1],[0,1]];function $t(r){if(r<=0)return 0;if(r>=1)return 1;const e=r*r,n=e*r;return 4*(r<.5?n:3*(r-e)+n-.75)}function Mt(r,e,n,u){const f=new ci(r,e,n,u);return function(g){return f.solve(g)}}const ui=Mt(.25,.1,.25,1);function pt(r,e,n){return Math.min(n,Math.max(e,r))}function hi(r,e,n){return(n=pt((n-r)/(e-r),0,1))*n*(3-2*n)}function Si(r,e,n){const u=n-e,f=((r-e)%u+u)%u+e;return f===e?n:f}function Wi(r,e,n){if(!r.length)return n(null,[]);let u=r.length;const f=new Array(r.length);let g=null;r.forEach((b,I)=>{e(b,(z,R)=>{z&&(g=z),f[I]=R,--u==0&&n(g,f)})})}function lr(r){const e=[];for(const n in r)e.push(r[n]);return e}function mr(r,...e){for(const n of e)for(const u in n)r[u]=n[u];return r}let Vr=1;function rn(){return Vr++}function nn(){return function r(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function on(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function mo(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function eo(r,e){r.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function Rs(r,e){return r.indexOf(e,r.length-e.length)!==-1}function Ir(r,e,n){const u={};for(const f in r)u[f]=e.call(n||this,r[f],f,r);return u}function wn(r,e,n){const u={};for(const f in r)e.call(n||this,r[f],f,r)&&(u[f]=r[f]);return u}function hn(r){return Array.isArray(r)?r.map(hn):typeof r=="object"&&r?Ir(r,hn):r}const $s={};function sn(r){$s[r]||(typeof console<"u"&&console.warn(r),$s[r]=!0)}function Vn(r,e,n){return(n.y-r.y)*(e.x-r.x)>(e.y-r.y)*(n.x-r.x)}function ra(r){let e=0;for(let n,u,f=0,g=r.length,b=g-1;f<g;b=f++)n=r[f],u=r[b],e+=(u.x-n.x)*(n.y+u.y);return e}function ns(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function xr(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,u,f,g)=>{const b=f||g;return e[u]=!b||b.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Wo=null;function os(r){if(Wo==null){const e=r.navigator?r.navigator.userAgent:null;Wo=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Wo}function gs(r){try{const e=j[r];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function ys(r,e){return[r[4*e],r[4*e+1],r[4*e+2],r[4*e+3]]}const to="mapbox-tiles";let Eo=500,Zs=50,qn,qt;function Mi(){try{return j.caches}catch{}}function Xo(){Mi()&&!qn&&(qn=j.caches.open(to))}function so(r){const e=r.indexOf("?");if(e<0)return r;const n=function(f){const g=f.indexOf("?");return g>0?f.slice(g+1).split("&"):[]}(r),u=n.filter(f=>{const g=f.split("=");return g[0]==="language"||g[0]==="worldview"});return u.length?`${r.slice(0,e)}?${u.join("&")}`:r.slice(0,e)}let Gr=1/0;const zn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(zn);class Hn extends Error{constructor(e,n,u){n===401&&Tt(u)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const io=ns()?()=>self.worker&&self.worker.referrer:()=>(j.location.protocol==="blob:"?j.parent:j).location.href,Ao=function(r,e){if(!(/^file:/.test(n=r.url)||/^file:/.test(io())&&!/^\w+:/.test(n))){if(j.fetch&&j.Request&&j.AbortController&&j.Request.prototype.hasOwnProperty("signal"))return function(u,f){const g=new j.AbortController,b=new j.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:io(),referrerPolicy:u.referrerPolicy,signal:g.signal});let I=!1,z=!1;const R=(N=b.url).indexOf("sku=")>0&&Tt(N);var N;u.type==="json"&&b.headers.set("Accept","application/json");const $=(Q,te,ce)=>{if(z)return;if(Q&&Q.message!=="SecurityError"&&sn(Q.toString()),te&&ce)return W(te);const we=Date.now();j.fetch(b).then(Re=>{if(Re.ok){const He=R?Re.clone():null;return W(Re,He,we)}return f(new Hn(Re.statusText,Re.status,u.url))}).catch(Re=>{Re.name!=="AbortError"&&f(new Error(`${Re.message} ${u.url}`))})},W=(Q,te,ce)=>{(u.type==="arrayBuffer"?Q.arrayBuffer():u.type==="json"?Q.json():Q.text()).then(we=>{z||(te&&ce&&function(Re,He,Be){if(Xo(),!qn)return;const We={status:He.status,statusText:He.statusText,headers:new j.Headers};He.headers.forEach((Ot,Lt)=>We.headers.set(Lt,Ot));const it=xr(He.headers.get("Cache-Control")||"");if(it["no-store"])return;it["max-age"]&&We.headers.set("Expires",new Date(Be+1e3*it["max-age"]).toUTCString());const et=We.headers.get("Expires");et&&(new Date(et).getTime()-Be<42e4||function(Ot,Lt){if(qt===void 0)try{new Response(new ReadableStream),qt=!0}catch{qt=!1}qt?Lt(Ot.body):Ot.blob().then(Lt)}(He,Ot=>{const Lt=new j.Response(Ot,We);Xo(),qn&&qn.then(ti=>ti.put(so(Re.url),Lt)).catch(ti=>sn(ti.message))}))}(b,te,ce),I=!0,f(null,we,Q.headers.get("Cache-Control"),Q.headers.get("Expires")))}).catch(we=>{z||f(new Error(we.message))})};return R?function(Q,te){if(Xo(),!qn)return te(null);const ce=so(Q.url);qn.then(we=>{we.match(ce).then(Re=>{const He=function(Be){if(!Be)return!1;const We=new Date(Be.headers.get("Expires")||0),it=xr(Be.headers.get("Cache-Control")||"");return We>Date.now()&&!it["no-cache"]}(Re);we.delete(ce),He&&we.put(ce,Re.clone()),te(null,Re,He)}).catch(te)}).catch(te)}(b,$):$(null,null),{cancel:()=>{z=!0,I||g.abort()}}}(r,e);if(ns()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var n;return function(u,f){const g=new j.XMLHttpRequest;g.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const b in u.headers)g.setRequestHeader(b,u.headers[b]);return u.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=u.credentials==="include",g.onerror=()=>{f(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let b=g.response;if(u.type==="json")try{b=JSON.parse(g.response)}catch(I){return f(I)}f(null,b,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else f(new Hn(g.statusText,g.status,u.url))},g.send(u.body),{cancel:()=>g.abort()}}(r,e)},Ii=function(r,e){return Ao(mr(r,{type:"arrayBuffer"}),e)};function Tr(r){const e=j.document.createElement("a");return e.href=r,e.protocol===j.document.location.protocol&&e.host===j.document.location.host}const De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let de,_e;de=[],_e=0;const Ae=function(r,e){if(ne.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),_e>=he.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return de.push(g),g}_e++;let n=!1;const u=()=>{if(!n)for(n=!0,_e--;de.length&&_e<he.MAX_PARALLEL_IMAGE_REQUESTS;){const g=de.shift(),{requestParameters:b,callback:I,cancelled:z}=g;z||(g.cancel=Ae(b,I).cancel)}},f=Ii(r,(g,b,I,z)=>{u(),g?e(g):b&&(j.createImageBitmap?function(R,N){const $=new j.Blob([new Uint8Array(R)],{type:"image/png"});j.createImageBitmap($).then(W=>{N(null,W)}).catch(W=>{N(new Error(`Could not load image because of ${W.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(b,(R,N)=>e(R,N,I,z)):function(R,N){const $=new j.Image,W=j.URL;$.onload=()=>{N(null,$),W.revokeObjectURL($.src),$.onload=null,j.requestAnimationFrame(()=>{$.src=De})},$.onerror=()=>N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Q=new j.Blob([new Uint8Array(R)],{type:"image/png"});$.src=R.byteLength?W.createObjectURL(Q):De}(b,(R,N)=>e(R,N,I,z)))});return{cancel:()=>{f.cancel(),u()}}},Je="NO_ACCESS_TOKEN";function ot(r){return r.indexOf("mapbox:")===0}function Tt(r){return he.API_URL_REGEX.test(r)}function mt(r){return he.API_CDN_URL_REGEX.test(r)}function st(r){return he.API_STYLE_REGEX.test(r)&&!xt(r)}function xt(r){return he.API_SPRITE_REGEX.test(r)}const gi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wi(r){const e=r.match(gi);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Pe(r){const e=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${e}`}const ct="mapbox.eventData";function bt(r){if(!r)return null;const e=r.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(j.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class jt{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=bt(he.ACCESS_TOKEN);let u="";return u=n&&n.u?j.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(f,g)=>String.fromCharCode(+("0x"+g)))):he.ACCESS_TOKEN||"",e?`${ct}.${e}:${u}`:`${ct}:${u}`}fetchEventData(){const e=gs("localStorage"),n=this.getStorageKey(),u=this.getStorageKey("uuid");if(e)try{const f=j.localStorage.getItem(n);f&&(this.eventData=JSON.parse(f));const g=j.localStorage.getItem(u);g&&(this.anonId=g)}catch{sn("Unable to read from LocalStorage")}}saveEventData(){const e=gs("localStorage"),n=this.getStorageKey(),u=this.getStorageKey("uuid");if(e)try{j.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&j.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{sn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,u,f){if(!he.EVENTS_URL)return;const g=wi(he.EVENTS_URL);g.params.push(`access_token=${f||he.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(e).toISOString()},I=n?mr(b,n):b,z={url:Pe(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=function(R,N){return Ao(mr(R,{method:"POST"}),N)}(z,R=>{this.pendingRequest=null,u(R),this.saveEventData(),this.processRequests(f)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const pe=new class extends jt{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,e){he.EVENTS_URL&&he.ACCESS_TOKEN&&Array.isArray(r)&&r.some(n=>ot(n)||Tt(n))&&this.queueRequest(Date.now(),e)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=bt(he.ACCESS_TOKEN),n=e?e.u:he.ACCESS_TOKEN;let u=n!==this.eventData.tokenU;mo(this.anonId)||(this.anonId=nn(),u=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),b=new Date(f),I=(f-this.eventData.lastSuccess)/864e5;u=u||I>=1||I<-1||g.getDate()!==b.getDate()}else u=!0;u?this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ie,skuId:Le,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=f,this.eventData.tokenU=n)},r):this.processRequests()}},Y=pe.postTurnstileEvent.bind(pe),re=new class extends jt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,e,n,u){this.skuToken=e,this.errorCb=u,he.EVENTS_URL&&(n||he.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},n):this.errorCb(new Error(Je)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),mo(this.anonId)||(this.anonId=nn()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ie,skuId:Le,skuToken:this.skuToken,userId:this.anonId},u=>{u?this.errorCb(u):e&&(this.success[e]=!0)},r))}},fe=re.postMapLoadEvent.bind(re),ge=new class extends jt{constructor(){super("gljs.performance")}postPerformanceEvent(r,e){he.EVENTS_URL&&(r||he.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},r)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:n}=this.queue.shift(),u=function(f){const g=j.performance.getEntriesByType("resource"),b=j.performance.getEntriesByType("mark"),I=function(W){const Q={};if(W){for(const te in W)if(te!=="other")for(const ce of W[te]){const we=`${te}ResolveRangeMin`,Re=`${te}ResolveRangeMax`,He=`${te}RequestCount`,Be=`${te}RequestCachedCount`;Q[we]=Math.min(Q[we]||1/0,ce.startTime),Q[Re]=Math.max(Q[Re]||-1/0,ce.responseEnd);const We=it=>{Q[it]===void 0&&(Q[it]=0),++Q[it]};ce.transferSize!==void 0&&ce.transferSize===0&&We(Be),We(He)}}return Q}(function(W,Q){const te={};if(W)for(const ce of W){const we=Q(ce);te[we]===void 0&&(te[we]=[]),te[we].push(ce)}return te}(g,Ht)),z=j.devicePixelRatio,R=j.navigator.connection||j.navigator.mozConnection||j.navigator.webkitConnection,N={counters:[],metadata:[],attributes:[]},$=(W,Q,te)=>{te!=null&&W.push({name:Q,value:te.toString()})};for(const W in I)$(N.counters,W,I[W]);if(f.interactionRange[0]!==1/0&&f.interactionRange[1]!==-1/0&&($(N.counters,"interactionRangeMin",f.interactionRange[0]),$(N.counters,"interactionRangeMax",f.interactionRange[1])),b)for(const W of Object.keys(ut)){const Q=ut[W],te=b.find(ce=>ce.name===Q);te&&$(N.counters,Q,te.startTime)}return $(N.counters,"visibilityHidden",f.visibilityHidden),$(N.attributes,"style",function(W){if(W)for(const Q of W){const te=Q.name.split("?")[0];if(st(te)){const ce=te.split("/").slice(-2);if(ce.length===2)return`mapbox://styles/${ce[0]}/${ce[1]}`}}}(g)),$(N.attributes,"terrainEnabled",f.terrainEnabled?"true":"false"),$(N.attributes,"fogEnabled",f.fogEnabled?"true":"false"),$(N.attributes,"projection",f.projection),$(N.attributes,"zoom",f.zoom),$(N.metadata,"devicePixelRatio",z),$(N.metadata,"connectionEffectiveType",R?R.effectiveType:void 0),$(N.metadata,"navigatorUserAgent",j.navigator.userAgent),$(N.metadata,"screenWidth",j.screen.width),$(N.metadata,"screenHeight",j.screen.height),$(N.metadata,"windowWidth",j.innerWidth),$(N.metadata,"windowHeight",j.innerHeight),$(N.metadata,"mapWidth",f.width/z),$(N.metadata,"mapHeight",f.height/z),$(N.metadata,"webglRenderer",f.renderer),$(N.metadata,"webglVendor",f.vendor),$(N.metadata,"sdkVersion",ie),$(N.metadata,"sdkIdentifier","mapbox-gl-js"),N}(n);for(const f of u.metadata);for(const f of u.counters);for(const f of u.attributes);this.postEvent(e,u,()=>{},r)}},ke=ge.postPerformanceEvent.bind(ge),Ze=new class extends jt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,e,n,u){if(!he.API_URL||!he.SESSION_PATH)return;const f=wi(he.API_URL+he.SESSION_PATH);f.params.push(`sku=${e||""}`),f.params.push(`access_token=${u||he.ACCESS_TOKEN||""}`);const g={url:Pe(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(b,I){return Ao(mr(b,{method:"GET"}),I)}(g,b=>{this.pendingRequest=null,n(b),this.saveEventData(),this.processRequests(u)})}getSessionAPI(r,e,n,u){this.skuToken=e,this.errorCb=u,he.SESSION_PATH&&he.API_URL&&(n||he.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},n):this.errorCb(new Error(Je)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,u=>{u?this.errorCb(u):e&&(this.success[e]=!0)},r)}},$e=Ze.getSessionAPI.bind(Ze),Ve=new Set,ut={create:"create",load:"load",fullLoad:"fullLoad"},Dt={mark(r){j.performance.mark(r)},measure(r,e,n){j.performance.measure(r,e,n)}};function Ht(r){const e=r.name.split("?")[0];return mt(e)&&e.includes("mapbox-gl.js")?"javascript":mt(e)&&e.includes("mapbox-gl.css")?"css":function(n){return he.API_FONTS_REGEX.test(n)}(e)?"fontRange":xt(e)?"sprite":st(e)?"style":function(n){return he.API_TILEJSON_REGEX.test(n)}(e)?"tilejson":"other"}const ft=j.performance;function ji(r){const e=r?r.url.toString():void 0;return ft.getEntriesByName(e)}let Zi,Ai,Yi,rr;const br={now:()=>Yi!==void 0?Yi:j.performance.now(),setNow(r){Yi=r},restoreNow(){Yi=void 0},frame(r){const e=j.requestAnimationFrame(r);return{cancel:()=>j.cancelAnimationFrame(e)}},getImageData(r,e=0){const{width:n,height:u}=r;rr||(rr=j.document.createElement("canvas"));const f=rr.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(n>rr.width||u>rr.height)&&(rr.width=n,rr.height=u),f.clearRect(-e,-e,n+2*e,u+2*e),f.drawImage(r,0,0,n,u),f.getImageData(-e,-e,n+2*e,u+2*e)},resolveURL:r=>(Zi||(Zi=j.document.createElement("a")),Zi.href=r,Zi.href),get devicePixelRatio(){return j.devicePixelRatio},get prefersReducedMotion(){return!!j.matchMedia&&(Ai==null&&(Ai=j.matchMedia("(prefers-reduced-motion: reduce)")),Ai.matches)}};function hr(r,e,n){n[r]&&n[r].indexOf(e)!==-1||(n[r]=n[r]||[],n[r].push(e))}function wr(r,e,n){if(n&&n[r]){const u=n[r].indexOf(e);u!==-1&&n[r].splice(u,1)}}class Mr{constructor(e,n={}){mr(this,n),this.type=e}}class Qi extends Mr{constructor(e,n={}){super("error",mr({error:e},n))}}class Pr{on(e,n){return this._listeners=this._listeners||{},hr(e,n,this._listeners),this}off(e,n){return wr(e,n,this._listeners),wr(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},hr(e,n,this._oneTimeListeners),this):new Promise(u=>this.once(e,u))}fire(e,n){typeof e=="string"&&(e=new Mr(e,n||{}));const u=e.type;if(this.listens(u)){e.target=this;const f=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const I of f)I.call(this,e);const g=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const I of g)wr(u,I,this._oneTimeListeners),I.call(this,e);const b=this._eventedParent;b&&(mr(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(e))}else e instanceof Qi&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var It=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Tn(r,...e){for(const n of e)for(const u in n)r[u]=n[u];return r}function Cr(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function En(r){if(Array.isArray(r))return r.map(En);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const n in r)e[n]=En(r[n]);return e}return Cr(r)}class ln extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var xs=ln;class eu{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[u,f]of n)this.bindings[u]=f}concat(e){return new eu(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Eh=eu;const $l={kind:"null"},Di={kind:"number"},$r={kind:"string"},Ar={kind:"boolean"},ss={kind:"color"},qs={kind:"object"},Br={kind:"value"},vs={kind:"collator"},na={kind:"formatted"},oa={kind:"resolvedImage"};function Po(r,e){return{kind:"array",itemType:r,N:e}}function Sn(r){if(r.kind==="array"){const e=Sn(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const tu=[$l,Di,$r,Ar,ss,na,qs,Po(Br),oa];function bs(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!bs(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const n of tu)if(!bs(n,e))return null}}return`Expected ${Sn(r)} but found ${Sn(e)} instead.`}function Zl(r,e){return e.some(n=>n.kind===r.kind)}function cl(r,e){return e.some(n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r)}var ql,Bn={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Na(r){return(r=Math.round(r))<0?0:r>255?255:r}function Tc(r){return Na(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function iu(r){return(e=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function ul(r,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?r+(e-r)*n*6:2*n<1?e:3*n<2?r+(e-r)*(2/3-n)*6:r}try{ql={}.parseCSSColor=function(r){var e,n=r.replace(/ /g,"").toLowerCase();if(n in Bn)return Bn[n].slice();if(n[0]==="#")return n.length===4?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:n.length===7&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=n.indexOf("("),f=n.indexOf(")");if(u!==-1&&f+1===n.length){var g=n.substr(0,u),b=n.substr(u+1,f-(u+1)).split(","),I=1;switch(g){case"rgba":if(b.length!==4)return null;I=iu(b.pop());case"rgb":return b.length!==3?null:[Tc(b[0]),Tc(b[1]),Tc(b[2]),I];case"hsla":if(b.length!==4)return null;I=iu(b.pop());case"hsl":if(b.length!==3)return null;var z=(parseFloat(b[0])%360+360)%360/360,R=iu(b[1]),N=iu(b[2]),$=N<=.5?N*(R+1):N+R-N*R,W=2*N-$;return[Na(255*ul(W,$,z+1/3)),Na(255*ul(W,$,z)),Na(255*ul(W,$,z-1/3)),I];default:return null}}return null}}catch{}class ko{constructor(e,n,u,f=1){this.r=e,this.g=n,this.b=u,this.a=f}static parse(e){if(!e)return;if(e instanceof ko)return e;if(typeof e!="string")return;const n=ql(e);return n?new ko(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,u,f]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(u)},${f})`}toArray(){const{r:e,g:n,b:u,a:f}=this;return f===0?[0,0,0,0]:[255*e/f,255*n/f,255*u/f,f]}toArray01(){const{r:e,g:n,b:u,a:f}=this;return f===0?[0,0,0,0]:[e/f,n/f,u/f,f]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:u,a:f}=this;return[e,n,u,f]}}ko.black=new ko(0,0,0,1),ko.white=new ko(1,1,1,1),ko.transparent=new ko(0,0,0,0),ko.red=new ko(1,0,0,1),ko.blue=new ko(0,0,1,1);var Kn=ko;class Sh{constructor(e,n,u){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Mh{constructor(e,n,u,f,g){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=u,this.fontStack=f,this.textColor=g}}class Ho{constructor(e){this.sections=e}static fromString(e){return new Ho([new Mh(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Ho?e:Ho.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const u={};n.fontStack&&(u["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(u["font-scale"]=n.scale),n.textColor&&(u["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(u)}return e}}class ws{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ws({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Ou(r,e,n,u){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[r,e,n,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[r,e,n,u]:[r,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wl(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Kn||r instanceof Sh||r instanceof Ho||r instanceof ws)return!0;if(Array.isArray(r)){for(const e of r)if(!Wl(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Wl(r[e]))return!1;return!0}return!1}function _r(r){if(r===null)return $l;if(typeof r=="string")return $r;if(typeof r=="boolean")return Ar;if(typeof r=="number")return Di;if(r instanceof Kn)return ss;if(r instanceof Sh)return vs;if(r instanceof Ho)return na;if(r instanceof ws)return oa;if(Array.isArray(r)){const e=r.length;let n;for(const u of r){const f=_r(u);if(n){if(n===f)continue;n=Br;break}n=f}return Po(n||Br,e)}return qs}function Ec(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof Kn||r instanceof Ho||r instanceof ws?r.toString():JSON.stringify(r)}class Ch{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Wl(e[1]))return n.error("invalid value");const u=e[1];let f=_r(u);const g=n.expectedType;return f.kind!=="array"||f.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(f=g),new Ch(f,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Kn?["rgba"].concat(this.value.toArray()):this.value instanceof Ho?this.value.serialize():this.value}}var sa=Ch,ao=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const Uu={string:$r,number:Di,boolean:Ar,object:qs};class as{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let u,f=1;const g=e[0];if(g==="array"){let I,z;if(e.length>2){const R=e[1];if(typeof R!="string"||!(R in Uu)||R==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);I=Uu[R],f++}else I=Br;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);z=e[2],f++}u=Po(I,z)}else u=Uu[g];const b=[];for(;f<e.length;f++){const I=n.parse(e[f],f,Br);if(!I)return null;b.push(I)}return new as(u,b)}evaluate(e){for(let n=0;n<this.args.length;n++){const u=this.args[n].evaluate(e);if(!bs(this.type,_r(u)))return u;if(n===this.args.length-1)throw new ao(`Expected value to be of type ${Sn(this.type)}, but found ${Sn(_r(u))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const u=e.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){n.push(u.kind);const f=e.N;(typeof f=="number"||this.args.length>1)&&n.push(f)}}return n.concat(this.args.map(u=>u.serialize()))}}var aa=as;class la{constructor(e){this.type=na,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const u=e[1];if(!Array.isArray(u)&&typeof u=="object")return n.error("First argument must be an image or text section.");const f=[];let g=!1;for(let b=1;b<=e.length-1;++b){const I=e[b];if(g&&typeof I=="object"&&!Array.isArray(I)){g=!1;let z=null;if(I["font-scale"]&&(z=n.parse(I["font-scale"],1,Di),!z))return null;let R=null;if(I["text-font"]&&(R=n.parse(I["text-font"],1,Po($r)),!R))return null;let N=null;if(I["text-color"]&&(N=n.parse(I["text-color"],1,ss),!N))return null;const $=f[f.length-1];$.scale=z,$.font=R,$.textColor=N}else{const z=n.parse(e[b],1,Br);if(!z)return null;const R=z.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,f.push({content:z,scale:null,font:null,textColor:null})}}return new la(f)}evaluate(e){return new Ho(this.sections.map(n=>{const u=n.content.evaluate(e);return _r(u)===oa?new Mh("",u,null,null,null):new Mh(Ec(u),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const u={};n.scale&&(u["font-scale"]=n.scale.serialize()),n.font&&(u["text-font"]=n.font.serialize()),n.textColor&&(u["text-color"]=n.textColor.serialize()),e.push(u)}return e}}class Xl{constructor(e){this.type=oa,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const u=n.parse(e[1],1,$r);return u?new Xl(u):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),u=ws.fromString(n);return u&&e.availableImages&&(u.available=e.availableImages.indexOf(n)>-1),u}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ih={"to-boolean":Ar,"to-color":ss,"to-number":Di,"to-string":$r};class ru{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const u=e[0];if((u==="to-boolean"||u==="to-string")&&e.length!==2)return n.error("Expected one argument.");const f=Ih[u],g=[];for(let b=1;b<e.length;b++){const I=n.parse(e[b],b,Br);if(!I)return null;g.push(I)}return new ru(f,g)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let n,u;for(const f of this.args){if(n=f.evaluate(e),u=null,n instanceof Kn)return n;if(typeof n=="string"){const g=e.parseColor(n);if(g)return g}else if(Array.isArray(n)&&(u=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Ou(n[0],n[1],n[2],n[3]),!u))return new Kn(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new ao(u||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const u of this.args){if(n=u.evaluate(e),n===null)return 0;const f=Number(n);if(!isNaN(f))return f}throw new ao(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?Ho.fromString(Ec(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ws.fromString(Ec(this.args[0].evaluate(e))):Ec(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new la([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Xl(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Va=ru;const Ws=["Unknown","Point","LineString","Polygon"];var nu=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ws[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-r[0])+this.featureDistanceData.bearing[1]*(u*e-r[1])}return 0}parseColor(r){let e=this._parseColorCache[r];return e||(e=this._parseColorCache[r]=Kn.parse(r)),e}};class ya{constructor(e,n,u,f){this.name=e,this.type=n,this._evaluate=u,this.args=f}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const u=e[0],f=ya.definitions[u];if(!f)return n.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(f)?f[0]:f.type,b=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,I=b.filter(([R])=>!Array.isArray(R)||R.length===e.length-1);let z=null;for(const[R,N]of I){z=new Kl(n.registry,n.path,null,n.scope);const $=[];let W=!1;for(let Q=1;Q<e.length;Q++){const te=e[Q],ce=Array.isArray(R)?R[Q-1]:R.type,we=z.parse(te,1+$.length,ce);if(!we){W=!0;break}$.push(we)}if(!W)if(Array.isArray(R)&&R.length!==$.length)z.error(`Expected ${R.length} arguments, but found ${$.length} instead.`);else{for(let Q=0;Q<$.length;Q++){const te=Array.isArray(R)?R[Q]:R.type,ce=$[Q];z.concat(Q+1).checkSubtype(te,ce.type)}if(z.errors.length===0)return new ya(u,g,N,$)}}if(I.length===1)n.errors.push(...z.errors);else{const R=(I.length?I:b).map(([$])=>{return W=$,Array.isArray(W)?`(${W.map(Sn).join(", ")})`:`(${Sn(W.type)}...)`;var W}).join(" | "),N=[];for(let $=1;$<e.length;$++){const W=n.parse(e[$],1+N.length);if(!W)return null;N.push(Sn(W.type))}n.error(`Expected arguments of type ${R}, but found (${N.join(", ")}) instead.`)}return null}static register(e,n){ya.definitions=n;for(const u in n)e[u]=ya}}var xa=ya;class Sc{constructor(e,n,u){this.type=vs,this.locale=u,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const u=e[1];if(typeof u!="object"||Array.isArray(u))return n.error("Collator options argument must be an object.");const f=n.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Ar);if(!f)return null;const g=n.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Ar);if(!g)return null;let b=null;return u.locale&&(b=n.parse(u.locale,1,$r),!b)?null:new Sc(f,g,b)}evaluate(e){return new Sh(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Ts=8192;function Nu(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function Mc(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function ou(r,e){const n=(180+r[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,f=Math.pow(2,e.z);return[Math.round(n*f*Ts),Math.round(u*f*Ts)]}function p1(r,e,n){const u=r[0]-e[0],f=r[1]-e[1],g=r[0]-n[0],b=r[1]-n[1];return u*b-g*f==0&&u*g<=0&&f*b<=0}function Vu(r,e){let n=!1;for(let b=0,I=e.length;b<I;b++){const z=e[b];for(let R=0,N=z.length;R<N-1;R++){if(p1(r,z[R],z[R+1]))return!1;(f=z[R])[1]>(u=r)[1]!=(g=z[R+1])[1]>u[1]&&u[0]<(g[0]-f[0])*(u[1]-f[1])/(g[1]-f[1])+f[0]&&(n=!n)}}var u,f,g;return n}function Ah(r,e){for(let n=0;n<e.length;n++)if(Vu(r,e[n]))return!0;return!1}function su(r,e,n,u){const f=u[0]-n[0],g=u[1]-n[1],b=(r[0]-n[0])*g-f*(r[1]-n[1]),I=(e[0]-n[0])*g-f*(e[1]-n[1]);return b>0&&I<0||b<0&&I>0}function ja(r,e,n){for(const R of n)for(let N=0;N<R.length-1;++N)if((I=[(b=R[N+1])[0]-(g=R[N])[0],b[1]-g[1]])[0]*(z=[(f=e)[0]-(u=r)[0],f[1]-u[1]])[1]-I[1]*z[0]!=0&&su(u,f,g,b)&&su(g,b,u,f))return!0;var u,f,g,b,I,z;return!1}function Qr(r,e){for(let n=0;n<r.length;++n)if(!Vu(r[n],e))return!1;for(let n=0;n<r.length-1;++n)if(ja(r[n],r[n+1],e))return!1;return!0}function Ph(r,e){for(let n=0;n<e.length;n++)if(Qr(r,e[n]))return!0;return!1}function hl(r,e,n){const u=[];for(let f=0;f<r.length;f++){const g=[];for(let b=0;b<r[f].length;b++){const I=ou(r[f][b],n);Nu(e,I),g.push(I)}u.push(g)}return u}function kh(r,e,n){const u=[];for(let f=0;f<r.length;f++){const g=hl(r[f],e,n);u.push(g)}return u}function ju(r,e,n,u){if(r[0]<n[0]||r[0]>n[2]){const f=.5*u;let g=r[0]-n[0]>f?-u:n[0]-r[0]>f?u:0;g===0&&(g=r[0]-n[2]>f?-u:n[2]-r[0]>f?u:0),r[0]+=g}Nu(e,r)}function au(r,e,n,u){const f=Math.pow(2,u.z)*Ts,g=[u.x*Ts,u.y*Ts],b=[];if(!r)return b;for(const I of r)for(const z of I){const R=[z.x+g[0],z.y+g[1]];ju(R,e,n,f),b.push(R)}return b}function Ga(r,e,n,u){const f=Math.pow(2,u.z)*Ts,g=[u.x*Ts,u.y*Ts],b=[];if(!r)return b;for(const z of r){const R=[];for(const N of z){const $=[N.x+g[0],N.y+g[1]];Nu(e,$),R.push($)}b.push(R)}if(e[2]-e[0]<=f/2){(I=e)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const z of b)for(const R of z)ju(R,e,n,f)}var I;return b}class Hl{constructor(e,n){this.type=Ar,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Wl(e[1])){const u=e[1];if(u.type==="FeatureCollection")for(let f=0;f<u.features.length;++f){const g=u.features[f].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Hl(u,u.features[f].geometry)}else if(u.type==="Feature"){const f=u.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Hl(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Hl(u,u)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,u){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],b=n.canonicalID();if(!b)return!1;if(u.type==="Polygon"){const I=hl(u.coordinates,g,b),z=au(n.geometry(),f,g,b);if(!Mc(f,g))return!1;for(const R of z)if(!Vu(R,I))return!1}if(u.type==="MultiPolygon"){const I=kh(u.coordinates,g,b),z=au(n.geometry(),f,g,b);if(!Mc(f,g))return!1;for(const R of z)if(!Ah(R,I))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,u){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],b=n.canonicalID();if(!b)return!1;if(u.type==="Polygon"){const I=hl(u.coordinates,g,b),z=Ga(n.geometry(),f,g,b);if(!Mc(f,g))return!1;for(const R of z)if(!Qr(R,I))return!1}if(u.type==="MultiPolygon"){const I=kh(u.coordinates,g,b),z=Ga(n.geometry(),f,g,b);if(!Mc(f,g))return!1;for(const R of z)if(!Ph(R,I))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var $a=Hl;function _n(r){if(r instanceof xa&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof $a)return!1;let e=!0;return r.eachChild(n=>{e&&!_n(n)&&(e=!1)}),e}function va(r){if(r instanceof xa&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(n=>{e&&!va(n)&&(e=!1)}),e}function kr(r,e){if(r instanceof xa&&e.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild(u=>{n&&!kr(u,e)&&(n=!1)}),n}class en{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const u=e[1];return n.scope.has(u)?new en(u,n.scope.get(u)):n.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Pn=en;class Mn{constructor(e,n=[],u,f=new Eh,g=[]){this.registry=e,this.path=n,this.key=n.map(b=>`[${b}]`).join(""),this.scope=f,this.errors=g,this.expectedType=u}parse(e,n,u,f,g={}){return n?this.concat(n,u,f)._parse(e,g):this._parse(e,g)}_parse(e,n){function u(f,g,b){return b==="assert"?new aa(g,[f]):b==="coerce"?new Va(g,[f]):f}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=e[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[f];if(g){let b=g.parse(e,this);if(!b)return null;if(this.expectedType){const I=this.expectedType,z=b.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||z.kind!=="value")if(I.kind!=="color"&&I.kind!=="formatted"&&I.kind!=="resolvedImage"||z.kind!=="value"&&z.kind!=="string"){if(this.checkSubtype(I,z))return null}else b=u(b,I,n.typeAnnotation||"coerce");else b=u(b,I,n.typeAnnotation||"assert")}if(!(b instanceof sa)&&b.type.kind!=="resolvedImage"&&dl(b)){const I=new nu;try{b=new sa(b.type,b.evaluate(I))}catch(z){return this.error(z.message),null}}return b}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,u){const f=typeof e=="number"?this.path.concat(e):this.path,g=u?this.scope.concat(u):this.scope;return new Mn(this.registry,f,n||null,g,this.errors)}error(e,...n){const u=`${this.key}${n.map(f=>`[${f}]`).join("")}`;this.errors.push(new xs(u,e))}checkSubtype(e,n){const u=bs(e,n);return u&&this.error(u),u}}var Kl=Mn;function dl(r){if(r instanceof Pn)return dl(r.boundExpression);if(r instanceof xa&&r.name==="error"||r instanceof Sc||r instanceof $a)return!1;const e=r instanceof Va||r instanceof aa;let n=!0;return r.eachChild(u=>{n=e?n&&dl(u):n&&u instanceof sa}),!!n&&_n(r)&&kr(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Gu(r,e){const n=r.length-1;let u,f,g=0,b=n,I=0;for(;g<=b;)if(I=Math.floor((g+b)/2),u=r[I],f=r[I+1],u<=e){if(I===n||e<f)return I;g=I+1}else{if(!(u>e))throw new ao("Input is not a number.");b=I-1}return 0}class $u{constructor(e,n,u){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[f,g]of u)this.labels.push(f),this.outputs.push(g)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const u=n.parse(e[1],1,Di);if(!u)return null;const f=[];let g=null;n.expectedType&&n.expectedType.kind!=="value"&&(g=n.expectedType);for(let b=1;b<e.length;b+=2){const I=b===1?-1/0:e[b],z=e[b+1],R=b,N=b+1;if(typeof I!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(f.length&&f[f.length-1][0]>=I)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const $=n.parse(z,N,g);if(!$)return null;g=g||$.type,f.push([I,$])}return new $u(g,u,f)}evaluate(e){const n=this.labels,u=this.outputs;if(n.length===1)return u[0].evaluate(e);const f=this.input.evaluate(e);if(f<=n[0])return u[0].evaluate(e);const g=n.length;return f>=n[g-1]?u[g-1].evaluate(e):u[Gu(n,f)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var Zu=$u;function Kr(r,e,n){return r*(1-n)+e*n}var pl=Object.freeze({__proto__:null,array:function(r,e,n){return r.map((u,f)=>Kr(u,e[f],n))},color:function(r,e,n){return new Kn(Kr(r.r,e.r,n),Kr(r.g,e.g,n),Kr(r.b,e.b,n),Kr(r.a,e.a,n))},number:Kr});const Cc=.95047,Yl=1.08883,Ic=4/29,Za=6/29,qu=3*Za*Za,Wu=Za*Za*Za,Xu=Math.PI/180,ca=180/Math.PI;function Hu(r){return r>Wu?Math.pow(r,1/3):r/qu+Ic}function lu(r){return r>Za?r*r*r:qu*(r-Ic)}function Ku(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function ba(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Ac(r){const e=ba(r.r),n=ba(r.g),u=ba(r.b),f=Hu((.4124564*e+.3575761*n+.1804375*u)/Cc),g=Hu((.2126729*e+.7151522*n+.072175*u)/1);return{l:116*g-16,a:500*(f-g),b:200*(g-Hu((.0193339*e+.119192*n+.9503041*u)/Yl)),alpha:r.a}}function Jl(r){let e=(r.l+16)/116,n=isNaN(r.a)?e:e+r.a/500,u=isNaN(r.b)?e:e-r.b/200;return e=1*lu(e),n=Cc*lu(n),u=Yl*lu(u),new Kn(Ku(3.2404542*n-1.5371385*e-.4985314*u),Ku(-.969266*n+1.8760108*e+.041556*u),Ku(.0556434*n-.2040259*e+1.0572252*u),r.alpha)}function wd(r,e,n){const u=e-r;return r+n*(u>180||u<-180?u-360*Math.round(u/360):u)}const fl={forward:Ac,reverse:Jl,interpolate:function(r,e,n){return{l:Kr(r.l,e.l,n),a:Kr(r.a,e.a,n),b:Kr(r.b,e.b,n),alpha:Kr(r.alpha,e.alpha,n)}}},Ql={forward:function(r){const{l:e,a:n,b:u}=Ac(r),f=Math.atan2(u,n)*ca;return{h:f<0?f+360:f,c:Math.sqrt(n*n+u*u),l:e,alpha:r.a}},reverse:function(r){const e=r.h*Xu,n=r.c;return Jl({l:r.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:r.alpha})},interpolate:function(r,e,n){return{h:wd(r.h,e.h,n),c:Kr(r.c,e.c,n),l:Kr(r.l,e.l,n),alpha:Kr(r.alpha,e.alpha,n)}}};var Yu=Object.freeze({__proto__:null,hcl:Ql,lab:fl});class qa{constructor(e,n,u,f,g){this.type=e,this.operator=n,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(const[b,I]of g)this.labels.push(b),this.outputs.push(I)}static interpolationFactor(e,n,u,f){let g=0;if(e.name==="exponential")g=cu(n,e.base,u,f);else if(e.name==="linear")g=cu(n,1,u,f);else if(e.name==="cubic-bezier"){const b=e.controlPoints;g=new ci(b[0],b[1],b[2],b[3]).solve(cu(n,1,u,f))}return g}static parse(e,n){let[u,f,g,...b]=e;if(!Array.isArray(f)||f.length===0)return n.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const R=f[1];if(typeof R!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:R}}else{if(f[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const R=f.slice(1);if(R.length!==4||R.some(N=>typeof N!="number"||N<0||N>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:R}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(g=n.parse(g,2,Di),!g)return null;const I=[];let z=null;u==="interpolate-hcl"||u==="interpolate-lab"?z=ss:n.expectedType&&n.expectedType.kind!=="value"&&(z=n.expectedType);for(let R=0;R<b.length;R+=2){const N=b[R],$=b[R+1],W=R+3,Q=R+4;if(typeof N!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(I.length&&I[I.length-1][0]>=N)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',W);const te=n.parse($,Q,z);if(!te)return null;z=z||te.type,I.push([N,te])}return z.kind==="number"||z.kind==="color"||z.kind==="array"&&z.itemType.kind==="number"&&typeof z.N=="number"?new qa(z,u,f,g,I):n.error(`Type ${Sn(z)} is not interpolatable.`)}evaluate(e){const n=this.labels,u=this.outputs;if(n.length===1)return u[0].evaluate(e);const f=this.input.evaluate(e);if(f<=n[0])return u[0].evaluate(e);const g=n.length;if(f>=n[g-1])return u[g-1].evaluate(e);const b=Gu(n,f),I=qa.interpolationFactor(this.interpolation,f,n[b],n[b+1]),z=u[b].evaluate(e),R=u[b+1].evaluate(e);return this.operator==="interpolate"?pl[this.type.kind.toLowerCase()](z,R,I):this.operator==="interpolate-hcl"?Ql.reverse(Ql.interpolate(Ql.forward(z),Ql.forward(R),I)):fl.reverse(fl.interpolate(fl.forward(z),fl.forward(R),I))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let u=0;u<this.labels.length;u++)n.push(this.labels[u],this.outputs[u].serialize());return n}}function cu(r,e,n,u){const f=u-n,g=r-n;return f===0?0:e===1?g/f:(Math.pow(e,g)-1)/(Math.pow(e,f)-1)}var Bs=qa;class ml{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let u=null;const f=n.expectedType;f&&f.kind!=="value"&&(u=f);const g=[];for(const I of e.slice(1)){const z=n.parse(I,1+g.length,u,void 0,{typeAnnotation:"omit"});if(!z)return null;u=u||z.type,g.push(z)}const b=f&&g.some(I=>bs(f,I.type));return new ml(b?Br:u,g)}evaluate(e){let n,u=null,f=0;for(const g of this.args){if(f++,u=g.evaluate(e),u&&u instanceof ws&&!u.available&&(n||(n=u),u=null,f===this.args.length))return n;if(u!==null)break}return u}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var _l=ml;class gl{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const u=[];for(let g=1;g<e.length-1;g+=2){const b=e[g];if(typeof b!="string")return n.error(`Expected string, but found ${typeof b} instead.`,g);if(/[^a-zA-Z0-9_]/.test(b))return n.error("Variable names must contain only alphanumeric characters or '_'.",g);const I=n.parse(e[g+1],g+1);if(!I)return null;u.push([b,I])}const f=n.parse(e[e.length-1],e.length-1,n.expectedType,u);return f?new gl(u,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,u]of this.bindings)e.push(n,u.serialize());return e.push(this.result.serialize()),e}}var zh=gl;class ec{constructor(e,n,u){this.type=e,this.index=n,this.input=u}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=n.parse(e[1],1,Di),f=n.parse(e[2],2,Po(n.expectedType||Br));return u&&f?new ec(f.type.itemType,u,f):null}evaluate(e){const n=this.index.evaluate(e),u=this.input.evaluate(e);if(n<0)throw new ao(`Array index out of bounds: ${n} < 0.`);if(n>=u.length)throw new ao(`Array index out of bounds: ${n} > ${u.length-1}.`);if(n!==Math.floor(n))throw new ao(`Array index must be an integer, but found ${n} instead.`);return u[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var f1=ec;class Ju{constructor(e,n){this.type=Ar,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=n.parse(e[1],1,Br),f=n.parse(e[2],2,Br);return u&&f?Zl(u.type,[Ar,$r,Di,$l,Br])?new Ju(u,f):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Sn(u.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(u==null)return!1;if(!cl(n,["boolean","string","number","null"]))throw new ao(`Expected first argument to be of type boolean, string, number or null, but found ${Sn(_r(n))} instead.`);if(!cl(u,["string","array"]))throw new ao(`Expected second argument to be of type array or string, but found ${Sn(_r(u))} instead.`);return u.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var uu=Ju;class wa{constructor(e,n,u){this.type=Di,this.needle=e,this.haystack=n,this.fromIndex=u}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=n.parse(e[1],1,Br),f=n.parse(e[2],2,Br);if(!u||!f)return null;if(!Zl(u.type,[Ar,$r,Di,$l,Br]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Sn(u.type)} instead`);if(e.length===4){const g=n.parse(e[3],3,Di);return g?new wa(u,f,g):null}return new wa(u,f)}evaluate(e){const n=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!cl(n,["boolean","string","number","null"]))throw new ao(`Expected first argument to be of type boolean, string, number or null, but found ${Sn(_r(n))} instead.`);if(!cl(u,["string","array"]))throw new ao(`Expected second argument to be of type array or string, but found ${Sn(_r(u))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(e);return u.indexOf(n,f)}return u.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Dh=wa;class tc{constructor(e,n,u,f,g,b){this.inputType=e,this.type=n,this.input=u,this.cases=f,this.outputs=g,this.otherwise=b}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let u,f;n.expectedType&&n.expectedType.kind!=="value"&&(f=n.expectedType);const g={},b=[];for(let R=2;R<e.length-1;R+=2){let N=e[R];const $=e[R+1];Array.isArray(N)||(N=[N]);const W=n.concat(R);if(N.length===0)return W.error("Expected at least one branch label.");for(const te of N){if(typeof te!="number"&&typeof te!="string")return W.error("Branch labels must be numbers or strings.");if(typeof te=="number"&&Math.abs(te)>Number.MAX_SAFE_INTEGER)return W.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof te=="number"&&Math.floor(te)!==te)return W.error("Numeric branch labels must be integer values.");if(u){if(W.checkSubtype(u,_r(te)))return null}else u=_r(te);if(g[String(te)]!==void 0)return W.error("Branch labels must be unique.");g[String(te)]=b.length}const Q=n.parse($,R,f);if(!Q)return null;f=f||Q.type,b.push(Q)}const I=n.parse(e[1],1,Br);if(!I)return null;const z=n.parse(e[e.length-1],e.length-1,f);return z?I.type.kind!=="value"&&n.concat(1).checkSubtype(u,I.type)?null:new tc(u,f,I,g,b,z):null}evaluate(e){const n=this.input.evaluate(e);return(_r(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),u=[],f={};for(const b of n){const I=f[this.cases[b]];I===void 0?(f[this.cases[b]]=u.length,u.push([this.cases[b],[b]])):u[I][1].push(b)}const g=b=>this.inputType.kind==="number"?Number(b):b;for(const[b,I]of u)e.push(I.length===1?g(I[0]):I.map(g)),e.push(this.outputs[b].serialize());return e.push(this.otherwise.serialize()),e}}var hu=tc;class ls{constructor(e,n,u){this.type=e,this.branches=n,this.otherwise=u}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let u;n.expectedType&&n.expectedType.kind!=="value"&&(u=n.expectedType);const f=[];for(let b=1;b<e.length-1;b+=2){const I=n.parse(e[b],b,Ar);if(!I)return null;const z=n.parse(e[b+1],b+1,u);if(!z)return null;f.push([I,z]),u=u||z.type}const g=n.parse(e[e.length-1],e.length-1,u);return g?new ls(u,f,g):null}evaluate(e){for(const[n,u]of this.branches)if(n.evaluate(e))return u.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,u]of this.branches)e(n),e(u);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Pc=ls;class zo{constructor(e,n,u,f){this.type=e,this.input=n,this.beginIndex=u,this.endIndex=f}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=n.parse(e[1],1,Br),f=n.parse(e[2],2,Di);if(!u||!f)return null;if(!Zl(u.type,[Po(Br),$r,Br]))return n.error(`Expected first argument to be of type array or string, but found ${Sn(u.type)} instead`);if(e.length===4){const g=n.parse(e[3],3,Di);return g?new zo(u.type,u,f,g):null}return new zo(u.type,u,f)}evaluate(e){const n=this.input.evaluate(e),u=this.beginIndex.evaluate(e);if(!cl(n,["string","array"]))throw new ao(`Expected first argument to be of type array or string, but found ${Sn(_r(n))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(e);return n.slice(u,f)}return n.slice(u)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var m1=zo;function ua(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Lh(r,e,n,u){return u.compare(e,n)===0}function Es(r,e,n){const u=r!=="=="&&r!=="!=";return class Ev{constructor(g,b,I){this.type=Ar,this.lhs=g,this.rhs=b,this.collator=I,this.hasUntypedArgument=g.type.kind==="value"||b.type.kind==="value"}static parse(g,b){if(g.length!==3&&g.length!==4)return b.error("Expected two or three arguments.");const I=g[0];let z=b.parse(g[1],1,Br);if(!z)return null;if(!ua(I,z.type))return b.concat(1).error(`"${I}" comparisons are not supported for type '${Sn(z.type)}'.`);let R=b.parse(g[2],2,Br);if(!R)return null;if(!ua(I,R.type))return b.concat(2).error(`"${I}" comparisons are not supported for type '${Sn(R.type)}'.`);if(z.type.kind!==R.type.kind&&z.type.kind!=="value"&&R.type.kind!=="value")return b.error(`Cannot compare types '${Sn(z.type)}' and '${Sn(R.type)}'.`);u&&(z.type.kind==="value"&&R.type.kind!=="value"?z=new aa(R.type,[z]):z.type.kind!=="value"&&R.type.kind==="value"&&(R=new aa(z.type,[R])));let N=null;if(g.length===4){if(z.type.kind!=="string"&&R.type.kind!=="string"&&z.type.kind!=="value"&&R.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(N=b.parse(g[3],3,vs),!N)return null}return new Ev(z,R,N)}evaluate(g){const b=this.lhs.evaluate(g),I=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){const z=_r(b),R=_r(I);if(z.kind!==R.kind||z.kind!=="string"&&z.kind!=="number")throw new ao(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${z.kind}, ${R.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const z=_r(b),R=_r(I);if(z.kind!=="string"||R.kind!=="string")return e(g,b,I)}return this.collator?n(g,b,I,this.collator.evaluate(g)):e(g,b,I)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[r];return this.eachChild(b=>{g.push(b.serialize())}),g}}}const du=Es("==",function(r,e,n){return e===n},Lh),Rh=Es("!=",function(r,e,n){return e!==n},function(r,e,n,u){return!Lh(0,e,n,u)}),Td=Es("<",function(r,e,n){return e<n},function(r,e,n,u){return u.compare(e,n)<0}),Ed=Es(">",function(r,e,n){return e>n},function(r,e,n,u){return u.compare(e,n)>0}),Qu=Es("<=",function(r,e,n){return e<=n},function(r,e,n,u){return u.compare(e,n)<=0}),kc=Es(">=",function(r,e,n){return e>=n},function(r,e,n,u){return u.compare(e,n)>=0});class Xs{constructor(e,n,u,f,g,b){this.type=$r,this.number=e,this.locale=n,this.currency=u,this.unit=f,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const u=n.parse(e[1],1,Di);if(!u)return null;const f=e[2];if(typeof f!="object"||Array.isArray(f))return n.error("NumberFormat options argument must be an object.");let g=null;if(f.locale&&(g=n.parse(f.locale,1,$r),!g))return null;let b=null;if(f.currency&&(b=n.parse(f.currency,1,$r),!b))return null;let I=null;if(f.unit&&(I=n.parse(f.unit,1,$r),!I))return null;let z=null;if(f["min-fraction-digits"]&&(z=n.parse(f["min-fraction-digits"],1,Di),!z))return null;let R=null;return f["max-fraction-digits"]&&(R=n.parse(f["max-fraction-digits"],1,Di),!R)?null:new Xs(u,g,b,I,z,R)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Gi{constructor(e){this.type=Di,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const u=n.parse(e[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Sn(u.type)} instead.`):new Gi(u):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new ao(`Expected value to be of type string or array, but found ${Sn(_r(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const Bh={"==":du,"!=":Rh,">":Ed,"<":Td,">=":kc,"<=":Qu,array:aa,at:f1,boolean:aa,case:Pc,coalesce:_l,collator:Sc,format:la,image:Xl,in:uu,"index-of":Dh,interpolate:Bs,"interpolate-hcl":Bs,"interpolate-lab":Bs,length:Gi,let:zh,literal:sa,match:hu,number:aa,"number-format":Xs,object:aa,slice:m1,step:Zu,string:aa,"to-boolean":Va,"to-color":Va,"to-number":Va,"to-string":Va,var:Pn,within:$a};function yl(r,[e,n,u,f]){e=e.evaluate(r),n=n.evaluate(r),u=u.evaluate(r);const g=f?f.evaluate(r):1,b=Ou(e,n,u,g);if(b)throw new ao(b);return new Kn(e/255*g,n/255*g,u/255*g,g)}function Ko(r,e){return r in e}function zc(r,e){const n=e[r];return n===void 0?null:n}function Pi(r){return{type:r}}xa.register(Bh,{error:[{kind:"error"},[$r],(r,[e])=>{throw new ao(e.evaluate(r))}],typeof:[$r,[Br],(r,[e])=>Sn(_r(e.evaluate(r)))],"to-rgba":[Po(Di,4),[ss],(r,[e])=>e.evaluate(r).toArray()],rgb:[ss,[Di,Di,Di],yl],rgba:[ss,[Di,Di,Di,Di],yl],has:{type:Ar,overloads:[[[$r],(r,[e])=>Ko(e.evaluate(r),r.properties())],[[$r,qs],(r,[e,n])=>Ko(e.evaluate(r),n.evaluate(r))]]},get:{type:Br,overloads:[[[$r],(r,[e])=>zc(e.evaluate(r),r.properties())],[[$r,qs],(r,[e,n])=>zc(e.evaluate(r),n.evaluate(r))]]},"feature-state":[Br,[$r],(r,[e])=>zc(e.evaluate(r),r.featureState||{})],properties:[qs,[],r=>r.properties()],"geometry-type":[$r,[],r=>r.geometryType()],id:[Br,[],r=>r.id()],zoom:[Di,[],r=>r.globals.zoom],pitch:[Di,[],r=>r.globals.pitch||0],"distance-from-center":[Di,[],r=>r.distanceFromCenter()],"heatmap-density":[Di,[],r=>r.globals.heatmapDensity||0],"line-progress":[Di,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[Di,[],r=>r.globals.skyRadialProgress||0],accumulated:[Br,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Di,Pi(Di),(r,e)=>{let n=0;for(const u of e)n+=u.evaluate(r);return n}],"*":[Di,Pi(Di),(r,e)=>{let n=1;for(const u of e)n*=u.evaluate(r);return n}],"-":{type:Di,overloads:[[[Di,Di],(r,[e,n])=>e.evaluate(r)-n.evaluate(r)],[[Di],(r,[e])=>-e.evaluate(r)]]},"/":[Di,[Di,Di],(r,[e,n])=>e.evaluate(r)/n.evaluate(r)],"%":[Di,[Di,Di],(r,[e,n])=>e.evaluate(r)%n.evaluate(r)],ln2:[Di,[],()=>Math.LN2],pi:[Di,[],()=>Math.PI],e:[Di,[],()=>Math.E],"^":[Di,[Di,Di],(r,[e,n])=>Math.pow(e.evaluate(r),n.evaluate(r))],sqrt:[Di,[Di],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Di,[Di],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Di,[Di],(r,[e])=>Math.log(e.evaluate(r))],log2:[Di,[Di],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Di,[Di],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Di,[Di],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Di,[Di],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Di,[Di],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Di,[Di],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Di,[Di],(r,[e])=>Math.atan(e.evaluate(r))],min:[Di,Pi(Di),(r,e)=>Math.min(...e.map(n=>n.evaluate(r)))],max:[Di,Pi(Di),(r,e)=>Math.max(...e.map(n=>n.evaluate(r)))],abs:[Di,[Di],(r,[e])=>Math.abs(e.evaluate(r))],round:[Di,[Di],(r,[e])=>{const n=e.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[Di,[Di],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Di,[Di],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[Ar,[$r,Br],(r,[e,n])=>r.properties()[e.value]===n.value],"filter-id-==":[Ar,[Br],(r,[e])=>r.id()===e.value],"filter-type-==":[Ar,[$r],(r,[e])=>r.geometryType()===e.value],"filter-<":[Ar,[$r,Br],(r,[e,n])=>{const u=r.properties()[e.value],f=n.value;return typeof u==typeof f&&u<f}],"filter-id-<":[Ar,[Br],(r,[e])=>{const n=r.id(),u=e.value;return typeof n==typeof u&&n<u}],"filter->":[Ar,[$r,Br],(r,[e,n])=>{const u=r.properties()[e.value],f=n.value;return typeof u==typeof f&&u>f}],"filter-id->":[Ar,[Br],(r,[e])=>{const n=r.id(),u=e.value;return typeof n==typeof u&&n>u}],"filter-<=":[Ar,[$r,Br],(r,[e,n])=>{const u=r.properties()[e.value],f=n.value;return typeof u==typeof f&&u<=f}],"filter-id-<=":[Ar,[Br],(r,[e])=>{const n=r.id(),u=e.value;return typeof n==typeof u&&n<=u}],"filter->=":[Ar,[$r,Br],(r,[e,n])=>{const u=r.properties()[e.value],f=n.value;return typeof u==typeof f&&u>=f}],"filter-id->=":[Ar,[Br],(r,[e])=>{const n=r.id(),u=e.value;return typeof n==typeof u&&n>=u}],"filter-has":[Ar,[Br],(r,[e])=>e.value in r.properties()],"filter-has-id":[Ar,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Ar,[Po($r)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[Ar,[Po(Br)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[Ar,[$r,Po(Br)],(r,[e,n])=>n.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[Ar,[$r,Po(Br)],(r,[e,n])=>function(u,f,g,b){for(;g<=b;){const I=g+b>>1;if(f[I]===u)return!0;f[I]>u?b=I-1:g=I+1}return!1}(r.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Ar,overloads:[[[Ar,Ar],(r,[e,n])=>e.evaluate(r)&&n.evaluate(r)],[Pi(Ar),(r,e)=>{for(const n of e)if(!n.evaluate(r))return!1;return!0}]]},any:{type:Ar,overloads:[[[Ar,Ar],(r,[e,n])=>e.evaluate(r)||n.evaluate(r)],[Pi(Ar),(r,e)=>{for(const n of e)if(n.evaluate(r))return!0;return!1}]]},"!":[Ar,[Ar],(r,[e])=>!e.evaluate(r)],"is-supported-script":[Ar,[$r],(r,[e])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(e.evaluate(r))}],upcase:[$r,[$r],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[$r,[$r],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[$r,Pi(Br),(r,e)=>e.map(n=>Ec(n.evaluate(r))).join("")],"resolved-locale":[$r,[vs],(r,[e])=>e.evaluate(r).resolvedLocale()]});var xl=Bh;function _1(r){return{result:"success",value:r}}function Wa(r){return{result:"error",value:r}}function vl(r){return r["property-type"]==="data-driven"}function pu(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function fu(r){return!!r.expression&&r.expression.interpolated}function tn(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Dc(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function eh(r){return r}function Lc(r,e){const n=e.type==="color",u=r.stops&&typeof r.stops[0][0]=="object",f=u||!(u||r.property!==void 0),g=r.type||(fu(e)?"exponential":"interval");if(n&&((r=Tn({},r)).stops&&(r.stops=r.stops.map(R=>[R[0],Kn.parse(R[1])])),r.default=Kn.parse(r.default?r.default:e.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!Yu[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let b,I,z;if(g==="exponential")b=Yo;else if(g==="interval")b=Do;else if(g==="categorical"){b=th,I=Object.create(null);for(const R of r.stops)I[R[0]]=R[1];z=typeof r.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);b=Fh}if(u){const R={},N=[];for(let Q=0;Q<r.stops.length;Q++){const te=r.stops[Q],ce=te[0].zoom;R[ce]===void 0&&(R[ce]={zoom:ce,type:r.type,property:r.property,default:r.default,stops:[]},N.push(ce)),R[ce].stops.push([te[0].value,te[1]])}const $=[];for(const Q of N)$.push([R[Q].zoom,Lc(R[Q],e)]);const W={name:"linear"};return{kind:"composite",interpolationType:W,interpolationFactor:Bs.interpolationFactor.bind(void 0,W),zoomStops:$.map(Q=>Q[0]),evaluate:({zoom:Q},te)=>Yo({stops:$,base:r.base},e,Q).evaluate(Q,te)}}if(f){const R=g==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Bs.interpolationFactor.bind(void 0,R),zoomStops:r.stops.map(N=>N[0]),evaluate:({zoom:N})=>b(r,e,N,I,z)}}return{kind:"source",evaluate(R,N){const $=N&&N.properties?N.properties[r.property]:void 0;return $===void 0?bl(r.default,e.default):b(r,e,$,I,z)}}}function bl(r,e,n){return r!==void 0?r:e!==void 0?e:n!==void 0?n:void 0}function th(r,e,n,u,f){return bl(typeof n===f?u[n]:void 0,r.default,e.default)}function Do(r,e,n){if(tn(n)!=="number")return bl(r.default,e.default);const u=r.stops.length;if(u===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[u-1][0])return r.stops[u-1][1];const f=Gu(r.stops.map(g=>g[0]),n);return r.stops[f][1]}function Yo(r,e,n){const u=r.base!==void 0?r.base:1;if(tn(n)!=="number")return bl(r.default,e.default);const f=r.stops.length;if(f===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[f-1][0])return r.stops[f-1][1];const g=Gu(r.stops.map(N=>N[0]),n),b=function(N,$,W,Q){const te=Q-W,ce=N-W;return te===0?0:$===1?ce/te:(Math.pow($,ce)-1)/(Math.pow($,te)-1)}(n,u,r.stops[g][0],r.stops[g+1][0]),I=r.stops[g][1],z=r.stops[g+1][1];let R=pl[e.type]||eh;if(r.colorSpace&&r.colorSpace!=="rgb"){const N=Yu[r.colorSpace];R=($,W)=>N.reverse(N.interpolate(N.forward($),N.forward(W),b))}return typeof I.evaluate=="function"?{evaluate(...N){const $=I.evaluate.apply(void 0,N),W=z.evaluate.apply(void 0,N);if($!==void 0&&W!==void 0)return R($,W,b)}}:R(I,z,b)}function Fh(r,e,n){return e.type==="color"?n=Kn.parse(n):e.type==="formatted"?n=Ho.fromString(n.toString()):e.type==="resolvedImage"?n=ws.fromString(n.toString()):tn(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),bl(n,r.default,e.default)}class Xa{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new nu,this._defaultValue=n?function(u){return u.type==="color"&&(Dc(u.default)||Array.isArray(u.default))?new Kn(0,0,0,0):u.type==="color"?Kn.parse(u.default)||null:u.default===void 0?null:u.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,u,f,g,b,I,z){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=u,this._evaluator.canonical=f||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=I||null,this._evaluator.featureDistanceData=z||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,u,f,g,b,I,z){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=u||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=I||null,this._evaluator.featureDistanceData=z||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new ao(`Expected value to be one of ${Object.keys(this._enumValues).map(N=>JSON.stringify(N)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function wl(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in xl}function Ta(r,e){const n=new Kl(xl,[],e?function(f){const g={color:ss,string:$r,number:Di,enum:$r,boolean:Ar,formatted:na,resolvedImage:oa};return f.type==="array"?Po(g[f.value]||Br,f.length):g[f.type]}(e):void 0),u=n.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?_1(new Xa(u,e)):Wa(n.errors)}class ih{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!va(n.expression)}evaluateWithoutErrorHandling(e,n,u,f,g,b){return this._styleExpression.evaluateWithoutErrorHandling(e,n,u,f,g,b)}evaluate(e,n,u,f,g,b){return this._styleExpression.evaluate(e,n,u,f,g,b)}}class Jo{constructor(e,n,u,f){this.kind=e,this.zoomStops=u,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!va(n.expression),this.interpolationType=f}evaluateWithoutErrorHandling(e,n,u,f,g,b){return this._styleExpression.evaluateWithoutErrorHandling(e,n,u,f,g,b)}evaluate(e,n,u,f,g,b){return this._styleExpression.evaluate(e,n,u,f,g,b)}interpolationFactor(e,n,u){return this.interpolationType?Bs.interpolationFactor(this.interpolationType,e,n,u):0}}function Cn(r,e){if((r=Ta(r,e)).result==="error")return r;const n=r.value.expression,u=_n(n);if(!u&&!vl(e))return Wa([new xs("","data expressions not supported")]);const f=kr(n,["zoom","pitch","distance-from-center"]);if(!f&&!pu(e))return Wa([new xs("","zoom expressions not supported")]);const g=ic(n);return g||f?g instanceof xs?Wa([g]):g instanceof Bs&&!fu(e)?Wa([new xs("",'"interpolate" expressions cannot be used with this property')]):_1(g?new Jo(u?"camera":"composite",r.value,g.labels,g instanceof Bs?g.interpolation:void 0):new ih(u?"constant":"source",r.value)):Wa([new xs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Tl{constructor(e,n){this._parameters=e,this._specification=n,Tn(this,Lc(this._parameters,this._specification))}static deserialize(e){return new Tl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ic(r){let e=null;if(r instanceof zh)e=ic(r.result);else if(r instanceof _l){for(const n of r.args)if(e=ic(n),e)break}else(r instanceof Zu||r instanceof Bs)&&r.input instanceof xa&&r.input.name==="zoom"&&(e=r);return e instanceof xs||r.eachChild(n=>{const u=ic(n);u instanceof xs?e=u:!e&&u?e=new xs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&u&&e!==u&&(e=new xs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class Fi{constructor(e,n,u,f){this.message=(e?`${e}: `:"")+u,f&&(this.identifier=f),n!=null&&n.__line__&&(this.line=n.__line__)}}function Hs(r){const e=r.key,n=r.value,u=r.valueSpec||{},f=r.objectElementValidators||{},g=r.style,b=r.styleSpec;let I=[];const z=tn(n);if(z!=="object")return[new Fi(e,n,`object expected, ${z} found`)];for(const R in n){const N=R.split(".")[0];let $;f[N]?$=f[N]:u[N]?$=Fe:f["*"]?$=f["*"]:u["*"]&&($=Fe),$?I=I.concat($({key:(e&&`${e}.`)+R,value:n[R],valueSpec:u[N]||u["*"],style:g,styleSpec:b,object:n,objectKey:R},n)):I.push(new Fi(e,n[R],`unknown property "${R}"`))}for(const R in u)f[R]||u[R].required&&u[R].default===void 0&&n[R]===void 0&&I.push(new Fi(e,n,`missing required property "${R}"`));return I}function Oh(r){const e=r.value,n=r.valueSpec,u=r.style,f=r.styleSpec,g=r.key,b=r.arrayElementValidator||Fe;if(tn(e)!=="array")return[new Fi(g,e,`array expected, ${tn(e)} found`)];if(n.length&&e.length!==n.length)return[new Fi(g,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new Fi(g,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let I={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};f.$version<7&&(I.function=n.function),tn(n.value)==="object"&&(I=n.value);let z=[];for(let R=0;R<e.length;R++)z=z.concat(b({array:e,arrayIndex:R,value:e[R],valueSpec:I,style:u,styleSpec:f,key:`${g}[${R}]`}));return z}function mu(r){const e=r.key,n=r.value,u=r.valueSpec;let f=tn(n);if(f==="number"&&n!=n&&(f="NaN"),f!=="number")return[new Fi(e,n,`number expected, ${f} found`)];if("minimum"in u){let g=u.minimum;if(tn(u.minimum)==="array"&&(g=u.minimum[r.arrayIndex]),n<g)return[new Fi(e,n,`${n} is less than the minimum value ${g}`)]}if("maximum"in u){let g=u.maximum;if(tn(u.maximum)==="array"&&(g=u.maximum[r.arrayIndex]),n>g)return[new Fi(e,n,`${n} is greater than the maximum value ${g}`)]}return[]}function Ss(r){const e=r.valueSpec,n=Cr(r.value.type);let u,f,g,b={};const I=n!=="categorical"&&r.value.property===void 0,z=!I,R=tn(r.value.stops)==="array"&&tn(r.value.stops[0])==="array"&&tn(r.value.stops[0][0])==="object",N=Hs({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(Q){if(n==="identity")return[new Fi(Q.key,Q.value,'identity function may not have a "stops" property')];let te=[];const ce=Q.value;return te=te.concat(Oh({key:Q.key,value:ce,valueSpec:Q.valueSpec,style:Q.style,styleSpec:Q.styleSpec,arrayElementValidator:$})),tn(ce)==="array"&&ce.length===0&&te.push(new Fi(Q.key,ce,"array must have at least one stop")),te},default:function(Q){return Fe({key:Q.key,value:Q.value,valueSpec:e,style:Q.style,styleSpec:Q.styleSpec})}}});return n==="identity"&&I&&N.push(new Fi(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||N.push(new Fi(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!fu(r.valueSpec)&&N.push(new Fi(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(z&&!vl(r.valueSpec)?N.push(new Fi(r.key,r.value,"property functions not supported")):I&&!pu(r.valueSpec)&&N.push(new Fi(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!R||r.value.property!==void 0||N.push(new Fi(r.key,r.value,'"property" property is required')),N;function $(Q){let te=[];const ce=Q.value,we=Q.key;if(tn(ce)!=="array")return[new Fi(we,ce,`array expected, ${tn(ce)} found`)];if(ce.length!==2)return[new Fi(we,ce,`array length 2 expected, length ${ce.length} found`)];if(R){if(tn(ce[0])!=="object")return[new Fi(we,ce,`object expected, ${tn(ce[0])} found`)];if(ce[0].zoom===void 0)return[new Fi(we,ce,"object stop key must have zoom")];if(ce[0].value===void 0)return[new Fi(we,ce,"object stop key must have value")];const Re=Cr(ce[0].zoom);if(typeof Re!="number")return[new Fi(we,ce[0].zoom,"stop zoom values must be numbers")];if(g&&g>Re)return[new Fi(we,ce[0].zoom,"stop zoom values must appear in ascending order")];Re!==g&&(g=Re,f=void 0,b={}),te=te.concat(Hs({key:`${we}[0]`,value:ce[0],valueSpec:{zoom:{}},style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{zoom:mu,value:W}}))}else te=te.concat(W({key:`${we}[0]`,value:ce[0],valueSpec:{},style:Q.style,styleSpec:Q.styleSpec},ce));return wl(En(ce[1]))?te.concat([new Fi(`${we}[1]`,ce[1],"expressions are not allowed in function stops.")]):te.concat(Fe({key:`${we}[1]`,value:ce[1],valueSpec:e,style:Q.style,styleSpec:Q.styleSpec}))}function W(Q,te){const ce=tn(Q.value),we=Cr(Q.value),Re=Q.value!==null?Q.value:te;if(u){if(ce!==u)return[new Fi(Q.key,Re,`${ce} stop domain type must match previous stop domain type ${u}`)]}else u=ce;if(ce!=="number"&&ce!=="string"&&ce!=="boolean"&&typeof we!="number"&&typeof we!="string"&&typeof we!="boolean")return[new Fi(Q.key,Re,"stop domain value must be a number, string, or boolean")];if(ce!=="number"&&n!=="categorical"){let He=`number expected, ${ce} found`;return vl(e)&&n===void 0&&(He+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fi(Q.key,Re,He)]}return n!=="categorical"||ce!=="number"||typeof we=="number"&&isFinite(we)&&Math.floor(we)===we?n!=="categorical"&&ce==="number"&&typeof we=="number"&&typeof f=="number"&&f!==void 0&&we<f?[new Fi(Q.key,Re,"stop domain values must appear in ascending order")]:(f=we,n==="categorical"&&we in b?[new Fi(Q.key,Re,"stop domain values must be unique")]:(b[we]=!0,[])):[new Fi(Q.key,Re,`integer expected, found ${String(we)}`)]}}function ro(r){const e=(r.expressionContext==="property"?Cn:Ta)(En(r.value),r.valueSpec);if(e.result==="error")return e.value.map(u=>new Fi(`${r.key}${u.key}`,r.value,u.message));const n=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new Fi(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!va(n))return[new Fi(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return Ji(n,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!kr(n,["zoom","feature-state"]))return[new Fi(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!_n(n))return[new Fi(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ji(r,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const f of e.valueSpec.expression.parameters)n.delete(f);if(n.size===0)return[];const u=[];return r instanceof xa&&n.has(r.name)?[new Fi(e.key,e.value,`["${r.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(r.eachChild(f=>{u.push(...Ji(f,e))}),u)}function dr(r){const e=r.key,n=r.value,u=r.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Cr(n))===-1&&f.push(new Fi(e,n,`expected one of [${u.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(u.values).indexOf(Cr(n))===-1&&f.push(new Fi(e,n,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(n)} found`)),f}function El(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!El(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Rc(r,e="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};El(r)||(r=Dn(r));const n=r;let u=!0;try{u=function(R){if(!Fs(R))return R;let N=En(R);return ho(N),N=Ha(N),N}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const f=It[`filter_${e}`],g=Ta(u,f);let b=null;if(g.result==="error")throw new Error(g.value.map(R=>`${R.key}: ${R.message}`).join(", "));b=(R,N,$)=>g.value.evaluate(R,N,{},$);let I=null,z=null;if(u!==n){const R=Ta(n,f);if(R.result==="error")throw new Error(R.value.map(N=>`${N.key}: ${N.message}`).join(", "));I=(N,$,W,Q,te)=>R.value.evaluate(N,$,{},W,void 0,void 0,Q,te),z=!_n(R.value.expression)}return{filter:b,dynamicFilter:I||void 0,needGeometry:Ka(u),needFeature:!!z}}function Ha(r){if(!Array.isArray(r))return r;const e=function(n){if(Ks.has(n[0])){for(let u=1;u<n.length;u++)if(Fs(n[u]))return!0}return n}(r);return e===!0?e:e.map(n=>Ha(n))}function ho(r){let e=!1;const n=[];if(r[0]==="case"){for(let u=1;u<r.length-1;u+=2)e=e||Fs(r[u]),n.push(r[u+1]);n.push(r[r.length-1])}else if(r[0]==="match"){e=e||Fs(r[1]);for(let u=2;u<r.length-1;u+=2)n.push(r[u+1]);n.push(r[r.length-1])}else if(r[0]==="step"){e=e||Fs(r[1]);for(let u=1;u<r.length-1;u+=2)n.push(r[u+1])}e&&(r.length=0,r.push("any",...n));for(let u=1;u<r.length;u++)ho(r[u])}function Fs(r){if(!Array.isArray(r))return!1;if((e=r[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<r.length;n++)if(Fs(r[n]))return!0;return!1}const Ks=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function g1(r,e){return r<e?-1:r>e?1:0}function Ka(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(Ka(r[e]))return!0;return!1}function Dn(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?no(r[1],r[2],"=="):e==="!="?S(no(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?no(r[1],r[2],e):e==="any"?(n=r.slice(1),["any"].concat(n.map(Dn))):e==="all"?["all"].concat(r.slice(1).map(Dn)):e==="none"?["all"].concat(r.slice(1).map(Dn).map(S)):e==="in"?_u(r[1],r.slice(2)):e==="!in"?S(_u(r[1],r.slice(2))):e==="has"?Ya(r[1]):e==="!has"?S(Ya(r[1])):e!=="within"||r;var n}function no(r,e,n){switch(r){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,r,e]}}function _u(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",r,["literal",e.sort(g1)]]:["filter-in-small",r,["literal",e]]}}function Ya(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function S(r){return["!",r]}function l(r){return El(En(r.value))?ro(Tn({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):m(r)}function m(r){const e=r.value,n=r.key;if(tn(e)!=="array")return[new Fi(n,e,`array expected, ${tn(e)} found`)];const u=r.styleSpec;let f,g=[];if(e.length<1)return[new Fi(n,e,"filter array must have at least 1 element")];switch(g=g.concat(dr({key:`${n}[0]`,value:e[0],valueSpec:u.filter_operator,style:r.style,styleSpec:r.styleSpec})),Cr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Cr(e[1])==="$type"&&g.push(new Fi(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&g.push(new Fi(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(f=tn(e[1]),f!=="string"&&g.push(new Fi(`${n}[1]`,e[1],`string expected, ${f} found`)));for(let b=2;b<e.length;b++)f=tn(e[b]),Cr(e[1])==="$type"?g=g.concat(dr({key:`${n}[${b}]`,value:e[b],valueSpec:u.geometry_type,style:r.style,styleSpec:r.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&g.push(new Fi(`${n}[${b}]`,e[b],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let b=1;b<e.length;b++)g=g.concat(m({key:`${n}[${b}]`,value:e[b],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":f=tn(e[1]),e.length!==2?g.push(new Fi(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):f!=="string"&&g.push(new Fi(`${n}[1]`,e[1],`string expected, ${f} found`));break;case"within":f=tn(e[1]),e.length!==2?g.push(new Fi(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):f!=="object"&&g.push(new Fi(`${n}[1]`,e[1],`object expected, ${f} found`))}return g}function w(r,e){const n=r.key,u=r.style,f=r.styleSpec,g=r.value,b=r.objectKey,I=f[`${e}_${r.layerType}`];if(!I)return[];const z=b.match(/^(.*)-transition$/);if(e==="paint"&&z&&I[z[1]]&&I[z[1]].transition)return Fe({key:n,value:g,valueSpec:f.transition,style:u,styleSpec:f});const R=r.valueSpec||I[b];if(!R)return[new Fi(n,g,`unknown property "${b}"`)];let N;if(tn(g)==="string"&&vl(R)&&!R.tokens&&(N=/^{([^}]+)}$/.exec(g))){const W=`\`{ "type": "identity", "property": ${N?JSON.stringify(N[1]):'"_"'} }\``;return[new Fi(n,g,`"${b}" does not support interpolation syntax
Use an identity property function instead: ${W}.`)]}const $=[];return r.layerType==="symbol"&&(b==="text-field"&&u&&!u.glyphs&&$.push(new Fi(n,g,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&Dc(En(g))&&Cr(g.type)==="identity"&&$.push(new Fi(n,g,'"text-font" does not support identity functions'))),$.concat(Fe({key:r.key,value:g,valueSpec:R,style:u,styleSpec:f,expressionContext:"property",propertyType:e,propertyKey:b}))}function C(r){return w(r,"paint")}function D(r){return w(r,"layout")}function U(r){let e=[];const n=r.value,u=r.key,f=r.style,g=r.styleSpec;n.type||n.ref||e.push(new Fi(u,n,'either "type" or "ref" is required'));let b=Cr(n.type);const I=Cr(n.ref);if(n.id){const z=Cr(n.id);for(let R=0;R<r.arrayIndex;R++){const N=f.layers[R];Cr(N.id)===z&&e.push(new Fi(u,n.id,`duplicate layer id "${n.id}", previously used at line ${N.id.__line__}`))}}if("ref"in n){let z;["type","source","source-layer","filter","layout"].forEach(R=>{R in n&&e.push(new Fi(u,n[R],`"${R}" is prohibited for ref layers`))}),f.layers.forEach(R=>{Cr(R.id)===I&&(z=R)}),z?z.ref?e.push(new Fi(u,n.ref,"ref cannot reference another ref layer")):b=Cr(z.type):typeof I=="string"&&e.push(new Fi(u,n.ref,`ref layer "${I}" not found`))}else if(b!=="background"&&b!=="sky")if(n.source){const z=f.sources&&f.sources[n.source],R=z&&Cr(z.type);z?R==="vector"&&b==="raster"?e.push(new Fi(u,n.source,`layer "${n.id}" requires a raster source`)):R==="raster"&&b!=="raster"?e.push(new Fi(u,n.source,`layer "${n.id}" requires a vector source`)):R!=="vector"||n["source-layer"]?R==="raster-dem"&&b!=="hillshade"?e.push(new Fi(u,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||R==="geojson"&&z.lineMetrics||e.push(new Fi(u,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Fi(u,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Fi(u,n.source,`source "${n.source}" not found`))}else e.push(new Fi(u,n,'missing required property "source"'));return e=e.concat(Hs({key:u,value:n,valueSpec:g.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Fe({key:`${u}.type`,value:n.type,valueSpec:g.layer.type,style:r.style,styleSpec:r.styleSpec,object:n,objectKey:"type"}),filter:z=>l(Tn({layerType:b},z)),layout:z=>Hs({layer:n,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":R=>D(Tn({layerType:b},R))}}),paint:z=>Hs({layer:n,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":R=>C(Tn({layerType:b},R))}})}})),e}function q(r){const e=r.value,n=r.key,u=tn(e);return u!=="string"?[new Fi(n,e,`string expected, ${u} found`)]:[]}const K={promoteId:function({key:r,value:e}){if(tn(e)==="string")return q({key:r,value:e});{const n=[];for(const u in e)n.push(...q({key:`${r}.${u}`,value:e[u]}));return n}}};function ee(r){const e=r.value,n=r.key,u=r.styleSpec,f=r.style;if(!e.type)return[new Fi(n,e,'"type" is required')];const g=Cr(e.type);let b;switch(g){case"vector":case"raster":case"raster-dem":return b=Hs({key:n,value:e,valueSpec:u[`source_${g.replace("-","_")}`],style:r.style,styleSpec:u,objectElementValidators:K}),b;case"geojson":if(b=Hs({key:n,value:e,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:K}),e.cluster)for(const I in e.clusterProperties){const[z,R]=e.clusterProperties[I],N=typeof z=="string"?[z,["accumulated"],["get",I]]:z;b.push(...ro({key:`${n}.${I}.map`,value:R,expressionContext:"cluster-map"})),b.push(...ro({key:`${n}.${I}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return b;case"video":return Hs({key:n,value:e,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return Hs({key:n,value:e,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new Fi(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return dr({key:`${n}.type`,value:e.type,valueSpec:{values:le(u)},style:f,styleSpec:u})}}function le(r){return r.source.reduce((e,n)=>{const u=r[n];return u.type.type==="enum"&&(e=e.concat(Object.keys(u.type.values))),e},[])}function me(r){const e=r.value,n=r.styleSpec,u=n.light,f=r.style;let g=[];const b=tn(e);if(e===void 0)return g;if(b!=="object")return g=g.concat([new Fi("light",e,`object expected, ${b} found`)]),g;for(const I in e){const z=I.match(/^(.*)-transition$/);g=g.concat(z&&u[z[1]]&&u[z[1]].transition?Fe({key:I,value:e[I],valueSpec:n.transition,style:f,styleSpec:n}):u[I]?Fe({key:I,value:e[I],valueSpec:u[I],style:f,styleSpec:n}):[new Fi(I,e[I],`unknown property "${I}"`)])}return g}function be(r){const e=r.value,n=r.key,u=r.style,f=r.styleSpec,g=f.terrain;let b=[];const I=tn(e);if(e===void 0)return b;if(I!=="object")return b=b.concat([new Fi("terrain",e,`object expected, ${I} found`)]),b;for(const z in e){const R=z.match(/^(.*)-transition$/);b=b.concat(R&&g[R[1]]&&g[R[1]].transition?Fe({key:z,value:e[z],valueSpec:f.transition,style:u,styleSpec:f}):g[z]?Fe({key:z,value:e[z],valueSpec:g[z],style:u,styleSpec:f}):[new Fi(z,e[z],`unknown property "${z}"`)])}if(e.source){const z=u.sources&&u.sources[e.source],R=z&&Cr(z.type);z?R!=="raster-dem"&&b.push(new Fi(n,e.source,`terrain cannot be used with a source of type ${String(R)}, it only be used with a "raster-dem" source type`)):b.push(new Fi(n,e.source,`source "${e.source}" not found`))}else b.push(new Fi(n,e,'terrain is missing required property "source"'));return b}function qe(r){const e=r.value,n=r.style,u=r.styleSpec,f=u.fog;let g=[];const b=tn(e);if(e===void 0)return g;if(b!=="object")return g=g.concat([new Fi("fog",e,`object expected, ${b} found`)]),g;for(const I in e){const z=I.match(/^(.*)-transition$/);g=g.concat(z&&f[z[1]]&&f[z[1]].transition?Fe({key:I,value:e[I],valueSpec:u.transition,style:n,styleSpec:u}):f[I]?Fe({key:I,value:e[I],valueSpec:f[I],style:n,styleSpec:u}):[new Fi(I,e[I],`unknown property "${I}"`)])}return g}const Oe={"*":()=>[],array:Oh,boolean:function(r){const e=r.value,n=r.key,u=tn(e);return u!=="boolean"?[new Fi(n,e,`boolean expected, ${u} found`)]:[]},number:mu,color:function(r){const e=r.key,n=r.value,u=tn(n);return u!=="string"?[new Fi(e,n,`color expected, ${u} found`)]:ql(n)===null?[new Fi(e,n,`color expected, "${n}" found`)]:[]},enum:dr,filter:l,function:Ss,layer:U,object:Hs,source:ee,light:me,terrain:be,fog:qe,string:q,formatted:function(r){return q(r).length===0?[]:ro(r)},resolvedImage:function(r){return q(r).length===0?[]:ro(r)},projection:function(r){const e=r.value,n=r.styleSpec,u=n.projection,f=r.style;let g=[];const b=tn(e);if(b==="object")for(const I in e)g=g.concat(Fe({key:I,value:e[I],valueSpec:u[I],style:f,styleSpec:n}));else b!=="string"&&(g=g.concat([new Fi("projection",e,`object or string expected, ${b} found`)]));return g}};function Fe(r){const e=r.value,n=r.valueSpec,u=r.styleSpec;return n.expression&&Dc(Cr(e))?Ss(r):n.expression&&wl(En(e))?ro(r):n.type&&Oe[n.type]?Oe[n.type](r):Hs(Tn({},r,{valueSpec:n.type?u[n.type]:n}))}function ht(r){const e=r.value,n=r.key,u=q(r);return u.length||(e.indexOf("{fontstack}")===-1&&u.push(new Fi(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&u.push(new Fi(n,e,'"glyphs" url must include a "{range}" token'))),u}function vt(r,e=It){return Rt(Fe({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:ht,"*":()=>[]}}))}const Pt=r=>Rt(C(r)),Ke=r=>Rt(D(r));function Rt(r){return r.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function Bt(r,e){let n=!1;if(e&&e.length)for(const u of e)r.fire(new Qi(new Error(u.message))),n=!0;return n}var ii=di,Yt=3;function di(r,e,n){var u=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var f=new Int32Array(this.arrayBuffer);r=f[0],this.d=(e=f[1])+2*(n=f[2]);for(var g=0;g<this.d*this.d;g++){var b=f[Yt+g],I=f[Yt+g+1];u.push(b===I?null:f.subarray(b,I))}var z=f[Yt+u.length+1];this.keys=f.subarray(f[Yt+u.length],z),this.bboxes=f.subarray(z),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var R=0;R<this.d*this.d;R++)u.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=r,this.padding=n,this.scale=e/r,this.uid=0;var N=n/e*r;this.min=-N,this.max=r+N}di.prototype.insert=function(r,e,n,u,f){this._forEachCell(e,n,u,f,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(u),this.bboxes.push(f)},di.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},di.prototype._insertCell=function(r,e,n,u,f,g){this.cells[f].push(g)},di.prototype.query=function(r,e,n,u,f){var g=this.min,b=this.max;if(r<=g&&e<=g&&b<=n&&b<=u&&!f)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(r,e,n,u,this._queryCell,I,{},f),I},di.prototype._queryCell=function(r,e,n,u,f,g,b,I){var z=this.cells[f];if(z!==null)for(var R=this.keys,N=this.bboxes,$=0;$<z.length;$++){var W=z[$];if(b[W]===void 0){var Q=4*W;(I?I(N[Q+0],N[Q+1],N[Q+2],N[Q+3]):r<=N[Q+2]&&e<=N[Q+3]&&n>=N[Q+0]&&u>=N[Q+1])?(b[W]=!0,g.push(R[W])):b[W]=!1}}},di.prototype._forEachCell=function(r,e,n,u,f,g,b,I){for(var z=this._convertToCellCoord(r),R=this._convertToCellCoord(e),N=this._convertToCellCoord(n),$=this._convertToCellCoord(u),W=z;W<=N;W++)for(var Q=R;Q<=$;Q++){var te=this.d*Q+W;if((!I||I(this._convertFromCellCoord(W),this._convertFromCellCoord(Q),this._convertFromCellCoord(W+1),this._convertFromCellCoord(Q+1)))&&f.call(this,r,e,n,u,te,g,b,I))return}},di.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},di.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},di.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,e=Yt+this.cells.length+1+1,n=0,u=0;u<this.cells.length;u++)n+=this.cells[u].length;var f=new Int32Array(e+n+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var g=e,b=0;b<r.length;b++){var I=r[b];f[Yt+b]=g,f.set(I,g),g+=I.length}return f[Yt+r.length]=g,f.set(this.keys,g),f[Yt+r.length+1]=g+=this.keys.length,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer};var Wt=je(ii);const Ui={};function Ft(r,e,n={}){Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),Ui[e]={klass:r,omit:n.omit||[]}}Ft(Object,"Object"),Wt.serialize=function(r,e){const n=r.toArrayBuffer();return e&&e.push(n),{buffer:n}},Wt.deserialize=function(r){return new Wt(r.buffer)},Object.defineProperty(Wt,"name",{value:"Grid"}),Ft(Wt,"Grid"),Ft(Kn,"Color"),Ft(Error,"Error"),Ft(Hn,"AJAXError"),Ft(ws,"ResolvedImage"),Ft(Tl,"StylePropertyFunction"),Ft(Xa,"StyleExpression",{omit:["_evaluator"]}),Ft(Jo,"ZoomDependentExpression"),Ft(ih,"ZoomConstantExpression"),Ft(xa,"CompoundExpression",{omit:["_evaluate"]});for(const r in xl)Ui[xl[r]._classRegistryKey]||Ft(xl[r],`Expression${r}`);function qi(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Er(r){return j.ImageBitmap&&r instanceof j.ImageBitmap}function Sr(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(qi(r)||Er(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const n=r;return e&&e.push(n.buffer),n}if(r instanceof j.ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const n=[];for(const u of r)n.push(Sr(u,e));return n}if(typeof r=="object"){const n=r.constructor,u=n._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const f=n.serialize?n.serialize(r,e):{};if(!n.serialize){for(const g in r)r.hasOwnProperty(g)&&(Ui[u].omit.indexOf(g)>=0||(f[g]=Sr(r[g],e)));r instanceof Error&&(f.message=r.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(f.$name=u),f}throw new Error("can't serialize object of type "+typeof r)}function ir(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||qi(r)||Er(r)||ArrayBuffer.isView(r)||r instanceof j.ImageData)return r;if(Array.isArray(r))return r.map(ir);if(typeof r=="object"){const e=r.$name||"Object",{klass:n}=Ui[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(r);const u=Object.create(n.prototype);for(const f of Object.keys(r))f!=="$name"&&(u[f]=ir(r[f]));return u}throw new Error("can't deserialize object of type "+typeof r)}const pi={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function cn(r){for(const e of r)if(dn(e.charCodeAt(0)))return!0;return!1}function Yr(r){for(const e of r)if(!Jr(e.charCodeAt(0)))return!1;return!0}function Jr(r){return!(pi.Arabic(r)||pi["Arabic Supplement"](r)||pi["Arabic Extended-A"](r)||pi["Arabic Presentation Forms-A"](r)||pi["Arabic Presentation Forms-B"](r))}function dn(r){return!(r!==746&&r!==747&&(r<4352||!(pi["Bopomofo Extended"](r)||pi.Bopomofo(r)||pi["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||pi["CJK Compatibility Ideographs"](r)||pi["CJK Compatibility"](r)||pi["CJK Radicals Supplement"](r)||pi["CJK Strokes"](r)||!(!pi["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||pi["CJK Unified Ideographs Extension A"](r)||pi["CJK Unified Ideographs"](r)||pi["Enclosed CJK Letters and Months"](r)||pi["Hangul Compatibility Jamo"](r)||pi["Hangul Jamo Extended-A"](r)||pi["Hangul Jamo Extended-B"](r)||pi["Hangul Jamo"](r)||pi["Hangul Syllables"](r)||pi.Hiragana(r)||pi["Ideographic Description Characters"](r)||pi.Kanbun(r)||pi["Kangxi Radicals"](r)||pi["Katakana Phonetic Extensions"](r)||pi.Katakana(r)&&r!==12540||!(!pi["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!pi["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||pi["Unified Canadian Aboriginal Syllabics"](r)||pi["Unified Canadian Aboriginal Syllabics Extended"](r)||pi["Vertical Forms"](r)||pi["Yijing Hexagram Symbols"](r)||pi["Yi Syllables"](r)||pi["Yi Radicals"](r))))}function _o(r){return!(dn(r)||function(e){return!!(pi["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||pi["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||pi["Letterlike Symbols"](e)||pi["Number Forms"](e)||pi["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||pi["Control Pictures"](e)&&e!==9251||pi["Optical Character Recognition"](e)||pi["Enclosed Alphanumerics"](e)||pi["Geometric Shapes"](e)||pi["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||pi["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||pi["CJK Symbols and Punctuation"](e)||pi.Katakana(e)||pi["Private Use Area"](e)||pi["CJK Compatibility Forms"](e)||pi["Small Form Variants"](e)||pi["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function ha(r){return r>=1424&&r<=2303||pi["Arabic Presentation Forms-A"](r)||pi["Arabic Presentation Forms-B"](r)}function da(r,e){return!(!e&&ha(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||pi.Khmer(r))}function Ea(r){for(const e of r)if(ha(e.charCodeAt(0)))return!0;return!1}const Sa="deferred",Ms="loading",Qo="loaded";let Cs=null,_="unavailable",o=null;const d=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(_="error"),Cs&&Cs(r)};function x(){E.fire(new Mr("pluginStateChange",{pluginStatus:_,pluginURL:o}))}const E=new Pr,A=function(){return _},B=function(){if(_!==Sa||!o)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_=Ms,x(),o&&Ii({url:o},r=>{r?d(r):(_=Qo,x())})},O={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_===Qo||O.applyArabicShaping!=null,isLoading:()=>_===Ms,setState(r){_=r.pluginStatus,o=r.pluginURL},isParsed:()=>O.applyArabicShaping!=null&&O.processBidirectionalText!=null&&O.processStyledBidirectionalText!=null,getPluginURL:()=>o};class G{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,u){for(const f of n)if(!da(f.charCodeAt(0),u))return!1;return!0}(e,O.isLoaded())}}class H{constructor(e,n){this.property=e,this.value=n,this.expression=function(u,f){if(Dc(u))return new Tl(u,f);if(wl(u)){const g=Cn(u,f);if(g.result==="error")throw new Error(g.value.map(b=>`${b.key}: ${b.message}`).join(", "));return g.value}{let g=u;return typeof u=="string"&&f.type==="color"&&(g=Kn.parse(u)),{kind:"constant",evaluate:()=>g}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,u){return this.property.possiblyEvaluate(this,e,n,u)}}class X{constructor(e){this.property=e,this.value=new H(e,void 0)}transitioned(e,n){return new ve(this.property,this.value,n,mr({},e.transition,this.transition),e.now)}untransitioned(){return new ve(this.property,this.value,null,{},0)}}class oe{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return hn(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new X(this._values[e].property)),this._values[e].value=new H(this._values[e].property,n===null?void 0:hn(n))}getTransition(e){return hn(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new X(this._values[e].property)),this._values[e].transition=hn(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const u=this.getValue(n);u!==void 0&&(e[n]=u);const f=this.getTransition(n);f!==void 0&&(e[`${n}-transition`]=f)}return e}transitioned(e,n){const u=new Ee(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].transitioned(e,n._values[f]);return u}untransitioned(){const e=new Ee(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class ve{constructor(e,n,u,f,g){const b=f.delay||0,I=f.duration||0;g=g||0,this.property=e,this.value=n,this.begin=g+b,this.end=this.begin+I,e.specification.transition&&(f.delay||f.duration)&&(this.prior=u)}possiblyEvaluate(e,n,u){const f=e.now||0,g=this.value.possiblyEvaluate(e,n,u),b=this.prior;if(b){if(f>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(f<this.begin)return b.possiblyEvaluate(e,n,u);{const I=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(e,n,u),g,$t(I))}}return g}}class Ee{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,u){const f=new ze(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(e,n,u);return f}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ie{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return hn(this._values[e].value)}setValue(e,n){this._values[e]=new H(this._values[e].property,n===null?void 0:hn(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const u=this.getValue(n);u!==void 0&&(e[n]=u)}return e}possiblyEvaluate(e,n,u){const f=new ze(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(e,n,u);return f}}class Ce{constructor(e,n,u){this.property=e,this.value=n,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,u,f){return this.property.evaluate(this.value,this.parameters,e,n,u,f)}}class ze{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ae{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,u){const f=pl[this.specification.type];return f?f(e,n,u):e}}class Me{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,u,f){return new Ce(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},u,f)}:e.expression,n)}interpolate(e,n,u){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new Ce(this,{kind:"constant",value:void 0},e.parameters);const f=pl[this.specification.type];return f?new Ce(this,{kind:"constant",value:f(e.value.value,n.value.value,u)},e.parameters):e}evaluate(e,n,u,f,g,b){return e.kind==="constant"?e.value:e.evaluate(n,u,f,g,b)}}class Ue{constructor(e){this.specification=e}possiblyEvaluate(e,n,u,f){return!!e.expression.evaluate(n,null,{},u,f)}interpolate(){return!1}}class Ge{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new G(0,{});for(const u in e){const f=e[u];f.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new H(f,void 0),b=this.defaultTransitionablePropertyValues[u]=new X(f);this.defaultTransitioningPropertyValues[u]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate(n)}}}function rt(r,e){return 256*(r=pt(Math.floor(r),0,255))+pt(Math.floor(e),0,255)}Ft(Me,"DataDrivenProperty"),Ft(ae,"DataConstantProperty"),Ft(Ue,"ColorRampProperty");const nt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class tt{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function yt(r,e=1){let n=0,u=0;return{members:r.map(f=>{const g=nt[f.type].BYTES_PER_ELEMENT,b=n=kt(n,Math.max(e,g)),I=f.components||1;return u=Math.max(u,g),n+=g*I,{name:f.name,type:f.type,components:I,offset:b}}),size:kt(n,Math.max(u,e)),alignment:e}}function kt(r,e){return Math.ceil(r/e)*e}class yi extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const u=this.length;return this.resize(u+1),this.emplace(u,e,n)}emplace(e,n,u){const f=2*e;return this.int16[f+0]=n,this.int16[f+1]=u,e}}yi.prototype.bytesPerElement=4,Ft(yi,"StructArrayLayout2i4");class At extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,u)}emplace(e,n,u,f){const g=3*e;return this.int16[g+0]=n,this.int16[g+1]=u,this.int16[g+2]=f,e}}At.prototype.bytesPerElement=6,Ft(At,"StructArrayLayout3i6");class Zt extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,u,f)}emplace(e,n,u,f,g){const b=4*e;return this.int16[b+0]=n,this.int16[b+1]=u,this.int16[b+2]=f,this.int16[b+3]=g,e}}Zt.prototype.bytesPerElement=8,Ft(Zt,"StructArrayLayout4i8");class Nt extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g,b,I){const z=this.length;return this.resize(z+1),this.emplace(z,e,n,u,f,g,b,I)}emplace(e,n,u,f,g,b,I,z){const R=6*e,N=12*e,$=3*e;return this.int16[R+0]=n,this.int16[R+1]=u,this.uint8[N+4]=f,this.uint8[N+5]=g,this.uint8[N+6]=b,this.uint8[N+7]=I,this.float32[$+2]=z,e}}Nt.prototype.bytesPerElement=12,Ft(Nt,"StructArrayLayout2i4ub1f12");class mi extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,u,f)}emplace(e,n,u,f,g){const b=4*e;return this.float32[b+0]=n,this.float32[b+1]=u,this.float32[b+2]=f,this.float32[b+3]=g,e}}mi.prototype.bytesPerElement=16,Ft(mi,"StructArrayLayout4f16");class Ct extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,u,f,g)}emplace(e,n,u,f,g,b){const I=6*e,z=3*e;return this.uint16[I+0]=n,this.uint16[I+1]=u,this.uint16[I+2]=f,this.uint16[I+3]=g,this.float32[z+2]=b,e}}Ct.prototype.bytesPerElement=12,Ft(Ct,"StructArrayLayout4ui1f12");class ei extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,u,f)}emplace(e,n,u,f,g){const b=4*e;return this.uint16[b+0]=n,this.uint16[b+1]=u,this.uint16[b+2]=f,this.uint16[b+3]=g,e}}ei.prototype.bytesPerElement=8,Ft(ei,"StructArrayLayout4ui8");class _i extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g,b){const I=this.length;return this.resize(I+1),this.emplace(I,e,n,u,f,g,b)}emplace(e,n,u,f,g,b,I){const z=6*e;return this.int16[z+0]=n,this.int16[z+1]=u,this.int16[z+2]=f,this.int16[z+3]=g,this.int16[z+4]=b,this.int16[z+5]=I,e}}_i.prototype.bytesPerElement=12,Ft(_i,"StructArrayLayout6i12");class si extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g,b,I,z,R,N,$,W){const Q=this.length;return this.resize(Q+1),this.emplace(Q,e,n,u,f,g,b,I,z,R,N,$,W)}emplace(e,n,u,f,g,b,I,z,R,N,$,W,Q){const te=12*e;return this.int16[te+0]=n,this.int16[te+1]=u,this.int16[te+2]=f,this.int16[te+3]=g,this.uint16[te+4]=b,this.uint16[te+5]=I,this.uint16[te+6]=z,this.uint16[te+7]=R,this.int16[te+8]=N,this.int16[te+9]=$,this.int16[te+10]=W,this.int16[te+11]=Q,e}}si.prototype.bytesPerElement=24,Ft(si,"StructArrayLayout4i4ui4i24");class xi extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g,b){const I=this.length;return this.resize(I+1),this.emplace(I,e,n,u,f,g,b)}emplace(e,n,u,f,g,b,I){const z=10*e,R=5*e;return this.int16[z+0]=n,this.int16[z+1]=u,this.int16[z+2]=f,this.float32[R+2]=g,this.float32[R+3]=b,this.float32[R+4]=I,e}}xi.prototype.bytesPerElement=20,Ft(xi,"StructArrayLayout3i3f20");class or extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}or.prototype.bytesPerElement=4,Ft(or,"StructArrayLayout1ul4");class vr extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g,b,I,z,R,N,$,W,Q){const te=this.length;return this.resize(te+1),this.emplace(te,e,n,u,f,g,b,I,z,R,N,$,W,Q)}emplace(e,n,u,f,g,b,I,z,R,N,$,W,Q,te){const ce=20*e,we=10*e;return this.int16[ce+0]=n,this.int16[ce+1]=u,this.int16[ce+2]=f,this.int16[ce+3]=g,this.int16[ce+4]=b,this.float32[we+3]=I,this.float32[we+4]=z,this.float32[we+5]=R,this.float32[we+6]=N,this.int16[ce+14]=$,this.uint32[we+8]=W,this.uint16[ce+18]=Q,this.uint16[ce+19]=te,e}}vr.prototype.bytesPerElement=40,Ft(vr,"StructArrayLayout5i4f1i1ul2ui40");class Xi extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g,b,I){const z=this.length;return this.resize(z+1),this.emplace(z,e,n,u,f,g,b,I)}emplace(e,n,u,f,g,b,I,z){const R=8*e;return this.int16[R+0]=n,this.int16[R+1]=u,this.int16[R+2]=f,this.int16[R+4]=g,this.int16[R+5]=b,this.int16[R+6]=I,this.int16[R+7]=z,e}}Xi.prototype.bytesPerElement=16,Ft(Xi,"StructArrayLayout3i2i2i16");class cr extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,u,f,g)}emplace(e,n,u,f,g,b){const I=4*e,z=8*e;return this.float32[I+0]=n,this.float32[I+1]=u,this.float32[I+2]=f,this.int16[z+6]=g,this.int16[z+7]=b,e}}cr.prototype.bytesPerElement=16,Ft(cr,"StructArrayLayout2f1f2i16");class Zr extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,u,f)}emplace(e,n,u,f,g){const b=12*e,I=3*e;return this.uint8[b+0]=n,this.uint8[b+1]=u,this.float32[I+1]=f,this.float32[I+2]=g,e}}Zr.prototype.bytesPerElement=12,Ft(Zr,"StructArrayLayout2ub2f12");class Fr extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,u)}emplace(e,n,u,f){const g=3*e;return this.float32[g+0]=n,this.float32[g+1]=u,this.float32[g+2]=f,e}}Fr.prototype.bytesPerElement=12,Ft(Fr,"StructArrayLayout3f12");class er extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,u)}emplace(e,n,u,f){const g=3*e;return this.uint16[g+0]=n,this.uint16[g+1]=u,this.uint16[g+2]=f,e}}er.prototype.bytesPerElement=6,Ft(er,"StructArrayLayout3ui6");class pn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g,b,I,z,R,N,$,W,Q,te,ce,we,Re,He,Be,We,it){const et=this.length;return this.resize(et+1),this.emplace(et,e,n,u,f,g,b,I,z,R,N,$,W,Q,te,ce,we,Re,He,Be,We,it)}emplace(e,n,u,f,g,b,I,z,R,N,$,W,Q,te,ce,we,Re,He,Be,We,it,et){const Ot=30*e,Lt=15*e,ti=60*e;return this.int16[Ot+0]=n,this.int16[Ot+1]=u,this.int16[Ot+2]=f,this.float32[Lt+2]=g,this.float32[Lt+3]=b,this.uint16[Ot+8]=I,this.uint16[Ot+9]=z,this.uint32[Lt+5]=R,this.uint32[Lt+6]=N,this.uint32[Lt+7]=$,this.uint16[Ot+16]=W,this.uint16[Ot+17]=Q,this.uint16[Ot+18]=te,this.float32[Lt+10]=ce,this.float32[Lt+11]=we,this.uint8[ti+48]=Re,this.uint8[ti+49]=He,this.uint8[ti+50]=Be,this.uint32[Lt+13]=We,this.int16[Ot+28]=it,this.uint8[ti+58]=et,e}}pn.prototype.bytesPerElement=60,Ft(pn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class un extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g,b,I,z,R,N,$,W,Q,te,ce,we,Re,He,Be,We,it,et,Ot,Lt,ti,vi,Vt,ni,oi,fi){const Ti=this.length;return this.resize(Ti+1),this.emplace(Ti,e,n,u,f,g,b,I,z,R,N,$,W,Q,te,ce,we,Re,He,Be,We,it,et,Ot,Lt,ti,vi,Vt,ni,oi,fi)}emplace(e,n,u,f,g,b,I,z,R,N,$,W,Q,te,ce,we,Re,He,Be,We,it,et,Ot,Lt,ti,vi,Vt,ni,oi,fi,Ti){const Jt=38*e,Bi=19*e;return this.int16[Jt+0]=n,this.int16[Jt+1]=u,this.int16[Jt+2]=f,this.float32[Bi+2]=g,this.float32[Bi+3]=b,this.int16[Jt+8]=I,this.int16[Jt+9]=z,this.int16[Jt+10]=R,this.int16[Jt+11]=N,this.int16[Jt+12]=$,this.int16[Jt+13]=W,this.uint16[Jt+14]=Q,this.uint16[Jt+15]=te,this.uint16[Jt+16]=ce,this.uint16[Jt+17]=we,this.uint16[Jt+18]=Re,this.uint16[Jt+19]=He,this.uint16[Jt+20]=Be,this.uint16[Jt+21]=We,this.uint16[Jt+22]=it,this.uint16[Jt+23]=et,this.uint16[Jt+24]=Ot,this.uint16[Jt+25]=Lt,this.uint16[Jt+26]=ti,this.uint16[Jt+27]=vi,this.uint16[Jt+28]=Vt,this.uint32[Bi+15]=ni,this.float32[Bi+16]=oi,this.float32[Bi+17]=fi,this.float32[Bi+18]=Ti,e}}un.prototype.bytesPerElement=76,Ft(un,"StructArrayLayout3i2f6i15ui1ul3f76");class kn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}kn.prototype.bytesPerElement=4,Ft(kn,"StructArrayLayout1f4");class fn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,u,f,g)}emplace(e,n,u,f,g,b){const I=5*e;return this.float32[I+0]=n,this.float32[I+1]=u,this.float32[I+2]=f,this.float32[I+3]=g,this.float32[I+4]=b,e}}fn.prototype.bytesPerElement=20,Ft(fn,"StructArrayLayout5f20");class Lo extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,u,f)}emplace(e,n,u,f,g){const b=6*e;return this.uint32[3*e+0]=n,this.uint16[b+2]=u,this.uint16[b+3]=f,this.uint16[b+4]=g,e}}Lo.prototype.bytesPerElement=12,Ft(Lo,"StructArrayLayout1ul3ui12");class go extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const u=this.length;return this.resize(u+1),this.emplace(u,e,n)}emplace(e,n,u){const f=2*e;return this.uint16[f+0]=n,this.uint16[f+1]=u,e}}go.prototype.bytesPerElement=4,Ft(go,"StructArrayLayout2ui4");class Ma extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Ma.prototype.bytesPerElement=2,Ft(Ma,"StructArrayLayout1ui2");class Sl extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const u=this.length;return this.resize(u+1),this.emplace(u,e,n)}emplace(e,n,u){const f=2*e;return this.float32[f+0]=n,this.float32[f+1]=u,e}}Sl.prototype.bytesPerElement=8,Ft(Sl,"StructArrayLayout2f8");class Wr extends tt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Wr.prototype.size=40;class jr extends vr{get(e){return new Wr(this,e)}}Ft(jr,"CollisionBoxArray");class an extends tt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}an.prototype.size=60;class lo extends pn{get(e){return new an(this,e)}}Ft(lo,"PlacedSymbolArray");class Is extends tt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Is.prototype.size=76;class In extends un{get(e){return new Is(this,e)}}Ft(In,"SymbolInstanceArray");class Ys extends kn{getoffsetX(e){return this.float32[1*e+0]}}Ft(Ys,"GlyphOffsetArray");class Uh extends yi{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Ft(Uh,"SymbolLineVertexArray");class Bc extends tt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Bc.prototype.size=12;class Fc extends Lo{get(e){return new Bc(this,e)}}Ft(Fc,"FeatureIndexArray");class Ml extends go{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Ft(Ml,"FillExtrusionCentroidArray");const rc=yt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Oc=yt([{name:"a_dash",components:4,type:"Uint16"}]);var y1={exports:{}},gu={exports:{}};gu.exports=function(r,e){var n,u,f,g,b,I,z,R;for(u=r.length-(n=3&r.length),f=e,b=3432918353,I=461845907,R=0;R<u;)z=255&r.charCodeAt(R)|(255&r.charCodeAt(++R))<<8|(255&r.charCodeAt(++R))<<16|(255&r.charCodeAt(++R))<<24,++R,f=27492+(65535&(g=5*(65535&(f=(f^=z=(65535&(z=(z=(65535&z)*b+(((z>>>16)*b&65535)<<16)&4294967295)<<15|z>>>17))*I+(((z>>>16)*I&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(z=0,n){case 3:z^=(255&r.charCodeAt(R+2))<<16;case 2:z^=(255&r.charCodeAt(R+1))<<8;case 1:f^=z=(65535&(z=(z=(65535&(z^=255&r.charCodeAt(R)))*b+(((z>>>16)*b&65535)<<16)&4294967295)<<15|z>>>17))*I+(((z>>>16)*I&65535)<<16)&4294967295}return f^=r.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var x1=gu.exports,_p={exports:{}};_p.exports=function(r,e){for(var n,u=r.length,f=e^u,g=0;u>=4;)n=1540483477*(65535&(n=255&r.charCodeAt(g)|(255&r.charCodeAt(++g))<<8|(255&r.charCodeAt(++g))<<16|(255&r.charCodeAt(++g))<<24))+((1540483477*(n>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),u-=4,++g;switch(u){case 3:f^=(255&r.charCodeAt(g+2))<<16;case 2:f^=(255&r.charCodeAt(g+1))<<8;case 1:f=1540483477*(65535&(f^=255&r.charCodeAt(g)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var v1=x1,Ja=_p.exports;y1.exports=v1,y1.exports.murmur3=v1,y1.exports.murmur2=Ja;var gp=je(y1.exports);class yp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,u,f){this.ids.push(X2(e)),this.positions.push(n,u,f)}getPositions(e){const n=X2(e);let u=0,f=this.ids.length-1;for(;u<f;){const b=u+f>>1;this.ids[b]>=n?f=b:u=b+1}const g=[];for(;this.ids[u]===n;)g.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return g}static serialize(e,n){const u=new Float64Array(e.ids),f=new Uint32Array(e.positions);return Z0(u,f,0,u.length-1),n&&n.push(u.buffer,f.buffer),{ids:u,positions:f}}static deserialize(e){const n=new yp;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function X2(r){const e=+r;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:gp(String(r))}function Z0(r,e,n,u){for(;n<u;){const f=r[n+u>>1];let g=n-1,b=u+1;for(;;){do g++;while(r[g]<f);do b--;while(r[b]>f);if(g>=b)break;Nh(r,g,b),Nh(e,3*g,3*b),Nh(e,3*g+1,3*b+1),Nh(e,3*g+2,3*b+2)}b-n<u-b?(Z0(r,e,n,b),n=b+1):(Z0(r,e,b+1,u),u=b)}}function Nh(r,e,n){const u=r[e];r[e]=r[n],r[n]=u}Ft(yp,"FeaturePositionMap");class Cl{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class Sd extends Cl{constructor(e){super(e),this.current=0}set(e,n,u){this.fetchUniformLocation(e,n)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class rh extends Cl{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,u){this.fetchUniformLocation(e,n)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class b1 extends Cl{constructor(e){super(e),this.current=Kn.transparent}set(e,n,u){this.fetchUniformLocation(e,n)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const U5=new Float32Array(16),N5=new Float32Array(9),V5=new Float32Array(4);function q0(r){return[rt(255*r.r,255*r.g),rt(255*r.b,255*r.a)]}class Md{constructor(e,n,u){this.value=e,this.uniformNames=n.map(f=>`u_${f}`),this.type=u}setUniform(e,n,u,f,g){n.set(e,g,f.constantOr(this.value))}getBinding(e,n){return this.type==="color"?new b1(e):new Sd(e)}}class w1{constructor(e,n){this.uniformNames=n.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,n,u,f,g){const b=g==="u_pattern"||g==="u_dash"?this.pattern:g==="u_pixel_ratio"?this.pixelRatio:null;b&&n.set(e,g,b)}getBinding(e,n){return n==="u_pattern"||n==="u_dash"?new rh(e):new Sd(e)}}class yu{constructor(e,n,u,f){this.expression=e,this.type=u,this.maxValue=0,this.paintVertexAttributes=n.map(g=>({name:`a_${g}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(e,n,u,f,g,b){const I=this.paintVertexArray.length,z=this.expression.evaluate(new G(0),n,{},g,f,b);this.paintVertexArray.resize(e),this._setPaintValue(I,e,z)}updatePaintArray(e,n,u,f,g){const b=this.expression.evaluate({zoom:0},u,f,void 0,g);this._setPaintValue(e,n,b)}_setPaintValue(e,n,u){if(this.type==="color"){const f=q0(u);for(let g=e;g<n;g++)this.paintVertexArray.emplace(g,f[0],f[1])}else{for(let f=e;f<n;f++)this.paintVertexArray.emplace(f,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Qa{constructor(e,n,u,f,g,b){this.expression=e,this.uniformNames=n.map(I=>`u_${I}_t`),this.type=u,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=n.map(I=>({name:`a_${I}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(e,n,u,f,g,b){const I=this.expression.evaluate(new G(this.zoom),n,{},g,f,b),z=this.expression.evaluate(new G(this.zoom+1),n,{},g,f,b),R=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(R,e,I,z)}updatePaintArray(e,n,u,f,g){const b=this.expression.evaluate({zoom:this.zoom},u,f,void 0,g),I=this.expression.evaluate({zoom:this.zoom+1},u,f,void 0,g);this._setPaintValue(e,n,b,I)}_setPaintValue(e,n,u,f){if(this.type==="color"){const g=q0(u),b=q0(f);for(let I=e;I<n;I++)this.paintVertexArray.emplace(I,g[0],g[1],b[0],b[1])}else{for(let g=e;g<n;g++)this.paintVertexArray.emplace(g,u,f);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(f))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,u,f,g){const b=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,I=pt(this.expression.interpolationFactor(b,this.zoom,this.zoom+1),0,1);n.set(e,g,I)}getBinding(e,n){return new Sd(e)}}class nh{constructor(e,n,u,f,g){this.expression=e,this.layerId=g,this.paintVertexAttributes=(u==="array"?Oc:rc).members;for(let b=0;b<n.length;++b);this.paintVertexArray=new f}populatePaintArray(e,n,u){const f=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(f,e,n.patterns&&n.patterns[this.layerId],u)}updatePaintArray(e,n,u,f,g,b){this._setPaintValues(e,n,u.patterns&&u.patterns[this.layerId],b)}_setPaintValues(e,n,u,f){if(!f||!u)return;const g=f[u];if(!g)return;const{tl:b,br:I,pixelRatio:z}=g;for(let R=e;R<n;R++)this.paintVertexArray.emplace(R,b[0],b[1],I[0],I[1],z)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class el{constructor(e,n,u=()=>!0){this.binders={},this._buffers=[];const f=[];for(const g in e.paint._values){if(!u(g))continue;const b=e.paint.get(g);if(!(b instanceof Ce&&vl(b.property.specification)))continue;const I=xp(g,e.type),z=b.value,R=b.property.specification.type,N=!!b.property.useIntegerZoom,$=g==="line-dasharray"||g.endsWith("pattern"),W=g==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(z.kind!=="constant"||W)if(z.kind==="source"||W||$){const Q=Cd(g,R,"source");this.binders[g]=$?new nh(z,I,R,Q,e.id):new yu(z,I,R,Q),f.push(`/a_${g}`)}else{const Q=Cd(g,R,"composite");this.binders[g]=new Qa(z,I,R,N,n,Q),f.push(`/z_${g}`)}else this.binders[g]=$?new w1(z.value,I):new Md(z.value,I,R),f.push(`/u_${g}`)}this.cacheKey=f.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof yu||n instanceof Qa?n.maxValue:0}populatePaintArrays(e,n,u,f,g,b){for(const I in this.binders){const z=this.binders[I];(z instanceof yu||z instanceof Qa||z instanceof nh)&&z.populatePaintArray(e,n,u,f,g,b)}}setConstantPatternPositions(e){for(const n in this.binders){const u=this.binders[n];u instanceof w1&&u.setConstantPatternPositions(e)}}updatePaintArrays(e,n,u,f,g,b){let I=!1;for(const z in e){const R=n.getPositions(z);for(const N of R){const $=u.feature(N.index);for(const W in this.binders){const Q=this.binders[W];if((Q instanceof yu||Q instanceof Qa||Q instanceof nh)&&Q.expression.isStateDependent===!0){const te=f.paint.get(W);Q.expression=te.value,Q.updatePaintArray(N.start,N.end,$,e[z],g,b),I=!0}}}}return I}defines(){const e=[];for(const n in this.binders){const u=this.binders[n];(u instanceof Md||u instanceof w1)&&e.push(...u.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const u=this.binders[n];if(u instanceof yu||u instanceof Qa||u instanceof nh)for(let f=0;f<u.paintVertexAttributes.length;f++)e.push(u.paintVertexAttributes[f].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const u=this.binders[n];if(u instanceof Md||u instanceof w1||u instanceof Qa)for(const f of u.uniformNames)e.push(f)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Md||f instanceof w1||f instanceof Qa)for(const g of f.uniformNames)n.push({name:g,property:u,binding:f.getBinding(e,g)})}return n}setUniforms(e,n,u,f,g){for(const{name:b,property:I,binding:z}of u)this.binders[I].setUniform(e,z,g,f.get(I),b)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const n=this.binders[e];(n instanceof yu||n instanceof Qa||n instanceof nh)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const n in this.binders){const u=this.binders[n];(u instanceof yu||u instanceof Qa||u instanceof nh)&&u.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof yu||n instanceof Qa||n instanceof nh)&&n.destroy()}}}class Vh{constructor(e,n,u=()=>!0){this.programConfigurations={};for(const f of e)this.programConfigurations[f.id]=new el(f,n,u);this.needsUpload=!1,this._featureMap=new yp,this._bufferOffset=0}populatePaintArrays(e,n,u,f,g,b,I){for(const z in this.programConfigurations)this.programConfigurations[z].populatePaintArrays(e,n,f,g,b,I);n.id!==void 0&&this._featureMap.add(n.id,u,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,u,f,g){for(const b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(e,this._featureMap,n,b,f,g)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const yo={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function xp(r,e){return yo[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}const H2={"line-pattern":{source:Ct,composite:Ct},"fill-pattern":{source:Ct,composite:Ct},"fill-extrusion-pattern":{source:Ct,composite:Ct},"line-dasharray":{source:ei,composite:ei}},vp={color:{source:Sl,composite:mi},number:{source:kn,composite:Sl}};function Cd(r,e,n){const u=H2[r];return u&&u[n]||vp[e][n]}Ft(Md,"ConstantBinder"),Ft(w1,"PatternConstantBinder"),Ft(yu,"SourceExpressionBinder"),Ft(nh,"PatternCompositeBinder"),Ft(Qa,"CompositeExpressionBinder"),Ft(el,"ProgramConfiguration",{omit:["_buffers"]}),Ft(Vh,"ProgramConfigurationSet");const T1="-transition";class Il extends Pr{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Ie(n.layout)),n.paint)){this._transitionablePaint=new oe(n.paint);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ze(n.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,u={}){n!=null&&this._validate(Ke,`layers.${this.id}.layout.${e}`,e,n,u)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return Rs(e,T1)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,u={}){if(n!=null&&this._validate(Pt,`layers.${this.id}.paint.${e}`,e,n,u))return!1;if(Rs(e,T1))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const f=this._transitionablePaint._values[e],g=f.value.isDataDriven(),b=f.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const I=this._transitionablePaint._values[e].value,z=I.isDataDriven(),R=Rs(e,"pattern")||e==="line-dasharray";return z||g||R||this._handleOverridablePaintPropertyUpdate(e,b,I)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,u){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),wn(e,(n,u)=>!(n===void 0||u==="layout"&&!Object.keys(n).length||u==="paint"&&!Object.keys(n).length))}_validate(e,n,u,f,g={}){return(!g||g.validate!==!1)&&Bt(this,e.call(vt,{key:n,layerType:this.type,objectKey:u,value:f,styleSpec:It,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof Ce&&vl(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Rc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const K2=yt([{name:"a_pos",components:2,type:"Int16"}],4),Id=yt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class co{constructor(e=[]){this.segments=e}prepareSegment(e,n,u,f){let g=this.segments[this.segments.length-1];return e>co.MAX_VERTEX_ARRAY_LENGTH&&sn(`Max vertices per segment is ${co.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!g||g.vertexLength+e>co.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==f)&&(g={vertexOffset:n.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},f!==void 0&&(g.sortKey=f),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,u,f){return new co([{vertexOffset:e,primitiveOffset:n,vertexLength:u,primitiveLength:f,vaos:{},sortKey:0}])}}co.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft(co,"SegmentVector");var sr=8192;class oh{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof gn?new gn(e.lng,e.lat):gn.convert(e),this}setSouthWest(e){return this._sw=e instanceof gn?new gn(e.lng,e.lat):gn.convert(e),this}extend(e){const n=this._sw,u=this._ne;let f,g;if(e instanceof gn)f=e,g=e;else{if(!(e instanceof oh))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(oh.convert(e)):this.extend(gn.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(gn.convert(e)):this;if(f=e._sw,g=e._ne,!f||!g)return this}return n||u?(n.lng=Math.min(f.lng,n.lng),n.lat=Math.min(f.lat,n.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new gn(f.lng,f.lat),this._ne=new gn(g.lng,g.lat)),this}getCenter(){return new gn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new gn(this.getWest(),this.getNorth())}getSouthEast(){return new gn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:u}=gn.convert(e);let f=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f}static convert(e){return!e||e instanceof oh?e:new oh(e)}}var Ad=1e-6,As=typeof Float32Array<"u"?Float32Array:Array;function Y2(){var r=new As(9);return As!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function bp(r,e,n){var u=e[0],f=e[1],g=e[2],b=e[3],I=e[4],z=e[5],R=e[6],N=e[7],$=e[8],W=n[0],Q=n[1],te=n[2],ce=n[3],we=n[4],Re=n[5],He=n[6],Be=n[7],We=n[8];return r[0]=W*u+Q*b+te*R,r[1]=W*f+Q*I+te*N,r[2]=W*g+Q*z+te*$,r[3]=ce*u+we*b+Re*R,r[4]=ce*f+we*I+Re*N,r[5]=ce*g+we*z+Re*$,r[6]=He*u+Be*b+We*R,r[7]=He*f+Be*I+We*N,r[8]=He*g+Be*z+We*$,r}function nc(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Pd(r,e){var n=e[0],u=e[1],f=e[2],g=e[3],b=e[4],I=e[5],z=e[6],R=e[7],N=e[8],$=e[9],W=e[10],Q=e[11],te=e[12],ce=e[13],we=e[14],Re=e[15],He=n*I-u*b,Be=n*z-f*b,We=n*R-g*b,it=u*z-f*I,et=u*R-g*I,Ot=f*R-g*z,Lt=N*ce-$*te,ti=N*we-W*te,vi=N*Re-Q*te,Vt=$*we-W*ce,ni=$*Re-Q*ce,oi=W*Re-Q*we,fi=He*oi-Be*ni+We*Vt+it*vi-et*ti+Ot*Lt;return fi?(r[0]=(I*oi-z*ni+R*Vt)*(fi=1/fi),r[1]=(f*ni-u*oi-g*Vt)*fi,r[2]=(ce*Ot-we*et+Re*it)*fi,r[3]=(W*et-$*Ot-Q*it)*fi,r[4]=(z*vi-b*oi-R*ti)*fi,r[5]=(n*oi-f*vi+g*ti)*fi,r[6]=(we*We-te*Ot-Re*Be)*fi,r[7]=(N*Ot-W*We+Q*Be)*fi,r[8]=(b*ni-I*vi+R*Lt)*fi,r[9]=(u*vi-n*ni-g*Lt)*fi,r[10]=(te*et-ce*We+Re*He)*fi,r[11]=($*We-N*et-Q*He)*fi,r[12]=(I*ti-b*Vt-z*Lt)*fi,r[13]=(n*Vt-u*ti+f*Lt)*fi,r[14]=(ce*Be-te*it-we*He)*fi,r[15]=(N*it-$*Be+W*He)*fi,r):null}function xu(r,e,n){var u=e[0],f=e[1],g=e[2],b=e[3],I=e[4],z=e[5],R=e[6],N=e[7],$=e[8],W=e[9],Q=e[10],te=e[11],ce=e[12],we=e[13],Re=e[14],He=e[15],Be=n[0],We=n[1],it=n[2],et=n[3];return r[0]=Be*u+We*I+it*$+et*ce,r[1]=Be*f+We*z+it*W+et*we,r[2]=Be*g+We*R+it*Q+et*Re,r[3]=Be*b+We*N+it*te+et*He,r[4]=(Be=n[4])*u+(We=n[5])*I+(it=n[6])*$+(et=n[7])*ce,r[5]=Be*f+We*z+it*W+et*we,r[6]=Be*g+We*R+it*Q+et*Re,r[7]=Be*b+We*N+it*te+et*He,r[8]=(Be=n[8])*u+(We=n[9])*I+(it=n[10])*$+(et=n[11])*ce,r[9]=Be*f+We*z+it*W+et*we,r[10]=Be*g+We*R+it*Q+et*Re,r[11]=Be*b+We*N+it*te+et*He,r[12]=(Be=n[12])*u+(We=n[13])*I+(it=n[14])*$+(et=n[15])*ce,r[13]=Be*f+We*z+it*W+et*we,r[14]=Be*g+We*R+it*Q+et*Re,r[15]=Be*b+We*N+it*te+et*He,r}function jh(r,e,n){var u,f,g,b,I,z,R,N,$,W,Q,te,ce=n[0],we=n[1],Re=n[2];return e===r?(r[12]=e[0]*ce+e[4]*we+e[8]*Re+e[12],r[13]=e[1]*ce+e[5]*we+e[9]*Re+e[13],r[14]=e[2]*ce+e[6]*we+e[10]*Re+e[14],r[15]=e[3]*ce+e[7]*we+e[11]*Re+e[15]):(f=e[1],g=e[2],b=e[3],I=e[4],z=e[5],R=e[6],N=e[7],$=e[8],W=e[9],Q=e[10],te=e[11],r[0]=u=e[0],r[1]=f,r[2]=g,r[3]=b,r[4]=I,r[5]=z,r[6]=R,r[7]=N,r[8]=$,r[9]=W,r[10]=Q,r[11]=te,r[12]=u*ce+I*we+$*Re+e[12],r[13]=f*ce+z*we+W*Re+e[13],r[14]=g*ce+R*we+Q*Re+e[14],r[15]=b*ce+N*we+te*Re+e[15]),r}function Gh(r,e,n){var u=n[0],f=n[1],g=n[2];return r[0]=e[0]*u,r[1]=e[1]*u,r[2]=e[2]*u,r[3]=e[3]*u,r[4]=e[4]*f,r[5]=e[5]*f,r[6]=e[6]*f,r[7]=e[7]*f,r[8]=e[8]*g,r[9]=e[9]*g,r[10]=e[10]*g,r[11]=e[11]*g,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function W0(r,e,n){var u=Math.sin(n),f=Math.cos(n),g=e[4],b=e[5],I=e[6],z=e[7],R=e[8],N=e[9],$=e[10],W=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=g*f+R*u,r[5]=b*f+N*u,r[6]=I*f+$*u,r[7]=z*f+W*u,r[8]=R*f-g*u,r[9]=N*f-b*u,r[10]=$*f-I*u,r[11]=W*f-z*u,r}function wp(r,e,n){var u=Math.sin(n),f=Math.cos(n),g=e[0],b=e[1],I=e[2],z=e[3],R=e[8],N=e[9],$=e[10],W=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=g*f-R*u,r[1]=b*f-N*u,r[2]=I*f-$*u,r[3]=z*f-W*u,r[8]=g*u+R*f,r[9]=b*u+N*f,r[10]=I*u+$*f,r[11]=z*u+W*f,r}function J2(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Q2(r,e,n){var u,f,g,b=n[0],I=n[1],z=n[2],R=Math.hypot(b,I,z);return R<Ad?null:(b*=R=1/R,I*=R,z*=R,u=Math.sin(e),f=Math.cos(e),r[0]=b*b*(g=1-f)+f,r[1]=I*b*g+z*u,r[2]=z*b*g-I*u,r[3]=0,r[4]=b*I*g-z*u,r[5]=I*I*g+f,r[6]=z*I*g+b*u,r[7]=0,r[8]=b*z*g+I*u,r[9]=I*z*g-b*u,r[10]=z*z*g+f,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var sh=xu;function X0(){var r=new As(3);return As!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function H0(r){var e=new As(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function Uc(r){return Math.hypot(r[0],r[1],r[2])}function E1(r,e,n){var u=new As(3);return u[0]=r,u[1]=e,u[2]=n,u}function vu(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r}function K0(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r}function Y0(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r[2]=e[2]*n[2],r}function S1(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r[2]=Math.min(e[2],n[2]),r}function kd(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r[2]=Math.max(e[2],n[2]),r}function tl(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r}function zd(r,e,n,u){return r[0]=e[0]+n[0]*u,r[1]=e[1]+n[1]*u,r[2]=e[2]+n[2]*u,r}function Js(r,e){var n=e[0],u=e[1],f=e[2],g=n*n+u*u+f*f;return g>0&&(g=1/Math.sqrt(g)),r[0]=e[0]*g,r[1]=e[1]*g,r[2]=e[2]*g,r}function Ca(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function $h(r,e,n){var u=e[0],f=e[1],g=e[2],b=n[0],I=n[1],z=n[2];return r[0]=f*z-g*I,r[1]=g*b-u*z,r[2]=u*I-f*b,r}function oo(r,e,n){var u=e[0],f=e[1],g=e[2],b=n[3]*u+n[7]*f+n[11]*g+n[15];return r[0]=(n[0]*u+n[4]*f+n[8]*g+n[12])/(b=b||1),r[1]=(n[1]*u+n[5]*f+n[9]*g+n[13])/b,r[2]=(n[2]*u+n[6]*f+n[10]*g+n[14])/b,r}function em(r,e,n){var u=n[0],f=n[1],g=n[2],b=e[0],I=e[1],z=e[2],R=f*z-g*I,N=g*b-u*z,$=u*I-f*b,W=f*$-g*N,Q=g*R-u*$,te=u*N-f*R,ce=2*n[3];return N*=ce,$*=ce,Q*=2,te*=2,r[0]=b+(R*=ce)+(W*=2),r[1]=I+N+Q,r[2]=z+$+te,r}var Dd,oc=K0,Ld=Y0,tm=Uc;function im(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r}function rm(r,e){var n=e[0],u=e[1],f=e[2],g=e[3],b=n*n+u*u+f*f+g*g;return b>0&&(b=1/Math.sqrt(b)),r[0]=n*b,r[1]=u*b,r[2]=f*b,r[3]=g*b,r}function Zh(r,e,n){var u=e[0],f=e[1],g=e[2],b=e[3];return r[0]=n[0]*u+n[4]*f+n[8]*g+n[12]*b,r[1]=n[1]*u+n[5]*f+n[9]*g+n[13]*b,r[2]=n[2]*u+n[6]*f+n[10]*g+n[14]*b,r[3]=n[3]*u+n[7]*f+n[11]*g+n[15]*b,r}function nm(){var r=new As(4);return As!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function om(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function sm(r,e,n){n*=.5;var u=e[0],f=e[1],g=e[2],b=e[3],I=Math.sin(n),z=Math.cos(n);return r[0]=u*z+b*I,r[1]=f*z+g*I,r[2]=g*z-f*I,r[3]=b*z-u*I,r}function J0(r,e,n){n*=.5;var u=e[0],f=e[1],g=e[2],b=e[3],I=Math.sin(n),z=Math.cos(n);return r[0]=u*z-g*I,r[1]=f*z+b*I,r[2]=g*z+u*I,r[3]=b*z-f*I,r}X0(),Dd=new As(4),As!=Float32Array&&(Dd[0]=0,Dd[1]=0,Dd[2]=0,Dd[3]=0);var Q0=rm;X0(),E1(1,0,0),E1(0,1,0),nm(),nm(),Y2();const j5=yt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ef}=j5,tf=yt([{name:"a_pos_3",components:3,type:"Int16"}]);var M1=yt([{name:"a_pos",type:"Int16",components:2}]);class rf{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,u){const f=Ca(n,this.dir);if(Math.abs(f)<1e-6)return!1;const g=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/f;return u[0]=this.pos[0]+this.dir[0]*g,u[1]=this.pos[1]+this.dir[1]*g,u[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(e,n,u){if(function(Q,te){var ce=Q[0],we=Q[1],Re=Q[2],He=te[0],Be=te[1],We=te[2];return Math.abs(ce-He)<=Ad*Math.max(1,Math.abs(ce),Math.abs(He))&&Math.abs(we-Be)<=Ad*Math.max(1,Math.abs(we),Math.abs(Be))&&Math.abs(Re-We)<=Ad*Math.max(1,Math.abs(Re),Math.abs(We))}(this.pos,e)||n===0)return u[0]=u[1]=u[2]=0,!1;const[f,g,b]=this.dir,I=this.pos[0]-e[0],z=this.pos[1]-e[1],R=this.pos[2]-e[2],N=f*f+g*g+b*b,$=2*(I*f+z*g+R*b),W=$*$-4*N*(I*I+z*z+R*R-n*n);if(W<0){const Q=Math.max(-$/2,0),te=I+f*Q,ce=z+g*Q,we=R+b*Q,Re=Math.hypot(te,ce,we);return u[0]=te*n/Re,u[1]=ce*n/Re,u[2]=we*n/Re,!1}{const Q=(-$-Math.sqrt(W))/(2*N);if(Q<0){const te=Math.hypot(I,z,R);return u[0]=I*n/te,u[1]=z*n/te,u[2]=R*n/te,!1}return u[0]=I+f*Q,u[1]=z+g*Q,u[2]=R+b*Q,!0}}}class nf{constructor(e,n,u,f,g){this.TL=e,this.TR=n,this.BR=u,this.BL=f,this.horizon=g}static fromInvProjectionMatrix(e,n,u){const f=[-1,1,1],g=[1,1,1],b=[1,-1,1],I=[-1,-1,1],z=oo(f,f,e),R=oo(g,g,e),N=oo(b,b,e),$=oo(I,I,e);return new nf(z,R,N,$,n/u)}}class of{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,u,f){const g=Math.pow(2,u),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(z=>{const R=Zh([],z,e),N=1/R[3]/n*g;return function($,W,Q){return $[0]=W[0]*Q[0],$[1]=W[1]*Q[1],$[2]=W[2]*Q[2],$[3]=W[3]*Q[3],$}(R,R,[N,N,f?1/R[3]:N,N])}),I=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(z=>{const R=Js([],$h([],oc([],b[z[0]],b[z[1]]),oc([],b[z[2]],b[z[1]]))),N=-Ca(R,b[z[1]]);return R.concat(N)});return new of(b,I)}}class Os{static fromPoints(e){const n=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const f of e)S1(n,n,f),kd(u,u,f);return new Os(n,u)}static applyTransform(e,n){const u=e.getCorners();for(let f=0;f<u.length;++f)oo(u[f],u[f],n);return Os.fromPoints(u)}constructor(e,n){this.min=e,this.max=n,this.center=tl([],vu([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],u=H0(this.min),f=H0(this.max);for(let g=0;g<n.length;g++)u[g]=n[g]?this.min[g]:this.center[g],f[g]=n[g]?this.center[g]:this.max[g];return f[2]=this.max[2],new Os(u,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let u=!0;for(let f=0;f<e.planes.length;f++){const g=e.planes[f];let b=0;for(let I=0;I<n.length;I++)b+=Ca(g,n[I])+g[3]>=0;if(b===0)return 0;b!==n.length&&(u=!1)}if(u)return 2;for(let f=0;f<3;f++){let g=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let I=0;I<e.points.length;I++){const z=e.points[I][f]-this.min[f];g=Math.min(g,z),b=Math.max(b,z)}if(b<0||g>this.max[f]-this.min[f])return 0}return 1}}const sf=5,am=6,Ia=sr/Math.PI/2,cs=16383,bu=64,C1=[bu,32,16],il=-Ia,Hr=Ia,ah=[new Os([il,il,il],[Hr,Hr,Hr]),new Os([il,il,il],[0,0,Hr]),new Os([0,il,il],[Hr,0,Hr]),new Os([il,0,il],[0,Hr,Hr]),new Os([0,0,il],[Hr,Hr,Hr])];function I1(r){return r*Ia/wu}function af(r,e,n,u=!0){const f=tl([],r._camera.position,r.worldSize),g=[e,n,1,1];Zh(g,g,r.pixelMatrixInverse),im(g,g,1/g[3]);const b=Js([],oc([],g,f)),I=r.globeMatrix,z=[I[12],I[13],I[14]],R=oc([],z,f),N=Uc(R),$=Js([],R),W=r.worldSize/(2*Math.PI),Q=Ca($,b),te=Math.asin(W/N);if(te<Math.acos(Q)){if(!u)return null;const vi=[],Vt=[];tl(vi,b,N/Q),Js(Vt,oc(Vt,vi,R)),Js(b,vu(b,R,tl(b,Vt,Math.tan(te)*N)))}const ce=[];new rf(f,b).closestPointOnSphere(z,W,ce);const we=Js([],ys(I,0)),Re=Js([],ys(I,1)),He=Js([],ys(I,2)),Be=Ca(we,ce),We=Ca(Re,ce),it=Ca(He,ce),et=fr(Math.asin(-We/W));let Ot=fr(Math.atan2(Be,it));Ot=r.center.lng+function(vi,Vt){const ni=(Vt-vi+180)%360-180;return ni<-180?ni+360:ni}(r.center.lng,Ot);const Lt=lc(Ot),ti=pt(cc(et),0,1);return new z1(Lt,ti)}class lm{constructor(e,n,u){this.a=oc([],e,u),this.b=oc([],n,u),this.center=u;const f=Js([],this.a),g=Js([],this.b);this.angle=Math.acos(Ca(f,g))}}function sc(r,e){if(r.angle===0)return null;let n;return n=r.a[e]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[e]/r.a[e]/Math.sin(r.angle)-1/Math.tan(r.angle)),n<0||n>1?null:function(u,f,g,b){const I=Math.sin(g);return u*(Math.sin((1-b)*g)/I)+f*(Math.sin(b*g)/I)}(r.a[e],r.b[e],r.angle,pt(n,0,1))+r.center[e]}function pa(r){if(r.z<=1)return ah[r.z+2*r.y+r.x];const e=lf(Tp(r));return Os.fromPoints(e)}function lh(r,e,n){return tl(r,r,1-n),zd(r,r,e,n)}function cm(r,e){const n=k1(e.zoom);if(n===0)return pa(r);const u=Tp(r),f=lf(u),g=lc(u.getWest())*e.worldSize,b=lc(u.getEast())*e.worldSize,I=cc(u.getNorth())*e.worldSize,z=cc(u.getSouth())*e.worldSize,R=[g,I,0],N=[b,I,0],$=[g,z,0],W=[b,z,0],Q=Pd([],e.globeMatrix);return oo(R,R,Q),oo(N,N,Q),oo($,$,Q),oo(W,W,Q),f[0]=lh(f[0],$,n),f[1]=lh(f[1],W,n),f[2]=lh(f[2],N,n),f[3]=lh(f[3],R,n),Os.fromPoints(f)}function um(r,e,n){for(const u of r)oo(u,u,e),tl(u,u,n)}function G5(r,e,n){const u=e/r.worldSize,f=r.globeMatrix;if(n.z<=1){const Lt=pa(n).getCorners();return um(Lt,f,u),Os.fromPoints(Lt)}const g=Tp(n),b=lf(g);um(b,f,u);const I=Number.MAX_VALUE,z=[-I,-I,-I],R=[I,I,I];if(g.contains(r.center)){for(const vi of b)S1(R,R,vi),kd(z,z,vi);z[2]=0;const Lt=r.point,ti=[Lt.x*u,Lt.y*u,0];return S1(R,R,ti),kd(z,z,ti),new Os(R,z)}const N=[f[12]*u,f[13]*u,f[14]*u],$=g.getCenter(),W=pt(r.center.lat,-es,es),Q=pt($.lat,-es,es),te=lc(r.center.lng),ce=cc(W);let we=te-lc($.lng);const Re=ce-cc(Q);we>.5?we-=1:we<-.5&&(we+=1);let He=0;Math.abs(we)>Math.abs(Re)?He=we>=0?1:3:(He=Re>=0?0:2,zd(N,N,[f[4]*u,f[5]*u,f[6]*u],-Math.sin(ki(Re>=0?g.getSouth():g.getNorth()))*Ia));const Be=b[He],We=b[(He+1)%4],it=new lm(Be,We,N),et=[sc(it,0)||Be[0],sc(it,1)||Be[1],sc(it,2)||Be[2]],Ot=k1(r.zoom);if(Ot>0){const Lt=function({x:vi,y:Vt,z:ni},oi,fi,Ti,Jt){const Bi=1/(1<<ni);let Ki=vi*Bi,Oi=Ki+Bi,Dr=Vt*Bi,Ei=Dr+Bi,ur=0;const Lr=(Ki+Oi)/2-Ti;return Lr>.5?ur=-1:Lr<-.5&&(ur=1),Ki=((Ki+ur)*oi-(Ti*=oi))*fi+Ti,Oi=((Oi+ur)*oi-Ti)*fi+Ti,Dr=(Dr*oi-(Jt*=oi))*fi+Jt,Ei=(Ei*oi-Jt)*fi+Jt,[[Ki,Ei,0],[Oi,Ei,0],[Oi,Dr,0],[Ki,Dr,0]]}(n,e,r._pixelsPerMercatorPixel,te,ce);for(let vi=0;vi<b.length;vi++)lh(b[vi],Lt[vi],Ot);const ti=vu([],Lt[He],Lt[(He+1)%4]);tl(ti,ti,.5),lh(et,ti,Ot)}for(const Lt of b)S1(R,R,Lt),kd(z,z,Lt);return R[2]=Math.min(Be[2],We[2]),S1(R,R,et),kd(z,z,et),new Os(R,z)}function Tp({x:r,y:e,z:n}){const u=1/(1<<n),f=new gn(Aa(r*u),us((e+1)*u)),g=new gn(Aa((r+1)*u),us(e*u));return new oh(f,g)}function lf(r){const e=ki(r.getNorth()),n=ki(r.getSouth()),u=Math.cos(e),f=Math.cos(n),g=Math.sin(e),b=Math.sin(n),I=r.getWest(),z=r.getEast();return[A1(f,b,I),A1(f,b,z),A1(u,g,z),A1(u,g,I)]}function A1(r,e,n,u=Ia){return n=ki(n),[r*Math.sin(n)*u,-e*u,r*Math.cos(n)*u]}function P1(r,e,n){return A1(Math.cos(ki(r)),Math.sin(ki(r)),e,n)}function Rd(r,e,n,u){const f=1<<n.z,g=(r/sr+n.x)/f;return P1(us((e/sr+n.y)/f),Aa(g),u)}function Ep({min:r,max:e}){return cs/Math.max(e[0]-r[0],e[1]-r[1],e[2]-r[2])}const Bd=new Float64Array(16);function Nc(r){const e=Ep(r),n=J2(Bd,[e,e,e]);return jh(n,n,((u=[])[0]=-(f=r.min)[0],u[1]=-f[1],u[2]=-f[2],u));var u,f}function Sp(r){const e=(u=r.min,(n=Bd)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=u[0],n[13]=u[1],n[14]=u[2],n[15]=1,n);var n,u;const f=1/Ep(r);return Gh(e,e,[f,f,f])}function hm(r,e,n,u,f){const g=function(z){const R=sr/(2*Math.PI);return z/(2*Math.PI)/R}(n),b=[r,e,-n/(2*Math.PI)],I=nc(new Float64Array(16));return jh(I,I,b),Gh(I,I,[g,g,g]),W0(I,I,ki(-f)),wp(I,I,ki(-u)),I}function k1(r){return hi(sf,am,r)}function dm(r,e){const n=P1(e.lat,e.lng),u=function(te){const ce=P1(te._center.lat,te._center.lng);let we=$h([],E1(0,1,0),ce);const Re=Q2([],-te.angle,ce);we=oo(we,we,Re),Q2(Re,-te._pitch,we);const He=Js([],ce);return tl(He,He,I1(te.cameraToCenterDistance/te.pixelsPerMeter)),oo(He,He,Re),vu([],ce,He)}(r);return b=(f=K0([],u,n))[0],I=f[1],z=f[2],R=(g=n)[0],N=g[1],$=g[2],Q=(W=Math.sqrt(b*b+I*I+z*z)*Math.sqrt(R*R+N*N+$*$))&&Ca(f,g)/W,Math.acos(Math.min(Math.max(Q,-1),1));var f,g,b,I,z,R,N,$,W,Q}function Mp(r,e){return dm(r,e)>Math.PI/2*1.01}const Cp=ki(85),pm=Math.cos(Cp),Ip=Math.sin(Cp),wu=63710088e-1,qh=2*Math.PI*wu;class ac{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ac(Si(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,u=this.lat*n,f=e.lat*n,g=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos((e.lng-this.lng)*n);return wu*Math.acos(Math.min(g,1))}toBounds(e=0){const n=360*e/40075017,u=n/Math.cos(Math.PI/180*this.lat);return new oh(new ac(this.lng-u,this.lat-n),new ac(this.lng+u,this.lat+n))}toEcef(e){const n=I1(e);return P1(this.lat,this.lng,Ia+n)}static convert(e){if(e instanceof ac)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ac(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ac(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var gn=ac;function cf(r){return qh*Math.cos(r*Math.PI/180)}function lc(r){return(180+r)/360}function cc(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function uc(r,e){return r/cf(e)}function Aa(r){return 360*r-180}function us(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Ap(r,e){return r*cf(us(e))}const es=85.051129;function fm(r){return 1/Math.cos(r*Math.PI/180)}class z1{constructor(e,n,u=0){this.x=+e,this.y=+n,this.z=+u}static fromLngLat(e,n=0){const u=gn.convert(e);return new z1(lc(u.lng),cc(u.lat),uc(n,u.lat))}toLngLat(){return new gn(Aa(this.x),us(this.y))}toAltitude(){return Ap(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/qh*fm(us(this.y))}}function Pp(r,e,n,u,f,g,b,I,z){const R=(e+u)/2,N=(n+f)/2,$=new zt(R,N);I($),function(W,Q,te,ce,we,Re){const He=te-we,Be=ce-Re;return Math.abs((ce-Q)*He-(te-W)*Be)/Math.hypot(He,Be)}($.x,$.y,g.x,g.y,b.x,b.y)>=z?(Pp(r,e,n,R,N,g,$,I,z),Pp(r,R,N,u,f,$,b,I,z)):r.push(b)}function Vc(r,e,n){let u=r[0],f=u.x,g=u.y;e(u);const b=[u];for(let I=1;I<r.length;I++){const z=r[I],{x:R,y:N}=z;e(z),Pp(b,f,g,R,N,u,z,e,n),f=R,g=N,u=z}return b}function kp(r,e,n,u){if(u(e,n)){const f=e.add(n)._mult(.5);kp(r,e,f,u),kp(r,f,n,u)}else r.push(n)}function ch(r,e){let n=r[0];const u=[n];for(let f=1;f<r.length;f++){const g=r[f];kp(u,n,g,e),n=g}return u}const zp=Math.pow(2,14)-1,uf=-zp-1;function mm(r,e){const n=Math.round(r.x*e),u=Math.round(r.y*e);return r.x=pt(n,uf,zp),r.y=pt(u,uf,zp),(n<r.x||n>r.x+1||u<r.y||u>r.y+1)&&sn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function jc(r,e,n){const u=r.loadGeometry(),f=r.extent,g=sr/f;if(e&&n&&n.projection.isReprojectedInTileSpace){const b=1<<e.z,{scale:I,x:z,y:R,projection:N}=n,$=W=>{const Q=Aa((e.x+W.x/f)/b),te=us((e.y+W.y/f)/b),ce=N.project(Q,te);W.x=(ce.x*I-z)*f,W.y=(ce.y*I-R)*f};for(let W=0;W<u.length;W++)if(r.type!==1)u[W]=Vc(u[W],$,1);else{const Q=[];for(const te of u[W])te.x<0||te.x>=f||te.y<0||te.y>=f||($(te),Q.push(te));u[W]=Q}}for(const b of u)for(const I of b)mm(I,g);return u}function Wh(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?jc(r):[]}}function Dp(r,e,n,u,f){r.emplaceBack(2*e+(u+1)/2,2*n+(f+1)/2)}function Fd(r,e,n){r.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class Lp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new yi,this.indexArray=new er,this.segments=new co,this.programConfigurations=new Vh(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,u,f){const g=this.layers[0],b=[];let I=null;g.type==="circle"&&(I=g.layout.get("circle-sort-key"));for(const{feature:R,id:N,index:$,sourceLayerIndex:W}of e){const Q=this.layers[0]._featureFilter.needGeometry,te=Wh(R,Q);if(!this.layers[0]._featureFilter.filter(new G(this.zoom),te,u))continue;const ce=I?I.evaluate(te,{},u):void 0,we={id:N,properties:R.properties,type:R.type,sourceLayerIndex:W,index:$,geometry:Q?te.geometry:jc(R,u,f),patterns:{},sortKey:ce};b.push(we)}I&&b.sort((R,N)=>R.sortKey-N.sortKey);let z=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new _i,z=f.projection);for(const R of b){const{geometry:N,index:$,sourceLayerIndex:W}=R,Q=e[$].feature;this.addFeature(R,N,$,n.availableImages,u,z),n.featureIndex.insert(Q,N,$,W,this.index)}}update(e,n,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,K2.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Id.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,u,f,g,b){for(const I of n)for(const z of I){const R=z.x,N=z.y;if(R<0||R>=sr||N<0||N>=sr)continue;if(b){const Q=b.projectTilePoint(R,N,g),te=b.upVector(g,R,N),ce=this.globeExtVertexArray;Fd(ce,Q,te),Fd(ce,Q,te),Fd(ce,Q,te),Fd(ce,Q,te)}const $=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),W=$.vertexLength;Dp(this.layoutVertexArray,R,N,-1,-1),Dp(this.layoutVertexArray,R,N,1,-1),Dp(this.layoutVertexArray,R,N,1,1),Dp(this.layoutVertexArray,R,N,-1,1),this.indexArray.emplaceBack(W,W+1,W+2),this.indexArray.emplaceBack(W,W+2,W+3),$.vertexLength+=4,$.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{},f,g)}}function hf(r,e){for(let n=0;n<r.length;n++)if(Xh(e,r[n]))return!0;for(let n=0;n<e.length;n++)if(Xh(r,e[n]))return!0;return!!D1(r,e)}function Rp(r,e,n){return!!Xh(r,e)||!!pf(e,r,n)}function df(r,e){if(r.length===1)return gm(e,r[0]);for(let n=0;n<e.length;n++){const u=e[n];for(let f=0;f<u.length;f++)if(Xh(r,u[f]))return!0}for(let n=0;n<r.length;n++)if(gm(e,r[n]))return!0;for(let n=0;n<e.length;n++)if(D1(r,e[n]))return!0;return!1}function Bp(r,e,n){if(r.length>1){if(D1(r,e))return!0;for(let u=0;u<e.length;u++)if(pf(e[u],r,n))return!0}for(let u=0;u<r.length;u++)if(pf(r[u],e,n))return!0;return!1}function D1(r,e){if(r.length===0||e.length===0)return!1;for(let n=0;n<r.length-1;n++){const u=r[n],f=r[n+1];for(let g=0;g<e.length-1;g++)if(Fp(u,f,e[g],e[g+1]))return!0}return!1}function Fp(r,e,n,u){return Vn(r,n,u)!==Vn(e,n,u)&&Vn(r,e,n)!==Vn(r,e,u)}function pf(r,e,n){const u=n*n;if(e.length===1)return r.distSqr(e[0])<u;for(let f=1;f<e.length;f++)if(_m(r,e[f-1],e[f])<u)return!0;return!1}function _m(r,e,n){const u=e.distSqr(n);if(u===0)return r.distSqr(e);const f=((r.x-e.x)*(n.x-e.x)+(r.y-e.y)*(n.y-e.y))/u;return r.distSqr(f<0?e:f>1?n:n.sub(e)._mult(f)._add(e))}function gm(r,e){let n,u,f,g=!1;for(let b=0;b<r.length;b++){n=r[b];for(let I=0,z=n.length-1;I<n.length;z=I++)u=n[I],f=n[z],u.y>e.y!=f.y>e.y&&e.x<(f.x-u.x)*(e.y-u.y)/(f.y-u.y)+u.x&&(g=!g)}return g}function Xh(r,e){let n=!1;for(let u=0,f=r.length-1;u<r.length;f=u++){const g=r[u],b=r[f];g.y>e.y!=b.y>e.y&&e.x<(b.x-g.x)*(e.y-g.y)/(b.y-g.y)+g.x&&(n=!n)}return n}function Hh(r,e,n,u,f){for(const b of r)if(e<=b.x&&n<=b.y&&u>=b.x&&f>=b.y)return!0;const g=[new zt(e,n),new zt(e,f),new zt(u,f),new zt(u,n)];if(r.length>2){for(const b of g)if(Xh(r,b))return!0}for(let b=0;b<r.length-1;b++)if(ff(r[b],r[b+1],g))return!0;return!1}function ff(r,e,n){const u=n[0],f=n[2];if(r.x<u.x&&e.x<u.x||r.x>f.x&&e.x>f.x||r.y<u.y&&e.y<u.y||r.y>f.y&&e.y>f.y)return!1;const g=Vn(r,e,n[0]);return g!==Vn(r,e,n[1])||g!==Vn(r,e,n[2])||g!==Vn(r,e,n[3])}function Kh(r,e,n){const u=e.paint.get(r).value;return u.kind==="constant"?u.value:n.programConfigurations.get(e.id).getMaxValue(r)}function L1(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function ym(r,e,n,u,f){if(!e[0]&&!e[1])return r;const g=zt.convert(e)._mult(f);n==="viewport"&&g._rotate(-u);const b=[];for(let I=0;I<r.length;I++)b.push(r[I].sub(g));return b}function Tu(r,e,n,u){const f=zt.convert(r)._mult(u);return e==="viewport"&&f._rotate(-n),f}Ft(Lp,"CircleBucket",{omit:["layers"]});const xm=new Ge({"circle-sort-key":new Me(It.layout_circle["circle-sort-key"])});var vm={paint:new Ge({"circle-radius":new Me(It.paint_circle["circle-radius"]),"circle-color":new Me(It.paint_circle["circle-color"]),"circle-blur":new Me(It.paint_circle["circle-blur"]),"circle-opacity":new Me(It.paint_circle["circle-opacity"]),"circle-translate":new ae(It.paint_circle["circle-translate"]),"circle-translate-anchor":new ae(It.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ae(It.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ae(It.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Me(It.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Me(It.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Me(It.paint_circle["circle-stroke-opacity"])}),layout:xm};function bm(r,e,n,u,f,g,b,I,z){if(g&&r.queryGeometry.isAboveHorizon)return!1;g&&(z*=r.pixelToTileUnitsFactor);const R=r.tileID.canonical,N=n.projection.upVectorScale(R,n.center.lat,n.worldSize).metersToTile;for(const $ of e)for(const W of $){const Q=W.add(I),te=f&&n.elevation?n.elevation.exaggeration()*f.getElevationAt(Q.x,Q.y,!0):0,ce=n.projection.projectTilePoint(Q.x,Q.y,R);if(te>0){const Be=n.projection.upVector(R,Q.x,Q.y);ce.x+=Be[0]*N*te,ce.y+=Be[1]*N*te,ce.z+=Be[2]*N*te}const we=g?Q:$5(ce.x,ce.y,ce.z,u),Re=g?r.tilespaceRays.map(Be=>mf(Be,te)):r.queryGeometry.screenGeometry,He=Zh([],[ce.x,ce.y,ce.z,1],u);if(!b&&g?z*=He[3]/n.cameraToCenterDistance:b&&!g&&(z*=n.cameraToCenterDistance/He[3]),g){const Be=us((W.y/sr+R.y)/(1<<R.z));z/=n.projection.pixelsPerMeter(Be,1)/uc(1,Be)}if(Rp(Re,we,z))return!0}return!1}function $5(r,e,n,u){const f=Zh([],[r,e,n,1],u);return new zt(f[0]/f[3],f[1]/f[3])}const wm=E1(0,0,0),Op=E1(0,0,1);function mf(r,e){const n=X0();return wm[2]=e,r.intersectsPlane(wm,Op,n),new zt(n[0],n[1])}class Tm extends Lp{}function Up(r,{width:e,height:n},u,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==e*n*u)throw new RangeError("mismatched image size")}else f=new Uint8Array(e*n*u);return r.width=e,r.height=n,r.data=f,r}function Np(r,e,n){const{width:u,height:f}=e;u===r.width&&f===r.height||(uh(r,e,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,u),height:Math.min(r.height,f)},n),r.width=u,r.height=f,r.data=e.data)}function uh(r,e,n,u,f,g){if(f.width===0||f.height===0)return e;if(f.width>r.width||f.height>r.height||n.x>r.width-f.width||n.y>r.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>e.width||f.height>e.height||u.x>e.width-f.width||u.y>e.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const b=r.data,I=e.data;for(let z=0;z<f.height;z++){const R=((n.y+z)*r.width+n.x)*g,N=((u.y+z)*e.width+u.x)*g;for(let $=0;$<f.width*g;$++)I[N+$]=b[R+$]}return e}Ft(Tm,"HeatmapBucket",{omit:["layers"]});class Eu{constructor(e,n){Up(this,e,1,n)}resize(e){Np(this,new Eu(e),1)}clone(){return new Eu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,u,f,g){uh(e,n,u,f,g,1)}}class Qs{constructor(e,n){Up(this,e,4,n)}resize(e){Np(this,new Qs(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Qs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,u,f,g){uh(e,n,u,f,g,4)}}Ft(Eu,"AlphaImage"),Ft(Qs,"RGBAImage");var Em={paint:new Ge({"heatmap-radius":new Me(It.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Me(It.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ae(It.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ue(It.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ae(It.paint_heatmap["heatmap-opacity"])})};function R1(r){const e={},n=r.resolution||256,u=r.clips?r.clips.length:1,f=r.image||new Qs({width:n,height:u}),g=(b,I,z)=>{e[r.evaluationKey]=z;const R=r.expression.evaluate(e);f.data[b+I+0]=Math.floor(255*R.r/R.a),f.data[b+I+1]=Math.floor(255*R.g/R.a),f.data[b+I+2]=Math.floor(255*R.b/R.a),f.data[b+I+3]=Math.floor(255*R.a)};if(r.clips)for(let b=0,I=0;b<u;++b,I+=4*n)for(let z=0,R=0;z<n;z++,R+=4){const N=z/(n-1),{start:$,end:W}=r.clips[b];g(I,R,$*(1-N)+W*N)}else for(let b=0,I=0;b<n;b++,I+=4)g(0,I,b/(n-1));return f}var _f={paint:new Ge({"hillshade-illumination-direction":new ae(It.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ae(It.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ae(It.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ae(It.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ae(It.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ae(It.paint_hillshade["hillshade-accent-color"])})};const Z5=yt([{name:"a_pos",components:2,type:"Int16"}],4),{members:q5}=Z5;var gf={exports:{}};function Vp(r,e,n){n=n||2;var u,f,g,b,I,z,R,N=e&&e.length,$=N?e[0]*n:r.length,W=Sm(r,0,$,n,!0),Q=[];if(!W||W.next===W.prev)return Q;if(N&&(W=function(ce,we,Re,He){var Be,We,it,et=[];for(Be=0,We=we.length;Be<We;Be++)(it=Sm(ce,we[Be]*He,Be<We-1?we[Be+1]*He:ce.length,He,!1))===it.next&&(it.steiner=!0),et.push(km(it));for(et.sort(Am),Be=0;Be<et.length;Be++)Re=Pm(et[Be],Re);return Re}(r,e,W,n)),r.length>80*n){u=g=r[0],f=b=r[1];for(var te=n;te<$;te+=n)(I=r[te])<u&&(u=I),(z=r[te+1])<f&&(f=z),I>g&&(g=I),z>b&&(b=z);R=(R=Math.max(g-u,b-f))!==0?32767/R:0}return Wn(W,Q,n,u,f,R,0),Q}function Sm(r,e,n,u,f){var g,b;if(f===O1(r,e,n,u)>0)for(g=e;g<n;g+=u)b=bf(g,r[g],r[g+1],b);else for(g=n-u;g>=e;g-=u)b=bf(g,r[g],r[g+1],b);return b&&ph(b,b.next)&&(Nd(b),b=b.next),b}function hh(r,e){if(!r)return r;e||(e=r);var n,u=r;do if(n=!1,u.steiner||!ph(u,u.next)&&yn(u.prev,u,u.next)!==0)u=u.next;else{if(Nd(u),(u=e=u.prev)===u.next)break;n=!0}while(n||u!==e);return e}function Wn(r,e,n,u,f,g,b){if(r){!b&&g&&function(N,$,W,Q){var te=N;do te.z===0&&(te.z=B1(te.x,te.y,$,W,Q)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next;while(te!==N);te.prevZ.nextZ=null,te.prevZ=null,function(ce){var we,Re,He,Be,We,it,et,Ot,Lt=1;do{for(Re=ce,ce=null,We=null,it=0;Re;){for(it++,He=Re,et=0,we=0;we<Lt&&(et++,He=He.nextZ);we++);for(Ot=Lt;et>0||Ot>0&&He;)et!==0&&(Ot===0||!He||Re.z<=He.z)?(Be=Re,Re=Re.nextZ,et--):(Be=He,He=He.nextZ,Ot--),We?We.nextZ=Be:ce=Be,Be.prevZ=We,We=Be;Re=He}We.nextZ=null,Lt*=2}while(it>1)}(te)}(r,u,f,g);for(var I,z,R=r;r.prev!==r.next;)if(I=r.prev,z=r.next,g?Mm(r,u,f,g):Yh(r))e.push(I.i/n|0),e.push(r.i/n|0),e.push(z.i/n|0),Nd(r),r=z.next,R=z.next;else if((r=z)===R){b?b===1?Wn(r=Cm(hh(r),e,n),e,n,u,f,g,2):b===2&&Im(r,e,n,u,f,g):Wn(hh(r),e,n,u,f,g,1);break}}}function Yh(r){var e=r.prev,n=r,u=r.next;if(yn(e,n,u)>=0)return!1;for(var f=e.x,g=n.x,b=u.x,I=e.y,z=n.y,R=u.y,N=f<g?f<b?f:b:g<b?g:b,$=I<z?I<R?I:R:z<R?z:R,W=f>g?f>b?f:b:g>b?g:b,Q=I>z?I>R?I:R:z>R?z:R,te=u.next;te!==e;){if(te.x>=N&&te.x<=W&&te.y>=$&&te.y<=Q&&dh(f,I,g,z,b,R,te.x,te.y)&&yn(te.prev,te,te.next)>=0)return!1;te=te.next}return!0}function Mm(r,e,n,u){var f=r.prev,g=r,b=r.next;if(yn(f,g,b)>=0)return!1;for(var I=f.x,z=g.x,R=b.x,N=f.y,$=g.y,W=b.y,Q=I<z?I<R?I:R:z<R?z:R,te=N<$?N<W?N:W:$<W?$:W,ce=I>z?I>R?I:R:z>R?z:R,we=N>$?N>W?N:W:$>W?$:W,Re=B1(Q,te,e,n,u),He=B1(ce,we,e,n,u),Be=r.prevZ,We=r.nextZ;Be&&Be.z>=Re&&We&&We.z<=He;){if(Be.x>=Q&&Be.x<=ce&&Be.y>=te&&Be.y<=we&&Be!==f&&Be!==b&&dh(I,N,z,$,R,W,Be.x,Be.y)&&yn(Be.prev,Be,Be.next)>=0||(Be=Be.prevZ,We.x>=Q&&We.x<=ce&&We.y>=te&&We.y<=we&&We!==f&&We!==b&&dh(I,N,z,$,R,W,We.x,We.y)&&yn(We.prev,We,We.next)>=0))return!1;We=We.nextZ}for(;Be&&Be.z>=Re;){if(Be.x>=Q&&Be.x<=ce&&Be.y>=te&&Be.y<=we&&Be!==f&&Be!==b&&dh(I,N,z,$,R,W,Be.x,Be.y)&&yn(Be.prev,Be,Be.next)>=0)return!1;Be=Be.prevZ}for(;We&&We.z<=He;){if(We.x>=Q&&We.x<=ce&&We.y>=te&&We.y<=we&&We!==f&&We!==b&&dh(I,N,z,$,R,W,We.x,We.y)&&yn(We.prev,We,We.next)>=0)return!1;We=We.nextZ}return!0}function Cm(r,e,n){var u=r;do{var f=u.prev,g=u.next.next;!ph(f,g)&&xf(f,u,u.next,g)&&F1(f,g)&&F1(g,f)&&(e.push(f.i/n|0),e.push(u.i/n|0),e.push(g.i/n|0),Nd(u),Nd(u.next),u=r=g),u=u.next}while(u!==r);return hh(u)}function Im(r,e,n,u,f,g){var b=r;do{for(var I=b.next.next;I!==b.prev;){if(b.i!==I.i&&zm(b,I)){var z=vf(b,I);return b=hh(b,b.next),z=hh(z,z.next),Wn(b,e,n,u,f,g,0),void Wn(z,e,n,u,f,g,0)}I=I.next}b=b.next}while(b!==r)}function Am(r,e){return r.x-e.x}function Pm(r,e){var n=function(f,g){var b,I=g,z=f.x,R=f.y,N=-1/0;do{if(R<=I.y&&R>=I.next.y&&I.next.y!==I.y){var $=I.x+(R-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if($<=z&&$>N&&(N=$,b=I.x<I.next.x?I:I.next,$===z))return b}I=I.next}while(I!==g);if(!b)return null;var W,Q=b,te=b.x,ce=b.y,we=1/0;I=b;do z>=I.x&&I.x>=te&&z!==I.x&&dh(R<ce?z:N,R,te,ce,R<ce?N:z,R,I.x,I.y)&&(W=Math.abs(R-I.y)/(z-I.x),F1(I,f)&&(W<we||W===we&&(I.x>b.x||I.x===b.x&&yf(b,I)))&&(b=I,we=W)),I=I.next;while(I!==Q);return b}(r,e);if(!n)return e;var u=vf(n,r);return hh(u,u.next),hh(n,n.next)}function yf(r,e){return yn(r.prev,r,e.prev)<0&&yn(e.next,r,r.next)<0}function B1(r,e,n,u,f){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-u)*f|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function km(r){var e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function dh(r,e,n,u,f,g,b,I){return(f-b)*(e-I)>=(r-b)*(g-I)&&(r-b)*(u-I)>=(n-b)*(e-I)&&(n-b)*(g-I)>=(f-b)*(u-I)}function zm(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(n,u){var f=n;do{if(f.i!==n.i&&f.next.i!==n.i&&f.i!==u.i&&f.next.i!==u.i&&xf(f,f.next,n,u))return!0;f=f.next}while(f!==n);return!1}(r,e)&&(F1(r,e)&&F1(e,r)&&function(n,u){var f=n,g=!1,b=(n.x+u.x)/2,I=(n.y+u.y)/2;do f.y>I!=f.next.y>I&&f.next.y!==f.y&&b<(f.next.x-f.x)*(I-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==n);return g}(r,e)&&(yn(r.prev,r,e.prev)||yn(r,e.prev,e))||ph(r,e)&&yn(r.prev,r,r.next)>0&&yn(e.prev,e,e.next)>0)}function yn(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function ph(r,e){return r.x===e.x&&r.y===e.y}function xf(r,e,n,u){var f=Ud(yn(r,e,n)),g=Ud(yn(r,e,u)),b=Ud(yn(n,u,r)),I=Ud(yn(n,u,e));return f!==g&&b!==I||!(f!==0||!Od(r,n,e))||!(g!==0||!Od(r,u,e))||!(b!==0||!Od(n,r,u))||!(I!==0||!Od(n,e,u))}function Od(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function Ud(r){return r>0?1:r<0?-1:0}function F1(r,e){return yn(r.prev,r,r.next)<0?yn(r,e,r.next)>=0&&yn(r,r.prev,e)>=0:yn(r,e,r.prev)<0||yn(r,r.next,e)<0}function vf(r,e){var n=new Vd(r.i,r.x,r.y),u=new Vd(e.i,e.x,e.y),f=r.next,g=e.prev;return r.next=e,e.prev=r,n.next=f,f.prev=n,u.next=n,n.prev=u,g.next=u,u.prev=g,u}function bf(r,e,n,u){var f=new Vd(r,e,n);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Nd(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Vd(r,e,n){this.i=r,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O1(r,e,n,u){for(var f=0,g=e,b=n-u;g<n;g+=u)f+=(r[b]-r[g])*(r[g+1]+r[b+1]),b=g;return f}gf.exports=Vp,gf.exports.default=Vp,Vp.deviation=function(r,e,n,u){var f=e&&e.length,g=Math.abs(O1(r,0,f?e[0]*n:r.length,n));if(f)for(var b=0,I=e.length;b<I;b++)g-=Math.abs(O1(r,e[b]*n,b<I-1?e[b+1]*n:r.length,n));var z=0;for(b=0;b<u.length;b+=3){var R=u[b]*n,N=u[b+1]*n,$=u[b+2]*n;z+=Math.abs((r[R]-r[$])*(r[N+1]-r[R+1])-(r[R]-r[N])*(r[$+1]-r[R+1]))}return g===0&&z===0?0:Math.abs((z-g)/g)},Vp.flatten=function(r){for(var e=r[0][0].length,n={vertices:[],holes:[],dimensions:e},u=0,f=0;f<r.length;f++){for(var g=0;g<r[f].length;g++)for(var b=0;b<e;b++)n.vertices.push(r[f][g][b]);f>0&&n.holes.push(u+=r[f-1].length)}return n};var Jh=je(gf.exports);function wf(r,e,n,u,f){Dm(r,e,n||0,u||r.length-1,f||s)}function Dm(r,e,n,u,f){for(;u>n;){if(u-n>600){var g=u-n+1,b=e-n+1,I=Math.log(g),z=.5*Math.exp(2*I/3),R=.5*Math.sqrt(I*z*(g-z)/g)*(b-g/2<0?-1:1);Dm(r,e,Math.max(n,Math.floor(e-b*z/g+R)),Math.min(u,Math.floor(e+(g-b)*z/g+R)),f)}var N=r[e],$=n,W=u;for(c(r,n,e),f(r[u],N)>0&&c(r,n,u);$<W;){for(c(r,$,W),$++,W--;f(r[$],N)<0;)$++;for(;f(r[W],N)>0;)W--}f(r[n],N)===0?c(r,n,W):c(r,++W,u),W<=e&&(n=W+1),e<=W&&(u=W-1)}}function c(r,e,n){var u=r[e];r[e]=r[n],r[n]=u}function s(r,e){return r<e?-1:r>e?1:0}function h(r,e){const n=r.length;if(n<=1)return[r];const u=[];let f,g;for(let b=0;b<n;b++){const I=ra(r[b]);I!==0&&(r[b].area=Math.abs(I),g===void 0&&(g=I<0),g===I<0?(f&&u.push(f),f=[r[b]]):f.push(r[b]))}if(f&&u.push(f),e>1)for(let b=0;b<u.length;b++)u[b].length<=e||(wf(u[b],e,1,u[b].length-1,v),u[b]=u[b].slice(0,e));return u}function v(r,e){return e.area-r.area}function M(r,e,n){const u=n.patternDependencies;let f=!1;for(const g of e){const b=g.paint.get(`${r}-pattern`);b.isConstant()||(f=!0);const I=b.constantOr(null);I&&(f=!0,u[I]=!0)}return f}function k(r,e,n,u,f){const g=f.patternDependencies;for(const b of e){const I=b.paint.get(`${r}-pattern`).value;if(I.kind!=="constant"){let z=I.evaluate({zoom:u},n,{},f.availableImages);z=z&&z.name?z.name:z,g[z]=!0,n.patterns[b.id]=z}}return n}class L{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new yi,this.indexArray=new er,this.indexArray2=new go,this.programConfigurations=new Vh(e.layers,e.zoom),this.segments=new co,this.segments2=new co,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,u,f){this.hasPattern=M("fill",this.layers,n);const g=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:I,id:z,index:R,sourceLayerIndex:N}of e){const $=this.layers[0]._featureFilter.needGeometry,W=Wh(I,$);if(!this.layers[0]._featureFilter.filter(new G(this.zoom),W,u))continue;const Q=g?g.evaluate(W,{},u,n.availableImages):void 0,te={id:z,properties:I.properties,type:I.type,sourceLayerIndex:N,index:R,geometry:$?W.geometry:jc(I,u,f),patterns:{},sortKey:Q};b.push(te)}g&&b.sort((I,z)=>I.sortKey-z.sortKey);for(const I of b){const{geometry:z,index:R,sourceLayerIndex:N}=I;if(this.hasPattern){const $=k("fill",this.layers,I,this.zoom,n);this.patternFeatures.push($)}else this.addFeature(I,z,R,u,{},n.availableImages);n.featureIndex.insert(e[R].feature,z,R,N,this.index)}}update(e,n,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,u,f)}addFeatures(e,n,u,f,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,n,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,q5),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,u,f,g,b=[]){for(const I of h(n,500)){let z=0;for(const te of I)z+=te.length;const R=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),N=R.vertexLength,$=[],W=[];for(const te of I){if(te.length===0)continue;te!==I[0]&&W.push($.length/2);const ce=this.segments2.prepareSegment(te.length,this.layoutVertexArray,this.indexArray2),we=ce.vertexLength;this.layoutVertexArray.emplaceBack(te[0].x,te[0].y),this.indexArray2.emplaceBack(we+te.length-1,we),$.push(te[0].x),$.push(te[0].y);for(let Re=1;Re<te.length;Re++)this.layoutVertexArray.emplaceBack(te[Re].x,te[Re].y),this.indexArray2.emplaceBack(we+Re-1,we+Re),$.push(te[Re].x),$.push(te[Re].y);ce.vertexLength+=te.length,ce.primitiveLength+=te.length}const Q=Jh($,W);for(let te=0;te<Q.length;te+=3)this.indexArray.emplaceBack(N+Q[te],N+Q[te+1],N+Q[te+2]);R.vertexLength+=z,R.primitiveLength+=Q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,g,b,f)}}Ft(L,"FillBucket",{omit:["layers","patternFeatures"]});const V=new Ge({"fill-sort-key":new Me(It.layout_fill["fill-sort-key"])});var Z={paint:new Ge({"fill-antialias":new ae(It.paint_fill["fill-antialias"]),"fill-opacity":new Me(It.paint_fill["fill-opacity"]),"fill-color":new Me(It.paint_fill["fill-color"]),"fill-outline-color":new Me(It.paint_fill["fill-outline-color"]),"fill-translate":new ae(It.paint_fill["fill-translate"]),"fill-translate-anchor":new ae(It.paint_fill["fill-translate-anchor"]),"fill-pattern":new Me(It.paint_fill["fill-pattern"])}),layout:V};const J=yt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),se=yt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),ue=yt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:xe}=J;var Te={},Se=dt,Qe=Xe;function Xe(r,e,n,u,f){this.properties={},this.extent=n,this.type=0,this._pbf=r,this._geometry=-1,this._keys=u,this._values=f,r.readFields(Et,this,e)}function Et(r,e,n){r==1?e.id=n.readVarint():r==2?function(u,f){for(var g=u.readVarint()+u.pos;u.pos<g;){var b=f._keys[u.readVarint()],I=f._values[u.readVarint()];f.properties[b]=I}}(n,e):r==3?e.type=n.readVarint():r==4&&(e._geometry=n.pos)}function Gt(r){for(var e,n,u=0,f=0,g=r.length,b=g-1;f<g;b=f++)u+=((n=r[b]).x-(e=r[f]).x)*(e.y+n.y);return u}Xe.types=["Unknown","Point","LineString","Polygon"],Xe.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,n=r.readVarint()+r.pos,u=1,f=0,g=0,b=0,I=[];r.pos<n;){if(f<=0){var z=r.readVarint();u=7&z,f=z>>3}if(f--,u===1||u===2)g+=r.readSVarint(),b+=r.readSVarint(),u===1&&(e&&I.push(e),e=[]),e.push(new Se(g,b));else{if(u!==7)throw new Error("unknown command "+u);e&&e.push(e[0].clone())}}return e&&I.push(e),I},Xe.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,n=1,u=0,f=0,g=0,b=1/0,I=-1/0,z=1/0,R=-1/0;r.pos<e;){if(u<=0){var N=r.readVarint();n=7&N,u=N>>3}if(u--,n===1||n===2)(f+=r.readSVarint())<b&&(b=f),f>I&&(I=f),(g+=r.readSVarint())<z&&(z=g),g>R&&(R=g);else if(n!==7)throw new Error("unknown command "+n)}return[b,z,I,R]},Xe.prototype.toGeoJSON=function(r,e,n){var u,f,g=this.extent*Math.pow(2,n),b=this.extent*r,I=this.extent*e,z=this.loadGeometry(),R=Xe.types[this.type];function N(Q){for(var te=0;te<Q.length;te++){var ce=Q[te];Q[te]=[360*(ce.x+b)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(ce.y+I)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(u=0;u<z.length;u++)$[u]=z[u][0];N(z=$);break;case 2:for(u=0;u<z.length;u++)N(z[u]);break;case 3:for(z=function(Q){var te=Q.length;if(te<=1)return[Q];for(var ce,we,Re=[],He=0;He<te;He++){var Be=Gt(Q[He]);Be!==0&&(we===void 0&&(we=Be<0),we===Be<0?(ce&&Re.push(ce),ce=[Q[He]]):ce.push(Q[He]))}return ce&&Re.push(ce),Re}(z),u=0;u<z.length;u++)for(f=0;f<z[u].length;f++)N(z[u][f])}z.length===1?z=z[0]:R="Multi"+R;var W={type:"Feature",geometry:{type:R,coordinates:z},properties:this.properties};return"id"in this&&(W.id=this.id),W};var wt=Qe,Ut=ai;function ai(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(li,this,e),this.length=this._features.length}function li(r,e,n){r===15?e.version=n.readVarint():r===1?e.name=n.readString():r===5?e.extent=n.readVarint():r===2?e._features.push(n.pos):r===3?e._keys.push(n.readString()):r===4&&e._values.push(function(u){for(var f=null,g=u.readVarint()+u.pos;u.pos<g;){var b=u.readVarint()>>3;f=b===1?u.readString():b===2?u.readFloat():b===3?u.readDouble():b===4?u.readVarint64():b===5?u.readVarint():b===6?u.readSVarint():b===7?u.readBoolean():null}return f}(n))}ai.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new wt(this._pbf,e,this.extent,this._keys,this._values)};var Hi=Ut;function tr(r,e,n){if(r===3){var u=new Hi(n,n.readVarint()+n.pos);u.length&&(e[u.name]=u)}}var Vi=Te.VectorTile=function(r,e){this.layers=r.readFields(tr,{},e)},Li=Te.VectorTileFeature=Qe;function zi(r,e,n,u){const f=[],g=u===0?(b,I,z,R,N,$)=>{b.push(new zt($,z+($-I)/(R-I)*(N-z)))}:(b,I,z,R,N,$)=>{b.push(new zt(I+($-z)/(N-z)*(R-I),$))};for(const b of r){const I=[];for(const z of b){if(z.length<=2)continue;const R=[];for(let W=0;W<z.length-1;W++){const Q=z[W].x,te=z[W].y,ce=z[W+1].x,we=z[W+1].y,Re=u===0?Q:te,He=u===0?ce:we;Re<e?He>e&&g(R,Q,te,ce,we,e):Re>n?He<n&&g(R,Q,te,ce,we,n):R.push(z[W]),He<e&&Re>=e&&g(R,Q,te,ce,we,e),He>n&&Re<=n&&g(R,Q,te,ce,we,n)}let N=z[z.length-1];const $=u===0?N.x:N.y;$>=e&&$<=n&&R.push(N),R.length&&(N=R[R.length-1],R[0].x===N.x&&R[0].y===N.y||R.push(R[0]),I.push(R))}I.length&&f.push(I)}return f}Te.VectorTileLayer=Ut;const $i=Li.types,Ni=Math.pow(2,13);function bi(r,e,n,u,f,g,b,I){r.emplaceBack((e<<1)+b,(n<<1)+g,(Math.floor(u*Ni)<<1)+f,Math.round(I))}function ar(r,e,n){r.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class nr{constructor(){this.acc=new zt(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new zt(e.x,e.y),this.max=new zt(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);const u=this.min,f=this.max;e.x<u.x?u.x=e.x:e.x>f.x&&(f.x=e.x),e.y<u.y?u.y=e.y:e.y>f.y&&(f.y=e.y),((e.x===0||e.x===sr)&&e.x===n.x)!=((e.y===0||e.y===sr)&&e.y===n.y)&&this.processBorderOverlap(e,n),n.x<0!=e.x<0&&this.addBorderIntersection(0,Kr(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>sr!=e.x>sr&&this.addBorderIntersection(1,Kr(n.y,e.y,(sr-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,Kr(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>sr!=e.y>sr&&this.addBorderIntersection(3,Kr(n.x,e.x,(sr-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[e];n<u[0]&&(u[0]=n),n>u[1]&&(u[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const u=e.x===0?0:1;this.addBorderIntersection(u,n.y),this.addBorderIntersection(u,e.y)}else{const u=e.y===0?2:3;this.addBorderIntersection(u,n.x),this.addBorderIntersection(u,e.x)}}centroid(){const e=this.polyCount.reduce((n,u)=>n+u.edges,0);return e!==0?this.acc.div(e)._round():new zt(0,0)}span(){return new zt(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class zr{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Zt,this.centroidVertexArray=new Ml,this.indexArray=new er,this.programConfigurations=new Vh(e.layers,e.zoom),this.segments=new co,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,u,f){this.features=[],this.hasPattern=M("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){const b=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*b/(b*b+1)/sr/(1<<g.z)}(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:g,id:b,index:I,sourceLayerIndex:z}of e){const R=this.layers[0]._featureFilter.needGeometry,N=Wh(g,R);if(!this.layers[0]._featureFilter.filter(new G(this.zoom),N,u))continue;const $={id:b,sourceLayerIndex:z,index:I,geometry:R?N.geometry:jc(g,u,f),properties:g.properties,type:g.type,patterns:{}},W=this.layoutVertexArray.length;this.hasPattern?this.features.push(k("fill-extrusion",this.layers,$,this.zoom,n)):this.addFeature($,$.geometry,I,u,{},n.availableImages,f),n.featureIndex.insert(g,$.geometry,I,z,this.index,W)}this.sortBorders()}addFeatures(e,n,u,f,g){for(const b of this.features){const{geometry:I}=b;this.addFeature(b,I,b.index,n,u,f,g)}this.sortBorders()}update(e,n,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xe),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,ue.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,se.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,u,f,g,b,I){const z=[new zt(0,0),new zt(sr,sr)],R=I.projection,N=R.name==="globe",$=this.enableTerrain&&!N?new nr:null,W=$i[e.type]==="Polygon";N&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new _i);const Q=h(n,500);for(let Re=Q.length-1;Re>=0;Re--){const He=Q[Re];(He.length===0||(te=He[0]).every(Be=>Be.x<=0)||te.every(Be=>Be.x>=sr)||te.every(Be=>Be.y<=0)||te.every(Be=>Be.y>=sr))&&Q.splice(Re,1)}var te;let ce;if(N)ce=ds(Q,z,f);else{ce=[];for(const Re of Q)ce.push({polygon:Re,bounds:z})}const we=W?this.edgeRadius:0;for(const{polygon:Re,bounds:He}of ce){let Be=0,We=0;for(const et of Re)W&&!et[0].equals(et[et.length-1])&&et.push(et[0]),We+=W?et.length-1:et.length;const it=this.segments.prepareSegment((W?5:4)*We,this.layoutVertexArray,this.indexArray);if(W){const et=[],Ot=[];Be=it.vertexLength;for(const ti of Re){let vi,Vt;ti.length&&ti!==Re[0]&&Ot.push(et.length/2),vi=ti[1].sub(ti[0])._perp()._unit();for(let ni=1;ni<ti.length;ni++){const oi=ti[ni],fi=ti[ni===ti.length-1?1:ni+1];let{x:Ti,y:Jt}=oi;if(we){Vt=fi.sub(oi)._perp()._unit();const Bi=vi.add(Vt)._unit(),Ki=we*Math.min(4,1/(vi.x*Bi.x+vi.y*Bi.y));Ti+=Ki*Bi.x,Jt+=Ki*Bi.y,vi=Vt}bi(this.layoutVertexArray,Ti,Jt,0,0,1,1,0),it.vertexLength++,et.push(oi.x,oi.y),N&&ar(this.layoutVertexExtArray,R.projectTilePoint(Ti,Jt,f),R.upVector(f,Ti,Jt))}}const Lt=Jh(et,Ot);for(let ti=0;ti<Lt.length;ti+=3)this.indexArray.emplaceBack(Be+Lt[ti],Be+Lt[ti+2],Be+Lt[ti+1]),it.primitiveLength++}for(const et of Re){$&&et.length&&$.startRing(et[0]);let Ot,Lt,ti,vi=et.length>4&&hs(et[et.length-2],et[0],et[1]),Vt=we?Yn(et[et.length-2],et[0],et[1],we):0;Lt=et[1].sub(et[0])._perp()._unit();let ni=!0;for(let oi=1,fi=0;oi<et.length;oi++){let Ti=et[oi-1],Jt=et[oi];const Bi=et[oi===et.length-1?1:oi+1];if($&&W&&$.currentPolyCount.top++,Pa(Jt,Ti,He)){we&&(Lt=Bi.sub(Jt)._perp()._unit(),ni=!ni);continue}$&&$.append(Jt,Ti);const Ki=Jt.sub(Ti)._perp(),Oi=Ki.x/(Math.abs(Ki.x)+Math.abs(Ki.y)),Dr=Ki.y>0?1:0,Ei=Ti.dist(Jt);if(fi+Ei>32768&&(fi=0),we){ti=Bi.sub(Jt)._perp()._unit();let Rr=So(Ti,Jt,Bi,jn(Lt,ti),we);isNaN(Rr)&&(Rr=0);const gr=Jt.sub(Ti)._unit();Ti=Ti.add(gr.mult(Vt))._round(),Jt=Jt.add(gr.mult(-Rr))._round(),Vt=Rr,Lt=ti}const ur=it.vertexLength,Lr=et.length>4&&hs(Ti,Jt,Bi);let mn=xo(fi,vi,ni);if(bi(this.layoutVertexArray,Ti.x,Ti.y,Oi,Dr,0,0,mn),bi(this.layoutVertexArray,Ti.x,Ti.y,Oi,Dr,0,1,mn),fi+=Ei,mn=xo(fi,Lr,!ni),vi=Lr,bi(this.layoutVertexArray,Jt.x,Jt.y,Oi,Dr,0,0,mn),bi(this.layoutVertexArray,Jt.x,Jt.y,Oi,Dr,0,1,mn),it.vertexLength+=4,this.indexArray.emplaceBack(ur+0,ur+1,ur+2),this.indexArray.emplaceBack(ur+1,ur+3,ur+2),it.primitiveLength+=2,we){const Rr=Be+(oi===1?et.length-2:oi-2),gr=oi===1?Be:Rr+1;if(this.indexArray.emplaceBack(ur+1,Rr,ur+3),this.indexArray.emplaceBack(Rr,gr,ur+3),it.primitiveLength+=2,Ot===void 0&&(Ot=ur),!Pa(Bi,et[oi],He)){const Xn=oi===et.length-1?Ot:it.vertexLength;this.indexArray.emplaceBack(ur+2,ur+3,Xn),this.indexArray.emplaceBack(ur+3,Xn+1,Xn),this.indexArray.emplaceBack(ur+3,gr,Xn+1),it.primitiveLength+=3}ni=!ni}if(N){const Rr=this.layoutVertexExtArray,gr=R.projectTilePoint(Ti.x,Ti.y,f),Xn=R.projectTilePoint(Jt.x,Jt.y,f),Or=R.upVector(f,Ti.x,Ti.y),Ur=R.upVector(f,Jt.x,Jt.y);ar(Rr,gr,Or),ar(Rr,gr,Or),ar(Rr,Xn,Ur),ar(Rr,Xn,Ur)}}W&&(Be+=et.length-1)}}if($&&$.polyCount.length>0){if($.borders){$.vertexArrayOffset=this.centroidVertexArray.length;const Re=$.borders,He=this.featuresOnBorder.push($)-1;for(let Be=0;Be<4;Be++)Re[Be][0]!==Number.MAX_VALUE&&this.borders[Be].push(He)}this.encodeCentroid($.borders?void 0:$.centroid(),$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,g,b,f)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,u)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[u].borders[e][0])}encodeCentroid(e,n,u=!0){let f,g;if(e)if(e.y!==0){const I=n.span()._mult(this.tileToMeter);f=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(I.x/10)),g=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(I.y/10))}else f=Math.ceil(7*(e.x+450)),g=0;else f=0,g=+u;let b=u?this.centroidVertexArray.length:n.vertexArrayOffset;for(const I of n.polyCount){u&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*I.edges+I.top);for(let z=0;z<I.top;z++)this.centroidVertexArray.emplace(b++,f,g);for(let z=0;z<2*I.edges;z++)this.centroidVertexArray.emplace(b++,0,g),this.centroidVertexArray.emplace(b++,f,g)}}}function jn(r,e){const n=r.add(e)._unit();return r.x*n.x+r.y*n.y}function Yn(r,e,n,u){const f=e.sub(r)._perp()._unit(),g=n.sub(e)._perp()._unit();return So(r,e,n,jn(f,g),u)}function So(r,e,n,u,f){const g=Math.sqrt(1-u*u);return Math.min(r.dist(e)/3,e.dist(n)/3,f*g/u)}function Pa(r,e,n){return r.x<n[0].x&&e.x<n[0].x||r.x>n[1].x&&e.x>n[1].x||r.y<n[0].y&&e.y<n[0].y||r.y>n[1].y&&e.y>n[1].y}function hs(r,e,n){if(r.x<0||r.x>=sr||e.x<0||e.x>=sr||n.x<0||n.x>=sr)return!1;const u=n.sub(e),f=u.perp(),g=r.sub(e);return(u.x*g.x+u.y*g.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(g.x*g.x+g.y*g.y))>-.866&&f.x*g.x+f.y*g.y<0}function xo(r,e,n){const u=e?2|r:-3&r;return n?1|u:-2&u}function Ro(){const r=Math.PI/32,e=Math.tan(r),n=wu;return n*Math.sqrt(1+2*e*e)-n}function ds(r,e,n){const u=1<<n.z,f=Aa(n.x/u),g=Aa((n.x+1)/u),b=us(n.y/u),I=us((n.y+1)/u);return function(z,R,N,$,W=0,Q){const te=[];if(!z.length||!N||!$)return te;const ce=(et,Ot)=>{for(const Lt of et)te.push({polygon:Lt,bounds:Ot})},we=Math.ceil(Math.log2(N)),Re=Math.ceil(Math.log2($)),He=we-Re,Be=[];for(let et=0;et<Math.abs(He);et++)Be.push(He>0?0:1);for(let et=0;et<Math.min(we,Re);et++)Be.push(0),Be.push(1);let We=z;if(We=zi(We,R[0].y-W,R[1].y+W,1),We=zi(We,R[0].x-W,R[1].x+W,0),!We.length)return te;const it=[];for(Be.length?it.push({polygons:We,bounds:R,depth:0}):ce(We,R);it.length;){const et=it.pop(),Ot=et.depth,Lt=Be[Ot],ti=et.bounds[0],vi=et.bounds[1],Vt=Lt===0?ti.x:ti.y,ni=Lt===0?vi.x:vi.y,oi=Q?Q(Lt,Vt,ni):.5*(Vt+ni),fi=zi(et.polygons,Vt-W,oi+W,Lt),Ti=zi(et.polygons,oi-W,ni+W,Lt);if(fi.length){const Jt=[ti,new zt(Lt===0?oi:vi.x,Lt===1?oi:vi.y)];Be.length>Ot+1?it.push({polygons:fi,bounds:Jt,depth:Ot+1}):ce(fi,Jt)}if(Ti.length){const Jt=[new zt(Lt===0?oi:ti.x,Lt===1?oi:ti.y),vi];Be.length>Ot+1?it.push({polygons:Ti,bounds:Jt,depth:Ot+1}):ce(Ti,Jt)}}return te}(r,e,Math.ceil((g-f)/11.25),Math.ceil((b-I)/11.25),1,(z,R,N)=>{if(z===0)return .5*(R+N);{const $=us((n.y+R/sr)/u);return(cc(.5*(us((n.y+N/sr)/u)+$))*u-n.y)*sr}})}Ft(zr,"FillExtrusionBucket",{omit:["layers","features"]}),Ft(nr,"PartMetadata");const Us=new Ge({"fill-extrusion-edge-radius":new ae(It["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var fa={paint:new Ge({"fill-extrusion-opacity":new ae(It["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Me(It["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ae(It["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ae(It["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Me(It["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Me(It["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Me(It["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ae(It["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ae(It["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ae(It["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ae(It["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Us};function vo(r,e,n){var u=2*Math.PI*6378137/256/Math.pow(2,n);return[r*u-2*Math.PI*6378137/2,e*u-2*Math.PI*6378137/2]}class Bo{constructor(e,n,u){this.z=e,this.x=n,this.y=u,this.key=ps(0,e,e,n,u)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const u=function(g,b,I){var z=vo(256*g,256*(b=Math.pow(2,I)-b-1),I),R=vo(256*(g+1),256*(b+1),I);return z[0]+","+z[1]+","+R[0]+","+R[1]}(this.x,this.y,this.z),f=function(g,b,I){let z,R="";for(let N=g;N>0;N--)z=1<<N-1,R+=(b&z?1:0)+(I&z?2:0);return R}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ps{constructor(e,n){this.wrap=e,this.canonical=n,this.key=ps(e,n.z,n.z,n.x,n.y)}}class Ln{constructor(e,n,u,f,g){this.overscaledZ=e,this.wrap=n,this.canonical=new Bo(u,+f,+g),this.key=n===0&&e===u?this.canonical.key:ps(n,e,u,f,g)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new Ln(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ln(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return ps(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-e;return ps(this.wrap*+n,e,e,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Ln(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,u=2*this.canonical.x,f=2*this.canonical.y;return[new Ln(n,this.wrap,n,u,f),new Ln(n,this.wrap,n,u+1,f),new Ln(n,this.wrap,n,u,f+1),new Ln(n,this.wrap,n,u+1,f+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ln(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ln(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ps(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function ps(r,e,n,u,f){const g=1<<Math.min(n,22);let b=g*(f%g)+u%g;return r&&n<22&&(b+=g*g*((r<0?-2*r-1:2*r)%(1<<2*(22-n)))),16*(32*b+n)+(e-n)}Ft(Bo,"CanonicalTileID"),Ft(Ln,"OverscaledTileID",{omit:["projMatrix"]});class ts extends zt{constructor(e,n,u){super(e,n),this.z=u}}function Fn(r,e){return r.x*e.x+r.y*e.y}function Fo(r,e){if(r.length===1){let n=0;const u=e[n++];let f;for(;!f||u.equals(f);)if(f=e[n++],!f)return 1/0;for(;n<e.length;n++){const g=e[n],b=r[0],I=f.sub(u),z=g.sub(u),R=b.sub(u),N=Fn(I,I),$=Fn(I,z),W=Fn(z,z),Q=Fn(R,I),te=Fn(R,z),ce=N*W-$*$,we=(W*Q-$*te)/ce,Re=(N*te-$*Q)/ce,He=u.z*(1-we-Re)+f.z*we+g.z*Re;if(isFinite(He))return He}return 1/0}{let n=1/0;for(const u of e)n=Math.min(n,u.z);return n}}function Xr(r,e,n,u,f,g,b,I){const z=b*f.getElevationAt(r,e,!0,!0),R=g[0]!==0,N=R?g[1]===0?b*(g[0]/7-450):b*function($,W,Q){const te=Math.floor(W[0]/8),ce=Math.floor(W[1]/8),we=10*(W[0]-8*te),Re=10*(W[1]-8*ce),He=$.getElevationAt(te,ce,!0,!0),Be=$.getMeterToDEM(Q),We=Math.floor(.5*(we*Be-1)),it=Math.floor(.5*(Re*Be-1)),et=$.tileCoordToPixel(te,ce),Ot=2*We+1,Lt=2*it+1,ti=function(Ti,Jt,Bi,Ki,Oi){return[Ti.getElevationAtPixel(Jt,Bi,!0),Ti.getElevationAtPixel(Jt+Oi,Bi,!0),Ti.getElevationAtPixel(Jt,Bi+Oi,!0),Ti.getElevationAtPixel(Jt+Ki,Bi+Oi,!0)]}($,et.x-We,et.y-it,Ot,Lt),vi=Math.abs(ti[0]-ti[1]),Vt=Math.abs(ti[2]-ti[3]),ni=Math.abs(ti[0]-ti[2])+Math.abs(ti[1]-ti[3]),oi=Math.min(.25,.5*Be*(vi+Vt)/Ot),fi=Math.min(.25,.5*Be*ni/Lt);return He+Math.max(oi*we,fi*Re)}(f,g,I):z;return{base:z+(n===0)?-1:n,top:R?Math.max(N+u,z+n+2):z+u}}const ka=yt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:ks}=ka,Ns=yt([{name:"a_packed",components:4,type:"Float32"}]),{members:Al}=Ns,hc=Li.types,dc=Math.cos(Math.PI/180*37.5);class Pl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Nt,this.layoutVertexArray2=new mi,this.indexArray=new er,this.programConfigurations=new Vh(e.layers,e.zoom),this.segments=new co,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,u,f){this.hasPattern=M("line",this.layers,n);const g=this.layers[0].layout.get("line-sort-key"),b=[];for(const{feature:N,id:$,index:W,sourceLayerIndex:Q}of e){const te=this.layers[0]._featureFilter.needGeometry,ce=Wh(N,te);if(!this.layers[0]._featureFilter.filter(new G(this.zoom),ce,u))continue;const we=g?g.evaluate(ce,{},u):void 0,Re={id:$,properties:N.properties,type:N.type,sourceLayerIndex:Q,index:W,geometry:te?ce.geometry:jc(N,u,f),patterns:{},sortKey:we};b.push(Re)}g&&b.sort((N,$)=>N.sortKey-$.sortKey);const{lineAtlas:I,featureIndex:z}=n,R=this.addConstantDashes(I);for(const N of b){const{geometry:$,index:W,sourceLayerIndex:Q}=N;if(R&&this.addFeatureDashes(N,I),this.hasPattern){const te=k("line",this.layers,N,this.zoom,n);this.patternFeatures.push(te)}else this.addFeature(N,$,W,u,I.positions,n.availableImages);z.insert(e[W].feature,$,W,Q,this.index)}}addConstantDashes(e){let n=!1;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if(f.kind!=="constant"||g.kind!=="constant")n=!0;else{const b=g.value,I=f.value;if(!I)continue;e.addDash(I,b)}}return n}addFeatureDashes(e,n){const u=this.zoom;for(const f of this.layers){const g=f.paint.get("line-dasharray").value,b=f.layout.get("line-cap").value;if(g.kind==="constant"&&b.kind==="constant")continue;let I,z;if(g.kind==="constant"){if(I=g.value,!I)continue}else I=g.evaluate({zoom:u},e);z=b.kind==="constant"?b.value:b.evaluate({zoom:u},e),n.addDash(I,z),e.patterns[f.id]=n.getKey(I,z)}}update(e,n,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,u,f)}addFeatures(e,n,u,f,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,n,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Al)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ks),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,u,f,g,b){const I=this.layers[0].layout,z=I.get("line-join").evaluate(e,{}),R=I.get("line-cap").evaluate(e,{}),N=I.get("line-miter-limit"),$=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const W of n)this.addLine(W,e,z,R,N,$);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,g,b,f)}addLine(e,n,u,f,g,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Re=0;Re<e.length-1;Re++)this.totalDistance+=e[Re].dist(e[Re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=hc[n.type]==="Polygon";let z=e.length;for(;z>=2&&e[z-1].equals(e[z-2]);)z--;let R=0;for(;R<z-1&&e[R].equals(e[R+1]);)R++;if(z<(I?3:2))return;u==="bevel"&&(g=1.05);const N=this.overscaling<=16?15*sr/(512*this.overscaling):0,$=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray);let W,Q,te,ce,we;this.e1=this.e2=-1,I&&(W=e[z-2],we=e[R].sub(W)._unit()._perp());for(let Re=R;Re<z;Re++){if(te=Re===z-1?I?e[R+1]:void 0:e[Re+1],te&&e[Re].equals(te))continue;we&&(ce=we),W&&(Q=W),W=e[Re],we=te?te.sub(W)._unit()._perp():ce,ce=ce||we;let He=ce.add(we);He.x===0&&He.y===0||He._unit();const Be=ce.x*we.x+ce.y*we.y,We=He.x*we.x+He.y*we.y,it=We!==0?1/We:1/0,et=2*Math.sqrt(2-2*We),Ot=We<dc&&Q&&te,Lt=ce.x*we.y-ce.y*we.x>0;if(Ot&&Re>R){const Vt=W.dist(Q);if(Vt>2*N){const ni=W.sub(W.sub(Q)._mult(N/Vt)._round());this.updateDistance(Q,ni),this.addCurrentVertex(ni,ce,0,0,$),Q=ni}}const ti=Q&&te;let vi=ti?u:I?"butt":f;if(ti&&vi==="round"&&(it<b?vi="miter":it<=2&&(vi="fakeround")),vi==="miter"&&it>g&&(vi="bevel"),vi==="bevel"&&(it>2&&(vi="flipbevel"),it<g&&(vi="miter")),Q&&this.updateDistance(Q,W),vi==="miter")He._mult(it),this.addCurrentVertex(W,He,0,0,$);else if(vi==="flipbevel"){if(it>100)He=we.mult(-1);else{const Vt=it*ce.add(we).mag()/ce.sub(we).mag();He._perp()._mult(Vt*(Lt?-1:1))}this.addCurrentVertex(W,He,0,0,$),this.addCurrentVertex(W,He.mult(-1),0,0,$)}else if(vi==="bevel"||vi==="fakeround"){const Vt=-Math.sqrt(it*it-1),ni=Lt?Vt:0,oi=Lt?0:Vt;if(Q&&this.addCurrentVertex(W,ce,ni,oi,$),vi==="fakeround"){const fi=Math.round(180*et/Math.PI/20);for(let Ti=1;Ti<fi;Ti++){let Jt=Ti/fi;if(Jt!==.5){const Ki=Jt-.5;Jt+=Jt*Ki*(Jt-1)*((1.0904+Be*(Be*(3.55645-1.43519*Be)-3.2452))*Ki*Ki+(.848013+Be*(.215638*Be-1.06021)))}const Bi=we.sub(ce)._mult(Jt)._add(ce)._unit()._mult(Lt?-1:1);this.addHalfVertex(W,Bi.x,Bi.y,!1,Lt,0,$)}}te&&this.addCurrentVertex(W,we,-ni,-oi,$)}else if(vi==="butt")this.addCurrentVertex(W,He,0,0,$);else if(vi==="square"){const Vt=Q?1:-1;Q||this.addCurrentVertex(W,He,Vt,Vt,$),this.addCurrentVertex(W,He,0,0,$),Q&&this.addCurrentVertex(W,He,Vt,Vt,$)}else vi==="round"&&(Q&&(this.addCurrentVertex(W,ce,0,0,$),this.addCurrentVertex(W,ce,1,1,$,!0)),te&&(this.addCurrentVertex(W,we,-1,-1,$,!0),this.addCurrentVertex(W,we,0,0,$)));if(Ot&&Re<z-1){const Vt=W.dist(te);if(Vt>2*N){const ni=W.add(te.sub(W)._mult(N/Vt)._round());this.updateDistance(W,ni),this.addCurrentVertex(ni,we,0,0,$),W=ni}}}}addCurrentVertex(e,n,u,f,g,b=!1){const I=n.y*f-n.x,z=-n.y-n.x*f;this.addHalfVertex(e,n.x+n.y*u,n.y-n.x*u,b,!1,u,g),this.addHalfVertex(e,I,z,b,!0,-f,g)}addHalfVertex({x:e,y:n},u,f,g,b,I,z){this.layoutVertexArray.emplaceBack((e<<1)+(g?1:0),(n<<1)+(b?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(I===0?0:I<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const R=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),z.primitiveLength++),b?this.e2=R:this.e1=R}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}Ft(Pl,"LineBucket",{omit:["layers","patternFeatures"]});const kl=new Ge({"line-cap":new Me(It.layout_line["line-cap"]),"line-join":new Me(It.layout_line["line-join"]),"line-miter-limit":new ae(It.layout_line["line-miter-limit"]),"line-round-limit":new ae(It.layout_line["line-round-limit"]),"line-sort-key":new Me(It.layout_line["line-sort-key"])});var za={paint:new Ge({"line-opacity":new Me(It.paint_line["line-opacity"]),"line-color":new Me(It.paint_line["line-color"]),"line-translate":new ae(It.paint_line["line-translate"]),"line-translate-anchor":new ae(It.paint_line["line-translate-anchor"]),"line-width":new Me(It.paint_line["line-width"]),"line-gap-width":new Me(It.paint_line["line-gap-width"]),"line-offset":new Me(It.paint_line["line-offset"]),"line-blur":new Me(It.paint_line["line-blur"]),"line-dasharray":new Me(It.paint_line["line-dasharray"]),"line-pattern":new Me(It.paint_line["line-pattern"]),"line-gradient":new Ue(It.paint_line["line-gradient"]),"line-trim-offset":new ae(It.paint_line["line-trim-offset"])}),layout:kl};const ea=new class extends Me{possiblyEvaluate(r,e){return e=new G(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,n,u){return e=mr({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,n,u)}}(za.paint.properties["line-width"].specification);function Gc(r,e){return e>0?e+2*r:r}ea.useIntegerZoom=!0;const jd=yt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Lm=yt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Tf=yt([{name:"a_projected_pos",components:4,type:"Float32"}],4);yt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ef=yt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Su=yt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);yt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Sf=yt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Mf=yt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);yt([{name:"triangle",components:3,type:"Uint16"}]),yt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),yt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),yt([{type:"Float32",name:"offsetX"}]),yt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Oo=24;const zl=128;function Cf(r,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new G(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:f}=n;let g=0;for(;g<u.length&&u[g]<=r;)g++;g=Math.max(0,g-1);let b=g;for(;b<u.length&&u[b]<r+1;)b++;b=Math.min(u.length-1,b);const I=u[g],z=u[b];return n.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:z,interpolationType:f}:{kind:"camera",minZoom:I,maxZoom:z,minSize:n.evaluate(new G(I)),maxSize:n.evaluate(new G(z)),interpolationType:f}}}function jp(r,{uSize:e,uSizeT:n},{lowerSize:u,upperSize:f}){return r.kind==="source"?u/zl:r.kind==="composite"?Kr(u/zl,f/zl,n):e}function U1(r,e){let n=0,u=0;if(r.kind==="constant")u=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:f,minZoom:g,maxZoom:b}=r,I=f?pt(Bs.interpolationFactor(f,e,g,b),0,1):0;r.kind==="camera"?u=Kr(r.minSize,r.maxSize,I):n=I}return{uSizeT:n,uSize:u}}var W5=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:zl,evaluateSizeForFeature:jp,evaluateSizeForZoom:U1,getSizeData:Cf});function X5(r,e,n){return r.sections.forEach(u=>{u.text=function(f,g,b){const I=g.layout.get("text-transform").evaluate(b,{});return I==="uppercase"?f=f.toLocaleUpperCase():I==="lowercase"&&(f=f.toLocaleLowerCase()),O.applyArabicShaping&&(f=O.applyArabicShaping(f)),f}(u.text,e,n)}),r}const Gd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function H5(r){return r==="︶"||r==="﹈"||r==="︸"||r==="﹄"||r==="﹂"||r==="︾"||r==="︼"||r==="︺"||r==="︘"||r==="﹀"||r==="︐"||r==="︓"||r==="︔"||r==="｀"||r==="￣"||r==="︑"||r==="︒"}function K5(r){return r==="︵"||r==="﹇"||r==="︷"||r==="﹃"||r==="﹁"||r==="︽"||r==="︻"||r==="︹"||r==="︗"||r==="︿"}var Dl=qr,$d=function(r,e,n,u,f){var g,b,I=8*f-u-1,z=(1<<I)-1,R=z>>1,N=-7,$=n?f-1:0,W=n?-1:1,Q=r[e+$];for($+=W,g=Q&(1<<-N)-1,Q>>=-N,N+=I;N>0;g=256*g+r[e+$],$+=W,N-=8);for(b=g&(1<<-N)-1,g>>=-N,N+=u;N>0;b=256*b+r[e+$],$+=W,N-=8);if(g===0)g=1-R;else{if(g===z)return b?NaN:1/0*(Q?-1:1);b+=Math.pow(2,u),g-=R}return(Q?-1:1)*b*Math.pow(2,g-u)},If=function(r,e,n,u,f,g){var b,I,z,R=8*g-f-1,N=(1<<R)-1,$=N>>1,W=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,Q=u?0:g-1,te=u?1:-1,ce=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(I=isNaN(e)?1:0,b=N):(b=Math.floor(Math.log(e)/Math.LN2),e*(z=Math.pow(2,-b))<1&&(b--,z*=2),(e+=b+$>=1?W/z:W*Math.pow(2,1-$))*z>=2&&(b++,z/=2),b+$>=N?(I=0,b=N):b+$>=1?(I=(e*z-1)*Math.pow(2,f),b+=$):(I=e*Math.pow(2,$-1)*Math.pow(2,f),b=0));f>=8;r[n+Q]=255&I,Q+=te,I/=256,f-=8);for(b=b<<f|I,R+=f;R>0;r[n+Q]=255&b,Q+=te,b/=256,R-=8);r[n+Q-te]|=128*ce};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function qr(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}qr.Varint=0,qr.Fixed64=1,qr.Bytes=2,qr.Fixed32=5;var Ll=4294967296,N1=1/Ll,V1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $c(r){return r.type===qr.Bytes?r.readVarint()+r.pos:r.pos+1}function Rl(r,e,n){return n?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function dg(r,e,n){var u=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(u);for(var f=n.pos-1;f>=r;f--)n.buf[f+u]=n.buf[f]}function Mv(r,e){for(var n=0;n<r.length;n++)e.writeVarint(r[n])}function Cv(r,e){for(var n=0;n<r.length;n++)e.writeSVarint(r[n])}function Iv(r,e){for(var n=0;n<r.length;n++)e.writeFloat(r[n])}function Av(r,e){for(var n=0;n<r.length;n++)e.writeDouble(r[n])}function Pv(r,e){for(var n=0;n<r.length;n++)e.writeBoolean(r[n])}function kv(r,e){for(var n=0;n<r.length;n++)e.writeFixed32(r[n])}function zv(r,e){for(var n=0;n<r.length;n++)e.writeSFixed32(r[n])}function Dv(r,e){for(var n=0;n<r.length;n++)e.writeFixed64(r[n])}function Lv(r,e){for(var n=0;n<r.length;n++)e.writeSFixed64(r[n])}function Rm(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function Gp(r,e,n){r[n]=e,r[n+1]=e>>>8,r[n+2]=e>>>16,r[n+3]=e>>>24}function pg(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}qr.prototype={destroy:function(){this.buf=null},readFields:function(r,e,n){for(n=n||this.length;this.pos<n;){var u=this.readVarint(),f=u>>3,g=this.pos;this.type=7&u,r(f,e,this),this.pos===g&&this.skip(u)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=Rm(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=pg(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Rm(this.buf,this.pos)+Rm(this.buf,this.pos+4)*Ll;return this.pos+=8,r},readSFixed64:function(){var r=Rm(this.buf,this.pos)+pg(this.buf,this.pos+4)*Ll;return this.pos+=8,r},readFloat:function(){var r=$d(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=$d(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,n,u=this.buf;return e=127&(n=u[this.pos++]),n<128?e:(e|=(127&(n=u[this.pos++]))<<7,n<128?e:(e|=(127&(n=u[this.pos++]))<<14,n<128?e:(e|=(127&(n=u[this.pos++]))<<21,n<128?e:function(f,g,b){var I,z,R=b.buf;if(I=(112&(z=R[b.pos++]))>>4,z<128||(I|=(127&(z=R[b.pos++]))<<3,z<128)||(I|=(127&(z=R[b.pos++]))<<10,z<128)||(I|=(127&(z=R[b.pos++]))<<17,z<128)||(I|=(127&(z=R[b.pos++]))<<24,z<128)||(I|=(1&(z=R[b.pos++]))<<31,z<128))return Rl(f,I,g);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=u[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&V1?function(n,u,f){return V1.decode(n.subarray(u,f))}(this.buf,e,r):function(n,u,f){for(var g="",b=u;b<f;){var I,z,R,N=n[b],$=null,W=N>239?4:N>223?3:N>191?2:1;if(b+W>f)break;W===1?N<128&&($=N):W===2?(192&(I=n[b+1]))==128&&($=(31&N)<<6|63&I)<=127&&($=null):W===3?(z=n[b+2],(192&(I=n[b+1]))==128&&(192&z)==128&&(($=(15&N)<<12|(63&I)<<6|63&z)<=2047||$>=55296&&$<=57343)&&($=null)):W===4&&(z=n[b+2],R=n[b+3],(192&(I=n[b+1]))==128&&(192&z)==128&&(192&R)==128&&(($=(15&N)<<18|(63&I)<<12|(63&z)<<6|63&R)<=65535||$>=1114112)&&($=null)),$===null?($=65533,W=1):$>65535&&($-=65536,g+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),g+=String.fromCharCode($),b+=W}return g}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==qr.Bytes)return r.push(this.readVarint(e));var n=$c(this);for(r=r||[];this.pos<n;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==qr.Bytes)return r.push(this.readSVarint());var e=$c(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==qr.Bytes)return r.push(this.readBoolean());var e=$c(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==qr.Bytes)return r.push(this.readFloat());var e=$c(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==qr.Bytes)return r.push(this.readDouble());var e=$c(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==qr.Bytes)return r.push(this.readFixed32());var e=$c(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==qr.Bytes)return r.push(this.readSFixed32());var e=$c(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==qr.Bytes)return r.push(this.readFixed64());var e=$c(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==qr.Bytes)return r.push(this.readSFixed64());var e=$c(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===qr.Varint)for(;this.buf[this.pos++]>127;);else if(e===qr.Bytes)this.pos=this.readVarint()+this.pos;else if(e===qr.Fixed32)this.pos+=4;else{if(e!==qr.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Gp(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Gp(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Gp(this.buf,-1&r,this.pos),Gp(this.buf,Math.floor(r*N1),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Gp(this.buf,-1&r,this.pos),Gp(this.buf,Math.floor(r*N1),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,n){var u,f;if(e>=0?(u=e%4294967296|0,f=e/4294967296|0):(f=~(-e/4294967296),4294967295^(u=~(-e%4294967296))?u=u+1|0:(u=0,f=f+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(g,b,I){I.buf[I.pos++]=127&g|128,g>>>=7,I.buf[I.pos++]=127&g|128,g>>>=7,I.buf[I.pos++]=127&g|128,g>>>=7,I.buf[I.pos++]=127&g|128,I.buf[I.pos]=127&(g>>>=7)}(u,0,n),function(g,b){var I=(7&g)<<4;b.buf[b.pos++]|=I|((g>>>=3)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g)))))}(f,n)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(u,f,g){for(var b,I,z=0;z<f.length;z++){if((b=f.charCodeAt(z))>55295&&b<57344){if(!I){b>56319||z+1===f.length?(u[g++]=239,u[g++]=191,u[g++]=189):I=b;continue}if(b<56320){u[g++]=239,u[g++]=191,u[g++]=189,I=b;continue}b=I-55296<<10|b-56320|65536,I=null}else I&&(u[g++]=239,u[g++]=191,u[g++]=189,I=null);b<128?u[g++]=b:(b<2048?u[g++]=b>>6|192:(b<65536?u[g++]=b>>12|224:(u[g++]=b>>18|240,u[g++]=b>>12&63|128),u[g++]=b>>6&63|128),u[g++]=63&b|128)}return g}(this.buf,r,this.pos);var n=this.pos-e;n>=128&&dg(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(r){this.realloc(4),If(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),If(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=r[n]},writeRawMessage:function(r,e){this.pos++;var n=this.pos;r(e,this);var u=this.pos-n;u>=128&&dg(n,u,this),this.pos=n-1,this.writeVarint(u),this.pos+=u},writeMessage:function(r,e,n){this.writeTag(r,qr.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,Mv,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,Cv,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,Pv,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,Iv,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,Av,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,kv,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,zv,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,Dv,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,Lv,e)},writeBytesField:function(r,e){this.writeTag(r,qr.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,qr.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,qr.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,qr.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,qr.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,qr.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,qr.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,qr.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,qr.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,qr.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,!!e)}};var Bm=je(Dl);const Y5=3;function Rv(r,e,n){e.glyphs=[],r===1&&n.readMessage(Bv,e)}function Bv(r,e,n){if(r===3){const{id:u,bitmap:f,width:g,height:b,left:I,top:z,advance:R}=n.readMessage(Fv,{});e.glyphs.push({id:u,bitmap:new Eu({width:g+2*Y5,height:b+2*Y5},f),metrics:{width:g,height:b,left:I,top:z,advance:R}})}else r===4?e.ascender=n.readSVarint():r===5&&(e.descender=n.readSVarint())}function Fv(r,e,n){r===1?e.id=n.readVarint():r===2?e.bitmap=n.readBytes():r===3?e.width=n.readVarint():r===4?e.height=n.readVarint():r===5?e.left=n.readSVarint():r===6?e.top=n.readSVarint():r===7&&(e.advance=n.readVarint())}const fg=Y5;function J5(r){let e=0,n=0;for(const b of r)e+=b.w*b.h,n=Math.max(n,b.w);r.sort((b,I)=>I.h-b.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let f=0,g=0;for(const b of r)for(let I=u.length-1;I>=0;I--){const z=u[I];if(!(b.w>z.w||b.h>z.h)){if(b.x=z.x,b.y=z.y,g=Math.max(g,b.y+b.h),f=Math.max(f,b.x+b.w),b.w===z.w&&b.h===z.h){const R=u.pop();I<u.length&&(u[I]=R)}else b.h===z.h?(z.x+=b.w,z.w-=b.w):b.w===z.w?(z.y+=b.h,z.h-=b.h):(u.push({x:z.x+b.w,y:z.y,w:z.w-b.w,h:b.h}),z.y+=b.h,z.h-=b.h);break}}return{w:f,h:g,fill:e/(f*g)||0}}const rl=1;class Q5{constructor(e,{pixelRatio:n,version:u,stretchX:f,stretchY:g,content:b}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=f,this.stretchY=g,this.content=b,this.version=u}get tl(){return[this.paddedRect.x+rl,this.paddedRect.y+rl]}get br(){return[this.paddedRect.x+this.paddedRect.w-rl,this.paddedRect.y+this.paddedRect.h-rl]}get displaySize(){return[(this.paddedRect.w-2*rl)/this.pixelRatio,(this.paddedRect.h-2*rl)/this.pixelRatio]}}class mg{constructor(e,n){const u={},f={};this.haveRenderCallbacks=[];const g=[];this.addImages(e,u,g),this.addImages(n,f,g);const{w:b,h:I}=J5(g),z=new Qs({width:b||1,height:I||1});for(const R in e){const N=e[R],$=u[R].paddedRect;Qs.copy(N.data,z,{x:0,y:0},{x:$.x+rl,y:$.y+rl},N.data)}for(const R in n){const N=n[R],$=f[R].paddedRect,W=$.x+rl,Q=$.y+rl,te=N.data.width,ce=N.data.height;Qs.copy(N.data,z,{x:0,y:0},{x:W,y:Q},N.data),Qs.copy(N.data,z,{x:0,y:ce-1},{x:W,y:Q-1},{width:te,height:1}),Qs.copy(N.data,z,{x:0,y:0},{x:W,y:Q+ce},{width:te,height:1}),Qs.copy(N.data,z,{x:te-1,y:0},{x:W-1,y:Q},{width:1,height:ce}),Qs.copy(N.data,z,{x:0,y:0},{x:W+te,y:Q},{width:1,height:ce})}this.image=z,this.iconPositions=u,this.patternPositions=f}addImages(e,n,u){for(const f in e){const g=e[f],b={x:0,y:0,w:g.data.width+2*rl,h:g.data.height+2*rl};u.push(b),n[f]=new Q5(b,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>e.hasImage(u)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in e.updatedImages)this.patchUpdatedImage(this.iconPositions[u],e.getImage(u),n),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u),n)}patchUpdatedImage(e,n,u){if(!e||!n||e.version===n.version)return;e.version=n.version;const[f,g]=e.tl;u.update(n.data,void 0,{x:f,y:g})}}Ft(Q5,"ImagePosition"),Ft(mg,"ImageAtlas");const pc={horizontal:1,vertical:2,horizontalOnly:3},_g=-17;class Af{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const u=new Af;return u.scale=e||1,u.fontStack=n,u}static forImage(e){const n=new Af;return n.imageName=e,n}}class $p{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const u=new $p;for(let f=0;f<e.sections.length;f++){const g=e.sections[f];g.image?u.addImageSection(g):u.addTextSection(g,n)}return u}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,u){let f="";for(let g=0;g<n.length;g++){const b=n.charCodeAt(g+1)||null,I=n.charCodeAt(g-1)||null;f+=!u&&(b&&_o(b)&&!Gd[n[g+1]]||I&&_o(I)&&!Gd[n[g-1]])||!Gd[n[g]]?n[g]:Gd[n[g]]}return f}(this.text,e)}trim(){let e=0;for(let u=0;u<this.text.length&&Fm[this.text.charCodeAt(u)];u++)e++;let n=this.text.length;for(let u=this.text.length-1;u>=0&&u>=e&&Fm[this.text.charCodeAt(u)];u--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const u=new $p;return u.text=this.text.substring(e,n),u.sectionIndex=this.sectionIndex.slice(e,n),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Af.forText(e.scale,e.fontStack||n));const u=this.sections.length-1;for(let f=0;f<e.text.length;++f)this.sectionIndex.push(u)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void sn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Af.forImage(n)),this.sectionIndex.push(this.sections.length-1)):sn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function e4(r,e,n,u,f,g,b,I,z,R,N,$,W,Q,te){const ce=$p.fromFeature(r,f);$===pc.vertical&&ce.verticalizePunctuation(W);let we=[];const Re=function(et,Ot,Lt,ti,vi,Vt){if(!et)return[];const ni=[],oi=function(Bi,Ki,Oi,Dr,Ei,ur){let Lr=0;for(let mn=0;mn<Bi.length();mn++){const Rr=Bi.getSection(mn);Lr+=gg(Bi.getCharCode(mn),Rr,Dr,Ei,Ki,ur)}return Lr/Math.max(1,Math.ceil(Lr/Oi))}(et,Ot,Lt,ti,vi,Vt),fi=et.text.indexOf("​")>=0;let Ti=0;for(let Bi=0;Bi<et.length();Bi++){const Ki=et.getSection(Bi),Oi=et.getCharCode(Bi);if(Fm[Oi]||(Ti+=gg(Oi,Ki,ti,vi,Ot,Vt)),Bi<et.length()-1){const Dr=!((Jt=Oi)<11904||!(pi["Bopomofo Extended"](Jt)||pi.Bopomofo(Jt)||pi["CJK Compatibility Forms"](Jt)||pi["CJK Compatibility Ideographs"](Jt)||pi["CJK Compatibility"](Jt)||pi["CJK Radicals Supplement"](Jt)||pi["CJK Strokes"](Jt)||pi["CJK Symbols and Punctuation"](Jt)||pi["CJK Unified Ideographs Extension A"](Jt)||pi["CJK Unified Ideographs"](Jt)||pi["Enclosed CJK Letters and Months"](Jt)||pi["Halfwidth and Fullwidth Forms"](Jt)||pi.Hiragana(Jt)||pi["Ideographic Description Characters"](Jt)||pi["Kangxi Radicals"](Jt)||pi["Katakana Phonetic Extensions"](Jt)||pi.Katakana(Jt)||pi["Vertical Forms"](Jt)||pi["Yi Radicals"](Jt)||pi["Yi Syllables"](Jt)));(Ov[Oi]||Dr||Ki.imageName)&&ni.push(xg(Bi+1,Ti,oi,ni,Uv(Oi,et.getCharCode(Bi+1),Dr&&fi),!1))}}var Jt;return vg(xg(et.length(),Ti,oi,ni,0,!0))}(ce,R,g,e,u,Q),{processBidirectionalText:He,processStyledBidirectionalText:Be}=O;if(He&&ce.sections.length===1){const et=He(ce.toString(),Re);for(const Ot of et){const Lt=new $p;Lt.text=Ot,Lt.sections=ce.sections;for(let ti=0;ti<Ot.length;ti++)Lt.sectionIndex.push(0);we.push(Lt)}}else if(Be){const et=Be(ce.text,ce.sectionIndex,Re);for(const Ot of et){const Lt=new $p;Lt.text=Ot[0],Lt.sectionIndex=Ot[1],Lt.sections=ce.sections,we.push(Lt)}}else we=function(et,Ot){const Lt=[],ti=et.text;let vi=0;for(const Vt of Ot)Lt.push(et.substring(vi,Vt)),vi=Vt;return vi<ti.length&&Lt.push(et.substring(vi,ti.length)),Lt}(ce,Re);const We=[],it={positionedLines:We,text:ce.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:$,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(et,Ot,Lt,ti,vi,Vt,ni,oi,fi,Ti,Jt,Bi){let Ki=0,Oi=0,Dr=0;const Ei=oi==="right"?1:oi==="left"?0:.5;let ur=!1;for(const Or of vi){const Ur=Or.getSections();for(const On of Ur){if(On.imageName)continue;const Gn=Ot[On.fontStack];if(Gn&&(ur=Gn.ascender!==void 0&&Gn.descender!==void 0,!ur))break}if(!ur)break}let Lr=0;for(const Or of vi){Or.trim();const Ur=Or.getMaxScale(),On=(Ur-1)*Oo,Gn={positionedGlyphs:[],lineOffset:0};et.positionedLines[Lr]=Gn;const $n=Gn.positionedGlyphs;let Un=0;if(!Or.length()){Oi+=Vt,++Lr;continue}let uo=0,bo=0;for(let Nn=0;Nn<Or.length();Nn++){const is=Or.getSection(Nn),No=Or.getSectionIndex(Nn),po=Or.getCharCode(Nn);let xn=is.scale,Vo=null,Zn=null,Da=null,jo=Oo,Vs=0;const zs=!(fi===pc.horizontal||!Jt&&!dn(po)||Jt&&(Fm[po]||(mn=po,pi.Arabic(mn)||pi["Arabic Supplement"](mn)||pi["Arabic Extended-A"](mn)||pi["Arabic Presentation Forms-A"](mn)||pi["Arabic Presentation Forms-B"](mn))));if(is.imageName){const La=ti[is.imageName];if(!La)continue;Da=is.imageName,et.iconsInText=et.iconsInText||!0,Zn=La.paddedRect;const Ds=La.displaySize;xn=xn*Oo/Bi,Vo={width:Ds[0],height:Ds[1],left:rl,top:-fg,advance:zs?Ds[1]:Ds[0],localGlyph:!1},Vs=ur?-Vo.height*xn:_g+Ur*Oo-Ds[1]*xn,jo=Vo.advance;const Iu=(zs?Ds[0]:Ds[1])*xn-Oo*Ur;Iu>0&&Iu>Un&&(Un=Iu)}else{const La=Lt[is.fontStack];if(!La)continue;La[po]&&(Zn=La[po]);const Ds=Ot[is.fontStack];if(!Ds)continue;const Iu=Ds.glyphs[po];if(!Iu)continue;if(Vo=Iu.metrics,jo=po!==8203?Oo:0,ur){const Yp=Ds.ascender!==void 0?Math.abs(Ds.ascender):0,Uf=Ds.descender!==void 0?Math.abs(Ds.descender):0,Nf=(Yp+Uf)*xn;uo<Nf&&(uo=Nf,bo=(Yp-Uf)/2*xn),Vs=-Yp*xn}else Vs=_g+(Ur-xn)*Oo}zs?(et.verticalizable=!0,$n.push({glyph:po,imageName:Da,x:Ki,y:Oi+Vs,vertical:zs,scale:xn,localGlyph:Vo.localGlyph,fontStack:is.fontStack,sectionIndex:No,metrics:Vo,rect:Zn}),Ki+=jo*xn+Ti):($n.push({glyph:po,imageName:Da,x:Ki,y:Oi+Vs,vertical:zs,scale:xn,localGlyph:Vo.localGlyph,fontStack:is.fontStack,sectionIndex:No,metrics:Vo,rect:Zn}),Ki+=Vo.advance*xn+Ti)}$n.length!==0&&(Dr=Math.max(Ki-Ti,Dr),ur?bg($n,Ei,Un,bo,Vt*Ur/2):bg($n,Ei,Un,0,Vt/2)),Ki=0;const Uo=Vt*Ur+Un;Gn.lineOffset=Math.max(Un,On),Oi+=Uo,++Lr}var mn;const Rr=Oi,{horizontalAlign:gr,verticalAlign:Xn}=t4(ni);(function(Or,Ur,On,Gn,$n,Un){const uo=(Ur-On)*$n,bo=-Un*Gn;for(const Uo of Or)for(const Nn of Uo.positionedGlyphs)Nn.x+=uo,Nn.y+=bo})(et.positionedLines,Ei,gr,Xn,Dr,Rr),et.top+=-Xn*Rr,et.bottom=et.top+Rr,et.left+=-gr*Dr,et.right=et.left+Dr,et.hasBaseline=ur}(it,e,n,u,we,b,I,z,$,R,W,te),!function(et){for(const Ot of et)if(Ot.positionedGlyphs.length!==0)return!1;return!0}(We)&&it}const Fm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ov={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function gg(r,e,n,u,f,g){if(e.imageName){const b=u[e.imageName];return b?b.displaySize[0]*e.scale*Oo/g+f:0}{const b=n[e.fontStack],I=b&&b.glyphs[r];return I?I.metrics.advance*e.scale+f:0}}function yg(r,e,n,u){const f=Math.pow(r-e,2);return u?r<e?f/2:2*f:f+Math.abs(n)*n}function Uv(r,e,n){let u=0;return r===10&&(u-=1e4),n&&(u+=150),r!==40&&r!==65288||(u+=50),e!==41&&e!==65289||(u+=50),u}function xg(r,e,n,u,f,g){let b=null,I=yg(e,n,f,g);for(const z of u){const R=yg(e-z.x,n,f,g)+z.badness;R<=I&&(b=z,I=R)}return{index:r,x:e,priorBreak:b,badness:I}}function vg(r){return r?vg(r.priorBreak).concat(r.index):[]}function t4(r){let e=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function bg(r,e,n,u,f){if(!(e||n||u||f))return;const g=r.length-1,b=r[g],I=(b.x+b.metrics.advance*b.scale)*e;for(let z=0;z<=g;z++)r[z].x-=I,r[z].y+=n+u+f}function Nv(r,e,n){const{horizontalAlign:u,verticalAlign:f}=t4(n),g=e[0]-r.displaySize[0]*u,b=e[1]-r.displaySize[1]*f;return{image:r,top:b,bottom:b+r.displaySize[1],left:g,right:g+r.displaySize[0]}}function wg(r,e,n,u,f,g){const b=r.image;let I;if(b.content){const we=b.content,Re=b.pixelRatio||1;I=[we[0]/Re,we[1]/Re,b.displaySize[0]-we[2]/Re,b.displaySize[1]-we[3]/Re]}const z=e.left*g,R=e.right*g;let N,$,W,Q;n==="width"||n==="both"?(Q=f[0]+z-u[3],$=f[0]+R+u[1]):(Q=f[0]+(z+R-b.displaySize[0])/2,$=Q+b.displaySize[0]);const te=e.top*g,ce=e.bottom*g;return n==="height"||n==="both"?(N=f[1]+te-u[0],W=f[1]+ce+u[2]):(N=f[1]+(te+ce-b.displaySize[1])/2,W=N+b.displaySize[1]),{image:b,top:N,right:$,bottom:W,left:Q,collisionPadding:I}}class Qh extends zt{constructor(e,n,u,f,g){super(e,n),this.angle=f,this.z=u,g!==void 0&&(this.segment=g)}clone(){return new Qh(this.x,this.y,this.z,this.angle,this.segment)}}function Tg(r,e,n,u,f){if(e.segment===void 0)return!0;let g=e,b=e.segment+1,I=0;for(;I>-n/2;){if(b--,b<0)return!1;I-=r[b].dist(g),g=r[b]}I+=r[b].dist(r[b+1]),b++;const z=[];let R=0;for(;I<n/2;){const N=r[b],$=r[b+1];if(!$)return!1;let W=r[b-1].angleTo(N)-N.angleTo($);for(W=Math.abs((W+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:I,angleDelta:W}),R+=W;I-z[0].distance>u;)R-=z.shift().angleDelta;if(R>f)return!1;b++,I+=N.dist($)}return!0}function Eg(r){let e=0;for(let n=0;n<r.length-1;n++)e+=r[n].dist(r[n+1]);return e}function Sg(r,e,n){return r?.6*e*n:0}function Mg(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function Vv(r,e,n,u,f,g){const b=Sg(n,f,g),I=Mg(n,u)*g;let z=0;const R=Eg(r)/2;for(let N=0;N<r.length-1;N++){const $=r[N],W=r[N+1],Q=$.dist(W);if(z+Q>R){const te=(R-z)/Q,ce=Kr($.x,W.x,te),we=Kr($.y,W.y,te),Re=new Qh(ce,we,0,W.angleTo($),N);return!b||Tg(r,Re,I,b,e)?Re:void 0}z+=Q}}function jv(r,e,n,u,f,g,b,I,z){const R=Sg(u,g,b),N=Mg(u,f),$=N*b,W=r[0].x===0||r[0].x===z||r[0].y===0||r[0].y===z;return e-$<e/4&&(e=$+e/4),Cg(r,W?e/2*I%e:(N/2+2*g)*b*I%e,e,R,n,$,W,!1,z)}function Cg(r,e,n,u,f,g,b,I,z){const R=g/2,N=Eg(r);let $=0,W=e-n,Q=[];for(let te=0;te<r.length-1;te++){const ce=r[te],we=r[te+1],Re=ce.dist(we),He=we.angleTo(ce);for(;W+n<$+Re;){W+=n;const Be=(W-$)/Re,We=Kr(ce.x,we.x,Be),it=Kr(ce.y,we.y,Be);if(We>=0&&We<z&&it>=0&&it<z&&W-R>=0&&W+R<=N){const et=new Qh(We,it,0,He,te);et._round(),u&&!Tg(r,et,g,u,f)||Q.push(et)}}$+=Re}return I||Q.length||b||(Q=Cg(r,$/2,n,u,f,g,b,!0,z)),Q}function Ig(r,e,n,u,f){const g=[];for(let b=0;b<r.length;b++){const I=r[b];let z;for(let R=0;R<I.length-1;R++){let N=I[R],$=I[R+1];N.x<e&&$.x<e||(N.x<e?N=new zt(e,N.y+(e-N.x)/($.x-N.x)*($.y-N.y))._round():$.x<e&&($=new zt(e,N.y+(e-N.x)/($.x-N.x)*($.y-N.y))._round()),N.y<n&&$.y<n||(N.y<n?N=new zt(N.x+(n-N.y)/($.y-N.y)*($.x-N.x),n)._round():$.y<n&&($=new zt(N.x+(n-N.y)/($.y-N.y)*($.x-N.x),n)._round()),N.x>=u&&$.x>=u||(N.x>=u?N=new zt(u,N.y+(u-N.x)/($.x-N.x)*($.y-N.y))._round():$.x>=u&&($=new zt(u,N.y+(u-N.x)/($.x-N.x)*($.y-N.y))._round()),N.y>=f&&$.y>=f||(N.y>=f?N=new zt(N.x+(f-N.y)/($.y-N.y)*($.x-N.x),f)._round():$.y>=f&&($=new zt(N.x+(f-N.y)/($.y-N.y)*($.x-N.x),f)._round()),z&&N.equals(z[z.length-1])||(z=[N],g.push(z)),z.push($)))))}}return g}Ft(Qh,"Anchor");const Pf=1e20;function Ag(r,e,n,u,f,g,b,I,z){for(let R=e;R<e+u;R++)Pg(r,n*g+R,g,f,b,I,z);for(let R=n;R<n+f;R++)Pg(r,R*g+e,1,u,b,I,z)}function Pg(r,e,n,u,f,g,b){g[0]=0,b[0]=-Pf,b[1]=Pf,f[0]=r[e];for(let I=1,z=0,R=0;I<u;I++){f[I]=r[e+I*n];const N=I*I;do{const $=g[z];R=(f[I]-f[$]+N-$*$)/(I-$)/2}while(R<=b[z]&&--z>-1);z++,g[z]=I,b[z]=R,b[z+1]=Pf}for(let I=0,z=0;I<u;I++){for(;b[z+1]<I;)z++;const R=g[z],N=I-R;r[e+I*n]=f[R]+N*N}}const Mu=2,i4={none:0,ideographs:1,all:2};class Zp{constructor(e,n,u){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=u,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const u=[];for(const f in e)for(const g of e[f])u.push({stack:f,id:g});Wi(u,({stack:f,id:g},b)=>{let I=this.entries[f];I||(I=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let z=I.glyphs[g];if(z!==void 0)return void b(null,{stack:f,id:g,glyph:z});if(z=this._tinySDF(I,f,g),z)return I.glyphs[g]=z,void b(null,{stack:f,id:g,glyph:z});const R=Math.floor(g/256);if(256*R>65535)return void b(new Error("glyphs > 65535 not supported"));if(I.ranges[R])return void b(null,{stack:f,id:g,glyph:z});let N=I.requests[R];N||(N=I.requests[R]=[],Zp.loadGlyphRange(f,R,this.url,this.requestManager,($,W)=>{if(W){I.ascender=W.ascender,I.descender=W.descender;for(const Q in W.glyphs)this._doesCharSupportLocalGlyph(+Q)||(I.glyphs[+Q]=W.glyphs[+Q]);I.ranges[R]=!0}for(const Q of N)Q($,W);delete I.requests[R]})),N.push(($,W)=>{$?b($):W&&b(null,{stack:f,id:g,glyph:W.glyphs[g]||null})})},(f,g)=>{if(f)n(f);else if(g){const b={};for(const{stack:I,id:z,glyph:R}of g)b[I]===void 0&&(b[I]={}),b[I].glyphs===void 0&&(b[I].glyphs={}),b[I].glyphs[z]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics},b[I].ascender=this.entries[I].ascender,b[I].descender=this.entries[I].descender;n(null,b)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==i4.none&&(this.localGlyphMode===i4.all?!!this.localFontFamily:!!this.localFontFamily&&(pi["CJK Unified Ideographs"](e)||pi["Hangul Syllables"](e)||pi.Hiragana(e)||pi.Katakana(e)||pi["CJK Symbols and Punctuation"](e)))}_tinySDF(e,n,u){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(u))return;let g=e.tinySDF;if(!g){let ce="400";/bold/i.test(n)?ce="900":/medium/i.test(n)?ce="500":/light/i.test(n)&&(ce="200"),g=e.tinySDF=new Zp.TinySDF({fontFamily:f,fontWeight:ce,fontSize:24*Mu,buffer:3*Mu,radius:8*Mu}),g.fontWeight=ce}if(this.localGlyphs[g.fontWeight][u])return this.localGlyphs[g.fontWeight][u];const b=String.fromCharCode(u),{data:I,width:z,height:R,glyphWidth:N,glyphHeight:$,glyphLeft:W,glyphTop:Q,glyphAdvance:te}=g.draw(b);return this.localGlyphs[g.fontWeight][u]={id:u,bitmap:new Eu({width:z,height:R},I),metrics:{width:N/Mu,height:$/Mu,left:W/Mu,top:Q/Mu-27,advance:te/Mu,localGlyph:!0}}}}Zp.loadGlyphRange=function(r,e,n,u,f){const g=256*e,b=g+255,I=u.transformRequest(u.normalizeGlyphsURL(n).replace("{fontstack}",r).replace("{range}",`${g}-${b}`),zn.Glyphs);Ii(I,(z,R)=>{if(z)f(z);else if(R){const N={},$=function(W){return new Bm(W).readFields(Rv,{})}(R);for(const W of $.glyphs)N[W.id]=W;f(null,{glyphs:N,ascender:$.ascender,descender:$.descender})}})},Zp.TinySDF=class{constructor({fontSize:r=24,buffer:e=3,radius:n=8,cutoff:u=.25,fontFamily:f="sans-serif",fontWeight:g="normal",fontStyle:b="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=n;const I=this.size=r+4*e,z=this._createCanvas(I),R=this.ctx=z.getContext("2d",{willReadFrequently:!0});R.font=`${b} ${g} ${r}px ${f}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(r){const e=document.createElement("canvas");return e.width=e.height=r,e}draw(r){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:u,actualBoundingBoxLeft:f,actualBoundingBoxRight:g}=this.ctx.measureText(r),b=Math.ceil(n),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-f))),z=Math.min(this.size-this.buffer,b+Math.ceil(u)),R=I+2*this.buffer,N=z+2*this.buffer,$=Math.max(R*N,0),W=new Uint8ClampedArray($),Q={data:W,width:R,height:N,glyphWidth:I,glyphHeight:z,glyphTop:b,glyphLeft:0,glyphAdvance:e};if(I===0||z===0)return Q;const{ctx:te,buffer:ce,gridInner:we,gridOuter:Re}=this;te.clearRect(ce,ce,I,z),te.fillText(r,ce,ce+b);const He=te.getImageData(ce,ce,I,z);Re.fill(Pf,0,$),we.fill(0,0,$);for(let Be=0;Be<z;Be++)for(let We=0;We<I;We++){const it=He.data[4*(Be*I+We)+3]/255;if(it===0)continue;const et=(Be+ce)*R+We+ce;if(it===1)Re[et]=0,we[et]=Pf;else{const Ot=.5-it;Re[et]=Ot>0?Ot*Ot:0,we[et]=Ot<0?Ot*Ot:0}}Ag(Re,0,0,R,N,R,this.f,this.v,this.z),Ag(we,ce,ce,I,z,R,this.f,this.v,this.z);for(let Be=0;Be<$;Be++){const We=Math.sqrt(Re[Be])-Math.sqrt(we[Be]);W[Be]=Math.round(255-255*(We/this.radius+this.cutoff))}return Q}};const qp=rl;function kg(r,e,n,u){const f=[],g=r.image,b=g.pixelRatio,I=g.paddedRect.w-2*qp,z=g.paddedRect.h-2*qp,R=r.right-r.left,N=r.bottom-r.top,$=g.stretchX||[[0,I]],W=g.stretchY||[[0,z]],Q=(Vt,ni)=>Vt+ni[1]-ni[0],te=$.reduce(Q,0),ce=W.reduce(Q,0),we=I-te,Re=z-ce;let He=0,Be=te,We=0,it=ce,et=0,Ot=we,Lt=0,ti=Re;if(g.content&&u){const Vt=g.content;He=Om($,0,Vt[0]),We=Om(W,0,Vt[1]),Be=Om($,Vt[0],Vt[2]),it=Om(W,Vt[1],Vt[3]),et=Vt[0]-He,Lt=Vt[1]-We,Ot=Vt[2]-Vt[0]-Be,ti=Vt[3]-Vt[1]-it}const vi=(Vt,ni,oi,fi)=>{const Ti=Um(Vt.stretch-He,Be,R,r.left),Jt=Nm(Vt.fixed-et,Ot,Vt.stretch,te),Bi=Um(ni.stretch-We,it,N,r.top),Ki=Nm(ni.fixed-Lt,ti,ni.stretch,ce),Oi=Um(oi.stretch-He,Be,R,r.left),Dr=Nm(oi.fixed-et,Ot,oi.stretch,te),Ei=Um(fi.stretch-We,it,N,r.top),ur=Nm(fi.fixed-Lt,ti,fi.stretch,ce),Lr=new zt(Ti,Bi),mn=new zt(Oi,Bi),Rr=new zt(Oi,Ei),gr=new zt(Ti,Ei),Xn=new zt(Jt/b,Ki/b),Or=new zt(Dr/b,ur/b),Ur=e*Math.PI/180;if(Ur){const $n=Math.sin(Ur),Un=Math.cos(Ur),uo=[Un,-$n,$n,Un];Lr._matMult(uo),mn._matMult(uo),gr._matMult(uo),Rr._matMult(uo)}const On=Vt.stretch+Vt.fixed,Gn=ni.stretch+ni.fixed;return{tl:Lr,tr:mn,bl:gr,br:Rr,tex:{x:g.paddedRect.x+qp+On,y:g.paddedRect.y+qp+Gn,w:oi.stretch+oi.fixed-On,h:fi.stretch+fi.fixed-Gn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Xn,pixelOffsetBR:Or,minFontScaleX:Ot/b/R,minFontScaleY:ti/b/N,isSDF:n}};if(u&&(g.stretchX||g.stretchY)){const Vt=zg($,we,te),ni=zg(W,Re,ce);for(let oi=0;oi<Vt.length-1;oi++){const fi=Vt[oi],Ti=Vt[oi+1];for(let Jt=0;Jt<ni.length-1;Jt++)f.push(vi(fi,ni[Jt],Ti,ni[Jt+1]))}}else f.push(vi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:z+1}));return f}function Om(r,e,n){let u=0;for(const f of r)u+=Math.max(e,Math.min(n,f[1]))-Math.max(e,Math.min(n,f[0]));return u}function zg(r,e,n){const u=[{fixed:-qp,stretch:0}];for(const[f,g]of r){const b=u[u.length-1];u.push({fixed:f-b.stretch,stretch:b.stretch}),u.push({fixed:f-b.stretch,stretch:b.stretch+(g-f)})}return u.push({fixed:e+qp,stretch:n}),u}function Um(r,e,n,u){return r/e*n+u}function Nm(r,e,n,u){return r-e*n/u}function Gv(r,e,n,u){const f=e+r.positionedLines[u].lineOffset;return u===0?n+f/2:n+(f+(e+r.positionedLines[u-1].lineOffset))/2}class $v{constructor(e=[],n=Zv){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:u}=this,f=n[e];for(;e>0;){const g=e-1>>1,b=n[g];if(u(f,b)>=0)break;n[e]=b,e=g}n[e]=f}_down(e){const{data:n,compare:u}=this,f=this.length>>1,g=n[e];for(;e<f;){let b=1+(e<<1),I=n[b];const z=b+1;if(z<this.length&&u(n[z],I)<0&&(b=z,I=n[z]),u(I,g)>=0)break;n[e]=I,e=b}n[e]=g}}function Zv(r,e){return r<e?-1:r>e?1:0}function qv(r,e=1,n=!1){let u=1/0,f=1/0,g=-1/0,b=-1/0;const I=r[0];for(let Q=0;Q<I.length;Q++){const te=I[Q];(!Q||te.x<u)&&(u=te.x),(!Q||te.y<f)&&(f=te.y),(!Q||te.x>g)&&(g=te.x),(!Q||te.y>b)&&(b=te.y)}const z=Math.min(g-u,b-f);let R=z/2;const N=new $v([],Wv);if(z===0)return new zt(u,f);for(let Q=u;Q<g;Q+=z)for(let te=f;te<b;te+=z)N.push(new Wp(Q+R,te+R,R,r));let $=function(Q){let te=0,ce=0,we=0;const Re=Q[0];for(let He=0,Be=Re.length,We=Be-1;He<Be;We=He++){const it=Re[He],et=Re[We],Ot=it.x*et.y-et.x*it.y;ce+=(it.x+et.x)*Ot,we+=(it.y+et.y)*Ot,te+=3*Ot}return new Wp(ce/te,we/te,0,Q)}(r),W=N.length;for(;N.length;){const Q=N.pop();(Q.d>$.d||!$.d)&&($=Q,n&&console.log("found best %d after %d probes",Math.round(1e4*Q.d)/1e4,W)),Q.max-$.d<=e||(R=Q.h/2,N.push(new Wp(Q.p.x-R,Q.p.y-R,R,r)),N.push(new Wp(Q.p.x+R,Q.p.y-R,R,r)),N.push(new Wp(Q.p.x-R,Q.p.y+R,R,r)),N.push(new Wp(Q.p.x+R,Q.p.y+R,R,r)),W+=4)}return n&&(console.log(`num probes: ${W}`),console.log(`best distance: ${$.d}`)),$.p}function Wv(r,e){return e.max-r.max}class Wp{constructor(e,n,u,f){this.p=new zt(e,n),this.h=u,this.d=function(g,b){let I=!1,z=1/0;for(let R=0;R<b.length;R++){const N=b[R];for(let $=0,W=N.length,Q=W-1;$<W;Q=$++){const te=N[$],ce=N[Q];te.y>g.y!=ce.y>g.y&&g.x<(ce.x-te.x)*(g.y-te.y)/(ce.y-te.y)+te.x&&(I=!I),z=Math.min(z,_m(g,te,ce))}}return(I?1:-1)*Math.sqrt(z)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const Xp=7,r4=Number.POSITIVE_INFINITY,Xv=Math.sqrt(2);function Dg(r,[e,n]){let u=0,f=0;if(n===r4){e<0&&(e=0);const g=e/Xv;switch(r){case"top-right":case"top-left":f=g-Xp;break;case"bottom-right":case"bottom-left":f=-g+Xp;break;case"bottom":f=-e+Xp;break;case"top":f=e-Xp}switch(r){case"top-right":case"bottom-right":u=-g;break;case"top-left":case"bottom-left":u=g;break;case"left":u=e;break;case"right":u=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),r){case"top-right":case"top-left":case"top":f=n-Xp;break;case"bottom-right":case"bottom-left":case"bottom":f=-n+Xp}switch(r){case"top-right":case"bottom-right":case"right":u=-e;break;case"top-left":case"bottom-left":case"left":u=e}}return[u,f]}function Hv(r,e,n,u,f,g,b,I,z,R){r.createArrays(),r.tilePixelRatio=sr/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const N=r.layers[0].layout,$=r.layers[0]._unevaluatedLayout._values,W={};if(r.textSizeData.kind==="composite"){const{minZoom:ce,maxZoom:we}=r.textSizeData;W.compositeTextSizes=[$["text-size"].possiblyEvaluate(new G(ce),I),$["text-size"].possiblyEvaluate(new G(we),I)]}if(r.iconSizeData.kind==="composite"){const{minZoom:ce,maxZoom:we}=r.iconSizeData;W.compositeIconSizes=[$["icon-size"].possiblyEvaluate(new G(ce),I),$["icon-size"].possiblyEvaluate(new G(we),I)]}W.layoutTextSize=$["text-size"].possiblyEvaluate(new G(z+1),I),W.layoutIconSize=$["icon-size"].possiblyEvaluate(new G(z+1),I),W.textMaxSize=$["text-size"].possiblyEvaluate(new G(18),I);const Q=N.get("text-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",te=N.get("text-size");for(const ce of r.features){const we=N.get("text-font").evaluate(ce,{},I).join(","),Re=te.evaluate(ce,{},I),He=W.layoutTextSize.evaluate(ce,{},I),Be=(W.layoutIconSize.evaluate(ce,{},I),{horizontal:{},vertical:void 0}),We=ce.text;let it,et=[0,0];if(We){const ti=We.toString(),vi=N.get("text-letter-spacing").evaluate(ce,{},I)*Oo,Vt=N.get("text-line-height").evaluate(ce,{},I)*Oo,ni=Yr(ti)?vi:0,oi=N.get("text-anchor").evaluate(ce,{},I),fi=N.get("text-variable-anchor");if(!fi){const Oi=N.get("text-radial-offset").evaluate(ce,{},I);et=Oi?Dg(oi,[Oi*Oo,r4]):N.get("text-offset").evaluate(ce,{},I).map(Dr=>Dr*Oo)}let Ti=Q?"center":N.get("text-justify").evaluate(ce,{},I);const Jt=N.get("symbol-placement")==="point",Bi=Jt?N.get("text-max-width").evaluate(ce,{},I)*Oo:1/0,Ki=Oi=>{r.allowVerticalPlacement&&cn(ti)&&(Be.vertical=e4(We,e,n,f,we,Bi,Vt,oi,Oi,ni,et,pc.vertical,!0,He,Re))};if(!Q&&fi){const Oi=Ti==="auto"?fi.map(Ei=>n4(Ei)):[Ti];let Dr=!1;for(let Ei=0;Ei<Oi.length;Ei++){const ur=Oi[Ei];if(!Be.horizontal[ur])if(Dr)Be.horizontal[ur]=Be.horizontal[0];else{const Lr=e4(We,e,n,f,we,Bi,Vt,"center",ur,ni,et,pc.horizontal,!1,He,Re);Lr&&(Be.horizontal[ur]=Lr,Dr=Lr.positionedLines.length===1)}}Ki("left")}else{if(Ti==="auto"&&(Ti=n4(oi)),Jt||N.get("text-writing-mode").indexOf("horizontal")>=0||!cn(ti)){const Oi=e4(We,e,n,f,we,Bi,Vt,oi,Ti,ni,et,pc.horizontal,!1,He,Re);Oi&&(Be.horizontal[Ti]=Oi)}Ki(Jt?"left":Ti)}}let Ot=!1;if(ce.icon&&ce.icon.name){const ti=u[ce.icon.name];ti&&(it=Nv(f[ce.icon.name],N.get("icon-offset").evaluate(ce,{},I),N.get("icon-anchor").evaluate(ce,{},I)),Ot=ti.sdf,r.sdfIcons===void 0?r.sdfIcons=ti.sdf:r.sdfIcons!==ti.sdf&&sn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ti.pixelRatio!==r.pixelRatio||N.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const Lt=Rg(Be.horizontal)||Be.vertical;r.iconsInText||(r.iconsInText=!!Lt&&Lt.iconsInText),(Lt||it)&&Kv(r,ce,Be,it,u,W,He,0,et,Ot,b,I,R)}g&&r.generateCollisionDebugBuffers(z,r.collisionBoxArray)}function n4(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Kv(r,e,n,u,f,g,b,I,z,R,N,$,W){let Q=g.textMaxSize.evaluate(e,{},$);Q===void 0&&(Q=b);const te=r.layers[0].layout,ce=te.get("icon-offset").evaluate(e,{},$),we=Rg(n.horizontal)||n.vertical,Re=W.name==="globe",He=Oo,Be=b/He,We=r.tilePixelRatio*Q/He,it=(oi=r.overscaling,r.zoom>18&&oi>2&&(oi>>=1),Math.max(sr/(512*oi),1)*te.get("symbol-spacing")),et=te.get("text-padding")*r.tilePixelRatio,Ot=te.get("icon-padding")*r.tilePixelRatio,Lt=ki(te.get("text-max-angle")),ti=te.get("text-rotation-alignment")==="map"&&te.get("symbol-placement")!=="point",vi=te.get("icon-rotation-alignment")==="map"&&te.get("symbol-placement")!=="point",Vt=te.get("symbol-placement"),ni=it/2;var oi;const fi=te.get("icon-text-fit");let Ti;u&&fi!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(Ti=wg(u,n.vertical,fi,te.get("icon-text-fit-padding"),ce,Be)),we&&(u=wg(u,we,fi,te.get("icon-text-fit-padding"),ce,Be)));const Jt=(Bi,Ki,Oi)=>{if(Ki.x<0||Ki.x>=sr||Ki.y<0||Ki.y>=sr)return;let Dr=null;if(Re){const{x:Ei,y:ur,z:Lr}=W.projectTilePoint(Ki.x,Ki.y,Oi);Dr={anchor:new Qh(Ei,ur,Lr,0,void 0),up:W.upVector(Oi,Ki.x,Ki.y)}}(function(Ei,ur,Lr,mn,Rr,gr,Xn,Or,Ur,On,Gn,$n,Un,uo,bo,Uo,Nn,is,No,po,xn,Vo,Zn,Da,jo){const Vs=Ei.addToLineVertexArray(ur,mn);let zs,La,Ds,Iu,Yp,Uf,Nf,f7=0,m7=0,_7=0,g7=0,x4=-1,v4=-1;const gh={};let y7=gp("");const Wd=Lr?Lr.anchor:ur;let b4=0,w4=0;if(Ur._unevaluatedLayout.getValue("text-radial-offset")===void 0?[b4,w4]=Ur.layout.get("text-offset").evaluate(xn,{},jo).map(Bl=>Bl*Oo):(b4=Ur.layout.get("text-radial-offset").evaluate(xn,{},jo)*Oo,w4=r4),Ei.allowVerticalPlacement&&Rr.vertical){const Bl=Rr.vertical;if(bo)Uf=o4(Bl),Or&&(Nf=o4(Or));else{const Fl=Ur.layout.get("text-rotate").evaluate(xn,{},jo)+90;Ds=Vm(On,Wd,ur,Gn,$n,Un,Bl,uo,Fl,Uo),Or&&(Iu=Vm(On,Wd,ur,Gn,$n,Un,Or,is,Fl))}}if(gr){const Bl=Ur.layout.get("icon-rotate").evaluate(xn,{},jo),Fl=Ur.layout.get("icon-text-fit")!=="none",Vf=kg(gr,Bl,Zn,Fl),E4=Or?kg(Or,Bl,Zn,Fl):void 0;La=Vm(On,Wd,ur,Gn,$n,Un,gr,is,Bl),f7=4*Vf.length;const x7=Ei.iconSizeData;let Xd=null;x7.kind==="source"?(Xd=[zl*Ur.layout.get("icon-size").evaluate(xn,{},jo)],Xd[0]>j1&&sn(`${Ei.layerIds[0]}: Value for "icon-size" is >= ${kf}. Reduce your "icon-size".`)):x7.kind==="composite"&&(Xd=[zl*Vo.compositeIconSizes[0].evaluate(xn,{},jo),zl*Vo.compositeIconSizes[1].evaluate(xn,{},jo)],(Xd[0]>j1||Xd[1]>j1)&&sn(`${Ei.layerIds[0]}: Value for "icon-size" is >= ${kf}. Reduce your "icon-size".`)),Ei.addSymbols(Ei.icon,Vf,Xd,po,No,xn,!1,Lr,ur,Vs.lineStartIndex,Vs.lineLength,-1,Da,jo),x4=Ei.icon.placedSymbolArray.length-1,E4&&(m7=4*E4.length,Ei.addSymbols(Ei.icon,E4,Xd,po,No,xn,pc.vertical,Lr,ur,Vs.lineStartIndex,Vs.lineLength,-1,Da,jo),v4=Ei.icon.placedSymbolArray.length-1)}for(const Bl in Rr.horizontal){const Fl=Rr.horizontal[Bl];zs||(y7=gp(Fl.text),bo?Yp=o4(Fl):zs=Vm(On,Wd,ur,Gn,$n,Un,Fl,uo,Ur.layout.get("text-rotate").evaluate(xn,{},jo),Uo));const Vf=Fl.positionedLines.length===1;if(_7+=Lg(Ei,Lr,ur,Fl,Xn,Ur,bo,xn,Uo,Vs,Rr.vertical?pc.horizontal:pc.horizontalOnly,Vf?Object.keys(Rr.horizontal):[Bl],gh,x4,Vo,Da,jo),Vf)break}Rr.vertical&&(g7+=Lg(Ei,Lr,ur,Rr.vertical,Xn,Ur,bo,xn,Uo,Vs,pc.vertical,["vertical"],gh,v4,Vo,Da,jo));let X1=-1;const T4=(Bl,Fl)=>Bl?Math.max(Bl,Fl):Fl;X1=T4(Yp,X1),X1=T4(Uf,X1),X1=T4(Nf,X1);const Eb=X1>-1?1:0;Ei.glyphOffsetArray.length>=$1.MAX_GLYPHS&&sn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),xn.sortKey!==void 0&&Ei.addToSortKeyRanges(Ei.symbolInstances.length,xn.sortKey),Ei.symbolInstances.emplaceBack(Wd.x,Wd.y,Wd.z,ur.x,ur.y,gh.right>=0?gh.right:-1,gh.center>=0?gh.center:-1,gh.left>=0?gh.left:-1,gh.vertical>=0?gh.vertical:-1,x4,v4,y7,zs!==void 0?zs:Ei.collisionBoxArray.length,zs!==void 0?zs+1:Ei.collisionBoxArray.length,Ds!==void 0?Ds:Ei.collisionBoxArray.length,Ds!==void 0?Ds+1:Ei.collisionBoxArray.length,La!==void 0?La:Ei.collisionBoxArray.length,La!==void 0?La+1:Ei.collisionBoxArray.length,Iu||Ei.collisionBoxArray.length,Iu?Iu+1:Ei.collisionBoxArray.length,Gn,_7,g7,f7,m7,Eb,0,b4,w4,X1)})(r,Ki,Dr,Bi,n,u,f,Ti,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,et,ti,z,0,Ot,vi,ce,e,g,R,N,$)};if(Vt==="line")for(const Bi of Ig(e.geometry,0,0,sr,sr)){const Ki=jv(Bi,it,Lt,n.vertical||we,u,He,We,r.overscaling,sr);for(const Oi of Ki)we&&Yv(r,we.text,ni,Oi)||Jt(Bi,Oi,$)}else if(Vt==="line-center"){for(const Bi of e.geometry)if(Bi.length>1){const Ki=Vv(Bi,Lt,n.vertical||we,u,He,We);Ki&&Jt(Bi,Ki,$)}}else if(e.type==="Polygon")for(const Bi of h(e.geometry,0)){const Ki=qv(Bi,16);Jt(Bi[0],new Qh(Ki.x,Ki.y,0,0,void 0),$)}else if(e.type==="LineString")for(const Bi of e.geometry)Jt(Bi,new Qh(Bi[0].x,Bi[0].y,0,0,void 0),$);else if(e.type==="Point")for(const Bi of e.geometry)for(const Ki of Bi)Jt([Ki],new Qh(Ki.x,Ki.y,0,0,void 0),$)}const kf=255,j1=kf*zl;function Lg(r,e,n,u,f,g,b,I,z,R,N,$,W,Q,te,ce,we){const Re=function(We,it,et,Ot,Lt,ti,vi,Vt){const ni=[];if(it.positionedLines.length===0)return ni;const oi=Ot.layout.get("text-rotate").evaluate(ti,{})*Math.PI/180,fi=function(Oi){const Dr=Oi[0],Ei=Oi[1],ur=Dr*Ei;return ur>0?[Dr,-Ei]:ur<0?[-Dr,Ei]:Dr===0?[Ei,Dr]:[Ei,-Dr]}(et);let Ti=Math.abs(it.top-it.bottom);for(const Oi of it.positionedLines)Ti-=Oi.lineOffset;const Jt=it.positionedLines.length,Bi=Ti/Jt;let Ki=it.top-et[1];for(let Oi=0;Oi<Jt;++Oi){const Dr=it.positionedLines[Oi];Ki=Gv(it,Bi,Ki,Oi);for(const Ei of Dr.positionedGlyphs){if(!Ei.rect)continue;const ur=Ei.rect||{};let Lr=fg+1,mn=!0,Rr=1,gr=0;if(Ei.imageName){const Zn=vi[Ei.imageName];if(!Zn)continue;if(Zn.sdf){sn("SDF images are not supported in formatted text and will be ignored.");continue}mn=!1,Rr=Zn.pixelRatio,Lr=rl/Rr}const Xn=(Lt||Vt)&&Ei.vertical,Or=Ei.metrics.advance*Ei.scale/2,Ur=Ei.metrics,On=Ei.rect;if(On===null)continue;Vt&&it.verticalizable&&(gr=Ei.imageName?Or-Ei.metrics.width*Ei.scale/2:0);const Gn=Lt?[Ei.x+Or,Ei.y]:[0,0];let $n=[0,0],Un=[0,0],uo=!1;Lt||(Xn?(Un=[Ei.x+Or+fi[0],Ei.y+fi[1]-gr],uo=!0):$n=[Ei.x+Or+et[0],Ei.y+et[1]-gr]);const bo=On.w*Ei.scale/(Rr*(Ei.localGlyph?Mu:1)),Uo=On.h*Ei.scale/(Rr*(Ei.localGlyph?Mu:1));let Nn,is,No,po;if(Xn){const Zn=Ei.y-Ki,Da=new zt(-Or,Or-Zn),jo=-Math.PI/2,Vs=new zt(...Un);Nn=new zt(-Or+$n[0],$n[1]),Nn._rotateAround(jo,Da)._add(Vs),Nn.x+=-Zn+Or,Nn.y-=(Ur.left-Lr)*Ei.scale;const zs=Ei.imageName?Ur.advance*Ei.scale:Oo*Ei.scale,La=String.fromCharCode(Ei.glyph);H5(La)?Nn.x+=(1-Lr)*Ei.scale:K5(La)?Nn.x+=zs-Ur.height*Ei.scale+(-Lr-1)*Ei.scale:Nn.x+=Ei.imageName||Ur.width+2*Lr===On.w&&Ur.height+2*Lr===On.h?(zs-Uo)/2:(zs-(Ur.height+2*Lr)*Ei.scale)/2,is=new zt(Nn.x,Nn.y-bo),No=new zt(Nn.x+Uo,Nn.y),po=new zt(Nn.x+Uo,Nn.y-bo)}else{const Zn=(Ur.left-Lr)*Ei.scale-Or+$n[0],Da=(-Ur.top-Lr)*Ei.scale+$n[1],jo=Zn+bo,Vs=Da+Uo;Nn=new zt(Zn,Da),is=new zt(jo,Da),No=new zt(Zn,Vs),po=new zt(jo,Vs)}if(oi){let Zn;Zn=Lt?new zt(0,0):uo?new zt(fi[0],fi[1]):new zt(et[0],et[1]),Nn._rotateAround(oi,Zn),is._rotateAround(oi,Zn),No._rotateAround(oi,Zn),po._rotateAround(oi,Zn)}const xn=new zt(0,0),Vo=new zt(0,0);ni.push({tl:Nn,tr:is,bl:No,br:po,tex:ur,writingMode:it.writingMode,glyphOffset:Gn,sectionIndex:Ei.sectionIndex,isSDF:mn,pixelOffsetTL:xn,pixelOffsetBR:Vo,minFontScaleX:0,minFontScaleY:0})}}return ni}(0,u,z,g,b,I,f,r.allowVerticalPlacement),He=r.textSizeData;let Be=null;He.kind==="source"?(Be=[zl*g.layout.get("text-size").evaluate(I,{},we)],Be[0]>j1&&sn(`${r.layerIds[0]}: Value for "text-size" is >= ${kf}. Reduce your "text-size".`)):He.kind==="composite"&&(Be=[zl*te.compositeTextSizes[0].evaluate(I,{},we),zl*te.compositeTextSizes[1].evaluate(I,{},we)],(Be[0]>j1||Be[1]>j1)&&sn(`${r.layerIds[0]}: Value for "text-size" is >= ${kf}. Reduce your "text-size".`)),r.addSymbols(r.text,Re,Be,z,b,I,N,e,n,R.lineStartIndex,R.lineLength,Q,ce,we);for(const We of $)W[We]=r.text.placedSymbolArray.length-1;return 4*Re.length}function Rg(r){for(const e in r)return r[e];return null}function Vm(r,e,n,u,f,g,b,I,z,R){let N=b.top,$=b.bottom,W=b.left,Q=b.right;const te=b.collisionPadding;if(te&&(W-=te[0],N-=te[1],Q+=te[2],$+=te[3]),z){const ce=new zt(W,N),we=new zt(Q,N),Re=new zt(W,$),He=new zt(Q,$),Be=ki(z);let We=new zt(0,0);R&&(We=new zt(R[0],R[1])),ce._rotateAround(Be,We),we._rotateAround(Be,We),Re._rotateAround(Be,We),He._rotateAround(Be,We),W=Math.min(ce.x,we.x,Re.x,He.x),Q=Math.max(ce.x,we.x,Re.x,He.x),N=Math.min(ce.y,we.y,Re.y,He.y),$=Math.max(ce.y,we.y,Re.y,He.y)}return r.emplaceBack(e.x,e.y,e.z,n.x,n.y,W,N,Q,$,I,u,f,g),r.length-1}function o4(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const e=r.bottom-r.top;return e>0?Math.max(10,e):null}function Yv(r,e,n,u){const f=r.compareText;if(e in f){const g=f[e];for(let b=g.length-1;b>=0;b--)if(u.dist(g[b])<n)return!0}else f[e]=[];return f[e].push(u),!1}function Bg(r,e){const n=r.fovAboveCenter,u=r.elevation?r.elevation.getMinElevationBelowMSL()*e:0,f=(r._camera.position[2]*r.worldSize-u)/Math.cos(r._pitch),g=Math.sin(n)*f/Math.sin(Math.max(Math.PI/2-r._pitch-n,.01)),b=Math.sin(r._pitch)*g+f;return Math.min(1.01*b,f*(1/r._horizonShift))}function Zd(r,e){if(!e.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:e};const n=Math.pow(2,-r.z),u=r.x*n,f=(r.x+1)*n,g=r.y*n,b=(r.y+1)*n,I=Aa(u),z=Aa(f),R=us(g),N=us(b),$=e.project(I,R),W=e.project(z,R),Q=e.project(z,N),te=e.project(I,N);let ce=Math.min($.x,W.x,Q.x,te.x),we=Math.min($.y,W.y,Q.y,te.y),Re=Math.max($.x,W.x,Q.x,te.x),He=Math.max($.y,W.y,Q.y,te.y);const Be=n/16;function We(et,Ot,Lt,ti,vi,Vt){const ni=(Lt+vi)/2,oi=(ti+Vt)/2,fi=e.project(Aa(ni),us(oi)),Ti=Math.max(0,ce-fi.x,we-fi.y,fi.x-Re,fi.y-He);ce=Math.min(ce,fi.x),Re=Math.max(Re,fi.x),we=Math.min(we,fi.y),He=Math.max(He,fi.y),Ti>Be&&(We(et,fi,Lt,ti,ni,oi),We(fi,Ot,ni,oi,vi,Vt))}We($,W,u,g,f,g),We(W,Q,f,g,f,b),We(Q,te,f,b,u,b),We(te,$,u,b,u,g),ce-=Be,we-=Be,Re+=Be,He+=Be;const it=1/Math.max(Re-ce,He-we);return{scale:it,x:ce*it,y:we*it,x2:Re*it,y2:He*it,projection:e}}const Jv=nc(new Float32Array(16));class G1{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new gn(0,0)}projectTilePoint(e,n,u){return{x:e,y:n,z:0}}locationPoint(e,n,u=!0){return e._coordinatePoint(e.locationCoordinate(n),u)}pixelsPerMeter(e,n){return uc(1,e)*n}pixelSpaceConversion(e,n,u){return 1}farthestPixelDistance(e){return Bg(e,e.pixelsPerMeter)}pointCoordinate(e,n,u,f){const g=e.horizonLineFromTop(!1),b=new zt(n,Math.max(g,u));return e.rayIntersectionCoordinate(e.pointRayIntersection(b,f))}pointCoordinate3D(e,n,u){const f=new zt(n,u);if(e.elevation)return e.elevation.pointCoordinate(f);{const g=this.pointCoordinate(e,f.x,f.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const u=e.horizonLineFromTop();return n.y<u}createInversionMatrix(e,n){return Jv}createTileMatrix(e,n,u){let f,g,b;const I=u.canonical,z=nc(new Float64Array(16));if(this.isReprojectedInTileSpace){const R=Zd(I,this);f=1,g=R.x+u.wrap*R.scale,b=R.y,Gh(z,z,[f/R.scale,f/R.scale,e.pixelsPerMeter/n])}else f=n/e.zoomScale(I.z),g=(I.x+Math.pow(2,I.z)*u.wrap)*f,b=I.y*f;return jh(z,z,[g,b,0]),Gh(z,z,[f/sr,f/sr,1]),z}upVector(e,n,u){return[0,0,1]}upVectorScale(e,n,u){return{metersToTile:1}}}class Qv extends G1{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,u]=this.parallels=e.parallels||[29.5,45.5],f=Math.sin(ki(n));this.n=(f+Math.sin(ki(u)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:u,c:f,r0:g}=this,b=ki(e-this.center[0]),I=ki(n),z=Math.sqrt(f-2*u*Math.sin(I))/u;return{x:z*Math.sin(b*u),y:z*Math.cos(b*u)-g,z:0}}unproject(e,n){const{n:u,c:f,r0:g}=this,b=g+n;let I=Math.atan2(e,Math.abs(b))*Math.sign(b);b*u<0&&(I-=Math.PI*Math.sign(e)*Math.sign(b));const z=ki(this.center[0])*u;I=Si(I,-Math.PI-z,Math.PI-z);const R=pt(fr(I/u)+this.center[0],-180,180),N=Math.asin(pt((f-(e*e+b*b)*u*u)/(2*u),-1,1)),$=pt(fr(N),-es,es);return new gn(R,$)}}const zf=1.340264,Df=-.081106,Lf=893e-6,Rf=.003796,jm=Math.sqrt(3)/2;class eb extends G1{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const u=Math.asin(jm*Math.sin(n)),f=u*u,g=f*f*f;return{x:.5*(e*Math.cos(u)/(jm*(zf+3*Df*f+g*(7*Lf+9*Rf*f)))/Math.PI+.5),y:1-.5*(u*(zf+Df*f+g*(Lf+Rf*f))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let u=n=(2*(1-n)-1)*Math.PI,f=u*u,g=f*f*f;for(let N,$,W,Q=0;Q<12&&($=u*(zf+Df*f+g*(Lf+Rf*f))-n,W=zf+3*Df*f+g*(7*Lf+9*Rf*f),N=$/W,u=pt(u-N,-Math.PI/3,Math.PI/3),f=u*u,g=f*f*f,!(Math.abs(N)<1e-12));++Q);const b=jm*e*(zf+3*Df*f+g*(7*Lf+9*Rf*f))/Math.cos(u),I=Math.asin(Math.sin(u)/jm),z=pt(180*b/Math.PI,-180,180),R=pt(180*I/Math.PI,-es,es);return new gn(z,R)}}class tb extends G1{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const u=360*(e-.5),f=pt(360*(.5-n),-es,es);return new gn(u,f)}}const Hp=Math.PI/2;function Gm(r){return Math.tan((Hp+r)/2)}class ib extends G1{constructor(e){super(e),this.center=e.center||[0,30];const[n,u]=this.parallels=e.parallels||[30,30];let f=ki(n),g=ki(u);this.southernCenter=f+g<0,this.southernCenter&&(f=-f,g=-g);const b=Math.cos(f),I=Gm(f);this.n=f===g?Math.sin(f):Math.log(b/Math.cos(g))/Math.log(Gm(g)/I),this.f=b*Math.pow(Gm(f),this.n)/this.n}project(e,n){n=ki(n),this.southernCenter&&(n=-n),e=ki(e-this.center[0]);const u=1e-6,{n:f,f:g}=this;g>0?n<-Hp+u&&(n=-Hp+u):n>Hp-u&&(n=Hp-u);const b=g/Math.pow(Gm(n),f);let I=b*Math.sin(f*e),z=g-b*Math.cos(f*e);return I=.5*(I/Math.PI+.5),z=.5*(z/Math.PI+.5),{x:I,y:this.southernCenter?z:1-z,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:u,f}=this,g=f-n,b=Math.sign(g),I=Math.sign(u)*Math.sqrt(e*e+g*g);let z=Math.atan2(e,Math.abs(g))*b;g*u<0&&(z-=Math.PI*Math.sign(e)*b);const R=pt(fr(z/u)+this.center[0],-180,180),N=pt(fr(2*Math.atan(Math.pow(f/I,1/u))-Hp),-es,es);return new gn(R,this.southernCenter?-N:N)}}class Fg extends G1{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:lc(e),y:cc(n),z:0}}unproject(e,n){const u=Aa(e),f=us(n);return new gn(u,f)}}const Og=ki(es);class rb extends G1{project(e,n){const u=(n=ki(n))*n,f=u*u;return{x:.5*((e=ki(e))*(.8707-.131979*u+f*(f*(.003971*u-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+u*(.015085+f*(.028874*u-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let u=n=(2*(1-n)-1)*Math.PI,f=25,g=0,b=u*u;do{b=u*u;const R=b*b;g=(u*(1.007226+b*(.015085+R*(.028874*b-.044475-.005916*R)))-n)/(1.007226+b*(.045255+R*(.259866*b-.311325-.005916*11*R))),u=pt(u-g,-Og,Og)}while(Math.abs(g)>1e-6&&--f>0);b=u*u;const I=pt(fr(e/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),z=fr(u);return new gn(I,z)}}const Ug=ki(es);class nb extends G1{project(e,n){n=ki(n),e=ki(e);const u=Math.cos(n),f=2/Math.PI,g=Math.acos(u*Math.cos(e/2)),b=Math.sin(g)/g,I=.5*(e*f+2*u*Math.sin(e/2)/b)||0,z=.5*(n+Math.sin(n)/b)||0;return{x:.5*(I/Math.PI+.5),y:1-.5*(z/Math.PI+1),z:0}}unproject(e,n){let u=e=(2*e-.5)*Math.PI,f=n=(2*(1-n)-1)*Math.PI,g=25;const b=1e-6;let I=0,z=0;do{const R=Math.cos(f),N=Math.sin(f),$=2*N*R,W=N*N,Q=R*R,te=Math.cos(u/2),ce=Math.sin(u/2),we=2*te*ce,Re=ce*ce,He=1-Q*te*te,Be=He?1/He:0,We=He?Math.acos(R*te)*Math.sqrt(1/He):0,it=.5*(2*We*R*ce+2*u/Math.PI)-e,et=.5*(We*N+f)-n,Ot=.5*Be*(Q*Re+We*R*te*W)+1/Math.PI,Lt=Be*(we*$/4-We*N*ce),ti=.125*Be*($*ce-We*N*Q*we),vi=.5*Be*(W*te+We*Re*R)+.5,Vt=Lt*ti-vi*Ot;I=(et*Lt-it*vi)/Vt,z=(it*ti-et*Ot)/Vt,u=pt(u-I,-Math.PI,Math.PI),f=pt(f-z,-Ug,Ug)}while((Math.abs(I)>b||Math.abs(z)>b)&&--g>0);return new gn(fr(u),fr(f))}}class Ng extends G1{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ki(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:u,cosPhi:f}=this;return{x:ki(e)*f*u+.5,y:-Math.sin(ki(n))/f*u+.5,z:0}}unproject(e,n){const{scale:u,cosPhi:f}=this,g=-(n-.5)/u,b=pt(fr((e-.5)/u)/f,-180,180),I=Math.asin(pt(g*f,-1,1)),z=pt(fr(I),-es,es);return new gn(b,z)}}class ob extends Fg{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,n,u){const f=Rd(e,n,u);return oo(f,f,Nc(pa(u))),{x:f[0],y:f[1],z:f[2]}}locationPoint(e,n){const u=P1(n.lat,n.lng),f=Js([],u),g=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude;zd(u,u,f,uc(1,0)*sr*g);const b=nc(new Float64Array(16));return xu(b,e.pixelMatrix,e.globeMatrix),oo(u,u,b),new zt(u[0],u[1])}pixelsPerMeter(e,n){return uc(1,0)*n}pixelSpaceConversion(e,n,u){const f=uc(1,e)*n,g=Kr(uc(1,45)*n,f,u);return this.pixelsPerMeter(e,n)/g}createTileMatrix(e,n,u){const f=Sp(pa(u.canonical));return xu(new Float64Array(16),e.globeMatrix,f)}createInversionMatrix(e,n){const{center:u}=e,f=Nc(pa(n));return wp(f,f,ki(u.lng)),W0(f,f,ki(u.lat)),Gh(f,f,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(e,n,u,f){return af(e,n,u,!0)||new z1(0,0)}pointCoordinate3D(e,n,u){const f=this.pointCoordinate(e,n,u,0);return[f.x,f.y,f.z]}isPointAboveHorizon(e,n){return!af(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(f,g){const b=f.cameraToCenterDistance,I=f._centerAltitude*g,z=f._camera,R=f._camera.forward(),N=vu([],tl([],R,-b),[0,0,I]),$=f.worldSize/(2*Math.PI),W=[0,0,-$],Q=f.width/f.height,te=Math.tan(f.fovAboveCenter),ce=tl([],z.up(),te),we=tl([],z.right(),te*Q),Re=Js([],vu([],vu([],R,ce),we)),He=[];let Be;if(new rf(N,Re).closestPointOnSphere(W,$,He)){const We=vu([],He,W),it=oc([],We,N);Be=Math.cos(f.fovAboveCenter)*Uc(it)}else{const We=oc([],N,W),it=oc([],W,N);Js(it,it);const et=Uc(We)-$;Be=Math.sqrt(et*(et+2*$));const Ot=Math.acos(Be/($+et))-Math.acos(Ca(R,it));Be*=Math.cos(Ot)}return 1.01*Be}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),u=k1(e.zoom);if(u>0){const f=Bg(e,uc(1,e.center.lat)*e.worldSize),g=e.worldSize/(2*Math.PI),b=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Kr(n,f+g*(1-Math.cos(b)),Math.pow(u,10))}return n}upVector(e,n,u){return Rd(n,u,e,1)}upVectorScale(e){return{metersToTile:I1(Ep(pa(e)))}}}function Vg(r){const e=r.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(r.name){case"mercator":return new Fg(r);case"equirectangular":return new tb(r);case"naturalEarth":return new rb(r);case"equalEarth":return new eb(r);case"winkelTripel":return new nb(r);case"albers":return n?new Ng(r):new Qv(r);case"lambertConformalConic":return n?new Ng(r):new ib(r);case"globe":return new ob(r)}throw new Error(`Invalid projection name: ${r.name}`)}const sb=Li.types,ab=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function $m(r,e,n,u,f,g,b,I,z,R,N,$,W){const Q=I?Math.min(j1,Math.round(I[0])):0,te=I?Math.min(j1,Math.round(I[1])):0;r.emplaceBack(e,n,Math.round(32*u),Math.round(32*f),g,b,(Q<<1)+(z?1:0),te,16*R,16*N,256*$,256*W)}function Zm(r,e,n,u,f,g,b){r.emplaceBack(e,n,u,f,g,b)}function qm(r,e,n,u,f){r.emplaceBack(e,n,u,f),r.emplaceBack(e,n,u,f),r.emplaceBack(e,n,u,f),r.emplaceBack(e,n,u,f)}function lb(r){for(const e of r.sections)if(Ea(e.text))return!0;return!1}class s4{constructor(e){this.layoutVertexArray=new si,this.indexArray=new er,this.programConfigurations=e,this.segments=new co,this.dynamicLayoutVertexArray=new mi,this.opacityVertexArray=new or,this.placedSymbolArray=new lo,this.globeExtVertexArray=new xi}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,u,f){this.isEmpty()||(u&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jd.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Tf.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ab,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Lm.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||f)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ft(s4,"SymbolBuffers");class a4{constructor(e,n,u){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new u,this.segments=new co,this.collisionVertexArray=new Zr,this.collisionVertexArrayExt=new Fr}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ef.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Su.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ft(a4,"CollisionBuffers");class $1{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(b=>b.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=nc([]),this.placementViewportMatrix=nc([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Cf(this.zoom,n["text-size"]),this.iconSizeData=Cf(this.zoom,n["icon-size"]);const u=this.layers[0].layout,f=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(b=>pc[b]),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new s4(new Vh(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new s4(new Vh(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Ys,this.lineVertexArray=new Uh,this.symbolInstances=new In}calculateGlyphDependencies(e,n,u,f,g){for(let b=0;b<e.length;b++)if(n[e.charCodeAt(b)]=!0,f&&g){const I=Gd[e.charAt(b)];I&&(n[I.charCodeAt(0)]=!0)}}populate(e,n,u,f){const g=this.layers[0],b=g.layout,I=this.projection.name==="globe",z=b.get("text-font"),R=b.get("text-field"),N=b.get("icon-image"),$=(R.value.kind!=="constant"||R.value.value instanceof Ho&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(z.value.kind!=="constant"||z.value.value.length>0),W=N.value.kind!=="constant"||!!N.value.value||Object.keys(N.parameters).length>0,Q=b.get("symbol-sort-key");if(this.features=[],!$&&!W)return;const te=n.iconDependencies,ce=n.glyphDependencies,we=n.availableImages,Re=new G(this.zoom);for(const{feature:He,id:Be,index:We,sourceLayerIndex:it}of e){const et=g._featureFilter.needGeometry,Ot=Wh(He,et);if(!g._featureFilter.filter(Re,Ot,u))continue;if(et||(Ot.geometry=jc(He,u,f)),I&&He.type!==1&&u.z<=5){const Vt=Ot.geometry,ni=.98078528056,oi=(fi,Ti)=>Ca(Rd(fi.x,fi.y,u,1),Rd(Ti.x,Ti.y,u,1))<ni;for(let fi=0;fi<Vt.length;fi++)Vt[fi]=ch(Vt[fi],oi)}let Lt,ti;if($){const Vt=g.getValueAndResolveTokens("text-field",Ot,u,we),ni=Ho.factory(Vt);lb(ni)&&(this.hasRTLText=!0),(!this.hasRTLText||A()==="unavailable"||this.hasRTLText&&O.isParsed())&&(Lt=X5(ni,g,Ot))}if(W){const Vt=g.getValueAndResolveTokens("icon-image",Ot,u,we);ti=Vt instanceof ws?Vt:ws.fromString(Vt)}if(!Lt&&!ti)continue;const vi=this.sortFeaturesByKey?Q.evaluate(Ot,{},u):void 0;if(this.features.push({id:Be,text:Lt,icon:ti,index:We,sourceLayerIndex:it,geometry:Ot.geometry,properties:He.properties,type:sb[He.type],sortKey:vi}),ti&&(te[ti.name]=!0),Lt){const Vt=z.evaluate(Ot,{},u).join(","),ni=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(pc.vertical)>=0;for(const oi of Lt.sections)if(oi.image)te[oi.image.name]=!0;else{const fi=cn(Lt.toString()),Ti=oi.fontStack||Vt,Jt=ce[Ti]=ce[Ti]||{};this.calculateGlyphDependencies(oi.text,Jt,ni,this.allowVerticalPlacement,fi)}}}b.get("symbol-placement")==="line"&&(this.features=function(He){const Be={},We={},it=[];let et=0;function Ot(Vt){it.push(He[Vt]),et++}function Lt(Vt,ni,oi){const fi=We[Vt];return delete We[Vt],We[ni]=fi,it[fi].geometry[0].pop(),it[fi].geometry[0]=it[fi].geometry[0].concat(oi[0]),fi}function ti(Vt,ni,oi){const fi=Be[ni];return delete Be[ni],Be[Vt]=fi,it[fi].geometry[0].shift(),it[fi].geometry[0]=oi[0].concat(it[fi].geometry[0]),fi}function vi(Vt,ni,oi){const fi=oi?ni[0][ni[0].length-1]:ni[0][0];return`${Vt}:${fi.x}:${fi.y}`}for(let Vt=0;Vt<He.length;Vt++){const ni=He[Vt],oi=ni.geometry,fi=ni.text?ni.text.toString():null;if(!fi){Ot(Vt);continue}const Ti=vi(fi,oi),Jt=vi(fi,oi,!0);if(Ti in We&&Jt in Be&&We[Ti]!==Be[Jt]){const Bi=ti(Ti,Jt,oi),Ki=Lt(Ti,Jt,it[Bi].geometry);delete Be[Ti],delete We[Jt],We[vi(fi,it[Ki].geometry,!0)]=Ki,it[Bi].geometry=null}else Ti in We?Lt(Ti,Jt,oi):Jt in Be?ti(Ti,Jt,oi):(Ot(Vt),Be[Ti]=et-1,We[Jt]=et-1)}return it.filter(Vt=>Vt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((He,Be)=>He.sortKey-Be.sortKey)}update(e,n,u,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,u,f),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,u,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Vg(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const u=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:f,y:g}of n)this.lineVertexArray.emplaceBack(f,g);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(e,n,u,f,g,b,I,z,R,N,$,W,Q,te){const ce=e.indexArray,we=e.layoutVertexArray,Re=e.globeExtVertexArray,He=e.segments.prepareSegment(4*n.length,we,ce,this.canOverlap?b.sortKey:void 0),Be=this.glyphOffsetArray.length,We=He.vertexLength,it=this.allowVerticalPlacement&&I===pc.vertical?Math.PI/2:0,et=b.text&&b.text.sections;for(let Lt=0;Lt<n.length;Lt++){const{tl:ti,tr:vi,bl:Vt,br:ni,tex:oi,pixelOffsetTL:fi,pixelOffsetBR:Ti,minFontScaleX:Jt,minFontScaleY:Bi,glyphOffset:Ki,isSDF:Oi,sectionIndex:Dr}=n[Lt],Ei=He.vertexLength,ur=Ki[1];if($m(we,R.x,R.y,ti.x,ur+ti.y,oi.x,oi.y,u,Oi,fi.x,fi.y,Jt,Bi),$m(we,R.x,R.y,vi.x,ur+vi.y,oi.x+oi.w,oi.y,u,Oi,Ti.x,fi.y,Jt,Bi),$m(we,R.x,R.y,Vt.x,ur+Vt.y,oi.x,oi.y+oi.h,u,Oi,fi.x,Ti.y,Jt,Bi),$m(we,R.x,R.y,ni.x,ur+ni.y,oi.x+oi.w,oi.y+oi.h,u,Oi,Ti.x,Ti.y,Jt,Bi),z){const{x:Lr,y:mn,z:Rr}=z.anchor,[gr,Xn,Or]=z.up;Zm(Re,Lr,mn,Rr,gr,Xn,Or),Zm(Re,Lr,mn,Rr,gr,Xn,Or),Zm(Re,Lr,mn,Rr,gr,Xn,Or),Zm(Re,Lr,mn,Rr,gr,Xn,Or),qm(e.dynamicLayoutVertexArray,Lr,mn,Rr,it)}else qm(e.dynamicLayoutVertexArray,R.x,R.y,R.z,it);ce.emplaceBack(Ei,Ei+1,Ei+2),ce.emplaceBack(Ei+1,Ei+2,Ei+3),He.vertexLength+=4,He.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ki[0]),Lt!==n.length-1&&Dr===n[Lt+1].sectionIndex||e.programConfigurations.populatePaintArrays(we.length,b,b.index,{},Q,te,et&&et[Dr])}const Ot=z?z.anchor:R;e.placedSymbolArray.emplaceBack(Ot.x,Ot.y,Ot.z,R.x,R.y,Be,this.glyphOffsetArray.length-Be,We,N,$,R.segment,u?u[0]:0,u?u[1]:0,f[0],f[1],I,0,!1,0,W,0)}_commitLayoutVertex(e,n,u,f,g,b,I){e.emplaceBack(n,u,f,g,b,Math.round(I.x),Math.round(I.y))}_addCollisionDebugVertices(e,n,u,f,g,b,I){const z=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),R=z.vertexLength,N=I.tileAnchorX,$=I.tileAnchorY;for(let Q=0;Q<4;Q++)u.collisionVertexArray.emplaceBack(0,0,0,0);u.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),u.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),u.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),u.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(u.layoutVertexArray,f,g,b,N,$,new zt(e.x1,e.y1)),this._commitLayoutVertex(u.layoutVertexArray,f,g,b,N,$,new zt(e.x2,e.y1)),this._commitLayoutVertex(u.layoutVertexArray,f,g,b,N,$,new zt(e.x2,e.y2)),this._commitLayoutVertex(u.layoutVertexArray,f,g,b,N,$,new zt(e.x1,e.y2)),z.vertexLength+=4;const W=u.indexArray;W.emplaceBack(R,R+1),W.emplaceBack(R+1,R+2),W.emplaceBack(R+2,R+3),W.emplaceBack(R+3,R),z.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,u,f,g,b){for(let I=f;I<g;I++){const z=u.get(I),R=this.getSymbolInstanceTextSize(e,b,n,I);this._addCollisionDebugVertices(z,R,this.textCollisionBox,z.projectedAnchorX,z.projectedAnchorY,z.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(e,n,u,f,g,b){for(let I=f;I<g;I++){const z=u.get(I),R=this.getSymbolInstanceIconSize(e,n,b.placedIconSymbolIndex);this._addCollisionDebugVertices(z,R,this.iconCollisionBox,z.projectedAnchorX,z.projectedAnchorY,z.projectedAnchorZ,b)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new a4(Xi,Sf.members,go),this.iconCollisionBox=new a4(Xi,Sf.members,go);const u=U1(this.iconSizeData,e),f=U1(this.textSizeData,e);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(f,e,n,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(f,e,n,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(u,e,n,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(u,e,n,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(e,n,u,f){const g=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:f),b=jp(this.textSizeData,e,g)/Oo;return this.tilePixelRatio*b}getSymbolInstanceIconSize(e,n,u){const f=this.icon.placedSymbolArray.get(u),g=jp(this.iconSizeData,e,f);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(e,n,u){e.emplaceBack(n,-u,-u),e.emplaceBack(n,u,-u),e.emplaceBack(n,u,u),e.emplaceBack(n,-u,u)}_updateTextDebugCollisionBoxes(e,n,u,f,g,b){for(let I=f;I<g;I++){const z=u.get(I),R=this.getSymbolInstanceTextSize(e,b,n,I);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,R,z.padding)}}_updateIconDebugCollisionBoxes(e,n,u,f,g,b){for(let I=f;I<g;I++){const z=u.get(I),R=this.getSymbolInstanceIconSize(e,n,b);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,R,z.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=U1(this.iconSizeData,e),f=U1(this.textSizeData,e);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(f,e,n,b.textBoxStartIndex,b.textBoxEndIndex,b),this._updateTextDebugCollisionBoxes(f,e,n,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._updateIconDebugCollisionBoxes(u,e,n,b.iconBoxStartIndex,b.iconBoxEndIndex,b.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(u,e,n,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,u,f,g,b,I,z,R){const N={};if(n<u){const{x1:$,y1:W,x2:Q,y2:te,padding:ce,projectedAnchorX:we,projectedAnchorY:Re,projectedAnchorZ:He,tileAnchorX:Be,tileAnchorY:We,featureIndex:it}=e.get(n);N.textBox={x1:$,y1:W,x2:Q,y2:te,padding:ce,projectedAnchorX:we,projectedAnchorY:Re,projectedAnchorZ:He,tileAnchorX:Be,tileAnchorY:We},N.textFeatureIndex=it}if(f<g){const{x1:$,y1:W,x2:Q,y2:te,padding:ce,projectedAnchorX:we,projectedAnchorY:Re,projectedAnchorZ:He,tileAnchorX:Be,tileAnchorY:We,featureIndex:it}=e.get(f);N.verticalTextBox={x1:$,y1:W,x2:Q,y2:te,padding:ce,projectedAnchorX:we,projectedAnchorY:Re,projectedAnchorZ:He,tileAnchorX:Be,tileAnchorY:We},N.verticalTextFeatureIndex=it}if(b<I){const{x1:$,y1:W,x2:Q,y2:te,padding:ce,projectedAnchorX:we,projectedAnchorY:Re,projectedAnchorZ:He,tileAnchorX:Be,tileAnchorY:We,featureIndex:it}=e.get(b);N.iconBox={x1:$,y1:W,x2:Q,y2:te,padding:ce,projectedAnchorX:we,projectedAnchorY:Re,projectedAnchorZ:He,tileAnchorX:Be,tileAnchorY:We},N.iconFeatureIndex=it}if(z<R){const{x1:$,y1:W,x2:Q,y2:te,padding:ce,projectedAnchorX:we,projectedAnchorY:Re,projectedAnchorZ:He,tileAnchorX:Be,tileAnchorY:We,featureIndex:it}=e.get(z);N.verticalIconBox={x1:$,y1:W,x2:Q,y2:te,padding:ce,projectedAnchorX:we,projectedAnchorY:Re,projectedAnchorZ:He,tileAnchorX:Be,tileAnchorY:We},N.verticalIconFeatureIndex=it}return N}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const u=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const u=e.placedSymbolArray.get(n),f=u.vertexStartIndex+4*u.numGlyphs;for(let g=u.vertexStartIndex;g<f;g+=4)e.indexArray.emplaceBack(g,g+1,g+2),e.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),u=Math.cos(e),f=[],g=[],b=[];for(let I=0;I<this.symbolInstances.length;++I){b.push(I);const z=this.symbolInstances.get(I);f.push(0|Math.round(n*z.tileAnchorX+u*z.tileAnchorY)),g.push(z.featureIndex)}return b.sort((I,z)=>f[I]-f[z]||g[z]-g[I]),b}addToSortKeyRanges(e,n){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===n?u.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const u=this.symbolInstances.get(n);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:I,placedIconSymbolIndex:z,verticalPlacedIconSymbolIndex:R}=u;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&g!==f&&this.addIndicesForPlacedSymbol(this.text,g),b>=0&&b!==g&&b!==f&&this.addIndicesForPlacedSymbol(this.text,b),I>=0&&this.addIndicesForPlacedSymbol(this.text,I),z>=0&&this.addIndicesForPlacedSymbol(this.icon,z),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ft($1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),$1.MAX_GLYPHS=65535,$1.addDynamicAttributes=qm;const cb=new Ge({"symbol-placement":new ae(It.layout_symbol["symbol-placement"]),"symbol-spacing":new ae(It.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ae(It.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Me(It.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ae(It.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ae(It.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ae(It.layout_symbol["icon-ignore-placement"]),"icon-optional":new ae(It.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ae(It.layout_symbol["icon-rotation-alignment"]),"icon-size":new Me(It.layout_symbol["icon-size"]),"icon-text-fit":new ae(It.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ae(It.layout_symbol["icon-text-fit-padding"]),"icon-image":new Me(It.layout_symbol["icon-image"]),"icon-rotate":new Me(It.layout_symbol["icon-rotate"]),"icon-padding":new ae(It.layout_symbol["icon-padding"]),"icon-keep-upright":new ae(It.layout_symbol["icon-keep-upright"]),"icon-offset":new Me(It.layout_symbol["icon-offset"]),"icon-anchor":new Me(It.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ae(It.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ae(It.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ae(It.layout_symbol["text-rotation-alignment"]),"text-field":new Me(It.layout_symbol["text-field"]),"text-font":new Me(It.layout_symbol["text-font"]),"text-size":new Me(It.layout_symbol["text-size"]),"text-max-width":new Me(It.layout_symbol["text-max-width"]),"text-line-height":new Me(It.layout_symbol["text-line-height"]),"text-letter-spacing":new Me(It.layout_symbol["text-letter-spacing"]),"text-justify":new Me(It.layout_symbol["text-justify"]),"text-radial-offset":new Me(It.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ae(It.layout_symbol["text-variable-anchor"]),"text-anchor":new Me(It.layout_symbol["text-anchor"]),"text-max-angle":new ae(It.layout_symbol["text-max-angle"]),"text-writing-mode":new ae(It.layout_symbol["text-writing-mode"]),"text-rotate":new Me(It.layout_symbol["text-rotate"]),"text-padding":new ae(It.layout_symbol["text-padding"]),"text-keep-upright":new ae(It.layout_symbol["text-keep-upright"]),"text-transform":new Me(It.layout_symbol["text-transform"]),"text-offset":new Me(It.layout_symbol["text-offset"]),"text-allow-overlap":new ae(It.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ae(It.layout_symbol["text-ignore-placement"]),"text-optional":new ae(It.layout_symbol["text-optional"])});var l4={paint:new Ge({"icon-opacity":new Me(It.paint_symbol["icon-opacity"]),"icon-color":new Me(It.paint_symbol["icon-color"]),"icon-halo-color":new Me(It.paint_symbol["icon-halo-color"]),"icon-halo-width":new Me(It.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Me(It.paint_symbol["icon-halo-blur"]),"icon-translate":new ae(It.paint_symbol["icon-translate"]),"icon-translate-anchor":new ae(It.paint_symbol["icon-translate-anchor"]),"text-opacity":new Me(It.paint_symbol["text-opacity"]),"text-color":new Me(It.paint_symbol["text-color"],{runtimeType:ss,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Me(It.paint_symbol["text-halo-color"]),"text-halo-width":new Me(It.paint_symbol["text-halo-width"]),"text-halo-blur":new Me(It.paint_symbol["text-halo-blur"]),"text-translate":new ae(It.paint_symbol["text-translate"]),"text-translate-anchor":new ae(It.paint_symbol["text-translate-anchor"])}),layout:cb};class jg{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:$l,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft(jg,"FormatSectionOverride",{omit:["defaultValue"]});class Wm extends Il{constructor(e){super(e,l4)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const f=[];for(const g of u)f.indexOf(g)<0&&f.push(g);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,u,f){const g=this.layout.get(e).evaluate(n,{},u,f),b=this._unevaluatedLayout._values[e];return b.isDataDriven()||wl(b.value)||!g?g:function(I,z){return z.replace(/{([^{}]+)}/g,(R,N)=>N in I?String(I[N]):"")}(n.properties,g)}createBucket(e){return new $1(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of l4.paint.overridableProperties){if(!Wm.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),u=new jg(n),f=new Xa(u,n.property.specification);let g=null;g=n.value.kind==="constant"||n.value.kind==="source"?new ih("source",f):new Jo("composite",f,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new Ce(n.property,g,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,u){return!(!this.layout||n.isDataDriven()||u.isDataDriven())&&Wm.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const u=e.get("text-field"),f=l4.paint.properties[n];let g=!1;const b=I=>{for(const z of I)if(f.overrides&&f.overrides.hasOverride(z))return void(g=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Ho)b(u.value.value.sections);else if(u.value.kind==="source"){const I=R=>{g||(R instanceof sa&&_r(R.value)===na?b(R.value.sections):R instanceof la?b(R.sections):R.eachChild(I))},z=u.value;z._styleExpression&&I(z._styleExpression.expression)}return g}getProgramConfiguration(e){return new el(this,e)}}var ub={paint:new Ge({"background-color":new ae(It.paint_background["background-color"]),"background-pattern":new ae(It.paint_background["background-pattern"]),"background-opacity":new ae(It.paint_background["background-opacity"])})},hb={paint:new Ge({"raster-opacity":new ae(It.paint_raster["raster-opacity"]),"raster-hue-rotate":new ae(It.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ae(It.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ae(It.paint_raster["raster-brightness-max"]),"raster-saturation":new ae(It.paint_raster["raster-saturation"]),"raster-contrast":new ae(It.paint_raster["raster-contrast"]),"raster-resampling":new ae(It.paint_raster["raster-resampling"]),"raster-fade-duration":new ae(It.paint_raster["raster-fade-duration"])})};class db extends Il{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var pb={paint:new Ge({"sky-type":new ae(It.paint_sky["sky-type"]),"sky-atmosphere-sun":new ae(It.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ae(It.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ae(It.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ae(It.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ue(It.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ae(It.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ae(It.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ae(It.paint_sky["sky-opacity"])})};function c4(r,e,n){const u=[0,0,1],f=om([]);return J0(f,f,n?-ki(r)+Math.PI:ki(r)),sm(f,f,-ki(e)),em(u,u,f),Js(u,u)}const fb={circle:class extends Il{constructor(r){super(r,vm)}createBucket(r){return new Lp(r)}queryRadius(r){const e=r;return Kh("circle-radius",this,e)+Kh("circle-stroke-width",this,e)+L1(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,n,u,f,g,b,I){const z=Tu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,r.pixelToTileUnitsFactor),R=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return bm(r,u,g,b,I,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",z,R)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new el(this,r)}},heatmap:class extends Il{createBucket(r){return new Tm(r)}constructor(r){super(r,Em),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=R1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return Kh("heatmap-radius",this,r)}queryIntersectsFeature(r,e,n,u,f,g,b,I){const z=this.paint.get("heatmap-radius").evaluate(e,n);return bm(r,u,g,b,I,!0,!0,new zt(0,0),z)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new el(this,r)}},hillshade:class extends Il{constructor(r){super(r,_f)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Il{constructor(r){super(r,Z)}getProgramIds(){const r=this.paint.get("fill-pattern"),e=r&&r.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(r){return new el(this,r)}recalculate(r,e){super.recalculate(r,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new L(r)}queryRadius(){return L1(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,n,u,f,g){return!r.queryGeometry.isAboveHorizon&&df(ym(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,r.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends Il{constructor(r){super(r,fa)}createBucket(r){return new zr(r)}queryRadius(){return L1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new el(this,r)}queryIntersectsFeature(r,e,n,u,f,g,b,I,z){const R=Tu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,r.pixelToTileUnitsFactor),N=this.paint.get("fill-extrusion-height").evaluate(e,n),$=this.paint.get("fill-extrusion-base").evaluate(e,n),W=[0,0],Q=I&&g.elevation,te=g.elevation?g.elevation.exaggeration():1,ce=r.tile.getBucket(this);if(Q&&ce instanceof zr){const We=ce.centroidVertexArray,it=z+1;it<We.length&&(W[0]=We.geta_centroid_pos0(it),W[1]=We.geta_centroid_pos1(it))}if(W[0]===0&&W[1]===1)return!1;g.projection.name==="globe"&&(u=ds([u],[new zt(0,0),new zt(sr,sr)],r.tileID.canonical).map(We=>We.polygon).flat());const we=Q?I:null,[Re,He]=function(We,it,et,Ot,Lt,ti,vi,Vt,ni,oi,fi){return We.projection.name==="globe"?function(Ti,Jt,Bi,Ki,Oi,Dr,Ei,ur,Lr,mn,Rr){const gr=[],Xn=[],Or=Ti.projection.upVectorScale(Rr,Ti.center.lat,Ti.worldSize).metersToTile,Ur=[0,0,0,1],On=[0,0,0,1],Gn=(Un,uo,bo,Uo)=>{Un[0]=uo,Un[1]=bo,Un[2]=Uo,Un[3]=1},$n=Ro();Bi>0&&(Bi+=$n),Ki+=$n;for(const Un of Jt){const uo=[],bo=[];for(const Uo of Un){const Nn=Uo.x+Oi.x,is=Uo.y+Oi.y,No=Ti.projection.projectTilePoint(Nn,is,Rr),po=Ti.projection.upVector(Rr,Uo.x,Uo.y);let xn=Bi,Vo=Ki;if(Ei){const Zn=Xr(Nn,is,Bi,Ki,Ei,ur,Lr,mn);xn+=Zn.base,Vo+=Zn.top}Bi!==0?Gn(Ur,No.x+po[0]*Or*xn,No.y+po[1]*Or*xn,No.z+po[2]*Or*xn):Gn(Ur,No.x,No.y,No.z),Gn(On,No.x+po[0]*Or*Vo,No.y+po[1]*Or*Vo,No.z+po[2]*Or*Vo),oo(Ur,Ur,Dr),oo(On,On,Dr),uo.push(new ts(Ur[0],Ur[1],Ur[2])),bo.push(new ts(On[0],On[1],On[2]))}gr.push(uo),Xn.push(bo)}return[gr,Xn]}(We,it,et,Ot,Lt,ti,vi,Vt,ni,oi,fi):vi?function(Ti,Jt,Bi,Ki,Oi,Dr,Ei,ur,Lr){const mn=[],Rr=[],gr=[0,0,0,1];for(const Xn of Ti){const Or=[],Ur=[];for(const On of Xn){const Gn=On.x+Ki.x,$n=On.y+Ki.y,Un=Xr(Gn,$n,Jt,Bi,Dr,Ei,ur,Lr);gr[0]=Gn,gr[1]=$n,gr[2]=Un.base,gr[3]=1,Zh(gr,gr,Oi),gr[3]=Math.max(gr[3],1e-5);const uo=new ts(gr[0]/gr[3],gr[1]/gr[3],gr[2]/gr[3]);gr[0]=Gn,gr[1]=$n,gr[2]=Un.top,gr[3]=1,Zh(gr,gr,Oi),gr[3]=Math.max(gr[3],1e-5);const bo=new ts(gr[0]/gr[3],gr[1]/gr[3],gr[2]/gr[3]);Or.push(uo),Ur.push(bo)}mn.push(Or),Rr.push(Ur)}return[mn,Rr]}(it,et,Ot,Lt,ti,vi,Vt,ni,oi):function(Ti,Jt,Bi,Ki,Oi){const Dr=[],Ei=[],ur=Oi[8]*Jt,Lr=Oi[9]*Jt,mn=Oi[10]*Jt,Rr=Oi[11]*Jt,gr=Oi[8]*Bi,Xn=Oi[9]*Bi,Or=Oi[10]*Bi,Ur=Oi[11]*Bi;for(const On of Ti){const Gn=[],$n=[];for(const Un of On){const uo=Un.x+Ki.x,bo=Un.y+Ki.y,Uo=Oi[0]*uo+Oi[4]*bo+Oi[12],Nn=Oi[1]*uo+Oi[5]*bo+Oi[13],is=Oi[2]*uo+Oi[6]*bo+Oi[14],No=Oi[3]*uo+Oi[7]*bo+Oi[15],po=Uo+ur,xn=Nn+Lr,Vo=is+mn,Zn=Math.max(No+Rr,1e-5),Da=Uo+gr,jo=Nn+Xn,Vs=is+Or,zs=Math.max(No+Ur,1e-5);Gn.push(new ts(po/Zn,xn/Zn,Vo/Zn)),$n.push(new ts(Da/zs,jo/zs,Vs/zs))}Dr.push(Gn),Ei.push($n)}return[Dr,Ei]}(it,et,Ot,Lt,ti)}(g,u,$,N,R,b,we,W,te,g.center.lat,r.tileID.canonical),Be=r.queryGeometry;return function(We,it,et){let Ot=1/0;df(et,it)&&(Ot=Fo(et,it[0]));for(let Lt=0;Lt<it.length;Lt++){const ti=it[Lt],vi=We[Lt];for(let Vt=0;Vt<ti.length-1;Vt++){const ni=ti[Vt],oi=[ni,ti[Vt+1],vi[Vt+1],vi[Vt],ni];hf(et,oi)&&(Ot=Math.min(Ot,Fo(et,oi)))}}return Ot!==1/0&&Ot}(Re,He,Be.isPointQuery()?Be.screenBounds:Be.screenGeometry)}},line:class extends Il{constructor(r){super(r,za),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Zu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=ea.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Pl(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new el(this,r)}queryRadius(r){const e=r,n=Gc(Kh("line-width",this,e),Kh("line-gap-width",this,e)),u=Kh("line-offset",this,e);return n/2+Math.abs(u)+L1(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,n,u,f,g){if(r.queryGeometry.isAboveHorizon)return!1;const b=ym(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,r.pixelToTileUnitsFactor),I=r.pixelToTileUnitsFactor/2*Gc(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),z=this.paint.get("line-offset").evaluate(e,n);return z&&(u=function(R,N){const $=[],W=new zt(0,0);for(let Q=0;Q<R.length;Q++){const te=R[Q],ce=[];for(let we=0;we<te.length;we++){const Re=te[we],He=te[we+1],Be=we===0?W:Re.sub(te[we-1])._unit()._perp(),We=we===te.length-1?W:He.sub(Re)._unit()._perp(),it=Be._add(We)._unit();it._mult(1/(it.x*We.x+it.y*We.y)),ce.push(it._mult(N)._add(Re))}$.push(ce)}return $}(u,z*r.pixelToTileUnitsFactor)),function(R,N,$){for(let W=0;W<N.length;W++){const Q=N[W];if(R.length>=3){for(let te=0;te<Q.length;te++)if(Xh(R,Q[te]))return!0}if(Bp(R,Q,$))return!0}return!1}(b,u,I)}isTileClipped(){return!0}},symbol:Wm,background:class extends Il{constructor(r){super(r,ub)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Il{constructor(r){super(r,hb)}getProgramIds(){return["raster"]}},sky:class extends Il{constructor(r){super(r,pb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=R1({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(r,e){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),f=!u,g=r.style.light,b=g.properties.get("position");return f&&g.properties.get("anchor")==="viewport"&&sn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?c4(b.azimuthal,90-b.polar,e):c4(u[0],90-u[1],e)}const n=this.paint.get("sky-gradient-center");return c4(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}}};class Bf{constructor(e,n,u,f){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(n,f)}update(e,n,u){const{width:f,height:g}=e,{context:b}=this,{gl:I}=b,{HTMLImageElement:z,HTMLCanvasElement:R,HTMLVideoElement:N,ImageData:$,ImageBitmap:W}=j;if(I.bindTexture(I.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!n||n.premultiply!==!1)),u||this.size&&this.size[0]===f&&this.size[1]===g){const{x:Q,y:te}=u||{x:0,y:0};e instanceof z||e instanceof R||e instanceof N||e instanceof $||W&&e instanceof W?I.texSubImage2D(I.TEXTURE_2D,0,Q,te,I.RGBA,I.UNSIGNED_BYTE,e):I.texSubImage2D(I.TEXTURE_2D,0,Q,te,f,g,I.RGBA,I.UNSIGNED_BYTE,e.data)}else this.size=[f,g],e instanceof z||e instanceof R||e instanceof N||e instanceof $||W&&e instanceof W?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,e):I.texImage2D(I.TEXTURE_2D,0,this.format,f,g,0,this.format,I.UNSIGNED_BYTE,e.data);this.useMipmap=!!(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&I.generateMipmap(I.TEXTURE_2D)}bind(e,n){const{context:u}=this,{gl:f}=u;f.bindTexture(f.TEXTURE_2D,this.texture),e!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?e===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,n),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class mb{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class _b{constructor(){this.tasks={},this.taskQueue=[],eo(["process"],this),this.invoker=new mb(this.process),this.nextId=0}add(e,n){const u=this.nextId++,f=function({type:g,isSymbolTile:b,zoom:I}){return I=I||0,g==="message"?0:g!=="maybePrepare"||b?g!=="parseTile"||b?g==="parseTile"&&b?300-I:g==="maybePrepare"&&b?400-I:500:200-I:100-I}(n);if(f===0){ns();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[u]={fn:e,metadata:n,priority:f,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){ns();try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let f=0;f<this.taskQueue.length;f++){const g=this.tasks[this.taskQueue[f]];g.priority<n&&(n=g.priority,e=f)}if(e===null)return null;const u=this.taskQueue[e];return this.taskQueue.splice(e,1),u}remove(){this.invoker.remove()}}class Gg{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const u=e[n];this._stringToNumber[u]=n,this._numberToString[n]=u}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const gb=["tile","layer","source","sourceLayer","state"];class $g{constructor(e,n,u,f,g){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=u,this._y=f,this.properties=e.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const n of gb)this[n]!==void 0&&(e[n]=this[n]);return e}}const Zc=32,fh=33,Z1=new Uint16Array(8184);for(let r=0;r<2046;r++){let e=r+2,n=0,u=0,f=0,g=0,b=0,I=0;for(1&e?f=g=b=Zc:n=u=I=Zc;(e>>=1)>1;){const R=n+f>>1,N=u+g>>1;1&e?(f=n,g=u,n=b,u=I):(n=f,u=g,f=b,g=I),b=R,I=N}const z=4*r;Z1[z+0]=n,Z1[z+1]=u,Z1[z+2]=f,Z1[z+3]=g}const mh=new Uint16Array(2178),q1=new Uint8Array(1089),Xm=new Uint16Array(1089);function Zg(r){return r===0?-.03125:r===32?.03125:0}var qg=yt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Wg={type:2,extent:sr,loadGeometry:()=>[[new zt(0,0),new zt(sr+1,0),new zt(sr+1,sr+1),new zt(0,sr+1),new zt(0,0)]]};class u4{constructor(e,n,u,f,g){this.tileID=e,this.uid=rn(),this.uses=0,this.tileSize=n,this.tileZoom=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",f&&f.transform&&(this.projection=f.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<br.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Zd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,u){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(f,g){const b={};if(!g)return b;for(const I of f){const z=I.layerIds.map(R=>g.getLayer(R)).filter(Boolean);if(z.length!==0){I.layers=z,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(R=>z.filter(N=>N.id===R)[0]));for(const R of z)b[R.id]=I}}return b}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const g=this.buckets[f];if(g instanceof $1){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const g=this.buckets[f];if(g instanceof $1&&g.hasRTLText){this.hasRTLText=!0,O.isLoading()||O.isLoaded()||A()!=="deferred"||B();break}}this.queryPadding=0;for(const f in this.buckets){const g=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(f).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new jr}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const f=this.buckets[u];f.uploadPending()&&f.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Bf(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Bf(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Bf(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,u,f,g,b,I,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:I,transform:b,params:g,tileTransform:this.tileTransform},e,n,u):{}}querySourceFeatures(e,n){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const f=u.loadVTLayers(),g=n?n.sourceLayer:"",b=f._geojsonTileLayer||f[g];if(!b)return;const I=Rc(n&&n.filter),{z,x:R,y:N}=this.tileID.canonical,$={z,x:R,y:N};for(let W=0;W<b.length;W++){const Q=b.feature(W);if(I.needGeometry){const we=Wh(Q,!0);if(!I.filter(new G(this.tileID.overscaledZ),we,this.tileID.canonical))continue}else if(!I.filter(new G(this.tileID.overscaledZ),Q))continue;const te=u.getId(Q,g),ce=new $g(Q,z,R,N,te);ce.tile=$,e.push(ce)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const u=xr(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let f=!1;if(this.expirationTime>u)f=!1;else if(n)if(this.expirationTime<n)f=!0;else{const g=this.expirationTime-n;g?this.expirationTime=u+Math.max(g,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!n)return;const u=this.latestFeatureIndex.loadVTLayers(),f=n.style.listImages();for(const g in this.buckets){if(!n.style.hasLayer(g))continue;const b=this.buckets[g],I=b.layers[0].sourceLayer||"_geojsonTileLayer",z=u[I],R=e[I];if(!z||!R||Object.keys(R).length===0)continue;if(b.update(R,z,f,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b instanceof Pl||b instanceof L){const $=n.style._getSourceCache(b.layers[0].source);n._terrain&&n._terrain.enabled&&$&&b.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile($.id,this.tileID)}const N=n&&n.style&&n.style.getLayer(g);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<br.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=br.now()+e}setTexture(e,n){const u=n.context,f=u.gl;this.texture=this.texture||n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Bf(u,e,f.RGBA,{useMipmap:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE))}setDependencies(e,n){const u={};for(const f of n)u[f]=!0;this.dependencies[e]=u}hasDependency(e,n){for(const u of e){const f=this.dependencies[u];if(f){for(const g of n)if(f[g])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const u=jc(Wg,this.tileID.canonical,this.tileTransform)[0],f=new yi,g=new Ma;for(let b=0;b<u.length;b++){const{x:I,y:z}=u[b];f.emplaceBack(I,z),g.emplaceBack(b)}g.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(g),this._tileDebugBuffer=e.createVertexBuffer(f,M1.members),this._tileDebugSegments=co.simpleSegment(0,0,f.length,g.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const u=jc(Wg,this.tileID.canonical,this.tileTransform)[0];let f,g;if(this.isRaster){const b=function(I,z){const R=Zd(I,z),N=Math.pow(2,I.z);for(let we=0;we<fh;we++)for(let Re=0;Re<fh;Re++){const He=Aa((I.x+(Re+Zg(Re))/Zc)/N),Be=us((I.y+(we+Zg(we))/Zc)/N),We=z.project(He,Be),it=we*fh+Re;mh[2*it+0]=Math.round((We.x*R.scale-R.x)*sr),mh[2*it+1]=Math.round((We.y*R.scale-R.y)*sr)}q1.fill(0),Xm.fill(0);for(let we=2045;we>=0;we--){const Re=4*we,He=Z1[Re+0],Be=Z1[Re+1],We=Z1[Re+2],it=Z1[Re+3],et=He+We>>1,Ot=Be+it>>1,Lt=et+Ot-Be,ti=Ot+He-et,vi=Be*fh+He,Vt=it*fh+We,ni=Ot*fh+et,oi=Math.hypot((mh[2*vi+0]+mh[2*Vt+0])/2-mh[2*ni+0],(mh[2*vi+1]+mh[2*Vt+1])/2-mh[2*ni+1])>=16;q1[ni]=q1[ni]||(oi?1:0),we<1022&&(q1[ni]=q1[ni]||q1[(Be+ti>>1)*fh+(He+Lt>>1)]||q1[(it+ti>>1)*fh+(We+Lt>>1)])}const $=new Zt,W=new er;let Q=0;function te(we,Re){const He=Re*fh+we;return Xm[He]===0&&($.emplaceBack(mh[2*He+0],mh[2*He+1],we*sr/Zc,Re*sr/Zc),Xm[He]=++Q),Xm[He]-1}function ce(we,Re,He,Be,We,it){const et=we+He>>1,Ot=Re+Be>>1;if(Math.abs(we-We)+Math.abs(Re-it)>1&&q1[Ot*fh+et])ce(We,it,we,Re,et,Ot),ce(He,Be,We,it,et,Ot);else{const Lt=te(we,Re),ti=te(He,Be),vi=te(We,it);W.emplaceBack(Lt,ti,vi)}}return ce(0,0,Zc,Zc,Zc,0),ce(Zc,Zc,0,0,0,Zc),{vertices:$,indices:W}}(this.tileID.canonical,n);f=b.vertices,g=b.indices}else{f=new Zt,g=new er;for(const{x:I,y:z}of u)f.emplaceBack(I,z,0,0);const b=Jh(f.int16,void 0,4);for(let I=0;I<b.length;I+=3)g.emplaceBack(b[I],b[I+1],b[I+2])}this._tileBoundsBuffer=e.createVertexBuffer(f,qg.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(g),this._tileBoundsSegments=co.simpleSegment(0,0,f.length,g.length)}_makeGlobeTileDebugBuffers(e,n){const u=n.projection;if(!u||u.name!=="globe"||n.freezeTileCoverage)return;const f=this.tileID.canonical,g=Nc(cm(f,n)),b=k1(n.zoom);let I;b>0&&(I=Pd(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,f,n,g,I,b),this._makeGlobeTileDebugTextBuffer(e,f,n,g,I,b)}_globePoint(e,n,u,f,g,b,I){let z=Rd(e,n,u);if(b){const R=1<<u.z,N=lc(f.center.lng),$=cc(f.center.lat),W=(u.x+.5)/R-N;let Q=0;W>.5?Q=-1:W<-.5&&(Q=1);let te=(e/sr+u.x)/R+Q,ce=(n/sr+u.y)/R;te=(te-N)*f._pixelsPerMercatorPixel+N,ce=(ce-$)*f._pixelsPerMercatorPixel+$;const we=[te*f.worldSize,ce*f.worldSize,0];oo(we,we,b),z=lh(z,we,I)}return oo(z,z,g)}_makeGlobeTileDebugBorderBuffer(e,n,u,f,g,b){const I=new yi,z=new Ma,R=new At,N=(W,Q,te,ce,we)=>{const Re=(te-W)/(we-1),He=(ce-Q)/(we-1),Be=I.length;for(let We=0;We<we;We++){const it=W+We*Re,et=Q+We*He;I.emplaceBack(it,et);const Ot=this._globePoint(it,et,n,u,f,g,b);R.emplaceBack(Ot[0],Ot[1],Ot[2]),z.emplaceBack(Be+We)}},$=sr;N(0,0,$,0,16),N($,0,$,$,16),N($,$,0,$,16),N(0,$,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(z),this._tileDebugBuffer=e.createVertexBuffer(I,M1.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(R,tf.members),this._tileDebugSegments=co.simpleSegment(0,0,I.length,z.length)}_makeGlobeTileDebugTextBuffer(e,n,u,f,g,b){const I=sr/4,z=new yi,R=new er,N=new At,$=25;R.reserve(32),z.reserve($),N.reserve($);const W=(Q,te)=>$*Q+te;for(let Q=0;Q<$;Q++){const te=Q*I;for(let ce=0;ce<$;ce++){const we=ce*I;z.emplaceBack(we,te);const Re=this._globePoint(we,te,n,u,f,g,b);N.emplaceBack(Re[0],Re[1],Re[2])}}for(let Q=0;Q<4;Q++)for(let te=0;te<4;te++){const ce=W(Q,te),we=W(Q,te+1),Re=W(Q+1,te),He=W(Q+1,te+1);R.emplaceBack(ce,we,Re),R.emplaceBack(Re,we,He)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(R),this._tileDebugTextBuffer=e.createVertexBuffer(z,M1.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(N,tf.members),this._tileDebugTextSegments=co.simpleSegment(0,0,$,32)}}class yb{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,u){const f=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},mr(this.stateChanges[e][f],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const g in this.state[e])g!==f&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][f]===null){this.deletedStates[e][f]={};for(const g in this.state[e][f])u[g]||(this.deletedStates[e][f][g]=null)}else for(const g in u)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][g]===null&&delete this.deletedStates[e][f][g]}removeFeatureState(e,n,u){if(this.deletedStates[e]===null)return;const f=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&n!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][u]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(u in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][u]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,n){const u=String(n),f=mr({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const g=this.deletedStates[e][n];if(g===null)return{};for(const b in g)delete f[b]}return f}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const u={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const g={};for(const b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),mr(this.state[f][b],this.stateChanges[f][b]),g[b]=this.state[f][b];u[f]=g}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const g={};if(this.deletedStates[f]===null)for(const b in this.state[f])g[b]={},this.state[f][b]={};else for(const b in this.deletedStates[f]){if(this.deletedStates[f][b]===null)this.state[f][b]={};else if(this.state[f][b])for(const I of Object.keys(this.deletedStates[f][b]))delete this.state[f][b][I];g[b]=this.state[f][b]}u[f]=u[f]||{},mr(u[f],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const f in e)e[f].setFeatureState(u,n)}}class Xg{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const u=this.toIdx(e,n);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function Hg(r,e,n,u){let f=0,g=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(u[b])<1e-15){if(n[b]<r[b]||n[b]>e[b])return null}else{const I=1/u[b];let z=(r[b]-n[b])*I,R=(e[b]-n[b])*I;if(z>R){const N=z;z=R,R=N}if(z>f&&(f=z),R<g&&(g=R),f>g)return null}return f}function Kg(r,e,n,u,f,g,b,I,z,R,N){const $=u-r,W=f-e,Q=g-n,te=b-r,ce=I-e,we=z-n,Re=N[1]*we-N[2]*ce,He=N[2]*te-N[0]*we,Be=N[0]*ce-N[1]*te,We=$*Re+W*He+Q*Be;if(Math.abs(We)<1e-15)return null;const it=1/We,et=R[0]-r,Ot=R[1]-e,Lt=R[2]-n,ti=(et*Re+Ot*He+Lt*Be)*it;if(ti<0||ti>1)return null;const vi=Ot*Q-Lt*W,Vt=Lt*$-et*Q,ni=et*W-Ot*$,oi=(N[0]*vi+N[1]*Vt+N[2]*ni)*it;return oi<0||ti+oi>1?null:(te*vi+ce*Vt+we*ni)*it}function Yg(r,e,n){return(r-e)/(n-e)}function Jg(r,e,n,u,f,g,b,I,z){const R=1<<n,N=g-u,$=b-f,W=(r+1)/R*N+u,Q=(e+0)/R*$+f,te=(e+1)/R*$+f;I[0]=(r+0)/R*N+u,I[1]=Q,z[0]=W,z[1]=te}class Qg{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(g){const b=Math.ceil(Math.log2(g.dim/8)),I=[];let z=Math.ceil(Math.pow(2,b));const R=1/z,N=(Q,te,ce,we,Re)=>{const He=we?1:0,Be=(Q+1)*ce-He,We=te*ce,it=(te+1)*ce-He;Re[0]=Q*ce,Re[1]=We,Re[2]=Be,Re[3]=it};let $=new Xg(z);const W=[];for(let Q=0;Q<z*z;Q++){N(Q%z,Math.floor(Q/z),R,!1,W);const te=W1(W[0],W[1],g),ce=W1(W[2],W[1],g),we=W1(W[2],W[3],g),Re=W1(W[0],W[3],g);$.minimums.push(Math.min(te,ce,we,Re)),$.maximums.push(Math.max(te,ce,we,Re)),$.leaves.push(1)}for(I.push($),z/=2;z>=1;z/=2){const Q=I[I.length-1];$=new Xg(z);for(let te=0;te<z*z;te++){N(te%z,Math.floor(te/z),2,!0,W);const ce=Q.getElevation(W[0],W[1]),we=Q.getElevation(W[2],W[1]),Re=Q.getElevation(W[2],W[3]),He=Q.getElevation(W[0],W[3]),Be=Q.isLeaf(W[0],W[1]),We=Q.isLeaf(W[2],W[1]),it=Q.isLeaf(W[2],W[3]),et=Q.isLeaf(W[0],W[3]),Ot=Math.min(ce.min,we.min,Re.min,He.min),Lt=Math.max(ce.max,we.max,Re.max,He.max),ti=Be&&We&&it&&et;$.maximums.push(Lt),$.minimums.push(Ot),$.leaves.push(Lt-Ot<=5&&ti?1:0)}I.push($)}return I}(this.dem),u=n.length-1,f=n[u];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(n,0,0,u,0)}raycastRoot(e,n,u,f,g,b,I=1){return Hg([e,n,-100],[u,f,this.maximums[0]*I],g,b)}raycast(e,n,u,f,g,b,I=1){if(!this.nodeCount)return null;const z=this.raycastRoot(e,n,u,f,g,b,I);if(z==null)return null;const R=[],N=[],$=[],W=[],Q=[{idx:0,t:z,nodex:0,nodey:0,depth:0}];for(;Q.length>0;){const{idx:te,t:ce,nodex:we,nodey:Re,depth:He}=Q.pop();if(this.leaves[te]){Jg(we,Re,He,e,n,u,f,$,W);const We=1<<He,it=(we+0)/We,et=(we+1)/We,Ot=(Re+0)/We,Lt=(Re+1)/We,ti=W1(it,Ot,this.dem)*I,vi=W1(et,Ot,this.dem)*I,Vt=W1(et,Lt,this.dem)*I,ni=W1(it,Lt,this.dem)*I,oi=Kg($[0],$[1],ti,W[0],$[1],vi,W[0],W[1],Vt,g,b),fi=Kg(W[0],W[1],Vt,$[0],W[1],ni,$[0],$[1],ti,g,b),Ti=Math.min(oi!==null?oi:Number.MAX_VALUE,fi!==null?fi:Number.MAX_VALUE);if(Ti!==Number.MAX_VALUE)return Ti;{const Jt=zd([],g,b,ce);if(e7(ti,vi,ni,Vt,Yg(Jt[0],$[0],W[0]),Yg(Jt[1],$[1],W[1]))>=Jt[2])return ce}continue}let Be=0;for(let We=0;We<this._siblingOffset.length;We++){Jg((we<<1)+this._siblingOffset[We][0],(Re<<1)+this._siblingOffset[We][1],He+1,e,n,u,f,$,W),$[2]=-100,W[2]=this.maximums[this.childOffsets[te]+We]*I;const it=Hg($,W,g,b);if(it!=null){const et=it;R[We]=et;let Ot=!1;for(let Lt=0;Lt<Be&&!Ot;Lt++)et>=R[N[Lt]]&&(N.splice(Lt,0,We),Ot=!0);Ot||(N[Be]=We),Be++}}for(let We=0;We<Be;We++){const it=N[We];Q.push({idx:this.childOffsets[te]+it,t:R[it],nodex:(we<<1)+this._siblingOffset[it][0],nodey:(Re<<1)+this._siblingOffset[it][1],depth:He+1})}}return null}_addNode(e,n,u){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,u,f,g){if(e[f].isLeaf(n,u)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const b=f-1,I=e[b];let z=0,R=0;for(let N=0;N<this._siblingOffset.length;N++){const $=2*n+this._siblingOffset[N][0],W=2*u+this._siblingOffset[N][1],Q=I.getElevation($,W),te=I.isLeaf($,W),ce=this._addNode(Q.min,Q.max,te);te&&(z|=1<<N),R||(R=ce)}for(let N=0;N<this._siblingOffset.length;N++)z&1<<N||this._construct(e,2*n+this._siblingOffset[N][0],2*u+this._siblingOffset[N][1],b,R+N)}}function e7(r,e,n,u,f,g){return Kr(Kr(r,n,g),Kr(e,u,g),f)}function W1(r,e,n){const u=n.dim,f=pt(r*u-.5,0,u-1),g=pt(e*u-.5,0,u-1),b=Math.floor(f),I=Math.floor(g),z=Math.min(b+1,u-1),R=Math.min(I+1,u-1);return e7(n.get(b,I),n.get(z,I),n.get(b,R),n.get(z,R),f-b,g-I)}const t7={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function xb(r,e,n){return(256*r*256+256*e+n)/10-1e4}function vb(r,e,n){return 256*r+e+n/256-32768}class Hm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,u,f=!1,g=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return sn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const b=this.dim=n.height-2,I=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=u||"mapbox",this.borderReady=f,!f){for(let z=0;z<b;z++)I[this._idx(-1,z)]=I[this._idx(0,z)],I[this._idx(b,z)]=I[this._idx(b-1,z)],I[this._idx(z,-1)]=I[this._idx(z,0)],I[this._idx(z,b)]=I[this._idx(z,b-1)];I[this._idx(-1,-1)]=I[this._idx(0,0)],I[this._idx(b,-1)]=I[this._idx(b-1,0)],I[this._idx(-1,b)]=I[this._idx(0,b-1)],I[this._idx(b,b)]=I[this._idx(b-1,b-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Qg(this)}get(e,n,u=!1){u&&(e=pt(e,-1,this.dim),n=pt(n,-1,this.dim));const f=4*this._idx(e,n);return(this.encoding==="terrarium"?vb:xb)(this.pixels[f],this.pixels[f+1],this.pixels[f+2])}static getUnpackVector(e){return t7[e]}get unpackVector(){return t7[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}static pack(e,n){const u=[0,0,0,0],f=Hm.getUnpackVector(n);let g=Math.floor((e+f[3])/f[2]);return u[2]=g%256,g=Math.floor(g/256),u[1]=g%256,g=Math.floor(g/256),u[0]=g,u}getPixels(){return new Qs({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,u){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let f=n*this.dim,g=n*this.dim+this.dim,b=u*this.dim,I=u*this.dim+this.dim;switch(n){case-1:f=g-1;break;case 1:g=f+1}switch(u){case-1:b=I-1;break;case 1:I=b+1}const z=-n*this.dim,R=-u*this.dim;for(let N=b;N<I;N++)for(let $=f;$<g;$++){const W=4*this._idx($,N),Q=4*this._idx($+z,N+R);this.pixels[W+0]=e.pixels[Q+0],this.pixels[W+1]=e.pixels[Q+1],this.pixels[W+2]=e.pixels[Q+2],this.pixels[W+3]=e.pixels[Q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ft(Hm,"DEMData"),Ft(Qg,"DemMinMaxQuadTree",{omit:["dem"]});class bb{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,u){const f=e.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const g={value:n,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(e,g)},u)),this.data[f].push(g),this.order.push(f),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const u=e.wrapped().key,f=n===void 0?0:this.data[u].indexOf(n),g=this.data[u][f];return this.data[u].splice(f,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const u in this.data)for(const f of this.data[u])e(f.value)||n.push(f);for(const u of n)this.remove(u.value.tileID,u)}}class Kp{constructor(e,n,u){this.func=e,this.mask=n,this.range=u}}Kp.ReadOnly=!1,Kp.ReadWrite=!0,Kp.disabled=new Kp(519,Kp.ReadOnly,[0,1]);const h4=7680;class d4{constructor(e,n,u,f,g,b){this.test=e,this.ref=n,this.mask=u,this.fail=f,this.depthFail=g,this.pass=b}}d4.disabled=new d4({func:519,mask:0},0,0,h4,h4,h4);class _h{constructor(e,n,u){this.blendFunction=e,this.blendColor=n,this.mask=u}}_h.Replace=[1,0],_h.disabled=new _h(_h.Replace,Kn.transparent,[!1,!1,!1,!1]),_h.unblended=new _h(_h.Replace,Kn.transparent,[!0,!0,!0,!0]),_h.alphaBlended=new _h([1,771],Kn.transparent,[!0,!0,!0,!0]);const p4=1029,f4=2305;class Cu{constructor(e,n,u){this.enable=e,this.mode=n,this.frontFace=u}}Cu.disabled=new Cu(!1,p4,f4),Cu.backCCW=new Cu(!0,p4,f4),Cu.backCW=new Cu(!0,p4,2304),Cu.frontCW=new Cu(!0,1028,2304),Cu.frontCCW=new Cu(!0,1028,f4);class qd extends Pr{constructor(e,n,u){super(),this.id=e,this._onlySymbols=u,n.on("data",f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new bb(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new yb,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const u=this._tiles[n];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return lr(this._tiles).map(e=>e.tileID).sort(i7).map(e=>e.key)}getRenderableIds(e){const n=[];for(const u in this._tiles)this._isIdRenderable(+u,e)&&n.push(this._tiles[u]);return e?n.sort((u,f)=>{const g=u.tileID,b=f.tileID,I=new zt(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),z=new zt(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-b.overscaledZ||z.y-I.y||z.x-I.x}).map(u=>u.tileID.key):n.map(u=>u.tileID).sort(i7).map(u=>u.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=n),this._loadTile(u,this._tileLoaded.bind(this,u,e,n)))}_tileLoaded(e,n,u,f){if(f)if(e.state="errored",f.status!==404)this._source.fire(new Qi(f,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=br.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Mr("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let f=0;f<n.length;f++){const g=n[f];if(e.neighboringTiles&&e.neighboringTiles[g]){const b=this.getTileByID(g);u(e,b),u(b,e)}}function u(f,g){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let b=g.tileID.canonical.x-f.tileID.canonical.x;const I=g.tileID.canonical.y-f.tileID.canonical.y,z=Math.pow(2,f.tileID.canonical.z),R=g.tileID.key;b===0&&I===0||Math.abs(I)>1||(Math.abs(b)>1&&(Math.abs(b+z)===1?b+=z:Math.abs(b-z)===1&&(b-=z)),g.dem&&f.dem&&(f.dem.backfillBorder(g.dem,b,I),f.neighboringTiles&&f.neighboringTiles[R]&&(f.neighboringTiles[R].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,u,f){for(const g in this._tiles){let b=this._tiles[g];if(f[g]||!b.hasData()||b.tileID.overscaledZ<=n||b.tileID.overscaledZ>u)continue;let I=b.tileID;for(;b&&b.tileID.overscaledZ>n+1;){const R=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[R.key],b&&b.hasData()&&(I=R)}let z=I;for(;z.overscaledZ>n;)if(z=z.scaledTo(z.overscaledZ-1),e[z.key]){f[I.key]=I;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=n?u:null}for(let u=e.overscaledZ-1;u>=n;u--){const f=e.scaledTo(u),g=this._getLoadedTile(f);if(g)return g}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const u=Math.ceil(e.width/n)+1,f=Math.ceil(e.height/n)+1,g=Math.floor(u*f*5),b=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,g):g,I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(I)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const u={};for(const f in this._tiles){const g=this._tiles[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+n),u[g.tileID.key]=g}this._tiles=u;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(e,n,u){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!u)return;let f;this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(I=>new Ln(I.canonical.z,I.wrap,I.canonical.z,I.canonical.x,I.canonical.y)):(f=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!u,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter(I=>this._source.hasTile(I)))):f=[];const g=this._updateRetainedTiles(f);if(r7(this._source.type)&&f.length!==0){const I={},z={},R=Object.keys(g);for(const $ of R){const W=g[$],Q=this._tiles[$];if(!Q||Q.fadeEndTime&&Q.fadeEndTime<=br.now())continue;const te=this.findLoadedParent(W,Math.max(W.overscaledZ-qd.maxOverzooming,this._source.minzoom));te&&(this._addTile(te.tileID),I[te.tileID.key]=te.tileID),z[$]=W}const N=f[f.length-1].overscaledZ;for(const $ in this._tiles){const W=this._tiles[$];if(g[$]||!W.hasData())continue;let Q=W.tileID;for(;Q.overscaledZ>N;){Q=Q.scaledTo(Q.overscaledZ-1);const te=this._tiles[Q.key];if(te&&te.hasData()&&z[Q.key]){g[$]=W.tileID;break}}}for(const $ in I)g[$]||(this._coveredTiles[$]=!0,g[$]=I[$])}for(const I in g)this._tiles[I].clearFadeHold();const b=function(I,z){const R=[];for(const N in I)N in z||R.push(N);return R}(this._tiles,g);for(const I of b){const z=this._tiles[I];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(+I)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(e.length===0)return n;const u={},f=e.reduce((R,N)=>Math.min(R,N.overscaledZ),1/0),g=e[0].overscaledZ,b=Math.max(g-qd.maxOverzooming,this._source.minzoom),I=Math.max(g+qd.maxUnderzooming,this._source.minzoom),z={};for(const R of e){const N=this._addTile(R);n[R.key]=R,N.hasData()||f<this._source.maxzoom&&(z[R.key]=R)}this._retainLoadedChildren(z,f,I,n);for(const R of e){let N=this._tiles[R.key];if(N.hasData())continue;if(R.canonical.z>=this._source.maxzoom){const W=R.children(this._source.maxzoom)[0],Q=this.getTile(W);if(Q&&Q.hasData()){n[W.key]=W;continue}}else{const W=R.children(this._source.maxzoom);if(n[W[0].key]&&n[W[1].key]&&n[W[2].key]&&n[W[3].key])continue}let $=N.wasRequested();for(let W=R.overscaledZ-1;W>=b;--W){const Q=R.scaledTo(W);if(u[Q.key]||(u[Q.key]=!0,N=this.getTile(Q),!N&&$&&(N=this._addTile(Q)),N&&(n[Q.key]=Q,$=N.wasRequested(),N.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let u,f=this._tiles[e].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){u=this._loadedParentTiles[f.key];break}n.push(f.key);const g=f.scaledTo(f.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;f=g}for(const g of n)this._loadedParentTiles[g]=u}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const u=!!n;if(!u){const f=this.map?this.map.painter:null;n=new u4(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,f,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,u||this._source.fire(new Mr("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=n.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,u){const f=[],g=this.transform;if(!g)return f;const b=g.projection.name==="globe",I=lc(g.center.lng);for(const z in this._tiles){const R=this._tiles[z];if(u&&R.clearQueryDebugViz(),R.holdingForFade())continue;let N;if(b){const $=R.tileID.canonical;if($.z===0){const W=[Math.abs(pt(I,...Ff($,-1))-I),Math.abs(pt(I,...Ff($,1))-I)];N=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(pt(I,...Ff($,-1))-I),Math.abs(pt(I,...Ff($,0))-I),Math.abs(pt(I,...Ff($,1))-I)];N=[W.indexOf(Math.min(...W))-1]}}else N=[0];for(const $ of N){const W=e.containsTile(R,g,n,$);W&&f.push(W)}}return f}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);for(const u of n)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(r7(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=br.now())return!0}return!1}setFeatureState(e,n,u){this._state.updateState(e=e||"_geojsonTileLayer",n,u)}removeFeatureState(e,n,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,u)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,u){const f=this._tiles[e];f&&f.setDependencies(n,u)}reloadTilesForDependencies(e,n){for(const u in this._tiles)this._tiles[u].hasDependency(e,n)&&this._reloadTile(+u,"reloading");this._cache.filter(u=>!u.hasDependency(e,n))}_preloadTiles(e,n){if(!this._sourceLoaded){const I=()=>{this._sourceLoaded&&(this._source.off("data",I),this._preloadTiles(e,n))};return void this._source.on("data",I)}const u=new Map,f=Array.isArray(e)?e:[e],g=this.map.painter.terrain,b=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(const I of f){const z=I.coveringTiles({tileSize:b,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const R of z)u.set(R.key,R);this.usedForTerrain&&I.updateElevation(!1)}Wi(Array.from(u.values()),(I,z)=>{const R=new u4(I,this._source.tileSize*I.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(R,N=>{this._source.type==="raster-dem"&&R.dem&&this._backfillDEM(R),z(N,R)})},n)}}function i7(r,e){const n=Math.abs(2*r.wrap)-+(r.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return r.overscaledZ-e.overscaledZ||u-n||e.canonical.y-r.canonical.y||e.canonical.x-r.canonical.x}function r7(r){return r==="raster"||r==="image"||r==="video"||r==="custom"}function Ff(r,e){const n=1<<r.z;return[r.x/n+e,(r.x+1)/n+e]}qd.maxOverzooming=10,qd.maxUnderzooming=3;class Km{constructor(e,n,u){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=u}static create(e,n,u){const f=u||e.findDEMTileFor(n);if(!f||!f.dem)return;const g=f.dem,b=f.tileID,I=1<<n.canonical.z-b.canonical.z;return new Km(f,f.tileSize/sr/I,[(n.canonical.x/I-b.canonical.x)*g.dim,(n.canonical.y/I-b.canonical.y)*g.dim])}tileCoordToPixel(e,n){const u=n*this._scale+this._offset[1],f=Math.floor(e*this._scale+this._offset[0]),g=Math.floor(u);return new zt(f,g)}getElevationAt(e,n,u,f){const g=e*this._scale+this._offset[0],b=n*this._scale+this._offset[1],I=Math.floor(g),z=Math.floor(b),R=this._dem;return f=!!f,u?Kr(Kr(R.get(I,z,f),R.get(I,z+1,f),b-z),Kr(R.get(I+1,z,f),R.get(I+1,z+1,f),b-z),g-I):R.get(I,z,f)}getElevationAtPixel(e,n,u){return this._dem.get(e,n,!!u)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*uc(1,e)*this._dem.stride}}class n7{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Wt(sr,16,0),this.featureIndexArray=new Fc,this.promoteId=n}insert(e,n,u,f,g,b=0){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,f,g,b);const z=this.grid;for(let R=0;R<n.length;R++){const N=n[R],$=[1/0,1/0,-1/0,-1/0];for(let W=0;W<N.length;W++){const Q=N[W];$[0]=Math.min($[0],Q.x),$[1]=Math.min($[1],Q.y),$[2]=Math.max($[2],Q.x),$[3]=Math.max($[3],Q.y)}$[0]<sr&&$[1]<sr&&$[2]>=0&&$[3]>=0&&z.insert(I,$[0],$[1],$[2],$[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Vi(new Bm(this.rawTileData)).layers,this.sourceLayerCoder=new Gg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,u,f){this.loadVTLayers();const g=e.params||{},b=Rc(g.filter),I=e.tileResult,z=e.transform,R=I.bufferedTilespaceBounds,N=this.grid.query(R.min.x,R.min.y,R.max.x,R.max.y,(te,ce,we,Re)=>Hh(I.bufferedTilespaceGeometry,te,ce,we,Re));N.sort(wb);let $=null;z.elevation&&N.length>0&&($=Km.create(z.elevation,this.tileID));const W={};let Q;for(let te=0;te<N.length;te++){const ce=N[te];if(ce===Q)continue;Q=ce;const we=this.featureIndexArray.get(ce);let Re=null;this.loadMatchingFeature(W,we,b,g.layers,g.availableImages,n,u,f,(He,Be,We,it=0)=>(Re||(Re=jc(He,this.tileID.canonical,e.tileTransform)),Be.queryIntersectsFeature(I,He,We,Re,this.z,e.transform,e.pixelPosMatrix,$,it)))}return W}loadMatchingFeature(e,n,u,f,g,b,I,z,R){const{featureIndex:N,bucketIndex:$,sourceLayerIndex:W,layoutVertexArrayOffset:Q}=n,te=this.bucketLayerIDs[$];if(f&&!function(He,Be){for(let We=0;We<He.length;We++)if(Be.indexOf(He[We])>=0)return!0;return!1}(f,te))return;const ce=this.sourceLayerCoder.decode(W),we=this.vtLayers[ce].feature(N);if(u.needGeometry){const He=Wh(we,!0);if(!u.filter(new G(this.tileID.overscaledZ),He,this.tileID.canonical))return}else if(!u.filter(new G(this.tileID.overscaledZ),we))return;const Re=this.getId(we,ce);for(let He=0;He<te.length;He++){const Be=te[He];if(f&&f.indexOf(Be)<0)continue;const We=b[Be];if(!We)continue;let it={};Re!==void 0&&z&&(it=z.getState(We.sourceLayer||"_geojsonTileLayer",Re));const et=mr({},I[Be]);et.paint=o7(et.paint,We.paint,we,it,g),et.layout=o7(et.layout,We.layout,we,it,g);const Ot=!R||R(we,We,it,Q);if(!Ot)continue;const Lt=new $g(we,this.z,this.x,this.y,Re);Lt.layer=et;let ti=e[Be];ti===void 0&&(ti=e[Be]=[]),ti.push({featureIndex:N,feature:Lt,intersectionZ:Ot})}}lookupSymbolFeatures(e,n,u,f,g,b,I,z){const R={};this.loadVTLayers();const N=Rc(g);for(const $ of e)this.loadMatchingFeature(R,{bucketIndex:u,sourceLayerIndex:f,featureIndex:$,layoutVertexArrayOffset:0},N,b,I,z,n);return R}loadFeature(e){const{featureIndex:n,sourceLayerIndex:u}=e;this.loadVTLayers();const f=this.sourceLayerCoder.decode(u),g=this.vtFeatures[f];if(g[n])return g[n];const b=this.vtLayers[f].feature(n);return g[n]=b,b}hasLayer(e){for(const n of this.bucketLayerIDs)for(const u of n)if(e===u)return!0;return!1}getId(e,n){let u=e.id;if(this.promoteId){const f=typeof this.promoteId=="string"?this.promoteId:this.promoteId[n];f!=null&&(u=e.properties[f]),typeof u=="boolean"&&(u=Number(u))}return u}}function o7(r,e,n,u,f){return Ir(r,(g,b)=>{const I=e instanceof ze?e.get(b):null;return I&&I.evaluate?I.evaluate(n,u,f):I})}function wb(r,e){return e-r}Ft(n7,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class s7{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new Eu({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const u=this.getKey(e,n);return this.positions[u]}trim(){const e=this.width,n=this.height=on(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,u){const f=[];let g=e.length%2==1?-e[e.length-1]*u:0,b=e[0]*u,I=!0;f.push({left:g,right:b,isDash:I,zeroLength:e[0]===0});let z=e[0];for(let R=1;R<e.length;R++){I=!I;const N=e[R];g=z*u,z+=N,b=z*u,f.push({left:g,right:b,isDash:I,zeroLength:N===0})}return f}addRoundDash(e,n,u){const f=n/2;for(let g=-u;g<=u;g++){const b=this.width*(this.nextRow+u+g);let I=0,z=e[I];for(let R=0;R<this.width;R++){R/z.right>1&&(z=e[++I]);const N=Math.abs(R-z.left),$=Math.abs(R-z.right),W=Math.min(N,$);let Q;const te=g/u*(f+1);if(z.isDash){const ce=f-Math.abs(te);Q=Math.sqrt(W*W+ce*ce)}else Q=f-Math.sqrt(W*W+te*te);this.image.data[b+R]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(e,n){for(let z=e.length-1;z>=0;--z){const R=e[z],N=e[z+1];R.zeroLength?e.splice(z,1):N&&N.isDash===R.isDash&&(N.left=R.left,e.splice(z,1))}const u=e[0],f=e[e.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const g=this.width*this.nextRow;let b=0,I=e[b];for(let z=0;z<this.width;z++){z/I.right>1&&(I=e[++b]);const R=Math.abs(z-I.left),N=Math.abs(z-I.right),$=Math.min(R,N);this.image.data[g+z]=Math.max(0,Math.min(255,(I.isDash?$:-$)+n+128))}}addDash(e,n){const u=this.getKey(e,n);if(this.positions[u])return this.positions[u];const f=n==="round",g=f?7:0,b=2*g+1;if(this.nextRow+b>this.height)return sn("LineAtlas out of space"),null;e.length===0&&e.push(1);let I=0;for(let N=0;N<e.length;N++)e[N]<0&&(sn("Negative value is found in line dasharray, replacing values with 0"),e[N]=0),I+=e[N];if(I!==0){const N=this.width/I,$=this.getDashRanges(e,this.width,N);f?this.addRoundDash($,N,g):this.addRegularDash($,n==="square"?.5*N:0)}const z=this.nextRow+g;this.nextRow+=b;const R={tl:[z,g],br:[I,0]};return this.positions[u]=R,R}}Ft(s7,"LineAtlas");const a7=1*Mu;class l7{constructor(e){const n={},u=[];for(const I in e){const z=e[I],R=n[I]={};for(const N in z.glyphs){const $=z.glyphs[+N];if(!$||$.bitmap.width===0||$.bitmap.height===0)continue;const W=$.metrics.localGlyph?a7:1,Q={x:0,y:0,w:$.bitmap.width+2*W,h:$.bitmap.height+2*W};u.push(Q),R[N]=Q}}const{w:f,h:g}=J5(u),b=new Eu({width:f||1,height:g||1});for(const I in e){const z=e[I];for(const R in z.glyphs){const N=z.glyphs[+R];if(!N||N.bitmap.width===0||N.bitmap.height===0)continue;const $=n[I][R],W=N.metrics.localGlyph?a7:1;Eu.copy(N.bitmap,b,{x:0,y:0},{x:$.x+W,y:$.y+W},N.bitmap)}}this.image=b,this.positions=n}}Ft(l7,"GlyphAtlas");class Tb{constructor(e){this.tileID=new Ln(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Zd(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,u,f,g){this.status="parsing",this.data=e,this.collisionBoxArray=new jr;const b=new Gg(Object.keys(e.layers).sort()),I=new n7(this.tileID,this.promoteId);I.bucketLayerIDs=[];const z={},R=new s7(256,256),N={featureIndex:I,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:R,availableImages:u},$=n.familiesBySource[this.source];for(const it in $){const et=e.layers[it];if(!et)continue;let Ot=!1,Lt=!1;for(const Vt of $[it])Vt[0].type==="symbol"?Ot=!0:Lt=!0;if(this.isSymbolTile===!0&&!Ot||this.isSymbolTile===!1&&!Lt)continue;et.version===1&&sn(`Vector tile source "${this.source}" layer "${it}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ti=b.encode(it),vi=[];for(let Vt=0;Vt<et.length;Vt++){const ni=et.feature(Vt),oi=I.getId(ni,it);vi.push({feature:ni,id:oi,index:Vt,sourceLayerIndex:ti})}for(const Vt of $[it]){const ni=Vt[0];this.isSymbolTile!==void 0&&ni.type==="symbol"!==this.isSymbolTile||ni.minzoom&&this.zoom<Math.floor(ni.minzoom)||ni.maxzoom&&this.zoom>=ni.maxzoom||ni.visibility!=="none"&&(m4(Vt,this.zoom,u),(z[ni.id]=ni.createBucket({index:I.bucketLayerIDs.length,layers:Vt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ti,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:u})).populate(vi,N,this.tileID.canonical,this.tileTransform),I.bucketLayerIDs.push(Vt.map(oi=>oi.id)))}}let W,Q,te,ce;R.trim();const we={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Re=()=>{if(W)return g(W);if(Q&&te&&ce){const it=new l7(Q),et=new mg(te,ce);for(const Ot in z){const Lt=z[Ot];Lt instanceof $1?(m4(Lt.layers,this.zoom,u),Hv(Lt,Q,it.positions,te,et.iconPositions,this.showCollisionBoxes,u,this.tileID.canonical,this.tileZoom,this.projection)):Lt.hasPattern&&(Lt instanceof Pl||Lt instanceof L||Lt instanceof zr)&&(m4(Lt.layers,this.zoom,u),Lt.addFeatures(N,this.tileID.canonical,et.patternPositions,u,this.tileTransform))}this.status="done",g(null,{buckets:lr(z).filter(Ot=>!Ot.isEmpty()),featureIndex:I,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:it.image,lineAtlas:R,imageAtlas:et,glyphMap:this.returnDependencies?Q:null,iconMap:this.returnDependencies?te:null,glyphPositions:this.returnDependencies?it.positions:null})}},He=Ir(N.glyphDependencies,it=>Object.keys(it).map(Number));Object.keys(He).length?f.send("getGlyphs",{uid:this.uid,stacks:He},(it,et)=>{W||(W=it,Q=et,Re())},void 0,!1,we):Q={};const Be=Object.keys(N.iconDependencies);Be.length?f.send("getImages",{icons:Be,source:this.source,tileID:this.tileID,type:"icons"},(it,et)=>{W||(W=it,te=et,Re())},void 0,!1,we):te={};const We=Object.keys(N.patternDependencies);We.length?f.send("getImages",{icons:We,source:this.source,tileID:this.tileID,type:"patterns"},(it,et)=>{W||(W=it,ce=et,Re())},void 0,!1,we):ce={},Re()}}function m4(r,e,n){const u=new G(e);for(const f of r)f.recalculate(u,n)}class c7{constructor(e){this.entries={},this.scheduler=e}request(e,n,u,f){const g=this.entries[e]=this.entries[e]||{callbacks:[]};if(g.result){const[b,I]=g.result;return this.scheduler?this.scheduler.add(()=>{f(b,I)},n):f(b,I),()=>{}}return g.callbacks.push(f),g.cancel||(g.cancel=u((b,I)=>{g.result=[b,I];for(const z of g.callbacks)this.scheduler?this.scheduler.add(()=>{z(b,I)},n):z(b,I);setTimeout(()=>delete this.entries[e],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(b=>b!==f),g.callbacks.length||(g.cancel(),delete this.entries[e]))}}}function u7(r,e,n){const u=JSON.stringify(r.request);return r.data&&(this.deduped.entries[u]={result:[null,r.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},f=>{const g=Ii(r.request,(b,I,z,R)=>{b?f(b):I&&f(null,{vectorTile:n?void 0:new Vi(new Bm(I)),rawData:I,cacheControl:z,expires:R})});return()=>{g.cancel(),f()}},e)}const h7=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class _4{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,u]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=u>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const g=h7[15&u];if(!g)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(e,2,1),[I]=new Uint32Array(e,4,1);return new _4(I,b,g,e)}constructor(e,n=64,u=Float64Array,f){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=u,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const g=h7.indexOf(this.ArrayType),b=2*e*this.ArrayType.BYTES_PER_ELEMENT,I=e*this.IndexArrayType.BYTES_PER_ELEMENT,z=(8-I%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${u}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+I+z,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+b+I+z),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+I+z,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=e,this.coords[this._pos++]=n,u}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return g4(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:I}=this,z=[0,g.length-1,0],R=[];for(;z.length;){const N=z.pop()||0,$=z.pop()||0,W=z.pop()||0;if($-W<=I){for(let we=W;we<=$;we++){const Re=b[2*we],He=b[2*we+1];Re>=e&&Re<=u&&He>=n&&He<=f&&R.push(g[we])}continue}const Q=W+$>>1,te=b[2*Q],ce=b[2*Q+1];te>=e&&te<=u&&ce>=n&&ce<=f&&R.push(g[Q]),(N===0?e<=te:n<=ce)&&(z.push(W),z.push(Q-1),z.push(1-N)),(N===0?u>=te:f>=ce)&&(z.push(Q+1),z.push($),z.push(1-N))}return R}within(e,n,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:b}=this,I=[0,f.length-1,0],z=[],R=u*u;for(;I.length;){const N=I.pop()||0,$=I.pop()||0,W=I.pop()||0;if($-W<=b){for(let we=W;we<=$;we++)p7(g[2*we],g[2*we+1],e,n)<=R&&z.push(f[we]);continue}const Q=W+$>>1,te=g[2*Q],ce=g[2*Q+1];p7(te,ce,e,n)<=R&&z.push(f[Q]),(N===0?e-u<=te:n-u<=ce)&&(I.push(W),I.push(Q-1),I.push(1-N)),(N===0?e+u>=te:n+u>=ce)&&(I.push(Q+1),I.push($),I.push(1-N))}return z}}function g4(r,e,n,u,f,g){if(f-u<=n)return;const b=u+f>>1;d7(r,e,b,u,f,g),g4(r,e,n,u,b-1,1-g),g4(r,e,n,b+1,f,1-g)}function d7(r,e,n,u,f,g){for(;f>u;){if(f-u>600){const R=f-u+1,N=n-u+1,$=Math.log(R),W=.5*Math.exp(2*$/3),Q=.5*Math.sqrt($*W*(R-W)/R)*(N-R/2<0?-1:1);d7(r,e,n,Math.max(u,Math.floor(n-N*W/R+Q)),Math.min(f,Math.floor(n+(R-N)*W/R+Q)),g)}const b=e[2*n+g];let I=u,z=f;for(Of(r,e,u,n),e[2*f+g]>b&&Of(r,e,u,f);I<z;){for(Of(r,e,I,z),I++,z--;e[2*I+g]<b;)I++;for(;e[2*z+g]>b;)z--}e[2*u+g]===b?Of(r,e,u,z):(z++,Of(r,e,z,f)),z<=n&&(u=z+1),n<=z&&(f=z-1)}}function Of(r,e,n,u){y4(r,n,u),y4(e,2*n,2*u),y4(e,2*n+1,2*u+1)}function y4(r,e,n){const u=r[e];r[e]=r[n],r[n]=u}function p7(r,e,n,u){const f=r-n,g=e-u;return f*f+g*g}t.ARRAY_TYPE=As,t.AUTH_ERR_MSG=Je,t.Aabb=Os,t.Actor=class{constructor(r,e,n){this.target=r,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},eo(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ns()?r:j,this.scheduler=new _b}send(r,e,n,u,f=!1,g){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=g,this.callbacks[b]=n);const I=os(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:r,hasCallback:!!n,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:Sr(e,I)},I),{cancel:()=>{n&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(r){const e=r.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const u=this.cancelCallbacks[n];delete this.cancelCallbacks[n],u&&u.cancel()}else if(e.mustQueue||ns()){const u=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),u&&u.metadata||{type:"message"})}else this.processTask(n,e)}processTask(r,e){if(e.type==="<response>"){const n=this.callbacks[r];delete this.callbacks[r],n&&(e.error?n(ir(e.error)):n(null,ir(e.data)))}else{const n=os(this.globalScope)?void 0:[],u=e.hasCallback?(g,b)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:g?Sr(g):null,data:Sr(b,n)},n)}:g=>{},f=ir(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,f,u);else if(this.parent.getWorkerSource){const g=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,g[0],f.source)[g[1]](f,u)}else u(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.CanonicalTileID=Bo,t.Color=Kn,t.ColorMode=_h,t.CullFaceMode=Cu,t.DEMData=Hm,t.DataConstantProperty=ae,t.DedupedRequest=c7,t.DepthMode=Kp,t.EXTENT=sr,t.Elevation=class{isDataAvailableAtPoint(r){const e=this._source();if(this.isUsingMockSource()||!e||r.y<0||r.y>1)return!1;const n=e.getSource().maxzoom,u=1<<n,f=Math.floor(r.x),g=Math.floor((r.x-f)*u),b=Math.floor(r.y*u),I=this.findDEMTileFor(new Ln(n,f,n,g,b));return!(!I||!I.dem)}getAtPointOrZero(r,e=0){return this.getAtPoint(r,e)||0}getAtPoint(r,e,n=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const u=this._source();if(!u||r.y<0||r.y>1)return e;const f=u.getSource().maxzoom,g=1<<f,b=Math.floor(r.x),I=r.x-b,z=new Ln(f,b,f,Math.floor(I*g),Math.floor(r.y*g)),R=this.findDEMTileFor(z);if(!R||!R.dem)return e;const N=R.dem,$=1<<R.tileID.canonical.z,W=(I*$-R.tileID.canonical.x)*N.dim,Q=(r.y*$-R.tileID.canonical.y)*N.dim,te=Math.floor(W),ce=Math.floor(Q);return(n?this.exaggeration():1)*Kr(Kr(N.get(te,ce),N.get(te,ce+1),Q-ce),Kr(N.get(te+1,ce),N.get(te+1,ce+1),Q-ce),W-te)}getAtTileOffset(r,e,n){const u=1<<r.canonical.z;return this.getAtPointOrZero(new z1(r.wrap+(r.canonical.x+e/sr)/u,(r.canonical.y+n/sr)/u))}getAtTileOffsetFunc(r,e,n,u){return f=>{const g=this.getAtTileOffset(r,f.x,f.y),b=u.upVector(r.canonical,f.x,f.y);return tl(b,b,g*u.upVectorScale(r.canonical,e,n).metersToTile),b}}getForTilePoints(r,e,n,u){if(this.isUsingMockSource())return!1;const f=Km.create(this,r,u);return!!f&&(e.forEach(g=>{g[2]=this.exaggeration()*f.getElevationAt(g[0],g[1],n)}),!0)}getMinMaxForTile(r){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(r);if(!e||!e.dem)return null;const n=e.dem.tree,u=e.tileID,f=1<<r.canonical.z-u.canonical.z;let g=r.canonical.x/f-u.canonical.x,b=r.canonical.y/f-u.canonical.y,I=0;for(let z=0;z<r.canonical.z-u.canonical.z&&!n.leaves[I];z++){g*=2,b*=2;const R=2*Math.floor(b)+Math.floor(g);I=n.childOffsets[I]+R,g%=1,b%=1}return{min:this.exaggeration()*n.minimums[I],max:this.exaggeration()*n.maximums[I]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Qi,t.EvaluationParameters=G,t.Event=Mr,t.Evented=Pr,t.FillExtrusionBucket=zr,t.Frustum=of,t.FrustumCorners=nf,t.GLOBE_RADIUS=Ia,t.GLOBE_SCALE_MATCH_LATITUDE=45,t.GLOBE_ZOOM_THRESHOLD_MAX=am,t.GLOBE_ZOOM_THRESHOLD_MIN=sf,t.GlobeSharedBuffers=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.withSkirts.destroy(),r.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const r of this._wireframeSegments)r.destroy()}}_fillGridMeshWithLods(r,e){const n=new yi,u=new er,f=[],g=r+1+2,b=e[0]+1,I=e[0]+1+(1+e.length),z=(R,N,$)=>{let W=R===g-1?R-2:R===0?R:R-1;return W+=$?24575:0,[W,N]};for(let R=0;R<g;++R)n.emplaceBack(...z(R,0,!0));for(let R=0;R<b;++R)for(let N=0;N<g;++N)n.emplaceBack(...z(N,R,(N===0||N===g-1)&&!0));for(let R=0;R<e.length;++R){const N=e[R];for(let $=0;$<g;++$)n.emplaceBack(...z($,N,!0))}for(let R=0;R<e.length;++R){const N=u.length,$=e[R]+1+2,W=new er;for(let ce=0;ce<$-1;ce++){const we=ce===$-2,Re=we?g*(I-e.length+R-ce):g;for(let He=0;He<g-1;He++){const Be=ce*g+He;ce===0||we||He===0||He===g-2?(W.emplaceBack(Be+1,Be,Be+Re),W.emplaceBack(Be+Re,Be+Re+1,Be+1)):(u.emplaceBack(Be+1,Be,Be+Re),u.emplaceBack(Be+Re,Be+Re+1,Be+1))}}const Q=co.simpleSegment(0,N,n.length,u.length-N);for(let ce=0;ce<W.uint16.length;ce+=3)u.emplaceBack(W.uint16[ce],W.uint16[ce+1],W.uint16[ce+2]);const te=co.simpleSegment(0,N,n.length,u.length-N);f.push({withoutSkirts:Q,withSkirts:te})}return{vertices:n,indices:u,segments:f}}_createGrid(r){const e=this._fillGridMeshWithLods(bu,C1);this._gridSegments=e.segments,this._gridBuffer=r.createVertexBuffer(e.vertices,M1.members),this._gridIndexBuffer=r.createIndexBuffer(e.indices,!0)}_createPoles(r){const e=new er;for(let f=0;f<=bu;f++)e.emplaceBack(0,f+1,f+2);this._poleIndexBuffer=r.createIndexBuffer(e,!0);const n=new fn,u=new fn;this._poleSegments=[];for(let f=0,g=0;f<sf;f++){const b=360/(1<<f);n.emplaceBack(0,-Ia,0,.5,0),u.emplaceBack(0,-Ia,0,.5,1);for(let I=0;I<=bu;I++){const z=I/bu,R=Kr(0,b,z),[N,$,W]=A1(pm,Ip,R,Ia);n.emplaceBack(N,$,W,z,0),u.emplaceBack(N,$,W,z,1)}this._poleSegments.push(co.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(n,ef,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(u,ef,!1)}getGridBuffers(r,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[r].withSkirts:this._gridSegments[r].withoutSkirts]}getPoleBuffers(r){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}getWirefameBuffers(r,e){if(!this._wireframeSegments){const n=new go,u=bu,f=u+1+2,g=1;this._wireframeSegments=[];for(let b=0,I=0;b<C1.length;b++){const z=C1[b];for(let N=g;N<z+g;N++)for(let $=g;$<u+g;$++){const W=N*f+$;n.emplaceBack(W,W+1),n.emplaceBack(W,W+f),n.emplaceBack(W,W+f+1)}const R=z*u*3;this._wireframeSegments.push(co.simpleSegment(0,I,(z+1)*f,R)),I+=R}this._wireframeIndexBuffer=r.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},t.GlyphManager=Zp,t.ImagePosition=Q5,t.KDBush=_4,t.LivePerformanceUtils=Dt,t.LngLat=gn,t.LngLatBounds=oh,t.LocalGlyphMode=i4,t.MAX_MERCATOR_LATITUDE=es,t.MercatorCoordinate=z1,t.ONE_EM=Oo,t.OverscaledTileID=Ln,t.PerformanceMarkers=ut,t.Point=zt,t.Properties=Ge,t.RGBAImage=Qs,t.Ray=rf,t.RequestManager=class{constructor(r,e,n){this._transformRequestFn=r,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const r=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Le,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,e){return this._transformRequestFn&&this._transformRequestFn(r,e)||{url:r}}normalizeStyleURL(r,e){if(!ot(r))return r;const n=wi(r);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(r,e){if(!ot(r))return r;const n=wi(r);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(r,e,n,u){if(!ot(r))return r;const f=wi(r);return f.path=`/v4/${f.authority}.json`,f.params.push("secure"),n&&f.params.push(`language=${n}`),u&&f.params.push(`worldview=${u}`),this._makeAPIURL(f,this._customAccessToken||e)}normalizeSpriteURL(r,e,n,u){const f=wi(r);return ot(r)?(f.path=`/styles/v1${f.path}/sprite${e}${n}`,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=`${e}${n}`,Pe(f))}normalizeTileURL(r,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!ot(r))return r;const u=wi(r);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&u.authority!=="raster"&&n===512?"@2x":""}${ne.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${he.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${he.TILE_URL_VERSION}${u.path}`);const f=this._customAccessToken||function(g){for(const b of g){const I=b.match(/^access_token=(.*)$/);if(I)return I[1]}return null}(u.params)||he.ACCESS_TOKEN;return he.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,f)}canonicalizeTileURL(r,e){const n=wi(r);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return r;let u="mapbox://";n.path.match(/^\/raster\/v1\//)?u+=`raster/${n.path.replace(`/${he.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${n.path.replace(`/${he.TILE_URL_VERSION}/`,"")}`;let f=n.params;return e&&(f=f.filter(g=>!g.match(/^access_token=/))),f.length&&(u+=`?${f.join("&")}`),u}canonicalizeTileset(r,e){const n=!!e&&ot(e),u=[];for(const f of r.tiles||[])Tt(f)?u.push(this.canonicalizeTileURL(f,n)):u.push(f);return u}_makeAPIURL(r,e){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=wi(he.API_URL);if(r.protocol=u.protocol,r.authority=u.authority,r.protocol==="http"){const f=r.params.indexOf("secure");f>=0&&r.params.splice(f,1)}if(u.path!=="/"&&(r.path=`${u.path}${r.path}`),!he.REQUIRE_ACCESS_TOKEN)return Pe(r);if(e=e||he.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return r.params=r.params.filter(f=>f.indexOf("access_token")===-1),r.params.push(`access_token=${e||""}`),Pe(r)}},t.ResourceType=zn,t.SegmentVector=co,t.SourceCache=qd,t.StencilMode=d4,t.StructArrayLayout1ui2=Ma,t.StructArrayLayout2f1f2i16=cr,t.StructArrayLayout2i4=yi,t.StructArrayLayout2ui4=go,t.StructArrayLayout3f12=Fr,t.StructArrayLayout3ui6=er,t.StructArrayLayout4i8=Zt,t.StructArrayLayout5f20=fn,t.Texture=Bf,t.Tile=u4,t.Transitionable=oe,t.Uniform1f=Sd,t.Uniform1i=class extends Cl{constructor(r){super(r),this.current=0}set(r,e,n){this.fetchUniformLocation(r,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},t.Uniform2f=class extends Cl{constructor(r){super(r),this.current=[0,0]}set(r,e,n){this.fetchUniformLocation(r,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},t.Uniform3f=class extends Cl{constructor(r){super(r),this.current=[0,0,0]}set(r,e,n){this.fetchUniformLocation(r,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},t.Uniform4f=rh,t.UniformColor=b1,t.UniformMatrix2f=class extends Cl{constructor(r){super(r),this.current=V5}set(r,e,n){if(this.fetchUniformLocation(r,e)){for(let u=0;u<4;u++)if(n[u]!==this.current[u]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}},t.UniformMatrix3f=class extends Cl{constructor(r){super(r),this.current=N5}set(r,e,n){if(this.fetchUniformLocation(r,e)){for(let u=0;u<9;u++)if(n[u]!==this.current[u]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}},t.UniformMatrix4f=class extends Cl{constructor(r){super(r),this.current=U5}set(r,e,n){if(this.fetchUniformLocation(r,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let u=1;u<16;u++)if(n[u]!==this.current[u]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},t.UnwrappedTileID=Ps,t.ValidationError=Fi,t.VectorTileFeature=Li,t.VectorTileWorkerSource=class extends Pr{constructor(r,e,n,u,f){super(),this.actor=r,this.layerIndex=e,this.availableImages=n,this.loadVectorData=f||u7,this.loading={},this.loaded={},this.deduped=new c7(r.scheduler),this.isSpriteLoaded=u,this.scheduler=r.scheduler}loadTile(r,e){const n=r.uid,u=r&&r.request,f=u&&u.collectResourceTiming,g=this.loading[n]=new Tb(r);g.abort=this.loadVectorData(r,(b,I)=>{const z=!this.loading[n];if(delete this.loading[n],z||b||!I)return g.status="done",z||(this.loaded[n]=g),e(b);const R=I.rawData,N={};I.expires&&(N.expires=I.expires),I.cacheControl&&(N.cacheControl=I.cacheControl),g.vectorTile=I.vectorTile||new Vi(new Bm(R));const $=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,(W,Q)=>{if(W||!Q)return e(W);const te={};if(f){const ce=ji(u);ce.length>0&&(te.resourceTiming=JSON.parse(JSON.stringify(ce)))}e(null,mr({rawTileData:R.slice(0)},Q,N,te))})};this.isSpriteLoaded?$():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add($,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):$()}),this.loaded=this.loaded||{},this.loaded[n]=g})}reloadTile(r,e){const n=this.loaded,u=r.uid,f=this;if(n&&n[u]){const g=n[u];g.showCollisionBoxes=r.showCollisionBoxes,g.enableTerrain=!!r.enableTerrain,g.projection=r.projection,g.tileTransform=Zd(r.tileID.canonical,r.projection);const b=(I,z)=>{const R=g.reloadCallback;R&&(delete g.reloadCallback,g.parse(g.vectorTile,f.layerIndex,this.availableImages,f.actor,R)),e(I,z)};g.status==="parsing"?g.reloadCallback=b:g.status==="done"&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,b):b())}}abortTile(r,e){const n=r.uid,u=this.loading[n];u&&(u.abort&&u.abort(),delete this.loading[n]),e()}removeTile(r,e){const n=this.loaded,u=r.uid;n&&n[u]&&delete n[u],e()}},t.WritingMode=pc,t.ZoomDependentExpression=Jo,t.add=vu,t.addDynamicAttributes=qm,t.adjoint=function(r,e){var n=e[0],u=e[1],f=e[2],g=e[3],b=e[4],I=e[5],z=e[6],R=e[7],N=e[8];return r[0]=b*N-I*R,r[1]=f*R-u*N,r[2]=u*I-f*b,r[3]=I*z-g*N,r[4]=n*N-f*z,r[5]=f*g-n*I,r[6]=g*R-b*z,r[7]=u*z-n*R,r[8]=n*b-u*g,r},t.asyncAll=Wi,t.bezier=Mt,t.bindAll=eo,t.boundsAttributes=qg,t.bufferConvexPolygon=function(r,e){const n=[];for(let u=0;u<r.length;u++){const f=Si(u-1,-1,r.length-1),g=Si(u+1,-1,r.length-1),b=r[u],I=r[g],z=r[f].sub(b).unit(),R=I.sub(b).unit(),N=R.angleWithSep(z.x,z.y),$=z.add(R).unit().mult(-1*e/Math.sin(N/2));n.push(b.add($))}return n},t.cacheEntryPossiblyAdded=function(r){Gr++,Gr>Zs&&(r.getActor().send("enforceCacheSizeLimit",Eo),Gr=0)},t.calculateGlobeLabelMatrix=function(r,e){const{x:n,y:u}=r.point,f=hm(n,u,r.worldSize/r._pixelsPerMercatorPixel,0,0);return xu(f,f,Sp(pa(e)))},t.calculateGlobeMatrix=function(r){const{x:e,y:n}=r.point,{lng:u,lat:f}=r._center;return hm(e,n,r.worldSize,u,f)},t.calculateGlobeMercatorMatrix=function(r){const e=r.pixelsPerMeter,n=e/uc(1,r.center.lat),u=nc(new Float64Array(16));return jh(u,u,[r.point.x,r.point.y,0]),Gh(u,u,[n,n,e]),Float32Array.from(u)},t.circumferenceAtLatitude=cf,t.clamp=pt,t.clearTileCache=function(r){if(!Mi())return;const e=j.caches.delete(to);r&&e.catch(r).then(()=>r())},t.clipLine=Ig,t.clone=function(r){var e=new As(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},t.clone$1=hn,t.collisionCircleLayout=Mf,t.config=he,t.conjugate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r},t.create=function(){var r=new As(16);return As!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},t.create$1=Y2,t.createExpression=Ta,t.createLayout=yt,t.createStyleLayer=function(r){return r.type==="custom"?new db(r):new fb[r.type](r)},t.cross=$h,t.degToRad=ki,t.distance=function(r,e){return Math.hypot(e[0]-r[0],e[1]-r[1],e[2]-r[2])},t.div=function(r,e,n){return r[0]=e[0]/n[0],r[1]=e[1]/n[1],r[2]=e[2]/n[2],r},t.dot=Ca,t.earthRadius=wu,t.ease=ui,t.easeCubicInOut=$t,t.ecefToLatLng=function([r,e,n]){const u=Math.hypot(r,e,n),f=Math.atan2(r,n),g=.5*Math.PI-Math.acos(-e/u);return new gn(fr(f),fr(g))},t.emitValidationErrors=Bt,t.endsWith=Rs,t.enforceCacheSizeLimit=function(r){Xo(),qn&&qn.then(e=>{e.keys().then(n=>{for(let u=0;u<n.length-r;u++)e.delete(n[u])})})},t.evaluateSizeForFeature=jp,t.evaluateSizeForZoom=U1,t.evaluateVariableOffset=Dg,t.evented=E,t.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]},t.exactEquals$1=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]},t.exported=br,t.exported$1=ne,t.extend=mr,t.extend$1=Tn,t.fillExtrusionHeightLift=Ro,t.filterObject=wn,t.fromMat4=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r},t.fromQuat=function(r,e){var n=e[0],u=e[1],f=e[2],g=e[3],b=n+n,I=u+u,z=f+f,R=n*b,N=u*b,$=u*I,W=f*b,Q=f*I,te=f*z,ce=g*b,we=g*I,Re=g*z;return r[0]=1-$-te,r[1]=N+Re,r[2]=W-we,r[3]=0,r[4]=N-Re,r[5]=1-R-te,r[6]=Q+ce,r[7]=0,r[8]=W+we,r[9]=Q-ce,r[10]=1-R-$,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},t.fromRotation=function(r,e){var n=Math.sin(e),u=Math.cos(e);return r[0]=u,r[1]=n,r[2]=0,r[3]=-n,r[4]=u,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},t.fromScaling=J2,t.furthestTileCorner=function(r){const e=Math.round((r+45+360)%360/90)%4;return Qt[e]},t.getAABBPointSquareDist=function(r,e,n){let u=0;for(let f=0;f<2;++f){const g=n?n[f]:0;r[f]>g&&(u+=(r[f]-g)*(r[f]-g)),e[f]<g&&(u+=(g-e[f])*(g-e[f]))}return u},t.getAnchorAlignment=t4,t.getAnchorJustification=n4,t.getBounds=function(r){let e=1/0,n=1/0,u=-1/0,f=-1/0;for(const g of r)e=Math.min(e,g.x),n=Math.min(n,g.y),u=Math.max(u,g.x),f=Math.max(f,g.y);return{min:new zt(e,n),max:new zt(u,f)}},t.getColumn=ys,t.getDefaultExportFromCjs=je,t.getGridMatrix=function(r,e,n,u){const f=e.getNorth(),g=e.getSouth(),b=e.getWest(),I=e.getEast(),z=1<<r.z,R=I-b,N=f-g,$=R/bu,W=-N/C1[n],Q=[0,$,0,W,0,0,f,b,0];if(r.z>0){const te=180/u;bp(Q,Q,[te/R+1,0,0,0,te/N+1,0,-.5*te/$,.5*te/W,1])}return Q[2]=z,Q[5]=r.x,Q[8]=r.y,Q},t.getImage=Ae,t.getJSON=function(r,e){return Ao(mr(r,{type:"json"}),e)},t.getLatitudinalLod=function(r){const e=es-5;r=pt(r,-e,e)/e*90;const n=Math.pow(Math.abs(Math.sin(ki(r))),3);return Math.round(n*(C1.length-1))},t.getMapSessionAPI=$e,t.getPerformanceMeasurement=ji,t.getProjection=Vg,t.getRTLTextPluginStatus=A,t.getReferrer=io,t.getTilePoint=function(r,{x:e,y:n},u=0){return new zt(((e-u)*r.scale-r.x)*sr,(n*r.scale-r.y)*sr)},t.getTileVec3=function(r,e,n=0){return E1(((e.x-n)*r.scale-r.x)*sr,(e.y*r.scale-r.y)*sr,Ap(e.z,e.y))},t.getVideo=function(r,e){const n=j.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let u=0;u<r.length;u++){const f=j.document.createElement("source");Tr(r[u])||(n.crossOrigin="Anonymous"),f.src=r[u],n.appendChild(f)}return{cancel:()=>{}}},t.globeCenterToScreenPoint=function(r){const e=[0,0,0],n=nc(new Float64Array(16));return xu(n,r.pixelMatrix,r.globeMatrix),oo(e,e,n),new zt(e[0],e[1])},t.globeDenormalizeECEF=Sp,t.globeECEFOrigin=function(r,e){const n=[0,0,0];return oo(n,n,Nc(pa(e.canonical))),oo(n,n,r),n},t.globeMetersToEcef=I1,t.globeNormalizeECEF=Nc,t.globePixelsToTileUnits=function(r,e){return sr/(512*Math.pow(2,r))*Ep(pa(e))},t.globePoleMatrixForTile=function(r,e,n){const u=nc(new Float64Array(16)),f=(e/(1<<r)-.5)*Math.PI*2;return wp(u,n.globeMatrix,f),Float32Array.from(u)},t.globeTileBounds=pa,t.globeTiltAtLngLat=dm,t.globeToMercatorTransition=k1,t.globeUseCustomAntiAliasing=function(r,e,n){const u=k1(n.zoom),f=r.style.map._antialias,g=!!e.extStandardDerivatives,b=e.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return u===0&&!f&&!b&&g},t.identity=nc,t.identity$1=om,t.invert=Pd,t.isFullscreen=function(){return!!j.document.fullscreenElement||!!j.document.webkitFullscreenElement},t.isLngLatBehindGlobe=Mp,t.isMapAuthenticated=function(r){return Ve.has(r)},t.isMapboxURL=ot,t.isSafariWithAntialiasingBug=function(r){const e=r.navigator?r.navigator.userAgent:null;return!!os(r)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},t.latFromMercatorY=us,t.latLngToECEF=P1,t.len=tm,t.length=Uc,t.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},t.lngFromMercatorX=Aa,t.loadVectorTile=u7,t.makeRequest=Ao,t.mapValue=function(r,e,n,u,f){return pt((r-e)/(n-e)*(f-u)+u,u,f)},t.mercatorScale=fm,t.mercatorXfromLng=lc,t.mercatorYfromLat=cc,t.mercatorZfromAltitude=uc,t.mul=sh,t.mul$1=Ld,t.multiply=xu,t.multiply$1=bp,t.multiply$2=Y0,t.nextPowerOfTwo=on,t.normalize=Js,t.normalize$1=Q0,t.normalize$2=rm,t.number=Kr,t.ortho=function(r,e,n,u,f,g,b){var I=1/(e-n),z=1/(u-f),R=1/(g-b);return r[0]=-2*I,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*z,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*R,r[11]=0,r[12]=(e+n)*I,r[13]=(f+u)*z,r[14]=(b+g)*R,r[15]=1,r},t.pbf=Dl,t.perspective=function(r,e,n,u,f){var g,b=1/Math.tan(e/2);return r[0]=b/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,f!=null&&f!==1/0?(r[10]=(f+u)*(g=1/(u-f)),r[14]=2*f*u*g):(r[10]=-1,r[14]=-2*u),r},t.pick=function(r,e){const n={};for(let u=0;u<e.length;u++){const f=e[u];f in r&&(n[f]=r[f])}return n},t.plugin=O,t.pointGeometry=dt,t.polesInViewport=function(r){const e=nc(new Float64Array(16));xu(e,r.pixelMatrix,r.globeMatrix);const n=[0,il,0],u=[0,Hr,0];return oo(n,n,e),oo(u,u,e),[n[0]>0&&n[0]<=r.width&&n[1]>0&&n[1]<=r.height&&!Mp(r,new gn(r.center.lat,90)),u[0]>0&&u[0]<=r.width&&u[1]>0&&u[1]<=r.height&&!Mp(r,new gn(r.center.lat,-90))]},t.polygonContainsPoint=Xh,t.polygonIntersectsBox=Hh,t.polygonIntersectsPolygon=hf,t.polygonizeBounds=function(r,e,n=0,u=!0){const f=new zt(n,n),g=r.sub(f),b=e.add(f),I=[g,new zt(b.x,g.y),b,new zt(g.x,b.y)];return u&&I.push(g.clone()),I},t.posAttributes=M1,t.postMapLoadEvent=fe,t.postPerformanceEvent=ke,t.postTurnstileEvent=Y,t.potpack=J5,t.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},t.radToDeg=fr,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(r){return r({pluginStatus:_,pluginURL:o}),E.on("pluginStateChange",r),r},t.removeAuthState=function(r){Ve.delete(r)},t.renderColorRamp=R1,t.resample=Vc,t.rotateX=W0,t.rotateX$1=sm,t.rotateY=wp,t.rotateY$1=J0,t.rotateZ=function(r,e,n){var u=Math.sin(n),f=Math.cos(n),g=e[0],b=e[1],I=e[2],z=e[3],R=e[4],N=e[5],$=e[6],W=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=g*f+R*u,r[1]=b*f+N*u,r[2]=I*f+$*u,r[3]=z*f+W*u,r[4]=R*f-g*u,r[5]=N*f-b*u,r[6]=$*f-I*u,r[7]=W*f-z*u,r},t.rotateZ$1=function(r,e,n){n*=.5;var u=e[0],f=e[1],g=e[2],b=e[3],I=Math.sin(n),z=Math.cos(n);return r[0]=u*z+f*I,r[1]=f*z-u*I,r[2]=g*z+b*I,r[3]=b*z-g*I,r},t.scale=Gh,t.scale$1=im,t.scale$2=tl,t.scaleAndAdd=zd,t.set=function(r,e,n,u){return r[0]=e,r[1]=n,r[2]=u,r},t.setCacheLimits=function(r,e){Eo=r,Zs=e},t.setColumn=function(r,e,n){r[4*e+0]=n[0],r[4*e+1]=n[1],r[4*e+2]=n[2],r[4*e+3]=n[3]},t.setRTLTextPlugin=function(r,e,n=!1){if(_===Sa||_===Ms||_===Qo)throw new Error("setRTLTextPlugin cannot be called multiple times.");o=br.resolveURL(r),_=Sa,Cs=e,x(),n||B()},t.smoothstep=hi,t.spec=It,t.squaredLength=function(r){var e=r[0],n=r[1],u=r[2];return e*e+n*n+u*u},t.storeAuthState=function(r,e){e?Ve.add(r):Ve.delete(r)},t.sub=oc,t.subtract=K0,t.symbolSize=W5,t.tileAABB=function(r,e,n,u,f,g,b,I,z){if(z.name==="globe")return G5(r,e,new Bo(n,u,f));const R=Zd({z:n,x:u,y:f},z);return new Os([(g+R.x/R.scale)*e,e*(R.y/R.scale),b],[(g+R.x2/R.scale)*e,e*(R.y2/R.scale),I])},t.tileCornersToBounds=Tp,t.tileTransform=Zd,t.transformMat3=function(r,e,n){var u=e[0],f=e[1],g=e[2];return r[0]=u*n[0]+f*n[3]+g*n[6],r[1]=u*n[1]+f*n[4]+g*n[7],r[2]=u*n[2]+f*n[5]+g*n[8],r},t.transformMat4=oo,t.transformMat4$1=Zh,t.transformQuat=em,t.transitionTileAABBinECEF=cm,t.translate=jh,t.transpose=function(r,e){if(r===e){var n=e[1],u=e[2],f=e[5];r[1]=e[3],r[2]=e[6],r[3]=n,r[5]=e[7],r[6]=u,r[7]=f}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r},t.triggerPluginCompletionEvent=d,t.uniqueId=rn,t.updateGlobeVertexNormal=function(r,e,n,u,f){const g=5*e+2;r.float32[g+0]=n,r.float32[g+1]=u,r.float32[g+2]=f},t.validateCustomStyleLayer=function(r){const e=[],n=r.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},t.validateFilter=r=>Rt(l(r)),t.validateFog=r=>Rt(qe(r)),t.validateLayer=r=>Rt(U(r)),t.validateLight=r=>Rt(me(r)),t.validateSource=r=>Rt(ee(r)),t.validateStyle=vt,t.validateTerrain=r=>Rt(be(r)),t.values=lr,t.vectorTile=Te,t.version=ie,t.warnOnce=sn,t.window=j,t.wrap=Si}),P(["./shared"],function(t){function j(De){if(typeof De=="number"||typeof De=="boolean"||typeof De=="string"||De==null)return JSON.stringify(De);if(Array.isArray(De)){let _e="[";for(const Ae of De)_e+=`${j(Ae)},`;return`${_e}]`}let de="{";for(const _e of Object.keys(De).sort())de+=`${_e}:${j(De[_e])},`;return`${de}}`}function ie(De){let de="";for(const _e of t.refProperties)de+=`/${j(De[_e])}`;return de}class ye{constructor(de){this.keyCache={},de&&this.replace(de)}replace(de){this._layerConfigs={},this._layers={},this.update(de,[])}update(de,_e){for(const Je of de)this._layerConfigs[Je.id]=Je,(this._layers[Je.id]=t.createStyleLayer(Je)).compileFilter(),this.keyCache[Je.id]&&delete this.keyCache[Je.id];for(const Je of _e)delete this.keyCache[Je],delete this._layerConfigs[Je],delete this._layers[Je];this.familiesBySource={};const Ae=function(Je,ot){const Tt={};for(let st=0;st<Je.length;st++){const xt=ot&&ot[Je[st].id]||ie(Je[st]);ot&&(ot[Je[st].id]=xt);let gi=Tt[xt];gi||(gi=Tt[xt]=[]),gi.push(Je[st])}const mt=[];for(const st in Tt)mt.push(Tt[st]);return mt}(t.values(this._layerConfigs),this.keyCache);for(const Je of Ae){const ot=Je.map(wi=>this._layers[wi.id]),Tt=ot[0];if(Tt.visibility==="none")continue;const mt=Tt.source||"";let st=this.familiesBySource[mt];st||(st=this.familiesBySource[mt]={});const xt=Tt.sourceLayer||"_geojsonTileLayer";let gi=st[xt];gi||(gi=st[xt]=[]),gi.push(ot)}}}class he{loadTile(de,_e){const{uid:Ae,encoding:Je,rawImageData:ot,padding:Tt,buildQuadTree:mt}=de,st=t.window.ImageBitmap&&ot instanceof t.window.ImageBitmap?this.getImageData(ot,Tt):ot;_e(null,new t.DEMData(Ae,st,Je,Tt<1,mt))}getImageData(de,_e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(de.width,de.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=de.width,this.offscreenCanvas.height=de.height,this.offscreenCanvasContext.drawImage(de,0,0,de.width,de.height);const Ae=this.offscreenCanvasContext.getImageData(-_e,-_e,de.width+2*_e,de.height+2*_e);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ae}}function ne(De,de){if(De.length!==0){Ye(De[0],de);for(var _e=1;_e<De.length;_e++)Ye(De[_e],!de)}}function Ye(De,de){for(var _e=0,Ae=0,Je=0,ot=De.length,Tt=ot-1;Je<ot;Tt=Je++){var mt=(De[Je][0]-De[Tt][0])*(De[Tt][1]+De[Je][1]),st=_e+mt;Ae+=Math.abs(_e)>=Math.abs(mt)?_e-st+mt:mt-st+_e,_e=st}_e+Ae>=0!=!!de&&De.reverse()}var lt=t.getDefaultExportFromCjs(function De(de,_e){var Ae,Je=de&&de.type;if(Je==="FeatureCollection")for(Ae=0;Ae<de.features.length;Ae++)De(de.features[Ae],_e);else if(Je==="GeometryCollection")for(Ae=0;Ae<de.geometries.length;Ae++)De(de.geometries[Ae],_e);else if(Je==="Feature")De(de.geometry,_e);else if(Je==="Polygon")ne(de.coordinates,_e);else if(Je==="MultiPolygon")for(Ae=0;Ae<de.coordinates.length;Ae++)ne(de.coordinates[Ae],_e);return de});const at=t.VectorTileFeature.prototype.toGeoJSON;var Kt={exports:{}},Ne=t.pointGeometry,Le=t.vectorTile.VectorTileFeature,je=_t;function _t(De,de){this.options=de||{},this.features=De,this.length=De.length}function St(De,de){this.id=typeof De.id=="number"?De.id:void 0,this.type=De.type,this.rawGeometry=De.type===1?[De.geometry]:De.geometry,this.properties=De.tags,this.extent=de||4096}_t.prototype.feature=function(De){return new St(this.features[De],this.options.extent)},St.prototype.loadGeometry=function(){var De=this.rawGeometry;this.geometry=[];for(var de=0;de<De.length;de++){for(var _e=De[de],Ae=[],Je=0;Je<_e.length;Je++)Ae.push(new Ne(_e[Je][0],_e[Je][1]));this.geometry.push(Ae)}return this.geometry},St.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var De=this.geometry,de=1/0,_e=-1/0,Ae=1/0,Je=-1/0,ot=0;ot<De.length;ot++)for(var Tt=De[ot],mt=0;mt<Tt.length;mt++){var st=Tt[mt];de=Math.min(de,st.x),_e=Math.max(_e,st.x),Ae=Math.min(Ae,st.y),Je=Math.max(Je,st.y)}return[de,Ae,_e,Je]},St.prototype.toGeoJSON=Le.prototype.toGeoJSON;var ci=t.pbf,dt=je;function ri(De){var de=new ci;return function(_e,Ae){for(var Je in _e.layers)Ae.writeMessage(3,zt,_e.layers[Je])}(De,de),de.finish()}function zt(De,de){var _e;de.writeVarintField(15,De.version||1),de.writeStringField(1,De.name||""),de.writeVarintField(5,De.extent||4096);var Ae={keys:[],values:[],keycache:{},valuecache:{}};for(_e=0;_e<De.length;_e++)Ae.feature=De.feature(_e),de.writeMessage(2,Ci,Ae);var Je=Ae.keys;for(_e=0;_e<Je.length;_e++)de.writeStringField(3,Je[_e]);var ot=Ae.values;for(_e=0;_e<ot.length;_e++)de.writeMessage(4,$t,ot[_e])}function Ci(De,de){var _e=De.feature;_e.id!==void 0&&de.writeVarintField(1,_e.id),de.writeMessage(2,yr,De),de.writeVarintField(3,_e.type),de.writeMessage(4,Qt,_e)}function yr(De,de){var _e=De.feature,Ae=De.keys,Je=De.values,ot=De.keycache,Tt=De.valuecache;for(var mt in _e.properties){var st=_e.properties[mt],xt=ot[mt];if(st!==null){xt===void 0&&(Ae.push(mt),ot[mt]=xt=Ae.length-1),de.writeVarint(xt);var gi=typeof st;gi!=="string"&&gi!=="boolean"&&gi!=="number"&&(st=JSON.stringify(st));var wi=gi+":"+st,Pe=Tt[wi];Pe===void 0&&(Je.push(st),Tt[wi]=Pe=Je.length-1),de.writeVarint(Pe)}}}function ki(De,de){return(de<<3)+(7&De)}function fr(De){return De<<1^De>>31}function Qt(De,de){for(var _e=De.loadGeometry(),Ae=De.type,Je=0,ot=0,Tt=_e.length,mt=0;mt<Tt;mt++){var st=_e[mt],xt=1;Ae===1&&(xt=st.length),de.writeVarint(ki(1,xt));for(var gi=Ae===3?st.length-1:st.length,wi=0;wi<gi;wi++){wi===1&&Ae!==1&&de.writeVarint(ki(2,gi-1));var Pe=st[wi].x-Je,ct=st[wi].y-ot;de.writeVarint(fr(Pe)),de.writeVarint(fr(ct)),Je+=Pe,ot+=ct}Ae===3&&de.writeVarint(ki(7,1))}}function $t(De,de){var _e=typeof De;_e==="string"?de.writeStringField(1,De):_e==="boolean"?de.writeBooleanField(7,De):_e==="number"&&(De%1!=0?de.writeDoubleField(3,De):De<0?de.writeSVarintField(6,De):de.writeVarintField(5,De))}Kt.exports=ri,Kt.exports.fromVectorTileJs=ri,Kt.exports.fromGeojsonVt=function(De,de){de=de||{};var _e={};for(var Ae in De)_e[Ae]=new dt(De[Ae].features,de),_e[Ae].name=Ae,_e[Ae].version=de.version,_e[Ae].extent=de.extent;return ri({layers:_e})},Kt.exports.GeoJSONWrapper=dt;var Mt=t.getDefaultExportFromCjs(Kt.exports);const ui={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:De=>De},pt=Math.fround||(hi=new Float32Array(1),De=>(hi[0]=+De,hi[0]));var hi;const Si=3,Wi=5,lr=6;class mr{constructor(de){this.options=Object.assign(Object.create(ui),de),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(de){const{log:_e,minZoom:Ae,maxZoom:Je}=this.options;_e&&console.time("total time");const ot=`prepare ${de.length} points`;_e&&console.time(ot),this.points=de;const Tt=[];for(let st=0;st<de.length;st++){const xt=de[st];if(!xt.geometry)continue;const[gi,wi]=xt.geometry.coordinates,Pe=pt(nn(gi)),ct=pt(on(wi));Tt.push(Pe,ct,1/0,st,-1,1),this.options.reduce&&Tt.push(0)}let mt=this.trees[Je+1]=this._createTree(Tt);_e&&console.timeEnd(ot);for(let st=Je;st>=Ae;st--){const xt=+Date.now();mt=this.trees[st]=this._createTree(this._cluster(mt,st)),_e&&console.log("z%d: %d clusters in %dms",st,mt.numItems,+Date.now()-xt)}return _e&&console.timeEnd("total time"),this}getClusters(de,_e){let Ae=((de[0]+180)%360+360)%360-180;const Je=Math.max(-90,Math.min(90,de[1]));let ot=de[2]===180?180:((de[2]+180)%360+360)%360-180;const Tt=Math.max(-90,Math.min(90,de[3]));if(de[2]-de[0]>=360)Ae=-180,ot=180;else if(Ae>ot){const wi=this.getClusters([Ae,Je,180,Tt],_e),Pe=this.getClusters([-180,Je,ot,Tt],_e);return wi.concat(Pe)}const mt=this.trees[this._limitZoom(_e)],st=mt.range(nn(Ae),on(Tt),nn(ot),on(Je)),xt=mt.data,gi=[];for(const wi of st){const Pe=this.stride*wi;gi.push(xt[Pe+Wi]>1?Vr(xt,Pe,this.clusterProps):this.points[xt[Pe+Si]])}return gi}getChildren(de){const _e=this._getOriginId(de),Ae=this._getOriginZoom(de),Je="No cluster with the specified id.",ot=this.trees[Ae];if(!ot)throw new Error(Je);const Tt=ot.data;if(_e*this.stride>=Tt.length)throw new Error(Je);const mt=this.options.radius/(this.options.extent*Math.pow(2,Ae-1)),st=ot.within(Tt[_e*this.stride],Tt[_e*this.stride+1],mt),xt=[];for(const gi of st){const wi=gi*this.stride;Tt[wi+4]===de&&xt.push(Tt[wi+Wi]>1?Vr(Tt,wi,this.clusterProps):this.points[Tt[wi+Si]])}if(xt.length===0)throw new Error(Je);return xt}getLeaves(de,_e,Ae){const Je=[];return this._appendLeaves(Je,de,_e=_e||10,Ae=Ae||0,0),Je}getTile(de,_e,Ae){const Je=this.trees[this._limitZoom(de)],ot=Math.pow(2,de),{extent:Tt,radius:mt}=this.options,st=mt/Tt,xt=(Ae-st)/ot,gi=(Ae+1+st)/ot,wi={features:[]};return this._addTileFeatures(Je.range((_e-st)/ot,xt,(_e+1+st)/ot,gi),Je.data,_e,Ae,ot,wi),_e===0&&this._addTileFeatures(Je.range(1-st/ot,xt,1,gi),Je.data,ot,Ae,ot,wi),_e===ot-1&&this._addTileFeatures(Je.range(0,xt,st/ot,gi),Je.data,-1,Ae,ot,wi),wi.features.length?wi:null}getClusterExpansionZoom(de){let _e=this._getOriginZoom(de)-1;for(;_e<=this.options.maxZoom;){const Ae=this.getChildren(de);if(_e++,Ae.length!==1)break;de=Ae[0].properties.cluster_id}return _e}_appendLeaves(de,_e,Ae,Je,ot){const Tt=this.getChildren(_e);for(const mt of Tt){const st=mt.properties;if(st&&st.cluster?ot+st.point_count<=Je?ot+=st.point_count:ot=this._appendLeaves(de,st.cluster_id,Ae,Je,ot):ot<Je?ot++:de.push(mt),de.length===Ae)break}return ot}_createTree(de){const _e=new t.KDBush(de.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ae=0;Ae<de.length;Ae+=this.stride)_e.add(de[Ae],de[Ae+1]);return _e.finish(),_e.data=de,_e}_addTileFeatures(de,_e,Ae,Je,ot,Tt){for(const mt of de){const st=mt*this.stride,xt=_e[st+Wi]>1;let gi,wi,Pe;if(xt)gi=rn(_e,st,this.clusterProps),wi=_e[st],Pe=_e[st+1];else{const jt=this.points[_e[st+Si]];gi=jt.properties;const[pe,Y]=jt.geometry.coordinates;wi=nn(pe),Pe=on(Y)}const ct={type:1,geometry:[[Math.round(this.options.extent*(wi*ot-Ae)),Math.round(this.options.extent*(Pe*ot-Je))]],tags:gi};let bt;bt=xt||this.options.generateId?_e[st+Si]:this.points[_e[st+Si]].id,bt!==void 0&&(ct.id=bt),Tt.features.push(ct)}}_limitZoom(de){return Math.max(this.options.minZoom,Math.min(Math.floor(+de),this.options.maxZoom+1))}_cluster(de,_e){const{radius:Ae,extent:Je,reduce:ot,minPoints:Tt}=this.options,mt=Ae/(Je*Math.pow(2,_e)),st=de.data,xt=[],gi=this.stride;for(let wi=0;wi<st.length;wi+=gi){if(st[wi+2]<=_e)continue;st[wi+2]=_e;const Pe=st[wi],ct=st[wi+1],bt=de.within(st[wi],st[wi+1],mt),jt=st[wi+Wi];let pe=jt;for(const Y of bt){const re=Y*gi;st[re+2]>_e&&(pe+=st[re+Wi])}if(pe>jt&&pe>=Tt){let Y,re=Pe*jt,fe=ct*jt,ge=-1;const ke=((wi/gi|0)<<5)+(_e+1)+this.points.length;for(const Ze of bt){const $e=Ze*gi;if(st[$e+2]<=_e)continue;st[$e+2]=_e;const Ve=st[$e+Wi];re+=st[$e]*Ve,fe+=st[$e+1]*Ve,st[$e+4]=ke,ot&&(Y||(Y=this._map(st,wi,!0),ge=this.clusterProps.length,this.clusterProps.push(Y)),ot(Y,this._map(st,$e)))}st[wi+4]=ke,xt.push(re/pe,fe/pe,1/0,ke,-1,pe),ot&&xt.push(ge)}else{for(let Y=0;Y<gi;Y++)xt.push(st[wi+Y]);if(pe>1)for(const Y of bt){const re=Y*gi;if(!(st[re+2]<=_e)){st[re+2]=_e;for(let fe=0;fe<gi;fe++)xt.push(st[re+fe])}}}}return xt}_getOriginId(de){return de-this.points.length>>5}_getOriginZoom(de){return(de-this.points.length)%32}_map(de,_e,Ae){if(de[_e+Wi]>1){const Tt=this.clusterProps[de[_e+lr]];return Ae?Object.assign({},Tt):Tt}const Je=this.points[de[_e+Si]].properties,ot=this.options.map(Je);return Ae&&ot===Je?Object.assign({},ot):ot}}function Vr(De,de,_e){return{type:"Feature",id:De[de+Si],properties:rn(De,de,_e),geometry:{type:"Point",coordinates:[(Ae=De[de],360*(Ae-.5)),mo(De[de+1])]}};var Ae}function rn(De,de,_e){const Ae=De[de+Wi],Je=Ae>=1e4?`${Math.round(Ae/1e3)}k`:Ae>=1e3?Math.round(Ae/100)/10+"k":Ae,ot=De[de+lr],Tt=ot===-1?{}:Object.assign({},_e[ot]);return Object.assign(Tt,{cluster:!0,cluster_id:De[de+Si],point_count:Ae,point_count_abbreviated:Je})}function nn(De){return De/360+.5}function on(De){const de=Math.sin(De*Math.PI/180),_e=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return _e<0?0:_e>1?1:_e}function mo(De){const de=(180-360*De)*Math.PI/180;return 360*Math.atan(Math.exp(de))/Math.PI-90}function eo(De,de,_e,Ae){for(var Je,ot=Ae,Tt=_e-de>>1,mt=_e-de,st=De[de],xt=De[de+1],gi=De[_e],wi=De[_e+1],Pe=de+3;Pe<_e;Pe+=3){var ct=Rs(De[Pe],De[Pe+1],st,xt,gi,wi);if(ct>ot)Je=Pe,ot=ct;else if(ct===ot){var bt=Math.abs(Pe-Tt);bt<mt&&(Je=Pe,mt=bt)}}ot>Ae&&(Je-de>3&&eo(De,de,Je,Ae),De[Je+2]=ot,_e-Je>3&&eo(De,Je,_e,Ae))}function Rs(De,de,_e,Ae,Je,ot){var Tt=Je-_e,mt=ot-Ae;if(Tt!==0||mt!==0){var st=((De-_e)*Tt+(de-Ae)*mt)/(Tt*Tt+mt*mt);st>1?(_e=Je,Ae=ot):st>0&&(_e+=Tt*st,Ae+=mt*st)}return(Tt=De-_e)*Tt+(mt=de-Ae)*mt}function Ir(De,de,_e,Ae){var Je={id:De===void 0?null:De,type:de,geometry:_e,tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ot){var Tt=ot.geometry,mt=ot.type;if(mt==="Point"||mt==="MultiPoint"||mt==="LineString")wn(ot,Tt);else if(mt==="Polygon"||mt==="MultiLineString")for(var st=0;st<Tt.length;st++)wn(ot,Tt[st]);else if(mt==="MultiPolygon")for(st=0;st<Tt.length;st++)for(var xt=0;xt<Tt[st].length;xt++)wn(ot,Tt[st][xt])}(Je),Je}function wn(De,de){for(var _e=0;_e<de.length;_e+=3)De.minX=Math.min(De.minX,de[_e]),De.minY=Math.min(De.minY,de[_e+1]),De.maxX=Math.max(De.maxX,de[_e]),De.maxY=Math.max(De.maxY,de[_e+1])}function hn(De,de,_e,Ae){if(de.geometry){var Je=de.geometry.coordinates,ot=de.geometry.type,Tt=Math.pow(_e.tolerance/((1<<_e.maxZoom)*_e.extent),2),mt=[],st=de.id;if(_e.promoteId?st=de.properties[_e.promoteId]:_e.generateId&&(st=Ae||0),ot==="Point")$s(Je,mt);else if(ot==="MultiPoint")for(var xt=0;xt<Je.length;xt++)$s(Je[xt],mt);else if(ot==="LineString")sn(Je,mt,Tt,!1);else if(ot==="MultiLineString"){if(_e.lineMetrics){for(xt=0;xt<Je.length;xt++)sn(Je[xt],mt=[],Tt,!1),De.push(Ir(st,"LineString",mt,de.properties));return}Vn(Je,mt,Tt,!1)}else if(ot==="Polygon")Vn(Je,mt,Tt,!0);else{if(ot!=="MultiPolygon"){if(ot==="GeometryCollection"){for(xt=0;xt<de.geometry.geometries.length;xt++)hn(De,{id:st,geometry:de.geometry.geometries[xt],properties:de.properties},_e,Ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(xt=0;xt<Je.length;xt++){var gi=[];Vn(Je[xt],gi,Tt,!0),mt.push(gi)}}De.push(Ir(st,ot,mt,de.properties))}}function $s(De,de){de.push(ra(De[0])),de.push(ns(De[1])),de.push(0)}function sn(De,de,_e,Ae){for(var Je,ot,Tt=0,mt=0;mt<De.length;mt++){var st=ra(De[mt][0]),xt=ns(De[mt][1]);de.push(st),de.push(xt),de.push(0),mt>0&&(Tt+=Ae?(Je*xt-st*ot)/2:Math.sqrt(Math.pow(st-Je,2)+Math.pow(xt-ot,2))),Je=st,ot=xt}var gi=de.length-3;de[2]=1,eo(de,0,gi,_e),de[gi+2]=1,de.size=Math.abs(Tt),de.start=0,de.end=de.size}function Vn(De,de,_e,Ae){for(var Je=0;Je<De.length;Je++){var ot=[];sn(De[Je],ot,_e,Ae),de.push(ot)}}function ra(De){return De/360+.5}function ns(De){var de=Math.sin(De*Math.PI/180),_e=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return _e<0?0:_e>1?1:_e}function xr(De,de,_e,Ae,Je,ot,Tt,mt){if(Ae/=de,ot>=(_e/=de)&&Tt<Ae)return De;if(Tt<_e||ot>=Ae)return null;for(var st=[],xt=0;xt<De.length;xt++){var gi=De[xt],wi=gi.geometry,Pe=gi.type,ct=Je===0?gi.minX:gi.minY,bt=Je===0?gi.maxX:gi.maxY;if(ct>=_e&&bt<Ae)st.push(gi);else if(!(bt<_e||ct>=Ae)){var jt=[];if(Pe==="Point"||Pe==="MultiPoint")Wo(wi,jt,_e,Ae,Je);else if(Pe==="LineString")os(wi,jt,_e,Ae,Je,!1,mt.lineMetrics);else if(Pe==="MultiLineString")ys(wi,jt,_e,Ae,Je,!1);else if(Pe==="Polygon")ys(wi,jt,_e,Ae,Je,!0);else if(Pe==="MultiPolygon")for(var pe=0;pe<wi.length;pe++){var Y=[];ys(wi[pe],Y,_e,Ae,Je,!0),Y.length&&jt.push(Y)}if(jt.length){if(mt.lineMetrics&&Pe==="LineString"){for(pe=0;pe<jt.length;pe++)st.push(Ir(gi.id,Pe,jt[pe],gi.tags));continue}Pe!=="LineString"&&Pe!=="MultiLineString"||(jt.length===1?(Pe="LineString",jt=jt[0]):Pe="MultiLineString"),Pe!=="Point"&&Pe!=="MultiPoint"||(Pe=jt.length===3?"Point":"MultiPoint"),st.push(Ir(gi.id,Pe,jt,gi.tags))}}}return st.length?st:null}function Wo(De,de,_e,Ae,Je){for(var ot=0;ot<De.length;ot+=3){var Tt=De[ot+Je];Tt>=_e&&Tt<=Ae&&(de.push(De[ot]),de.push(De[ot+1]),de.push(De[ot+2]))}}function os(De,de,_e,Ae,Je,ot,Tt){for(var mt,st,xt=gs(De),gi=Je===0?Eo:Zs,wi=De.start,Pe=0;Pe<De.length-3;Pe+=3){var ct=De[Pe],bt=De[Pe+1],jt=De[Pe+2],pe=De[Pe+3],Y=De[Pe+4],re=Je===0?ct:bt,fe=Je===0?pe:Y,ge=!1;Tt&&(mt=Math.sqrt(Math.pow(ct-pe,2)+Math.pow(bt-Y,2))),re<_e?fe>_e&&(st=gi(xt,ct,bt,pe,Y,_e),Tt&&(xt.start=wi+mt*st)):re>Ae?fe<Ae&&(st=gi(xt,ct,bt,pe,Y,Ae),Tt&&(xt.start=wi+mt*st)):to(xt,ct,bt,jt),fe<_e&&re>=_e&&(st=gi(xt,ct,bt,pe,Y,_e),ge=!0),fe>Ae&&re<=Ae&&(st=gi(xt,ct,bt,pe,Y,Ae),ge=!0),!ot&&ge&&(Tt&&(xt.end=wi+mt*st),de.push(xt),xt=gs(De)),Tt&&(wi+=mt)}var ke=De.length-3;ct=De[ke],bt=De[ke+1],jt=De[ke+2],(re=Je===0?ct:bt)>=_e&&re<=Ae&&to(xt,ct,bt,jt),ke=xt.length-3,ot&&ke>=3&&(xt[ke]!==xt[0]||xt[ke+1]!==xt[1])&&to(xt,xt[0],xt[1],xt[2]),xt.length&&de.push(xt)}function gs(De){var de=[];return de.size=De.size,de.start=De.start,de.end=De.end,de}function ys(De,de,_e,Ae,Je,ot){for(var Tt=0;Tt<De.length;Tt++)os(De[Tt],de,_e,Ae,Je,ot,!1)}function to(De,de,_e,Ae){De.push(de),De.push(_e),De.push(Ae)}function Eo(De,de,_e,Ae,Je,ot){var Tt=(ot-de)/(Ae-de);return De.push(ot),De.push(_e+(Je-_e)*Tt),De.push(1),Tt}function Zs(De,de,_e,Ae,Je,ot){var Tt=(ot-_e)/(Je-_e);return De.push(de+(Ae-de)*Tt),De.push(ot),De.push(1),Tt}function qn(De,de){for(var _e=[],Ae=0;Ae<De.length;Ae++){var Je,ot=De[Ae],Tt=ot.type;if(Tt==="Point"||Tt==="MultiPoint"||Tt==="LineString")Je=qt(ot.geometry,de);else if(Tt==="MultiLineString"||Tt==="Polygon"){Je=[];for(var mt=0;mt<ot.geometry.length;mt++)Je.push(qt(ot.geometry[mt],de))}else if(Tt==="MultiPolygon")for(Je=[],mt=0;mt<ot.geometry.length;mt++){for(var st=[],xt=0;xt<ot.geometry[mt].length;xt++)st.push(qt(ot.geometry[mt][xt],de));Je.push(st)}_e.push(Ir(ot.id,Tt,Je,ot.tags))}return _e}function qt(De,de){var _e=[];_e.size=De.size,De.start!==void 0&&(_e.start=De.start,_e.end=De.end);for(var Ae=0;Ae<De.length;Ae+=3)_e.push(De[Ae]+de,De[Ae+1],De[Ae+2]);return _e}function Mi(De,de){if(De.transformed)return De;var _e,Ae,Je,ot=1<<De.z,Tt=De.x,mt=De.y;for(_e=0;_e<De.features.length;_e++){var st=De.features[_e],xt=st.geometry,gi=st.type;if(st.geometry=[],gi===1)for(Ae=0;Ae<xt.length;Ae+=2)st.geometry.push(Xo(xt[Ae],xt[Ae+1],de,ot,Tt,mt));else for(Ae=0;Ae<xt.length;Ae++){var wi=[];for(Je=0;Je<xt[Ae].length;Je+=2)wi.push(Xo(xt[Ae][Je],xt[Ae][Je+1],de,ot,Tt,mt));st.geometry.push(wi)}}return De.transformed=!0,De}function Xo(De,de,_e,Ae,Je,ot){return[Math.round(_e*(De*Ae-Je)),Math.round(_e*(de*Ae-ot))]}function so(De,de,_e,Ae,Je){for(var ot=de===Je.maxZoom?0:Je.tolerance/((1<<de)*Je.extent),Tt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:_e,y:Ae,z:de,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},mt=0;mt<De.length;mt++){Tt.numFeatures++,Gr(Tt,De[mt],ot,Je);var st=De[mt].minX,xt=De[mt].minY,gi=De[mt].maxX,wi=De[mt].maxY;st<Tt.minX&&(Tt.minX=st),xt<Tt.minY&&(Tt.minY=xt),gi>Tt.maxX&&(Tt.maxX=gi),wi>Tt.maxY&&(Tt.maxY=wi)}return Tt}function Gr(De,de,_e,Ae){var Je=de.geometry,ot=de.type,Tt=[];if(ot==="Point"||ot==="MultiPoint")for(var mt=0;mt<Je.length;mt+=3)Tt.push(Je[mt]),Tt.push(Je[mt+1]),De.numPoints++,De.numSimplified++;else if(ot==="LineString")zn(Tt,Je,De,_e,!1,!1);else if(ot==="MultiLineString"||ot==="Polygon")for(mt=0;mt<Je.length;mt++)zn(Tt,Je[mt],De,_e,ot==="Polygon",mt===0);else if(ot==="MultiPolygon")for(var st=0;st<Je.length;st++){var xt=Je[st];for(mt=0;mt<xt.length;mt++)zn(Tt,xt[mt],De,_e,!0,mt===0)}if(Tt.length){var gi=de.tags||null;if(ot==="LineString"&&Ae.lineMetrics){for(var wi in gi={},de.tags)gi[wi]=de.tags[wi];gi.mapbox_clip_start=Je.start/Je.size,gi.mapbox_clip_end=Je.end/Je.size}var Pe={geometry:Tt,type:ot==="Polygon"||ot==="MultiPolygon"?3:ot==="LineString"||ot==="MultiLineString"?2:1,tags:gi};de.id!==null&&(Pe.id=de.id),De.features.push(Pe)}}function zn(De,de,_e,Ae,Je,ot){var Tt=Ae*Ae;if(Ae>0&&de.size<(Je?Tt:Ae))_e.numPoints+=de.length/3;else{for(var mt=[],st=0;st<de.length;st+=3)(Ae===0||de[st+2]>Tt)&&(_e.numSimplified++,mt.push(de[st]),mt.push(de[st+1])),_e.numPoints++;Je&&function(xt,gi){for(var wi=0,Pe=0,ct=xt.length,bt=ct-2;Pe<ct;bt=Pe,Pe+=2)wi+=(xt[Pe]-xt[bt])*(xt[Pe+1]+xt[bt+1]);if(wi>0===gi)for(Pe=0,ct=xt.length;Pe<ct/2;Pe+=2){var jt=xt[Pe],pe=xt[Pe+1];xt[Pe]=xt[ct-2-Pe],xt[Pe+1]=xt[ct-1-Pe],xt[ct-2-Pe]=jt,xt[ct-1-Pe]=pe}}(mt,ot),De.push(mt)}}function Hn(De,de){var _e=(de=this.options=function(Je,ot){for(var Tt in ot)Je[Tt]=ot[Tt];return Je}(Object.create(this.options),de)).debug;if(_e&&console.time("preprocess data"),de.maxZoom<0||de.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(de.promoteId&&de.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ae=function(Je,ot){var Tt=[];if(Je.type==="FeatureCollection")for(var mt=0;mt<Je.features.length;mt++)hn(Tt,Je.features[mt],ot,mt);else hn(Tt,Je.type==="Feature"?Je:{geometry:Je},ot);return Tt}(De,de);this.tiles={},this.tileCoords=[],_e&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",de.indexMaxZoom,de.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ae=function(Je,ot){var Tt=ot.buffer/ot.extent,mt=Je,st=xr(Je,1,-1-Tt,Tt,0,-1,2,ot),xt=xr(Je,1,1-Tt,2+Tt,0,-1,2,ot);return(st||xt)&&(mt=xr(Je,1,-Tt,1+Tt,0,-1,2,ot)||[],st&&(mt=qn(st,1).concat(mt)),xt&&(mt=mt.concat(qn(xt,-1)))),mt}(Ae,de),Ae.length&&this.splitTile(Ae,0,0,0),_e&&(Ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function io(De,de,_e){return 32*((1<<De)*_e+de)+De}function Ao(De,de){const _e=De.tileID.canonical;if(!this._geoJSONIndex)return de(null,null);const Ae=this._geoJSONIndex.getTile(_e.z,_e.x,_e.y);if(!Ae)return de(null,null);const Je=new class{constructor(Tt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=Tt.length,this._features=Tt}feature(Tt){return new class{constructor(mt){this._feature=mt,this.extent=t.EXTENT,this.type=mt.type,this.properties=mt.tags,"id"in mt&&!isNaN(mt.id)&&(this.id=parseInt(mt.id,10))}loadGeometry(){if(this._feature.type===1){const mt=[];for(const st of this._feature.geometry)mt.push([new t.Point(st[0],st[1])]);return mt}{const mt=[];for(const st of this._feature.geometry){const xt=[];for(const gi of st)xt.push(new t.Point(gi[0],gi[1]));mt.push(xt)}return mt}}toGeoJSON(mt,st,xt){return at.call(this,mt,st,xt)}}(this._features[Tt])}}(Ae.features);let ot=Mt(Je);ot.byteOffset===0&&ot.byteLength===ot.buffer.byteLength||(ot=new Uint8Array(ot)),de(null,{vectorTile:Je,rawData:ot.buffer})}Hn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Hn.prototype.splitTile=function(De,de,_e,Ae,Je,ot,Tt){for(var mt=[De,de,_e,Ae],st=this.options,xt=st.debug;mt.length;){Ae=mt.pop(),_e=mt.pop(),de=mt.pop(),De=mt.pop();var gi=1<<de,wi=io(de,_e,Ae),Pe=this.tiles[wi];if(!Pe&&(xt>1&&console.time("creation"),Pe=this.tiles[wi]=so(De,de,_e,Ae,st),this.tileCoords.push({z:de,x:_e,y:Ae}),xt)){xt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",de,_e,Ae,Pe.numFeatures,Pe.numPoints,Pe.numSimplified),console.timeEnd("creation"));var ct="z"+de;this.stats[ct]=(this.stats[ct]||0)+1,this.total++}if(Pe.source=De,Je){if(de===st.maxZoom||de===Je)continue;var bt=1<<Je-de;if(_e!==Math.floor(ot/bt)||Ae!==Math.floor(Tt/bt))continue}else if(de===st.indexMaxZoom||Pe.numPoints<=st.indexMaxPoints)continue;if(Pe.source=null,De.length!==0){xt>1&&console.time("clipping");var jt,pe,Y,re,fe,ge,ke=.5*st.buffer/st.extent,Ze=.5-ke,$e=.5+ke,Ve=1+ke;jt=pe=Y=re=null,fe=xr(De,gi,_e-ke,_e+$e,0,Pe.minX,Pe.maxX,st),ge=xr(De,gi,_e+Ze,_e+Ve,0,Pe.minX,Pe.maxX,st),De=null,fe&&(jt=xr(fe,gi,Ae-ke,Ae+$e,1,Pe.minY,Pe.maxY,st),pe=xr(fe,gi,Ae+Ze,Ae+Ve,1,Pe.minY,Pe.maxY,st),fe=null),ge&&(Y=xr(ge,gi,Ae-ke,Ae+$e,1,Pe.minY,Pe.maxY,st),re=xr(ge,gi,Ae+Ze,Ae+Ve,1,Pe.minY,Pe.maxY,st),ge=null),xt>1&&console.timeEnd("clipping"),mt.push(jt||[],de+1,2*_e,2*Ae),mt.push(pe||[],de+1,2*_e,2*Ae+1),mt.push(Y||[],de+1,2*_e+1,2*Ae),mt.push(re||[],de+1,2*_e+1,2*Ae+1)}}},Hn.prototype.getTile=function(De,de,_e){var Ae=this.options,Je=Ae.extent,ot=Ae.debug;if(De<0||De>24)return null;var Tt=1<<De,mt=io(De,de=(de%Tt+Tt)%Tt,_e);if(this.tiles[mt])return Mi(this.tiles[mt],Je);ot>1&&console.log("drilling down to z%d-%d-%d",De,de,_e);for(var st,xt=De,gi=de,wi=_e;!st&&xt>0;)xt--,gi=Math.floor(gi/2),wi=Math.floor(wi/2),st=this.tiles[io(xt,gi,wi)];return st&&st.source?(ot>1&&console.log("found parent tile z%d-%d-%d",xt,gi,wi),ot>1&&console.time("drilling down"),this.splitTile(st.source,xt,gi,wi,De,de,_e),ot>1&&console.timeEnd("drilling down"),this.tiles[mt]?Mi(this.tiles[mt],Je):null):null};class Ii extends t.VectorTileWorkerSource{constructor(de,_e,Ae,Je,ot){super(de,_e,Ae,Je,Ao),ot&&(this.loadGeoJSON=ot)}loadData(de,_e){const Ae=de&&de.request,Je=Ae&&Ae.collectResourceTiming;this.loadGeoJSON(de,(ot,Tt)=>{if(ot||!Tt)return _e(ot);if(typeof Tt!="object")return _e(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));{lt(Tt,!0);try{if(de.filter){const st=t.createExpression(de.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(st.result==="error")throw new Error(st.value.map(gi=>`${gi.key}: ${gi.message}`).join(", "));Tt={type:"FeatureCollection",features:Tt.features.filter(gi=>st.value.evaluate({zoom:0},gi))}}this._geoJSONIndex=de.cluster?new mr(function({superclusterOptions:st,clusterProperties:xt}){if(!xt||!st)return st;const gi={},wi={},Pe={accumulated:null,zoom:0},ct={properties:null},bt=Object.keys(xt);for(const jt of bt){const[pe,Y]=xt[jt],re=t.createExpression(Y),fe=t.createExpression(typeof pe=="string"?[pe,["accumulated"],["get",jt]]:pe);gi[jt]=re.value,wi[jt]=fe.value}return st.map=jt=>{ct.properties=jt;const pe={};for(const Y of bt)pe[Y]=gi[Y].evaluate(Pe,ct);return pe},st.reduce=(jt,pe)=>{ct.properties=pe;for(const Y of bt)Pe.accumulated=jt[Y],jt[Y]=wi[Y].evaluate(Pe,ct)},st}(de)).load(Tt.features):function(st,xt){return new Hn(st,xt)}(Tt,de.geojsonVtOptions)}catch(st){return _e(st)}this.loaded={};const mt={};if(Je){const st=t.getPerformanceMeasurement(Ae);st&&(mt.resourceTiming={},mt.resourceTiming[de.source]=JSON.parse(JSON.stringify(st)))}_e(null,mt)}})}reloadTile(de,_e){const Ae=this.loaded;return Ae&&Ae[de.uid]?super.reloadTile(de,_e):this.loadTile(de,_e)}loadGeoJSON(de,_e){if(de.request)t.getJSON(de.request,_e);else{if(typeof de.data!="string")return _e(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));try{return _e(null,JSON.parse(de.data))}catch{return _e(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(de,_e){try{_e(null,this._geoJSONIndex.getClusterExpansionZoom(de.clusterId))}catch(Ae){_e(Ae)}}getClusterChildren(de,_e){try{_e(null,this._geoJSONIndex.getChildren(de.clusterId))}catch(Ae){_e(Ae)}}getClusterLeaves(de,_e){try{_e(null,this._geoJSONIndex.getLeaves(de.clusterId,de.limit,de.offset))}catch(Ae){_e(Ae)}}}class Tr{constructor(de){this.self=de,this.actor=new t.Actor(de,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=t.getProjection({name:"mercator"}),this.workerSourceTypes={vector:t.VectorTileWorkerSource,geojson:Ii},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(_e,Ae)=>{if(this.workerSourceTypes[_e])throw new Error(`Worker source with name "${_e}" already registered.`);this.workerSourceTypes[_e]=Ae},this.self.registerRTLTextPlugin=_e=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=_e.applyArabicShaping,t.plugin.processBidirectionalText=_e.processBidirectionalText,t.plugin.processStyledBidirectionalText=_e.processStyledBidirectionalText}}clearCaches(de,_e,Ae){delete this.layerIndexes[de],delete this.availableImages[de],delete this.workerSources[de],delete this.demWorkerSources[de],Ae()}checkIfReady(de,_e,Ae){Ae()}setReferrer(de,_e){this.referrer=_e}spriteLoaded(de,_e){this.isSpriteLoaded[de]=_e;for(const Ae in this.workerSources[de]){const Je=this.workerSources[de][Ae];for(const ot in Je)Je[ot]instanceof t.VectorTileWorkerSource&&(Je[ot].isSpriteLoaded=_e,Je[ot].fire(new t.Event("isSpriteLoaded")))}}setImages(de,_e,Ae){this.availableImages[de]=_e;for(const Je in this.workerSources[de]){const ot=this.workerSources[de][Je];for(const Tt in ot)ot[Tt].availableImages=_e}Ae()}enableTerrain(de,_e,Ae){this.terrain=_e,Ae()}setProjection(de,_e){this.projections[de]=t.getProjection(_e)}setLayers(de,_e,Ae){this.getLayerIndex(de).replace(_e),Ae()}updateLayers(de,_e,Ae){this.getLayerIndex(de).update(_e.layers,_e.removedIds),Ae()}loadTile(de,_e,Ae){const Je=this.enableTerrain?t.extend({enableTerrain:this.terrain},_e):_e;Je.projection=this.projections[de]||this.defaultProjection,this.getWorkerSource(de,_e.type,_e.source).loadTile(Je,Ae)}loadDEMTile(de,_e,Ae){const Je=this.enableTerrain?t.extend({buildQuadTree:this.terrain},_e):_e;this.getDEMWorkerSource(de,_e.source).loadTile(Je,Ae)}reloadTile(de,_e,Ae){const Je=this.enableTerrain?t.extend({enableTerrain:this.terrain},_e):_e;Je.projection=this.projections[de]||this.defaultProjection,this.getWorkerSource(de,_e.type,_e.source).reloadTile(Je,Ae)}abortTile(de,_e,Ae){this.getWorkerSource(de,_e.type,_e.source).abortTile(_e,Ae)}removeTile(de,_e,Ae){this.getWorkerSource(de,_e.type,_e.source).removeTile(_e,Ae)}removeSource(de,_e,Ae){if(!this.workerSources[de]||!this.workerSources[de][_e.type]||!this.workerSources[de][_e.type][_e.source])return;const Je=this.workerSources[de][_e.type][_e.source];delete this.workerSources[de][_e.type][_e.source],Je.removeSource!==void 0?Je.removeSource(_e,Ae):Ae()}loadWorkerSource(de,_e,Ae){try{this.self.importScripts(_e.url),Ae()}catch(Je){Ae(Je.toString())}}syncRTLPluginState(de,_e,Ae){try{t.plugin.setState(_e);const Je=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&Je!=null){this.self.importScripts(Je);const ot=t.plugin.isParsed();Ae(ot?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Je}`),ot)}}catch(Je){Ae(Je.toString())}}getAvailableImages(de){let _e=this.availableImages[de];return _e||(_e=[]),_e}getLayerIndex(de){let _e=this.layerIndexes[de];return _e||(_e=this.layerIndexes[de]=new ye),_e}getWorkerSource(de,_e,Ae){if(this.workerSources[de]||(this.workerSources[de]={}),this.workerSources[de][_e]||(this.workerSources[de][_e]={}),!this.workerSources[de][_e][Ae]){const Je={send:(ot,Tt,mt,st,xt,gi)=>{this.actor.send(ot,Tt,mt,de,xt,gi)},scheduler:this.actor.scheduler};this.workerSources[de][_e][Ae]=new this.workerSourceTypes[_e](Je,this.getLayerIndex(de),this.getAvailableImages(de),this.isSpriteLoaded[de])}return this.workerSources[de][_e][Ae]}getDEMWorkerSource(de,_e){return this.demWorkerSources[de]||(this.demWorkerSources[de]={}),this.demWorkerSources[de][_e]||(this.demWorkerSources[de][_e]=new he),this.demWorkerSources[de][_e]}enforceCacheSizeLimit(de,_e){t.enforceCacheSizeLimit(_e)}getWorkerPerformanceMetrics(de,_e,Ae){Ae(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Tr(self)),Tr}),P(["./shared"],function(t){function j(_,o){if(Array.isArray(_)){if(!Array.isArray(o)||_.length!==o.length)return!1;for(let d=0;d<_.length;d++)if(!j(_[d],o[d]))return!1;return!0}if(typeof _=="object"&&_!==null&&o!==null){if(typeof o!="object"||Object.keys(_).length!==Object.keys(o).length)return!1;for(const d in _)if(!j(_[d],o[d]))return!1;return!0}return _===o}var ie=ye;function ye(_){return!function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,E,A=new Blob([""],{type:"text/javascript"}),B=URL.createObjectURL(A);try{E=new Worker(B),x=!0}catch{x=!1}return E&&E.terminate(),URL.revokeObjectURL(B),x}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var x=document.createElement("canvas");x.width=x.height=1;var E=x.getContext("2d");if(!E)return!1;var A=E.getImageData(0,0,1,1);return A&&A.width===x.width}()?(he[d=o&&o.failIfMajorPerformanceCaveat]===void 0&&(he[d]=function(x){var E,A=function(B){var O=document.createElement("canvas"),G=Object.create(ye.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=B,O.getContext("webgl",G)||O.getContext("experimental-webgl",G)}(x);if(!A)return!1;try{E=A.createShader(A.VERTEX_SHADER)}catch{return!1}return!(!E||A.isContextLost())&&(A.shaderSource(E,"void main() {}"),A.compileShader(E),A.getShaderParameter(E,A.COMPILE_STATUS)===!0)}(d)),he[d]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var d}(_)}var he={};function ne(_,o,d){const x=t.window.document.createElement(_);return o!==void 0&&(x.className=o),d&&d.appendChild(x),x}function Ye(_,o,d){const x=t.window.document.createElementNS("http://www.w3.org/2000/svg",_);for(const E of Object.keys(o))x.setAttributeNS(null,E,o[E]);return d&&d.appendChild(x),x}ye.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const lt=t.window.document&&t.window.document.documentElement.style,at=lt&&lt.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Kt;function Ne(){lt&&at&&(Kt=lt[at],lt[at]="none")}function Le(){lt&&at&&(lt[at]=Kt)}function je(_){_.preventDefault(),_.stopPropagation(),t.window.removeEventListener("click",je,!0)}function _t(){t.window.addEventListener("click",je,!0),t.window.setTimeout(()=>{t.window.removeEventListener("click",je,!0)},0)}function St(_,o){const d=_.getBoundingClientRect();return ri(_,d,o)}function ci(_,o){const d=_.getBoundingClientRect(),x=[];for(let E=0;E<o.length;E++)x.push(ri(_,d,o[E]));return x}function dt(_){return t.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function ri(_,o,d){const x=_.offsetWidth===o.width?1:_.offsetWidth/o.width;return new t.Point((d.clientX-o.left)*x,(d.clientY-o.top)*x)}function zt(_,o){var d=o[0],x=o[1],E=o[2],A=o[3],B=d*A-E*x;return B?(_[0]=A*(B=1/B),_[1]=-x*B,_[2]=-E*B,_[3]=d*B,_):null}function Ci(_){const{userImage:o}=_;return!!(o&&o.render&&o.render())&&(_.data.replace(new Uint8Array(o.data.buffer)),!0)}class yr extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,callback:x}of this.requestors)this._notify(d,x);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,d){this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let x=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),x=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),x=!1),this._validateContent(d.content,d)||(this.fire(new t.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),x=!1),x}_validateStretch(o,d){if(!o)return!0;let x=0;for(const E of o){if(E[0]<x||E[1]<E[0]||d<E[1])return!1;x=E[1]}return!0}_validateContent(o,d){return!(o&&(o.length!==4||o[0]<0||d.data.width<o[0]||o[1]<0||d.data.height<o[1]||o[2]<0||d.data.width<o[2]||o[3]<0||d.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,d){d.version=this.images[o].version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,d){let x=!0;if(!this.isLoaded())for(const E of o)this.images[E]||(x=!1);this.isLoaded()||x?this._notify(o,d):this.requestors.push({ids:o,callback:d})}_notify(o,d){const x={};for(const E of o){this.images[E]||this.fire(new t.Event("styleimagemissing",{id:E}));const A=this.images[E];A?x[E]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:t.warnOnce(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,x)}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],x=this.getImage(o);if(!x)return null;if(d&&d.position.version===x.version)return d.position;if(d)d.position.version=x.version;else{const E={w:x.data.width+2,h:x.data.height+2,x:0,y:0},A=new t.ImagePosition(E,x);this.patterns[o]={bin:E,position:A}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(o,this.atlasImage,d.RGBA),this.atlasTexture&&this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const A in this.patterns)o.push(this.patterns[A].bin);const{w:d,h:x}=t.potpack(o),E=this.atlasImage;E.resize({width:d||1,height:x||1});for(const A in this.patterns){const{bin:B}=this.patterns[A],O=B.x+1,G=B.y+1,H=this.images[A].data,X=H.width,oe=H.height;t.RGBAImage.copy(H,E,{x:0,y:0},{x:O,y:G},{width:X,height:oe}),t.RGBAImage.copy(H,E,{x:0,y:oe-1},{x:O,y:G-1},{width:X,height:1}),t.RGBAImage.copy(H,E,{x:0,y:0},{x:O,y:G+oe},{width:X,height:1}),t.RGBAImage.copy(H,E,{x:X-1,y:0},{x:O-1,y:G},{width:1,height:oe}),t.RGBAImage.copy(H,E,{x:0,y:0},{x:O+X,y:G},{width:1,height:oe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const x=this.images[d];Ci(x)&&this.updateImage(d,x)}}}const ki=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(_,o){return function([d,x,E]){const A=t.degToRad(x+90),B=t.degToRad(E);return{x:d*Math.cos(A)*Math.sin(B),y:d*Math.sin(A)*Math.sin(B),z:d*Math.cos(B),azimuthal:x,polar:E}}(_.expression.evaluate(o))}interpolate(_,o,d){return{x:t.number(_.x,o.x,d),y:t.number(_.y,o.y,d),z:t.number(_.z,o.z,d),azimuthal:t.number(_.azimuthal,o.azimuthal,d),polar:t.number(_.polar,o.polar,d)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)});class fr extends t.Evented{constructor(o){super(),this._transitionable=new t.Transitionable(ki),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(t.validateLight,o,d))for(const x in o){const E=o[x];t.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),E):this._transitionable.setValue(x,E)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,x){return(!x||x.validate!==!1)&&t.emitValidationErrors(this,o.call(t.validateStyle,t.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const Qt=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)});let $t=class extends t.Evented{constructor(_,o){super(),this._transitionable=new t.Transitionable(Qt),this.set(_),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(_){for(const o in _){const d=_[o];t.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),d):this._transitionable.setValue(o,d)}}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}};function Mt(_,o,d,x){const E=t.smoothstep(45,65,d),[A,B]=ui(_,x),O=t.length(o);let G=1-Math.min(1,Math.exp((O-A)/(B-A)*-6));return G*=G*G,G=Math.min(1,1.00747*G),G*E*_.alpha}function ui(_,o){const d=.5/Math.tan(.5*o);return[_.range[0]+d,_.range[1]+d]}const pt=new t.Properties({range:new t.DataConstantProperty(t.spec.fog.range),color:new t.DataConstantProperty(t.spec.fog.color),"high-color":new t.DataConstantProperty(t.spec.fog["high-color"]),"space-color":new t.DataConstantProperty(t.spec.fog["space-color"]),"horizon-blend":new t.DataConstantProperty(t.spec.fog["horizon-blend"]),"star-intensity":new t.DataConstantProperty(t.spec.fog["star-intensity"])});class hi extends t.Evented{constructor(o,d){super(),this._transitionable=new t.Transitionable(pt),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=d}get state(){const o=this._transform,d=o.projection.name==="globe",x=t.globeToMercatorTransition(o.zoom),E=this.properties.get("range"),A=[.5,3];return{range:d?[t.number(A[0],E[0],x),t.number(A[1],E[1],x)]:E,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,d={}){if(!this._validate(t.validateFog,o,d)){for(const x of Object.keys(t.spec.fog))o&&o[x]===void 0&&(o[x]=t.spec.fog[x].default);for(const x in o){const E=o[x];t.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),E):this._transitionable.setValue(x,E)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:t.smoothstep(45,65,o))*d.a}getOpacityAtLatLng(o,d){return this._transform.projection.supportsFog?function(x,E,A){const B=t.MercatorCoordinate.fromLngLat(E),O=A.elevation?A.elevation.getAtPointOrZero(B):0,G=[B.x,B.y,O];return t.transformMat4(G,G,A.mercatorFogMatrix),Mt(x,G,A.pitch,A._fov)}(this.state,o,d):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?ui(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,x){return(!x||x.validate!==!1)&&t.emitValidationErrors(this,o.call(t.validateStyle,t.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class Si{constructor(o,d){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const x=this.workerPool.acquire(this.id);for(let E=0;E<x.length;E++){const A=new Si.Actor(x[E],d,this.id);A.name=`Worker ${E}`,this.actors.push(A)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,d,x){t.asyncAll(this.actors,(E,A)=>{E.send(o,d,A)},x=x||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Wi(_,o,d){return o*(t.EXTENT/(_.tileSize*Math.pow(2,d-_.tileID.overscaledZ)))}Si.Actor=t.Actor;class lr{constructor(o,d,x,E){this.screenBounds=o,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,E)}static createFromScreenPoints(o,d){let x,E;if(o instanceof t.Point||typeof o[0]=="number"){const A=t.Point.convert(o);x=[A],E=d.isPointAboveHorizon(A)}else{const A=t.Point.convert(o[0]),B=t.Point.convert(o[1]);x=[A,B],E=t.polygonizeBounds(A,B).every(O=>d.isPointAboveHorizon(O))}return new lr(x,d.getCameraPoint(),E,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return t.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const d=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new t.Point(1,1)):this.screenBounds[1],E=t.polygonizeBounds(d,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<x.x?E.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?E[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(E[3]=this.cameraPoint)),t.bufferConvexPolygon(E,o)}bufferedCameraGeometryGlobe(o){const d=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new t.Point(1,1)):this.screenBounds[1],E=t.polygonizeBounds(d,x,o),A=this.cameraPoint.clone();switch(3*((A.y>d.y)+(A.y>x.y))+((A.x>d.x)+(A.x>x.x))){case 0:E[0]=A,E[4]=A.clone();break;case 1:E.splice(1,0,A);break;case 2:E[1]=A;break;case 3:E.splice(4,0,A);break;case 5:E.splice(2,0,A);break;case 6:E[3]=A;break;case 7:E.splice(3,0,A);break;case 8:E[2]=A}return E}containsTile(o,d,x,E=0){const A=o.queryPadding/d._pixelsPerMercatorPixel+1,B=x?this._bufferedCameraMercator(A,d):this._bufferedScreenMercator(A,d);let O=o.tileID.wrap+(B.unwrapped?E:0);const G=B.polygon.map(ze=>t.getTilePoint(o.tileTransform,ze,O));if(!t.polygonIntersectsBox(G,0,0,t.EXTENT,t.EXTENT))return;O=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?E:0);const H=this.screenGeometryMercator.polygon.map(ze=>t.getTileVec3(o.tileTransform,ze,O)),X=H.map(ze=>new t.Point(ze[0],ze[1])),oe=d.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),ve=t.getTileVec3(o.tileTransform,oe,O),Ee=H.map(ze=>{const ae=t.sub(ze,ze,ve);return t.normalize(ae,ae),new t.Ray(ve,ae)}),Ie=Wi(o,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:X,tilespaceRays:Ee,bufferedTilespaceGeometry:G,bufferedTilespaceBounds:(Ce=t.getBounds(G),Ce.min.x=t.clamp(Ce.min.x,0,t.EXTENT),Ce.min.y=t.clamp(Ce.min.y,0,t.EXTENT),Ce.max.x=t.clamp(Ce.max.x,0,t.EXTENT),Ce.max.y=t.clamp(Ce.max.y,0,t.EXTENT),Ce),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:Ie};var Ce}_bufferedScreenMercator(o,d){const x=rn(o);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let E;return E=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),d):{polygon:this.bufferedScreenGeometry(o).map(A=>d.pointCoordinate3D(A)),unwrapped:!0},this._screenRaycastCache[x]=E,E}}_bufferedCameraMercator(o,d){const x=rn(o);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let E;return E=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),d):{polygon:this.bufferedCameraGeometry(o).map(A=>d.pointCoordinate3D(A)),unwrapped:!0},this._cameraRaycastCache[x]=E,E}}_projectAndResample(o,d){const x=function(A,B){const O=t.multiply([],B.pixelMatrix,B.globeMatrix),G=[0,-t.GLOBE_RADIUS,0,1],H=[0,t.GLOBE_RADIUS,0,1],X=[0,0,0,1];t.transformMat4$1(G,G,O),t.transformMat4$1(H,H,O),t.transformMat4$1(X,X,O);const oe=new t.Point(G[0]/G[3],G[1]/G[3]),ve=new t.Point(H[0]/H[3],H[1]/H[3]),Ee=t.polygonContainsPoint(A,oe)&&G[3]<X[3],Ie=t.polygonContainsPoint(A,ve)&&H[3]<X[3];if(!Ee&&!Ie)return null;const Ce=function(tt,gt,yt){for(let kt=1;kt<tt.length;kt++){const yi=Vr(gt.pointCoordinate3D(tt[kt-1]).x),At=Vr(gt.pointCoordinate3D(tt[kt]).x);if(yt<0){if(yi<At)return{idx:kt,t:-yi/(At-1-yi)}}else if(At<yi)return{idx:kt,t:(1-yi)/(At+1-yi)}}return null}(A,B,Ee?-1:1);if(!Ce)return null;const{idx:ze,t:ae}=Ce;let Me=ze>1?mr(A.slice(0,ze),B):[],Ue=ze<A.length?mr(A.slice(ze),B):[];Me=Me.map(tt=>new t.Point(Vr(tt.x),tt.y)),Ue=Ue.map(tt=>new t.Point(Vr(tt.x),tt.y));const Ge=[...Me];Ge.length===0&&Ge.push(Ue[Ue.length-1]);const rt=t.number(Ge[Ge.length-1].y,(Ue.length===0?Me[0]:Ue[0]).y,ae);let nt;return nt=Ee?[new t.Point(0,rt),new t.Point(0,0),new t.Point(1,0),new t.Point(1,rt)]:[new t.Point(1,rt),new t.Point(1,1),new t.Point(0,1),new t.Point(0,rt)],Ge.push(...nt),Ue.length===0?Ge.push(Me[0]):Ge.push(...Ue),{polygon:Ge.map(tt=>new t.MercatorCoordinate(tt.x,tt.y)),unwrapped:!1}}(o,d);if(x)return x;const E=function(A,B){let O=!1,G=-1/0,H=0;for(let oe=0;oe<A.length-1;oe++)A[oe].x>G&&(G=A[oe].x,H=oe);for(let oe=0;oe<A.length-1;oe++){const ve=(H+oe)%(A.length-1),Ee=A[ve],Ie=A[ve+1];Math.abs(Ee.x-Ie.x)>.5&&(Ee.x<Ie.x?(Ee.x+=1,ve===0&&(A[A.length-1].x+=1)):(Ie.x+=1,ve+1===A.length-1&&(A[0].x+=1)),O=!0)}const X=t.mercatorXfromLng(B.center.lng);return O&&X<Math.abs(X-1)&&A.forEach(oe=>{oe.x-=1}),{polygon:A,unwrapped:O}}(mr(o,d).map(A=>new t.Point(Vr(A.x),A.y)),d);return{polygon:E.polygon.map(A=>new t.MercatorCoordinate(A.x,A.y)),unwrapped:E.unwrapped}}}function mr(_,o){return t.resample(_,d=>{const x=o.pointCoordinate3D(d);d.x=x.x,d.y=x.y},1/256)}function Vr(_){return _<0?1+_%1:_%1}function rn(_){return 100*_|0}function nn(_,o,d,x,E){const A=function(B,O){if(B)return E(B);if(O){_.url&&O.tiles&&_.tiles&&delete _.tiles;const G=t.pick(t.extend(O,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(G.vectorLayers=O.vector_layers,G.vectorLayerIds=G.vectorLayers.map(H=>H.id)),G.tiles=o.canonicalizeTileset(G,_.url),E(null,G)}};return _.url?t.getJSON(o.transformRequest(o.normalizeSourceURL(_.url,null,d,x),t.ResourceType.Source),A):t.exported.frame(()=>A(null,_))}class on{constructor(o,d,x){this.bounds=t.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=x||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),x=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*d),E=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*d),A=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*d),B=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*d);return o.x>=x&&o.x<A&&o.y>=E&&o.y<B}}class mo{constructor(o,d,x){this.context=o;const E=o.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const eo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Rs{constructor(o,d,x,E){this.length=d.length,this.attributes=x,this.itemSize=d.bytesPerElement,this.dynamicDraw=E,this.context=o;const A=o.gl;this.buffer=A.createBuffer(),o.bindVertexBuffer.set(this.buffer),A.bufferData(A.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let x=0;x<this.attributes.length;x++){const E=d.attributes[this.attributes[x].name];E!==void 0&&o.enableVertexAttribArray(E)}}setVertexAttribPointers(o,d,x){for(let E=0;E<this.attributes.length;E++){const A=this.attributes[E],B=d.attributes[A.name];B!==void 0&&o.vertexAttribPointer(B,A.components,o[eo[A.type]],!1,this.itemSize,A.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ir{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class wn extends Ir{getDefault(){return t.Color.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class hn extends Ir{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class $s extends Ir{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class sn extends Ir{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Vn extends Ir{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class ra extends Ir{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class ns extends Ir{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class xr extends Ir{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Wo extends Ir{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class os extends Ir{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class gs extends Ir{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class ys extends Ir{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class to extends Ir{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class Eo extends Ir{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Zs extends Ir{getDefault(){return t.Color.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class qn extends Ir{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class qt extends Ir{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class Mi extends Ir{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Xo extends Ir{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let so,Gr=class extends Ir{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class zn extends Ir{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Hn extends Ir{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class io extends Ir{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Ao extends Ir{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ii extends Ir{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Tr extends Ir{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class De extends Ir{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class de extends Ir{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class _e extends Ir{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Ae extends Ir{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Je extends Ir{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class ot extends Ir{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Tt extends ot{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class mt extends ot{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class st extends mt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class xt{constructor(o,d,x,E){this.context=o,this.width=d,this.height=x;const A=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Tt(o,A),E&&(this.depthAttachment=new mt(o,A))}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const x=this.depthAttachment.get();x&&o.deleteRenderbuffer(x)}o.deleteFramebuffer(this.framebuffer)}}class gi{constructor(o,d=!1){if(this.gl=o,this.isWebGL2=d,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),d){const x=o;this.extVertexArrayObject={createVertexArrayOES:x.createVertexArray.bind(o),deleteVertexArrayOES:x.deleteVertexArray.bind(o),bindVertexArrayOES:x.bindVertexArray.bind(o)}}this.clearColor=new wn(this),this.clearDepth=new hn(this),this.clearStencil=new $s(this),this.colorMask=new sn(this),this.depthMask=new Vn(this),this.stencilMask=new ra(this),this.stencilFunc=new ns(this),this.stencilOp=new xr(this),this.stencilTest=new Wo(this),this.depthRange=new os(this),this.depthTest=new gs(this),this.depthFunc=new ys(this),this.blend=new to(this),this.blendFunc=new Eo(this),this.blendColor=new Zs(this),this.blendEquation=new qn(this),this.cullFace=new qt(this),this.cullFaceSide=new Mi(this),this.frontFace=new Xo(this),this.program=new Gr(this),this.activeTexture=new zn(this),this.viewport=new Hn(this),this.bindFramebuffer=new io(this),this.bindRenderbuffer=new Ao(this),this.bindTexture=new Ii(this),this.bindVertexBuffer=new Tr(this),this.bindElementBuffer=new De(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new de(this),this.pixelStoreUnpack=new _e(this),this.pixelStoreUnpackPremultiplyAlpha=new Ae(this),this.pixelStoreUnpackFlipY=new Je(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),d||(this.extTextureHalfFloat=o.getExtension("OES_texture_half_float")),(d||this.extTextureHalfFloat&&o.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=d||o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new mo(this,o,d)}createVertexBuffer(o,d,x){return new Rs(this,o,d,x)}createRenderbuffer(o,d,x){const E=this.gl,A=E.createRenderbuffer();return this.bindRenderbuffer.set(A),E.renderbufferStorage(E.RENDERBUFFER,o,d,x),this.bindRenderbuffer.set(null),A}createFramebuffer(o,d,x){return new xt(this,o,d,x)}clear({color:o,depth:d,stencil:x}){const E=this.gl;let A=0;o&&(A|=E.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(A|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),x!==void 0&&(A|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),E.clear(A)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){j(o.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class wi extends t.Evented{constructor(o,d,x,E){if(super(),this.id=o,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(d,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(E),this._tileWorkers={},this._deduped=new t.DedupedRequest}load(o){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=nn(this._options,this.map._requestManager,d,x,(E,A)=>{this._tileJSONRequest=null,this._loaded=!0,E?(d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),x&&x.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new t.ErrorEvent(E))):A&&(t.extend(this,A),A.bounds&&(this.tileBounds=new on(A.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(A.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(E)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return t.extend({},this._options)}loadTile(o,d){const x=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),E={request:this.map._requestManager.transformRequest(x,t.ResourceType.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile};if(E.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=d:o.request=o.actor.send("reloadTile",E,A.bind(this));else if(o.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",E,A.bind(this),void 0,!0);else{const B=t.loadVectorTile.call({deduped:this._deduped},E,(O,G)=>{O||!G?A.call(this,O):(E.data={cacheControl:G.cacheControl,expires:G.expires,rawData:G.rawData.slice(0)},o.actor&&o.actor.send("loadTile",E,A.bind(this),void 0,!0))},!0);o.request={cancel:B}}function A(B,O){return delete o.request,o.aborted?d(null):B&&B.status!==404?d(B):(O&&O.resourceTiming&&(o.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&o.setExpiryData(O),o.loadVectorData(O,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),d(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id})}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Pe extends t.Evented{constructor(o,d,x,E){super(),this.id=o,this.dispatcher=x,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},d),t.extend(this,t.pick(d,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nn(this._options,this.map._requestManager,null,null,(d,x)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new t.ErrorEvent(d)):x&&(t.extend(this,x),x.bounds&&(this.tileBounds=new on(x.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(x.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(d)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return t.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const x=t.exported.devicePixelRatio>=2,E=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);o.request=t.getImage(this.map._requestManager.transformRequest(E,t.ResourceType.Tile),(A,B,O,G)=>(delete o.request,o.aborted?(o.state="unloaded",d(null)):A?(o.state="errored",d(A)):B?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:O,expires:G}),o.setTexture(B,this.map.painter),o.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),void d(null)):d(null)))}static loadTileData(o,d,x){o.setTexture(d,x)}static unloadTileData(o,d){o.texture&&d.saveTileTexture(o.texture)}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d()}unloadTile(o,d){o.texture&&this.map.painter.saveTileTexture(o.texture),d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function ct(_,o,d,x,E,A,B,O){const G=[_,d,E,o,x,A,1,1,1],H=[B,O,1],X=t.adjoint([],G),[oe,ve,Ee]=t.transformMat3(H,H,t.transpose(X,X));return t.multiply$1(G,[oe,0,0,0,ve,0,0,0,Ee],G)}class bt extends t.Evented{constructor(o,d,x,E){super(),this.id=o,this.dispatcher=x,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=d,this._dirty=!1}load(o,d){this._loaded=d||!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(x,E)=>{if(this._imageRequest=null,this._loaded=!0,x)this.fire(new t.ErrorEvent(x));else if(E){const{HTMLImageElement:A}=t.window;this.image=E instanceof A?t.exported.getImageData(E):E,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const d=o.map(t.MercatorCoordinate.fromLngLat);return this.tileID=function(x){let E=1/0,A=1/0,B=-1/0,O=-1/0;for(const oe of x)E=Math.min(E,oe.x),A=Math.min(A,oe.y),B=Math.max(B,oe.x),O=Math.max(O,oe.y);const G=Math.max(B-E,O-A),H=Math.max(0,Math.floor(-Math.log(G)/Math.LN2)),X=Math.pow(2,H);return new t.CanonicalTileID(H,Math.floor((E+B)/2*X),Math.floor((A+O)/2*X))}(d),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const G in this.tiles){const H=this.tiles[G];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray)return;const d=t.tileTransform(this.tileID,this.map.transform.projection),[x,E,A,B]=this.coordinates.map(G=>{const H=d.projection.project(G[0],G[1]);return t.getTilePoint(d,H)._round()});this.perspectiveTransform=function(G,H,X,oe,ve,Ee,Ie,Ce,ze,ae){const Me=ct(0,0,G,0,0,H,G,H),Ue=ct(X,oe,ve,Ee,Ie,Ce,ze,ae);return t.multiply$1(Ue,t.adjoint(Me,Me),Ue),[Ue[6]/Ue[8]*G/t.EXTENT,Ue[7]/Ue[8]*H/t.EXTENT]}(this.width,this.height,x.x,x.y,E.x,E.y,B.x,B.y,A.x,A.y);const O=this._boundsArray=new t.StructArrayLayout4i8;O.emplaceBack(x.x,x.y,0,0),O.emplaceBack(E.x,E.y,t.EXTENT,0),O.emplaceBack(B.x,B.y,0,t.EXTENT),O.emplaceBack(A.x,A.y,t.EXTENT,t.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(O,t.boundsAttributes.members),this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,d=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new t.Texture(o,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,d){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},d(null)):(o.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const jt={vector:wi,raster:Pe,"raster-dem":class extends Pe{constructor(_,o,d,x){super(_,o,d,x),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(_,o){const d=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(E,A){E&&(_.state="errored",o(E)),A&&(_.dem=A,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",o(null))}_.request=t.getImage(this.map._requestManager.transformRequest(d,t.ResourceType.Tile),(function(E,A,B,O){if(delete _.request,_.aborted)_.state="unloaded",o(null);else if(E)_.state="errored",o(E);else if(A){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:B,expires:O});const G=t.window.ImageBitmap&&A instanceof t.window.ImageBitmap&&(so==null&&(so=t.window.OffscreenCanvas&&new t.window.OffscreenCanvas(1,1).getContext("2d")&&typeof t.window.createImageBitmap=="function"),so),H=1-(A.width-t.prevPowerOfTwo(A.width))/2;H<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const X=G?A:t.exported.getImageData(A,H),oe={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:X,encoding:this.encoding,padding:H};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",oe,x.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(_){const o=_.canonical,d=Math.pow(2,o.z),x=(o.x-1+d)%d,E=o.x===0?_.wrap-1:_.wrap,A=(o.x+1+d)%d,B=o.x+1===d?_.wrap+1:_.wrap,O={};return O[new t.OverscaledTileID(_.overscaledZ,E,o.z,x,o.y).key]={backfilled:!1},O[new t.OverscaledTileID(_.overscaledZ,B,o.z,A,o.y).key]={backfilled:!1},o.y>0&&(O[new t.OverscaledTileID(_.overscaledZ,E,o.z,x,o.y-1).key]={backfilled:!1},O[new t.OverscaledTileID(_.overscaledZ,_.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},O[new t.OverscaledTileID(_.overscaledZ,B,o.z,A,o.y-1).key]={backfilled:!1}),o.y+1<d&&(O[new t.OverscaledTileID(_.overscaledZ,E,o.z,x,o.y+1).key]={backfilled:!1},O[new t.OverscaledTileID(_.overscaledZ,_.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},O[new t.OverscaledTileID(_.overscaledZ,B,o.z,A,o.y+1).key]={backfilled:!1}),O}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends t.Evented{constructor(_,o,d,x){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(x),this._data=o.data,this._options=t.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const E=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*E,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*E,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:t.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*E,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},o),this}getClusterChildren(_,o){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},o),this}getClusterLeaves(_,o,d,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:o,offset:d},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=t.extend({},this.workerOptions),o=this._data;typeof o=="string"?(_.request=this.map._requestManager.transformRequest(t.exported.resolveURL(o),t.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(d,x)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new t.ErrorEvent(d));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(E.resourceTiming=x.resourceTiming[this.id]),this.fire(new t.Event("data",E)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,o){const d=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(d,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(x,E)=>(delete _.request,_.unloadVectorData(),_.aborted?o(null):x?o(x):(_.loadVectorData(E,this.map.painter,d==="reloadTile"),o(null))),void 0,d==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends bt{constructor(_,o,d,x){super(_,o,d,x),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const o of _.urls)this.urls.push(this.map._requestManager.transformRequest(o,t.ResourceType.Source).url);t.getVideo(this.urls,(o,d)=>{this._loaded=!0,o?this.fire(new t.ErrorEvent(o)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const o=this.video.seekable;_<o.start(0)||_>o.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,o=_.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(_,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:bt,canvas:class extends bt{constructor(_,o,d,x){super(_,o,d,x),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(E=>!Array.isArray(E)||E.length!==2||E.some(A=>typeof A!="number"))||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends t.Evented{constructor(_,o,d,x){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=o,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new t.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new t.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new on(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),t.extend(this,t.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return t.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:o,y:d,z:x}=_.canonical;return this._implementation.hasTile({x:o,y:d,z:x})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,o){const{x:d,y:x,z:E}=_.tileID.canonical,A=new t.window.AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:d,y:x,z:E},{signal:A.signal})).then((function(B){return delete _.request,_.aborted?(_.state="unloaded",o(null)):B===void 0?(_.state="errored",o(null)):B===null?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",o(null)):function(O){return O instanceof t.window.ImageData||O instanceof t.window.HTMLCanvasElement||O instanceof t.window.ImageBitmap||O instanceof t.window.HTMLImageElement}(B)?(this.loadTileData(_,B),_.state="loaded",void o(null)):(_.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(B=>{B.code!==20&&(_.state="errored",o(B))}),_.request.cancel=()=>A.abort()}loadTileData(_,o){Pe.loadTileData(_,o,this._map.painter)}unloadTileData(_){Pe.unloadTileData(_,this._map.painter)}unloadTile(_,o){if(this.unloadTileData(_),this._implementation.unloadTile){const{x:d,y:x,z:E}=_.tileID.canonical;this._implementation.unloadTile({x:d,y:x,z:E})}o()}abortTile(_,o){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))}}},pe=function(_,o,d,x){const E=new jt[o.type](_,o,d,x);if(E.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${E.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],E),E};function Y(_,o){const d=t.identity([]);return t.scale(d,d,[.5*_.width,.5*-_.height,1]),t.translate(d,d,[1,-1,0]),t.multiply(d,d,_.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(d)}function re(_,o,d,x,E,A,B,O=!1){const G=_.tilesIn(x,B,O);G.sort(ge);const H=[];for(const oe of G)H.push({wrappedTileID:oe.tile.tileID.wrapped().key,queryResults:oe.tile.queryRenderedFeatures(o,d,_._state,oe,E,A,Y(_.transform,oe.tile.tileID),O)});const X=function(oe){const ve={},Ee={};for(const Ie of oe){const Ce=Ie.queryResults,ze=Ie.wrappedTileID,ae=Ee[ze]=Ee[ze]||{};for(const Me in Ce){const Ue=Ce[Me],Ge=ae[Me]=ae[Me]||{},rt=ve[Me]=ve[Me]||[];for(const nt of Ue)Ge[nt.featureIndex]||(Ge[nt.featureIndex]=!0,rt.push(nt))}}return ve}(H);for(const oe in X)X[oe].forEach(ve=>{const Ee=ve.feature,Ie=Ee.layer;Ie&&Ie.type!=="background"&&Ie.type!=="sky"&&(Ee.source=Ie.source,Ie["source-layer"]&&(Ee.sourceLayer=Ie["source-layer"]),Ee.state=Ee.id!==void 0?_.getFeatureState(Ie["source-layer"],Ee.id):{})});return X}function fe(_,o){const d=_.getRenderableIds().map(A=>_.getTileByID(A)),x=[],E={};for(let A=0;A<d.length;A++){const B=d[A],O=B.tileID.canonical.key;E[O]||(E[O]=!0,B.querySourceFeatures(x,o))}return x}function ge(_,o){const d=_.tileID,x=o.tileID;return d.overscaledZ-x.overscaledZ||d.canonical.y-x.canonical.y||d.wrap-x.wrap||d.canonical.x-x.canonical.x}function ke(){return Cs.workerClass!=null?new Cs.workerClass:new t.window.Worker(Cs.workerUrl)}const Ze="mapboxgl_preloaded_worker_pool";class $e{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<$e.workerCount;)this.workers.push(new ke);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ze]}numActive(){return Object.keys(this.active).length}}let Ve;function ut(){return Ve||(Ve=new $e),Ve}function Dt(_,o){const d={};for(const x in _)x!=="ref"&&(d[x]=_[x]);return t.refProperties.forEach(x=>{x in o&&(d[x]=o[x])}),d}function Ht(_){_=_.slice();const o=Object.create(null);for(let d=0;d<_.length;d++)o[_[d].id]=_[d];for(let d=0;d<_.length;d++)"ref"in _[d]&&(_[d]=Dt(_[d],o[_[d].ref]));return _}$e.workerCount=2;const ft={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ji(_,o,d){d.push({command:ft.addSource,args:[_,o[_]]})}function Zi(_,o,d){o.push({command:ft.removeSource,args:[_]}),d[_]=!0}function Ai(_,o,d,x){Zi(_,d,x),ji(_,o,d)}function Yi(_,o,d){let x;for(x in _[d])if(_[d].hasOwnProperty(x)&&x!=="data"&&!j(_[d][x],o[d][x]))return!1;for(x in o[d])if(o[d].hasOwnProperty(x)&&x!=="data"&&!j(_[d][x],o[d][x]))return!1;return!0}function rr(_,o,d,x,E,A){let B;for(B in o=o||{},_=_||{})_.hasOwnProperty(B)&&(j(_[B],o[B])||d.push({command:A,args:[x,B,o[B],E]}));for(B in o)o.hasOwnProperty(B)&&!_.hasOwnProperty(B)&&(j(_[B],o[B])||d.push({command:A,args:[x,B,o[B],E]}))}function br(_){return _.id}function hr(_,o){return _[o.id]=o,_}class wr{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=t.clamp(o,0,1);let d=1,x=this._distances[d];const E=o*this.paddedLength+this.padding;for(;x<E&&d<this._distances.length;)x=this._distances[++d];const A=d-1,B=this._distances[A],O=x-B,G=O>0?(E-B)/O:0;return this.points[A].mult(1-G).add(this.points[d].mult(G))}}class Mr{constructor(o,d,x){const E=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(o/x),this.yCellCount=Math.ceil(d/x);for(let B=0;B<this.xCellCount*this.yCellCount;B++)E.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,x,E,A){this._forEachCell(d,x,E,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(x),this.bboxes.push(E),this.bboxes.push(A)}insertCircle(o,d,x,E){this._forEachCell(d-E,x-E,d+E,x+E,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(x),this.circles.push(E)}_insertBoxCell(o,d,x,E,A,B){this.boxCells[A].push(B)}_insertCircleCell(o,d,x,E,A,B){this.circleCells[A].push(B)}_query(o,d,x,E,A,B){if(x<0||o>this.width||E<0||d>this.height)return!A&&[];const O=[];if(o<=0&&d<=0&&this.width<=x&&this.height<=E){if(A)return!0;for(let G=0;G<this.boxKeys.length;G++)O.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const H=this.circles[3*G],X=this.circles[3*G+1],oe=this.circles[3*G+2];O.push({key:this.circleKeys[G],x1:H-oe,y1:X-oe,x2:H+oe,y2:X+oe})}return B?O.filter(B):O}return this._forEachCell(o,d,x,E,this._queryCell,O,{hitTest:A,seenUids:{box:{},circle:{}}},B),A?O.length>0:O}_queryCircle(o,d,x,E,A){const B=o-x,O=o+x,G=d-x,H=d+x;if(O<0||B>this.width||H<0||G>this.height)return!E&&[];const X=[];return this._forEachCell(B,G,O,H,this._queryCellCircle,X,{hitTest:E,circle:{x:o,y:d,radius:x},seenUids:{box:{},circle:{}}},A),E?X.length>0:X}query(o,d,x,E,A){return this._query(o,d,x,E,!1,A)}hitTest(o,d,x,E,A){return this._query(o,d,x,E,!0,A)}hitTestCircle(o,d,x,E){return this._queryCircle(o,d,x,!0,E)}_queryCell(o,d,x,E,A,B,O,G){const H=O.seenUids,X=this.boxCells[A];if(X!==null){const ve=this.bboxes;for(const Ee of X)if(!H.box[Ee]){H.box[Ee]=!0;const Ie=4*Ee;if(o<=ve[Ie+2]&&d<=ve[Ie+3]&&x>=ve[Ie+0]&&E>=ve[Ie+1]&&(!G||G(this.boxKeys[Ee]))){if(O.hitTest)return B.push(!0),!0;B.push({key:this.boxKeys[Ee],x1:ve[Ie],y1:ve[Ie+1],x2:ve[Ie+2],y2:ve[Ie+3]})}}}const oe=this.circleCells[A];if(oe!==null){const ve=this.circles;for(const Ee of oe)if(!H.circle[Ee]){H.circle[Ee]=!0;const Ie=3*Ee;if(this._circleAndRectCollide(ve[Ie],ve[Ie+1],ve[Ie+2],o,d,x,E)&&(!G||G(this.circleKeys[Ee]))){if(O.hitTest)return B.push(!0),!0;{const Ce=ve[Ie],ze=ve[Ie+1],ae=ve[Ie+2];B.push({key:this.circleKeys[Ee],x1:Ce-ae,y1:ze-ae,x2:Ce+ae,y2:ze+ae})}}}}}_queryCellCircle(o,d,x,E,A,B,O,G){const H=O.circle,X=O.seenUids,oe=this.boxCells[A];if(oe!==null){const Ee=this.bboxes;for(const Ie of oe)if(!X.box[Ie]){X.box[Ie]=!0;const Ce=4*Ie;if(this._circleAndRectCollide(H.x,H.y,H.radius,Ee[Ce+0],Ee[Ce+1],Ee[Ce+2],Ee[Ce+3])&&(!G||G(this.boxKeys[Ie])))return B.push(!0),!0}}const ve=this.circleCells[A];if(ve!==null){const Ee=this.circles;for(const Ie of ve)if(!X.circle[Ie]){X.circle[Ie]=!0;const Ce=3*Ie;if(this._circlesCollide(Ee[Ce],Ee[Ce+1],Ee[Ce+2],H.x,H.y,H.radius)&&(!G||G(this.circleKeys[Ie])))return B.push(!0),!0}}}_forEachCell(o,d,x,E,A,B,O,G){const H=this._convertToXCellCoord(o),X=this._convertToYCellCoord(d),oe=this._convertToXCellCoord(x),ve=this._convertToYCellCoord(E);for(let Ee=H;Ee<=oe;Ee++)for(let Ie=X;Ie<=ve;Ie++)if(A.call(this,o,d,x,E,this.xCellCount*Ie+Ee,B,O,G))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,x,E,A,B){const O=E-o,G=A-d,H=x+B;return H*H>O*O+G*G}_circleAndRectCollide(o,d,x,E,A,B,O){const G=(B-E)/2,H=Math.abs(o-(E+G));if(H>G+x)return!1;const X=(O-A)/2,oe=Math.abs(d-(A+X));if(oe>X+x)return!1;if(H<=G||oe<=X)return!0;const ve=H-G,Ee=oe-X;return ve*ve+Ee*Ee<=x*x}}const Qi={unknown:0,flipRequired:1,flipNotRequired:2},Pr=Math.tan(85*Math.PI/180);function It(_,o,d,x,E,A,B){const O=t.create();if(d)if(A.name==="globe"){const G=t.calculateGlobeLabelMatrix(E,o);t.multiply(O,O,G)}else{const G=zt([],B);O[0]=G[0],O[1]=G[1],O[4]=G[2],O[5]=G[3],x||t.rotateZ(O,O,E.angle)}else t.multiply(O,E.labelPlaneMatrix,_);return O}function Tn(_,o,d,x,E,A,B){const O=It(_,o,d,x,E,A,B);return A.name==="globe"&&d||(O[2]=O[6]=O[10]=O[14]=0),O}function Cr(_,o,d,x,E,A,B){if(d){if(A.name==="globe"){const O=It(_,o,d,x,E,A,B);return t.invert(O,O),t.multiply(O,_,O),O}{const O=t.clone(_),G=t.identity([]);return G[0]=B[0],G[1]=B[1],G[4]=B[2],G[5]=B[3],t.multiply(O,O,G),x||t.rotateZ(O,O,-E.angle),O}}return E.glCoordMatrix}function En(_,o,d,x){const E=[_,o,d,1];d?t.transformMat4$1(E,E,x):Br(E,E,x);const A=E[3];return E[0]/=A,E[1]/=A,E[2]/=A,E}function ln(_,o){return Math.min(.5+_/o*.5,1.5)}function xs(_,o){const d=_[0]/_[3],x=_[1]/_[3];return d>=-o[0]&&d<=o[0]&&x>=-o[1]&&x<=o[1]}function eu(_,o,d,x,E,A,B,O,G,H){const X=d.transform,oe=x?_.textSizeData:_.iconSizeData,ve=t.evaluateSizeForZoom(oe,d.transform.zoom),Ee=X.projection.name==="globe",Ie=[256/d.width*2+1,256/d.height*2+1],Ce=x?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;Ce.clear();let ze=null;Ee&&(ze=x?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const ae=_.lineVertexArray,Me=x?_.text.placedSymbolArray:_.icon.placedSymbolArray,Ue=d.transform.width/d.transform.height;let Ge,rt=!1;for(let nt=0;nt<Me.length;nt++){const tt=Me.get(nt),{numGlyphs:gt,writingMode:yt}=tt;if(yt!==t.WritingMode.vertical||rt||Ge===t.WritingMode.horizontal||(rt=!0),Ge=yt,(tt.hidden||yt===t.WritingMode.vertical)&&!rt){qs(gt,Ce);continue}rt=!1;const kt=new t.Point(tt.tileAnchorX,tt.tileAnchorY);let{x:yi,y:At,z:Zt}=X.projection.projectTilePoint(kt.x,kt.y,H.canonical);if(G){const[vr,Xi,cr]=G(kt);yi+=vr,At+=Xi,Zt+=cr}const Nt=[yi,At,Zt,1];if(t.transformMat4$1(Nt,Nt,o),!xs(Nt,Ie)){qs(gt,Ce);continue}const mi=ln(d.transform.cameraToCenterDistance,Nt[3]),Ct=t.evaluateSizeForFeature(oe,ve,tt),ei=B?Ct/mi:Ct*mi,_i=En(yi,At,Zt,E);if(_i[3]<=0){qs(gt,Ce);continue}let si={};const xi=B?null:G,or=Di(tt,ei,!1,O,o,E,A,_.glyphOffsetArray,ae,Ce,ze,_i,kt,si,Ue,xi,X.projection,H,B);rt=or.useVertical,xi&&or.needsFlipping&&(si={}),(or.notEnoughRoom||rt||or.needsFlipping&&Di(tt,ei,!0,O,o,E,A,_.glyphOffsetArray,ae,Ce,ze,_i,kt,si,Ue,xi,X.projection,H,B).notEnoughRoom)&&qs(gt,Ce)}x?(_.text.dynamicLayoutVertexBuffer.updateData(Ce),ze&&_.text.globeExtVertexBuffer.updateData(ze)):(_.icon.dynamicLayoutVertexBuffer.updateData(Ce),ze&&_.icon.globeExtVertexBuffer.updateData(ze))}function Eh(_,o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce){const{lineStartIndex:ze,glyphStartIndex:ae,segment:Me}=O,Ue=ae+O.numGlyphs,Ge=ze+O.lineLength,rt=o.getoffsetX(ae),nt=o.getoffsetX(Ue-1),tt=ss(_*rt,d,x,E,A,B,Me,ze,Ge,G,H,X,oe,ve,!0,Ee,Ie,Ce);if(!tt)return null;const gt=ss(_*nt,d,x,E,A,B,Me,ze,Ge,G,H,X,oe,ve,!0,Ee,Ie,Ce);return gt?{first:tt,last:gt}:null}function $l(_,o,d,x){return _===t.WritingMode.horizontal&&Math.abs(x)>Math.abs(d)?{useVertical:!0}:_===t.WritingMode.vertical?x>0?{needsFlipping:!0}:null:o!==Qi.unknown&&function(E,A){return E===0||Math.abs(A/E)>Pr}(d,x)?o===Qi.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function Di(_,o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce,ze,ae,Me){const Ue=o/24,Ge=_.lineOffsetX*Ue,rt=_.lineOffsetY*Ue,{lineStartIndex:nt,glyphStartIndex:tt,numGlyphs:gt,segment:yt,writingMode:kt,flipState:yi}=_,At=nt+_.lineLength,Zt=Nt=>{if(X){const[_i,si,xi]=Nt.up,or=H.length;t.updateGlobeVertexNormal(X,or+0,_i,si,xi),t.updateGlobeVertexNormal(X,or+1,_i,si,xi),t.updateGlobeVertexNormal(X,or+2,_i,si,xi),t.updateGlobeVertexNormal(X,or+3,_i,si,xi)}const[mi,Ct,ei]=Nt.point;t.addDynamicAttributes(H,mi,Ct,ei,Nt.angle)};if(gt>1){const Nt=Eh(Ue,O,Ge,rt,d,oe,ve,_,G,A,Ee,Ce,!1,ze,ae,Me);if(!Nt)return{notEnoughRoom:!0};if(x&&!d){let[mi,Ct,ei]=Nt.first.point,[_i,si,xi]=Nt.last.point;[mi,Ct]=En(mi,Ct,ei,B),[_i,si]=En(_i,si,xi,B);const or=$l(kt,yi,(_i-mi)*Ie,si-Ct);if(_.flipState=or&&or.needsFlipping?Qi.flipRequired:Qi.flipNotRequired,or)return or}Zt(Nt.first);for(let mi=tt+1;mi<tt+gt-1;mi++){const Ct=ss(Ue*O.getoffsetX(mi),Ge,rt,d,oe,ve,yt,nt,At,G,A,Ee,Ce,!1,!1,ze,ae,Me);if(!Ct)return H.length-=4*(mi-tt),{notEnoughRoom:!0};Zt(Ct)}Zt(Nt.last)}else{if(x&&!d){const mi=En(ve.x,ve.y,0,E),Ct=nt+yt+1,ei=new t.Point(G.getx(Ct),G.gety(Ct)),_i=En(ei.x,ei.y,0,E),si=_i[3]>0?_i:Ar(ve,ei,mi,1,E,void 0,ze,ae.canonical),xi=$l(kt,yi,(si[0]-mi[0])*Ie,si[1]-mi[1]);if(_.flipState=xi&&xi.needsFlipping?Qi.flipRequired:Qi.flipNotRequired,xi)return xi}const Nt=ss(Ue*O.getoffsetX(tt),Ge,rt,d,oe,ve,yt,nt,At,G,A,Ee,Ce,!1,!1,ze,ae,Me);if(!Nt)return{notEnoughRoom:!0};Zt(Nt)}return{}}function $r(_,o,d,x,E){const{x:A,y:B,z:O}=x.projectTilePoint(_.x,_.y,o);if(!E)return En(A,B,O,d);const[G,H,X]=E(_);return En(A+G,B+H,O+X,d)}function Ar(_,o,d,x,E,A,B,O){const G=$r(_.sub(o)._unit()._add(_),O,E,B,A);return t.sub(G,d,G),t.normalize(G,G),t.scaleAndAdd(G,d,G,x)}function ss(_,o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce,ze,ae){const Me=x?_-o:_+o;let Ue=Me>0?1:-1,Ge=0;x&&(Ue*=-1,Ge=Math.PI),Ue<0&&(Ge+=Math.PI);let rt=O+B+(Ue>0?0:1)|0,nt=E,tt=E,gt=0,yt=0;const kt=Math.abs(Me),yi=[],At=[];let Zt=A,Nt=Zt;const mi=()=>Ar(Nt,Zt,tt,kt-gt+1,X,ve,Ce,ze.canonical);for(;gt+yt<=kt;){if(rt+=Ue,rt<O||rt>=G)return null;if(tt=nt,Nt=Zt,yi.push(tt),Ee&&At.push(Nt),Zt=new t.Point(H.getx(rt),H.gety(rt)),nt=oe[rt],!nt){const cr=$r(Zt,ze.canonical,X,Ce,ve);nt=cr[3]>0?oe[rt]=cr:mi()}gt+=yt,yt=t.distance(tt,nt)}Ie&&ve&&(oe[rt]&&(nt=mi(),yt=t.distance(tt,nt)),oe[rt]=nt);const Ct=(kt-gt)/yt,ei=Zt.sub(Nt)._mult(Ct)._add(Nt),_i=t.sub([],nt,tt),si=t.scaleAndAdd([],tt,_i,Ct);let xi=[0,0,1],or=_i[0],vr=_i[1];if(ae&&(xi=Ce.upVector(ze.canonical,ei.x,ei.y),xi[0]!==0||xi[1]!==0||xi[2]!==1)){const cr=[xi[2],0,-xi[0]],Zr=t.cross([],xi,cr);t.normalize(cr,cr),t.normalize(Zr,Zr),or=t.dot(_i,cr),vr=t.dot(_i,Zr)}if(d){const cr=t.cross([],xi,_i);t.normalize(cr,cr),t.scaleAndAdd(si,si,cr,d*Ue)}const Xi=Ge+Math.atan2(vr,or);return yi.push(si),Ee&&At.push(ei),{point:si,angle:Xi,path:yi,tilePath:At,up:xi}}function qs(_,o){const d=o.length,x=d+4*_;o.resize(x),o.float32.fill(-1/0,4*d,4*x)}function Br(_,o,d){const x=o[0],E=o[1];return _[0]=d[0]*x+d[4]*E+d[12],_[1]=d[1]*x+d[5]*E+d[13],_[3]=d[3]*x+d[7]*E+d[15],_}const vs=100;class na{constructor(o,d,x=new Mr(o.width+200,o.height+200,25),E=new Mr(o.width+200,o.height+200,25)){this.transform=o,this.grid=x,this.ignoredGrid=E,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+vs,this.screenBottomBoundary=o.height+vs,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=d}placeCollisionBox(o,d,x,E,A,B,O,G){let H=x.projectedAnchorX,X=x.projectedAnchorY,oe=x.projectedAnchorZ;const ve=x.elevation,Ee=x.tileID,Ie=o.getProjection();if(ve&&Ee){const[nt,tt,gt]=Ie.upVector(Ee.canonical,x.tileAnchorX,x.tileAnchorY),yt=Ie.upVectorScale(Ee.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=nt*ve*yt,X+=tt*ve*yt,oe+=gt*ve*yt}const Ce=this.projectAndGetPerspectiveRatio(O,H,X,oe,x.tileID,Ie.name==="globe"||!!ve||this.transform.pitch>0,Ie),ze=B*Ce.perspectiveRatio,ae=(x.x1*d+E.x-x.padding)*ze+Ce.point.x,Me=(x.y1*d+E.y-x.padding)*ze+Ce.point.y,Ue=(x.x2*d+E.x+x.padding)*ze+Ce.point.x,Ge=(x.y2*d+E.y+x.padding)*ze+Ce.point.y,rt=Ce.perspectiveRatio<=.55||Ce.occluded;return!this.isInsideGrid(ae,Me,Ue,Ge)||!A&&this.grid.hitTest(ae,Me,Ue,Ge,G)||rt?{box:[],offscreen:!1,occluded:Ce.occluded}:{box:[ae,Me,Ue,Ge],offscreen:this.isOffscreen(ae,Me,Ue,Ge),occluded:!1}}placeCollisionCircles(o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce){const ze=[],ae=this.transform.elevation,Me=o.getProjection(),Ue=ae?ae.getAtTileOffsetFunc(Ce,this.transform.center.lat,this.transform.worldSize,Me):null,Ge=new t.Point(x.tileAnchorX,x.tileAnchorY);let{x:rt,y:nt,z:tt}=Me.projectTilePoint(Ge.x,Ge.y,Ce.canonical);if(Ue){const[ei,_i,si]=Ue(Ge);rt+=ei,nt+=_i,tt+=si}const gt=Me.name==="globe",yt=this.projectAndGetPerspectiveRatio(O,rt,nt,tt,Ce,gt||!!ae||this.transform.pitch>0,Me),{perspectiveRatio:kt}=yt,yi=(oe?B/kt:B*kt)/t.ONE_EM,At=En(rt,nt,tt,G),Zt=yt.signedDistanceFromCamera>0?Eh(yi,A,x.lineOffsetX*yi,x.lineOffsetY*yi,!1,At,Ge,x,E,G,{},ae&&!oe?Ue:null,oe&&!!ae,Me,Ce,oe):null;let Nt=!1,mi=!1,Ct=!0;if(Zt&&!yt.occluded){const ei=.5*Ee*kt+Ie,_i=new t.Point(-100,-100),si=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),xi=new wr,{first:or,last:vr}=Zt,Xi=or.path.length;let cr=[];for(let er=Xi-1;er>=1;er--)cr.push(or.path[er]);for(let er=1;er<vr.path.length;er++)cr.push(vr.path[er]);const Zr=2.5*ei;H&&(cr=cr.map(([er,pn,un],kn)=>(Ue&&!gt&&(un=Ue(kn<Xi-1?or.tilePath[Xi-1-kn]:vr.tilePath[kn-Xi+2])[2]),En(er,pn,un,H))),cr.some(er=>er[3]<=0)&&(cr=[]));let Fr=[];if(cr.length>0){let er=1/0,pn=-1/0,un=1/0,kn=-1/0;for(const fn of cr)er=Math.min(er,fn[0]),un=Math.min(un,fn[1]),pn=Math.max(pn,fn[0]),kn=Math.max(kn,fn[1]);pn>=_i.x&&er<=si.x&&kn>=_i.y&&un<=si.y&&(Fr=[cr.map(fn=>new t.Point(fn[0],fn[1]))],(er<_i.x||pn>si.x||un<_i.y||kn>si.y)&&(Fr=t.clipLine(Fr,_i.x,_i.y,si.x,si.y)))}for(const er of Fr){xi.reset(er,.25*ei);let pn=0;pn=xi.length<=.5*ei?1:Math.ceil(xi.paddedLength/Zr)+1;for(let un=0;un<pn;un++){const kn=un/Math.max(pn-1,1),fn=xi.lerp(kn),Lo=fn.x+vs,go=fn.y+vs;ze.push(Lo,go,ei,0);const Ma=Lo-ei,Sl=go-ei,Wr=Lo+ei,jr=go+ei;if(Ct=Ct&&this.isOffscreen(Ma,Sl,Wr,jr),mi=mi||this.isInsideGrid(Ma,Sl,Wr,jr),!d&&this.grid.hitTestCircle(Lo,go,ei,ve)&&(Nt=!0,!X))return{circles:[],offscreen:!1,collisionDetected:Nt,occluded:!1}}}}return{circles:!X&&Nt||!mi?[]:ze,offscreen:Ct,collisionDetected:Nt,occluded:yt.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let x=1/0,E=1/0,A=-1/0,B=-1/0;for(const X of o){const oe=new t.Point(X.x+vs,X.y+vs);x=Math.min(x,oe.x),E=Math.min(E,oe.y),A=Math.max(A,oe.x),B=Math.max(B,oe.y),d.push(oe)}const O=this.grid.query(x,E,A,B).concat(this.ignoredGrid.query(x,E,A,B)),G={},H={};for(const X of O){const oe=X.key;if(G[oe.bucketInstanceId]===void 0&&(G[oe.bucketInstanceId]={}),G[oe.bucketInstanceId][oe.featureIndex])continue;const ve=[new t.Point(X.x1,X.y1),new t.Point(X.x2,X.y1),new t.Point(X.x2,X.y2),new t.Point(X.x1,X.y2)];t.polygonIntersectsPolygon(d,ve)&&(G[oe.bucketInstanceId][oe.featureIndex]=!0,H[oe.bucketInstanceId]===void 0&&(H[oe.bucketInstanceId]=[]),H[oe.bucketInstanceId].push(oe.featureIndex))}return H}insertCollisionBox(o,d,x,E,A){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:E,collisionGroupID:A},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,x,E,A){const B=d?this.ignoredGrid:this.grid,O={bucketInstanceId:x,featureIndex:E,collisionGroupID:A};for(let G=0;G<o.length;G+=4)B.insertCircle(O,o[G],o[G+1],o[G+2])}projectAndGetPerspectiveRatio(o,d,x,E,A,B,O){const G=[d,x,E,1];let H=!1;E||this.transform.pitch>0?(t.transformMat4$1(G,G,o),this.fogState&&A&&O.name!=="globe"&&(H=function(ve,Ee,Ie,Ce,ze,ae){const Me=ae.calculateFogTileMatrix(ze),Ue=[Ee,Ie,Ce];return t.transformMat4(Ue,Ue,Me),Mt(ve,Ue,ae.pitch,ae._fov)}(this.fogState,d,x,E,A.toUnwrapped(),this.transform)>.9)):Br(G,G,o);const X=G[3];return{point:new t.Point((G[0]/X+1)/2*this.transform.width+vs,(-G[1]/X+1)/2*this.transform.height+vs),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/X*.5,1.5),signedDistanceFromCamera:X,occluded:B&&G[2]>X||H}}isOffscreen(o,d,x,E){return x<vs||o>=this.screenRightBoundary||E<vs||d>this.screenBottomBoundary}isInsideGrid(o,d,x,E){return x>=0&&o<this.gridRightBoundary&&E>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=t.identity([]);return t.translate(o,o,[-100,-100,0]),o}}function oa(_,o,d){const x=o.createTileMatrix(_,_.worldSize,d.toUnwrapped());return t.multiply(new Float32Array(16),_.projMatrix,x)}function Po(_,o,d){if(o.projection.name===d.projection.name)return _.projMatrix;const x=d.clone();return x.setProjection(o.projection),oa(x,o.getProjection(),_)}function Sn(_,o,d){return o.name===d.projection.name?_.projMatrix:oa(d,o,_)}class tu{constructor(o,d,x,E){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):E&&x?1:0,this.placed=x}isHidden(){return this.opacity===0&&!this.placed}}class bs{constructor(o,d,x,E,A,B=!1){this.text=new tu(o?o.text:null,d,x,A),this.icon=new tu(o?o.icon:null,d,E,A),this.clipped=B}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Zl{constructor(o,d,x,E=!1){this.text=o,this.icon=d,this.skipFade=x,this.clipped=E}}class cl{constructor(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]}}class ql{constructor(o,d,x,E,A){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=x,this.bucketIndex=E,this.tileID=A}}class Bn{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:x=>x.collisionGroupID===d}}return this.collisionGroups[o]}}function Na(_,o,d,x,E){const{horizontalAlign:A,verticalAlign:B}=t.getAnchorAlignment(_),O=-(A-.5)*o,G=-(B-.5)*d,H=t.evaluateVariableOffset(_,x);return new t.Point(O+H[0]*E,G+H[1]*E)}function Tc(_,o,d,x,E){const A=new t.Point(_,o);return d&&A._rotate(x?E:-E),A}class iu{constructor(o,d,x,E,A){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new na(this.transform,A),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Bn(x),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,x,E){const A=x.getBucket(d),B=x.latestFeatureIndex;if(!A||!B||d.id!==A.layerIds[0])return;const O=A.layers[0].layout,G=x.collisionBoxArray,H=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),X=x.tileSize/t.EXTENT,oe=x.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ve=(Ee=x.tileID,Ie=A.getProjection(),Ce=this.transform,Ie.name===this.projection?Ce.calculateProjMatrix(Ee.toUnwrapped()):oa(Ce,Ie,Ee));var Ee,Ie,Ce;const ze=O.get("text-pitch-alignment")==="map",ae=O.get("text-rotation-alignment")==="map";d.compileFilter();const Me=d.dynamicFilter(),Ue=d.dynamicFilterNeedsFeature(),Ge=this.transform.calculatePixelsToTileUnitsMatrix(x),rt=Tn(ve,x.tileID.canonical,ze,ae,this.transform,A.getProjection(),Ge);let nt=null;if(ze){const yt=Cr(ve,x.tileID.canonical,ze,ae,this.transform,A.getProjection(),Ge);nt=t.multiply([],this.transform.labelPlaneMatrix,yt)}let tt=null;Me&&x.latestFeatureIndex&&(tt={unwrappedTileID:oe,dynamicFilter:Me,dynamicFilterNeedsFeature:Ue,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[A.bucketInstanceId]=new ql(A.bucketInstanceId,B,A.sourceLayerIndex,A.index,x.tileID);const gt={bucket:A,layout:O,posMatrix:ve,textLabelPlaneMatrix:rt,labelToScreenMatrix:nt,clippingData:tt,scale:H,textPixelRatio:X,holdingForFade:x.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(A.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(A.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(A.sourceID)};if(E)for(const yt of A.sortKeyRanges){const{sortKey:kt,symbolInstanceStart:yi,symbolInstanceEnd:At}=yt;o.push({sortKey:kt,symbolInstanceStart:yi,symbolInstanceEnd:At,parameters:gt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:gt})}attemptAnchorPlacement(o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce,ze,ae,Me){const{textOffset0:Ue,textOffset1:Ge,crossTileID:rt}=ve,nt=[Ue,Ge],tt=Na(o,x,E,nt,A),gt=this.collisionIndex.placeCollisionBox(Ie,A,d,Tc(tt.x,tt.y,B,O,this.transform.angle),oe,G,H,X.predicate);if(ze){const yt=Ie.getSymbolInstanceIconSize(Me,this.transform.zoom,ve.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Ie,yt,ze,Tc(tt.x,tt.y,B,O,this.transform.angle),oe,G,H,X.predicate).box.length===0)return}if(gt.box.length>0){let yt;return this.prevPlacement&&this.prevPlacement.variableOffsets[rt]&&this.prevPlacement.placements[rt]&&this.prevPlacement.placements[rt].text&&(yt=this.prevPlacement.variableOffsets[rt].anchor),this.variableOffsets[rt]={textOffset:nt,width:x,height:E,anchor:o,textScale:A,prevAnchor:yt},this.markUsedJustification(Ie,o,ve,Ce),Ie.allowVerticalPlacement&&(this.markUsedOrientation(Ie,Ce,ve),this.placedOrientations[rt]=Ce),{shift:tt,placedGlyphBoxes:gt}}}placeLayerBucketPart(o,d,x,E){const{bucket:A,layout:B,posMatrix:O,textLabelPlaneMatrix:G,labelToScreenMatrix:H,clippingData:X,textPixelRatio:oe,holdingForFade:ve,collisionBoxArray:Ee,partiallyEvaluatedTextSize:Ie,partiallyEvaluatedIconSize:Ce,collisionGroup:ze}=o.parameters,ae=B.get("text-optional"),Me=B.get("icon-optional"),Ue=B.get("text-allow-overlap"),Ge=B.get("icon-allow-overlap"),rt=B.get("text-rotation-alignment")==="map",nt=B.get("text-pitch-alignment")==="map",tt=B.get("icon-text-fit")!=="none",gt=B.get("symbol-z-order")==="viewport-y";this.transform.setProjection(A.projection);let yt=Ue&&(Ge||!A.hasIconData()||Me),kt=Ge&&(Ue||!A.hasTextData()||ae);!A.collisionArrays&&Ee&&A.deserializeCollisionBoxes(Ee),x&&E&&A.updateCollisionDebugBuffers(this.transform.zoom,Ee);const yi=(At,Zt,Nt)=>{const{crossTileID:mi,numVerticalGlyphVertices:Ct}=At;if(X){const Wr={zoom:this.transform.zoom,pitch:this.transform.pitch};let jr=null;if(X.dynamicFilterNeedsFeature){const an=this.retainedQueryData[A.bucketInstanceId];jr=X.featureIndex.loadFeature({featureIndex:At.featureIndex,bucketIndex:an.bucketIndex,sourceLayerIndex:an.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,X.dynamicFilter)(Wr,jr,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new t.Point(At.tileAnchorX,At.tileAnchorY),this.transform.calculateDistanceTileData(X.unwrappedTileID)))return this.placements[mi]=new Zl(!1,!1,!1,!0),void d.add(mi)}if(d.has(mi))return;if(ve)return void(this.placements[mi]=new Zl(!1,!1,!1));let ei=!1,_i=!1,si=!0,xi=!1,or=!1,vr=null,Xi={box:null,offscreen:null,occluded:null},cr={box:null,offscreen:null,occluded:null},Zr=null,Fr=null,er=null,pn=0,un=0,kn=0;Nt.textFeatureIndex?pn=Nt.textFeatureIndex:At.useRuntimeCollisionCircles&&(pn=At.featureIndex),Nt.verticalTextFeatureIndex&&(un=Nt.verticalTextFeatureIndex);const fn=Wr=>{Wr.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const jr=this.transform.elevation;(jr||Wr.elevation)&&(Wr.elevation=jr?jr.getAtTileOffset(Wr.tileID,Wr.tileAnchorX,Wr.tileAnchorY):0)},Lo=Nt.textBox;if(Lo){fn(Lo);const Wr=an=>{let lo=t.WritingMode.horizontal;if(A.allowVerticalPlacement&&!an&&this.prevPlacement){const Is=this.prevPlacement.placedOrientations[mi];Is&&(this.placedOrientations[mi]=Is,lo=Is,this.markUsedOrientation(A,lo,At))}return lo},jr=(an,lo)=>{if(A.allowVerticalPlacement&&Ct>0&&Nt.verticalTextBox){for(const Is of A.writingModes)if(Is===t.WritingMode.vertical?(Xi=lo(),cr=Xi):Xi=an(),Xi&&Xi.box&&Xi.box.length)break}else Xi=an()};if(B.get("text-variable-anchor")){let an=B.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[mi]){const In=this.prevPlacement.variableOffsets[mi];an.indexOf(In.anchor)>0&&(an=an.filter(Ys=>Ys!==In.anchor),an.unshift(In.anchor))}const lo=(In,Ys,Uh)=>{const Bc=A.getSymbolInstanceTextSize(Ie,At,this.transform.zoom,Zt),Fc=(In.x2-In.x1)*Bc+2*In.padding,Ml=(In.y2-In.y1)*Bc+2*In.padding,rc=tt&&!Ge?Ys:null;rc&&fn(rc);let Oc={box:[],offscreen:!1,occluded:!1};const y1=Ue?2*an.length:an.length;for(let gu=0;gu<y1;++gu){const x1=this.attemptAnchorPlacement(an[gu%an.length],In,Fc,Ml,Bc,rt,nt,oe,O,ze,gu>=an.length,At,Zt,A,Uh,rc,Ie,Ce);if(x1&&(Oc=x1.placedGlyphBoxes,Oc&&Oc.box&&Oc.box.length)){ei=!0,vr=x1.shift;break}}return Oc};jr(()=>lo(Lo,Nt.iconBox,t.WritingMode.horizontal),()=>{const In=Nt.verticalTextBox;return In&&fn(In),A.allowVerticalPlacement&&!(Xi&&Xi.box&&Xi.box.length)&&Ct>0&&In?lo(In,Nt.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Xi&&(ei=Xi.box,si=Xi.offscreen,xi=Xi.occluded);const Is=Wr(!(!Xi||!Xi.box));if(!ei&&this.prevPlacement){const In=this.prevPlacement.variableOffsets[mi];In&&(this.variableOffsets[mi]=In,this.markUsedJustification(A,In.anchor,At,Is))}}else{const an=(lo,Is)=>{const In=A.getSymbolInstanceTextSize(Ie,At,this.transform.zoom,Zt),Ys=this.collisionIndex.placeCollisionBox(A,In,lo,new t.Point(0,0),Ue,oe,O,ze.predicate);return Ys&&Ys.box&&Ys.box.length&&(this.markUsedOrientation(A,Is,At),this.placedOrientations[mi]=Is),Ys};jr(()=>an(Lo,t.WritingMode.horizontal),()=>{const lo=Nt.verticalTextBox;return A.allowVerticalPlacement&&Ct>0&&lo?(fn(lo),an(lo,t.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Wr(!!(Xi&&Xi.box&&Xi.box.length))}}if(Zr=Xi,ei=Zr&&Zr.box&&Zr.box.length>0,si=Zr&&Zr.offscreen,xi=Zr&&Zr.occluded,At.useRuntimeCollisionCircles){const Wr=A.text.placedSymbolArray.get(At.centerJustifiedTextSymbolIndex>=0?At.centerJustifiedTextSymbolIndex:At.verticalPlacedTextSymbolIndex),jr=t.evaluateSizeForFeature(A.textSizeData,Ie,Wr),an=B.get("text-padding");Fr=this.collisionIndex.placeCollisionCircles(A,Ue,Wr,A.lineVertexArray,A.glyphOffsetArray,jr,O,G,H,x,nt,ze.predicate,At.collisionCircleDiameter*jr/t.ONE_EM,an,this.retainedQueryData[A.bucketInstanceId].tileID),ei=Ue||Fr.circles.length>0&&!Fr.collisionDetected,si=si&&Fr.offscreen,xi=Fr.occluded}if(Nt.iconFeatureIndex&&(kn=Nt.iconFeatureIndex),Nt.iconBox){const Wr=jr=>{fn(jr);const an=tt&&vr?Tc(vr.x,vr.y,rt,nt,this.transform.angle):new t.Point(0,0),lo=A.getSymbolInstanceIconSize(Ce,this.transform.zoom,At.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,lo,jr,an,Ge,oe,O,ze.predicate)};cr&&cr.box&&cr.box.length&&Nt.verticalIconBox?(er=Wr(Nt.verticalIconBox),_i=er.box.length>0):(er=Wr(Nt.iconBox),_i=er.box.length>0),si=si&&er.offscreen,or=er.occluded}const go=ae||At.numHorizontalGlyphVertices===0&&Ct===0,Ma=Me||At.numIconVertices===0;if(go||Ma?Ma?go||(_i=_i&&ei):ei=_i&&ei:_i=ei=_i&&ei,ei&&Zr&&Zr.box&&this.collisionIndex.insertCollisionBox(Zr.box,B.get("text-ignore-placement"),A.bucketInstanceId,cr&&cr.box&&un?un:pn,ze.ID),_i&&er&&this.collisionIndex.insertCollisionBox(er.box,B.get("icon-ignore-placement"),A.bucketInstanceId,kn,ze.ID),Fr&&(ei&&this.collisionIndex.insertCollisionCircles(Fr.circles,B.get("text-ignore-placement"),A.bucketInstanceId,pn,ze.ID),x)){const Wr=A.bucketInstanceId;let jr=this.collisionCircleArrays[Wr];jr===void 0&&(jr=this.collisionCircleArrays[Wr]=new cl);for(let an=0;an<Fr.circles.length;an+=4)jr.circles.push(Fr.circles[an+0]),jr.circles.push(Fr.circles[an+1]),jr.circles.push(Fr.circles[an+2]),jr.circles.push(Fr.collisionDetected?1:0)}const Sl=A.projection.name!=="globe";yt=yt&&(Sl||!xi),kt=kt&&(Sl||!or),this.placements[mi]=new Zl(ei||yt,_i||kt,si||A.justReloaded),d.add(mi)};if(gt){const At=A.getSortedSymbolIndexes(this.transform.angle);for(let Zt=At.length-1;Zt>=0;--Zt){const Nt=At[Zt];yi(A.symbolInstances.get(Nt),Nt,A.collisionArrays[Nt])}}else for(let At=o.symbolInstanceStart;At<o.symbolInstanceEnd;At++)yi(A.symbolInstances.get(At),At,A.collisionArrays[At]);if(x&&A.bucketInstanceId in this.collisionCircleArrays){const At=this.collisionCircleArrays[A.bucketInstanceId];t.invert(At.invProjMatrix,O),At.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(o,d,x,E){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:B,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:G,crossTileID:H}=x,X=t.getAnchorJustification(d),oe=E===t.WritingMode.vertical?G:X==="left"?A:X==="center"?B:X==="right"?O:-1;A>=0&&(o.text.placedSymbolArray.get(A).crossTileID=oe>=0&&A!==oe?0:H),B>=0&&(o.text.placedSymbolArray.get(B).crossTileID=oe>=0&&B!==oe?0:H),O>=0&&(o.text.placedSymbolArray.get(O).crossTileID=oe>=0&&O!==oe?0:H),G>=0&&(o.text.placedSymbolArray.get(G).crossTileID=oe>=0&&G!==oe?0:H)}markUsedOrientation(o,d,x){const E=d===t.WritingMode.horizontal||d===t.WritingMode.horizontalOnly?d:0,A=d===t.WritingMode.vertical?d:0,{leftJustifiedTextSymbolIndex:B,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:H}=x,X=o.text.placedSymbolArray;B>=0&&(X.get(B).placedOrientation=E),O>=0&&(X.get(O).placedOrientation=E),G>=0&&(X.get(G).placedOrientation=E),H>=0&&(X.get(H).placedOrientation=A)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let x=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const E=d?d.symbolFadeChange(o):1,A=d?d.opacities:{},B=d?d.variableOffsets:{},O=d?d.placedOrientations:{};for(const G in this.placements){const H=this.placements[G],X=A[G];X?(this.opacities[G]=new bs(X,E,H.text,H.icon,null,H.clipped),x=x||H.text!==X.text.placed||H.icon!==X.icon.placed):(this.opacities[G]=new bs(null,E,H.text,H.icon,H.skipFade,H.clipped),x=x||H.text||H.icon)}for(const G in A){const H=A[G];if(!this.opacities[G]){const X=new bs(H,E,!1,!1);X.isHidden()||(this.opacities[G]=X,x=x||H.text.placed||H.icon.placed)}}for(const G in B)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=B[G]);for(const G in O)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=O[G]);x?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const x=new Set;for(const E of d){const A=E.getBucket(o);A&&E.latestFeatureIndex&&o.id===A.layerIds[0]&&this.updateBucketOpacities(A,x,E.collisionBoxArray)}}updateBucketOpacities(o,d,x){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const E=o.layers[0].layout,A=!!o.layers[0].dynamicFilter(),B=new bs(null,0,!1,!1,!0),O=E.get("text-allow-overlap"),G=E.get("icon-allow-overlap"),H=E.get("text-variable-anchor"),X=E.get("text-rotation-alignment")==="map",oe=E.get("text-pitch-alignment")==="map",ve=E.get("icon-text-fit")!=="none",Ee=new bs(null,0,O&&(G||!o.hasIconData()||E.get("icon-optional")),G&&(O||!o.hasTextData()||E.get("text-optional")),!0);!o.collisionArrays&&x&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(x);const Ie=(ze,ae,Me)=>{for(let Ue=0;Ue<ae/4;Ue++)ze.opacityVertexArray.emplaceBack(Me)};let Ce=0;for(let ze=0;ze<o.symbolInstances.length;ze++){const ae=o.symbolInstances.get(ze),{numHorizontalGlyphVertices:Me,numVerticalGlyphVertices:Ue,crossTileID:Ge,numIconVertices:rt}=ae,nt=d.has(Ge);let tt=this.opacities[Ge];nt?tt=B:tt||(tt=Ee,this.opacities[Ge]=tt),d.add(Ge);const gt=Me>0||Ue>0,yt=rt>0,kt=this.placedOrientations[Ge],yi=kt===t.WritingMode.vertical,At=kt===t.WritingMode.horizontal||kt===t.WritingMode.horizontalOnly;if(!gt&&!yt||tt.isHidden()||Ce++,gt){const Zt=Wl(tt.text);Ie(o.text,Me,yi?_r:Zt),Ie(o.text,Ue,At?_r:Zt);const Nt=tt.text.isHidden(),{leftJustifiedTextSymbolIndex:mi,centerJustifiedTextSymbolIndex:Ct,rightJustifiedTextSymbolIndex:ei,verticalPlacedTextSymbolIndex:_i}=ae,si=o.text.placedSymbolArray,xi=Nt||yi?1:0;mi>=0&&(si.get(mi).hidden=xi),Ct>=0&&(si.get(Ct).hidden=xi),ei>=0&&(si.get(ei).hidden=xi),_i>=0&&(si.get(_i).hidden=Nt||At?1:0);const or=this.variableOffsets[Ge];or&&this.markUsedJustification(o,or.anchor,ae,kt);const vr=this.placedOrientations[Ge];vr&&(this.markUsedJustification(o,"left",ae,vr),this.markUsedOrientation(o,vr,ae))}if(yt){const Zt=Wl(tt.icon),{placedIconSymbolIndex:Nt,verticalPlacedIconSymbolIndex:mi}=ae,Ct=o.icon.placedSymbolArray,ei=tt.icon.isHidden()?1:0;Nt>=0&&(Ie(o.icon,rt,yi?_r:Zt),Ct.get(Nt).hidden=ei),mi>=0&&(Ie(o.icon,ae.numVerticalIconVertices,At?_r:Zt),Ct.get(mi).hidden=ei)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Zt=o.collisionArrays[ze];if(Zt){let Nt=new t.Point(0,0),mi=!0;if(Zt.textBox||Zt.verticalTextBox){if(H){const ei=this.variableOffsets[Ge];ei?(Nt=Na(ei.anchor,ei.width,ei.height,ei.textOffset,ei.textScale),X&&Nt._rotate(oe?this.transform.angle:-this.transform.angle)):mi=!1}A&&(mi=!tt.clipped),Zt.textBox&&ul(o.textCollisionBox.collisionVertexArray,tt.text.placed,!mi||yi,Nt.x,Nt.y),Zt.verticalTextBox&&ul(o.textCollisionBox.collisionVertexArray,tt.text.placed,!mi||At,Nt.x,Nt.y)}const Ct=mi&&!!(!At&&Zt.verticalIconBox);Zt.iconBox&&ul(o.iconCollisionBox.collisionVertexArray,tt.icon.placed,Ct,ve?Nt.x:0,ve?Nt.y:0),Zt.verticalIconBox&&ul(o.iconCollisionBox.collisionVertexArray,tt.icon.placed,!Ct,ve?Nt.x:0,ve?Nt.y:0)}}}if(o.fullyClipped=Ce===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const ze=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=ze.invProjMatrix,o.placementViewportMatrix=ze.viewportMatrix,o.collisionCircleArray=ze.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const x=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*x>o}setStale(){this.stale=!0}}function ul(_,o,d,x,E){_.emplaceBack(o?1:0,d?1:0,x||0,E||0),_.emplaceBack(o?1:0,d?1:0,x||0,E||0),_.emplaceBack(o?1:0,d?1:0,x||0,E||0),_.emplaceBack(o?1:0,d?1:0,x||0,E||0)}const ko=Math.pow(2,25),Kn=Math.pow(2,24),Sh=Math.pow(2,17),Mh=Math.pow(2,16),Ho=Math.pow(2,9),ws=Math.pow(2,8),Ou=Math.pow(2,1);function Wl(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const o=_.placed?1:0,d=Math.floor(127*_.opacity);return d*ko+o*Kn+d*Sh+o*Mh+d*Ho+o*ws+d*Ou+o}const _r=0;class Ec{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,d,x,E,A){const B=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(B,E,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,B.sort((O,G)=>O.sortKey-G.sortKey));this._currentPartIndex<B.length;){const O=B[this._currentPartIndex];if(d.placeLayerBucketPart(O,this._seenCrossTileIDs,x,O.symbolInstanceStart===0),this._currentPartIndex++,A())return!0}return!1}}class Ch{constructor(o,d,x,E,A,B,O,G){this.placement=new iu(o,A,B,O,G),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(o,d,x){const E=t.exported.now(),A=()=>{const B=t.exported.now()-E;return!this._forceFullPlacement&&B>2};for(;this._currentPlacementIndex>=0;){const B=d[o[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=O)&&(!B.maxzoom||B.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new Ec(B)),this._inProgressLayer.continuePlacement(x[B.source],this.placement,this._showCollisionBoxes,B,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const sa=512/t.EXTENT/2;class ao{constructor(o,d,x){this.tileID=o,this.bucketInstanceId=x,this.index=new t.KDBush(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const E=o.canonical.x*t.EXTENT,A=o.canonical.y*t.EXTENT;for(let B=0;B<d.length;B++){const{key:O,crossTileID:G,tileAnchorX:H,tileAnchorY:X}=d.get(B),oe=Math.floor((E+H)*sa),ve=Math.floor((A+X)*sa);this.index.add(oe,ve),this.keys.push(O),this.crossTileIDs.push(G)}this.index.finish()}findMatches(o,d,x){const E=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),A=sa/Math.pow(2,d.canonical.z-this.tileID.canonical.z),B=d.canonical.x*t.EXTENT,O=d.canonical.y*t.EXTENT;for(let G=0;G<o.length;G++){const H=o.get(G);if(H.crossTileID)continue;const{key:X,tileAnchorX:oe,tileAnchorY:ve}=H,Ee=Math.floor((B+oe)*A),Ie=Math.floor((O+ve)*A),Ce=this.index.range(Ee-E,Ie-E,Ee+E,Ie+E);for(const ze of Ce){const ae=this.crossTileIDs[ze];if(this.keys[ze]===X&&!x.has(ae)){x.add(ae),H.crossTileID=ae;break}}}}}class Uu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class as{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const x in this.indexes){const E=this.indexes[x],A={};for(const B in E){const O=E[B];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+d),A[O.tileID.key]=O}this.indexes[x]=A}this.lng=o}addBucket(o,d,x){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let A=0;A<d.symbolInstances.length;A++)d.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const E=this.usedCrossTileIDs[o.overscaledZ];for(const A in this.indexes){const B=this.indexes[A];if(Number(A)>o.overscaledZ)for(const O in B){const G=B[O];G.tileID.isChildOf(o)&&G.findMatches(d.symbolInstances,o,E)}else{const O=B[o.scaledTo(Number(A)).key];O&&O.findMatches(d.symbolInstances,o,E)}}for(let A=0;A<d.symbolInstances.length;A++){const B=d.symbolInstances.get(A);B.crossTileID||(B.crossTileID=x.generate(),E.add(B.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new ao(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const x of d.crossTileIDs)this.usedCrossTileIDs[o].delete(x)}removeStaleBuckets(o){let d=!1;for(const x in this.indexes){const E=this.indexes[x];for(const A in E)o[E[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,E[A]),delete E[A],d=!0)}return d}}class aa{constructor(){this.layerIndexes={},this.crossTileIDs=new Uu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,x,E){let A=this.layerIndexes[o.id];A===void 0&&(A=this.layerIndexes[o.id]=new as);let B=!1;const O={};E.name!=="globe"&&A.handleWrapJump(x);for(const G of d){const H=G.getBucket(o);H&&o.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(G.tileID,H,this.crossTileIDs)&&(B=!0),O[H.bucketInstanceId]=!0)}return A.removeStaleBuckets(O)&&(B=!0),B}pruneUnusedLayers(o){const d={};o.forEach(x=>{d[x]=!0});for(const x in this.layerIndexes)d[x]||delete this.layerIndexes[x]}}const la=(_,o)=>t.emitValidationErrors(_,o&&o.filter(d=>d.identifier!=="source.canvas")),Xl=t.pick(ft,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Ih=t.pick(ft,["setCenter","setZoom","setBearing","setPitch"]),ru={version:8,layers:[],sources:{}},Va={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ws extends t.Evented{constructor(o,d={}){super(),this.map=o,this.dispatcher=new Si(ut(),this),this.imageManager=new yr,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(o._requestManager,d.localFontFamily?t.LocalGlyphMode.all:d.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,d.localFontFamily||d.localIdeographFontFamily),this.crossTileSymbolIndex=new aa,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const x=this;this._rtlTextPluginCallback=Ws.registerForPluginStateChange(E=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},(A,B)=>{if(t.triggerPluginCompletionEvent(A),B&&B.every(O=>O))for(const O in x._sourceCaches){const G=x._sourceCaches[O],H=G.getSource().type;H!=="vector"&&H!=="geojson"||G.reload()}})}),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const A=this.getSource(E.sourceId);if(A&&A.vectorLayerIds)for(const B in this._layers){const O=this._layers[B];O.source===A.id&&this._validateLayer(O)}})}loadURL(o,d={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const x=typeof d.validate=="boolean"?d.validate:!t.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,d.accessToken);const E=this.map._requestManager.transformRequest(o,t.ResourceType.Style);this._request=t.getJSON(E,(A,B)=>{this._request=null,A?this.fire(new t.ErrorEvent(A)):B&&this._load(B,x)})}loadJSON(o,d={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame(()=>{this._request=null,this._load(o,d.validate!==!1)})}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(ru,!1)}_updateLayerCount(o,d){const x=d?1:-1;o.is3D()&&(this._num3DLayers+=x),o.type==="circle"&&(this._numCircleLayers+=x),o.type==="symbol"&&(this._numSymbolLayers+=x)}_load(o,d){if(d&&la(this,t.validateStyle(o)))return;this._loaded=!0,this.stylesheet=t.clone$1(o),this._updateMapProjection();for(const E in o.sources)this.addSource(E,o.sources[E],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const x=Ht(this.stylesheet.layers);this._order=x.map(E=>E.id),this._layers={},this._serializedLayers={};for(const E of x){const A=t.createStyleLayer(E);A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new fr(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=function(d,x,E){let A,B,O;const G=t.exported.devicePixelRatio>1?"@2x":"";let H=t.getJSON(x.transformRequest(x.normalizeSpriteURL(d,G,".json"),t.ResourceType.SpriteJSON),(ve,Ee)=>{H=null,O||(O=ve,A=Ee,oe())}),X=t.getImage(x.transformRequest(x.normalizeSpriteURL(d,G,".png"),t.ResourceType.SpriteImage),(ve,Ee)=>{X=null,O||(O=ve,B=Ee,oe())});function oe(){if(O)E(O);else if(A&&B){const ve=t.exported.getImageData(B),Ee={};for(const Ie in A){const{width:Ce,height:ze,x:ae,y:Me,sdf:Ue,pixelRatio:Ge,stretchX:rt,stretchY:nt,content:tt}=A[Ie],gt=new t.RGBAImage({width:Ce,height:ze});t.RGBAImage.copy(ve,gt,{x:ae,y:Me},{x:0,y:0},{width:Ce,height:ze}),Ee[Ie]={data:gt,pixelRatio:Ge,sdf:Ue,stretchX:rt,stretchY:nt,content:tt}}E(null,Ee)}}return{cancel(){H&&(H.cancel(),H=null),X&&(X.cancel(),X=null)}}}(o,this.map._requestManager,(d,x)=>{if(this._spriteRequest=null,d)this.fire(new t.ErrorEvent(d));else if(x)for(const E in x)this.imageManager.addImage(E,x[E]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}))})}_validateLayer(o){const d=this.getSource(o.source);if(!d)return;const x=o.sourceLayer;x&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(x)===-1)&&this.fire(new t.ErrorEvent(new Error(`Source layer "${x}" does not exist on source "${d.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const d=[];for(const x of o){const E=this._layers[x];E.type!=="custom"&&d.push(E.serialize())}return d}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&(typeof o.isLayerDraped=="function"?o.isLayerDraped():Va[o.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const d=this._changed;if(this._changed){const E=Object.keys(this._updatedLayers),A=Object.keys(this._removedLayers);(E.length||A.length)&&this._updateWorkerLayers(E,A);for(const B in this._updatedSources){const O=this._updatedSources[B];O==="reload"?this._reloadSource(B):O==="clear"&&this._clearSource(B)}this._updateTilesForChangedImages();for(const B in this._updatedPaintProps)this._layers[B].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const x={};for(const E in this._sourceCaches){const A=this._sourceCaches[E];x[E]=A.used,A.used=!1}for(const E of this._order){const A=this._layers[E];if(A.recalculate(o,this._availableImages),!A.isHidden(o.zoom)){const O=this._getLayerSourceCache(A);O&&(O.used=!0)}const B=this.map.painter;if(B){const O=A.getProgramIds();if(!O)continue;const G=A.getProgramConfiguration(o.zoom);for(const H of O)B.useProgram(H,G)}}for(const E in x){const A=this._sourceCaches[E];x[E]!==A.used&&A.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:A.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),d&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),la(this,t.validateStyle(o)))return!1;(o=t.clone$1(o)).layers=Ht(o.layers);const d=function(E,A){if(!E)return[{command:ft.setStyle,args:[A]}];let B=[];try{if(!j(E.version,A.version))return[{command:ft.setStyle,args:[A]}];j(E.center,A.center)||B.push({command:ft.setCenter,args:[A.center]}),j(E.zoom,A.zoom)||B.push({command:ft.setZoom,args:[A.zoom]}),j(E.bearing,A.bearing)||B.push({command:ft.setBearing,args:[A.bearing]}),j(E.pitch,A.pitch)||B.push({command:ft.setPitch,args:[A.pitch]}),j(E.sprite,A.sprite)||B.push({command:ft.setSprite,args:[A.sprite]}),j(E.glyphs,A.glyphs)||B.push({command:ft.setGlyphs,args:[A.glyphs]}),j(E.transition,A.transition)||B.push({command:ft.setTransition,args:[A.transition]}),j(E.light,A.light)||B.push({command:ft.setLight,args:[A.light]}),j(E.fog,A.fog)||B.push({command:ft.setFog,args:[A.fog]}),j(E.projection,A.projection)||B.push({command:ft.setProjection,args:[A.projection]});const O={},G=[];(function(oe,ve,Ee,Ie){let Ce;for(Ce in ve=ve||{},oe=oe||{})oe.hasOwnProperty(Ce)&&(ve.hasOwnProperty(Ce)||Zi(Ce,Ee,Ie));for(Ce in ve){if(!ve.hasOwnProperty(Ce))continue;const ze=ve[Ce];oe.hasOwnProperty(Ce)?j(oe[Ce],ze)||(oe[Ce].type==="geojson"&&ze.type==="geojson"&&Yi(oe,ve,Ce)?Ee.push({command:ft.setGeoJSONSourceData,args:[Ce,ze.data]}):Ai(Ce,ve,Ee,Ie)):ji(Ce,ve,Ee)}})(E.sources,A.sources,G,O);const H=[];E.layers&&E.layers.forEach(oe=>{oe.source&&O[oe.source]?B.push({command:ft.removeLayer,args:[oe.id]}):H.push(oe)});let X=E.terrain;X&&O[X.source]&&(B.push({command:ft.setTerrain,args:[void 0]}),X=void 0),B=B.concat(G),j(X,A.terrain)||B.push({command:ft.setTerrain,args:[A.terrain]}),function(oe,ve,Ee){ve=ve||[];const Ie=(oe=oe||[]).map(br),Ce=ve.map(br),ze=oe.reduce(hr,{}),ae=ve.reduce(hr,{}),Me=Ie.slice(),Ue=Object.create(null);let Ge,rt,nt,tt,gt,yt,kt;for(Ge=0,rt=0;Ge<Ie.length;Ge++)nt=Ie[Ge],ae.hasOwnProperty(nt)?rt++:(Ee.push({command:ft.removeLayer,args:[nt]}),Me.splice(Me.indexOf(nt,rt),1));for(Ge=0,rt=0;Ge<Ce.length;Ge++)nt=Ce[Ce.length-1-Ge],Me[Me.length-1-Ge]!==nt&&(ze.hasOwnProperty(nt)?(Ee.push({command:ft.removeLayer,args:[nt]}),Me.splice(Me.lastIndexOf(nt,Me.length-rt),1)):rt++,yt=Me[Me.length-Ge],Ee.push({command:ft.addLayer,args:[ae[nt],yt]}),Me.splice(Me.length-Ge,0,nt),Ue[nt]=!0);for(Ge=0;Ge<Ce.length;Ge++)if(nt=Ce[Ge],tt=ze[nt],gt=ae[nt],!Ue[nt]&&!j(tt,gt))if(j(tt.source,gt.source)&&j(tt["source-layer"],gt["source-layer"])&&j(tt.type,gt.type)){for(kt in rr(tt.layout,gt.layout,Ee,nt,null,ft.setLayoutProperty),rr(tt.paint,gt.paint,Ee,nt,null,ft.setPaintProperty),j(tt.filter,gt.filter)||Ee.push({command:ft.setFilter,args:[nt,gt.filter]}),j(tt.minzoom,gt.minzoom)&&j(tt.maxzoom,gt.maxzoom)||Ee.push({command:ft.setLayerZoomRange,args:[nt,gt.minzoom,gt.maxzoom]}),tt)tt.hasOwnProperty(kt)&&kt!=="layout"&&kt!=="paint"&&kt!=="filter"&&kt!=="metadata"&&kt!=="minzoom"&&kt!=="maxzoom"&&(kt.indexOf("paint.")===0?rr(tt[kt],gt[kt],Ee,nt,kt.slice(6),ft.setPaintProperty):j(tt[kt],gt[kt])||Ee.push({command:ft.setLayerProperty,args:[nt,kt,gt[kt]]}));for(kt in gt)gt.hasOwnProperty(kt)&&!tt.hasOwnProperty(kt)&&kt!=="layout"&&kt!=="paint"&&kt!=="filter"&&kt!=="metadata"&&kt!=="minzoom"&&kt!=="maxzoom"&&(kt.indexOf("paint.")===0?rr(tt[kt],gt[kt],Ee,nt,kt.slice(6),ft.setPaintProperty):j(tt[kt],gt[kt])||Ee.push({command:ft.setLayerProperty,args:[nt,kt,gt[kt]]}))}else Ee.push({command:ft.removeLayer,args:[nt]}),yt=Me[Me.lastIndexOf(nt)+1],Ee.push({command:ft.addLayer,args:[gt,yt]})}(H,A.layers,B)}catch(O){console.warn("Unable to compute style diff:",O),B=[{command:ft.setStyle,args:[A]}]}return B}(this.serialize(),o).filter(E=>!(E.command in Ih));if(d.length===0)return!1;const x=d.filter(E=>!(E.command in Xl));if(x.length>0)throw new Error(`Unimplemented: ${x.map(E=>E.command).join(", ")}.`);return d.forEach(E=>{E.command!=="setTransition"&&E.command!=="setProjection"&&this[E.command].apply(this,E.args)}),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,d){return this.getImage(o)?this.fire(new t.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,d),this._afterImageUpdated(o),this)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new t.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,d,x={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(t.validateSource,`sources.${o}`,d,null,x))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const E=pe(o,d,this.dispatcher,this);E.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:E.serialize(),sourceId:o}));const A=B=>{const O=(B?"symbol:":"other:")+o,G=this._sourceCaches[O]=new t.SourceCache(O,E,B);(B?this._symbolSourceCaches:this._otherSourceCaches)[o]=G,G.style=this,G.onAdd(this.map)};A(!1),d.type!=="vector"&&d.type!=="geojson"||A(!0),E.onAdd&&E.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const d=this.getSource(o);if(!d)throw new Error("There is no source with this ID");for(const E in this._layers)if(this._layers[E].source===o)return this.fire(new t.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${E}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new t.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const x=this._getSourceCaches(o);for(const E of x)delete this._sourceCaches[E.id],delete this._updatedSources[E.id],E.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:E.getSource().id})),E.setEventedParent(null),E.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,d){this._checkLoaded(),this.getSource(o).setData(d),this._changed=!0}getSource(o){const d=this._getSourceCache(o);return d&&d.getSource()}_getSources(){const o=[];for(const d in this._otherSourceCaches){const x=this._getSourceCache(d);x&&o.push(x.getSource())}return o}addLayer(o,d,x={}){this._checkLoaded();const E=o.id;if(this.getLayer(E))return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${E}" already exists on this map`)));let A;if(o.type==="custom"){if(la(this,t.validateCustomStyleLayer(o)))return;A=t.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(E,o.source),o=t.clone$1(o),o=t.extend(o,{source:E})),this._validate(t.validateLayer,`layers.${E}`,o,{arrayIndex:-1},x))return;A=t.createStyleLayer(o),this._validateLayer(A),A.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0)}const B=d?this._order.indexOf(d):this._order.length;if(d&&B===-1)return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`)));this._order.splice(B,0,E),this._layerOrderChanged=!0,this._layers[E]=A;const O=this._getLayerSourceCache(A);if(this._removedLayers[E]&&A.source&&O&&A.type!=="custom"){const G=this._removedLayers[E];delete this._removedLayers[E],G.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",O.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new t.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const x=this._order.indexOf(o);this._order.splice(x,1);const E=d?this._order.indexOf(d):this._order.length;d&&E===-1?this.fire(new t.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`))):(this._order.splice(E,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new t.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));d.setEventedParent(null),this._updateLayerCount(d,!1);const x=this._order.indexOf(o);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const d in this._layers)if(this._layers[d].type===o)return!0;return!1}setLayerZoomRange(o,d,x){this._checkLoaded();const E=this.getLayer(o);E?E.minzoom===d&&E.maxzoom===x||(d!=null&&(E.minzoom=d),x!=null&&(E.maxzoom=x),this._updateLayer(E)):this.fire(new t.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,d,x={}){this._checkLoaded();const E=this.getLayer(o);if(E){if(!j(E.filter,d))return d==null?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(t.validateFilter,`layers.${E.id}.filter`,d,{layerType:E.type},x)||(E.filter=t.clone$1(d),this._updateLayer(E)))}else this.fire(new t.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const d=this.getLayer(o);return d&&t.clone$1(d.filter)}setLayoutProperty(o,d,x,E={}){this._checkLoaded();const A=this.getLayer(o);A?j(A.getLayoutProperty(d),x)||(A.setLayoutProperty(d,x,E),this._updateLayer(A)):this.fire(new t.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,d){const x=this.getLayer(o);if(x)return x.getLayoutProperty(d);this.fire(new t.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,d,x,E={}){this._checkLoaded();const A=this.getLayer(o);A?j(A.getPaintProperty(d),x)||(A.setPaintProperty(d,x,E)&&this._updateLayer(A),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new t.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,d){const x=this.getLayer(o);return x&&x.getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const x=o.source,E=o.sourceLayer,A=this.getSource(x);if(!A)return void this.fire(new t.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const B=A.type;if(B==="geojson"&&E)return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(B==="vector"&&!E)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(x);for(const G of O)G.setFeatureState(E,o.id,d)}removeFeatureState(o,d){this._checkLoaded();const x=o.source,E=this.getSource(x);if(!E)return void this.fire(new t.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const A=E.type,B=A==="vector"?o.sourceLayer:void 0;if(A==="vector"&&!B)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(x);for(const G of O)G.removeFeatureState(B,o.id,d)}getFeatureState(o){this._checkLoaded();const d=o.source,x=o.sourceLayer,E=this.getSource(d);if(E){if(E.type!=="vector"||x)return o.id===void 0&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(d)[0].getFeatureState(x,o.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const d in this._sourceCaches){const x=this._sourceCaches[d].getSource();o[x.id]||(o[x.id]=x.serialize())}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},d=>d!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0;const d=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&d&&d.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",d.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const d=B=>this._layers[B].type==="fill-extrusion",x={},E=[];for(let B=this._order.length-1;B>=0;B--){const O=this._order[B];if(d(O)){x[O]=B;for(const G of o){const H=G[O];if(H)for(const X of H)E.push(X)}}}E.sort((B,O)=>O.intersectionZ-B.intersectionZ);const A=[];for(let B=this._order.length-1;B>=0;B--){const O=this._order[B];if(d(O))for(let G=E.length-1;G>=0;G--){const H=E[G].feature;if(x[H.layer.id]<B)break;A.push(H),E.pop()}else for(const G of o){const H=G[O];if(H)for(const X of H)A.push(X.feature)}}return A}queryRenderedFeatures(o,d,x){d&&d.filter&&this._validate(t.validateFilter,"queryRenderedFeatures.filter",d.filter,null,d);const E={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const G of d.layers){const H=this._layers[G];if(!H)return this.fire(new t.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];E[H.source]=!0}}const A=[];d.availableImages=this._availableImages;const B=d&&d.layers?d.layers.some(G=>{const H=this.getLayer(G);return H&&H.is3D()}):this.has3DLayers(),O=lr.createFromScreenPoints(o,x);for(const G in this._sourceCaches){const H=this._sourceCaches[G].getSource().id;d.layers&&!E[H]||A.push(re(this._sourceCaches[G],this._layers,this._serializedLayers,O,d,x,B,!!this.map._showQueryGeometry))}return this.placement&&A.push(function(G,H,X,oe,ve,Ee,Ie){const Ce={},ze=Ee.queryRenderedSymbols(oe),ae=[];for(const Me of Object.keys(ze).map(Number))ae.push(Ie[Me]);ae.sort(ge);for(const Me of ae){const Ue=Me.featureIndex.lookupSymbolFeatures(ze[Me.bucketInstanceId],H,Me.bucketIndex,Me.sourceLayerIndex,ve.filter,ve.layers,ve.availableImages,G);for(const Ge in Ue){const rt=Ce[Ge]=Ce[Ge]||[],nt=Ue[Ge];nt.sort((tt,gt)=>{const yt=Me.featureSortOrder;if(yt){const kt=yt.indexOf(tt.featureIndex);return yt.indexOf(gt.featureIndex)-kt}return gt.featureIndex-tt.featureIndex});for(const tt of nt)rt.push(tt)}}for(const Me in Ce)Ce[Me].forEach(Ue=>{const Ge=Ue.feature,rt=X(G[Me]);if(!rt)return;const nt=rt.getFeatureState(Ge.layer["source-layer"],Ge.id);Ge.source=Ge.layer.source,Ge.layer["source-layer"]&&(Ge.sourceLayer=Ge.layer["source-layer"]),Ge.state=nt});return Ce}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(A)}querySourceFeatures(o,d){d&&d.filter&&this._validate(t.validateFilter,"querySourceFeatures.filter",d.filter,null,d);const x=this._getSourceCaches(o);let E=[];for(const A of x)E=E.concat(fe(A,d));return E}addSourceType(o,d,x){return Ws.getSourceType(o)?x(new Error(`A source type called "${o}" already exists.`)):(Ws.setSourceType(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},x):x(null,null))}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const x=this.light.getLight();let E=!1;for(const B in o)if(!j(o[B],x[B])){E=!0;break}if(!E)return;const A=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,d),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,d=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let x=o;if(d===1){if(typeof x.source=="object"){const E="terrain-dem-src";this.addSource(E,x.source),x=t.clone$1(x),x=t.extend(x,{source:E})}if(this._validate(t.validateTerrain,"terrain",x))return}if(!this.terrain||this.terrain&&d!==this.terrain.drapeRenderMode){if(!x)return;this._createTerrain(x,d)}else{const E=this.terrain,A=E.get();for(const B of Object.keys(t.spec.terrain))!x.hasOwnProperty(B)&&t.spec.terrain[B].default&&(x[B]=t.spec.terrain[B].default);for(const B in x)if(!j(x[B],A[B])){E.set(x),this.stylesheet.terrain=x;const O=this._setTransitionParameters({duration:0});E.updateTransitions(O);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const d=this.fog=new hi(o,this.map.transform);this.stylesheet.fog=o;const x=this._setTransitionParameters({duration:0});d.updateTransitions(x)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog,x=d.get();Object.keys(o).length===0&&d.set(o);for(const E in o)if(!j(o[E],x[E])){d.set(o),this.stylesheet.fog=o;const A=this._setTransitionParameters({duration:0});d.updateTransitions(A);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:t.exported.now(),transition:t.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(x=>this.isLayerDraped(this._layers[x])),d=this._order.filter(x=>!this.isLayerDraped(this._layers[x]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...d)}_createTerrain(o,d){const x=this.terrain=new $t(o,d);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const E=this._setTransitionParameters({duration:0});x.updateTransitions(E)}_force3DLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="symbol"&&this._updateLayer(d)}}_validate(o,d,x,E,A={}){return(!A||A.validate!==!1)&&la(this,o.call(t.validateStyle,t.extend({key:d,style:this.serialize(),value:x,styleSpec:t.spec},E)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const d=this._getSourceCaches(o);for(const x of d)x.clearTiles()}_reloadSource(o){const d=this._getSourceCaches(o);for(const x of d)x.resume(),x.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const d in this._sourceCaches)this._sourceCaches[d].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const d=this._sourceCaches[o];d.resume(),d.reload()}}_updatePlacement(o,d,x,E,A=!1){let B=!1,O=!1;const G={};for(const H of this._order){const X=this._layers[H];if(X.type!=="symbol")continue;if(!G[X.source]){const ve=this._getLayerSourceCache(X);if(!ve)continue;G[X.source]=ve.getRenderableIds(!0).map(Ee=>ve.getTileByID(Ee)).sort((Ee,Ie)=>Ie.tileID.overscaledZ-Ee.tileID.overscaledZ||(Ee.tileID.isLessThan(Ie.tileID)?-1:1))}const oe=this.crossTileSymbolIndex.addLayer(X,G[X.source],o.center.lng,o.projection);B=B||oe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),A=A||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(A||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),o.zoom))&&(this.pauseablePlacement=new Ch(o,this._order,A,d,x,E,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,G),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),O=!0),B&&this.pauseablePlacement.placement.setStale()),O||B)for(const H of this._order){const X=this._layers[H];X.type==="symbol"&&this.placement.updateLayerOpacities(X,G[X.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,d,x){this.imageManager.getImages(d.icons,x),this._updateTilesForChangedImages();const E=A=>{A&&A.setDependencies(d.tileID.key,d.type,d.icons)};E(this._otherSourceCaches[d.source]),E(this._symbolSourceCaches[d.source])}getGlyphs(o,d,x){this.glyphManager.getGlyphs(d.stacks,x)}getResource(o,d,x){return t.makeRequest(d,x)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const d=[];return this._otherSourceCaches[o]&&d.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&d.push(this._symbolSourceCaches[o]),d}_isSourceCacheLoaded(o){const d=this._getSourceCaches(o);return d.length===0?(this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):d.every(x=>x.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ws.getSourceType=function(_){return jt[_]},Ws.setSourceType=function(_,o){jt[_]=o},Ws.registerForPluginStateChange=t.registerForPluginStateChange;var nu=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,ya="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",xa=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Sc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ts=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Nu={},Mc={};const ou=[];ja(nu,ou),ja(xa,ou),ja(Sc,ou),ja(Ts,ou),Nu=Qr("",xa),Mc=Qr(Ts,Sc);const p1=Qr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Vu=nu,Ah=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var su={background:Qr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Qr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Qr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Qr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Qr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Qr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Qr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Qr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Qr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Qr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Qr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Qr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Qr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Qr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Qr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Qr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Qr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Qr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Qr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Qr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Qr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Qr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Qr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Qr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Qr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Qr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ya),skyboxGradient:Qr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ya),skyboxCapture:Qr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Qr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Qr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function ja(_,o){const d=_.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let x of d)if(x=x.trim(),x[0]==="#"&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const E=x.split(" ");for(const A of E)o.includes(A)||o.push(A)}}function Qr(_,o){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),E={},A=[...ou];return ja(_,A),ja(o,A),{fragmentSource:_=_.replace(d,(B,O,G,H,X)=>(E[X]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${G} ${H} ${X};
#else
uniform ${G} ${H} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${G} ${H} ${X} = u_${X};
#endif
`)),vertexSource:o=o.replace(d,(B,O,G,H,X)=>{const oe=H==="float"?"vec2":"vec4",ve=X.match(/color/)?"color":oe;return E[X]?O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${G} ${oe} a_${X};
varying ${G} ${H} ${X};
#else
uniform ${G} ${H} u_${X};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${G} ${H} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${ve}(a_${X}, u_${X}_t);
#else
    ${G} ${H} ${X} = u_${X};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${G} ${oe} a_${X};
#else
uniform ${G} ${H} u_${X};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${G} ${H} ${X} = a_${X};
#else
    ${G} ${H} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${G} ${H} ${X} = unpack_mix_${ve}(a_${X}, u_${X}_t);
#else
    ${G} ${H} ${X} = u_${X};
#endif
`}),staticAttributes:x,usedDefines:A}}class Ph{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,d,x,E,A,B,O){this.context=o;let G=this.boundPaintVertexBuffers.length!==E.length;for(let X=0;!G&&X<E.length;X++)this.boundPaintVertexBuffers[X]!==E[X]&&(G=!0);let H=this.boundDynamicVertexBuffers.length!==O.length;for(let X=0;!H&&X<O.length;X++)this.boundDynamicVertexBuffers[X]!==O[X]&&(H=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==x||G||H||this.boundIndexBuffer!==A||this.boundVertexOffset!==B)this.freshBind(d,x,E,A,B,O);else{o.bindVertexArrayOES.set(this.vao);for(const X of O)X&&X.bind();A&&A.dynamicDraw&&A.bind()}}freshBind(o,d,x,E,A,B){let O;const G=o.numAttributes,H=this.context,X=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=E,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=B;else{O=H.currentNumAttributes||0;for(let oe=G;oe<O;oe++)X.disableVertexAttribArray(oe)}d.enableAttributes(X,o),d.bind(),d.setVertexAttribPointers(X,o,A);for(const oe of x)oe.enableAttributes(X,o),oe.bind(),oe.setVertexAttribPointers(X,o,A);for(const oe of B)oe&&(oe.enableAttributes(X,o),oe.bind(),oe.setVertexAttribPointers(X,o,A));E&&E.bind(),H.currentNumAttributes=G}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function hl(_,o){const d=Math.pow(2,o.canonical.z),x=o.canonical.y;return[new t.MercatorCoordinate(0,x/d).toLngLat().lat,new t.MercatorCoordinate(0,(x+1)/d).toLngLat().lat]}function kh(_,o,d,x,E,A,B){const O=_.context,G=O.gl,H=d.fbo;if(!H)return;_.prepareDrawTile();const X=_.useProgram("hillshade");O.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,H.colorAttachment.get());const oe=((Ce,ze,ae,Me)=>{const Ue=ae.paint.get("hillshade-shadow-color"),Ge=ae.paint.get("hillshade-highlight-color"),rt=ae.paint.get("hillshade-accent-color");let nt=ae.paint.get("hillshade-illumination-direction")*(Math.PI/180);ae.paint.get("hillshade-illumination-anchor")==="viewport"&&(nt-=Ce.transform.angle);const tt=!Ce.options.moving;return{u_matrix:Me||Ce.transform.calculateProjMatrix(ze.tileID.toUnwrapped(),tt),u_image:0,u_latrange:hl(0,ze.tileID),u_light:[ae.paint.get("hillshade-exaggeration"),nt],u_shadow:Ue,u_highlight:Ge,u_accent:rt}})(_,d,x,_.terrain?o.projMatrix:null);_.prepareDrawProgram(O,X,o.toUnwrapped());const{tileBoundsBuffer:ve,tileBoundsIndexBuffer:Ee,tileBoundsSegments:Ie}=_.getTileBoundsBuffers(d);X.draw(O,G.TRIANGLES,E,A,B,t.CullFaceMode.disabled,oe,x.id,ve,Ee,Ie)}function ju(_,o,d){if(!o.needsDEMTextureUpload)return;const x=_.context,E=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||_.getTileTexture(d.stride);const A=d.getPixels();o.demTexture?o.demTexture.update(A,{premultiply:!1}):o.demTexture=new t.Texture(x,A,E.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function au(_,o,d,x,E,A){const B=_.context,O=B.gl;if(!o.dem)return;const G=o.dem;if(B.activeTexture.set(O.TEXTURE1),ju(_,o,G),!o.demTexture)return;o.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const H=G.dim;B.activeTexture.set(O.TEXTURE0);let X=o.fbo;if(!X){const Ie=new t.Texture(B,{width:H,height:H,data:null},O.RGBA);Ie.bind(O.LINEAR,O.CLAMP_TO_EDGE),X=o.fbo=B.createFramebuffer(H,H,!0),X.colorAttachment.set(Ie.texture)}B.bindFramebuffer.set(X.framebuffer),B.viewport.set([0,0,H,H]);const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:ve,tileBoundsSegments:Ee}=_.getMercatorTileBoundsBuffers();_.useProgram("hillshadePrepare").draw(B,O.TRIANGLES,x,E,A,t.CullFaceMode.disabled,((Ie,Ce)=>{const ze=Ce.stride,ae=t.create();return t.ortho(ae,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(ae,ae,[0,-t.EXTENT,0]),{u_matrix:ae,u_image:1,u_dimension:[ze,ze],u_zoom:Ie.overscaledZ,u_unpack:Ce.unpackVector}})(o.tileID,G),d.id,oe,ve,Ee),o.needsHillshadePrepare=!1}const Ga=_=>({u_matrix:new t.UniformMatrix4f(_),u_image0:new t.Uniform1i(_),u_skirt_height:new t.Uniform1f(_)}),Hl=(_,o)=>({u_matrix:_,u_image0:0,u_skirt_height:o}),$a=(_,o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:d,u_zoom_transition:E,u_merc_center:A,u_image0:0,u_frustum_tl:B,u_frustum_tr:O,u_frustum_br:G,u_frustum_bl:H,u_globe_pos:X,u_globe_radius:oe,u_viewport:ve,u_grid_matrix:Ie?Float32Array.from(Ie):new Float32Array(9),u_skirt_height:Ee});function _n(_,o){return _!=null&&o!=null&&!(!_.hasData()||!o.hasData())&&_.demTexture!=null&&o.demTexture!=null&&_.tileID.key!==o.tileID.key}const va=new class{constructor(){this.operations={}}newMorphing(_,o,d,x,E){if(_ in this.operations){const A=this.operations[_];A.to.tileID.key!==d.tileID.key&&(A.queued=d)}else this.operations[_]={startTime:x,phase:0,duration:E,from:o,to:d,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const o=this.operations[_];return{from:o.from,to:o.to,phase:o.phase}}update(_){for(const o in this.operations){const d=this.operations[o];for(d.phase=(_-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,_)){delete this.operations[o];break}}}_nextOp(_,o){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=o,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},kr={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function en(_){return 6*Math.pow(1.5,22-_)}function Pn(_,o){const d=1<<_.z;return!o&&(_.x===0||_.x===d-1)||_.y===0||_.y===d-1}const Mn=_=>({u_matrix:_});function Kl(_,o,d,x,E){if(E>0){const A=t.exported.now(),B=(A-_.timeAdded)/E,O=o?(A-o.timeAdded)/E:-1,G=d.getSource(),H=x.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),X=!o||Math.abs(o.tileID.overscaledZ-H)>Math.abs(_.tileID.overscaledZ-H),oe=X&&_.refreshedUponExpiration?1:t.clamp(X?B:1-O,0,1);return _.refreshedUponExpiration&&B>=1&&(_.refreshedUponExpiration=!1),o?{opacity:1,mix:1-oe}:{opacity:oe,mix:0}}return{opacity:1,mix:0}}class dl extends t.SourceCache{constructor(o){const d={type:"raster-dem",maxzoom:o.transform.maxZoom},x=new Si(ut(),null),E=pe("mock-dem",d,x,o.style);super("mock-dem",E,!1),E.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,d){o.state="loaded",d(null)}}class Gu extends t.SourceCache{constructor(o){const d=pe("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new Si(ut(),null),o.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,d,x){if(o.freezeTileCoverage)return;this.transform=o;const E=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((A,B)=>{if(A[B.key]="",!this._tiles[B.key]){const O=new t.Tile(B,this._source.tileSize*B.overscaleFactor(),o.tileZoom);O.state="loaded",this._tiles[B.key]=O}return A},{});for(const A in this._tiles)A in E||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(o){const d=this.proxyCachedFBO[o];if(d!==void 0){const x=Object.values(d);this.renderCachePool.push(...x),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class $u extends t.OverscaledTileID{constructor(o,d,x){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=d,this.projMatrix=x}}class Zu extends t.Elevation{constructor(o,d){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,E,A]=function(G){const H=new t.StructArrayLayout2i4,X=new t.StructArrayLayout3ui6,oe=131;H.reserve(17161),X.reserve(33800);const ve=t.EXTENT/128,Ee=t.EXTENT+ve/2,Ie=Ee+ve;for(let ze=-ve;ze<Ie;ze+=ve)for(let ae=-ve;ae<Ie;ae+=ve){const Me=ae<0||ae>Ee||ze<0||ze>Ee?24575:0,Ue=t.clamp(Math.round(ae),0,t.EXTENT),Ge=t.clamp(Math.round(ze),0,t.EXTENT);H.emplaceBack(Ue+Me,Ge)}const Ce=(ze,ae)=>{const Me=ae*oe+ze;X.emplaceBack(Me+1,Me,Me+oe),X.emplaceBack(Me+oe,Me+oe+1,Me+1)};for(let ze=1;ze<129;ze++)for(let ae=1;ae<129;ae++)Ce(ae,ze);return[0,129].forEach(ze=>{for(let ae=0;ae<130;ae++)Ce(ae,ze),Ce(ze,ae)}),[H,X,32768]}(),B=o.context;this.gridBuffer=B.createVertexBuffer(x,t.posAttributes.members),this.gridIndexBuffer=B.createIndexBuffer(E),this.gridSegments=t.SegmentVector.simpleSegment(0,0,x.length,E.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,x.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Gu(d.map),this.orthoMatrix=t.create(),t.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,t.EXTENT,0,t.EXTENT,0,1);const O=B.gl;this._overlapStencilMode=new t.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new dl(d.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,d,x){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const E=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(E.get("source")),this._exaggeration=E.get("exaggeration");const A=()=>{this.sourceCache.used&&t.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const B=this.getScaledDemTileSize();this.sourceCache.update(d,B,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,A(),this._initializing=!0),A(),d.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&t.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=x._centerAltitude===0&&this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(x.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const E=this.proxyCoords=d.getIds().map(G=>{const H=d.getTileByID(G).tileID;return H.projMatrix=x.calculateProjMatrix(H.toUnwrapped()),H});(function(G,H){const X=H.transform.pointCoordinate(H.transform.getCameraPoint()),oe=new t.Point(X.x,X.y);G.sort((ve,Ee)=>{if(Ee.overscaledZ-ve.overscaledZ)return Ee.overscaledZ-ve.overscaledZ;const Ie=new t.Point(ve.canonical.x+(1<<ve.canonical.z)*ve.wrap,ve.canonical.y),Ce=new t.Point(Ee.canonical.x+(1<<Ee.canonical.z)*Ee.wrap,Ee.canonical.y),ze=oe.mult(1<<ve.canonical.z);return ze.x-=.5,ze.y-=.5,ze.distSqr(Ie)-ze.distSqr(Ce)})})(E,this.painter),this._previousZoom=x.zoom;const A=this.proxyToSource||{};this.proxyToSource={},E.forEach(G=>{this.proxyToSource[G.key]={}}),this.terrainTileForTile={};const B=this._style._sourceCaches;for(const G in B){const H=B[G];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,o[G],A),H.usedForTerrain))continue;const X=o[G];H.getSource().reparseOverscaled&&this._assignTerrainTiles(X)}this.proxiedCoords[d.id]=E.map(G=>new $u(G,G.key,this.orthoMatrix)),this._assignTerrainTiles(E),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1,this._updateTimestamp=t.exported.now();const O={};this._visibleDemTiles=[];for(const G of this.proxyCoords){const H=this.terrainTileForTile[G.key];if(!H)continue;const X=H.tileID.key;X in O||(this._visibleDemTiles.push(H),O[X]=X)}}_assignTerrainTiles(o){this._initializing||o.forEach(d=>{if(this.terrainTileForTile[d.key])return;const x=this._findTileCoveringTileID(d,this.sourceCache);x&&(this.terrainTileForTile[d.key]=x)})}_prepareDEMTextures(){const o=this.painter.context,d=o.gl;for(const x in this.terrainTileForTile){const E=this.terrainTileForTile[x],A=E.dem;!A||E.demTexture&&!E.needsDEMTextureUpload||(o.activeTexture.set(d.TEXTURE1),ju(this.painter,E,A))}}_prepareDemTileUniforms(o,d,x,E){if(!d||d.demTexture==null)return!1;const A=o.tileID.canonical,B=Math.pow(2,d.tileID.canonical.z-A.z),O=E||"";return x[`u_dem_tl${O}`]=[A.x*B%1,A.y*B%1],x[`u_dem_scale${O}`]=B,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,d=o.gl;if(!this._emptyDepthBufferTexture){const x=new t.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new t.Texture(o,x,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const d=this._visibleDemTiles.reduce((x,E)=>{if(!E.dem)return x;const A=E.dem.tree.minimums[0];return A>0&&o++,x+A},0);return o?d/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,d=o.gl;o.activeTexture.set(d.TEXTURE2);const x=this._getLoadedAreaMinimum(),E=new t.RGBAImage({width:1,height:1},new Uint8Array(t.DEMData.pack(x,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(E,{premultiply:!1}):A=this._emptyDEMTexture=new t.Texture(o,E,d.RGBA,{premultiply:!1}),A}setupElevationDraw(o,d,x){const E=this.painter.context,A=E.gl,B=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;B.u_dem_size=this.sourceCache.getSource().tileSize,B.u_exaggeration=this.exaggeration();let G=null,H=null,X=1;if(x&&x.morphing&&this._useVertexMorphing){const oe=x.morphing.srcDemTile,ve=x.morphing.dstDemTile;X=x.morphing.phase,oe&&ve&&(this._prepareDemTileUniforms(o,oe,B,"_prev")&&(H=oe),this._prepareDemTileUniforms(o,ve,B)&&(G=ve))}if(H&&G?(E.activeTexture.set(A.TEXTURE2),G.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE,A.NEAREST),E.activeTexture.set(A.TEXTURE4),H.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE,A.NEAREST),B.u_dem_lerp=X):(G=this.terrainTileForTile[o.tileID.key],E.activeTexture.set(A.TEXTURE2),(this._prepareDemTileUniforms(o,G,B)?G.demTexture:this.emptyDEMTexture).bind(A.NEAREST,A.CLAMP_TO_EDGE)),E.activeTexture.set(A.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),this._depthFBO&&(B.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),B.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&G){const oe=(1<<G.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;B.u_meter_to_dem=oe}if(x&&x.labelPlaneMatrixInv&&(B.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),d.setTerrainUniformValues(E,B),this.painter.transform.projection.name==="globe"){const oe=this.globeUniformValues(this.painter.transform,o.tileID.canonical,x&&x.useDenormalizedUpVectorScale);d.setGlobeUniformValues(E,oe)}}globeUniformValues(o,d,x){const E=o.projection;return{u_tile_tl_up:E.upVector(d,0,0),u_tile_tr_up:E.upVector(d,t.EXTENT,0),u_tile_br_up:E.upVector(d,t.EXTENT,t.EXTENT),u_tile_bl_up:E.upVector(d,0,t.EXTENT),u_tile_up_scale:x?t.globeMetersToEcef(1):E.upVectorScale(d,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const d=this.painter,x=this.painter.context;o.length!==0&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(E,A,B,O,G){if(E.transform.projection.name==="globe")(function(H,X,oe,ve,Ee){const Ie=H.context,Ce=Ie.gl;let ze,ae;const Me=H.options.showTerrainWireframe?2:0,Ue=H.transform,Ge=t.globeUseCustomAntiAliasing(H,Ie,Ue),rt=(mi,Ct)=>{if(ae===mi)return;const ei=[kr[mi],"PROJECTION_GLOBE_VIEW"];Ge&&ei.push("CUSTOM_ANTIALIASING"),Ct&&ei.push(kr[Me]),ze=H.useProgram("globeRaster",null,ei),ae=mi},nt=H.colorModeForRenderPass(),tt=new t.DepthMode(Ce.LEQUAL,t.DepthMode.ReadWrite,H.depthRangeFor3D);va.update(Ee);const gt=t.calculateGlobeMercatorMatrix(Ue),yt=[t.mercatorXfromLng(Ue.center.lng),t.mercatorYfromLat(Ue.center.lat)],kt=Me?[!1,!0]:[!1],yi=H.globeSharedBuffers,At=[Ue.width*t.exported.devicePixelRatio,Ue.height*t.exported.devicePixelRatio],Zt=Float32Array.from(Ue.globeMatrix),Nt={useDenormalizedUpVectorScale:!0};if(kt.forEach(mi=>{const Ct=H.transform,ei=en(Ct.zoom)*X.exaggeration();ae=-1;const _i=mi?Ce.LINES:Ce.TRIANGLES;for(const si of ve){const xi=oe.getTile(si),or=t.StencilMode.disabled,vr=X.prevTerrainTileForTile[si.key],Xi=X.terrainTileForTile[si.key];_n(vr,Xi)&&va.newMorphing(si.key,vr,Xi,Ee,250),Ie.activeTexture.set(Ce.TEXTURE0),xi.texture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE);const cr=va.getMorphValuesForProxy(si.key),Zr=cr?1:0;cr&&t.extend$1(Nt,{morphing:{srcDemTile:cr.from,dstDemTile:cr.to,phase:t.easeCubicInOut(cr.phase)}});const Fr=t.tileCornersToBounds(si.canonical),er=t.getLatitudinalLod(Fr.getCenter().lat),pn=t.getGridMatrix(si.canonical,Fr,er,Ct.worldSize/Ct._pixelsPerMercatorPixel),un=t.globeNormalizeECEF(t.globeTileBounds(si.canonical)),kn=$a(Ct.projMatrix,Zt,gt,un,t.globeToMercatorTransition(Ct.zoom),yt,Ct.frustumCorners.TL,Ct.frustumCorners.TR,Ct.frustumCorners.BR,Ct.frustumCorners.BL,Ct.globeCenterInViewSpace,Ct.globeRadius,At,ei,pn);if(rt(Zr,mi),X.setupElevationDraw(xi,ze,Nt),H.prepareDrawProgram(Ie,ze,si.toUnwrapped()),yi){const[fn,Lo,go]=mi?yi.getWirefameBuffers(H.context,er):yi.getGridBuffers(er,ei!==0);ze.draw(Ie,_i,tt,or,nt,t.CullFaceMode.backCCW,kn,"globe_raster",fn,Lo,go)}}}),yi){const mi=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ge&&mi.push("CUSTOM_ANTIALIASING"),ze=H.useProgram("globeRaster",null,mi);for(const Ct of ve){const{x:ei,y:_i,z:si}=Ct.canonical,xi=_i===0,or=_i===(1<<si)-1,[vr,Xi,cr,Zr]=yi.getPoleBuffers(si);if(Zr&&(xi||or)){const Fr=oe.getTile(Ct);Ie.activeTexture.set(Ce.TEXTURE0),Fr.texture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE);let er=t.globePoleMatrixForTile(si,ei,Ue);const pn=t.globeNormalizeECEF(t.globeTileBounds(Ct.canonical)),un=(kn,fn)=>kn.draw(Ie,Ce.TRIANGLES,tt,t.StencilMode.disabled,nt,t.CullFaceMode.disabled,$a(Ue.projMatrix,er,er,pn,0,yt,Ue.frustumCorners.TL,Ue.frustumCorners.TR,Ue.frustumCorners.BR,Ue.frustumCorners.BL,Ue.globeCenterInViewSpace,Ue.globeRadius,At,0),"globe_pole_raster",fn,cr,Zr);X.setupElevationDraw(Fr,ze,Nt),H.prepareDrawProgram(Ie,ze,Ct.toUnwrapped()),xi&&un(ze,vr),or&&(er=t.scale(t.create(),er,[1,-1,1]),un(ze,Xi))}}}})(E,A,B,O,G);else{const H=E.context,X=H.gl;let oe,ve;const Ee=E.options.showTerrainWireframe?2:0,Ie=(Ue,Ge)=>{if(ve===Ue)return;const rt=[kr[Ue]];Ge&&rt.push(kr[Ee]),oe=E.useProgram("terrainRaster",null,rt),ve=Ue},Ce=E.colorModeForRenderPass(),ze=new t.DepthMode(X.LEQUAL,t.DepthMode.ReadWrite,E.depthRangeFor3D);va.update(G);const ae=E.transform,Me=en(ae.zoom)*A.exaggeration();(Ee?[!1,!0]:[!1]).forEach(Ue=>{ve=-1;const Ge=Ue?X.LINES:X.TRIANGLES,[rt,nt]=Ue?A.getWirefameBuffer():[A.gridIndexBuffer,A.gridSegments];for(const tt of O){const gt=B.getTile(tt),yt=t.StencilMode.disabled,kt=A.prevTerrainTileForTile[tt.key],yi=A.terrainTileForTile[tt.key];_n(kt,yi)&&va.newMorphing(tt.key,kt,yi,G,250),H.activeTexture.set(X.TEXTURE0),gt.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST);const At=va.getMorphValuesForProxy(tt.key),Zt=At?1:0;let Nt;At&&(Nt={morphing:{srcDemTile:At.from,dstDemTile:At.to,phase:t.easeCubicInOut(At.phase)}});const mi=Hl(tt.projMatrix,Pn(tt.canonical,ae.renderWorldCopies)?Me/10:Me);Ie(Zt,Ue),A.setupElevationDraw(gt,oe,Nt),E.prepareDrawProgram(H,oe,tt.toUnwrapped()),oe.draw(H,Ge,ze,yt,Ce,t.CullFaceMode.backCCW,mi,"terrain_raster",A.gridBuffer,rt,nt)}})}}(d,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const d=this.painter,x=this.painter.context,E=this.proxySourceCache,A=this.proxiedCoords[E.id],B=this._drapedRenderBatches.shift(),O=[],G=d.style.order;let H=0;for(const X of A){const oe=E.getTileByID(X.proxyTileKey),ve=E.proxyCachedFBO[X.key]?E.proxyCachedFBO[X.key][o]:void 0,Ee=ve!==void 0?E.renderCache[ve]:this.pool[H++],Ie=ve!==void 0;if(oe.texture=Ee.tex,Ie&&!Ee.dirty){O.push(oe.tileID);continue}let Ce;x.bindFramebuffer.set(Ee.fb.framebuffer),this.renderedToTile=!1,Ee.dirty&&(x.clear({color:t.Color.transparent,stencil:0}),Ee.dirty=!1);for(let ze=B.start;ze<=B.end;++ze){const ae=d.style._layers[G[ze]];if(ae.isHidden(d.transform.zoom))continue;const Me=d.style._getLayerSourceCache(ae),Ue=Me?this.proxyToSource[X.key][Me.id]:[X];if(!Ue)continue;const Ge=Ue;x.viewport.set([0,0,Ee.fb.width,Ee.fb.height]),Ce!==(Me?Me.id:null)&&(this._setupStencil(Ee,Ue,ae,Me),Ce=Me?Me.id:null),d.renderLayer(d,Me,ae,Ge)}this.renderedToTile?(Ee.dirty=!0,O.push(oe.tileID)):Ie||--H,H===5&&(H=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,d.width,d.height]),B.end+1}postRender(){}renderCacheEfficiency(o){const d=o.order.length;if(d===0)return{efficiency:100};let x,E=0,A=0,B=!1;for(let O=0;O<d;++O){const G=o._layers[o.order[O]];this._style.isLayerDraped(G)?(B&&++E,++A):B||(B=!0,x=G.id)}return A===0?{efficiency:100}:{efficiency:100*(1-E/A),firstUndrapedLayer:x}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{o=Math.min(o,d.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,d,x){if(!this._visibleDemTiles)return null;const E=this._visibleDemTiles.filter(A=>A.dem).map(A=>{const B=A.tileID,O=1<<B.overscaledZ,{x:G,y:H}=B.canonical,X=G/O,oe=(G+1)/O,ve=H/O,Ee=(H+1)/O;return{minx:X,miny:ve,maxx:oe,maxy:Ee,t:A.dem.tree.raycastRoot(X,ve,oe,Ee,o,d,x),tile:A}});E.sort((A,B)=>(A.t!==null?A.t:Number.MAX_VALUE)-(B.t!==null?B.t:Number.MAX_VALUE));for(const A of E){if(A.t==null)return null;const B=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,o,d,x);if(B!=null)return B}return null}_createFBO(){const o=this.painter.context,d=o.gl,x=this.drapeBufferSize;o.activeTexture.set(d.TEXTURE0);const E=new t.Texture(o,{width:x[0],height:x[1],data:null},d.RGBA);E.bind(d.LINEAR,d.CLAMP_TO_EDGE);const A=o.createFramebuffer(x[0],x[1],!1);return A.colorAttachment.set(E.texture),A.depthAttachment=new st(o,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&d.texParameterf(d.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:A,tex:E,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const d=this._style._layers[o],x=d.isHidden(this.painter.transform.zoom);return d.type==="custom"?!x&&d.shouldRedrape():!x&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const x of this._style._getSources())if(x instanceof wi){o=!0;break}if(!o)return;const d={};for(let x=0;x<this._style.order.length;++x){const E=this._style._layers[this._style.order[x]],A=this._style._getLayerSourceCache(E);if(A&&!d[A.id]&&!E.isHidden(this.painter.transform.zoom)&&E.type==="line"&&E.widthExpression()instanceof t.ZoomDependentExpression){d[A.id]=!0;for(const B of this.proxyCoords){const O=this.proxyToSource[B.key][A.id];if(O)for(const G of O)this._clearRenderCacheForTile(A.id,G)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const x in this._style._sourceCaches)if(this._style._sourceCaches[x]._source instanceof Pe){o=!0;break}if(!o)return;const d={};for(let x=0;x<this._style.order.length;++x){const E=this._style._layers[this._style.order[x]],A=this._style._getLayerSourceCache(E);if(!A||d[A.id]||E.isHidden(this.painter.transform.zoom)||E.type!=="raster")continue;const B=E.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const G=this.proxyToSource[O.key][A.id];if(G)for(const H of G){const X=Kl(A.getTile(H),A.findLoadedParent(H,0),A,this.painter.transform,B);(X.opacity!==1||X.mix!==0)&&this._clearRenderCacheForTile(A.id,H)}}}}_setupDrapedRenderBatches(){const o=this._style.order,d=o.length;if(d===0)return;const x=[];let E,A=0,B=this._style._layers[o[A]];for(;!this._style.isLayerDraped(B)&&B.isHidden(this.painter.transform.zoom)&&++A<d;)B=this._style._layers[o[A]];for(;A<d;++A){const O=this._style._layers[o[A]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?E===void 0&&(E=A):E!==void 0&&(x.push({start:E,end:A-1}),E=void 0))}E!==void 0&&x.push({start:E,end:A-1}),this._drapedRenderBatches=x}_setupRenderCache(o){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const B=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let O=0;O<B.length;++O){const G=Object.values(B[O]);d.renderCachePool.push(...G)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,E=this._tilesDirty;for(let B=x.length-1;B>=0;B--){const O=x[B];if(d.getTileByID(O.key),d.proxyCachedFBO[O.key]!==void 0){const G=o[O.key],H=this.proxyToSource[O.key];let X=0;for(const oe in H){const ve=H[oe],Ee=G[oe];if(!Ee||Ee.length!==ve.length||ve.some((Ie,Ce)=>Ie!==Ee[Ce]||E[oe]&&E[oe].hasOwnProperty(Ie.key))){X=-1;break}++X}for(const oe in d.proxyCachedFBO[O.key])d.renderCache[d.proxyCachedFBO[O.key][oe]].dirty=X<0||X!==Object.values(G).length}}const A=[...this._drapedRenderBatches];A.sort((B,O)=>O.end-O.start-(B.end-B.start));for(const B of A)for(const O of x){if(d.proxyCachedFBO[O.key])continue;let G=d.renderCachePool.pop();G===void 0&&d.renderCache.length<50&&(G=d.renderCache.length,d.renderCache.push(this._createFBO())),G!==void 0&&(d.proxyCachedFBO[O.key]={},d.proxyCachedFBO[O.key][B.start]=G,d.renderCache[G].dirty=!0)}this._tilesDirty={}}_setupStencil(o,d,x,E){if(!E||!this._sourceTilesOverlap[E.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,B=A.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let O;if(x.isTileClipped())O=d.length,this._overlapStencilMode.test={func:B.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:B.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(o,d){const x=this.painter,E=this.painter.context,A=E.gl;x._tileClippingMaskIDs={},E.setColorMode(t.ColorMode.disabled),E.setDepthMode(t.DepthMode.disabled);const B=x.useProgram("clippingMask");for(const O of o){const G=x._tileClippingMaskIDs[O.key]=--d;B.draw(E,A.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:A.ALWAYS,mask:0},G,255,A.KEEP,A.KEEP,A.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Mn(O.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(o){const d=this.painter.transform;if(o.x<0||o.x>d.width||o.y<0||o.y>d.height)return null;const x=[o.x,o.y,1,1];t.transformMat4$1(x,x,d.pixelMatrixInverse),t.scale$1(x,x,1/x[3]),x[0]/=d.worldSize,x[1]/=d.worldSize;const E=d._camera.position,A=t.mercatorZfromAltitude(1,d.center.lat),B=[E[0],E[1],E[2]/A,0],O=t.subtract([],x.slice(0,3),B);t.normalize(O,O);const G=this.raycast(B,O,this._exaggeration);return G!==null&&G?(t.scaleAndAdd(B,B,O,G),B[3]=B[2],B[2]*=A,B):null}drawDepth(){const o=this.painter,d=o.context,x=this.proxySourceCache,E=Math.ceil(o.width),A=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===E&&this._depthFBO.height===A||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const B=d.gl,O=d.createFramebuffer(E,A,!0);d.activeTexture.set(B.TEXTURE0);const G=new t.Texture(d,{width:E,height:A,data:null},B.RGBA);G.bind(B.NEAREST,B.CLAMP_TO_EDGE),O.colorAttachment.set(G.texture);const H=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,E,A);O.depthAttachment.set(H),this._depthFBO=O,this._depthTexture=G}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,E,A]),function(B,O,G,H){if(B.transform.projection.name==="globe")return;const X=B.context,oe=X.gl;X.clear({depth:1});const ve=B.useProgram("terrainDepth"),Ee=new t.DepthMode(oe.LESS,t.DepthMode.ReadWrite,B.depthRangeFor3D);for(const Ie of H){const Ce=G.getTile(Ie),ze=Hl(Ie.projMatrix,0);O.setupElevationDraw(Ce,ve),ve.draw(X,oe.TRIANGLES,Ee,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,ze,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(o,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,d,x){if(o.getSource()instanceof bt)return this._setupProxiedCoordsForImageSource(o,d,x);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const E=this.proxiedCoords[o.id]=[],A=this.proxyCoords;for(let O=0;O<A.length;O++){const G=A[O],H=this._findTileCoveringTileID(G,o);if(H){const X=this._createProxiedId(G,H,x[G.key]&&x[G.key][o.id]);E.push(X),this.proxyToSource[G.key][o.id]=[X]}}let B=!1;for(let O=0;O<d.length;O++){const G=o.getTile(d[O]);if(!G||!G.hasData())continue;const H=this._findTileCoveringTileID(G.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==G.tileID.canonical.z){const X=this.proxyToSource[H.tileID.key][o.id],oe=this._createProxiedId(H.tileID,G,x[H.tileID.key]&&x[H.tileID.key][o.id]);X?X.splice(X.length-1,0,oe):this.proxyToSource[H.tileID.key][o.id]=[oe],E.push(oe),B=!0}}this._sourceTilesOverlap[o.id]=B}_setupProxiedCoordsForImageSource(o,d,x){if(!o.getSource().loaded())return;const E=this.proxiedCoords[o.id]=[],A=this.proxyCoords,B=o.getSource(),O=new t.Point(B.tileID.x,B.tileID.y)._div(1<<B.tileID.z),G=B.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce((X,oe)=>(X.min.x=Math.min(X.min.x,oe.x-O.x),X.min.y=Math.min(X.min.y,oe.y-O.y),X.max.x=Math.max(X.max.x,oe.x-O.x),X.max.y=Math.max(X.max.y,oe.y-O.y),X),{min:new t.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=(X,oe)=>{const ve=X.wrap+X.canonical.x/(1<<X.canonical.z),Ee=X.canonical.y/(1<<X.canonical.z),Ie=t.EXTENT/(1<<X.canonical.z),Ce=oe.wrap+oe.canonical.x/(1<<oe.canonical.z),ze=oe.canonical.y/(1<<oe.canonical.z);return ve+Ie<Ce+G.min.x||ve>Ce+G.max.x||Ee+Ie<ze+G.min.y||Ee>ze+G.max.y};for(let X=0;X<A.length;X++){const oe=A[X];for(let ve=0;ve<d.length;ve++){const Ee=o.getTile(d[ve]);if(!Ee||!Ee.hasData()||H(oe,Ee.tileID))continue;const Ie=this._createProxiedId(oe,Ee,x[oe.key]&&x[oe.key][o.id]),Ce=this.proxyToSource[oe.key][o.id];Ce?Ce.push(Ie):this.proxyToSource[oe.key][o.id]=[Ie],E.push(Ie)}}}_createProxiedId(o,d,x){let E=this.orthoMatrix;if(x){const A=x.find(B=>B.key===d.tileID.key);if(A)return A}if(d.tileID.key!==o.key){const A=o.canonical.z-d.tileID.canonical.z;let B,O,G;E=t.create();const H=d.tileID.wrap-o.wrap<<o.overscaledZ;A>0?(B=t.EXTENT>>A,O=B*((d.tileID.canonical.x<<A)-o.canonical.x+H),G=B*((d.tileID.canonical.y<<A)-o.canonical.y)):(B=t.EXTENT<<-A,O=t.EXTENT*(d.tileID.canonical.x-(o.canonical.x+H<<-A)),G=t.EXTENT*(d.tileID.canonical.y-(o.canonical.y<<-A))),t.ortho(E,0,B,0,B,0,1),t.translate(E,E,[O,G,0])}return new $u(d.tileID,o.key,E)}_findTileCoveringTileID(o,d){let x=d.getTile(o);if(x&&x.hasData())return x;const E=this._findCoveringTileCache[d.id],A=E[o.key];if(x=A?d.getTileByID(A):null,x&&x.hasData()||A===null)return x;let B=x?x.tileID:o,O=B.overscaledZ;const G=d.getSource().minzoom,H=[];if(!A){const oe=d.getSource().maxzoom;if(o.canonical.z>=oe){const ve=o.canonical.z-oe;d.getSource().reparseOverscaled?(O=Math.max(o.canonical.z+2,d.transform.tileZoom),B=new t.OverscaledTileID(O,o.wrap,oe,o.canonical.x>>ve,o.canonical.y>>ve)):ve!==0&&(O=oe,B=new t.OverscaledTileID(O,o.wrap,oe,o.canonical.x>>ve,o.canonical.y>>ve))}B.key!==o.key&&(H.push(B.key),x=d.getTile(B))}const X=oe=>{H.forEach(ve=>{E[ve]=oe}),H.length=0};for(O-=1;O>=G&&(!x||!x.hasData());O--){x&&X(x.tileID.key);const oe=B.calculateScaledKey(O);if(x=d.getTileByID(oe),x&&x.hasData())break;const ve=E[oe];if(ve===null)break;ve===void 0?H.push(oe):x=d.getTileByID(ve)}return X(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,d){let x=this._tilesDirty[o];x||(x=this._tilesDirty[o]={}),x[d.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(d){let x=0;const E=new t.StructArrayLayout2ui4,A=131;for(let B=1;B<129;B++){for(let O=1;O<129;O++)x=B*A+O,E.emplaceBack(x,x+1),E.emplaceBack(x,x+A),E.emplaceBack(x+1,x+A),B===128&&E.emplaceBack(x+A,x+A+1);E.emplaceBack(x+1,x+1+A)}return E}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Kr{static cacheKey(o,d,x,E){let A=`${d}${E?E.cacheKey:""}`;for(const B of x)o.usedDefines.includes(B)&&(A+=`/${B}`);return A}constructor(o,d,x,E,A,B){const O=o.gl;this.program=O.createProgram();const G=function(ae){const Me=[];for(let Ue=0;Ue<ae.length;Ue++){if(ae[Ue]===null)continue;const Ge=ae[Ue].split(" ");Me.push(Ge.pop())}return Me}(x.staticAttributes),H=E?E.getBinderAttributes():[],X=G.concat(H);let oe=E?E.defines():[];oe=oe.concat(B.map(ae=>`#define ${ae}`));const ve=o.isWebGL2?`#version 300 es
`:"",Ee=ve+oe.concat(o.extStandardDerivatives&&ve.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Ah):Ah,Ah,Vu,p1.fragmentSource,Mc.fragmentSource,x.fragmentSource).join(`
`),Ie=ve+oe.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Vu,p1.vertexSource,Mc.vertexSource,Nu.vertexSource,x.vertexSource).join(`
`),Ce=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(Ce,Ee),O.compileShader(Ce),O.attachShader(this.program,Ce);const ze=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(ze,Ie),O.compileShader(ze),O.attachShader(this.program,ze),this.attributes={},this.numAttributes=X.length;for(let ae=0;ae<this.numAttributes;ae++)X[ae]&&(O.bindAttribLocation(this.program,ae,X[ae]),this.attributes[X[ae]]=ae);O.linkProgram(this.program),O.deleteShader(ze),O.deleteShader(Ce),this.fixedUniforms=A(o),this.binderUniforms=E?E.getUniforms(o):[],B.includes("TERRAIN")&&(this.terrainUniforms=(ae=>({u_dem:new t.Uniform1i(ae),u_dem_prev:new t.Uniform1i(ae),u_dem_unpack:new t.Uniform4f(ae),u_dem_tl:new t.Uniform2f(ae),u_dem_scale:new t.Uniform1f(ae),u_dem_tl_prev:new t.Uniform2f(ae),u_dem_scale_prev:new t.Uniform1f(ae),u_dem_size:new t.Uniform1f(ae),u_dem_lerp:new t.Uniform1f(ae),u_exaggeration:new t.Uniform1f(ae),u_depth:new t.Uniform1i(ae),u_depth_size_inv:new t.Uniform2f(ae),u_meter_to_dem:new t.Uniform1f(ae),u_label_plane_matrix_inv:new t.UniformMatrix4f(ae)}))(o)),B.includes("GLOBE")&&(this.globeUniforms=(ae=>({u_tile_tl_up:new t.Uniform3f(ae),u_tile_tr_up:new t.Uniform3f(ae),u_tile_br_up:new t.Uniform3f(ae),u_tile_bl_up:new t.Uniform3f(ae),u_tile_up_scale:new t.Uniform1f(ae)}))(o)),B.includes("FOG")&&(this.fogUniforms=(ae=>({u_fog_matrix:new t.UniformMatrix4f(ae),u_fog_range:new t.Uniform2f(ae),u_fog_color:new t.Uniform4f(ae),u_fog_horizon_blend:new t.Uniform1f(ae),u_fog_temporal_offset:new t.Uniform1f(ae),u_frustum_tl:new t.Uniform3f(ae),u_frustum_tr:new t.Uniform3f(ae),u_frustum_br:new t.Uniform3f(ae),u_frustum_bl:new t.Uniform3f(ae),u_globe_pos:new t.Uniform3f(ae),u_globe_radius:new t.Uniform1f(ae),u_globe_transition:new t.Uniform1f(ae),u_is_globe:new t.Uniform1i(ae),u_viewport:new t.Uniform2f(ae)}))(o))}}setTerrainUniformValues(o,d){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const E in d)x[E]&&x[E].set(this.program,E,d[E])}}setGlobeUniformValues(o,d){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const E in d)x[E]&&x[E].set(this.program,E,d[E])}}setFogUniformValues(o,d){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const E in d)x[E].set(this.program,E,d[E])}}draw(o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce){const ze=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(x),o.setStencilMode(E),o.setColorMode(A),o.setCullFace(B);for(const Me of Object.keys(this.fixedUniforms))this.fixedUniforms[Me].set(this.program,Me,O[Me]);Ie&&Ie.setUniforms(this.program,o,this.binderUniforms,ve,{zoom:Ee});const ae={[ze.LINES]:2,[ze.TRIANGLES]:3,[ze.LINE_STRIP]:1}[d];for(const Me of oe.get()){const Ue=Me.vaos||(Me.vaos={});(Ue[G]||(Ue[G]=new Ph)).bind(o,this,H,Ie?Ie.getPaintVertexBuffers():[],X,Me.vertexOffset,Ce||[]),ze.drawElements(d,Me.primitiveLength*ae,ze.UNSIGNED_SHORT,Me.primitiveOffset*ae*2)}}}function pl(_,o){const d=Math.pow(2,o.tileID.overscaledZ),x=o.tileSize*Math.pow(2,_.transform.tileZoom)/d,E=x*(o.tileID.canonical.x+o.tileID.wrap*d),A=x*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_tile_units_to_pixels:1/Wi(o,1,_.transform.tileZoom),u_pixel_coord_upper:[E>>16,A>>16],u_pixel_coord_lower:[65535&E,65535&A]}}const Cc=t.create(),Yl=(_,o,d,x,E,A,B,O,G,H,X)=>{const oe=o.style.light,ve=oe.properties.get("position"),Ee=[ve.x,ve.y,ve.z],Ie=t.create$1();oe.properties.get("anchor")==="viewport"&&(t.fromRotation(Ie,-o.transform.angle),t.transformMat3(Ee,Ee,Ie));const Ce=oe.properties.get("color"),ze=o.transform,ae={u_matrix:_,u_lightpos:Ee,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[Ce.r,Ce.g,Ce.b],u_vertical_gradient:+d,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Cc,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:E,u_edge_radius:A};return ze.projection.name==="globe"&&(ae.u_tile_id=[B.canonical.x,B.canonical.y,1<<B.canonical.z],ae.u_zoom_transition=G,ae.u_inv_rot_matrix=X,ae.u_merc_center=H,ae.u_up_dir=ze.projection.upVector(new t.CanonicalTileID(0,0,0),H[0]*t.EXTENT,H[1]*t.EXTENT),ae.u_height_lift=O),ae},Ic=(_,o,d,x,E,A,B,O,G,H,X,oe)=>{const ve=Yl(_,o,d,x,E,A,B,G,H,X,oe),Ee={u_height_factor:-Math.pow(2,B.overscaledZ)/O.tileSize/8};return t.extend(ve,pl(o,O),Ee)},Za=_=>({u_matrix:_}),qu=(_,o,d)=>t.extend(Za(_),pl(o,d)),Wu=(_,o)=>({u_matrix:_,u_world:o}),Xu=(_,o,d,x)=>t.extend(qu(_,o,d),{u_world:x}),ca=t.create(),Hu=(_,o,d,x,E,A)=>{const B=_.transform,O=B.projection.name==="globe";let G;if(A.paint.get("circle-pitch-alignment")==="map")if(O){const X=t.globePixelsToTileUnits(B.zoom,o.canonical)*B._pixelsPerMercatorPixel;G=Float32Array.from([X,0,0,X])}else G=B.calculatePixelsToTileUnitsMatrix(d);else G=new Float32Array([B.pixelsToGLUnits[0],0,0,B.pixelsToGLUnits[1]]);const H={u_camera_to_center_distance:B.cameraToCenterDistance,u_matrix:_.translatePosMatrix(o.projMatrix,d,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:G,u_inv_rot_matrix:ca,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){H.u_inv_rot_matrix=x,H.u_merc_center=E,H.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],H.u_zoom_transition=t.globeToMercatorTransition(B.zoom);const X=E[0]*t.EXTENT,oe=E[1]*t.EXTENT;H.u_up_dir=B.projection.upVector(new t.CanonicalTileID(0,0,0),X,oe)}return H},lu=_=>{const o=[];return _.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),_.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},Ku=(_,o,d,x)=>{const E=t.EXTENT/d.tileSize;return{u_matrix:_,u_camera_to_center_distance:o.getCameraToCenterDistance(x),u_extrude_scale:[o.pixelsToGLUnits[0]/E,o.pixelsToGLUnits[1]/E]}},ba=(_,o,d=1)=>({u_matrix:_,u_color:o,u_overlay:0,u_overlay_scale:d}),Ac=t.create(),Jl=(_,o,d,x,E,A,B)=>{const O=_.transform,G=O.projection.name==="globe",H=G?t.globePixelsToTileUnits(O.zoom,o.canonical)*O._pixelsPerMercatorPixel:Wi(d,1,A),X={u_matrix:o.projMatrix,u_extrude_scale:H,u_intensity:B,u_inv_rot_matrix:Ac,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){X.u_inv_rot_matrix=x,X.u_merc_center=E,X.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],X.u_zoom_transition=t.globeToMercatorTransition(O.zoom);const oe=E[0]*t.EXTENT,ve=E[1]*t.EXTENT;X.u_up_dir=O.projection.upVector(new t.CanonicalTileID(0,0,0),oe,ve)}return X},wd=(_,o,d,x,E,A,B)=>{const O=_.transform,G=O.calculatePixelsToTileUnitsMatrix(o);return{u_matrix:Yu(_,o,d,x),u_pixels_to_tile_units:G,u_device_pixel_ratio:A,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:E,u_texsize:qa(d)?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ql(o,_.transform),u_alpha_discard_threshold:0,u_trim_offset:B}},fl=(_,o,d,x,E)=>{const A=_.transform;return{u_matrix:Yu(_,o,d,x),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:A.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:E,u_image:0,u_tile_units_to_pixels:Ql(o,A),u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ql(_,o){return 1/Wi(_,1,o.tileZoom)}function Yu(_,o,d,x){return _.translatePosMatrix(x||o.tileID.projMatrix,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}function qa(_){const o=_.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const cu=(_,o,d,x,E,A)=>{return{u_matrix:_,u_tl_parent:o,u_scale_parent:d,u_fade_t:x.mix,u_opacity:x.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(O=E.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(B=E.paint.get("raster-contrast"),B>0?1/(1-B):1+B),u_spin_weights:Bs(E.paint.get("raster-hue-rotate")),u_perspective_transform:A};var B,O};function Bs(_){_*=Math.PI/180;const o=Math.sin(_),d=Math.cos(_);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const ml=t.create(),_l=(_,o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce)=>{const ze=E.transform,ae={u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:ze.cameraToCenterDistance,u_rotate_symbol:+d,u_aspect_ratio:ze.width/ze.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:B,u_coord_matrix:O,u_is_text:+G,u_pitch_with_map:+x,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ml,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ml,u_up_vector:[0,-1,0]};return Ce.name==="globe"&&(ae.u_tile_id=[X.canonical.x,X.canonical.y,1<<X.canonical.z],ae.u_zoom_transition=oe,ae.u_inv_rot_matrix=Ee,ae.u_merc_center=ve,ae.u_camera_forward=ze._camera.forward(),ae.u_ecef_origin=t.globeECEFOrigin(ze.globeMatrix,X.toUnwrapped()),ae.u_tile_matrix=Float32Array.from(ze.globeMatrix),ae.u_up_vector=Ie),ae},gl=(_,o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce,ze)=>t.extend(_l(_,o,d,x,E,A,B,O,G,H,oe,ve,Ee,Ie,Ce,ze),{u_gamma_scale:x?E.transform.cameraToCenterDistance*Math.cos(E.terrain?0:E.transform._pitch):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:+X}),zh=(_,o,d,x,E,A,B,O,G,H,X,oe,ve,Ee,Ie,Ce)=>t.extend(gl(_,o,d,x,E,A,B,O,!0,G,!0,X,oe,ve,Ee,Ie,Ce),{u_texsize_icon:H,u_texture_icon:1}),ec=(_,o,d)=>({u_matrix:_,u_opacity:o,u_color:d}),f1=(_,o,d,x,E)=>t.extend(function(A,B,O){const G=B.imageManager.getPattern(A.toString()),{width:H,height:X}=B.imageManager.getPixelSize(),oe=Math.pow(2,O.tileID.overscaledZ),ve=O.tileSize*Math.pow(2,B.transform.tileZoom)/oe,Ee=ve*(O.tileID.canonical.x+O.tileID.wrap*oe),Ie=ve*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:G.tl,u_pattern_br:G.br,u_texsize:[H,X],u_pattern_size:G.displaySize,u_tile_units_to_pixels:1/Wi(O,1,B.transform.tileZoom),u_pixel_coord_upper:[Ee>>16,Ie>>16],u_pixel_coord_lower:[65535&Ee,65535&Ie]}}(x,d,E),{u_matrix:_,u_opacity:o}),Ju={fillExtrusion:_=>({u_matrix:new t.UniformMatrix4f(_),u_lightpos:new t.Uniform3f(_),u_lightintensity:new t.Uniform1f(_),u_lightcolor:new t.Uniform3f(_),u_vertical_gradient:new t.Uniform1f(_),u_opacity:new t.Uniform1f(_),u_edge_radius:new t.Uniform1f(_),u_ao:new t.Uniform2f(_),u_tile_id:new t.Uniform3f(_),u_zoom_transition:new t.Uniform1f(_),u_inv_rot_matrix:new t.UniformMatrix4f(_),u_merc_center:new t.Uniform2f(_),u_up_dir:new t.Uniform3f(_),u_height_lift:new t.Uniform1f(_)}),fillExtrusionPattern:_=>({u_matrix:new t.UniformMatrix4f(_),u_lightpos:new t.Uniform3f(_),u_lightintensity:new t.Uniform1f(_),u_lightcolor:new t.Uniform3f(_),u_vertical_gradient:new t.Uniform1f(_),u_height_factor:new t.Uniform1f(_),u_edge_radius:new t.Uniform1f(_),u_ao:new t.Uniform2f(_),u_tile_id:new t.Uniform3f(_),u_zoom_transition:new t.Uniform1f(_),u_inv_rot_matrix:new t.UniformMatrix4f(_),u_merc_center:new t.Uniform2f(_),u_up_dir:new t.Uniform3f(_),u_height_lift:new t.Uniform1f(_),u_image:new t.Uniform1i(_),u_texsize:new t.Uniform2f(_),u_pixel_coord_upper:new t.Uniform2f(_),u_pixel_coord_lower:new t.Uniform2f(_),u_tile_units_to_pixels:new t.Uniform1f(_),u_opacity:new t.Uniform1f(_)}),fill:_=>({u_matrix:new t.UniformMatrix4f(_)}),fillPattern:_=>({u_matrix:new t.UniformMatrix4f(_),u_image:new t.Uniform1i(_),u_texsize:new t.Uniform2f(_),u_pixel_coord_upper:new t.Uniform2f(_),u_pixel_coord_lower:new t.Uniform2f(_),u_tile_units_to_pixels:new t.Uniform1f(_)}),fillOutline:_=>({u_matrix:new t.UniformMatrix4f(_),u_world:new t.Uniform2f(_)}),fillOutlinePattern:_=>({u_matrix:new t.UniformMatrix4f(_),u_world:new t.Uniform2f(_),u_image:new t.Uniform1i(_),u_texsize:new t.Uniform2f(_),u_pixel_coord_upper:new t.Uniform2f(_),u_pixel_coord_lower:new t.Uniform2f(_),u_tile_units_to_pixels:new t.Uniform1f(_)}),circle:_=>({u_camera_to_center_distance:new t.Uniform1f(_),u_extrude_scale:new t.UniformMatrix2f(_),u_device_pixel_ratio:new t.Uniform1f(_),u_matrix:new t.UniformMatrix4f(_),u_inv_rot_matrix:new t.UniformMatrix4f(_),u_merc_center:new t.Uniform2f(_),u_tile_id:new t.Uniform3f(_),u_zoom_transition:new t.Uniform1f(_),u_up_dir:new t.Uniform3f(_)}),collisionBox:_=>({u_matrix:new t.UniformMatrix4f(_),u_camera_to_center_distance:new t.Uniform1f(_),u_extrude_scale:new t.Uniform2f(_)}),collisionCircle:_=>({u_matrix:new t.UniformMatrix4f(_),u_inv_matrix:new t.UniformMatrix4f(_),u_camera_to_center_distance:new t.Uniform1f(_),u_viewport_size:new t.Uniform2f(_)}),debug:_=>({u_color:new t.UniformColor(_),u_matrix:new t.UniformMatrix4f(_),u_overlay:new t.Uniform1i(_),u_overlay_scale:new t.Uniform1f(_)}),clippingMask:_=>({u_matrix:new t.UniformMatrix4f(_)}),heatmap:_=>({u_extrude_scale:new t.Uniform1f(_),u_intensity:new t.Uniform1f(_),u_matrix:new t.UniformMatrix4f(_),u_inv_rot_matrix:new t.UniformMatrix4f(_),u_merc_center:new t.Uniform2f(_),u_tile_id:new t.Uniform3f(_),u_zoom_transition:new t.Uniform1f(_),u_up_dir:new t.Uniform3f(_)}),heatmapTexture:_=>({u_image:new t.Uniform1i(_),u_color_ramp:new t.Uniform1i(_),u_opacity:new t.Uniform1f(_)}),hillshade:_=>({u_matrix:new t.UniformMatrix4f(_),u_image:new t.Uniform1i(_),u_latrange:new t.Uniform2f(_),u_light:new t.Uniform2f(_),u_shadow:new t.UniformColor(_),u_highlight:new t.UniformColor(_),u_accent:new t.UniformColor(_)}),hillshadePrepare:_=>({u_matrix:new t.UniformMatrix4f(_),u_image:new t.Uniform1i(_),u_dimension:new t.Uniform2f(_),u_zoom:new t.Uniform1f(_),u_unpack:new t.Uniform4f(_)}),line:_=>({u_matrix:new t.UniformMatrix4f(_),u_pixels_to_tile_units:new t.UniformMatrix2f(_),u_device_pixel_ratio:new t.Uniform1f(_),u_units_to_pixels:new t.Uniform2f(_),u_dash_image:new t.Uniform1i(_),u_gradient_image:new t.Uniform1i(_),u_image_height:new t.Uniform1f(_),u_texsize:new t.Uniform2f(_),u_tile_units_to_pixels:new t.Uniform1f(_),u_alpha_discard_threshold:new t.Uniform1f(_),u_trim_offset:new t.Uniform2f(_)}),linePattern:_=>({u_matrix:new t.UniformMatrix4f(_),u_texsize:new t.Uniform2f(_),u_pixels_to_tile_units:new t.UniformMatrix2f(_),u_device_pixel_ratio:new t.Uniform1f(_),u_image:new t.Uniform1i(_),u_units_to_pixels:new t.Uniform2f(_),u_tile_units_to_pixels:new t.Uniform1f(_),u_alpha_discard_threshold:new t.Uniform1f(_)}),raster:_=>({u_matrix:new t.UniformMatrix4f(_),u_tl_parent:new t.Uniform2f(_),u_scale_parent:new t.Uniform1f(_),u_fade_t:new t.Uniform1f(_),u_opacity:new t.Uniform1f(_),u_image0:new t.Uniform1i(_),u_image1:new t.Uniform1i(_),u_brightness_low:new t.Uniform1f(_),u_brightness_high:new t.Uniform1f(_),u_saturation_factor:new t.Uniform1f(_),u_contrast_factor:new t.Uniform1f(_),u_spin_weights:new t.Uniform3f(_),u_perspective_transform:new t.Uniform2f(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new t.Uniform1i(_),u_is_size_feature_constant:new t.Uniform1i(_),u_size_t:new t.Uniform1f(_),u_size:new t.Uniform1f(_),u_camera_to_center_distance:new t.Uniform1f(_),u_rotate_symbol:new t.Uniform1i(_),u_aspect_ratio:new t.Uniform1f(_),u_fade_change:new t.Uniform1f(_),u_matrix:new t.UniformMatrix4f(_),u_label_plane_matrix:new t.UniformMatrix4f(_),u_coord_matrix:new t.UniformMatrix4f(_),u_is_text:new t.Uniform1i(_),u_pitch_with_map:new t.Uniform1i(_),u_texsize:new t.Uniform2f(_),u_tile_id:new t.Uniform3f(_),u_zoom_transition:new t.Uniform1f(_),u_inv_rot_matrix:new t.UniformMatrix4f(_),u_merc_center:new t.Uniform2f(_),u_camera_forward:new t.Uniform3f(_),u_tile_matrix:new t.UniformMatrix4f(_),u_up_vector:new t.Uniform3f(_),u_ecef_origin:new t.Uniform3f(_),u_texture:new t.Uniform1i(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new t.Uniform1i(_),u_is_size_feature_constant:new t.Uniform1i(_),u_size_t:new t.Uniform1f(_),u_size:new t.Uniform1f(_),u_camera_to_center_distance:new t.Uniform1f(_),u_rotate_symbol:new t.Uniform1i(_),u_aspect_ratio:new t.Uniform1f(_),u_fade_change:new t.Uniform1f(_),u_matrix:new t.UniformMatrix4f(_),u_label_plane_matrix:new t.UniformMatrix4f(_),u_coord_matrix:new t.UniformMatrix4f(_),u_is_text:new t.Uniform1i(_),u_pitch_with_map:new t.Uniform1i(_),u_texsize:new t.Uniform2f(_),u_texture:new t.Uniform1i(_),u_gamma_scale:new t.Uniform1f(_),u_device_pixel_ratio:new t.Uniform1f(_),u_tile_id:new t.Uniform3f(_),u_zoom_transition:new t.Uniform1f(_),u_inv_rot_matrix:new t.UniformMatrix4f(_),u_merc_center:new t.Uniform2f(_),u_camera_forward:new t.Uniform3f(_),u_tile_matrix:new t.UniformMatrix4f(_),u_up_vector:new t.Uniform3f(_),u_ecef_origin:new t.Uniform3f(_),u_is_halo:new t.Uniform1i(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new t.Uniform1i(_),u_is_size_feature_constant:new t.Uniform1i(_),u_size_t:new t.Uniform1f(_),u_size:new t.Uniform1f(_),u_camera_to_center_distance:new t.Uniform1f(_),u_rotate_symbol:new t.Uniform1i(_),u_aspect_ratio:new t.Uniform1f(_),u_fade_change:new t.Uniform1f(_),u_matrix:new t.UniformMatrix4f(_),u_label_plane_matrix:new t.UniformMatrix4f(_),u_coord_matrix:new t.UniformMatrix4f(_),u_is_text:new t.Uniform1i(_),u_pitch_with_map:new t.Uniform1i(_),u_texsize:new t.Uniform2f(_),u_texsize_icon:new t.Uniform2f(_),u_texture:new t.Uniform1i(_),u_texture_icon:new t.Uniform1i(_),u_gamma_scale:new t.Uniform1f(_),u_device_pixel_ratio:new t.Uniform1f(_),u_is_halo:new t.Uniform1i(_)}),background:_=>({u_matrix:new t.UniformMatrix4f(_),u_opacity:new t.Uniform1f(_),u_color:new t.UniformColor(_)}),backgroundPattern:_=>({u_matrix:new t.UniformMatrix4f(_),u_opacity:new t.Uniform1f(_),u_image:new t.Uniform1i(_),u_pattern_tl:new t.Uniform2f(_),u_pattern_br:new t.Uniform2f(_),u_texsize:new t.Uniform2f(_),u_pattern_size:new t.Uniform2f(_),u_pixel_coord_upper:new t.Uniform2f(_),u_pixel_coord_lower:new t.Uniform2f(_),u_tile_units_to_pixels:new t.Uniform1f(_)}),terrainRaster:Ga,terrainDepth:Ga,skybox:_=>({u_matrix:new t.UniformMatrix4f(_),u_sun_direction:new t.Uniform3f(_),u_cubemap:new t.Uniform1i(_),u_opacity:new t.Uniform1f(_),u_temporal_offset:new t.Uniform1f(_)}),skyboxGradient:_=>({u_matrix:new t.UniformMatrix4f(_),u_color_ramp:new t.Uniform1i(_),u_center_direction:new t.Uniform3f(_),u_radius:new t.Uniform1f(_),u_opacity:new t.Uniform1f(_),u_temporal_offset:new t.Uniform1f(_)}),skyboxCapture:_=>({u_matrix_3f:new t.UniformMatrix3f(_),u_sun_direction:new t.Uniform3f(_),u_sun_intensity:new t.Uniform1f(_),u_color_tint_r:new t.Uniform4f(_),u_color_tint_m:new t.Uniform4f(_),u_luminance:new t.Uniform1f(_)}),globeRaster:_=>({u_proj_matrix:new t.UniformMatrix4f(_),u_globe_matrix:new t.UniformMatrix4f(_),u_normalize_matrix:new t.UniformMatrix4f(_),u_merc_matrix:new t.UniformMatrix4f(_),u_zoom_transition:new t.Uniform1f(_),u_merc_center:new t.Uniform2f(_),u_image0:new t.Uniform1i(_),u_grid_matrix:new t.UniformMatrix3f(_),u_skirt_height:new t.Uniform1f(_),u_frustum_tl:new t.Uniform3f(_),u_frustum_tr:new t.Uniform3f(_),u_frustum_br:new t.Uniform3f(_),u_frustum_bl:new t.Uniform3f(_),u_globe_pos:new t.Uniform3f(_),u_globe_radius:new t.Uniform1f(_),u_viewport:new t.Uniform2f(_)}),globeAtmosphere:_=>({u_frustum_tl:new t.Uniform3f(_),u_frustum_tr:new t.Uniform3f(_),u_frustum_br:new t.Uniform3f(_),u_frustum_bl:new t.Uniform3f(_),u_horizon:new t.Uniform1f(_),u_transition:new t.Uniform1f(_),u_fadeout_range:new t.Uniform1f(_),u_color:new t.Uniform4f(_),u_high_color:new t.Uniform4f(_),u_space_color:new t.Uniform4f(_),u_star_intensity:new t.Uniform1f(_),u_star_density:new t.Uniform1f(_),u_star_size:new t.Uniform1f(_),u_temporal_offset:new t.Uniform1f(_),u_horizon_angle:new t.Uniform1f(_),u_rotation_matrix:new t.UniformMatrix4f(_)})};let uu;function wa(_,o,d,x,E,A,B){const O=_.context,G=O.gl,H=_.transform,X=_.useProgram("collisionBox"),oe=[];let ve=0,Ee=0;for(let Ge=0;Ge<x.length;Ge++){const rt=x[Ge],nt=o.getTile(rt),tt=nt.getBucket(d);if(!tt)continue;const gt=Po(rt,tt,H);let yt=gt;E[0]===0&&E[1]===0||(yt=_.translatePosMatrix(gt,nt,E,A));const kt=B?tt.textCollisionBox:tt.iconCollisionBox,yi=tt.collisionCircleArray;if(yi.length>0){const At=t.create(),Zt=yt;t.mul(At,tt.placementInvProjMatrix,H.glCoordMatrix),t.mul(At,At,tt.placementViewportMatrix),oe.push({circleArray:yi,circleOffset:Ee,transform:Zt,invTransform:At,projection:tt.getProjection()}),ve+=yi.length/4,Ee=ve}kt&&(_.terrain&&_.terrain.setupElevationDraw(nt,X),X.draw(O,G.LINES,t.DepthMode.disabled,t.StencilMode.disabled,_.colorModeForRenderPass(),t.CullFaceMode.disabled,Ku(yt,H,nt,tt.getProjection()),d.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,null,H.zoom,null,[kt.collisionVertexBuffer,kt.collisionVertexBufferExt]))}if(!B||!oe.length)return;const Ie=_.useProgram("collisionCircle"),Ce=new t.StructArrayLayout2f1f2i16;Ce.resize(4*ve),Ce._trim();let ze=0;for(const Ge of oe)for(let rt=0;rt<Ge.circleArray.length/4;rt++){const nt=4*rt,tt=Ge.circleArray[nt+0],gt=Ge.circleArray[nt+1],yt=Ge.circleArray[nt+2],kt=Ge.circleArray[nt+3];Ce.emplace(ze++,tt,gt,yt,kt,0),Ce.emplace(ze++,tt,gt,yt,kt,1),Ce.emplace(ze++,tt,gt,yt,kt,2),Ce.emplace(ze++,tt,gt,yt,kt,3)}(!uu||uu.length<2*ve)&&(uu=function(Ge){const rt=2*Ge,nt=new t.StructArrayLayout3ui6;nt.resize(rt),nt._trim();for(let tt=0;tt<rt;tt++){const gt=6*tt;nt.uint16[gt+0]=4*tt+0,nt.uint16[gt+1]=4*tt+1,nt.uint16[gt+2]=4*tt+2,nt.uint16[gt+3]=4*tt+2,nt.uint16[gt+4]=4*tt+3,nt.uint16[gt+5]=4*tt+0}return nt}(ve));const ae=O.createIndexBuffer(uu,!0),Me=O.createVertexBuffer(Ce,t.collisionCircleLayout.members,!0);for(const Ge of oe){const rt={u_matrix:Ge.transform,u_inv_matrix:Ge.invTransform,u_camera_to_center_distance:(Ue=H).getCameraToCenterDistance(Ge.projection),u_viewport_size:[Ue.width,Ue.height]};Ie.draw(O,G.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,_.colorModeForRenderPass(),t.CullFaceMode.disabled,rt,d.id,Me,ae,t.SegmentVector.simpleSegment(0,2*Ge.circleOffset,Ge.circleArray.length,Ge.circleArray.length/2),null,H.zoom)}var Ue;Me.destroy(),ae.destroy()}const Dh=t.create();function tc({width:_,height:o,anchor:d,textOffset:x,textScale:E},A){const{horizontalAlign:B,verticalAlign:O}=t.getAnchorAlignment(d),G=-(B-.5)*_,H=-(O-.5)*o,X=t.evaluateVariableOffset(d,x);return new t.Point((G/E+X[0])*A,(H/E+X[1])*A)}function hu(_,o,d,x,E,A,B,O,G,H,X){const oe=_.text.placedSymbolArray,ve=_.text.dynamicLayoutVertexArray,Ee=_.icon.dynamicLayoutVertexArray,Ie={},Ce=_.getProjection(),ze=Sn(O,Ce,A),ae=A.elevation,Me=Ce.upVectorScale(O.canonical,A.center.lat,A.worldSize).metersToTile;ve.clear();for(let Ue=0;Ue<oe.length;Ue++){const Ge=oe.get(Ue),{tileAnchorX:rt,tileAnchorY:nt,numGlyphs:tt}=Ge,gt=Ge.hidden||!Ge.crossTileID||_.allowVerticalPlacement&&!Ge.placedOrientation?null:x[Ge.crossTileID];if(gt){let yt=0,kt=0,yi=0;if(ae){const xi=ae?ae.getAtTileOffset(O,rt,nt):0,[or,vr,Xi]=Ce.upVector(O.canonical,rt,nt);yt=xi*or*Me,kt=xi*vr*Me,yi=xi*Xi*Me}let[At,Zt,Nt,mi]=En(Ge.projectedAnchorX+yt,Ge.projectedAnchorY+kt,Ge.projectedAnchorZ+yi,d?ze:B);const Ct=ln(A.getCameraToCenterDistance(Ce),mi);let ei=E.evaluateSizeForFeature(_.textSizeData,H,Ge)*Ct/t.ONE_EM;d&&(ei*=_.tilePixelRatio/G);const _i=tc(gt,ei);d?({x:At,y:Zt,z:Nt}=Ce.projectTilePoint(rt+_i.x,nt+_i.y,O.canonical),[At,Zt,Nt]=En(At+yt,Zt+kt,Nt+yi,B)):(o&&_i._rotate(-A.angle),At+=_i.x,Zt+=_i.y,Nt=0);const si=_.allowVerticalPlacement&&Ge.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let xi=0;xi<tt;xi++)t.addDynamicAttributes(ve,At,Zt,Nt,si);X&&Ge.associatedIconIndex>=0&&(Ie[Ge.associatedIconIndex]={x:At,y:Zt,z:Nt,angle:si})}else qs(tt,ve)}if(X){Ee.clear();const Ue=_.icon.placedSymbolArray;for(let Ge=0;Ge<Ue.length;Ge++){const rt=Ue.get(Ge),{numGlyphs:nt}=rt,tt=Ie[Ge];if(rt.hidden||!tt)qs(nt,Ee);else{const{x:gt,y:yt,z:kt,angle:yi}=tt;for(let At=0;At<nt;At++)t.addDynamicAttributes(Ee,gt,yt,kt,yi)}}_.icon.dynamicLayoutVertexBuffer.updateData(Ee)}_.text.dynamicLayoutVertexBuffer.updateData(ve)}function ls(_,o,d){return d.iconsInText&&o?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function Pc(_,o,d,x,E,A,B,O,G,H,X,oe){const ve=_.context,Ee=ve.gl,Ie=_.transform,Ce=O==="map",ze=G==="map",ae=Ce&&d.layout.get("symbol-placement")!=="point",Me=Ce&&!ze&&!ae,Ue=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ge=!1;const rt=_.depthModeForSublayer(0,t.DepthMode.ReadOnly),nt=[t.mercatorXfromLng(Ie.center.lng),t.mercatorYfromLat(Ie.center.lat)],tt=d.layout.get("text-variable-anchor"),gt=Ie.projection.name==="globe",yt=[],kt=[0,-1,0];let yi=kt;!gt&&!Ie.mercatorFromTransition||Ce||(yi=function(At){const Zt=At._camera.getWorldToCamera(At.worldSize,1),Nt=t.multiply([],Zt,At.globeMatrix);t.invert(Nt,Nt);const mi=[0,0,0],Ct=[0,1,0,0];return t.transformMat4$1(Ct,Ct,Nt),mi[0]=Ct[0],mi[1]=Ct[1],mi[2]=Ct[2],t.normalize(mi,mi),mi}(Ie));for(const At of x){const Zt=o.getTile(At),Nt=Zt.getBucket(d);if(!Nt||Nt.projection.name==="mercator"&&gt)continue;const mi=E?Nt.text:Nt.icon;if(!mi||Nt.fullyClipped||!mi.segments.get().length)continue;const Ct=mi.programConfigurations.get(d.id),ei=E||Nt.sdfIcons,_i=E?Nt.textSizeData:Nt.iconSizeData,si=ze||Ie.pitch!==0,xi=t.evaluateSizeForZoom(_i,Ie.zoom);let or,vr,Xi,cr,Zr=[0,0],Fr=null;if(E)vr=Zt.glyphAtlasTexture,Xi=Ee.LINEAR,or=Zt.glyphAtlasTexture.size,Nt.iconsInText&&(Zr=Zt.imageAtlasTexture.size,Fr=Zt.imageAtlasTexture,cr=si||_.options.rotating||_.options.zooming||_i.kind==="composite"||_i.kind==="camera"?Ee.LINEAR:Ee.NEAREST);else{const Ml=d.layout.get("icon-size").constantOr(0)!==1||Nt.iconsNeedLinear;vr=Zt.imageAtlasTexture,Xi=ei||_.options.rotating||_.options.zooming||Ml||si?Ee.LINEAR:Ee.NEAREST,or=Zt.imageAtlasTexture.size}const er=Nt.projection.name==="globe",pn=er?yi:kt,un=er?t.globeToMercatorTransition(Ie.zoom):0,kn=Sn(At,Nt.getProjection(),Ie),fn=Ie.calculatePixelsToTileUnitsMatrix(Zt),Lo=It(kn,Zt.tileID.canonical,ze,Ce,Ie,Nt.getProjection(),fn),go=_.terrain&&ze&&ae?t.invert(t.create(),Lo):Dh,Ma=Cr(kn,Zt.tileID.canonical,ze,Ce,Ie,Nt.getProjection(),fn),Sl=tt&&Nt.hasTextData(),Wr=d.layout.get("icon-text-fit")!=="none"&&Sl&&Nt.hasIconData();if(ae){const Ml=Ie.elevation,rc=Ml?Ml.getAtTileOffsetFunc(At,Ie.center.lat,Ie.worldSize,Nt.getProjection()):null,Oc=Tn(kn,Zt.tileID.canonical,ze,Ce,Ie,Nt.getProjection(),fn);eu(Nt,kn,_,E,Oc,Ma,ze,H,rc,At)}const jr=ae||E&&tt||Wr,an=_.translatePosMatrix(kn,Zt,A,B),lo=jr?Dh:Lo,Is=_.translatePosMatrix(Ma,Zt,A,B,!0),In=Nt.getProjection().createInversionMatrix(Ie,At.canonical),Ys=[];_.terrainRenderModeElevated()&&ze&&Ys.push("PITCH_WITH_MAP_TERRAIN"),er&&Ys.push("PROJECTION_GLOBE_VIEW"),jr&&Ys.push("PROJECTED_POS_ON_VIEWPORT");const Uh=ei&&d.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Bc;Bc=ei?Nt.iconsInText?zh(_i.kind,xi,Me,ze,_,an,lo,Is,or,Zr,At,un,nt,In,pn,Nt.getProjection()):gl(_i.kind,xi,Me,ze,_,an,lo,Is,E,or,!0,At,un,nt,In,pn,Nt.getProjection()):_l(_i.kind,xi,Me,ze,_,an,lo,Is,E,or,At,un,nt,In,pn,Nt.getProjection());const Fc={program:_.useProgram(ls(ei,E,Nt),Ct,Ys),buffers:mi,uniformValues:Bc,atlasTexture:vr,atlasTextureIcon:Fr,atlasInterpolation:Xi,atlasInterpolationIcon:cr,isSDF:ei,hasHalo:Uh,tile:Zt,labelPlaneMatrixInv:go};if(Ue&&Nt.canOverlap){Ge=!0;const Ml=mi.segments.get();for(const rc of Ml)yt.push({segments:new t.SegmentVector([rc]),sortKey:rc.sortKey,state:Fc})}else yt.push({segments:mi.segments,sortKey:0,state:Fc})}Ge&&yt.sort((At,Zt)=>At.sortKey-Zt.sortKey);for(const At of yt){const Zt=At.state;if(_.terrain&&_.terrain.setupElevationDraw(Zt.tile,Zt.program,{useDepthForOcclusion:!gt,labelPlaneMatrixInv:Zt.labelPlaneMatrixInv}),ve.activeTexture.set(Ee.TEXTURE0),Zt.atlasTexture.bind(Zt.atlasInterpolation,Ee.CLAMP_TO_EDGE),Zt.atlasTextureIcon&&(ve.activeTexture.set(Ee.TEXTURE1),Zt.atlasTextureIcon&&Zt.atlasTextureIcon.bind(Zt.atlasInterpolationIcon,Ee.CLAMP_TO_EDGE)),Zt.isSDF){const Nt=Zt.uniformValues;Zt.hasHalo&&(Nt.u_is_halo=1,zo(Zt.buffers,At.segments,d,_,Zt.program,rt,X,oe,Nt)),Nt.u_is_halo=0}zo(Zt.buffers,At.segments,d,_,Zt.program,rt,X,oe,Zt.uniformValues)}}function zo(_,o,d,x,E,A,B,O,G){const H=x.context,X=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.globeExtVertexBuffer];E.draw(H,H.gl.TRIANGLES,A,B,O,t.CullFaceMode.disabled,G,d.id,_.layoutVertexBuffer,_.indexBuffer,o,d.paint,x.transform.zoom,_.programConfigurations.get(d.id),X)}function m1(_,o,d,x,E,A,B){const O=_.context.gl,G=d.paint.get("fill-pattern"),H=G&&G.constantOr(1);let X,oe,ve,Ee,Ie;B?(oe=H&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=O.LINES):(oe=H?"fillPattern":"fill",X=O.TRIANGLES);for(const Ce of x){const ze=o.getTile(Ce);if(H&&!ze.patternsLoaded())continue;const ae=ze.getBucket(d);if(!ae)continue;_.prepareDrawTile();const Me=ae.programConfigurations.get(d.id),Ue=_.useProgram(oe,Me);H&&(_.context.activeTexture.set(O.TEXTURE0),ze.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Me.updatePaintBuffers());const Ge=G.constantOr(null);if(Ge&&ze.imageAtlas){const nt=ze.imageAtlas.patternPositions[Ge.toString()];nt&&Me.setConstantPatternPositions(nt)}const rt=_.translatePosMatrix(Ce.projMatrix,ze,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(B){Ee=ae.indexBuffer2,Ie=ae.segments2;const nt=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];ve=oe==="fillOutlinePattern"&&H?Xu(rt,_,ze,nt):Wu(rt,nt)}else Ee=ae.indexBuffer,Ie=ae.segments,ve=H?qu(rt,_,ze):Za(rt);_.prepareDrawProgram(_.context,Ue,Ce.toUnwrapped()),Ue.draw(_.context,X,E,_.stencilModeForClipping(Ce),A,t.CullFaceMode.disabled,ve,d.id,ae.layoutVertexBuffer,Ee,Ie,d.paint,_.transform.zoom,Me)}}function ua(_,o,d,x,E,A,B){const O=_.context,G=O.gl,H=_.transform,X=d.paint.get("fill-extrusion-pattern"),oe=X.constantOr(1),ve=d.paint.get("fill-extrusion-opacity"),Ee=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),d.paint.get("fill-extrusion-ambient-occlusion-radius")],Ie=d.layout.get("fill-extrusion-edge-radius"),Ce=Ie>0&&!d.paint.get("fill-extrusion-rounded-roof"),ze=Ce?0:Ie,ae=H.projection.name==="globe"?t.fillExtrusionHeightLift():0,Me=H.projection.name==="globe",Ue=Me?t.globeToMercatorTransition(H.zoom):0,Ge=[t.mercatorXfromLng(H.center.lng),t.mercatorYfromLat(H.center.lat)],rt=[];Me&&rt.push("PROJECTION_GLOBE_VIEW"),Ee[0]>0&&rt.push("FAUX_AO"),Ce&&rt.push("ZERO_ROOF_RADIUS");for(const nt of x){const tt=o.getTile(nt),gt=tt.getBucket(d);if(!gt||gt.projection.name!==H.projection.name)continue;const yt=gt.programConfigurations.get(d.id),kt=_.useProgram(oe?"fillExtrusionPattern":"fillExtrusion",yt,rt);if(_.terrain){const ei=_.terrain;if(_.style.terrainSetForDrapingOnly())ei.setupElevationDraw(tt,kt,{useMeterToDem:!0});else{if(!gt.enableTerrain)continue;if(ei.setupElevationDraw(tt,kt,{useMeterToDem:!0}),Lh(O,o,nt,gt,d,ei),!gt.centroidVertexBuffer){const _i=kt.attributes.a_centroid_pos;_i!==void 0&&G.vertexAttrib2f(_i,0,0)}}}oe&&(_.context.activeTexture.set(G.TEXTURE0),tt.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),yt.updatePaintBuffers());const yi=X.constantOr(null);if(yi&&tt.imageAtlas){const ei=tt.imageAtlas.patternPositions[yi.toString()];ei&&yt.setConstantPatternPositions(ei)}const At=_.translatePosMatrix(nt.projMatrix,tt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Zt=H.projection.createInversionMatrix(H,nt.canonical),Nt=d.paint.get("fill-extrusion-vertical-gradient"),mi=oe?Ic(At,_,Nt,ve,Ee,ze,nt,tt,ae,Ue,Ge,Zt):Yl(At,_,Nt,ve,Ee,ze,nt,ae,Ue,Ge,Zt);_.prepareDrawProgram(O,kt,nt.toUnwrapped());const Ct=[];_.terrain&&Ct.push(gt.centroidVertexBuffer),Me&&Ct.push(gt.layoutVertexExtBuffer),kt.draw(O,O.gl.TRIANGLES,E,A,B,t.CullFaceMode.backCCW,mi,d.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,d.paint,_.transform.zoom,yt,Ct)}}function Lh(_,o,d,x,E,A){const B=[ae=>{let Me=ae.canonical.x-1,Ue=ae.wrap;return Me<0&&(Me=(1<<ae.canonical.z)-1,Ue--),new t.OverscaledTileID(ae.overscaledZ,Ue,ae.canonical.z,Me,ae.canonical.y)},ae=>{let Me=ae.canonical.x+1,Ue=ae.wrap;return Me===1<<ae.canonical.z&&(Me=0,Ue++),new t.OverscaledTileID(ae.overscaledZ,Ue,ae.canonical.z,Me,ae.canonical.y)},ae=>new t.OverscaledTileID(ae.overscaledZ,ae.wrap,ae.canonical.z,ae.canonical.x,(ae.canonical.y===0?1<<ae.canonical.z:ae.canonical.y)-1),ae=>new t.OverscaledTileID(ae.overscaledZ,ae.wrap,ae.canonical.z,ae.canonical.x,ae.canonical.y===(1<<ae.canonical.z)-1?0:ae.canonical.y+1)],O=ae=>{const Me=o.getSource().minzoom,Ue=rt=>{const nt=o.getTileByID(rt);if(nt&&nt.hasData())return nt.getBucket(E)},Ge=[0,-1,1];for(const rt of Ge){if(ae.overscaledZ+rt<Me)continue;const nt=Ue(ae.calculateScaledKey(ae.overscaledZ+rt));if(nt)return nt}},G=[0,0,0],H=(ae,Me)=>(G[0]=Math.min(ae.min.y,Me.min.y),G[1]=Math.max(ae.max.y,Me.max.y),G[2]=t.EXTENT-Me.min.x>ae.max.x?Me.min.x-t.EXTENT:ae.max.x,G),X=(ae,Me)=>(G[0]=Math.min(ae.min.x,Me.min.x),G[1]=Math.max(ae.max.x,Me.max.x),G[2]=t.EXTENT-Me.min.y>ae.max.y?Me.min.y-t.EXTENT:ae.max.y,G),oe=[(ae,Me)=>H(ae,Me),(ae,Me)=>H(Me,ae),(ae,Me)=>X(ae,Me),(ae,Me)=>X(Me,ae)],ve=new t.Point(0,0);let Ee,Ie,Ce;const ze=(ae,Me,Ue,Ge,rt)=>{const nt=[[Ge?Ue:ae,Ge?ae:Ue,0],[Ge?Ue:Me,Ge?Me:Ue,0]],tt=rt<0?t.EXTENT+rt:rt,gt=[Ge?tt:(ae+Me)/2,Ge?(ae+Me)/2:tt,0];return Ue===0&&rt<0||Ue!==0&&rt>0?A.getForTilePoints(Ce,[gt],!0,Ie):nt.push(gt),A.getForTilePoints(d,nt,!0,Ee),Math.max(nt[0][2],nt[1][2],gt[2])/A.exaggeration()};for(let ae=0;ae<4;ae++){const Me=(ae<2?1:5)-ae,Ue=x.borders[ae];if(Ue.length===0)continue;const Ge=Ce=B[ae](d),rt=O(Ge);if(!(rt&&rt instanceof t.FillExtrusionBucket&&rt.enableTerrain)||x.borderDoneWithNeighborZ[ae]===rt.canonical.z&&rt.borderDoneWithNeighborZ[Me]===x.canonical.z||(Ie=A.findDEMTileFor(Ge),!Ie||!Ie.dem))continue;if(!Ee){const yt=A.findDEMTileFor(d);if(!yt||!yt.dem)return;Ee=yt}const nt=rt.borders[Me];let tt=0;const gt=rt.borderDoneWithNeighborZ[Me]!==x.canonical.z;if(x.canonical.z===rt.canonical.z){for(let yt=0;yt<Ue.length;yt++){const kt=x.featuresOnBorder[Ue[yt]],yi=kt.borders[ae];let At;for(;tt<nt.length&&(At=rt.featuresOnBorder[nt[tt]],!(At.borders[Me][1]>yi[0]+3));)gt&&rt.encodeCentroid(void 0,At,!1),tt++;if(At&&tt<nt.length){const Zt=tt;let Nt=0;for(;!(At.borders[Me][0]>yi[1]-3)&&(Nt++,++tt!==nt.length);)At=rt.featuresOnBorder[nt[tt]];if(At=rt.featuresOnBorder[nt[Zt]],kt.intersectsCount()>1||At.intersectsCount()>1||Nt!==1){Nt!==1&&(tt=Zt),x.encodeCentroid(void 0,kt,!1),gt&&rt.encodeCentroid(void 0,At,!1);continue}const mi=oe[ae](kt,At),Ct=ae%2?t.EXTENT-1:0;ve.x=ze(mi[0],Math.min(t.EXTENT-1,mi[1]),Ct,ae<2,mi[2]),ve.y=0,x.encodeCentroid(ve,kt,!1),gt&&rt.encodeCentroid(ve,At,!1)}else x.encodeCentroid(void 0,kt,!1)}x.borderDoneWithNeighborZ[ae]=rt.canonical.z,x.needsCentroidUpdate=!0,gt&&(rt.borderDoneWithNeighborZ[Me]=x.canonical.z,rt.needsCentroidUpdate=!0)}else{for(const yt of Ue)x.encodeCentroid(void 0,x.featuresOnBorder[yt],!1);if(gt){for(const yt of nt)rt.encodeCentroid(void 0,rt.featuresOnBorder[yt],!1);rt.borderDoneWithNeighborZ[Me]=x.canonical.z,rt.needsCentroidUpdate=!0}x.borderDoneWithNeighborZ[ae]=rt.canonical.z,x.needsCentroidUpdate=!0}}(x.needsCentroidUpdate||!x.centroidVertexBuffer&&x.centroidVertexArray.length!==0)&&x.uploadCentroid(_)}const Es=new t.Color(1,0,0,1),du=new t.Color(0,1,0,1),Rh=new t.Color(0,0,1,1),Td=new t.Color(1,0,1,1),Ed=new t.Color(0,1,1,1);function Qu(_,o,d){const x=_.context,E=_.transform,A=x.gl,B=E.projection.name==="globe",O=B?["PROJECTION_GLOBE_VIEW"]:null;let G=d.projMatrix;if(B&&t.globeToMercatorTransition(E.zoom)>0){const kt=t.transitionTileAABBinECEF(d.canonical,E),yi=t.globeDenormalizeECEF(kt);G=t.multiply(new Float32Array(16),E.globeMatrix,yi),t.multiply(G,E.projMatrix,G)}const H=_.useProgram("debug",null,O),X=o.getTileByID(d.key);_.terrain&&_.terrain.setupElevationDraw(X,H);const oe=t.DepthMode.disabled,ve=t.StencilMode.disabled,Ee=_.colorModeForRenderPass(),Ie="$debug";x.activeTexture.set(A.TEXTURE0),_.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),B?X._makeGlobeTileDebugBuffers(_.context,E):X._makeDebugTileBoundsBuffers(_.context,E.projection);const Ce=X._tileDebugBuffer||_.debugBuffer,ze=X._tileDebugIndexBuffer||_.debugIndexBuffer,ae=X._tileDebugSegments||_.debugSegments;H.draw(x,A.LINE_STRIP,oe,ve,Ee,t.CullFaceMode.disabled,ba(G,t.Color.red),Ie,Ce,ze,ae,null,null,null,[X._globeTileDebugBorderBuffer]);const Me=X.latestRawTileData,Ue=Math.floor((Me&&Me.byteLength||0)/1024),Ge=o.getTile(d).tileSize,rt=512/Math.min(Ge,512)*(d.overscaledZ/E.zoom)*.5;let nt=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(nt+=` => ${d.overscaledZ}`),nt+=` ${Ue}kb`,function(kt,yi){kt.initDebugOverlayCanvas();const At=kt.debugOverlayCanvas,Zt=kt.context.gl,Nt=kt.debugOverlayCanvas.getContext("2d");Nt.clearRect(0,0,At.width,At.height),Nt.shadowColor="white",Nt.shadowBlur=2,Nt.lineWidth=1.5,Nt.strokeStyle="white",Nt.textBaseline="top",Nt.font="bold 36px Open Sans, sans-serif",Nt.fillText(yi,5,5),Nt.strokeText(yi,5,5),kt.debugOverlayTexture.update(At),kt.debugOverlayTexture.bind(Zt.LINEAR,Zt.CLAMP_TO_EDGE)}(_,nt);const tt=X._tileDebugTextBuffer||_.debugBuffer,gt=X._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,yt=X._tileDebugTextSegments||_.debugSegments;H.draw(x,A.TRIANGLES,oe,ve,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,ba(G,t.Color.transparent,rt),Ie,tt,gt,yt,null,null,null,[X._globeTileDebugTextBuffer])}function kc(_,o,d,x){Gi(_,0,o+d/2,_.transform.width,d,x)}function Xs(_,o,d,x){Gi(_,o-d/2,0,d,_.transform.height,x)}function Gi(_,o,d,x,E,A){const B=_.context,O=B.gl;O.enable(O.SCISSOR_TEST),O.scissor(o*t.exported.devicePixelRatio,d*t.exported.devicePixelRatio,x*t.exported.devicePixelRatio,E*t.exported.devicePixelRatio),B.clear({color:A}),O.disable(O.SCISSOR_TEST)}const Bh=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:yl}=Bh;function Ko(_,o,d,x){_.emplaceBack(o,d,x)}class zc{constructor(o){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,Ko(this.vertexArray,-1,-1,1),Ko(this.vertexArray,1,-1,1),Ko(this.vertexArray,-1,1,1),Ko(this.vertexArray,1,1,1),Ko(this.vertexArray,-1,-1,-1),Ko(this.vertexArray,1,-1,-1),Ko(this.vertexArray,-1,1,-1),Ko(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,yl),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12)}}function Pi(_,o,d,x,E,A){const B=_.gl,O=o.paint.get("sky-atmosphere-color"),G=o.paint.get("sky-atmosphere-halo-color"),H=o.paint.get("sky-atmosphere-sun-intensity"),X=((oe,ve,Ee,Ie,Ce)=>({u_matrix_3f:oe,u_sun_direction:ve,u_sun_intensity:Ee,u_color_tint_r:[Ie.r,Ie.g,Ie.b,Ie.a],u_color_tint_m:[Ce.r,Ce.g,Ce.b,Ce.a],u_luminance:5e-5}))(t.fromMat4(t.create$1(),x),E,H,O,G);B.framebufferTexture2D(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_CUBE_MAP_POSITIVE_X+A,o.skyboxTexture,0),d.draw(_,B.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,X,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const xl=t.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class _1{constructor(o){const d=new t.StructArrayLayout5f20;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const x=new t.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(d,xl.members),this.indexBuffer=o.createIndexBuffer(x),this.segments=t.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Wa={symbol:function(_,o,d,x,E){if(_.renderPass!=="translucent")return;const A=t.StencilMode.disabled,B=_.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(O,G,H,X,oe,ve,Ee){const Ie=G.transform,Ce=oe==="map",ze=ve==="map";for(const ae of O){const Me=X.getTile(ae),Ue=Me.getBucket(H);if(!Ue||!Ue.text||!Ue.text.segments.get().length)continue;const Ge=t.evaluateSizeForZoom(Ue.textSizeData,Ie.zoom),rt=Sn(ae,Ue.getProjection(),Ie),nt=Ie.calculatePixelsToTileUnitsMatrix(Me),tt=It(rt,Me.tileID.canonical,ze,Ce,Ie,Ue.getProjection(),nt),gt=H.layout.get("icon-text-fit")!=="none"&&Ue.hasIconData();if(Ge){const yt=Math.pow(2,Ie.zoom-Me.tileID.overscaledZ);hu(Ue,Ce,ze,Ee,t.symbolSize,Ie,tt,ae,yt,Ge,gt)}}}(x,_,d,o,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),E),d.paint.get("icon-opacity").constantOr(1)!==0&&Pc(_,o,d,x,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),A,B),d.paint.get("text-opacity").constantOr(1)!==0&&Pc(_,o,d,x,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),A,B),o.map.showCollisionBoxes&&(wa(_,o,d,x,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),wa(_,o,d,x,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(_,o,d,x){if(_.renderPass!=="translucent")return;const E=d.paint.get("circle-opacity"),A=d.paint.get("circle-stroke-width"),B=d.paint.get("circle-stroke-opacity"),O=d.layout.get("circle-sort-key").constantOr(1)!==void 0;if(E.constantOr(1)===0&&(A.constantOr(1)===0||B.constantOr(1)===0))return;const G=_.context,H=G.gl,X=_.transform,oe=_.depthModeForSublayer(0,t.DepthMode.ReadOnly),ve=t.StencilMode.disabled,Ee=_.colorModeForRenderPass(),Ie=X.projection.name==="globe",Ce=[t.mercatorXfromLng(X.center.lng),t.mercatorYfromLat(X.center.lat)],ze=[];for(let Me=0;Me<x.length;Me++){const Ue=x[Me],Ge=o.getTile(Ue),rt=Ge.getBucket(d);if(!rt||rt.projection.name!==X.projection.name)continue;const nt=rt.programConfigurations.get(d.id),tt=lu(d);Ie&&tt.push("PROJECTION_GLOBE_VIEW");const gt=_.useProgram("circle",nt,tt),yt=rt.layoutVertexBuffer,kt=rt.globeExtVertexBuffer,yi=rt.indexBuffer,At=X.projection.createInversionMatrix(X,Ue.canonical),Zt={programConfiguration:nt,program:gt,layoutVertexBuffer:yt,globeExtVertexBuffer:kt,indexBuffer:yi,uniformValues:Hu(_,Ue,Ge,At,Ce,d),tile:Ge};if(O){const Nt=rt.segments.get();for(const mi of Nt)ze.push({segments:new t.SegmentVector([mi]),sortKey:mi.sortKey,state:Zt})}else ze.push({segments:rt.segments,sortKey:0,state:Zt})}O&&ze.sort((Me,Ue)=>Me.sortKey-Ue.sortKey);const ae={useDepthForOcclusion:!Ie};for(const Me of ze){const{programConfiguration:Ue,program:Ge,layoutVertexBuffer:rt,globeExtVertexBuffer:nt,indexBuffer:tt,uniformValues:gt,tile:yt}=Me.state,kt=Me.segments;_.terrain&&_.terrain.setupElevationDraw(yt,Ge,ae),_.prepareDrawProgram(G,Ge,yt.tileID.toUnwrapped()),Ge.draw(G,H.TRIANGLES,oe,ve,Ee,t.CullFaceMode.disabled,gt,d.id,rt,tt,kt,d.paint,X.zoom,Ue,[nt])}},heatmap:function(_,o,d,x){if(d.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const E=_.context,A=E.gl,B=t.StencilMode.disabled,O=new t.ColorMode([A.ONE,A.ONE],t.Color.transparent,[!0,!0,!0,!0]);(function(Ee,Ie,Ce,ze){const ae=Ee.gl,Me=Ie.width*ze,Ue=Ie.height*ze;Ee.activeTexture.set(ae.TEXTURE1),Ee.viewport.set([0,0,Me,Ue]);let Ge=Ce.heatmapFbo;if(!Ge||Ge&&(Ge.width!==Me||Ge.height!==Ue)){Ge&&Ge.destroy();const rt=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,rt),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),Ge=Ce.heatmapFbo=Ee.createFramebuffer(Me,Ue,!1),function(nt,tt,gt,yt,kt,yi){const At=nt.gl;At.texImage2D(At.TEXTURE_2D,0,nt.isWebGL2&&nt.extRenderToTextureHalfFloat?At.RGBA16F:At.RGBA,kt,yi,0,At.RGBA,nt.extRenderToTextureHalfFloat?nt.isWebGL2?At.HALF_FLOAT:nt.extTextureHalfFloat.HALF_FLOAT_OES:At.UNSIGNED_BYTE,null),yt.colorAttachment.set(gt)}(Ee,0,rt,Ge,Me,Ue)}else ae.bindTexture(ae.TEXTURE_2D,Ge.colorAttachment.get()),Ee.bindFramebuffer.set(Ge.framebuffer)})(E,_,d,_.transform.projection.name==="globe"?.5:.25),E.clear({color:t.Color.transparent});const G=_.transform,H=G.projection.name==="globe",X=H?["PROJECTION_GLOBE_VIEW"]:null,oe=H?t.CullFaceMode.frontCCW:t.CullFaceMode.disabled,ve=[t.mercatorXfromLng(G.center.lng),t.mercatorYfromLat(G.center.lat)];for(let Ee=0;Ee<x.length;Ee++){const Ie=x[Ee];if(o.hasRenderableParent(Ie))continue;const Ce=o.getTile(Ie),ze=Ce.getBucket(d);if(!ze||ze.projection.name!==G.projection.name)continue;const ae=ze.programConfigurations.get(d.id),Me=_.useProgram("heatmap",ae,X),{zoom:Ue}=_.transform;_.terrain&&_.terrain.setupElevationDraw(Ce,Me),_.prepareDrawProgram(E,Me,Ie.toUnwrapped());const Ge=G.projection.createInversionMatrix(G,Ie.canonical);Me.draw(E,A.TRIANGLES,t.DepthMode.disabled,B,O,oe,Jl(_,Ie,Ce,Ge,ve,Ue,d.paint.get("heatmap-intensity")),d.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,d.paint,_.transform.zoom,ae,H?[ze.globeExtVertexBuffer]:null)}E.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(E,A){const B=E.context,O=B.gl,G=A.heatmapFbo;if(!G)return;B.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,G.colorAttachment.get()),B.activeTexture.set(O.TEXTURE1);let H=A.colorRampTexture;H||(H=A.colorRampTexture=new t.Texture(B,A.colorRamp,O.RGBA)),H.bind(O.LINEAR,O.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(B,O.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,E.colorModeForRenderPass(),t.CullFaceMode.disabled,((X,oe,ve,Ee)=>({u_image:0,u_color_ramp:1,u_opacity:oe.paint.get("heatmap-opacity")}))(0,A),A.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,A.paint,E.transform.zoom)}(_,d))},line:function(_,o,d,x){if(_.renderPass!=="translucent")return;const E=d.paint.get("line-opacity"),A=d.paint.get("line-width");if(E.constantOr(1)===0||A.constantOr(1)===0)return;const B=_.depthModeForSublayer(0,t.DepthMode.ReadOnly),O=_.colorModeForRenderPass(),G=_.terrain&&_.terrain.renderingToTexture?1:t.exported.devicePixelRatio,H=d.paint.get("line-dasharray"),X=H.constantOr(1),oe=d.layout.get("line-cap"),ve=d.paint.get("line-pattern"),Ee=ve.constantOr(1),Ie=d.paint.get("line-gradient"),Ce=Ee?"linePattern":"line",ze=_.context,ae=ze.gl,Me=(Ge=>{const rt=[];qa(Ge)&&rt.push("RENDER_LINE_DASH"),Ge.paint.get("line-gradient")&&rt.push("RENDER_LINE_GRADIENT");const nt=Ge.paint.get("line-trim-offset");nt[0]===0&&nt[1]===0||rt.push("RENDER_LINE_TRIM_OFFSET");const tt=Ge.paint.get("line-pattern").constantOr(1),gt=Ge.paint.get("line-opacity").constantOr(1)!==1;return!tt&&gt&&rt.push("RENDER_LINE_ALPHA_DISCARD"),rt})(d);let Ue=Me.includes("RENDER_LINE_ALPHA_DISCARD");_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(Ue=!1);for(const Ge of x){const rt=o.getTile(Ge);if(Ee&&!rt.patternsLoaded())continue;const nt=rt.getBucket(d);if(!nt)continue;_.prepareDrawTile();const tt=nt.programConfigurations.get(d.id),gt=_.useProgram(Ce,tt,Me),yt=ve.constantOr(null);if(yt&&rt.imageAtlas){const ei=rt.imageAtlas.patternPositions[yt.toString()];ei&&tt.setConstantPatternPositions(ei)}const kt=H.constantOr(null),yi=oe.constantOr(null);if(!Ee&&kt&&yi&&rt.lineAtlas){const ei=rt.lineAtlas.getDash(kt,yi);ei&&tt.setConstantPatternPositions(ei)}let[At,Zt]=d.paint.get("line-trim-offset");(yi==="round"||yi==="square")&&At!==Zt&&(At===0&&(At-=1),Zt===1&&(Zt+=1));const Nt=_.terrain?Ge.projMatrix:null,mi=Ee?fl(_,rt,d,Nt,G):wd(_,rt,d,Nt,nt.lineClipsArray.length,G,[At,Zt]);if(Ie){const ei=nt.gradients[d.id];let _i=ei.texture;if(d.gradientVersion!==ei.version){let si=256;if(d.stepInterpolant){const xi=o.getSource().maxzoom,or=Ge.canonical.z===xi?Math.ceil(1<<_.transform.maxZoom-Ge.canonical.z):1;si=t.clamp(t.nextPowerOfTwo(nt.maxLineLength/t.EXTENT*1024*or),256,ze.maxTextureSize)}ei.gradient=t.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:si,image:ei.gradient||void 0,clips:nt.lineClipsArray}),ei.texture?ei.texture.update(ei.gradient):ei.texture=new t.Texture(ze,ei.gradient,ae.RGBA),ei.version=d.gradientVersion,_i=ei.texture}ze.activeTexture.set(ae.TEXTURE1),_i.bind(d.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}X&&(ze.activeTexture.set(ae.TEXTURE0),rt.lineAtlasTexture.bind(ae.LINEAR,ae.REPEAT),tt.updatePaintBuffers()),Ee&&(ze.activeTexture.set(ae.TEXTURE0),rt.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),tt.updatePaintBuffers()),_.prepareDrawProgram(ze,gt,Ge.toUnwrapped());const Ct=ei=>{gt.draw(ze,ae.TRIANGLES,B,ei,O,t.CullFaceMode.disabled,mi,d.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,d.paint,_.transform.zoom,tt,[nt.layoutVertexBuffer2])};if(Ue){const ei=_.stencilModeForClipping(Ge).ref;ei===0&&_.terrain&&ze.clear({stencil:0});const _i={func:ae.EQUAL,mask:255};mi.u_alpha_discard_threshold=.8,Ct(new t.StencilMode(_i,ei,255,ae.KEEP,ae.KEEP,ae.INVERT)),mi.u_alpha_discard_threshold=0,Ct(new t.StencilMode(_i,ei,255,ae.KEEP,ae.KEEP,ae.KEEP))}else Ct(_.stencilModeForClipping(Ge))}Ue&&(_.resetStencilClippingMasks(),_.terrain&&ze.clear({stencil:0}))},fill:function(_,o,d,x){const E=d.paint.get("fill-color"),A=d.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const B=_.colorModeForRenderPass(),O=d.paint.get("fill-pattern"),G=_.opaquePassEnabledForLayer()&&!O.constantOr(1)&&E.constantOr(t.Color.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===G){const H=_.depthModeForSublayer(1,_.renderPass==="opaque"?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);m1(_,o,d,x,H,B,!1)}if(_.renderPass==="translucent"&&d.paint.get("fill-antialias")){const H=_.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);m1(_,o,d,x,H,B,!0)}},"fill-extrusion":function(_,o,d,x){const E=d.paint.get("fill-extrusion-opacity");if(E!==0&&_.renderPass==="translucent"){const A=new t.DepthMode(_.context.gl.LEQUAL,t.DepthMode.ReadWrite,_.depthRangeFor3D);if(E!==1||d.paint.get("fill-extrusion-pattern").constantOr(1))ua(_,o,d,x,A,t.StencilMode.disabled,t.ColorMode.disabled),ua(_,o,d,x,A,_.stencilModeFor3D(),_.colorModeForRenderPass()),_.resetStencilClippingMasks();else{const B=_.colorModeForRenderPass();ua(_,o,d,x,A,t.StencilMode.disabled,B)}}},hillshade:function(_,o,d,x){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const E=_.context,A=_.depthModeForSublayer(0,t.DepthMode.ReadOnly),B=_.colorModeForRenderPass(),O=_.terrain&&_.terrain.renderingToTexture,[G,H]=_.renderPass!=="translucent"||O?[{},x]:_.stencilConfigForOverlap(x);for(const X of H){const oe=o.getTile(X);if(oe.needsHillshadePrepare&&_.renderPass==="offscreen")au(_,oe,d,A,t.StencilMode.disabled,B);else if(_.renderPass==="translucent"){const ve=O&&_.terrain?_.terrain.stencilModeForRTTOverlap(X):G[X.overscaledZ];kh(_,X,oe,d,A,ve,B)}}E.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,o,d,x,E,A){if(_.renderPass!=="translucent"||d.paint.get("raster-opacity")===0||!x.length)return;const B=_.context,O=B.gl,G=o.getSource(),H=_.useProgram("raster"),X=_.colorModeForRenderPass(),oe=_.terrain&&_.terrain.renderingToTexture,[ve,Ee]=G instanceof bt||oe?[{},x]:_.stencilConfigForOverlap(x),Ie=Ee[Ee.length-1].overscaledZ,Ce=!_.options.moving;for(const ze of Ee){const ae=oe?t.DepthMode.disabled:_.depthModeForSublayer(ze.overscaledZ-Ie,d.paint.get("raster-opacity")===1?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,O.LESS),Me=ze.toUnwrapped(),Ue=o.getTile(ze);if(oe&&(!Ue||!Ue.hasData()))continue;const Ge=oe?ze.projMatrix:_.transform.calculateProjMatrix(Me,Ce),rt=_.terrain&&oe?_.terrain.stencilModeForRTTOverlap(ze):ve[ze.overscaledZ],nt=A?0:d.paint.get("raster-fade-duration");Ue.registerFadeDuration(nt);const tt=o.findLoadedParent(ze,0),gt=Kl(Ue,tt,o,_.transform,nt);let yt,kt;_.terrain&&_.terrain.prepareDrawTile();const yi=d.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;B.activeTexture.set(O.TEXTURE0),Ue.texture.bind(yi,O.CLAMP_TO_EDGE),B.activeTexture.set(O.TEXTURE1),tt?(tt.texture.bind(yi,O.CLAMP_TO_EDGE),yt=Math.pow(2,tt.tileID.overscaledZ-Ue.tileID.overscaledZ),kt=[Ue.tileID.canonical.x*yt%1,Ue.tileID.canonical.y*yt%1]):Ue.texture.bind(yi,O.CLAMP_TO_EDGE),Ue.texture.useMipmap&&B.extTextureFilterAnisotropic&&_.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const At=cu(Ge,kt||[0,0],yt||1,gt,d,G instanceof bt?G.perspectiveTransform:[0,0]);if(_.prepareDrawProgram(B,H,Me),G instanceof bt)G.boundsBuffer&&G.boundsSegments&&H.draw(B,O.TRIANGLES,ae,t.StencilMode.disabled,X,t.CullFaceMode.disabled,At,d.id,G.boundsBuffer,_.quadTriangleIndexBuffer,G.boundsSegments);else{const{tileBoundsBuffer:Zt,tileBoundsIndexBuffer:Nt,tileBoundsSegments:mi}=_.getTileBoundsBuffers(Ue);H.draw(B,O.TRIANGLES,ae,rt,X,t.CullFaceMode.disabled,At,d.id,Zt,Nt,mi)}}_.resetStencilClippingMasks()},background:function(_,o,d,x){const E=d.paint.get("background-color"),A=d.paint.get("background-opacity");if(A===0)return;const B=_.context,O=B.gl,G=_.transform,H=G.tileSize,X=d.paint.get("background-pattern");if(_.isPatternMissing(X))return;const oe=!X&&E.a===1&&A===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==oe)return;const ve=t.StencilMode.disabled,Ee=_.depthModeForSublayer(0,oe==="opaque"?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),Ie=_.colorModeForRenderPass(),Ce=_.useProgram(X?"backgroundPattern":"background");let ze,ae=x;ae||(ze=_.getBackgroundTiles(),ae=Object.values(ze).map(Me=>Me.tileID)),X&&(B.activeTexture.set(O.TEXTURE0),_.imageManager.bind(_.context));for(const Me of ae){const Ue=Me.toUnwrapped(),Ge=x?Me.projMatrix:_.transform.calculateProjMatrix(Ue);_.prepareDrawTile();const rt=o?o.getTile(Me):ze?ze[Me.key]:new t.Tile(Me,H,G.zoom,_),nt=X?f1(Ge,A,_,X,{tileID:Me,tileSize:H}):ec(Ge,A,E);_.prepareDrawProgram(B,Ce,Ue);const{tileBoundsBuffer:tt,tileBoundsIndexBuffer:gt,tileBoundsSegments:yt}=_.getTileBoundsBuffers(rt);Ce.draw(B,O.TRIANGLES,Ee,ve,Ie,t.CullFaceMode.disabled,nt,d.id,tt,gt,yt)}},sky:function(_,o,d){const x=_.transform,E=x.projection.name==="mercator"||x.projection.name==="globe"?1:t.smoothstep(7,8,x.zoom),A=d.paint.get("sky-opacity")*E;if(A===0)return;const B=_.context,O=d.paint.get("sky-type"),G=new t.DepthMode(B.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),H=_.frameCounter/1e3%1;O==="atmosphere"?_.renderPass==="offscreen"?d.needsSkyboxCapture(_)&&(function(X,oe,ve,Ee){const Ie=X.context,Ce=Ie.gl;let ze=oe.skyboxFbo;if(!ze){ze=oe.skyboxFbo=Ie.createFramebuffer(32,32,!1),oe.skyboxGeometry=new zc(Ie),oe.skyboxTexture=Ie.gl.createTexture(),Ce.bindTexture(Ce.TEXTURE_CUBE_MAP,oe.skyboxTexture),Ce.texParameteri(Ce.TEXTURE_CUBE_MAP,Ce.TEXTURE_WRAP_S,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_CUBE_MAP,Ce.TEXTURE_WRAP_T,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_CUBE_MAP,Ce.TEXTURE_MIN_FILTER,Ce.LINEAR),Ce.texParameteri(Ce.TEXTURE_CUBE_MAP,Ce.TEXTURE_MAG_FILTER,Ce.LINEAR);for(let Ge=0;Ge<6;++Ge)Ce.texImage2D(Ce.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,Ce.RGBA,32,32,0,Ce.RGBA,Ce.UNSIGNED_BYTE,null)}Ie.bindFramebuffer.set(ze.framebuffer),Ie.viewport.set([0,0,32,32]);const ae=oe.getCenter(X,!0),Me=X.useProgram("skyboxCapture"),Ue=new Float64Array(16);t.identity(Ue),t.rotateY(Ue,Ue,.5*-Math.PI),Pi(Ie,oe,Me,Ue,ae,0),t.identity(Ue),t.rotateY(Ue,Ue,.5*Math.PI),Pi(Ie,oe,Me,Ue,ae,1),t.identity(Ue),t.rotateX(Ue,Ue,.5*-Math.PI),Pi(Ie,oe,Me,Ue,ae,2),t.identity(Ue),t.rotateX(Ue,Ue,.5*Math.PI),Pi(Ie,oe,Me,Ue,ae,3),t.identity(Ue),Pi(Ie,oe,Me,Ue,ae,4),t.identity(Ue),t.rotateY(Ue,Ue,Math.PI),Pi(Ie,oe,Me,Ue,ae,5),Ie.viewport.set([0,0,X.width,X.height])}(_,d),d.markSkyboxValid(_)):_.renderPass==="sky"&&function(X,oe,ve,Ee,Ie){const Ce=X.context,ze=Ce.gl,ae=X.transform,Me=X.useProgram("skybox");Ce.activeTexture.set(ze.TEXTURE0),ze.bindTexture(ze.TEXTURE_CUBE_MAP,oe.skyboxTexture);const Ue=((Ge,rt,nt,tt,gt)=>({u_matrix:Ge,u_sun_direction:rt,u_cubemap:0,u_opacity:tt,u_temporal_offset:gt}))(ae.skyboxMatrix,oe.getCenter(X,!1),0,Ee,Ie);X.prepareDrawProgram(Ce,Me),Me.draw(Ce,ze.TRIANGLES,ve,t.StencilMode.disabled,X.colorModeForRenderPass(),t.CullFaceMode.backCW,Ue,"skybox",oe.skyboxGeometry.vertexBuffer,oe.skyboxGeometry.indexBuffer,oe.skyboxGeometry.segment)}(_,d,G,A,H):O==="gradient"&&_.renderPass==="sky"&&function(X,oe,ve,Ee,Ie){const Ce=X.context,ze=Ce.gl,ae=X.transform,Me=X.useProgram("skyboxGradient");oe.skyboxGeometry||(oe.skyboxGeometry=new zc(Ce)),Ce.activeTexture.set(ze.TEXTURE0);let Ue=oe.colorRampTexture;Ue||(Ue=oe.colorRampTexture=new t.Texture(Ce,oe.colorRamp,ze.RGBA)),Ue.bind(ze.LINEAR,ze.CLAMP_TO_EDGE);const Ge=((rt,nt,tt,gt,yt)=>({u_matrix:rt,u_color_ramp:0,u_center_direction:nt,u_radius:t.degToRad(tt),u_opacity:gt,u_temporal_offset:yt}))(ae.skyboxMatrix,oe.getCenter(X,!1),oe.paint.get("sky-gradient-radius"),Ee,Ie);X.prepareDrawProgram(Ce,Me),Me.draw(Ce,ze.TRIANGLES,ve,t.StencilMode.disabled,X.colorModeForRenderPass(),t.CullFaceMode.backCW,Ge,"skyboxGradient",oe.skyboxGeometry.vertexBuffer,oe.skyboxGeometry.indexBuffer,oe.skyboxGeometry.segment)}(_,d,G,A,H)},debug:function(_,o,d){for(let x=0;x<d.length;x++)Qu(_,o,d[x])},custom:function(_,o,d,x){const E=_.context,A=d.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||_.renderPass==="offscreen")&&d.isLayerDraped()){if(_.renderPass==="offscreen"){const B=A.prerender;if(B){if(_.setCustomLayerDefaults(),E.setColorMode(_.colorModeForRenderPass()),_.transform.projection.name==="globe"){const O=_.transform.pointMerc;B.call(A,E.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),t.globeToMercatorTransition(_.transform.zoom),[O.x,O.y],_.transform.pixelsPerMeterRatio)}else B.call(A,E.gl,_.transform.customLayerMatrix());E.setDirty(),_.setBaseState()}}else if(_.renderPass==="translucent"){if(_.terrain&&_.terrain.renderingToTexture){const O=A.renderToTile;if(O){const G=x[0].canonical,H=new t.MercatorCoordinate(G.x+x[0].wrap*(1<<G.z),G.y,G.z);E.setDepthMode(t.DepthMode.disabled),E.setStencilMode(t.StencilMode.disabled),E.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),O.call(A,E.gl,H),E.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),E.setColorMode(_.colorModeForRenderPass()),E.setStencilMode(t.StencilMode.disabled);const B=A.renderingMode==="3d"?new t.DepthMode(_.context.gl.LEQUAL,t.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,t.DepthMode.ReadOnly);if(E.setDepthMode(B),_.transform.projection.name==="globe"){const O=_.transform.pointMerc;A.render(E.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),t.globeToMercatorTransition(_.transform.zoom),[O.x,O.y],_.transform.pixelsPerMeterRatio)}else A.render(E.gl,_.transform.customLayerMatrix());E.setDirty(),_.setBaseState(),E.bindFramebuffer.set(null)}}else t.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class vl{constructor(o,d,x=!1){this.context=new gi(o,x),this.transform=d,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,d){const x=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Zu(this,o));const E=this._terrain;this.transform.elevation=x?E:null,E.update(o,this.transform,d)}_updateFog(o){const d=o.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,E]=d.getFovAdjustedRange(this.transform._fov);if(x>E)return void(this.transform.fogCullDistSq=null);const A=x+.78*(E-x);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,d){if(this.width=o*t.exported.devicePixelRatio,this.height=d*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._layers[x].resize()}setup(){const o=this.context,d=new t.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(t.EXTENT,0),d.emplaceBack(0,t.EXTENT),d.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(d,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const x=new t.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(t.EXTENT,0),x.emplaceBack(0,t.EXTENT),x.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=o.createVertexBuffer(x,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const E=new t.StructArrayLayout2i4;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(-1,1),E.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(E,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const A=new t.StructArrayLayout4i8;A.emplaceBack(0,0,0,0),A.emplaceBack(t.EXTENT,0,t.EXTENT,0),A.emplaceBack(0,t.EXTENT,0,t.EXTENT),A.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(A,t.boundsAttributes.members),this.mercatorBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const B=new t.StructArrayLayout3ui6;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(B);const O=new t.StructArrayLayout1ui2;for(const H of[0,1,3,2,0])O.emplaceBack(H);this.debugIndexBuffer=o.createIndexBuffer(O),this.emptyTexture=new t.Texture(o,new t.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=t.create();const G=this.context.gl;this.stencilClearMode=new t.StencilMode({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.loadTimeStamps.push(t.window.performance.now()),this.atmosphereBuffer=new _1(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,d.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,Mn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,d,x){if(!d||this.currentStencilSource===d.id||!o.isTileClipped()||!x||x.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const G of x)if(this._tileClippingMaskIDs[G.key]===void 0){O=!0;break}if(!O)return}this.currentStencilSource=d.id;const E=this.context,A=E.gl;this.nextStencilID+x.length>256&&this.clearStencil(),E.setColorMode(t.ColorMode.disabled),E.setDepthMode(t.DepthMode.disabled);const B=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of x){const G=d.getTile(O),H=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:X,tileBoundsIndexBuffer:oe,tileBoundsSegments:ve}=this.getTileBoundsBuffers(G);B.draw(E,A.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:A.ALWAYS,mask:0},H,255,A.KEEP,A.KEEP,A.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Mn(O.projMatrix),"$clipping",X,oe,ve)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new t.StencilMode({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const d=this.context.gl;return new t.StencilMode({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,x=o.sort((B,O)=>O.overscaledZ-B.overscaledZ),E=x[x.length-1].overscaledZ,A=x[0].overscaledZ-E+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const B={};for(let O=0;O<A;O++)B[O+E]=new t.StencilMode({func:d.GEQUAL,mask:255},O+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=A,[B,x]}return[{[E]:t.StencilMode.disabled},x]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new t.ColorMode([o.CONSTANT_COLOR,o.ONE],new t.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(o,d,x){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new t.DepthMode(x||this.context.gl.LEQUAL,d,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){this.style=o,this.options=d,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const x=this.style.order,E=this.style._sourceCaches;for(const H in E){const X=E[H];X.used&&X.prepare(this.context)}const A={},B={},O={};for(const H in E){const X=E[H];A[H]=X.getVisibleCoordinates(),B[H]=A[H].slice().reverse(),O[H]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<x.length;H++)if(this.style._layers[x[H]].is3D()){this.opaquePassCutoff=H;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new t.GlobeSharedBuffers(this.context)),!t.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const H of x){const X=this.style._layers[H],oe=o._getLayerSourceCache(X);if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const ve=oe?B[oe.id]:void 0;(X.type==="custom"||X.isSky()||ve&&ve.length)&&this.renderLayer(this,oe,X,ve)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon];const G=this.terrain;if(G&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&G.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:d.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[x[this.currentLayer]],X=o._getLayerSourceCache(H);if(H.isSky())continue;const oe=X?B[X.id]:void 0;this._renderTileClippingMasks(H,X,oe),this.renderLayer(this,X,H,oe)}if(this.style.fog&&this.transform.projection.supportsFog&&function(H,X){const oe=H.context,ve=oe.gl,Ee=H.transform,Ie=new t.DepthMode(ve.LEQUAL,t.DepthMode.ReadOnly,[0,1]),Ce=H.useProgram("globeAtmosphere",null,Ee.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ze=t.globeToMercatorTransition(Ee.zoom),ae=X.properties.get("color").toArray01(),Me=X.properties.get("high-color").toArray01(),Ue=X.properties.get("space-color").toArray01PremultipliedAlpha(),Ge=t.identity$1([]);t.rotateY$1(Ge,Ge,-t.degToRad(Ee._center.lng)),t.rotateX$1(Ge,Ge,t.degToRad(Ee._center.lat)),t.rotateZ$1(Ge,Ge,Ee.angle),t.rotateX$1(Ge,Ge,-Ee._pitch);const rt=t.fromQuat(new Float32Array(16),Ge),nt=t.mapValue(X.properties.get("star-intensity"),0,1,0,.25),tt=5e-4,gt=t.mapValue(X.properties.get("horizon-blend"),0,1,tt,.25),yt=t.globeUseCustomAntiAliasing(H,oe,Ee)&&gt===tt?Ee.worldSize/(2*Math.PI*1.025)-1:Ee.globeRadius,kt=H.frameCounter/1e3%1,yi=t.length(Ee.globeCenterInViewSpace),At=Math.sqrt(Math.pow(yi,2)-Math.pow(yt,2)),Zt=Math.acos(At/yi),Nt=((Ct,ei,_i,si,xi,or,vr,Xi,cr,Zr,Fr,er,pn,un)=>({u_frustum_tl:Ct,u_frustum_tr:ei,u_frustum_br:_i,u_frustum_bl:si,u_horizon:xi,u_transition:or,u_fadeout_range:vr,u_color:Xi,u_high_color:cr,u_space_color:Zr,u_star_intensity:Fr,u_star_size:5*t.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:er,u_horizon_angle:pn,u_rotation_matrix:un}))(Ee.frustumCorners.TL,Ee.frustumCorners.TR,Ee.frustumCorners.BR,Ee.frustumCorners.BL,Ee.frustumCorners.horizon,ze,gt,ae,Me,Ue,nt,kt,Zt,rt);H.prepareDrawProgram(oe,Ce);const mi=H.atmosphereBuffer;mi&&Ce.draw(oe,ve.TRIANGLES,Ie,t.StencilMode.disabled,t.ColorMode.alphaBlended,t.CullFaceMode.backCW,Nt,"skybox",mi.vertexBuffer,mi.indexBuffer,mi.segments)}(this,this.style.fog),this.renderPass="sky",(t.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const H=this.style._layers[x[this.currentLayer]],X=o._getLayerSourceCache(H);H.isSky()&&this.renderLayer(this,X,H,X?B[X.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;){const H=this.style._layers[x[this.currentLayer]],X=o._getLayerSourceCache(H);if(H.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(H)){if(H.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const oe=X?(H.type==="symbol"?O:B)[X.id]:void 0;this._renderTileClippingMasks(H,X,X?A[X.id]:void 0),this.renderLayer(this,X,H,oe),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let H=null;t.values(this.style._layers).forEach(X=>{const oe=o._getLayerSourceCache(X);oe&&!X.isHidden(this.transform.zoom)&&(!H||H.getSource().maxzoom<oe.getSource().maxzoom)&&(H=oe)}),H&&this.options.showTileBoundaries&&Wa.debug(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const X=H.transform.padding;kc(H,H.transform.height-(X.top||0),3,Es),kc(H,X.bottom||0,3,du),Xs(H,X.left||0,3,Rh),Xs(H,H.transform.width-(X.right||0),3,Td);const oe=H.transform.centerPoint;(function(ve,Ee,Ie,Ce){Gi(ve,Ee-1,Ie-10,2,20,Ce),Gi(ve,Ee-10,Ie-1,20,2,Ce)})(H,oe.x,H.transform.height-oe.y,Ed)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,d,x,E){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="sky"||x.type==="custom"||E&&E.length)&&(this.id=x.id,this.gpuTimingStart(x),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(x.type)||o.terrain&&x.type==="custom")&&Wa[x.type](o,d,x,E,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;let x=this.gpuTimers[o.id];x||(x=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),x.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,d=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(d),o.beginQueryEXT(o.TIME_ELAPSED_EXT,d)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const d={};for(const x in o){const E=o[x],A=this.context.extTimerQuery,B=A.getQueryObjectEXT(E.query,A.QUERY_RESULT_EXT)/1e6;A.deleteQueryEXT(E.query),d[x]=B}return d}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.extTimerQuery;let x=0;for(const E of o)x+=d.getQueryObjectEXT(E,d.QUERY_RESULT_EXT)/1e6,d.deleteQueryEXT(E);return x}translatePosMatrix(o,d,x,E,A){if(!x[0]&&!x[1])return o;const B=A?E==="map"?this.transform.angle:0:E==="viewport"?-this.transform.angle:0;if(B){const H=Math.sin(B),X=Math.cos(B);x=[x[0]*X-x[1]*H,x[0]*H+x[1]*X]}const O=[A?x[0]:Wi(d,x[0],this.transform.zoom),A?x[1]:Wi(d,x[1],this.transform.zoom),0],G=new Float32Array(16);return t.translate(G,o,O),G}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){return o===null||o!==void 0&&!this.imageManager.getPattern(o.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,d=this.terrain&&this.terrain.exaggeration()===0,x=this.style&&this.style.fog,E=[];return this.terrainRenderModeElevated()&&E.push("TERRAIN"),this.transform.projection.name==="globe"&&E.push("GLOBE"),d&&E.push("ZERO_EXAGGERATION"),x&&!o&&x.getOpacity(this.transform.pitch)!==0&&E.push("FOG"),o&&E.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&E.push("OVERDRAW_INSPECTOR"),E}useProgram(o,d,x){this.cache=this.cache||{};const E=x||[],A=this.currentGlobalDefines().concat(E),B=Kr.cacheKey(su[o],o,A,d);return this.cache[B]||(this.cache[B]=new Kr(this.context,o,su[o],d,Ju[o],A)),this.cache[B]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,d,x){if(this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const A=E.getOpacity(this.transform.pitch),B=((O,G,H,X,oe,ve,Ee,Ie,Ce,ze,ae)=>{const Me=O.transform,Ue=G.properties.get("color").toArray01();Ue[3]=X;const Ge=O.frameCounter/1e3%1;return{u_fog_matrix:H?Me.calculateFogTileMatrix(H):O.identityMat,u_fog_range:G.getFovAdjustedRange(Me._fov),u_fog_color:Ue,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_temporal_offset:Ge,u_frustum_tl:oe,u_frustum_tr:ve,u_frustum_br:Ee,u_frustum_bl:Ie,u_globe_pos:Ce,u_globe_radius:ze,u_viewport:ae,u_globe_transition:t.globeToMercatorTransition(Me.zoom),u_is_globe:+(Me.projection.name==="globe")}})(this,E,x,A,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*t.exported.devicePixelRatio,this.transform.height*t.exported.devicePixelRatio]);d.setFogUniformValues(o,B)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,d=o.createTexture();return o.bindTexture(o.TEXTURE_2D,d),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,d=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const E of x)d[E.key]=o[E.key]||new t.Tile(E,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}}class pu{constructor(o=0,d=0,x=0,E=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(x)||x<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=x,this.right=E}interpolate(o,d,x){return d.top!=null&&o.top!=null&&(this.top=t.number(o.top,d.top,x)),d.bottom!=null&&o.bottom!=null&&(this.bottom=t.number(o.bottom,d.bottom,x)),d.left!=null&&o.left!=null&&(this.left=t.number(o.left,d.left,x)),d.right!=null&&o.right!=null&&(this.right=t.number(o.right,d.right,x)),this}getCenter(o,d){const x=t.clamp((this.left+o-this.right)/2,0,o),E=t.clamp((this.top+d-this.bottom)/2,0,d);return new t.Point(x,E)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new pu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function fu(_,o){const d=t.getColumn(_,3);t.fromQuat(_,o),t.setColumn(_,3,d)}function tn(_,o){const d=t.identity$1([]);return t.rotateZ$1(d,d,-o),t.rotateX$1(d,d,-_),d}function Dc(_,o){const d=[_[0],_[1],0],x=[o[0],o[1],0];if(t.length(d)>=1e-15){const B=t.normalize([],d);t.scale$2(x,B,t.dot(x,B)),o[0]=x[0],o[1]=x[1]}const E=t.cross([],o,_);if(t.len(E)<1e-15)return null;const A=Math.atan2(-E[1],E[0]);return tn(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),A)}class eh{constructor(o,d){this.position=o,this.orientation=d}get position(){return this._position}set position(o){if(o){const d=o instanceof t.MercatorCoordinate?o:new t.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(d.x=t.wrap(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(o,d){if(this.orientation=null,!this.position)return;const x=this.position,E=this._elevation?this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(o)):0,A=t.MercatorCoordinate.fromLngLat(o,E),B=[A.x-x.x,A.y-x.y,A.z-x.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Dc(B,d)}setPitchBearing(o,d){this.orientation=tn(t.degToRad(o),t.degToRad(-d))}}class Lc{constructor(o,d){this._transform=t.identity([]),this.orientation=d,this.position=o}get mercatorPosition(){const o=this.position;return new t.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=t.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var d;o&&t.setColumn(this._transform,3,[(d=o)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||t.identity$1([]),o&&fu(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,d){this._orientation=tn(o,d),fu(this._transform,this._orientation)}forward(){const o=t.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=t.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=t.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,d){const x=new Float64Array(16);return t.invert(x,this.getWorldToCamera(o,d)),x}getWorldToCameraPosition(o,d,x){const E=this.position;t.scale$2(E,E,-o);const A=new Float64Array(16);return t.fromScaling(A,[x,x,x]),t.translate(A,A,E),A[10]*=d,A}getWorldToCamera(o,d){const x=new Float64Array(16),E=new Float64Array(4),A=this.position;return t.conjugate(E,this._orientation),t.scale$2(A,A,-o),t.fromQuat(x,E),t.translate(x,x,A),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=d,x[9]*=d,x[10]*=d,x[11]*=d,x}getCameraToClipPerspective(o,d,x,E){const A=new Float64Array(16);return t.perspective(A,o,d,x,E),A}getDistanceToElevation(o,d=!1){const x=o===0?0:t.mercatorZfromAltitude(o,d?t.latFromMercatorY(this.position[1]):this.position[1]),E=this.forward();return(x-this.position[2])/E[2]}clone(){return new Lc([...this.position],[...this.orientation])}}function bl(_,o){const d=Do(_.projection,_.zoom,_.width,_.height),x=function(A,B,O,G,H){const X=new t.LngLat(O.lng-180*Yo,O.lat),oe=new t.LngLat(O.lng+180*Yo,O.lat),ve=A.project(X.lng,X.lat),Ee=A.project(oe.lng,oe.lat),Ie=-Math.atan2(Ee.y-ve.y,Ee.x-ve.x),Ce=t.MercatorCoordinate.fromLngLat(O);Ce.y=t.clamp(Ce.y,-1+Yo,1-Yo);const ze=Ce.toLngLat(),ae=A.project(ze.lng,ze.lat),Me=t.MercatorCoordinate.fromLngLat(ze);Me.x+=Yo;const Ue=Me.toLngLat(),Ge=A.project(Ue.lng,Ue.lat),rt=Xa(Ge.x-ae.x,Ge.y-ae.y,Ie),nt=t.MercatorCoordinate.fromLngLat(ze);nt.y+=Yo;const tt=nt.toLngLat(),gt=A.project(tt.lng,tt.lat),yt=Xa(gt.x-ae.x,gt.y-ae.y,Ie),kt=Math.abs(rt.x)/Math.abs(yt.y),yi=t.identity([]);t.rotateZ(yi,yi,-Ie*(1-(H?0:G)));const At=t.identity([]);return t.scale(At,At,[1,1-(1-kt)*G,1]),At[4]=-yt.x/yt.y*G,t.rotateZ(At,At,Ie),t.multiply(At,yi,At),At}(_.projection,0,_.center,d,o),E=th(_);return t.scale(x,x,[E,E,1]),x}function th(_){const o=_.projection,d=Do(_.projection,_.zoom,_.width,_.height),x=Fh(o,_.center),E=Fh(o,t.LngLat.convert(o.center));return Math.pow(2,x*d+(1-d)*E)}function Do(_,o,d,x,E=1/0){const A=_.range;if(!A)return 0;const B=Math.min(E,Math.max(d,x)),O=Math.log(B/1024)/Math.LN2;return t.smoothstep(A[0]+O,A[1]+O,o)}const Yo=1/4e4;function Fh(_,o){const d=t.clamp(o.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),x=new t.LngLat(o.lng-180*Yo,d),E=new t.LngLat(o.lng+180*Yo,d),A=_.project(x.lng,d),B=_.project(E.lng,d),O=t.MercatorCoordinate.fromLngLat(x),G=t.MercatorCoordinate.fromLngLat(E),H=B.x-A.x,X=B.y-A.y,oe=G.x-O.x,ve=G.y-O.y,Ee=Math.sqrt((oe*oe+ve*ve)/(H*H+X*X));return Math.log(Ee)/Math.LN2}function Xa(_,o,d){const x=Math.cos(d),E=Math.sin(d);return{x:_*x-o*E,y:_*E+o*x}}class wl{constructor(o,d,x,E,A,B,O){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=x??0,this._maxPitch=E??60,this.setProjection(B),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new pu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Lc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new wl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o,d=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||x)&&this._updateCameraOnTerrain(),(o||x)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return t.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=t.getProjection(this.projectionOptions);const x=!j(d,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=t.getProjection({name:"mercator"});const d=o!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return t.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.Point(this.width,this.height)}get bearing(){return t.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const d=-o*Math.PI/180;var x;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(x=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x),function(E,A,B){var O=A[0],G=A[1],H=A[2],X=A[3],oe=Math.sin(B),ve=Math.cos(B);E[0]=O*ve+H*oe,E[1]=G*ve+X*oe,E[2]=O*-oe+H*ve,E[3]=G*-oe+X*ve}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=t.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=t.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let E=0,A=0;for(let B=0;B<d.length;B++){const O=new t.Point(d[B][0]*this.width,x+d[B][1]*(this.height-x)),G=o.pointCoordinate(O);if(!G)continue;const H=1/Math.hypot(G[0]-this._camera.position[0],G[1]-this._camera.position[1]);E+=G[3]*H,A+=H}return A===0?NaN:E/A}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*d,E=this._mercatorZfromZoom(o),A=this._mercatorZfromZoom(this._maxZoom),B=Math.max(E-x,A);this._setZoom(this._zoomFromMercatorZ(B))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let x;x=o.z<this._camera.position[2]?[d.x,d.y,d.z]:[o.x,o.y,o.z];const E=t.length(t.sub([],this._camera.position,x));return t.clamp(this._zoomFromMercatorZ(E),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let d=!1;if(o.orientation&&!t.exactEquals(o.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(o.orientation)),o.position){const x=[o.position.x,o.position.y,o.position.z];t.exactEquals$1(x,this._camera.position)||(this._setCameraPosition(x),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,d=new eh;return d.position=new t.MercatorCoordinate(o[0],o[1],o[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(o){if(!t.length$1(o))return!1;t.normalize$1(o,o);const d=t.transformQuat([],[0,0,-1],o),x=t.transformQuat([],[0,-1,0],o);if(x[2]<0)return!1;const E=Dc(d,x);return!!E&&(this._camera.orientation=E,!0)}_setCameraPosition(o){const d=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,E=this.cameraToCenterDistance;o[2]=t.clamp(o[2],E/x,E/d),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,x){this._unmodified=!1,this._edgeInsets.interpolate(o,d,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new t.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const x=this.pointCoordinate(new t.Point(0,0)),E=this.pointCoordinate(new t.Point(this.width,0)),A=this.pointCoordinate(new t.Point(this.width,this.height)),B=this.pointCoordinate(new t.Point(0,this.height)),O=Math.floor(Math.min(x.x,E.x,A.x,B.x)),G=Math.floor(Math.max(x.x,E.x,A.x,B.x)),H=1;for(let X=O-H;X<=G+H;X++)X!==0&&d.push(new t.UnwrappedTileID(X,o))}return d}coveringTiles(o){let d=this.coveringZoomLevel(o);const x=d,E=this.elevation&&!o.isTerrainDEM,A=this.projection.name==="mercator";if(o.minzoom!==void 0&&d<o.minzoom)return[];o.maxzoom!==void 0&&d>o.maxzoom&&(d=o.maxzoom);const B=this.locationCoordinate(this.center),O=this.center.lat,G=1<<d,H=[G*B.x,G*B.y,0],X=this.projection.name==="globe",oe=!X,ve=t.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,oe),Ee=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ie=G*t.mercatorZfromAltitude(1,this.center.lat),Ce=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),ze=[G*Ee.x,G*Ee.y,Ce*(oe?1:Ie)],ae=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),Me=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?d:0,Ue=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ge=o.isTerrainDEM?-Ue:this._elevation?this._elevation.getMinElevationBelowMSL():0,rt=this.projection.isReprojectedInTileSpace?th(this):1,nt=Ct=>{const _i=new t.MercatorCoordinate(Ct.x+25e-6,Ct.y,Ct.z),si=new t.MercatorCoordinate(Ct.x,Ct.y+25e-6,Ct.z),xi=Ct.toLngLat(),or=_i.toLngLat(),vr=si.toLngLat(),Xi=this.locationCoordinate(xi),cr=this.locationCoordinate(or),Zr=this.locationCoordinate(vr),Fr=Math.hypot(cr.x-Xi.x,cr.y-Xi.y),er=Math.hypot(Zr.x-Xi.x,Zr.y-Xi.y);return Math.sqrt(Fr*er)*rt/25e-6},tt=Ct=>{const ei=Ue,_i=Ge;return{aabb:t.tileAABB(this,G,0,0,0,Ct,_i,ei,this.projection),zoom:0,x:0,y:0,minZ:_i,maxZ:ei,wrap:Ct,fullyVisible:!1}},gt=[];let yt=[];const kt=d,yi=o.reparseOverscaled?x:d,At=Ct=>Ct*Ct,Zt=At((Ce-this._centerAltitude)*Ie),Nt=Ct=>{if(!this._elevation||!Ct.tileID||!A)return;const ei=this._elevation.getMinMaxForTile(Ct.tileID),_i=Ct.aabb;ei?(_i.min[2]=ei.min,_i.max[2]=ei.max,_i.center[2]=(_i.min[2]+_i.max[2])/2):(Ct.shouldSplit=mi(Ct),Ct.shouldSplit||(_i.min[2]=_i.max[2]=_i.center[2]=this._centerAltitude))},mi=Ct=>{if(Ct.zoom<Me)return!0;if(Ct.zoom===kt)return!1;if(Ct.shouldSplit!=null)return Ct.shouldSplit;const ei=Ct.aabb.distanceX(ze),_i=Ct.aabb.distanceY(ze);let si=Zt,xi=1;if(X){si=At(Ct.aabb.distanceZ(ze));const Xi=Math.pow(2,Ct.zoom),cr=t.latFromMercatorY((Ct.y+1)/Xi),Zr=t.latFromMercatorY(Ct.y/Xi),Fr=Math.min(Math.max(O,cr),Zr),er=t.circumferenceAtLatitude(Fr)/t.circumferenceAtLatitude(O);if(xi=Fr===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,er/this._mercatorScaleRatio),this.zoom<=t.GLOBE_ZOOM_THRESHOLD_MIN&&Ct.zoom===kt-1&&er>=.9)return!0}else if(E&&(si=At(Ct.aabb.distanceZ(ze)*Ie)),this.projection.isReprojectedInTileSpace&&x<=5){const Xi=Math.pow(2,Ct.zoom),cr=nt(new t.MercatorCoordinate((Ct.x+.5)/Xi,(Ct.y+.5)/Xi));xi=cr>.85?1:cr}const or=ei*ei+_i*_i+si,vr=At((1<<kt-Ct.zoom)*ae*xi*((Xi,cr)=>{if(cr*At(.707)<Xi)return 1;const Zr=Math.sqrt(cr/Xi);return Zr/(1.4144271570014144+(Math.pow(1.1,Zr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(si,Zt),or));return or<vr};if(this.renderWorldCopies)for(let Ct=1;Ct<=3;Ct++)gt.push(tt(-Ct)),gt.push(tt(Ct));for(gt.push(tt(0));gt.length>0;){const Ct=gt.pop(),ei=Ct.x,_i=Ct.y;let si=Ct.fullyVisible;if(!si){const xi=Ct.aabb.intersects(ve);if(xi===0)continue;si=xi===2}if(Ct.zoom!==kt&&mi(Ct))for(let xi=0;xi<4;xi++){const or=(ei<<1)+xi%2,vr=(_i<<1)+(xi>>1),Xi={aabb:A?Ct.aabb.quadrant(xi):t.tileAABB(this,G,Ct.zoom+1,or,vr,Ct.wrap,Ct.minZ,Ct.maxZ,this.projection),zoom:Ct.zoom+1,x:or,y:vr,wrap:Ct.wrap,fullyVisible:si,tileID:void 0,shouldSplit:void 0,minZ:Ct.minZ,maxZ:Ct.maxZ};E&&!X&&(Xi.tileID=new t.OverscaledTileID(Ct.zoom+1===kt?yi:Ct.zoom+1,Ct.wrap,Ct.zoom+1,or,vr),Nt(Xi)),gt.push(Xi)}else{const xi=Ct.zoom===kt?yi:Ct.zoom;if(o.minzoom&&o.minzoom>xi)continue;const or=H[0]-(.5+ei+(Ct.wrap<<Ct.zoom))*(1<<d-Ct.zoom),vr=H[1]-.5-_i,Xi=Ct.tileID?Ct.tileID:new t.OverscaledTileID(xi,Ct.wrap,Ct.zoom,ei,_i);yt.push({tileID:Xi,distanceSq:or*or+vr*vr})}}if(this.fogCullDistSq){const Ct=this.fogCullDistSq,ei=this.horizonLineFromTop();yt=yt.filter(_i=>{const si=[0,0,0,1],xi=[t.EXTENT,t.EXTENT,0,1],or=this.calculateFogTileMatrix(_i.tileID.toUnwrapped());t.transformMat4$1(si,si,or),t.transformMat4$1(xi,xi,or);const vr=t.getAABBPointSquareDist(si,xi);if(vr===0)return!0;let Xi=!1;const cr=this._elevation;if(cr&&vr>Ct&&ei!==0){const Zr=this.calculateProjMatrix(_i.tileID.toUnwrapped());let Fr;o.isTerrainDEM||(Fr=cr.getMinMaxForTile(_i.tileID)),Fr||(Fr={min:Ge,max:Ue});const er=t.furthestTileCorner(this.rotation),pn=[er[0]*t.EXTENT,er[1]*t.EXTENT,Fr.max];t.transformMat4(pn,pn,Zr),Xi=(1-pn[1])*this.height*.5<ei}return vr<Ct||Xi})}return yt.sort((Ct,ei)=>Ct.distanceSq-ei.distanceSq).map(Ct=>Ct.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=t.clamp(o.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),x=this.projection.project(o.lng,d);return new t.Point(x.x*this.worldSize,x.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/t.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,d){let x,E;const A=this.centerPoint;if(this.projection.name==="globe"){const O=this.worldSize;x=(d.x-A.x)/O,E=(d.y-A.y)/O}else{const O=this.pointCoordinate(d),G=this.pointCoordinate(A);x=O.x-G.x,E=O.y-G.y}const B=this.locationCoordinate(o);this.setLocation(new t.MercatorCoordinate(B.x-x,B.y-E))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,d){const x=d?t.mercatorZfromAltitude(d,o.lat):void 0,E=this.projection.project(o.lng,o.lat);return new t.MercatorCoordinate(E.x,E.y,x)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,d){const x=d??this._centerAltitude,E=[o.x,o.y,0,1],A=[o.x,o.y,1,1];t.transformMat4$1(E,E,this.pixelMatrixInverse),t.transformMat4$1(A,A,this.pixelMatrixInverse);const B=A[3];t.scale$1(E,E,1/E[3]),t.scale$1(A,A,1/B);const O=E[2],G=A[2];return{p0:E,p1:A,t:O===G?0:(x-O)/(G-O)}}screenPointToMercatorRay(o){const d=[o.x,o.y,0,1],x=[o.x,o.y,1,1];return t.transformMat4$1(d,d,this.pixelMatrixInverse),t.transformMat4$1(x,x,this.pixelMatrixInverse),t.scale$1(d,d,1/d[3]),t.scale$1(x,x,1/x[3]),d[2]=t.mercatorZfromAltitude(d[2],this._center.lat)*this.worldSize,x[2]=t.mercatorZfromAltitude(x[2],this._center.lat)*this.worldSize,t.scale$1(d,d,1/this.worldSize),t.scale$1(x,x,1/this.worldSize),new t.Ray([d[0],d[1],d[2]],t.normalize([],t.sub([],x,d)))}rayIntersectionCoordinate(o){const{p0:d,p1:x,t:E}=o,A=t.mercatorZfromAltitude(d[2],this._center.lat),B=t.mercatorZfromAltitude(x[2],this._center.lat);return new t.MercatorCoordinate(t.number(d[0],x[0],E)/this.worldSize,t.number(d[1],x[1],E)/this.worldSize,t.number(A,B,E))}pointCoordinate(o,d=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,d)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let d=this.projection.pointCoordinate3D(this,o.x,o.y);if(d)return new t.MercatorCoordinate(d[0],d[1],d[2]);let x=0,E=this.horizonLineFromTop();if(o.y>E)return this.pointCoordinate(o);const A=.02*E,B=o.clone();for(let O=0;O<10&&E-x>A;O++){B.y=t.number(x,E,.66);const G=this.projection.pointCoordinate3D(this,B.x,B.y);G?(E=B.y,d=G):x=B.y}return d?new t.MercatorCoordinate(d[0],d[1],d[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(o);const d=this.pointCoordinate(o);return d.y>=0&&d.y<=1}_coordinatePoint(o,d){const x=d&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,E=[o.x*this.worldSize,o.y*this.worldSize,x+o.toAltitude(),1];return t.transformMat4$1(E,E,this.pixelMatrix),E[3]>0?new t.Point(E[0]/E[3],E[1]/E[3]):new t.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:d}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,A=this.pointLocation3D(new t.Point(d,o)),B=this.pointLocation3D(new t.Point(E,o)),O=this.pointLocation3D(new t.Point(E,x)),G=this.pointLocation3D(new t.Point(d,x));let H=Math.min(A.lng,B.lng,O.lng,G.lng),X=Math.max(A.lng,B.lng,O.lng,G.lng),oe=Math.min(A.lat,B.lat,O.lat,G.lat),ve=Math.max(A.lat,B.lat,O.lat,G.lat);const Ee=Math.pow(2,-this.zoom)/16*270,Ie=this.projection.name==="globe"?1:4,Ce=(ze,ae,Me,Ue,Ge)=>{const rt=(ze+Me)/2,nt=(ae+Ue)/2,tt=new t.Point(rt,nt),{lng:gt,lat:yt}=this.pointLocation3D(tt),kt=Math.max(0,H-gt,oe-yt,gt-X,yt-ve);H=Math.min(H,gt),X=Math.max(X,gt),oe=Math.min(oe,yt),ve=Math.max(ve,yt),(Ge<Ie||kt>Ee)&&(Ce(ze,ae,rt,nt,Ge+1),Ce(rt,nt,Me,Ue,Ge+1))};if(Ce(d,o,E,o,1),Ce(E,o,E,x,1),Ce(E,x,d,x,1),Ce(d,x,d,o,1),this.projection.name==="globe"){const[ze,ae]=t.polesInViewport(this);ze?(ve=90,X=180,H=-180):ae&&(oe=-90,X=180,H=-180)}return new t.LngLatBounds(new t.LngLat(H,oe),new t.LngLat(X,ve))}_getBoundsRectangular(o,d){const{top:x,left:E}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,B=this.width-this._edgeInsets.right,O=new t.Point(E,x),G=new t.Point(B,x),H=new t.Point(B,A),X=new t.Point(E,A);let oe=this.pointCoordinate(O,o),ve=this.pointCoordinate(G,o);const Ee=this.pointCoordinate(H,d),Ie=this.pointCoordinate(X,d),Ce=(ze,ae)=>(ae.y-ze.y)/(ae.x-ze.x);return oe.y>1&&ve.y>=0?oe=new t.MercatorCoordinate((1-Ie.y)/Ce(Ie,oe)+Ie.x,1):oe.y<0&&ve.y<=1&&(oe=new t.MercatorCoordinate(-Ie.y/Ce(Ie,oe)+Ie.x,0)),ve.y>1&&oe.y>=0?ve=new t.MercatorCoordinate((1-Ee.y)/Ce(Ee,ve)+Ee.x,1):ve.y<0&&oe.y<=1&&(ve=new t.MercatorCoordinate(-Ee.y/Ce(Ee,ve)+Ee.x,0)),new t.LngLatBounds().extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(ve)).extend(this.coordinateLocation(Ie)).extend(this.coordinateLocation(Ee))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=o.visibleDemTiles.reduce((x,E)=>{if(E.dem){const A=E.dem.tree;x.min=Math.min(x.min,A.minimums[0]),x.max=Math.max(x.max,A.maximums[0])}return x},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*o.exaggeration(),d.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,x=this.height/2-d*(1-this._horizonShift);return o?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-t.MAX_MERCATOR_LATITUDE,this.maxLat=t.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=t.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=t.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=t.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=t.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,d){return this.projection.createTileMatrix(this,d,o)}calculateDistanceTileData(o){const d=o.key,x=this._distanceTileDataCache;if(x[d])return x[d];const E=o.canonical,A=1/this.height,B=this.cameraWorldSize,O=B/this.zoomScale(E.z),G=(E.x+Math.pow(2,E.z)*o.wrap)*O,H=E.y*O,X=this.point;X.x*=B/this.worldSize,X.y*=B/this.worldSize;const oe=this.angle,ve=Math.sin(-oe),Ee=-Math.cos(-oe);return x[d]={bearing:[ve,Ee],center:[(X.x-G)*A,(X.y-H)*A],scale:O/t.EXTENT*A},x[d]}calculateFogTileMatrix(o){const d=o.key,x=this._fogTileMatrixCache;if(x[d])return x[d];const E=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return t.multiply(E,this.worldToFogMatrix,E),x[d]=new Float32Array(E),x[d]}calculateProjMatrix(o,d=!1){const x=o.key,E=d?this._alignedProjMatrixCache:this._projMatrixCache;if(E[x])return E[x];const A=this.calculatePosMatrix(o,this.worldSize);return t.multiply(A,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:d?this.alignedProjMatrix:this.projMatrix,A),E[x]=new Float32Array(A),E[x]}calculatePixelsToTileUnitsMatrix(o){const d=o.tileID.key,x=this._pixelsToTileUnitsCache;if(x[d])return x[d];const E=function(A,B){const{scale:O}=A.tileTransform,G=O*t.EXTENT/(A.tileSize*Math.pow(2,B.zoom-A.tileID.overscaledZ+A.tileID.canonical.z));return H=new Float32Array(4),ve=(X=B.inverseAdjustmentMatrix)[1],Ee=X[2],Ie=X[3],ze=(oe=[G,G])[1],H[0]=X[0]*(Ce=oe[0]),H[1]=ve*Ce,H[2]=Ee*ze,H[3]=Ie*ze,H;var H,X,oe,ve,Ee,Ie,Ce,ze}(o,this);return x[d]=E,x[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,d=t.fromScaling([],[o,o,o]);return t.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const d=t.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(d),E=this._camera.forward(),A=t.mercatorZfromAltitude(1,this._center.lat);x[2]/=A,E[2]/=A,t.normalize(E,E);const B=o.raycast(x,E,o.exaggeration());if(B){const O=t.scaleAndAdd([],x,E,B),G=new t.MercatorCoordinate(O[0],O[1],t.mercatorZfromAltitude(O[2],t.latFromMercatorY(O[1]))),H=(G.z+t.length([G.x-x[0],G.y-x[1],G.z-x[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=G.toAltitude(),this._center=this.coordinateLocation(G),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const d=this._elevation,x=t.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,E=this._computeCameraPosition(x),A=d.getAtPointOrZero(new t.MercatorCoordinate(...E)),B=this.pixelsPerMeter/this.worldSize*A,O=this._minimumHeightOverTerrain(),G=E[2]-B;if(G<=O)if(G<0||o){const H=this.locationCoordinate(this._center,this._centerAltitude),X=[E[0],E[1],H.z-E[2]],oe=t.length(X);X[2]-=(O-G)/this._pixelsPerMercatorPixel;const ve=t.length(X);if(ve===0)return;t.scale$2(X,X,oe/ve*this._pixelsPerMercatorPixel),this._camera.position=[E[0],E[1],H.z*this._pixelsPerMercatorPixel-X[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const ve=this.center;return ve.lat=t.clamp(ve.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(ve.lng=t.clamp(ve.lng,this.minLng,this.maxLng)),this.center=ve,void(this._constraining=!1)}const d=this._unmodified,{x,y:E}=this.point;let A=0,B=x,O=E;const G=this.width/2,H=this.height/2,X=this.worldMinY*this.scale,oe=this.worldMaxY*this.scale;if(E-H<X&&(O=X+H),E+H>oe&&(O=oe-H),oe-X<this.height&&(A=Math.max(A,this.height/(oe-X)),O=(oe+X)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ve=this.worldMinX*this.scale,Ee=this.worldMaxX*this.scale,Ie=this.worldSize/2-(ve+Ee)/2;B=(x+Ie+this.worldSize)%this.worldSize-Ie,B-G<ve&&(B=ve+G),B+G>Ee&&(B=Ee-G),Ee-ve<this.width&&(A=Math.max(A,this.width/(Ee-ve)),B=(Ee+ve)/2)}B===x&&O===E||(this.center=this.unproject(new t.Point(B,O))),A&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=t.mercatorZfromAltitude(1,this.center.lat)/t.mercatorZfromAltitude(1,t.GLOBE_SCALE_MATCH_LATITUDE));const x=Do(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this.projection.zAxisUnit==="meters"?d:1,A=this._camera.getWorldToCamera(this.worldSize,E),B=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);B[8]=2*-o.x/this.width,B[9]=2*o.y/this.height;let O=t.mul([],B,A);if(this.projection.isReprojectedInTileSpace){const nt=this.locationCoordinate(this.center),tt=t.identity([]);t.translate(tt,tt,[nt.x*this.worldSize,nt.y*this.worldSize,0]),t.multiply(tt,tt,bl(this)),t.translate(tt,tt,[-nt.x*this.worldSize,-nt.y*this.worldSize,0]),t.multiply(O,O,tt),this.inverseAdjustmentMatrix=function(gt){const yt=bl(gt,!0);return zt([],[yt[0],yt[1],yt[4],yt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=t.scale([],O,[this.worldSize,this.worldSize,this.worldSize/E,1]),this.projMatrix=O,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const G=t.invert([],B);this.frustumCorners=t.FrustumCorners.fromInvProjectionMatrix(G,this.horizonLineFromTop(),this.height);const H=new Float32Array(16);t.identity(H),t.scale(H,H,[1,-1,1]),t.rotateX(H,H,this._pitch),t.rotateZ(H,H,this.angle);const X=t.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),oe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;X[8]=2*-o.x/this.width,X[9]=2*(o.y+oe)/this.height,this.skyboxMatrix=t.multiply(H,X,H);const ve=this.point,Ee=ve.x,Ie=ve.y,Ce=this.width%2/2,ze=this.height%2/2,ae=Math.cos(this.angle),Me=Math.sin(this.angle),Ue=Ee-Math.round(Ee)+ae*Ce+Me*ze,Ge=Ie-Math.round(Ie)+ae*ze+Me*Ce,rt=new Float64Array(O);if(t.translate(rt,rt,[Ue>.5?Ue-1:Ue,Ge>.5?Ge-1:Ge,0]),this.alignedProjMatrix=rt,O=t.create(),t.scale(O,O,[this.width/2,-this.height/2,1]),t.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=t.create(),t.scale(O,O,[1,-1,1]),t.translate(O,O,[-1,-1,0]),t.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},O=t.invert(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=O,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=t.calculateGlobeMatrix(this);const nt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=t.transformMat4(nt,nt,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=O;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,x=this._camera.position,E=1/this.height/this._pixelsPerMercatorPixel,A=[o,o,d];t.scale$2(A,A,E),t.scale$2(x,x,-1),t.multiply$2(x,x,A);const B=t.create();t.translate(B,B,x),t.scale(B,B,A),this.mercatorFogMatrix=B,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,d,E)}_computeCameraPosition(o){const d=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),E=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-o/this.worldSize*this._centerAltitude;return[E.x/this.worldSize-x[0]*A,E.y/this.worldSize-x[1]*A,o/this.worldSize*this._centerAltitude-x[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],E=o[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),E>0&&(A=Math.min((d-x)/E,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,o,A),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,d=this._camera.forward(),{pitch:x,bearing:E}=this._camera.getPitchBearing(),A=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,B=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),O=Math.max((o[2]-A)/Math.cos(x),B),G=this._zoomFromMercatorZ(O);t.scaleAndAdd(o,o,d,O),this._pitch=t.clamp(x,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(E,-Math.PI,Math.PI),this._setZoom(t.clamp(G,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new t.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let d=0,x=t.GLOBE_ZOOM_THRESHOLD_MAX,E=0,A=1/0;for(;x-d>1e-6&&x>d;){const B=d+.5*(x-d),O=this.tileSize*Math.pow(2,B),G=this.getCameraToCenterDistance(this.projection,B,O),H=this.scaleZoom(G/(o*this.tileSize)),X=Math.abs(B-H);X<A&&(A=X,E=B),B<H?d=B:x=B}return E}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(t.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,d){const x=Math.min(o.x,d.x),E=Math.max(o.x,d.x),A=Math.min(o.y,d.y),B=Math.max(o.y,d.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const O=[new t.Point(x,A),new t.Point(E,B),new t.Point(x,B),new t.Point(E,A)],G=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const X of O){const oe=this.pointRayIntersection(X);if(oe.t<0)return!0;const ve=this.rayIntersectionCoordinate(oe);if(ve.x<G||ve.y<0||ve.x>H||ve.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new t.Point(0,0),new t.Point(this.width,this.height))}zoomDeltaToMovement(o,d){const x=t.length(t.sub([],this._camera.position,o)),E=this._zoomFromMercatorZ(x)+d;return x-this._mercatorZfromZoom(E)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([d,x,E],A){const B=[d,x,E,1];t.transformMat4$1(B,B,A);const O=B[3]=Math.max(B[3],1e-6);return B[0]/=O,B[1]/=O,B[2]/=O,B}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new t.Point(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,o))}}getCameraToCenterDistance(o,d=this.zoom,x=this.worldSize){const E=Do(o,d,this.width,this.height,1024),A=o.pixelSpaceConversion(this.center.lat,x,E);return .5/Math.tan(.5*this._fov)*this.height*A}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&t.multiply(o,o,this.globeMatrix),o}}function Ta(_,o){let d=!1,x=null;const E=()=>{x=null,d&&(_(),x=setTimeout(E,o),d=!1)};return()=>(d=!0,x||E(),x)}class ih{constructor(o){this._hashName=o&&encodeURIComponent(o),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ta(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,t.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),t.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const d=Jo(o);if(this._hashName){const x=this._hashName;let E=!1;const A=t.window.location.hash.slice(1).split("&").map(B=>{const O=B.split("=")[0];return O===x?(E=!0,`${O}=${d}`):B}).filter(B=>B);return E||A.push(`${x}=${d}`),`#${A.join("&")}`}return`#${d}`}_getCurrentHash(){const o=t.window.location.hash.replace("#","");if(this._hashName){let d;return o.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(d=x)}),(d&&d[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(x=>isNaN(x))){const x=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(d[3]||0):o.getBearing();return o.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:x,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,o)}}function Jo(_,o){const d=_.getCenter(),x=Math.round(100*_.getZoom())/100,E=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,E),B=Math.round(d.lng*A)/A,O=Math.round(d.lat*A)/A,G=_.getBearing(),H=_.getPitch();let X=o?`/${B}/${O}/${x}`:`${x}/${O}/${B}`;return(G||H)&&(X+="/"+Math.round(10*G)/10),H&&(X+=`/${Math.round(H)}`),X}const Cn={linearity:.3,easing:t.bezier(0,0,.3,1)},Tl=t.extend({deceleration:2500,maxSpeed:1400},Cn),ic=t.extend({deceleration:20,maxSpeed:1400},Cn),Fi=t.extend({deceleration:1e3,maxSpeed:360},Cn),Hs=t.extend({deceleration:1e3,maxSpeed:90},Cn);class Oh{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=t.exported.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)d.zoom+=A.zoomDelta||0,d.bearing+=A.bearingDelta||0,d.pitch+=A.pitchDelta||0,A.panDelta&&d.pan._add(A.panDelta),A.around&&(d.around=A.around),A.pinchAround&&(d.pinchAround=A.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(d.pan.mag()){const A=Ss(d.pan.mag(),x,t.extend({},Tl,o||{}));E.offset=d.pan.mult(A.amount/d.pan.mag()),E.center=this._map.transform.center,mu(E,A)}if(d.zoom){const A=Ss(d.zoom,x,ic);E.zoom=this._map.transform.zoom+A.amount,mu(E,A)}if(d.bearing){const A=Ss(d.bearing,x,Fi);E.bearing=this._map.transform.bearing+t.clamp(A.amount,-179,179),mu(E,A)}if(d.pitch){const A=Ss(d.pitch,x,Hs);E.pitch=this._map.transform.pitch+A.amount,mu(E,A)}if(E.zoom||E.bearing){const A=d.pinchAround===void 0?d.around:d.pinchAround;E.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),E.noMoveStart=!0,E}}function mu(_,o){(!_.duration||_.duration<o.duration)&&(_.duration=o.duration,_.easing=o.easing)}function Ss(_,o,d){const{maxSpeed:x,linearity:E,deceleration:A}=d,B=t.clamp(_*E/(o/1e3),-x,x),O=Math.abs(B)/(A*E);return{easing:d.easing,duration:1e3*O,amount:B*(O/2)}}class ro extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,x,E={}){const A=St(d.getCanvasContainer(),x),B=d.unproject(A);super(o,t.extend({point:A,lngLat:B,originalEvent:x},E)),this._defaultPrevented=!1,this.target=d}}class Ji extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,x){const E=o==="touchend"?x.changedTouches:x.touches,A=ci(d.getCanvasContainer(),E),B=A.map(G=>d.unproject(G)),O=A.reduce((G,H,X,oe)=>G.add(H.div(oe.length)),new t.Point(0,0));super(o,{points:A,point:O,lngLats:B,lngLat:d.unproject(O),originalEvent:x}),this._defaultPrevented=!1}}class dr extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,x){super(o,{originalEvent:x}),this._defaultPrevented=!1}}class El{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new dr(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new ro(o.type,this._map,o))}mouseup(o){this._map.fire(new ro(o.type,this._map,o))}preclick(o){const d=t.extend({},o);d.type="preclick",this._map.fire(new ro(d.type,this._map,d))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(o),this._map.fire(new ro(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new ro(o.type,this._map,o))}mouseover(o){this._map.fire(new ro(o.type,this._map,o))}mouseout(o){this._map.fire(new ro(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Ji(o.type,this._map,o))}touchmove(o){this._map.fire(new Ji(o.type,this._map,o))}touchend(o){this._map.fire(new Ji(o.type,this._map,o))}touchcancel(o){this._map.fire(new Ji(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rc{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new ro(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ro("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new ro(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ha{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(Ne(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const x=d,E=this._startPos,A=this._lastPos;if(!E||!A||A.equals(x)||!this._box&&x.dist(E)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=ne("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const B=Math.min(E.x,x.x),O=Math.max(E.x,x.x),G=Math.min(E.y,x.y),H=Math.max(E.y,x.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${B}px,${G}px)`,this._box.style.width=O-B+"px",this._box.style.height=H-G+"px")})}mouseupWindow(o,d){if(!this._active)return;const x=this._startPos,E=d;if(x&&o.button===0){if(this.reset(),_t(),x.x!==E.x||x.y!==E.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:A=>A.fitScreenCoordinates(x,E,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Le(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new t.Event(o,{originalEvent:d}))}}function ho(_,o){const d={};for(let x=0;x<_.length;x++)d[_[x].identifier]=o[x];return d}class Fs{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,d,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),x.length===this.numTouches&&(this.centroid=function(E){const A=new t.Point(0,0);for(const B of E)A._add(B);return A.div(E.length)}(d),this.touches=ho(x,d)))}touchmove(o,d,x){if(this.aborted||!this.centroid)return;const E=ho(x,d);for(const A in this.touches){const B=E[A];(!B||B.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(o,d,x){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){const E=!this.aborted&&this.centroid;if(this.reset(),E)return E}}}class Ks{constructor(o){this.singleTap=new Fs(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,d,x){this.singleTap.touchstart(o,d,x)}touchmove(o,d,x){this.singleTap.touchmove(o,d,x)}touchend(o,d,x){const E=this.singleTap.touchend(o,d,x);if(E){const A=o.timeStamp-this.lastTime<500,B=!this.lastTap||this.lastTap.dist(E)<30;if(A&&B||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=E,this.count===this.numTaps)return this.reset(),E}}}class g1{constructor(){this._zoomIn=new Ks({numTouches:1,numTaps:2}),this._zoomOut=new Ks({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,x){this._zoomIn.touchstart(o,d,x),this._zoomOut.touchstart(o,d,x)}touchmove(o,d,x){this._zoomIn.touchmove(o,d,x),this._zoomOut.touchmove(o,d,x)}touchend(o,d,x){const E=this._zoomIn.touchend(o,d,x),A=this._zoomOut.touchend(o,d,x);return E?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:B.getZoom()+1,around:B.unproject(E)},{originalEvent:o})}):A?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:B.getZoom()-1,around:B.unproject(A)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ka={0:1,2:2};class Dn{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,d){return!1}_move(o,d){return{}}mousedown(o,d){if(this._lastPoint)return;const x=dt(o);this._correctButton(o,x)&&(this._lastPoint=d,this._eventButton=x)}mousemoveWindow(o,d){const x=this._lastPoint;if(x){if(o.preventDefault(),this._eventButton!=null&&function(E,A){const B=Ka[A];return E.buttons===void 0||(E.buttons&B)!==B}(o,this._eventButton))this.reset();else if(this._moved||!(d.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(x,d)}}mouseupWindow(o){this._lastPoint&&dt(o)===this._eventButton&&(this._moved&&_t(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class no extends Dn{mousedown(o,d){super.mousedown(o,d),this._lastPoint&&(this._active=!0)}_correctButton(o,d){return d===0&&!o.ctrlKey}_move(o,d){return{around:d,panDelta:d.sub(o)}}}class _u extends Dn{_correctButton(o,d){return d===0&&o.ctrlKey||d===2}_move(o,d){const x=.8*(d.x-o.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(o){o.preventDefault()}}class Ya extends Dn{_correctButton(o,d){return d===0&&o.ctrlKey||d===2}_move(o,d){const x=-.5*(d.y-o.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(o){o.preventDefault()}}class S{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),t.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)}touchstart(o,d,x){return this._calculateTransform(o,d,x)}touchmove(o,d,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(x.length===1&&!t.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,d,x)}}touchend(o,d,x){this._calculateTransform(o,d,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,x){x.length>0&&(this._active=!0);const E=ho(x,d),A=new t.Point(0,0),B=new t.Point(0,0);let O=0;for(const H in E){const X=E[H],oe=this._touches[H];oe&&(A._add(X),B._add(X.sub(oe)),O++,E[H]=X)}if(this._touches=E,O<this._minTouches||!B.mag())return;const G=B.div(O);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(O),panDelta:G}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ne("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class l{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,d,x){return{}}touchstart(o,d,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,x){const E=this._firstTwoTouches;if(!E)return;o.preventDefault();const[A,B]=E,O=m(x,d,A),G=m(x,d,B);if(!O||!G)return;const H=this._aroundCenter?null:O.add(G).div(2);return this._move([O,G],H,o)}touchend(o,d,x){if(!this._firstTwoTouches)return;const[E,A]=this._firstTwoTouches,B=m(x,d,E),O=m(x,d,A);B&&O||(this._active&&_t(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function m(_,o,d){for(let x=0;x<_.length;x++)if(_[x].identifier===d)return o[x]}function w(_,o){return Math.log(_/o)/Math.LN2}class C extends l{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const x=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(w(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:w(this._distance,x),pinchAround:d}}}function D(_,o){return 180*_.angleWith(o)/Math.PI}class U extends l{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const x=this._vector;if(this._vector=o[0].sub(o[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:D(this._vector,x),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const E=D(o,x);return Math.abs(E)<d}}function q(_){return Math.abs(_.y)>Math.abs(_.x)}class K extends l{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,q(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,x){const E=this._lastPoints;if(!E)return;const A=o[0].sub(E[0]),B=o[1].sub(E[1]);return this._map._cooperativeGestures&&!t.isFullscreen()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(A,B,x.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(A.y+B.y)/2*-.5})}gestureBeginsVertically(o,d,x){if(this._valid!==void 0)return this._valid;const E=o.mag()>=2,A=d.mag()>=2;if(!E&&!A)return;if(!E||!A)return this._firstMove==null&&(this._firstMove=x),x-this._firstMove<100&&void 0;const B=o.y>0==d.y>0;return q(o)&&q(d)&&B}}const ee={panStep:100,bearingStep:15,pitchStep:10};class le{constructor(){const o=ee;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,x=0,E=0,A=0,B=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?x=-1:(o.preventDefault(),A=-1);break;case 39:o.shiftKey?x=1:(o.preventDefault(),A=1);break;case 38:o.shiftKey?E=1:(o.preventDefault(),B=-1);break;case 40:o.shiftKey?E=-1:(o.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(x=0,E=0),{cameraAnimation:O=>{const G=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:me,zoom:d?Math.round(G)+d*(o.shiftKey?2:1):G,bearing:O.getBearing()+x*this._bearingStep,pitch:O.getPitch()+E*this._pitchStep,offset:[-A*this._panStep,-B*this._panStep],center:O.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function me(_){return _*(2-_)}const be=4.000244140625;class qe{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||t.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=o.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const x=t.exported.now(),E=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,d!==0&&d%be==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":E>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(E*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=St(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const G=this._type==="wheel"&&Math.abs(this._delta)>be?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*G)));this._delta<0&&H!==0&&(H=1/H);const X=d(),oe=Math.pow(2,X),ve=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):oe;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(ve*H))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._delta=0}const x=typeof this._targetZoom=="number"?this._targetZoom:d(),E=this._startZoom,A=this._easing;let B,O=!1;if(this._type==="wheel"&&E&&A){const G=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),H=A(G);B=t.number(E,x,H),G<1?this._frameId||(this._frameId=!0):O=!0}else B=x,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:B-d(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=t.ease;if(this._prevEase){const x=this._prevEase,E=(t.exported.now()-x.start)/x.duration,A=x.easing(E+.01)-x.easing(E),B=.27/Math.sqrt(A*A+1e-4)*.01,O=Math.sqrt(.0729-B*B);d=t.bezier(B,O,.25,1)}return this._prevEase={start:t.exported.now(),duration:o,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ne("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(t.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Oe{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Fe{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,d){return o.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(o.shiftKey?-1:1),around:x.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ht{constructor(){this._tap=new Ks({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,d,x){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=d[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(o,d,x))}touchmove(o,d,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const E=d[0],A=E.y-this._swipePoint.y;return this._swipePoint=E,o.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(o,d,x)}touchend(o,d,x){this._tapTime?this._swipePoint&&x.length===0&&this.reset():this._tap.touchend(o,d,x)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vt{constructor(o,d,x){this._el=o,this._mousePan=d,this._touchPan=x}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Pt{constructor(o,d,x){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ke{constructor(o,d,x,E){this._el=o,this._touchZoom=d,this._touchRotate=x,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Rt=_=>_.zoom||_.drag||_.pitch||_.rotate;class Bt extends t.Event{}class ii{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,d){const x=t.sub([],d,o);this.radius=t.length(x[2]<0?t.div([],x,this.constants):[x[0],x[1],0])}projectRay(o){t.div(o,o,this.constants),t.normalize(o,o),t.mul$1(o,o,this.constants);const d=t.scale$2([],o,this.radius);if(d[2]>0){const x=t.scale$2([],[0,0,1],t.dot(d,[0,0,1])),E=t.scale$2([],t.normalize([],[d[0],d[1],0]),this.radius),A=t.add([],d,t.scale$2([],t.sub([],t.add([],E,x),d),2));d[0]=A[0],d[1]=A[1]}return d}}function Yt(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class di{constructor(o,d){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Oh(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new ii,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),t.bindAll(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[E,A,B]of this._listeners)E.addEventListener(A,E===t.window.document?this.handleWindowEvent:this.handleEvent,B)}destroy(){for(const[o,d,x]of this._listeners)o.removeEventListener(d,o===t.window.document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(o){const d=this._map,x=d.getCanvasContainer();this._add("mapEvent",new El(d,o));const E=d.boxZoom=new Ha(d,o);this._add("boxZoom",E);const A=new g1,B=new Fe;d.doubleClickZoom=new Oe(B,A),this._add("tapZoom",A),this._add("clickZoom",B);const O=new ht;this._add("tapDragZoom",O);const G=d.touchPitch=new K(d);this._add("touchPitch",G);const H=new _u(o),X=new Ya(o);d.dragRotate=new Pt(o,H,X),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",X,["mouseRotate"]);const oe=new no(o),ve=new S(d,o);d.dragPan=new vt(x,oe,ve),this._add("mousePan",oe),this._add("touchPan",ve,["touchZoom","touchRotate"]);const Ee=new U,Ie=new C;d.touchZoomRotate=new Ke(x,Ie,Ee,O),this._add("touchRotate",Ee,["touchPan","touchZoom"]),this._add("touchZoom",Ie,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Rc(d));const Ce=d.scrollZoom=new qe(d,this);this._add("scrollZoom",Ce,["mousePan"]);const ze=d.keyboard=new le;this._add("keyboard",ze);for(const ae of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[ae]&&d[ae].enable(o[ae])}_add(o,d,x){this._handlers.push({handlerName:o,handler:d,allowed:x}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rt(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,d,x){for(const E in o)if(E!==x&&(!d||d.indexOf(E)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const d=[];for(const x of o)this._el.contains(x.target)&&d.push(x);return d}handleEvent(o,d){this._updatingCamera=!0;const x=o.type==="renderFrame",E=x?void 0:o,A={needsRenderFrame:!1},B={},O={},G=o.touches?this._getMapTouches(o.touches):void 0,H=G?ci(this._el,G):x?void 0:St(this._el,o);for(const{handlerName:ve,handler:Ee,allowed:Ie}of this._handlers){if(!Ee.isEnabled())continue;let Ce;this._blockedByActive(O,Ie,ve)?Ee.reset():Ee[d||o.type]&&(Ce=Ee[d||o.type](o,H,G),this.mergeHandlerResult(A,B,Ce,ve,E),Ce&&Ce.needsRenderFrame&&this._triggerRenderFrame()),(Ce||Ee.isActive())&&(O[ve]=Ee)}const X={};for(const ve in this._previousActiveHandlers)O[ve]||(X[ve]=E);this._previousActiveHandlers=O,(Object.keys(X).length||Yt(A))&&(this._changes.push([A,B,X]),this._triggerRenderFrame()),(Object.keys(O).length||Yt(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:oe}=A;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))}mergeHandlerResult(o,d,x,E,A){if(!x)return;t.extend(o,x);const B={handlerName:E,originalEvent:x.originalEvent||A};x.zoomDelta!==void 0&&(d.zoom=B),x.panDelta!==void 0&&(d.drag=B),x.pitchDelta!==void 0&&(d.pitch=B),x.bearingDelta!==void 0&&(d.rotate=B)}_applyChanges(){const o={},d={},x={};for(const[E,A,B]of this._changes)E.panDelta&&(o.panDelta=(o.panDelta||new t.Point(0,0))._add(E.panDelta)),E.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+E.pitchDelta),E.around!==void 0&&(o.around=E.around),E.aroundCoord!==void 0&&(o.aroundCoord=E.aroundCoord),E.pinchAround!==void 0&&(o.pinchAround=E.pinchAround),E.noInertia&&(o.noInertia=E.noInertia),t.extend(d,A),t.extend(x,B);this._updateMapTransform(o,d,x),this._changes=[]}_updateMapTransform(o,d,x){const E=this._map,A=E.transform,B=Me=>[Me.x,Me.y,Me.z];if((Me=>{const Ue=this._eventsInProgress.drag;return Ue&&!this._handlersById[Ue.handlerName].isActive()})()&&!Yt(o)){const Me=A.zoom;A.cameraElevationReference="sea",A.recenterOnTerrain(),A.cameraElevationReference="ground",Me!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&E._stop(!0),!Yt(o))return void this._fireEvents(d,x,!0);let{panDelta:O,zoomDelta:G,bearingDelta:H,pitchDelta:X,around:oe,aroundCoord:ve,pinchAround:Ee}=o;A._isCameraConstrained&&(G>0&&(G=0),A._isCameraConstrained=!1),Ee!==void 0&&(oe=Ee),(G||(Me=>d[Me]&&!this._eventsInProgress[Me])("drag"))&&oe&&(this._dragOrigin=B(A.pointCoordinate3D(oe)),this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",E._stop(!0),oe=oe||E.transform.centerPoint,H&&(A.bearing+=H),X&&(A.pitch+=X),A._updateCameraState();const Ie=[0,0,0];if(O)if(A.projection.name==="mercator"){const Me=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(oe).dir),Ue=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(oe.sub(O)).dir);Ie[0]=Ue[0]-Me[0],Ie[1]=Ue[1]-Me[1]}else{const Me=A.pointCoordinate(oe);if(A.projection.name==="globe"){O=O.rotate(-A.angle);const Ue=A._pixelsPerMercatorPixel/A.worldSize;Ie[0]=-O.x*t.mercatorScale(t.latFromMercatorY(Me.y))*Ue,Ie[1]=-O.y*t.mercatorScale(A.center.lat)*Ue}else{const Ue=A.pointCoordinate(oe.sub(O));Me&&Ue&&(Ie[0]=Ue.x-Me.x,Ie[1]=Ue.y-Me.y)}}const Ce=A.zoom,ze=[0,0,0];if(G){const Me=B(ve||A.pointCoordinate3D(oe)),Ue={dir:t.normalize([],t.sub([],Me,A._camera.position))};if(Ue.dir[2]<0){const Ge=A.zoomDeltaToMovement(Me,G);t.scale$2(ze,Ue.dir,Ge)}}const ae=t.add(Ie,Ie,ze);A._translateCameraConstrained(ae),G&&Math.abs(A.zoom-Ce)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,x,!0)}_fireEvents(o,d,x){const E=Rt(this._eventsInProgress),A=Rt(o),B={};for(const X in o){const{originalEvent:oe}=o[X];this._eventsInProgress[X]||(B[`${X}start`]=oe),this._eventsInProgress[X]=o[X]}!E&&A&&this._fireEvent("movestart",A.originalEvent);for(const X in B)this._fireEvent(X,B[X]);A&&this._fireEvent("move",A.originalEvent);for(const X in o){const{originalEvent:oe}=o[X];this._fireEvent(X,oe)}const O={};let G;for(const X in this._eventsInProgress){const{handlerName:oe,originalEvent:ve}=this._eventsInProgress[X];this._handlersById[oe].isActive()||(delete this._eventsInProgress[X],G=d[oe]||ve,O[`${X}end`]=G)}for(const X in O)this._fireEvent(X,O[X]);const H=Rt(this._eventsInProgress);if(x&&(E||A)&&!H){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),oe=ve=>ve!==0&&-this._bearingSnap<ve&&ve<this._bearingSnap;X?(oe(X.bearing||this._map.getBearing())&&(X.bearing=0),this._map.easeTo(X,{originalEvent:G})):(this._map.fire(new t.Event("moveend",{originalEvent:G})),oe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new t.Event(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new Bt("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Wt="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ui extends t.Evented{constructor(o,d){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,x){return o=t.Point.convert(o).mult(-1),this.panTo(this.transform.center,t.extend({offset:o},d),x)}panTo(o,d,x){return this.easeTo(t.extend({center:o},d),x)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,x){return this.easeTo(t.extend({zoom:o},d),x)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,x){return this.easeTo(t.extend({bearing:o},d),x)}resetNorth(o,d){return this.rotateTo(0,t.extend({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=t.LngLatBounds.convert(o);const x=d&&d.bearing||0,E=d&&d.pitch||0,A=o.getNorthWest(),B=o.getSouthEast();return this._cameraForBounds(this.transform,A,B,x,E,d)}_extendCameraOptions(o){const d={top:0,bottom:0,right:0,left:0};if(typeof(o=t.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const x=o.padding;o.padding={top:x,bottom:x,right:x,left:x}}return o.padding=t.extend(d,o.padding),o}_minimumAABBFrustumDistance(o,d){const x=d.max[0]-d.min[0],E=d.max[1]-d.min[1];return x/E>o.aspect?x/(2*Math.tan(.5*o.fovX)*o.aspect):E/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,d,x,E,A,B){const O=o.clone(),G=this._extendCameraOptions(B);O.bearing=E,O.pitch=A;const H=t.LngLat.convert(d),X=t.LngLat.convert(x),oe=.5*(H.lat+X.lat),ve=.5*(H.lng+X.lng),Ee=t.latLngToECEF(oe,ve),Ie=t.normalize([],Ee),Ce=t.normalize([],t.cross([],Ie,[0,1,0])),ze=t.cross([],Ce,Ie),ae=[Ce[0],Ce[1],Ce[2],0,ze[0],ze[1],ze[2],0,Ie[0],Ie[1],Ie[2],0,0,0,0,1],Me=[Ee,t.latLngToECEF(H.lat,H.lng),t.latLngToECEF(X.lat,H.lng),t.latLngToECEF(X.lat,X.lng),t.latLngToECEF(H.lat,X.lng),t.latLngToECEF(oe,H.lng),t.latLngToECEF(oe,X.lng),t.latLngToECEF(H.lat,ve),t.latLngToECEF(X.lat,ve)];let Ue=t.Aabb.fromPoints(Me.map(si=>[t.dot(Ce,si),t.dot(ze,si),t.dot(Ie,si)]));const Ge=t.transformMat4([],Ue.center,ae);t.squaredLength(Ge)===0&&t.set(Ge,0,0,1),t.normalize(Ge,Ge),t.scale$2(Ge,Ge,t.GLOBE_RADIUS),O.center=t.ecefToLatLng(Ge);const rt=O.getWorldToCameraMatrix(),nt=t.invert(new Float64Array(16),rt);Ue=t.Aabb.applyTransform(Ue,t.multiply([],rt,ae)),t.transformMat4(Ge,Ge,rt);const tt=.5*(Ue.max[2]-Ue.min[2]),gt=this._minimumAABBFrustumDistance(O,Ue),yt=t.scale$2([],[0,0,1],tt),kt=t.add(yt,Ge,yt),yi=gt+(O.pitch===0?0:t.distance(Ge,kt)),At=O.globeCenterInViewSpace,Zt=t.sub([],Ge,[At[0],At[1],At[2]]);t.normalize(Zt,Zt),t.scale$2(Zt,Zt,yi);const Nt=t.add([],Ge,Zt);t.transformMat4(Nt,Nt,nt);const mi=t.earthRadius/t.GLOBE_RADIUS,Ct=t.length(Nt),ei=t.mercatorZfromAltitude(Math.max(Ct*mi-t.earthRadius,Number.EPSILON),0),_i=Math.min(O.zoomFromMercatorZAdjusted(ei),G.maxZoom);return _i>.5*(t.GLOBE_ZOOM_THRESHOLD_MIN+t.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"mercator"}),O.zoom=_i,this._cameraForBounds(O,d,x,E,A,B)):{center:O.center,zoom:_i,bearing:E,pitch:A}}queryTerrainElevation(o,d){const x=this.transform.elevation;return x?(d=t.extend({},{exaggerated:!0},d),x.getAtPoint(t.MercatorCoordinate.fromLngLat(o),null,d.exaggerated)):null}_cameraForBounds(o,d,x,E,A,B){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,d,x,E,A,B);const O=o.clone(),G=this._extendCameraOptions(B),H=O.padding;O.bearing=E,O.pitch=A;const X=t.LngLat.convert(d),oe=t.LngLat.convert(x),ve=new t.LngLat(X.lng,oe.lat),Ee=new t.LngLat(oe.lng,X.lat),Ie=O.project(X),Ce=O.project(oe),ze=this.queryTerrainElevation(X),ae=this.queryTerrainElevation(oe),Me=this.queryTerrainElevation(ve),Ue=this.queryTerrainElevation(Ee),Ge=[[Ie.x,Ie.y,Math.min(ze||0,ae||0,Me||0,Ue||0)],[Ce.x,Ce.y,Math.max(ze||0,ae||0,Me||0,Ue||0)]];let rt=t.Aabb.fromPoints(Ge);const nt=O.getWorldToCameraMatrix(),tt=t.invert(new Float64Array(16),nt);rt=t.Aabb.applyTransform(rt,nt);const gt=t.sub([],rt.max,rt.min),yt=H.left||0,kt=H.right||0,yi=H.bottom||0,At=H.top||0,{left:Zt,right:Nt,top:mi,bottom:Ct}=G.padding,ei=.5*(yt+kt),_i=.5*(At+yi),si=Math.min(O.scaleZoom(O.scale*Math.min((O.width-(yt+kt+Zt+Nt))/gt[0],(O.height-(yi+At+Ct+mi))/gt[1])),G.maxZoom),xi=O.scale/O.zoomScale(si);rt=new t.Aabb([rt.min[0]-(Zt+ei)*xi,rt.min[1]-(Ct+_i)*xi,rt.min[2]],[rt.max[0]+(Nt+ei)*xi,rt.max[1]+(mi+_i)*xi,rt.max[2]]);const or=.5*gt[2],vr=this._minimumAABBFrustumDistance(O,rt),Xi=[0,0,1,0];t.transformMat4$1(Xi,Xi,nt),t.normalize$2(Xi,Xi);const cr=t.scale$2([],Xi,vr+or),Zr=t.add([],rt.center,cr),Fr=(typeof G.offset.x=="number"&&typeof G.offset.y=="number"?new t.Point(G.offset.x,G.offset.y):t.Point.convert(G.offset)).rotate(-t.degToRad(E));rt.center[0]-=Fr.x*xi,rt.center[1]+=Fr.y*xi,t.transformMat4(rt.center,rt.center,tt),t.transformMat4(Zr,Zr,tt);const er=[rt.center[0],rt.center[1],Zr[2]*O.pixelsPerMeter];t.scale$2(er,er,1/O.worldSize);const pn=t.lngFromMercatorX(er[0]),un=t.latFromMercatorY(er[1]),kn=Math.min(O._zoomFromMercatorZ(er[2]),G.maxZoom),fn=new t.LngLat(pn,un);return O.mercatorFromTransition&&kn<.5*(t.GLOBE_ZOOM_THRESHOLD_MIN+t.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"globe"}),O.zoom=kn,this._cameraForBounds(O,d,x,E,A,B)):{center:fn,zoom:kn,bearing:E,pitch:A}}fitBounds(o,d,x){const E=this.cameraForBounds(o,d);return this._fitInternal(E,d,x)}fitScreenCoordinates(o,d,x,E,A){const B=t.Point.convert(o),O=t.Point.convert(d),G=new t.Point(Math.min(B.x,O.x),Math.min(B.y,O.y)),H=new t.Point(Math.max(B.x,O.x),Math.max(B.y,O.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(B,O))return this;const X=this.transform.pointLocation3D(G),oe=this.transform.pointLocation3D(H),ve=this.transform.pointLocation3D(new t.Point(G.x,H.y)),Ee=this.transform.pointLocation3D(new t.Point(H.x,G.y)),Ie=[Math.min(X.lng,oe.lng,ve.lng,Ee.lng),Math.min(X.lat,oe.lat,ve.lat,Ee.lat)],Ce=[Math.max(X.lng,oe.lng,ve.lng,Ee.lng),Math.max(X.lat,oe.lat,ve.lat,Ee.lat)],ze=E&&E.pitch?E.pitch:this.getPitch(),ae=this._cameraForBounds(this.transform,Ie,Ce,x,ze,E);return this._fitInternal(ae,E,A)}_fitInternal(o,d,x){return o?(delete(d=t.extend(o,d)).padding,d.linear?this.easeTo(d,x):this.flyTo(d,x)):this}jumpTo(o,d){this.stop();const x=o.preloadOnly?this.transform.clone():this.transform;let E=!1,A=!1,B=!1;return"zoom"in o&&x.zoom!==+o.zoom&&(E=!0,x.zoom=+o.zoom),o.center!==void 0&&(x.center=t.LngLat.convert(o.center)),"bearing"in o&&x.bearing!==+o.bearing&&(A=!0,x.bearing=+o.bearing),"pitch"in o&&x.pitch!==+o.pitch&&(B=!0,x.pitch=+o.pitch),o.padding==null||x.isPaddingEqual(o.padding)||(x.padding=o.padding),o.preloadOnly?(this._preloadTiles(x),this):(this.fire(new t.Event("movestart",d)).fire(new t.Event("move",d)),E&&this.fire(new t.Event("zoomstart",d)).fire(new t.Event("zoom",d)).fire(new t.Event("zoomend",d)),A&&this.fire(new t.Event("rotatestart",d)).fire(new t.Event("rotate",d)).fire(new t.Event("rotateend",d)),B&&this.fire(new t.Event("pitchstart",d)).fire(new t.Event("pitch",d)).fire(new t.Event("pitchend",d)),this.fire(new t.Event("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||t.warnOnce(Wt),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,d){const x=this.transform;if(!x.projection.supportsFreeCamera)return t.warnOnce(Wt),this;this.stop();const E=x.zoom,A=x.pitch,B=x.bearing;x.setFreeCameraOptions(o);const O=E!==x.zoom,G=A!==x.pitch,H=B!==x.bearing;return this.fire(new t.Event("movestart",d)).fire(new t.Event("move",d)),O&&this.fire(new t.Event("zoomstart",d)).fire(new t.Event("zoom",d)).fire(new t.Event("zoomend",d)),H&&this.fire(new t.Event("rotatestart",d)).fire(new t.Event("rotate",d)).fire(new t.Event("rotateend",d)),G&&this.fire(new t.Event("pitchstart",d)).fire(new t.Event("pitch",d)).fire(new t.Event("pitchend",d)),this.fire(new t.Event("moveend",d)),this}easeTo(o,d){this._stop(!1,o.easeId),((o=t.extend({offset:[0,0],duration:500,easing:t.ease},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const x=this.transform,E=this.getZoom(),A=this.getBearing(),B=this.getPitch(),O=this.getPadding(),G="zoom"in o?+o.zoom:E,H="bearing"in o?this._normalizeBearing(o.bearing,A):A,X="pitch"in o?+o.pitch:B,oe="padding"in o?o.padding:x.padding,ve=t.Point.convert(o.offset);let Ee,Ie,Ce;if(x.projection.name==="globe"){const yt=t.MercatorCoordinate.fromLngLat(x.center),kt=ve.rotate(-x.angle);yt.x+=kt.x/x.worldSize,yt.y+=kt.y/x.worldSize;const yi=yt.toLngLat(),At=t.LngLat.convert(o.center||yi);this._normalizeCenter(At),Ee=x.centerPoint.add(kt),Ie=new t.Point(yt.x,yt.y).mult(x.worldSize),Ce=new t.Point(t.mercatorXfromLng(At.lng),t.mercatorYfromLat(At.lat)).mult(x.worldSize).sub(Ie)}else{Ee=x.centerPoint.add(ve);const yt=x.pointLocation(Ee),kt=t.LngLat.convert(o.center||yt);this._normalizeCenter(kt),Ie=x.project(yt),Ce=x.project(kt).sub(Ie)}const ze=x.zoomScale(G-E);let ae,Me;o.around&&(ae=t.LngLat.convert(o.around),Me=x.locationPoint(ae));const Ue=this._zooming||G!==E,Ge=this._rotating||A!==H,rt=this._pitching||X!==B,nt=!x.isPaddingEqual(oe),tt=yt=>kt=>{if(Ue&&(yt.zoom=t.number(E,G,kt)),Ge&&(yt.bearing=t.number(A,H,kt)),rt&&(yt.pitch=t.number(B,X,kt)),nt&&(yt.interpolatePadding(O,oe,kt),Ee=yt.centerPoint.add(ve)),ae)yt.setLocationAtPoint(ae,Me);else{const yi=yt.zoomScale(yt.zoom-E),At=G>E?Math.min(2,ze):Math.max(.5,ze),Zt=Math.pow(At,1-kt),Nt=yt.unproject(Ie.add(Ce.mult(kt*Zt)).mult(yi));yt.setLocationAtPoint(yt.renderWorldCopies?Nt.wrap():Nt,Ee)}return o.preloadOnly||this._fireMoveEvents(d),yt};if(o.preloadOnly){const yt=this._emulate(tt,o.duration,x);return this._preloadTiles(yt),this}const gt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ue,this._rotating=Ge,this._pitching=rt,this._padding=nt,this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,gt),this._ease(tt(x),yt=>{x.recenterOnTerrain(),this._afterEase(d,yt)},o),this}_prepareEase(o,d,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",d||x.moving||this.fire(new t.Event("movestart",o)),this._zooming&&!x.zooming&&this.fire(new t.Event("zoomstart",o)),this._rotating&&!x.rotating&&this.fire(new t.Event("rotatestart",o)),this._pitching&&!x.pitching&&this.fire(new t.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new t.Event("move",o)),this._zooming&&this.fire(new t.Event("zoom",o)),this._rotating&&this.fire(new t.Event("rotate",o)),this._pitching&&this.fire(new t.Event("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,E=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new t.Event("zoomend",o)),E&&this.fire(new t.Event("rotateend",o)),A&&this.fire(new t.Event("pitchend",o)),this.fire(new t.Event("moveend",o))}flyTo(o,d){if(this._prefersReducedMotion(o)){const si=t.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(si,d)}this.stop(),o=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},o);const x=this.transform,E=this.getZoom(),A=this.getBearing(),B=this.getPitch(),O=this.getPadding(),G="zoom"in o?t.clamp(+o.zoom,x.minZoom,x.maxZoom):E,H="bearing"in o?this._normalizeBearing(o.bearing,A):A,X="pitch"in o?+o.pitch:B,oe="padding"in o?o.padding:x.padding,ve=x.zoomScale(G-E),Ee=t.Point.convert(o.offset);let Ie=x.centerPoint.add(Ee);const Ce=x.pointLocation(Ie),ze=t.LngLat.convert(o.center||Ce);this._normalizeCenter(ze);const ae=x.project(Ce),Me=x.project(ze).sub(ae);let Ue=o.curve;const Ge=Math.max(x.width,x.height),rt=Ge/ve,nt=Me.mag();if("minZoom"in o){const si=t.clamp(Math.min(o.minZoom,E,G),x.minZoom,x.maxZoom),xi=Ge/x.zoomScale(si-E);Ue=Math.sqrt(xi/nt*2)}const tt=Ue*Ue;function gt(si){const xi=(rt*rt-Ge*Ge+(si?-1:1)*tt*tt*nt*nt)/(2*(si?rt:Ge)*tt*nt);return Math.log(Math.sqrt(xi*xi+1)-xi)}function yt(si){return(Math.exp(si)-Math.exp(-si))/2}function kt(si){return(Math.exp(si)+Math.exp(-si))/2}const yi=gt(0);let At=function(si){return kt(yi)/kt(yi+Ue*si)},Zt=function(si){return Ge*((kt(yi)*(yt(xi=yi+Ue*si)/kt(xi))-yt(yi))/tt)/nt;var xi},Nt=(gt(1)-yi)/Ue;if(Math.abs(nt)<1e-6||!isFinite(Nt)){if(Math.abs(Ge-rt)<1e-6)return this.easeTo(o,d);const si=rt<Ge?-1:1;Nt=Math.abs(Math.log(rt/Ge))/Ue,Zt=function(){return 0},At=function(xi){return Math.exp(si*Ue*xi)}}o.duration="duration"in o?+o.duration:1e3*Nt/("screenSpeed"in o?+o.screenSpeed/Ue:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const mi=A!==H,Ct=X!==B,ei=!x.isPaddingEqual(oe),_i=si=>xi=>{const or=xi*Nt,vr=1/At(or);si.zoom=xi===1?G:E+si.scaleZoom(vr),mi&&(si.bearing=t.number(A,H,xi)),Ct&&(si.pitch=t.number(B,X,xi)),ei&&(si.interpolatePadding(O,oe,xi),Ie=si.centerPoint.add(Ee));const Xi=xi===1?ze:si.unproject(ae.add(Me.mult(Zt(or))).mult(vr));return si.setLocationAtPoint(si.renderWorldCopies?Xi.wrap():Xi,Ie),si._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(d),si};if(o.preloadOnly){const si=this._emulate(_i,o.duration,x);return this._preloadTiles(si),this}return this._zooming=!0,this._rotating=mi,this._pitching=Ct,this._padding=ei,this._prepareEase(d,!1),this._ease(_i(x),()=>this._afterEase(d),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,d)}if(!o){const x=this.handlers;x&&x.stop(!1)}return this}_ease(o,d,x){x.animate===!1||x.duration===0?(o(1),d()):(this._easeStart=t.exported.now(),this._easeOptions=x,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,d){o=t.wrap(o,-180,180);const x=Math.abs(o-d);return Math.abs(o-360-d)<x&&(o-=360),Math.abs(o+360-d)<x&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(!d.renderWorldCopies||d.maxBounds)return;const x=o.lng-d.center.lng;o.lng+=x>180?-360:x<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&t.exported.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,d,x){const E=Math.ceil(15*d/1e3),A=[],B=o(x.clone());for(let O=0;O<=E;O++){const G=B(O/E);A.push(G.clone())}return A}}class Ft{constructor(o={}){this.options=o,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const d=this.options&&this.options.compact;return this._map=o,this._container=ne("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ne("button","mapboxgl-ctrl-attrib-button",this._container),ne("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ne("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const x=this._map._getUIString(`AttributionControl.${d}`);o.setAttribute("aria-label",x),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(o){const x=d.reduce((E,A,B)=>(A.value&&(E+=`${A.key}=${A.value}${B<d.length-1?"&":""}`),E),"?");o.href=`${t.config.FEEDBACK_URL}/${x}#${Jo(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}const d=this._map.style._sourceCaches;for(const E in d){const A=d[E];if(A.used){const B=A.getSource();B.attribution&&o.indexOf(B.attribution)<0&&o.push(B.attribution)}}o.sort((E,A)=>E.length-A.length),o=o.filter((E,A)=>{for(let B=A+1;B<o.length;B++)if(o[B].indexOf(E)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const x=o.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,o.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class qi{constructor(){t.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=ne("div","mapboxgl-ctrl");const d=ne("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const d in o){const x=o[d].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const d=o[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class Er{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,x=d?this._queue.concat(d):this._queue;for(const E of x)if(E.id===o)return void(E.cancelled=!0)}run(o=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const x of d)if(!x.cancelled&&(x.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Sr(_,o,d){if(_=new t.LngLat(_.lng,_.lat),o){const x=new t.LngLat(_.lng-360,_.lat),E=new t.LngLat(_.lng+360,_.lat),A=360*Math.ceil(Math.abs(_.lng-d.center.lng)/360),B=d.locationPoint(_).distSqr(o),O=o.x<0||o.y<0||o.x>d.width||o.y>d.height;d.locationPoint(x).distSqr(o)<B&&(O||Math.abs(x.lng-d.center.lng)<A)?_=x:d.locationPoint(E).distSqr(o)<B&&(O||Math.abs(E.lng-d.center.lng)<A)&&(_=E)}for(;Math.abs(_.lng-d.center.lng)>180;){const x=d.locationPoint(_);if(x.x>=0&&x.y>=0&&x.x<=d.width&&x.y<=d.height)break;_.lng>d.center.lng?_.lng-=360:_.lng+=360}return _}const ir={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class pi extends t.Evented{constructor(o,d){if(super(),(o instanceof t.window.HTMLElement||d)&&(o=t.extend({element:o},d)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=t.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=ne("div");const E=41,A=27,B=Ye("svg",{display:"block",height:E*this._scale+"px",width:A*this._scale+"px",viewBox:`0 0 ${A} ${E}`},this._element),O=Ye("radialGradient",{id:"shadowGradient"},Ye("defs",{},B));Ye("stop",{offset:"10%","stop-opacity":.4},O),Ye("stop",{offset:"100%","stop-opacity":.05},O),Ye("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},B),Ye("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},B),Ye("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},B),Ye("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},B),this._offset=t.Point.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()});const x=this._element.classList;for(const E in ir)x.remove(`mapboxgl-marker-anchor-${E}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=t.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const E=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[E,-1*(38.1-13.5+E)],"bottom-right":[-E,-1*(38.1-13.5+E)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const d=o.code,x=o.charCode||o.keyCode;d!=="Space"&&d!=="Enter"&&x!==32&&x!==13||this.togglePopup()}_onMapClick(o){const d=o.originalEvent.target,x=this._element;this._popup&&(d===x||x.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,d=this._pos;if(!o||!d)return!1;const x=o.unproject(d),E=o.getFreeCameraOptions();if(!E.position)return!1;const A=E.position.toLngLat();return A.distanceTo(x)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const d=this._pos;if(!d||d.x<0||d.x>o.transform.width||d.y<0||d.y>o.transform.height)return void this._clearFadeTimer();const x=o.unproject(d);let E;o._showingGlobe()&&t.isLngLatBehindGlobe(o.transform,this._lngLat)?E=0:(E=1-o._queryFogOpacity(x),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(E*=this._occludedOpacity)),this._element.style.opacity=`${E}`,this._element.style.pointerEvents=E>0?"auto":"none",this._popup&&this._popup._setOpacity(E),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${ir[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const o=this._pos,d=this._map,x=this.getPitchAlignment();if(!d||!o||x!=="map")return"";if(!d._showingGlobe()){const G=d.getPitch();return G?`rotateX(${G}deg)`:""}const E=t.radToDeg(t.globeTiltAtLngLat(d.transform,this._lngLat)),A=o.sub(t.globeCenterToScreenPoint(d.transform)),B=Math.abs(A.x)+Math.abs(A.y);if(B===0)return"";const O=E/B;return`rotateX(${-A.y*O}deg) rotateY(${A.x*O}deg)`}_calculateZTransform(){const o=this._pos,d=this._map;if(!d||!o)return"";let x=0;const E=this.getRotationAlignment();if(E==="map")if(d._showingGlobe()){const A=d.project(new t.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),B=d.project(new t.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(A);x=t.radToDeg(Math.atan2(B.y,B.x))-90}else x=-d.getBearing();else if(E==="horizon"){const A=t.smoothstep(4,6,d.getZoom()),B=t.globeCenterToScreenPoint(d.transform);B.y+=A*d.transform.height;const O=o.sub(B),G=t.radToDeg(Math.atan2(O.y,O.x));x=(G>90?G-270:G+90)*(1-A)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(o){t.window.cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=Sr(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),o===!0?this._updateFrameId=t.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=t.Point.convert(o),this._update(),this}_onMove(o){const d=this._map;if(!d)return;const x=this._pointerdownPos,E=this._positionDelta;if(x&&E){if(!this._isDragging){const A=this._clickTolerance||d._clickTolerance;if(o.point.dist(x)<A)return;this._isDragging=!0}this._pos=o.point.sub(E),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(o){const d=this._map,x=this._pos;d&&x&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(x),this._pointerdownPos=o.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const d=this._map;return d&&(o?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const cn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Yr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Jr(_=new t.Point(0,0),o="bottom"){if(typeof _=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(o){case"top":return new t.Point(0,_);case"top-left":return new t.Point(d,d);case"top-right":return new t.Point(-d,d);case"bottom":return new t.Point(0,-_);case"bottom-left":return new t.Point(d,-d);case"bottom-right":return new t.Point(-d,-d);case"left":return new t.Point(_,0);case"right":return new t.Point(-_,0)}return new t.Point(0,0)}return _ instanceof t.Point||Array.isArray(_)?t.Point.convert(_):t.Point.convert(_[o]||[0,0])}class dn{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const d=t.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,d,x){this._start=this.getValue(d),this._end=o,this._startTime=d,this._endTime=d+x}}const _o={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ha={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},da={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ea{constructor(o,d,x=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new _u({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,x&&(this.mousePitch=new Ya({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(o,d){this.mouseRotate.mousedown(o,d),this.mousePitch&&this.mousePitch.mousedown(o,d),Ne()}move(o,d){const x=this.map,E=this.mouseRotate.mousemoveWindow(o,d),A=E&&E.bearingDelta;if(A&&x.setBearing(x.getBearing()+A),this.mousePitch){const B=this.mousePitch.mousemoveWindow(o,d),O=B&&B.pitchDelta;O&&x.setPitch(x.getPitch()+O)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Le(),t.window.removeEventListener("mousemove",this.mousemove),t.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(t.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),St(this.element,o)),t.window.addEventListener("mousemove",this.mousemove),t.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,St(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ci(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=ci(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Sa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ms={maxWidth:100,unit:"metric"},Qo={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Cs={version:t.version,supported:ie,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends Ui{constructor(_){if(t.LivePerformanceUtils.mark(t.PerformanceMarkers.create),(_=t.extend({},ha,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&t.isSafariWithAntialiasingBug(t.window)&&(_.antialias=!1,t.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new wl(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._useWebGL2=_.useWebGL2,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new Er,this._domRenderTaskQueue=new Er,this._controls=[],this._markers=[],this._popups=[],this._mapId=t.uniqueId(),this._locale=t.extend({},_o,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new dn(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new t.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,typeof _.container=="string"){if(this._container=t.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof t.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&t.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),t.window!==void 0&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1),t.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new di(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this._hash=_.hash&&new ih(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,t.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),_.attributionControl&&this.addControl(new Ft({customAttribution:_.customAttribution})),this._logoControl=new qi,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new t.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new t.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(_,o){if(o===void 0&&(o=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=_.onAdd(this);this._controls.push(_);const x=this._controlPositions[o];return o.indexOf("bottom")!==-1?x.insertBefore(d,x.firstChild):x.appendChild(d),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(_);return o>-1&&this._controls.splice(o,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new t.Event("movestart",_)).fire(new t.Event("move",_)),this.fire(new t.Event("resize",_)),o&&this.fire(new t.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(t.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return _==="auto"?t.window.navigator.language:Array.isArray(_)?_.length===0?void 0:_.map(o=>o==="auto"?t.window.navigator.language:o):_}setLanguage(_){const o=this._parseLanguage(_);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(_){return this._lazyInitEmptyStyle(),_?typeof _=="string"&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const _=this.transform,o=_.projection.name;let d;o==="globe"&&_.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX?(_.setMercatorFromTransition(),d=!0):o==="mercator"&&_.zoom<t.GLOBE_ZOOM_THRESHOLD_MAX&&(_.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,o){return this._updateProjection(_||o||{name:"mercator"})}_updateProjection(_){let o;if(o=_.name==="globe"&&this.transform.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const d in this.style._sourceCaches)this.style._sourceCaches[d].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(_){return this.transform.locationPoint3D(t.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(t.Point.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,o,d){if(_==="mouseenter"||_==="mouseover"){let x=!1;const E=B=>{const O=o.filter(H=>this.getLayer(H)),G=O.length?this.queryRenderedFeatures(B.point,{layers:O}):[];G.length?x||(x=!0,d.call(this,new ro(_,this,B.originalEvent,{features:G}))):x=!1},A=()=>{x=!1};return{layers:new Set(o),listener:d,delegates:{mousemove:E,mouseout:A}}}if(_==="mouseleave"||_==="mouseout"){let x=!1;const E=B=>{const O=o.filter(G=>this.getLayer(G));(O.length?this.queryRenderedFeatures(B.point,{layers:O}):[]).length?x=!0:x&&(x=!1,d.call(this,new ro(_,this,B.originalEvent)))},A=B=>{x&&(x=!1,d.call(this,new ro(_,this,B.originalEvent)))};return{layers:new Set(o),listener:d,delegates:{mousemove:E,mouseout:A}}}{const x=E=>{const A=o.filter(O=>this.getLayer(O)),B=A.length?this.queryRenderedFeatures(E.point,{layers:A}):[];B.length&&(E.features=B,d.call(this,E),delete E.features)};return{layers:new Set(o),listener:d,delegates:{[_]:x}}}}on(_,o,d){if(d===void 0)return super.on(_,o);Array.isArray(o)||(o=[o]);const x=this._createDelegatedListener(_,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(x);for(const E in x.delegates)this.on(E,x.delegates[E]);return this}once(_,o,d){if(d===void 0)return super.once(_,o);Array.isArray(o)||(o=[o]);const x=this._createDelegatedListener(_,o,d);for(const E in x.delegates)this.once(E,x.delegates[E]);return this}off(_,o,d){if(d===void 0)return super.off(_,o);o=new Set(Array.isArray(o)?o:[o]);const x=(A,B)=>{if(A.size!==B.size)return!1;for(const O of A)if(!B.has(O))return!1;return!0},E=this._delegatedListeners?this._delegatedListeners[_]:void 0;return E&&(A=>{for(let B=0;B<A.length;B++){const O=A[B];if(O.listener===d&&x(O.layers,o)){for(const G in O.delegates)this.off(G,O.delegates[G]);return A.splice(B,1),this}}})(E),this}queryRenderedFeatures(_,o){return this.style?(o!==void 0||_===void 0||_ instanceof t.Point||Array.isArray(_)||(o=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(_,o){return this.style.querySourceFeatures(_,o)}isPointOnSurface(_){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&t.warnOnce(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(t.Point.convert(_))}setStyle(_,o){return(o=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(_,o))}_getUIString(_){const o=this._locale[_];if(o==null)throw new Error(`Missing UI string '${_}'`);return o}_updateStyle(_,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new Ws(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ws(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,o){if(typeof _=="string"){const d=this._requestManager.normalizeStyleURL(_),x=this._requestManager.transformRequest(d,t.ResourceType.Style);t.getJSON(x,(E,A)=>{E?this.fire(new t.ErrorEvent(E)):A&&this._updateDiff(A,o)})}else typeof _=="object"&&this._updateDiff(_,o)}_updateDiff(_,o){try{this.style.setState(_)&&this._update(!0)}catch(d){t.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(_,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(t.warnOnce("There is no style added to the map."),!1)}addSource(_,o){return this._lazyInitEmptyStyle(),this.style.addSource(_,o),this._update(!0)}isSourceLoaded(_){return!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const o in _){const d=_[o]._tiles;for(const x in d){const E=d[x];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}addSourceType(_,o,d){this._lazyInitEmptyStyle(),this.style.addSourceType(_,o,d)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,o,{pixelRatio:d=1,sdf:x=!1,stretchX:E,stretchY:A,content:B}={}){if(this._lazyInitEmptyStyle(),o instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&o instanceof t.window.ImageBitmap){const{width:O,height:G,data:H}=t.exported.getImageData(o);this.style.addImage(_,{data:new t.RGBAImage({width:O,height:G},H),pixelRatio:d,stretchX:E,stretchY:A,content:B,sdf:x,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:G}=o,H=o;this.style.addImage(_,{data:new t.RGBAImage({width:O,height:G},new Uint8Array(H.data)),pixelRatio:d,stretchX:E,stretchY:A,content:B,sdf:x,version:0,userImage:H}),H.onAdd&&H.onAdd(this,_)}}updateImage(_,o){const d=this.style.getImage(_);if(!d)return void this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=o instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&o instanceof t.window.ImageBitmap?t.exported.getImageData(o):o,{width:E,height:A}=x;E!==void 0&&A!==void 0?E===d.data.width&&A===d.data.height?(d.data.replace(x.data,!(o instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&o instanceof t.window.ImageBitmap)),this.style.updateImage(_,d)):this.fire(new t.ErrorEvent(new Error(`The width and height of the updated image (${E}, ${A})
                must be that same as the previous version of the image
                (${d.data.width}, ${d.data.height})`))):this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,o){t.getImage(this._requestManager.transformRequest(_,t.ResourceType.Image),(d,x)=>{o(d,x instanceof t.window.HTMLImageElement?t.exported.getImageData(x):x)})}listImages(){return this.style.listImages()}addLayer(_,o){return this._lazyInitEmptyStyle(),this.style.addLayer(_,o),this._update(!0)}moveLayer(_,o){return this.style.moveLayer(_,o),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,o,d){return this.style.setLayerZoomRange(_,o,d),this._update(!0)}setFilter(_,o,d={}){return this.style.setFilter(_,o,d),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,o,d,x={}){return this.style.setPaintProperty(_,o,d,x),this._update(!0)}getPaintProperty(_,o){return this.style.getPaintProperty(_,o)}setLayoutProperty(_,o,d,x={}){return this.style.setLayoutProperty(_,o,d,x),this._update(!0)}getLayoutProperty(_,o){return this.style.getLayoutProperty(_,o)}setLight(_,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.LngLat.convert(_),this.transform):0}setFeatureState(_,o){return this.style.setFeatureState(_,o),this._update()}removeFeatureState(_,o){return this.style.removeFeatureState(_,o),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let d,x,E,A=this._container;for(;A&&(!x||!E);){const B=t.window.getComputedStyle(A).transform;B&&B!=="none"&&(d=B.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(x=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(E=d[3])),A=A.parentElement}this._containerWidth=x?Math.abs(_/x):_,this._containerHeight=E?Math.abs(o/E):o}_detectMissingCSS(){t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=ne("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=ne("div","mapboxgl-canvas-container",_);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=ne("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=ne("div","mapboxgl-control-container",_),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{x[E]=ne("div",`mapboxgl-ctrl-${E}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,o){const d=t.exported.devicePixelRatio||1;this._canvas.width=d*Math.ceil(_),this._canvas.height=d*Math.ceil(o),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${o}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const o=this._markers.indexOf(_);o!==-1&&this._markers.splice(o,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const o=this._popups.indexOf(_);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const _=t.extend({},ie.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",_),d=o||this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);d?(this._useWebGL2&&!o&&t.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),t.storeAuthState(d,!0),this.painter=new vl(d,this.transform,!!o),this.on("data",x=>{x.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),t.exported$1.testSupport(d)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let o;const d=this.painter.context.extTimerQuery,x=t.exported.now();if(this.listens("gpu-timing-frame")&&(o=d.createQueryEXT(),d.beginQueryEXT(d.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],t.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],t.window.performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,G=this.transform.pitch,H=t.exported.now(),X=new t.EvaluationParameters(O,{now:H,fadeDuration:E,pitch:G,transition:this.style.getTransition()});this.style.update(X)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(x),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const O=t.exported.now()-x;d.endQueryEXT(d.TIME_ELAPSED_EXT,o),setTimeout(()=>{const G=d.getQueryObjectEXT(o,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(o),this.fire(new t.Event("gpu-timing-frame",{cpuTime:O,gpuTime:G})),t.window.performance.mark("frame-gpu",{startTime:x,detail:{gpuTime:G}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(O);this.fire(new t.Event("gpu-timing-layer",{layerTimes:G}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const G=this.painter.queryGpuTimeDeferredRender(O);this.fire(new t.Event("gpu-timing-deferred-render",{gpuTime:G}))},50)}const B=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(B||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(A=this._updateAverageElevation(x,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,t.LivePerformanceUtils.mark(t.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&t.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const o of this._markers)_&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!_||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(_,o=!1){const d=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);if((o||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const x=this.transform.averageElevation;let E=this.transform.sampleAverageElevation(),A=!1;this.transform.elevation&&(A=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=_;const B=Math.abs(x-E);if(B>1){if(this._isInitialLoad||A)return this._averageElevation.jumpTo(E),d(E);this._averageElevation.easeTo(E,_,300)}else if(B>1e-4)return this._averageElevation.jumpTo(E),d(E)}return!!this._averageElevation.isEasing(_)&&d(this._averageElevation.getValue(_))}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===t.AUTH_ERR_MSG||_.status===401)){const o=this.painter.context.gl;t.storeAuthState(o,!1),this._logoControl instanceof qi&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const d=this.painter.context.gl,x=d.createFramebuffer();function E(A){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,A,0);const B=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,B),B}return d.bindFramebuffer(d.FRAMEBUFFER,x),this._canvasPixelComparison(E(_),o.canvasCopies.map(E),o.timeStamps)}_canvasPixelComparison(_,o,d){let x=d[1]-d[0];const E=_.length/4;for(let A=0;A<o.length;A++){const B=o[A];let O=0;for(let G=0;G<B.length;G+=4)B[G]===_[G]&&B[G+1]===_[G+1]&&B[G+2]===_[G+2]&&B[G+3]===_[G+3]&&(O+=1);x+=(d[A+2]-d[A+1])*(1-O/E)}return x}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),t.window!==void 0&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1),t.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=t.exported.frame(o=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(o)}))}_preloadTiles(_){const o=this.style?Object.values(this.style._sourceCaches):[];return t.asyncAll(o,(d,x)=>d._preloadTiles(_,x),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){t.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,o){t.setCacheLimits(_,o)}get version(){return t.version}},NavigationControl:class{constructor(_){this.options=t.extend({},da,_),this._container=ne("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),ne("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),ne("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:o}):d.resetNorth({},{originalEvent:o}))}),this._compassIcon=ne("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const o=_.getZoom(),d=o===_.getMaxZoom(),x=o===_.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ea(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,o){const d=ne("button",_,this._container);return d.type="button",d.addEventListener("click",o),d}_setButtonTitle(_,o){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${o}`);_.setAttribute("aria-label",d),_.firstElementChild&&_.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends t.Evented{constructor(_){super(),this.options=t.extend({geolocation:t.window.navigator.geolocation},Sa,_),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ta(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=ne("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const o=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,_(d)};this._supportsGeolocation!==void 0?_(this._supportsGeolocation):t.window.navigator.permissions!==void 0?t.window.navigator.permissions.query({name:"geolocation"}).then(d=>o(d.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(_){const o=this._map.getMaxBounds(),d=_.coords;return!!o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",_)),this._finish()}}_updateCamera(_){const o=new t.LngLat(_.coords.longitude,_.coords.latitude),d=_.coords.accuracy,x=this._map.getBearing(),E=t.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(d),E,{geolocateSource:!0})}_updateMarker(_){if(_){const o=new t.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,o=t.mercatorZfromAltitude(1,_._center.lat)*_.worldSize,d=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=ne("button","mapboxgl-ctrl-geolocate",this._container),ne("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",_===!1){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ne("div","mapboxgl-user-location"),this._dotElement.appendChild(ne("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ne("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new pi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ne("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new pi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{t.window.addEventListener("ondeviceorientationabsolute"in t.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};t.window.DeviceMotionEvent!==void 0&&typeof t.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),t.window.removeEventListener("deviceorientation",this._onDeviceOrientation),t.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ft,ScaleControl:class{constructor(_){this.options=t.extend({},Ms,_),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),t.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,o=this._map,d=o._containerHeight/2,x=o._containerWidth/2-_/2,E=o.unproject([x,d]),A=o.unproject([x+_,d]),B=E.distanceTo(A);if(this.options.unit==="imperial"){const O=3.2808*B;O>5280?this._setScale(_,O/5280,"mile"):this._setScale(_,O,"foot")}else this.options.unit==="nautical"?this._setScale(_,B/1852,"nautical-mile"):B>=1e3?this._setScale(_,B/1e3,"kilometer"):this._setScale(_,B,"meter")}_setScale(_,o,d){this._map._requestDomTask(()=>{const x=function(A){const B=Math.pow(10,`${Math.floor(A)}`.length-1);let O=A/B;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(G){const H=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10));return Math.round(G*H)/H}(O),B*O}(o),E=x/o;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(x):`${x}&nbsp;${Qo[d]}`,this._container.style.width=_*E+"px"})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=ne("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof t.window.HTMLElement?this._container=_.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=ne("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=ne("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ne("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.Evented{constructor(_){super(),this.options=t.extend(Object.create(cn),_),t.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=t.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(t.window.document.createTextNode(_))}setHTML(_){const o=t.window.document.createDocumentFragment(),d=t.window.document.createElement("body");let x;for(d.innerHTML=_;x=d.firstChild,x;)o.appendChild(x);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=ne("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(_),this.options.closeButton){const d=this._closeButton=ne("button","mapboxgl-popup-close-button",o);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let o;return this._classList.delete(_)?o=!1:(this._classList.add(_),o=!0),this._updateClassList(),o}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const o=this._map,d=this._container,x=this._pos;if(!o||!d||!x)return"bottom";const E=d.offsetWidth,A=d.offsetHeight,B=x.x<E/2,O=x.x>o.transform.width-E/2;if(x.y+_<A)return B?"top-left":O?"top-right":"top";if(x.y>o.transform.height-A){if(B)return"bottom-left";if(O)return"bottom-right"}return B?"left":O?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),_.className=o.join(" ")}_update(_){const o=this._map,d=this._content;if(!o||!this._lngLat&&!this._trackPointer||!d)return;let x=this._container;if(x||(x=this._container=ne("div","mapboxgl-popup",o.getContainer()),this._tip=ne("div","mapboxgl-popup-tip",x),x.appendChild(d)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Sr(this._lngLat,this._pos,o.transform)),!this._trackPointer||_){const E=this._pos=this._trackPointer&&_?_:o.project(this._lngLat),A=Jr(this.options.offset),B=this._anchor=this._getAnchor(A.y),O=Jr(this.options.offset,B),G=E.add(O).round();o._requestDomTask(()=>{this._container&&B&&(this._container.style.transform=`${ir[B]} translate(${G.x}px,${G.y}px)`)})}if(!this._marker&&o._showingGlobe()){const E=t.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(E)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Yr);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:pi,Style:Ws,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:eh,Evented:t.Evented,config:t.config,prewarm:function(){ut().acquire(Ze)},clearPrewarmedResources:function(){const _=Ve;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(Ze),Ve=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(_){t.config.ACCESS_TOKEN=_},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(_){t.config.API_URL=_},get workerCount(){return $e.workerCount},set workerCount(_){$e.workerCount=_},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){t.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){t.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return Cs});var F=T;return F})})(Tv);var Sv=Tv.exports;const RC=yd(Sv),BC=u_({__proto__:null,default:RC},[Sv]);export{WC as F,NC as L,qC as M,XC as N,An as P,i1 as R,KC as S,n6 as W,JM as _,c_ as a,ZC as b,HC as c,OC as d,T7 as e,UC as f,jC as g,FC as j,$C as m,VC as p,s2 as q,Xt as r,GC as w};
