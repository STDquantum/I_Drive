import{A as f,j as l}from"./const-0c3abedc.js";import{r as k,u as I,j as e,h as L,B as E,C as S,X as N,Y as b,T as M,i as w,e as Y,R as B,q as $}from"./vendors-a43e93ac.js";import{a as F}from"./activities-421834d1.js";const O="_activityList_1ukxg_1",R="_filterContainer_1ukxg_7",H="_summaryContainer_1ukxg_23",K="_activityCard_1ukxg_30",P="_activityName_1ukxg_45",G="_activityDetails_1ukxg_51",V="_chart_1ukxg_60",W="_smallHomeButton_1ukxg_70",m={activityList:O,filterContainer:R,summaryContainer:H,activityCard:K,activityName:P,activityDetails:G,chart:V,smallHomeButton:W},X=({period:c,summary:o,dailyDistances:x,interval:d,activityType:u})=>{const T=(()=>{if(d==="month"){const[t,s]=c.split("-").map(Number),i=new Date(t,s,0).getDate();return Array.from({length:i},(a,r)=>r+1)}else{if(d==="week")return Array.from({length:7},(t,s)=>s+1);if(d==="year")return Array.from({length:12},(t,s)=>s+1)}return[]})().map(t=>({day:t,distance:(x[t-1]||0).toFixed(2)})),_=t=>{const s=Math.floor(t/3600),i=Math.floor(t%3600/60),a=Math.floor(t%60);return`${s}h ${i}m ${a}s`},j=t=>{if(t===0)return"0:00";const s=60/t,i=Math.floor(s),a=Math.round((s-i)*60);return`${i}:${a<10?"0":""}${a} min/km`},p=Math.ceil(Math.max(...T.map(t=>parseFloat(t.distance)))+10),n=Array.from({length:Math.ceil(p/5)+1},(t,s)=>s*5);return e.jsxs("div",{className:m.activityCard,children:[e.jsx("h2",{className:m.activityName,children:c}),e.jsxs("div",{className:m.activityDetails,children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[l.TOTAL_DISTANCE_TITLE,":"]})," ",o.totalDistance.toFixed(2)," km"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.AVERAGE_SPEED_TITLE,":"]})," ",u==="ride"?`${o.averageSpeed.toFixed(2)} km/h`:j(o.averageSpeed)]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.TOTAL_TIME_TITLE,":"]})," ",_(o.totalTime)]}),d!=="day"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[l.ACTIVITY_COUNT_TITLE,":"]})," ",o.count]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.MAX_DISTANCE_TITLE,":"]})," ",o.maxDistance.toFixed(2)," km"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.MAX_SPEED_TITLE,":"]})," ",u==="ride"?`${o.maxSpeed.toFixed(2)} km/h`:j(o.maxSpeed)]})]}),d==="day"&&e.jsxs("p",{children:[e.jsxs("strong",{children:[l.LOCATION_TITLE,":"]})," ",o.location||""]}),["month","week","year"].includes(d)&&e.jsx("div",{className:m.chart,style:{height:"250px",width:"100%"},children:e.jsx(L,{children:e.jsxs(E,{data:T,margin:{top:20,right:20,left:-20,bottom:5},children:[e.jsx(S,{strokeDasharray:"3 3",stroke:"#444"}),e.jsx(N,{dataKey:"day",tick:{fill:"rgb(204, 204, 204)"}}),e.jsx(b,{label:{value:"km",angle:-90,position:"insideLeft",fill:"rgb(204, 204, 204)"},domain:[0,p],ticks:n,tick:{fill:"rgb(204, 204, 204)"}}),e.jsx(M,{formatter:t=>`${t} km`,contentStyle:{backgroundColor:"rgb(36, 36, 36)",border:"1px solid #444",color:"rgb(204, 204, 204)"},labelStyle:{color:"rgb(224, 237, 94)"}}),e.jsx(w,{dataKey:"distance",fill:"rgb(224, 237, 94)"})]})})})]})]})},U=()=>{const[c,o]=k.useState("month"),[x,d]=k.useState("run"),u=I(),v=n=>{o(n)},T=n=>n.type.toLowerCase()===x,_=n=>{const[t,s,i]=n.split(":").map(Number);return t*3600+s*60+i},p=(n=>F.filter(T).reduce((t,s)=>{const i=new Date(s.start_date_local);let a,r;switch(n){case"year":a=i.getFullYear().toString(),r=i.getMonth();break;case"month":a=`${i.getFullYear()}-${(i.getMonth()+1).toString().padStart(2,"0")}`,r=i.getDate()-1;break;case"week":const h=new Date(i.valueOf());h.setDate(h.getDate()+4-(h.getDay()||7));const A=new Date(h.getFullYear(),0,1),C=Math.ceil(((h.getTime()-A.getTime())/864e5+1)/7);a=`${h.getFullYear()}-W${C.toString().padStart(2,"0")}`,r=(i.getDay()+6)%7;break;case"day":a=i.toLocaleDateString("zh").replaceAll("/","-"),r=0;break;default:a=i.getFullYear().toString(),r=0}t[a]||(t[a]={totalDistance:0,totalTime:0,count:0,dailyDistances:[],maxDistance:0,maxSpeed:0,location:""});const g=s.distance/1e3,y=_(s.moving_time),D=y>0?g/(y/3600):0;return t[a].totalDistance+=g,t[a].totalTime+=y,t[a].count+=1,t[a].dailyDistances[r]=(t[a].dailyDistances[r]||0)+g,g>t[a].maxDistance&&(t[a].maxDistance=g),D>t[a].maxSpeed&&(t[a].maxSpeed=D),n==="day"&&(t[a].location=s.location_country||""),t},{}))(c);return e.jsxs("div",{className:m.activityList,children:[e.jsxs("div",{className:m.filterContainer,children:[e.jsx("button",{className:m.smallHomeButton,onClick:()=>u("/"),children:"Home"}),e.jsxs("select",{onChange:n=>d(n.target.value),value:x,children:[e.jsx("option",{value:"run",children:f.RUN_GENERIC_TITLE}),e.jsx("option",{value:"ride",children:f.CYCLING_TITLE})]}),e.jsxs("select",{onChange:n=>v(n.target.value),value:c,children:[e.jsx("option",{value:"year",children:l.YEARLY_TITLE}),e.jsx("option",{value:"month",children:l.MONTHLY_TITLE}),e.jsx("option",{value:"week",children:l.WEEKLY_TITLE}),e.jsx("option",{value:"day",children:l.DAILY_TITLE})]})]}),e.jsx("div",{className:m.summaryContainer,children:Object.entries(p).sort(([n],[t])=>{if(c==="day")return new Date(t).getTime()-new Date(n).getTime();if(c==="week"){const[s,i]=n.split("-W").map(Number),[a,r]=t.split("-W").map(Number);return a-s||r-i}else{const[s,i=0]=n.split("-").map(Number),[a,r=0]=t.split("-").map(Number);return a-s||r-i}}).map(([n,t])=>e.jsx(X,{period:n,summary:{totalDistance:t.totalDistance,averageSpeed:t.totalTime?t.totalDistance/(t.totalTime/3600):0,totalTime:t.totalTime,count:t.count,maxDistance:t.maxDistance,maxSpeed:t.maxSpeed,location:t.location},dailyDistances:t.dailyDistances,interval:c,activityType:x},n))})]})},q=()=>e.jsx("div",{children:e.jsx(U,{})});Y.createRoot(document.getElementById("root")).render(e.jsx(B.StrictMode,{children:e.jsx($,{children:e.jsx(q,{})})}));
